{
  "query": "q77",
  "status": "pending",
  "rules": [
    "FILTER_INTO_JOIN",
    "FILTER_SCAN",
    "PROJECT_MERGE",
    "JOIN_CONDITION_PUSH",
    "AGGREGATE_JOIN_TRANSPOSE",
    "SORT_PROJECT_TRANSPOSE"
  ],
  "optimizedSql": "SELECT CHANNEL, ID, SUM(SALES) AS SALES, SUM(RETURNS_) AS RETURNS_, SUM(PROFIT) AS PROFIT\nFROM (SELECT *\nFROM (SELECT \u0027store channel\u0027 AS CHANNEL, t2.S_STORE_SK AS ID, t2.SALES, CASE WHEN t6.RETURNS_ IS NOT NULL THEN CAST(t6.RETURNS_ AS DECIMAL(19, 0)) ELSE 0 END AS RETURNS_, t2.PROFIT - CASE WHEN t6.PROFIT_LOSS IS NOT NULL THEN CAST(t6.PROFIT_LOSS AS DECIMAL(19, 0)) ELSE 0 END AS PROFIT\nFROM (SELECT store.s_store_sk AS S_STORE_SK, SUM(store_sales.ss_ext_sales_price) AS SALES, SUM(store_sales.ss_net_profit) AS PROFIT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nGROUP BY store.s_store_sk) AS t2\nLEFT JOIN (SELECT store0.s_store_sk AS S_STORE_SK, SUM(store_returns.sr_return_amt) AS RETURNS_, SUM(store_returns.sr_net_loss) AS PROFIT_LOSS\nFROM store_returns\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t3 ON store_returns.sr_returned_date_sk \u003d t3.d_date_sk\nINNER JOIN store AS store0 ON store_returns.sr_store_sk \u003d store0.s_store_sk\nGROUP BY store0.s_store_sk) AS t6 ON t2.S_STORE_SK \u003d t6.S_STORE_SK\nUNION ALL\nSELECT \u0027catalog channel\u0027 AS CHANNEL, t11.CS_CALL_CENTER_SK AS ID, t11.SALES, t15.RETURNS_, t11.PROFIT - t15.PROFIT_LOSS AS PROFIT\nFROM (SELECT catalog_sales.cs_call_center_sk AS CS_CALL_CENTER_SK, SUM(catalog_sales.cs_ext_sales_price) AS SALES, SUM(catalog_sales.cs_net_profit) AS PROFIT\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t8 ON catalog_sales.cs_sold_date_sk \u003d t8.d_date_sk\nGROUP BY catalog_sales.cs_call_center_sk) AS t11,\n(SELECT catalog_returns.cr_call_center_sk AS CR_CALL_CENTER_SK, SUM(catalog_returns.cr_return_amount) AS RETURNS_, SUM(catalog_returns.cr_net_loss) AS PROFIT_LOSS\nFROM catalog_returns\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t12 ON catalog_returns.cr_returned_date_sk \u003d t12.d_date_sk\nGROUP BY catalog_returns.cr_call_center_sk) AS t15)\nUNION ALL\nSELECT \u0027web channel\u0027 AS CHANNEL, t21.WP_WEB_PAGE_SK AS ID, t21.SALES, CASE WHEN t25.RETURNS_ IS NOT NULL THEN CAST(t25.RETURNS_ AS DECIMAL(19, 0)) ELSE 0 END AS RETURNS_, t21.PROFIT - CASE WHEN t25.PROFIT_LOSS IS NOT NULL THEN CAST(t25.PROFIT_LOSS AS DECIMAL(19, 0)) ELSE 0 END AS PROFIT\nFROM (SELECT web_page.wp_web_page_sk AS WP_WEB_PAGE_SK, SUM(web_sales.ws_ext_sales_price) AS SALES, SUM(web_sales.ws_net_profit) AS PROFIT\nFROM web_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t18 ON web_sales.ws_sold_date_sk \u003d t18.d_date_sk\nINNER JOIN web_page ON web_sales.ws_web_page_sk \u003d web_page.wp_web_page_sk\nGROUP BY web_page.wp_web_page_sk) AS t21\nLEFT JOIN (SELECT web_page0.wp_web_page_sk AS WP_WEB_PAGE_SK, SUM(web_returns.wr_return_amt) AS RETURNS_, SUM(web_returns.wr_net_loss) AS PROFIT_LOSS\nFROM web_returns\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t22 ON web_returns.wr_returned_date_sk \u003d t22.d_date_sk\nINNER JOIN web_page AS web_page0 ON web_returns.wr_web_page_sk \u003d web_page0.wp_web_page_sk\nGROUP BY web_page0.wp_web_page_sk) AS t25 ON t21.WP_WEB_PAGE_SK \u003d t25.WP_WEB_PAGE_SK) AS t27\nGROUP BY ROLLUP(CHANNEL, ID)\nORDER BY CHANNEL NULLS FIRST, ID NULLS FIRST, 4 DESC\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    15,
    16
  ],
  "optimizedTimesMs": [
    17,
    15
  ],
  "originalAvgMs": 15,
  "optimizedAvgMs": 16,
  "speedup": 0.9375,
  "originalRowCount": 100,
  "optimizedRowCount": 100,
  "validationPassed": false,
  "originalPlanMaxRows": 2878107,
  "optimizedPlanMaxRows": 2878107
}