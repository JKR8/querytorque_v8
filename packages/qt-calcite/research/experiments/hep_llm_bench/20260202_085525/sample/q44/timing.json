{
  "query": "q44",
  "status": "pending",
  "rules": [
    "FILTER_INTO_JOIN",
    "JOIN_CONDITION_PUSH",
    "FILTER_AGGREGATE_TRANSPOSE",
    "PROJECT_MERGE",
    "SUBQUERY_REMOVE",
    "SORT_REMOVE_REDUNDANT"
  ],
  "optimizedSql": "SELECT t9.RNK, item.i_product_name AS BEST_PERFORMING, item0.i_product_name AS WORST_PERFORMING\nFROM (SELECT *\nFROM (SELECT ss_item_sk AS ITEM_SK, RANK() OVER (ORDER BY RANK_COL) AS RNK\nFROM (SELECT ss_item_sk, AVG(ss_net_profit) AS RANK_COL\nFROM store_sales\nWHERE ss_store_sk \u003d 4\nGROUP BY ss_item_sk\nHAVING AVG(ss_net_profit) \u003e 0.9 * (((SELECT AVG(ss_net_profit) AS RANK_COL\nFROM store_sales\nWHERE ss_store_sk \u003d 4 AND ss_addr_sk IS NULL\nGROUP BY ss_store_sk)))) AS t6) AS t7\nWHERE RNK \u003c 11) AS t9\nINNER JOIN (SELECT *\nFROM (SELECT ss_item_sk AS ITEM_SK, RANK() OVER (ORDER BY RANK_COL DESC) AS RNK\nFROM (SELECT ss_item_sk, AVG(ss_net_profit) AS RANK_COL\nFROM store_sales\nWHERE ss_store_sk \u003d 4\nGROUP BY ss_item_sk\nHAVING AVG(ss_net_profit) \u003e 0.9 * (((SELECT AVG(ss_net_profit) AS RANK_COL\nFROM store_sales\nWHERE ss_store_sk \u003d 4 AND ss_addr_sk IS NULL\nGROUP BY ss_store_sk)))) AS t17) AS t18\nWHERE RNK \u003c 11) AS t20 ON t9.RNK \u003d t20.RNK\nINNER JOIN item ON t9.ITEM_SK \u003d item.i_item_sk\nINNER JOIN item AS item0 ON t20.ITEM_SK \u003d item0.i_item_sk\nORDER BY t9.RNK\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    24,
    23
  ],
  "optimizedTimesMs": [
    21,
    23
  ],
  "originalAvgMs": 23,
  "optimizedAvgMs": 22,
  "speedup": 1.0454545454545454,
  "originalRowCount": 10,
  "optimizedRowCount": 10,
  "validationPassed": true,
  "originalPlanMaxRows": 204000,
  "optimizedPlanMaxRows": 204000
}