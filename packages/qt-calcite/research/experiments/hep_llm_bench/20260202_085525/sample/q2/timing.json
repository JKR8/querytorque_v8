{
  "query": "q2",
  "status": "pending",
  "rules": [
    "FILTER_SCAN",
    "FILTER_INTO_JOIN",
    "AGGREGATE_CASE_TO_FILTER",
    "PROJECT_MERGE",
    "SORT_PROJECT_TRANSPOSE"
  ],
  "optimizedSql": "SELECT t7.D_WEEK_SEQ1, ROUND(t7.SUN_SALES1 / t16.SUN_SALES2, 2) AS R1, ROUND(t7.MON_SALES1 / t16.MON_SALES2, 2) AS R2, ROUND(t7.TUE_SALES1 / t16.TUE_SALES2, 2) AS R3, ROUND(t7.WED_SALES1 / t16.WED_SALES2, 2) AS R4, ROUND(t7.THU_SALES1 / t16.THU_SALES2, 2) AS R5, ROUND(t7.FRI_SALES1 / t16.FRI_SALES2, 2) AS R6, ROUND(t7.SAT_SALES1 / t16.SAT_SALES2, 2)\nFROM (SELECT t5.D_WEEK_SEQ AS D_WEEK_SEQ1, t5.SUN_SALES AS SUN_SALES1, t5.MON_SALES AS MON_SALES1, t5.TUE_SALES AS TUE_SALES1, t5.WED_SALES AS WED_SALES1, t5.THU_SALES AS THU_SALES1, t5.FRI_SALES AS FRI_SALES1, t5.SAT_SALES AS SAT_SALES1\nFROM (SELECT date_dim.d_week_seq AS D_WEEK_SEQ, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Sunday\u0027 IS TRUE) AS SUN_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Monday\u0027 IS TRUE) AS MON_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Tuesday\u0027 IS TRUE) AS TUE_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Wednesday\u0027 IS TRUE) AS WED_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Thursday\u0027 IS TRUE) AS THU_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Friday\u0027 IS TRUE) AS FRI_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Saturday\u0027 IS TRUE) AS SAT_SALES\nFROM (SELECT *\nFROM (SELECT ws_sold_date_sk AS SOLD_DATE_SK, ws_ext_sales_price AS SALES_PRICE\nFROM web_sales\nUNION ALL\nSELECT cs_sold_date_sk AS SOLD_DATE_SK, cs_ext_sales_price AS SALES_PRICE\nFROM catalog_sales) AS t1) AS t2\nINNER JOIN date_dim ON t2.SOLD_DATE_SK \u003d date_dim.d_date_sk\nGROUP BY date_dim.d_week_seq) AS t5\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t6 ON t5.D_WEEK_SEQ \u003d t6.d_week_seq) AS t7\nINNER JOIN (SELECT t14.D_WEEK_SEQ AS D_WEEK_SEQ2, t14.SUN_SALES AS SUN_SALES2, t14.MON_SALES AS MON_SALES2, t14.TUE_SALES AS TUE_SALES2, t14.WED_SALES AS WED_SALES2, t14.THU_SALES AS THU_SALES2, t14.FRI_SALES AS FRI_SALES2, t14.SAT_SALES AS SAT_SALES2\nFROM (SELECT date_dim1.d_week_seq AS D_WEEK_SEQ, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Sunday\u0027 IS TRUE) AS SUN_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Monday\u0027 IS TRUE) AS MON_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Tuesday\u0027 IS TRUE) AS TUE_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Wednesday\u0027 IS TRUE) AS WED_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Thursday\u0027 IS TRUE) AS THU_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Friday\u0027 IS TRUE) AS FRI_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Saturday\u0027 IS TRUE) AS SAT_SALES\nFROM (SELECT *\nFROM (SELECT ws_sold_date_sk AS SOLD_DATE_SK, ws_ext_sales_price AS SALES_PRICE\nFROM web_sales\nUNION ALL\nSELECT cs_sold_date_sk AS SOLD_DATE_SK, cs_ext_sales_price AS SALES_PRICE\nFROM catalog_sales) AS t10) AS t11\nINNER JOIN date_dim AS date_dim1 ON t11.SOLD_DATE_SK \u003d date_dim1.d_date_sk\nGROUP BY date_dim1.d_week_seq) AS t14\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t15 ON t14.D_WEEK_SEQ \u003d t15.d_week_seq) AS t16 ON t7.D_WEEK_SEQ1 \u003d t16.D_WEEK_SEQ2 - 53\nORDER BY t7.D_WEEK_SEQ1 NULLS FIRST",
  "originalTimesMs": [
    32,
    23
  ],
  "optimizedTimesMs": [
    44,
    50
  ],
  "originalAvgMs": 27,
  "optimizedAvgMs": 47,
  "speedup": 0.574468085106383,
  "originalRowCount": 2513,
  "optimizedRowCount": 2513,
  "validationPassed": true,
  "originalPlanMaxRows": 2159358,
  "optimizedPlanMaxRows": 2159358
}