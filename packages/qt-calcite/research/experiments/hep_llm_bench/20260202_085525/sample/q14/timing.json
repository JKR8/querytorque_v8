{
  "query": "q14",
  "status": "pending",
  "rules": [
    "FILTER_SCAN",
    "FILTER_INTO_JOIN",
    "FILTER_SUB_QUERY_TO_CORRELATE",
    "PROJECT_MERGE",
    "AGGREGATE_JOIN_TRANSPOSE",
    "SORT_PROJECT_TRANSPOSE"
  ],
  "optimizedSql": "SELECT CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, SUM(SALES) AS SUM_SALES, SUM(NUMBER_SALES) AS SUM_NUMBER_SALES\nFROM (SELECT *\nFROM (SELECT \u0027store\u0027 AS CHANNEL, t13.i_brand_id AS I_BRAND_ID, t13.i_class_id AS I_CLASS_ID, t13.i_category_id AS I_CATEGORY_ID, t13.SALES, t13.NUMBER_SALES\nFROM (SELECT item3.i_brand_id, item3.i_class_id, item3.i_category_id, SUM(t10.ss_quantity * t10.ss_list_price) AS SALES, COUNT(*) AS NUMBER_SALES\nFROM (SELECT store_sales.ss_sold_date_sk, store_sales.ss_sold_time_sk, store_sales.ss_item_sk, store_sales.ss_customer_sk, store_sales.ss_cdemo_sk, store_sales.ss_hdemo_sk, store_sales.ss_addr_sk, store_sales.ss_store_sk, store_sales.ss_promo_sk, store_sales.ss_ticket_number, store_sales.ss_quantity, store_sales.ss_wholesale_cost, store_sales.ss_list_price, store_sales.ss_sales_price, store_sales.ss_ext_discount_amt, store_sales.ss_ext_sales_price, store_sales.ss_ext_wholesale_cost, store_sales.ss_ext_list_price, store_sales.ss_ext_tax, store_sales.ss_coupon_amt, store_sales.ss_net_paid, store_sales.ss_net_paid_inc_tax, store_sales.ss_net_profit\nFROM store_sales\nINNER JOIN (SELECT item.i_item_sk AS SS_ITEM_SK\nFROM item,\n(SELECT *\nFROM (SELECT item0.i_brand_id AS BRAND_ID, item0.i_class_id AS CLASS_ID, item0.i_category_id AS CATEGORY_ID\nFROM store_sales AS store_sales0,\nitem AS item0,\ndate_dim\nWHERE store_sales0.ss_item_sk \u003d item0.i_item_sk AND store_sales0.ss_sold_date_sk \u003d date_dim.d_date_sk AND date_dim.d_year \u003e\u003d 1999 AND date_dim.d_year \u003c\u003d 1999 + 2\nINTERSECT\nSELECT item1.i_brand_id AS I_BRAND_ID, item1.i_class_id AS I_CLASS_ID, item1.i_category_id AS I_CATEGORY_ID\nFROM catalog_sales,\nitem AS item1,\ndate_dim AS date_dim0\nWHERE catalog_sales.cs_item_sk \u003d item1.i_item_sk AND catalog_sales.cs_sold_date_sk \u003d date_dim0.d_date_sk AND date_dim0.d_year \u003e\u003d 1999 AND date_dim0.d_year \u003c\u003d 1999 + 2)\nINTERSECT\nSELECT item2.i_brand_id AS I_BRAND_ID, item2.i_class_id AS I_CLASS_ID, item2.i_category_id AS I_CATEGORY_ID\nFROM web_sales,\nitem AS item2,\ndate_dim AS date_dim1\nWHERE web_sales.ws_item_sk \u003d item2.i_item_sk AND web_sales.ws_sold_date_sk \u003d date_dim1.d_date_sk AND date_dim1.d_year \u003e\u003d 1999 AND date_dim1.d_year \u003c\u003d 1999 + 2) AS t6\nWHERE item.i_brand_id \u003d t6.BRAND_ID AND item.i_class_id \u003d t6.CLASS_ID AND item.i_category_id \u003d t6.CATEGORY_ID\nGROUP BY item.i_item_sk) AS t9 ON store_sales.ss_item_sk \u003d t9.SS_ITEM_SK) AS t10\nINNER JOIN item AS item3 ON t10.ss_item_sk \u003d item3.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d CAST(1999 + 2 AS BIGINT) AND d_moy \u003d 11) AS t11 ON t10.ss_sold_date_sk \u003d t11.d_date_sk\nGROUP BY item3.i_brand_id, item3.i_class_id, item3.i_category_id) AS t13\nLEFT JOIN (SELECT AVG(QUANTITY * LIST_PRICE) AS AVERAGE_SALES\nFROM (SELECT *\nFROM (SELECT store_sales1.ss_quantity AS QUANTITY, store_sales1.ss_list_price AS LIST_PRICE\nFROM store_sales AS store_sales1,\ndate_dim AS date_dim3\nWHERE store_sales1.ss_sold_date_sk \u003d date_dim3.d_date_sk AND date_dim3.d_year \u003e\u003d 1999 AND date_dim3.d_year \u003c\u003d 1999 + 2\nUNION ALL\nSELECT catalog_sales0.cs_quantity AS QUANTITY, catalog_sales0.cs_list_price AS LIST_PRICE\nFROM catalog_sales AS catalog_sales0,\ndate_dim AS date_dim4\nWHERE catalog_sales0.cs_sold_date_sk \u003d date_dim4.d_date_sk AND date_dim4.d_year \u003e\u003d 1999 AND date_dim4.d_year \u003c\u003d 1999 + 2)\nUNION ALL\nSELECT web_sales0.ws_quantity AS QUANTITY, web_sales0.ws_list_price AS LIST_PRICE\nFROM web_sales AS web_sales0,\ndate_dim AS date_dim5\nWHERE web_sales0.ws_sold_date_sk \u003d date_dim5.d_date_sk AND date_dim5.d_year \u003e\u003d 1999 AND date_dim5.d_year \u003c\u003d 1999 + 2) AS t21) AS t24 ON TRUE\nWHERE t13.SALES \u003e t24.AVERAGE_SALES\nUNION ALL\nSELECT \u0027catalog\u0027 AS CHANNEL, t41.i_brand_id AS I_BRAND_ID, t41.i_class_id AS I_CLASS_ID, t41.i_category_id AS I_CATEGORY_ID, t41.SALES, t41.NUMBER_SALES\nFROM (SELECT item8.i_brand_id, item8.i_class_id, item8.i_category_id, SUM(t38.cs_quantity * t38.cs_list_price) AS SALES, COUNT(*) AS NUMBER_SALES\nFROM (SELECT catalog_sales1.cs_sold_date_sk, catalog_sales1.cs_sold_time_sk, catalog_sales1.cs_ship_date_sk, catalog_sales1.cs_bill_customer_sk, catalog_sales1.cs_bill_cdemo_sk, catalog_sales1.cs_bill_hdemo_sk, catalog_sales1.cs_bill_addr_sk, catalog_sales1.cs_ship_customer_sk, catalog_sales1.cs_ship_cdemo_sk, catalog_sales1.cs_ship_hdemo_sk, catalog_sales1.cs_ship_addr_sk, catalog_sales1.cs_call_center_sk, catalog_sales1.cs_catalog_page_sk, catalog_sales1.cs_ship_mode_sk, catalog_sales1.cs_warehouse_sk, catalog_sales1.cs_item_sk, catalog_sales1.cs_promo_sk, catalog_sales1.cs_order_number, catalog_sales1.cs_quantity, catalog_sales1.cs_wholesale_cost, catalog_sales1.cs_list_price, catalog_sales1.cs_sales_price, catalog_sales1.cs_ext_discount_amt, catalog_sales1.cs_ext_sales_price, catalog_sales1.cs_ext_wholesale_cost, catalog_sales1.cs_ext_list_price, catalog_sales1.cs_ext_tax, catalog_sales1.cs_coupon_amt, catalog_sales1.cs_ext_ship_cost, catalog_sales1.cs_net_paid, catalog_sales1.cs_net_paid_inc_tax, catalog_sales1.cs_net_paid_inc_ship, catalog_sales1.cs_net_paid_inc_ship_tax, catalog_sales1.cs_net_profit\nFROM catalog_sales AS catalog_sales1\nINNER JOIN (SELECT item4.i_item_sk AS SS_ITEM_SK\nFROM item AS item4,\n(SELECT *\nFROM (SELECT item5.i_brand_id AS BRAND_ID, item5.i_class_id AS CLASS_ID, item5.i_category_id AS CATEGORY_ID\nFROM store_sales AS store_sales2,\nitem AS item5,\ndate_dim AS date_dim6\nWHERE store_sales2.ss_item_sk \u003d item5.i_item_sk AND store_sales2.ss_sold_date_sk \u003d date_dim6.d_date_sk AND date_dim6.d_year \u003e\u003d 1999 AND date_dim6.d_year \u003c\u003d 1999 + 2\nINTERSECT\nSELECT item6.i_brand_id AS I_BRAND_ID, item6.i_class_id AS I_CLASS_ID, item6.i_category_id AS I_CATEGORY_ID\nFROM catalog_sales AS catalog_sales2,\nitem AS item6,\ndate_dim AS date_dim7\nWHERE catalog_sales2.cs_item_sk \u003d item6.i_item_sk AND catalog_sales2.cs_sold_date_sk \u003d date_dim7.d_date_sk AND date_dim7.d_year \u003e\u003d 1999 AND date_dim7.d_year \u003c\u003d 1999 + 2)\nINTERSECT\nSELECT item7.i_brand_id AS I_BRAND_ID, item7.i_class_id AS I_CLASS_ID, item7.i_category_id AS I_CATEGORY_ID\nFROM web_sales AS web_sales1,\nitem AS item7,\ndate_dim AS date_dim8\nWHERE web_sales1.ws_item_sk \u003d item7.i_item_sk AND web_sales1.ws_sold_date_sk \u003d date_dim8.d_date_sk AND date_dim8.d_year \u003e\u003d 1999 AND date_dim8.d_year \u003c\u003d 1999 + 2) AS t34\nWHERE item4.i_brand_id \u003d t34.BRAND_ID AND item4.i_class_id \u003d t34.CLASS_ID AND item4.i_category_id \u003d t34.CATEGORY_ID\nGROUP BY item4.i_item_sk) AS t37 ON catalog_sales1.cs_item_sk \u003d t37.SS_ITEM_SK) AS t38\nINNER JOIN item AS item8 ON t38.cs_item_sk \u003d item8.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d CAST(1999 + 2 AS BIGINT) AND d_moy \u003d 11) AS t39 ON t38.cs_sold_date_sk \u003d t39.d_date_sk\nGROUP BY item8.i_brand_id, item8.i_class_id, item8.i_category_id) AS t41\nLEFT JOIN (SELECT AVG(QUANTITY * LIST_PRICE) AS AVERAGE_SALES\nFROM (SELECT *\nFROM (SELECT store_sales3.ss_quantity AS QUANTITY, store_sales3.ss_list_price AS LIST_PRICE\nFROM store_sales AS store_sales3,\ndate_dim AS date_dim10\nWHERE store_sales3.ss_sold_date_sk \u003d date_dim10.d_date_sk AND date_dim10.d_year \u003e\u003d 1999 AND date_dim10.d_year \u003c\u003d 1999 + 2\nUNION ALL\nSELECT catalog_sales3.cs_quantity AS QUANTITY, catalog_sales3.cs_list_price AS LIST_PRICE\nFROM catalog_sales AS catalog_sales3,\ndate_dim AS date_dim11\nWHERE catalog_sales3.cs_sold_date_sk \u003d date_dim11.d_date_sk AND date_dim11.d_year \u003e\u003d 1999 AND date_dim11.d_year \u003c\u003d 1999 + 2)\nUNION ALL\nSELECT web_sales2.ws_quantity AS QUANTITY, web_sales2.ws_list_price AS LIST_PRICE\nFROM web_sales AS web_sales2,\ndate_dim AS date_dim12\nWHERE web_sales2.ws_sold_date_sk \u003d date_dim12.d_date_sk AND date_dim12.d_year \u003e\u003d 1999 AND date_dim12.d_year \u003c\u003d 1999 + 2) AS t49) AS t52 ON TRUE\nWHERE t41.SALES \u003e t52.AVERAGE_SALES)\nUNION ALL\nSELECT \u0027web\u0027 AS CHANNEL, t70.i_brand_id AS I_BRAND_ID, t70.i_class_id AS I_CLASS_ID, t70.i_category_id AS I_CATEGORY_ID, t70.SALES, t70.NUMBER_SALES\nFROM (SELECT item13.i_brand_id, item13.i_class_id, item13.i_category_id, SUM(t67.ws_quantity * t67.ws_list_price) AS SALES, COUNT(*) AS NUMBER_SALES\nFROM (SELECT web_sales3.ws_sold_date_sk, web_sales3.ws_sold_time_sk, web_sales3.ws_ship_date_sk, web_sales3.ws_item_sk, web_sales3.ws_bill_customer_sk, web_sales3.ws_bill_cdemo_sk, web_sales3.ws_bill_hdemo_sk, web_sales3.ws_bill_addr_sk, web_sales3.ws_ship_customer_sk, web_sales3.ws_ship_cdemo_sk, web_sales3.ws_ship_hdemo_sk, web_sales3.ws_ship_addr_sk, web_sales3.ws_web_page_sk, web_sales3.ws_web_site_sk, web_sales3.ws_ship_mode_sk, web_sales3.ws_warehouse_sk, web_sales3.ws_promo_sk, web_sales3.ws_order_number, web_sales3.ws_quantity, web_sales3.ws_wholesale_cost, web_sales3.ws_list_price, web_sales3.ws_sales_price, web_sales3.ws_ext_discount_amt, web_sales3.ws_ext_sales_price, web_sales3.ws_ext_wholesale_cost, web_sales3.ws_ext_list_price, web_sales3.ws_ext_tax, web_sales3.ws_coupon_amt, web_sales3.ws_ext_ship_cost, web_sales3.ws_net_paid, web_sales3.ws_net_paid_inc_tax, web_sales3.ws_net_paid_inc_ship, web_sales3.ws_net_paid_inc_ship_tax, web_sales3.ws_net_profit\nFROM web_sales AS web_sales3\nINNER JOIN (SELECT item9.i_item_sk AS SS_ITEM_SK\nFROM item AS item9,\n(SELECT *\nFROM (SELECT item10.i_brand_id AS BRAND_ID, item10.i_class_id AS CLASS_ID, item10.i_category_id AS CATEGORY_ID\nFROM store_sales AS store_sales4,\nitem AS item10,\ndate_dim AS date_dim13\nWHERE store_sales4.ss_item_sk \u003d item10.i_item_sk AND store_sales4.ss_sold_date_sk \u003d date_dim13.d_date_sk AND date_dim13.d_year \u003e\u003d 1999 AND date_dim13.d_year \u003c\u003d 1999 + 2\nINTERSECT\nSELECT item11.i_brand_id AS I_BRAND_ID, item11.i_class_id AS I_CLASS_ID, item11.i_category_id AS I_CATEGORY_ID\nFROM catalog_sales AS catalog_sales4,\nitem AS item11,\ndate_dim AS date_dim14\nWHERE catalog_sales4.cs_item_sk \u003d item11.i_item_sk AND catalog_sales4.cs_sold_date_sk \u003d date_dim14.d_date_sk AND date_dim14.d_year \u003e\u003d 1999 AND date_dim14.d_year \u003c\u003d 1999 + 2)\nINTERSECT\nSELECT item12.i_brand_id AS I_BRAND_ID, item12.i_class_id AS I_CLASS_ID, item12.i_category_id AS I_CATEGORY_ID\nFROM web_sales AS web_sales4,\nitem AS item12,\ndate_dim AS date_dim15\nWHERE web_sales4.ws_item_sk \u003d item12.i_item_sk AND web_sales4.ws_sold_date_sk \u003d date_dim15.d_date_sk AND date_dim15.d_year \u003e\u003d 1999 AND date_dim15.d_year \u003c\u003d 1999 + 2) AS t63\nWHERE item9.i_brand_id \u003d t63.BRAND_ID AND item9.i_class_id \u003d t63.CLASS_ID AND item9.i_category_id \u003d t63.CATEGORY_ID\nGROUP BY item9.i_item_sk) AS t66 ON web_sales3.ws_item_sk \u003d t66.SS_ITEM_SK) AS t67\nINNER JOIN item AS item13 ON t67.ws_item_sk \u003d item13.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d CAST(1999 + 2 AS BIGINT) AND d_moy \u003d 11) AS t68 ON t67.ws_sold_date_sk \u003d t68.d_date_sk\nGROUP BY item13.i_brand_id, item13.i_class_id, item13.i_category_id) AS t70\nLEFT JOIN (SELECT AVG(QUANTITY * LIST_PRICE) AS AVERAGE_SALES\nFROM (SELECT *\nFROM (SELECT store_sales5.ss_quantity AS QUANTITY, store_sales5.ss_list_price AS LIST_PRICE\nFROM store_sales AS store_sales5,\ndate_dim AS date_dim17\nWHERE store_sales5.ss_sold_date_sk \u003d date_dim17.d_date_sk AND date_dim17.d_year \u003e\u003d 1999 AND date_dim17.d_year \u003c\u003d 1999 + 2\nUNION ALL\nSELECT catalog_sales5.cs_quantity AS QUANTITY, catalog_sales5.cs_list_price AS LIST_PRICE\nFROM catalog_sales AS catalog_sales5,\ndate_dim AS date_dim18\nWHERE catalog_sales5.cs_sold_date_sk \u003d date_dim18.d_date_sk AND date_dim18.d_year \u003e\u003d 1999 AND date_dim18.d_year \u003c\u003d 1999 + 2)\nUNION ALL\nSELECT web_sales5.ws_quantity AS QUANTITY, web_sales5.ws_list_price AS LIST_PRICE\nFROM web_sales AS web_sales5,\ndate_dim AS date_dim19\nWHERE web_sales5.ws_sold_date_sk \u003d date_dim19.d_date_sk AND date_dim19.d_year \u003e\u003d 1999 AND date_dim19.d_year \u003c\u003d 1999 + 2) AS t78) AS t81 ON TRUE\nWHERE t70.SALES \u003e t81.AVERAGE_SALES) AS t84\nGROUP BY ROLLUP(CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID)\nORDER BY CHANNEL NULLS FIRST, I_BRAND_ID NULLS FIRST, I_CLASS_ID NULLS FIRST, I_CATEGORY_ID NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    338,
    350
  ],
  "optimizedTimesMs": [
    336,
    340
  ],
  "originalAvgMs": 344,
  "optimizedAvgMs": 338,
  "speedup": 1.017751479289941,
  "originalRowCount": 100,
  "optimizedRowCount": 100,
  "validationPassed": true,
  "originalPlanMaxRows": 5037465,
  "optimizedPlanMaxRows": 2878107
}