{
  "query": "q78",
  "status": "pending",
  "rules": [
    "FILTER_INTO_JOIN",
    "FILTER_PROJECT_TRANSPOSE",
    "FILTER_SCAN",
    "PROJECT_MERGE",
    "FILTER_AGGREGATE_TRANSPOSE",
    "AGGREGATE_PROJECT_MERGE",
    "SORT_PROJECT_TRANSPOSE"
  ],
  "optimizedSql": "SELECT t3.SS_SOLD_YEAR, t3.SS_ITEM_SK, t3.SS_CUSTOMER_SK, ROUND(CAST(t3.SS_QTY AS DECIMAL(19, 2)) / (CASE WHEN t7.WS_QTY IS NOT NULL THEN CAST(t7.WS_QTY AS BIGINT) ELSE 0 END + CASE WHEN t11.CS_QTY IS NOT NULL THEN CAST(t11.CS_QTY AS BIGINT) ELSE 0 END), 2) AS RATIO, t3.SS_QTY AS STORE_QTY, t3.SS_WC AS STORE_WHOLESALE_COST, t3.SS_SP AS STORE_SALES_PRICE, CASE WHEN t7.WS_QTY IS NOT NULL THEN CAST(t7.WS_QTY AS BIGINT) ELSE 0 END + CASE WHEN t11.CS_QTY IS NOT NULL THEN CAST(t11.CS_QTY AS BIGINT) ELSE 0 END AS OTHER_CHAN_QTY, CASE WHEN t7.WS_WC IS NOT NULL THEN CAST(t7.WS_WC AS DECIMAL(19, 0)) ELSE 0 END + CASE WHEN t11.CS_WC IS NOT NULL THEN CAST(t11.CS_WC AS DECIMAL(19, 0)) ELSE 0 END AS OTHER_CHAN_WHOLESALE_COST, CASE WHEN t7.WS_SP IS NOT NULL THEN CAST(t7.WS_SP AS DECIMAL(19, 0)) ELSE 0 END + CASE WHEN t11.CS_SP IS NOT NULL THEN CAST(t11.CS_SP AS DECIMAL(19, 0)) ELSE 0 END AS OTHER_CHAN_SALES_PRICE\nFROM (SELECT d_year AS SS_SOLD_YEAR, ss_item_sk AS SS_ITEM_SK, ss_customer_sk AS SS_CUSTOMER_SK, SUM(ss_quantity) AS SS_QTY, SUM(ss_wholesale_cost) AS SS_WC, SUM(ss_sales_price) AS SS_SP\nFROM (SELECT date_dim.d_year, t.ss_item_sk, t.ss_customer_sk, t.ss_quantity, t.ss_wholesale_cost, t.ss_sales_price\nFROM (SELECT *\nFROM store_sales\nLEFT JOIN store_returns ON store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number AND store_sales.ss_item_sk \u003d store_returns.sr_item_sk\nWHERE store_returns.sr_ticket_number IS NULL) AS t\nINNER JOIN date_dim ON t.ss_sold_date_sk \u003d date_dim.d_date_sk) AS t0\nWHERE t0.d_year \u003d 2000\nGROUP BY d_year, ss_item_sk, ss_customer_sk) AS t3\nLEFT JOIN (SELECT date_dim0.d_year AS WS_SOLD_YEAR, t4.ws_item_sk AS WS_ITEM_SK, t4.ws_bill_customer_sk AS WS_CUSTOMER_SK, SUM(t4.ws_quantity) AS WS_QTY, SUM(t4.ws_wholesale_cost) AS WS_WC, SUM(t4.ws_sales_price) AS WS_SP\nFROM (SELECT *\nFROM web_sales\nLEFT JOIN web_returns ON web_sales.ws_order_number \u003d web_returns.wr_order_number AND web_sales.ws_item_sk \u003d web_returns.wr_item_sk\nWHERE web_returns.wr_order_number IS NULL) AS t4\nINNER JOIN date_dim AS date_dim0 ON t4.ws_sold_date_sk \u003d date_dim0.d_date_sk\nGROUP BY t4.ws_item_sk, t4.ws_bill_customer_sk, date_dim0.d_year) AS t7 ON t3.SS_SOLD_YEAR \u003d t7.WS_SOLD_YEAR AND t3.SS_ITEM_SK \u003d t7.WS_ITEM_SK AND t3.SS_CUSTOMER_SK \u003d t7.WS_CUSTOMER_SK\nLEFT JOIN (SELECT date_dim1.d_year AS CS_SOLD_YEAR, t8.cs_item_sk AS CS_ITEM_SK, t8.cs_bill_customer_sk AS CS_CUSTOMER_SK, SUM(t8.cs_quantity) AS CS_QTY, SUM(t8.cs_wholesale_cost) AS CS_WC, SUM(t8.cs_sales_price) AS CS_SP\nFROM (SELECT *\nFROM catalog_sales\nLEFT JOIN catalog_returns ON catalog_sales.cs_order_number \u003d catalog_returns.cr_order_number AND catalog_sales.cs_item_sk \u003d catalog_returns.cr_item_sk\nWHERE catalog_returns.cr_order_number IS NULL) AS t8\nINNER JOIN date_dim AS date_dim1 ON t8.cs_sold_date_sk \u003d date_dim1.d_date_sk\nGROUP BY t8.cs_bill_customer_sk, t8.cs_item_sk, date_dim1.d_year) AS t11 ON t3.SS_SOLD_YEAR \u003d t11.CS_SOLD_YEAR AND t3.SS_ITEM_SK \u003d t11.CS_ITEM_SK AND t3.SS_CUSTOMER_SK \u003d t11.CS_CUSTOMER_SK\nWHERE CASE WHEN t7.WS_QTY IS NOT NULL THEN CAST(t7.WS_QTY AS BIGINT) ELSE 0 END \u003e 0 OR CASE WHEN t11.CS_QTY IS NOT NULL THEN CAST(t11.CS_QTY AS BIGINT) ELSE 0 END \u003e 0\nORDER BY t3.SS_SOLD_YEAR, t3.SS_ITEM_SK, t3.SS_CUSTOMER_SK, t3.SS_QTY DESC, t3.SS_WC DESC, t3.SS_SP DESC, 8, 9, 10, 4\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    88,
    82
  ],
  "optimizedTimesMs": [
    266,
    254
  ],
  "originalAvgMs": 85,
  "optimizedAvgMs": 260,
  "speedup": 0.3269230769230769,
  "originalRowCount": 1,
  "optimizedRowCount": 1,
  "validationPassed": false,
  "originalPlanMaxRows": 2878107,
  "optimizedPlanMaxRows": 2878107
}