SELECT t22.PRODUCT_NAME, t22.STORE_NAME, t22.STORE_ZIP, t22.B_STREET_NUMBER, t22.B_STREET_NAME, t22.B_CITY, t22.B_ZIP, t22.C_STREET_NUMBER, t22.C_STREET_NAME, t22.C_CITY, t22.C_ZIP, t22.SYEAR AS CS1SYEAR, t22.CNT AS CS1CNT, t22.S1 AS S11, t22.S2 AS S21, t22.S3 AS S31, t46.S1 AS S12, t46.S2 AS S22, t46.S3 AS S32, t46.SYEAR, t46.CNT
FROM (SELECT t.i_product_name AS PRODUCT_NAME, t.i_item_sk AS ITEM_SK, t17.s_store_name AS STORE_NAME, t17.s_zip AS STORE_ZIP, t17.ca_street_number AS B_STREET_NUMBER, t17.ca_street_name AS B_STREET_NAME, t17.ca_city AS B_CITY, t17.ca_zip AS B_ZIP, t17.ca_street_number0 AS C_STREET_NUMBER, t17.ca_street_name0 AS C_STREET_NAME, t17.ca_city0 AS C_CITY, t17.ca_zip0 AS C_ZIP, t17.d_year AS SYEAR, t17.d_year0 AS FSYEAR, t17.d_year1 AS S2YEAR, COUNT(*) AS CNT, SUM(t17.ss_wholesale_cost) AS S1, SUM(t17.ss_list_price) AS S2, SUM(t17.ss_coupon_amt) AS S3
FROM (SELECT *
FROM item
WHERE i_color IN ('burlywood', 'floral', 'indian', 'medium', 'purple', 'spring') AND i_current_price >= 64 AND i_current_price <= 64 + 10 AND i_current_price >= 64 + 1 AND i_current_price <= 64 + 15) AS t
INNER JOIN (SELECT t16.ss_sold_date_sk, t16.ss_sold_time_sk, t16.ss_item_sk, t16.ss_customer_sk, t16.ss_cdemo_sk, t16.ss_hdemo_sk, t16.ss_addr_sk, t16.ss_store_sk, t16.ss_promo_sk, t16.ss_ticket_number, t16.ss_quantity, t16.ss_wholesale_cost, t16.ss_list_price, t16.ss_sales_price, t16.ss_ext_discount_amt, t16.ss_ext_sales_price, t16.ss_ext_wholesale_cost, t16.ss_ext_list_price, t16.ss_ext_tax, t16.ss_coupon_amt, t16.ss_net_paid, t16.ss_net_paid_inc_tax, t16.ss_net_profit, t16.sr_returned_date_sk, t16.sr_return_time_sk, t16.sr_item_sk, t16.sr_customer_sk, t16.sr_cdemo_sk, t16.sr_hdemo_sk, t16.sr_addr_sk, t16.sr_store_sk, t16.sr_reason_sk, t16.sr_ticket_number, t16.sr_return_quantity, t16.sr_return_amt, t16.sr_return_tax, t16.sr_return_amt_inc_tax, t16.sr_fee, t16.sr_return_ship_cost, t16.sr_refunded_cash, t16.sr_reversed_charge, t16.sr_store_credit, t16.sr_net_loss, t16.CS_ITEM_SK, t16.SALE, t16.REFUND, t16.d_date_sk, t16.d_date_id, t16.d_date, t16.d_month_seq, t16.d_week_seq, t16.d_quarter_seq, t16.d_year, t16.d_dow, t16.d_moy, t16.d_dom, t16.d_qoy, t16.d_fy_year, t16.d_fy_quarter_seq, t16.d_fy_week_seq, t16.d_day_name, t16.d_quarter_name, t16.d_holiday, t16.d_weekend, t16.d_following_holiday, t16.d_first_dom, t16.d_last_dom, t16.d_same_day_ly, t16.d_same_day_lq, t16.d_current_day, t16.d_current_week, t16.d_current_month, t16.d_current_quarter, t16.d_current_year, t16.d_date_sk0, t16.d_date_id0, t16.d_date0, t16.d_month_seq0, t16.d_week_seq0, t16.d_quarter_seq0, t16.d_year0, t16.d_dow0, t16.d_moy0, t16.d_dom0, t16.d_qoy0, t16.d_fy_year0, t16.d_fy_quarter_seq0, t16.d_fy_week_seq0, t16.d_day_name0, t16.d_quarter_name0, t16.d_holiday0, t16.d_weekend0, t16.d_following_holiday0, t16.d_first_dom0, t16.d_last_dom0, t16.d_same_day_ly0, t16.d_same_day_lq0, t16.d_current_day0, t16.d_current_week0, t16.d_current_month0, t16.d_current_quarter0, t16.d_current_year0, t16.d_date_sk1, t16.d_date_id1, t16.d_date1, t16.d_month_seq1, t16.d_week_seq1, t16.d_quarter_seq1, t16.d_year1, t16.d_dow1, t16.d_moy1, t16.d_dom1, t16.d_qoy1, t16.d_fy_year1, t16.d_fy_quarter_seq1, t16.d_fy_week_seq1, t16.d_day_name1, t16.d_quarter_name1, t16.d_holiday1, t16.d_weekend1, t16.d_following_holiday1, t16.d_first_dom1, t16.d_last_dom1, t16.d_same_day_ly1, t16.d_same_day_lq1, t16.d_current_day1, t16.d_current_week1, t16.d_current_month1, t16.d_current_quarter1, t16.d_current_year1, t16.s_store_sk, t16.s_store_id, t16.s_rec_start_date, t16.s_rec_end_date, t16.s_closed_date_sk, t16.s_store_name, t16.s_number_employees, t16.s_floor_space, t16.s_hours, t16.s_manager, t16.s_market_id, t16.s_geography_class, t16.s_market_desc, t16.s_market_manager, t16.s_division_id, t16.s_division_name, t16.s_company_id, t16.s_company_name, t16.s_street_number, t16.s_street_name, t16.s_street_type, t16.s_suite_number, t16.s_city, t16.s_county, t16.s_state, t16.s_zip, t16.s_country, t16.s_gmt_offset, t16.s_tax_percentage, t16.c_customer_sk, t16.c_customer_id, t16.c_current_cdemo_sk, t16.c_current_hdemo_sk, t16.c_current_addr_sk, t16.c_first_shipto_date_sk, t16.c_first_sales_date_sk, t16.c_salutation, t16.c_first_name, t16.c_last_name, t16.c_preferred_cust_flag, t16.c_birth_day, t16.c_birth_month, t16.c_birth_year, t16.c_birth_country, t16.c_login, t16.c_email_address, t16.c_last_review_date_sk, t16.cd_demo_sk, t16.cd_gender, t16.cd_marital_status, t16.cd_education_status, t16.cd_purchase_estimate, t16.cd_credit_rating, t16.cd_dep_count, t16.cd_dep_employed_count, t16.cd_dep_college_count, t16.cd_demo_sk0, t16.cd_gender0, t16.cd_marital_status0, t16.cd_education_status0, t16.cd_purchase_estimate0, t16.cd_credit_rating0, t16.cd_dep_count0, t16.cd_dep_employed_count0, t16.cd_dep_college_count0, t16.p_promo_sk, t16.p_promo_id, t16.p_start_date_sk, t16.p_end_date_sk, t16.p_item_sk, t16.p_cost, t16.p_response_target, t16.p_promo_name, t16.p_channel_dmail, t16.p_channel_email, t16.p_channel_catalog, t16.p_channel_tv, t16.p_channel_radio, t16.p_channel_press, t16.p_channel_event, t16.p_channel_demo, t16.p_channel_details, t16.p_purpose, t16.p_discount_active, t16.hd_demo_sk, t16.hd_income_band_sk, t16.hd_buy_potential, t16.hd_dep_count, t16.hd_vehicle_count, t16.hd_demo_sk0, t16.hd_income_band_sk0, t16.hd_buy_potential0, t16.hd_dep_count0, t16.hd_vehicle_count0, t16.ca_address_sk, t16.ca_address_id, t16.ca_street_number, t16.ca_street_name, t16.ca_street_type, t16.ca_suite_number, t16.ca_city, t16.ca_county, t16.ca_state, t16.ca_zip, t16.ca_country, t16.ca_gmt_offset, t16.ca_location_type, t16.ca_address_sk0, t16.ca_address_id0, t16.ca_street_number0, t16.ca_street_name0, t16.ca_street_type0, t16.ca_suite_number0, t16.ca_city0, t16.ca_county0, t16.ca_state0, t16.ca_zip0, t16.ca_country0, t16.ca_gmt_offset0, t16.ca_location_type0, t16.ib_income_band_sk, t16.ib_lower_bound, t16.ib_upper_bound, income_band.ib_income_band_sk AS ib_income_band_sk0, income_band.ib_lower_bound AS ib_lower_bound0, income_band.ib_upper_bound AS ib_upper_bound0
FROM income_band
INNER JOIN (SELECT t15.ss_sold_date_sk, t15.ss_sold_time_sk, t15.ss_item_sk, t15.ss_customer_sk, t15.ss_cdemo_sk, t15.ss_hdemo_sk, t15.ss_addr_sk, t15.ss_store_sk, t15.ss_promo_sk, t15.ss_ticket_number, t15.ss_quantity, t15.ss_wholesale_cost, t15.ss_list_price, t15.ss_sales_price, t15.ss_ext_discount_amt, t15.ss_ext_sales_price, t15.ss_ext_wholesale_cost, t15.ss_ext_list_price, t15.ss_ext_tax, t15.ss_coupon_amt, t15.ss_net_paid, t15.ss_net_paid_inc_tax, t15.ss_net_profit, t15.sr_returned_date_sk, t15.sr_return_time_sk, t15.sr_item_sk, t15.sr_customer_sk, t15.sr_cdemo_sk, t15.sr_hdemo_sk, t15.sr_addr_sk, t15.sr_store_sk, t15.sr_reason_sk, t15.sr_ticket_number, t15.sr_return_quantity, t15.sr_return_amt, t15.sr_return_tax, t15.sr_return_amt_inc_tax, t15.sr_fee, t15.sr_return_ship_cost, t15.sr_refunded_cash, t15.sr_reversed_charge, t15.sr_store_credit, t15.sr_net_loss, t15.CS_ITEM_SK, t15.SALE, t15.REFUND, t15.d_date_sk, t15.d_date_id, t15.d_date, t15.d_month_seq, t15.d_week_seq, t15.d_quarter_seq, t15.d_year, t15.d_dow, t15.d_moy, t15.d_dom, t15.d_qoy, t15.d_fy_year, t15.d_fy_quarter_seq, t15.d_fy_week_seq, t15.d_day_name, t15.d_quarter_name, t15.d_holiday, t15.d_weekend, t15.d_following_holiday, t15.d_first_dom, t15.d_last_dom, t15.d_same_day_ly, t15.d_same_day_lq, t15.d_current_day, t15.d_current_week, t15.d_current_month, t15.d_current_quarter, t15.d_current_year, t15.d_date_sk0, t15.d_date_id0, t15.d_date0, t15.d_month_seq0, t15.d_week_seq0, t15.d_quarter_seq0, t15.d_year0, t15.d_dow0, t15.d_moy0, t15.d_dom0, t15.d_qoy0, t15.d_fy_year0, t15.d_fy_quarter_seq0, t15.d_fy_week_seq0, t15.d_day_name0, t15.d_quarter_name0, t15.d_holiday0, t15.d_weekend0, t15.d_following_holiday0, t15.d_first_dom0, t15.d_last_dom0, t15.d_same_day_ly0, t15.d_same_day_lq0, t15.d_current_day0, t15.d_current_week0, t15.d_current_month0, t15.d_current_quarter0, t15.d_current_year0, t15.d_date_sk1, t15.d_date_id1, t15.d_date1, t15.d_month_seq1, t15.d_week_seq1, t15.d_quarter_seq1, t15.d_year1, t15.d_dow1, t15.d_moy1, t15.d_dom1, t15.d_qoy1, t15.d_fy_year1, t15.d_fy_quarter_seq1, t15.d_fy_week_seq1, t15.d_day_name1, t15.d_quarter_name1, t15.d_holiday1, t15.d_weekend1, t15.d_following_holiday1, t15.d_first_dom1, t15.d_last_dom1, t15.d_same_day_ly1, t15.d_same_day_lq1, t15.d_current_day1, t15.d_current_week1, t15.d_current_month1, t15.d_current_quarter1, t15.d_current_year1, t15.s_store_sk, t15.s_store_id, t15.s_rec_start_date, t15.s_rec_end_date, t15.s_closed_date_sk, t15.s_store_name, t15.s_number_employees, t15.s_floor_space, t15.s_hours, t15.s_manager, t15.s_market_id, t15.s_geography_class, t15.s_market_desc, t15.s_market_manager, t15.s_division_id, t15.s_division_name, t15.s_company_id, t15.s_company_name, t15.s_street_number, t15.s_street_name, t15.s_street_type, t15.s_suite_number, t15.s_city, t15.s_county, t15.s_state, t15.s_zip, t15.s_country, t15.s_gmt_offset, t15.s_tax_percentage, t15.c_customer_sk, t15.c_customer_id, t15.c_current_cdemo_sk, t15.c_current_hdemo_sk, t15.c_current_addr_sk, t15.c_first_shipto_date_sk, t15.c_first_sales_date_sk, t15.c_salutation, t15.c_first_name, t15.c_last_name, t15.c_preferred_cust_flag, t15.c_birth_day, t15.c_birth_month, t15.c_birth_year, t15.c_birth_country, t15.c_login, t15.c_email_address, t15.c_last_review_date_sk, t15.cd_demo_sk, t15.cd_gender, t15.cd_marital_status, t15.cd_education_status, t15.cd_purchase_estimate, t15.cd_credit_rating, t15.cd_dep_count, t15.cd_dep_employed_count, t15.cd_dep_college_count, t15.cd_demo_sk0, t15.cd_gender0, t15.cd_marital_status0, t15.cd_education_status0, t15.cd_purchase_estimate0, t15.cd_credit_rating0, t15.cd_dep_count0, t15.cd_dep_employed_count0, t15.cd_dep_college_count0, t15.p_promo_sk, t15.p_promo_id, t15.p_start_date_sk, t15.p_end_date_sk, t15.p_item_sk, t15.p_cost, t15.p_response_target, t15.p_promo_name, t15.p_channel_dmail, t15.p_channel_email, t15.p_channel_catalog, t15.p_channel_tv, t15.p_channel_radio, t15.p_channel_press, t15.p_channel_event, t15.p_channel_demo, t15.p_channel_details, t15.p_purpose, t15.p_discount_active, t15.hd_demo_sk, t15.hd_income_band_sk, t15.hd_buy_potential, t15.hd_dep_count, t15.hd_vehicle_count, t15.hd_demo_sk0, t15.hd_income_band_sk0, t15.hd_buy_potential0, t15.hd_dep_count0, t15.hd_vehicle_count0, t15.ca_address_sk, t15.ca_address_id, t15.ca_street_number, t15.ca_street_name, t15.ca_street_type, t15.ca_suite_number, t15.ca_city, t15.ca_county, t15.ca_state, t15.ca_zip, t15.ca_country, t15.ca_gmt_offset, t15.ca_location_type, t15.ca_address_sk0, t15.ca_address_id0, t15.ca_street_number0, t15.ca_street_name0, t15.ca_street_type0, t15.ca_suite_number0, t15.ca_city0, t15.ca_county0, t15.ca_state0, t15.ca_zip0, t15.ca_country0, t15.ca_gmt_offset0, t15.ca_location_type0, income_band0.ib_income_band_sk, income_band0.ib_lower_bound, income_band0.ib_upper_bound
FROM income_band AS income_band0
INNER JOIN (SELECT t14.ss_sold_date_sk, t14.ss_sold_time_sk, t14.ss_item_sk, t14.ss_customer_sk, t14.ss_cdemo_sk, t14.ss_hdemo_sk, t14.ss_addr_sk, t14.ss_store_sk, t14.ss_promo_sk, t14.ss_ticket_number, t14.ss_quantity, t14.ss_wholesale_cost, t14.ss_list_price, t14.ss_sales_price, t14.ss_ext_discount_amt, t14.ss_ext_sales_price, t14.ss_ext_wholesale_cost, t14.ss_ext_list_price, t14.ss_ext_tax, t14.ss_coupon_amt, t14.ss_net_paid, t14.ss_net_paid_inc_tax, t14.ss_net_profit, t14.sr_returned_date_sk, t14.sr_return_time_sk, t14.sr_item_sk, t14.sr_customer_sk, t14.sr_cdemo_sk, t14.sr_hdemo_sk, t14.sr_addr_sk, t14.sr_store_sk, t14.sr_reason_sk, t14.sr_ticket_number, t14.sr_return_quantity, t14.sr_return_amt, t14.sr_return_tax, t14.sr_return_amt_inc_tax, t14.sr_fee, t14.sr_return_ship_cost, t14.sr_refunded_cash, t14.sr_reversed_charge, t14.sr_store_credit, t14.sr_net_loss, t14.CS_ITEM_SK, t14.SALE, t14.REFUND, t14.d_date_sk, t14.d_date_id, t14.d_date, t14.d_month_seq, t14.d_week_seq, t14.d_quarter_seq, t14.d_year, t14.d_dow, t14.d_moy, t14.d_dom, t14.d_qoy, t14.d_fy_year, t14.d_fy_quarter_seq, t14.d_fy_week_seq, t14.d_day_name, t14.d_quarter_name, t14.d_holiday, t14.d_weekend, t14.d_following_holiday, t14.d_first_dom, t14.d_last_dom, t14.d_same_day_ly, t14.d_same_day_lq, t14.d_current_day, t14.d_current_week, t14.d_current_month, t14.d_current_quarter, t14.d_current_year, t14.d_date_sk0, t14.d_date_id0, t14.d_date0, t14.d_month_seq0, t14.d_week_seq0, t14.d_quarter_seq0, t14.d_year0, t14.d_dow0, t14.d_moy0, t14.d_dom0, t14.d_qoy0, t14.d_fy_year0, t14.d_fy_quarter_seq0, t14.d_fy_week_seq0, t14.d_day_name0, t14.d_quarter_name0, t14.d_holiday0, t14.d_weekend0, t14.d_following_holiday0, t14.d_first_dom0, t14.d_last_dom0, t14.d_same_day_ly0, t14.d_same_day_lq0, t14.d_current_day0, t14.d_current_week0, t14.d_current_month0, t14.d_current_quarter0, t14.d_current_year0, t14.d_date_sk1, t14.d_date_id1, t14.d_date1, t14.d_month_seq1, t14.d_week_seq1, t14.d_quarter_seq1, t14.d_year1, t14.d_dow1, t14.d_moy1, t14.d_dom1, t14.d_qoy1, t14.d_fy_year1, t14.d_fy_quarter_seq1, t14.d_fy_week_seq1, t14.d_day_name1, t14.d_quarter_name1, t14.d_holiday1, t14.d_weekend1, t14.d_following_holiday1, t14.d_first_dom1, t14.d_last_dom1, t14.d_same_day_ly1, t14.d_same_day_lq1, t14.d_current_day1, t14.d_current_week1, t14.d_current_month1, t14.d_current_quarter1, t14.d_current_year1, t14.s_store_sk, t14.s_store_id, t14.s_rec_start_date, t14.s_rec_end_date, t14.s_closed_date_sk, t14.s_store_name, t14.s_number_employees, t14.s_floor_space, t14.s_hours, t14.s_manager, t14.s_market_id, t14.s_geography_class, t14.s_market_desc, t14.s_market_manager, t14.s_division_id, t14.s_division_name, t14.s_company_id, t14.s_company_name, t14.s_street_number, t14.s_street_name, t14.s_street_type, t14.s_suite_number, t14.s_city, t14.s_county, t14.s_state, t14.s_zip, t14.s_country, t14.s_gmt_offset, t14.s_tax_percentage, t14.c_customer_sk, t14.c_customer_id, t14.c_current_cdemo_sk, t14.c_current_hdemo_sk, t14.c_current_addr_sk, t14.c_first_shipto_date_sk, t14.c_first_sales_date_sk, t14.c_salutation, t14.c_first_name, t14.c_last_name, t14.c_preferred_cust_flag, t14.c_birth_day, t14.c_birth_month, t14.c_birth_year, t14.c_birth_country, t14.c_login, t14.c_email_address, t14.c_last_review_date_sk, t14.cd_demo_sk, t14.cd_gender, t14.cd_marital_status, t14.cd_education_status, t14.cd_purchase_estimate, t14.cd_credit_rating, t14.cd_dep_count, t14.cd_dep_employed_count, t14.cd_dep_college_count, t14.cd_demo_sk0, t14.cd_gender0, t14.cd_marital_status0, t14.cd_education_status0, t14.cd_purchase_estimate0, t14.cd_credit_rating0, t14.cd_dep_count0, t14.cd_dep_employed_count0, t14.cd_dep_college_count0, t14.p_promo_sk, t14.p_promo_id, t14.p_start_date_sk, t14.p_end_date_sk, t14.p_item_sk, t14.p_cost, t14.p_response_target, t14.p_promo_name, t14.p_channel_dmail, t14.p_channel_email, t14.p_channel_catalog, t14.p_channel_tv, t14.p_channel_radio, t14.p_channel_press, t14.p_channel_event, t14.p_channel_demo, t14.p_channel_details, t14.p_purpose, t14.p_discount_active, t14.hd_demo_sk, t14.hd_income_band_sk, t14.hd_buy_potential, t14.hd_dep_count, t14.hd_vehicle_count, t14.hd_demo_sk0, t14.hd_income_band_sk0, t14.hd_buy_potential0, t14.hd_dep_count0, t14.hd_vehicle_count0, t14.ca_address_sk, t14.ca_address_id, t14.ca_street_number, t14.ca_street_name, t14.ca_street_type, t14.ca_suite_number, t14.ca_city, t14.ca_county, t14.ca_state, t14.ca_zip, t14.ca_country, t14.ca_gmt_offset, t14.ca_location_type, customer_address.ca_address_sk AS ca_address_sk0, customer_address.ca_address_id AS ca_address_id0, customer_address.ca_street_number AS ca_street_number0, customer_address.ca_street_name AS ca_street_name0, customer_address.ca_street_type AS ca_street_type0, customer_address.ca_suite_number AS ca_suite_number0, customer_address.ca_city AS ca_city0, customer_address.ca_county AS ca_county0, customer_address.ca_state AS ca_state0, customer_address.ca_zip AS ca_zip0, customer_address.ca_country AS ca_country0, customer_address.ca_gmt_offset AS ca_gmt_offset0, customer_address.ca_location_type AS ca_location_type0
FROM customer_address
INNER JOIN (SELECT t13.ss_sold_date_sk, t13.ss_sold_time_sk, t13.ss_item_sk, t13.ss_customer_sk, t13.ss_cdemo_sk, t13.ss_hdemo_sk, t13.ss_addr_sk, t13.ss_store_sk, t13.ss_promo_sk, t13.ss_ticket_number, t13.ss_quantity, t13.ss_wholesale_cost, t13.ss_list_price, t13.ss_sales_price, t13.ss_ext_discount_amt, t13.ss_ext_sales_price, t13.ss_ext_wholesale_cost, t13.ss_ext_list_price, t13.ss_ext_tax, t13.ss_coupon_amt, t13.ss_net_paid, t13.ss_net_paid_inc_tax, t13.ss_net_profit, t13.sr_returned_date_sk, t13.sr_return_time_sk, t13.sr_item_sk, t13.sr_customer_sk, t13.sr_cdemo_sk, t13.sr_hdemo_sk, t13.sr_addr_sk, t13.sr_store_sk, t13.sr_reason_sk, t13.sr_ticket_number, t13.sr_return_quantity, t13.sr_return_amt, t13.sr_return_tax, t13.sr_return_amt_inc_tax, t13.sr_fee, t13.sr_return_ship_cost, t13.sr_refunded_cash, t13.sr_reversed_charge, t13.sr_store_credit, t13.sr_net_loss, t13.CS_ITEM_SK, t13.SALE, t13.REFUND, t13.d_date_sk, t13.d_date_id, t13.d_date, t13.d_month_seq, t13.d_week_seq, t13.d_quarter_seq, t13.d_year, t13.d_dow, t13.d_moy, t13.d_dom, t13.d_qoy, t13.d_fy_year, t13.d_fy_quarter_seq, t13.d_fy_week_seq, t13.d_day_name, t13.d_quarter_name, t13.d_holiday, t13.d_weekend, t13.d_following_holiday, t13.d_first_dom, t13.d_last_dom, t13.d_same_day_ly, t13.d_same_day_lq, t13.d_current_day, t13.d_current_week, t13.d_current_month, t13.d_current_quarter, t13.d_current_year, t13.d_date_sk0, t13.d_date_id0, t13.d_date0, t13.d_month_seq0, t13.d_week_seq0, t13.d_quarter_seq0, t13.d_year0, t13.d_dow0, t13.d_moy0, t13.d_dom0, t13.d_qoy0, t13.d_fy_year0, t13.d_fy_quarter_seq0, t13.d_fy_week_seq0, t13.d_day_name0, t13.d_quarter_name0, t13.d_holiday0, t13.d_weekend0, t13.d_following_holiday0, t13.d_first_dom0, t13.d_last_dom0, t13.d_same_day_ly0, t13.d_same_day_lq0, t13.d_current_day0, t13.d_current_week0, t13.d_current_month0, t13.d_current_quarter0, t13.d_current_year0, t13.d_date_sk1, t13.d_date_id1, t13.d_date1, t13.d_month_seq1, t13.d_week_seq1, t13.d_quarter_seq1, t13.d_year1, t13.d_dow1, t13.d_moy1, t13.d_dom1, t13.d_qoy1, t13.d_fy_year1, t13.d_fy_quarter_seq1, t13.d_fy_week_seq1, t13.d_day_name1, t13.d_quarter_name1, t13.d_holiday1, t13.d_weekend1, t13.d_following_holiday1, t13.d_first_dom1, t13.d_last_dom1, t13.d_same_day_ly1, t13.d_same_day_lq1, t13.d_current_day1, t13.d_current_week1, t13.d_current_month1, t13.d_current_quarter1, t13.d_current_year1, t13.s_store_sk, t13.s_store_id, t13.s_rec_start_date, t13.s_rec_end_date, t13.s_closed_date_sk, t13.s_store_name, t13.s_number_employees, t13.s_floor_space, t13.s_hours, t13.s_manager, t13.s_market_id, t13.s_geography_class, t13.s_market_desc, t13.s_market_manager, t13.s_division_id, t13.s_division_name, t13.s_company_id, t13.s_company_name, t13.s_street_number, t13.s_street_name, t13.s_street_type, t13.s_suite_number, t13.s_city, t13.s_county, t13.s_state, t13.s_zip, t13.s_country, t13.s_gmt_offset, t13.s_tax_percentage, t13.c_customer_sk, t13.c_customer_id, t13.c_current_cdemo_sk, t13.c_current_hdemo_sk, t13.c_current_addr_sk, t13.c_first_shipto_date_sk, t13.c_first_sales_date_sk, t13.c_salutation, t13.c_first_name, t13.c_last_name, t13.c_preferred_cust_flag, t13.c_birth_day, t13.c_birth_month, t13.c_birth_year, t13.c_birth_country, t13.c_login, t13.c_email_address, t13.c_last_review_date_sk, t13.cd_demo_sk, t13.cd_gender, t13.cd_marital_status, t13.cd_education_status, t13.cd_purchase_estimate, t13.cd_credit_rating, t13.cd_dep_count, t13.cd_dep_employed_count, t13.cd_dep_college_count, t13.cd_demo_sk0, t13.cd_gender0, t13.cd_marital_status0, t13.cd_education_status0, t13.cd_purchase_estimate0, t13.cd_credit_rating0, t13.cd_dep_count0, t13.cd_dep_employed_count0, t13.cd_dep_college_count0, t13.p_promo_sk, t13.p_promo_id, t13.p_start_date_sk, t13.p_end_date_sk, t13.p_item_sk, t13.p_cost, t13.p_response_target, t13.p_promo_name, t13.p_channel_dmail, t13.p_channel_email, t13.p_channel_catalog, t13.p_channel_tv, t13.p_channel_radio, t13.p_channel_press, t13.p_channel_event, t13.p_channel_demo, t13.p_channel_details, t13.p_purpose, t13.p_discount_active, t13.hd_demo_sk, t13.hd_income_band_sk, t13.hd_buy_potential, t13.hd_dep_count, t13.hd_vehicle_count, t13.hd_demo_sk0, t13.hd_income_band_sk0, t13.hd_buy_potential0, t13.hd_dep_count0, t13.hd_vehicle_count0, customer_address0.ca_address_sk, customer_address0.ca_address_id, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_street_type, customer_address0.ca_suite_number, customer_address0.ca_city, customer_address0.ca_county, customer_address0.ca_state, customer_address0.ca_zip, customer_address0.ca_country, customer_address0.ca_gmt_offset, customer_address0.ca_location_type
FROM customer_address AS customer_address0
INNER JOIN (SELECT t12.ss_sold_date_sk, t12.ss_sold_time_sk, t12.ss_item_sk, t12.ss_customer_sk, t12.ss_cdemo_sk, t12.ss_hdemo_sk, t12.ss_addr_sk, t12.ss_store_sk, t12.ss_promo_sk, t12.ss_ticket_number, t12.ss_quantity, t12.ss_wholesale_cost, t12.ss_list_price, t12.ss_sales_price, t12.ss_ext_discount_amt, t12.ss_ext_sales_price, t12.ss_ext_wholesale_cost, t12.ss_ext_list_price, t12.ss_ext_tax, t12.ss_coupon_amt, t12.ss_net_paid, t12.ss_net_paid_inc_tax, t12.ss_net_profit, t12.sr_returned_date_sk, t12.sr_return_time_sk, t12.sr_item_sk, t12.sr_customer_sk, t12.sr_cdemo_sk, t12.sr_hdemo_sk, t12.sr_addr_sk, t12.sr_store_sk, t12.sr_reason_sk, t12.sr_ticket_number, t12.sr_return_quantity, t12.sr_return_amt, t12.sr_return_tax, t12.sr_return_amt_inc_tax, t12.sr_fee, t12.sr_return_ship_cost, t12.sr_refunded_cash, t12.sr_reversed_charge, t12.sr_store_credit, t12.sr_net_loss, t12.CS_ITEM_SK, t12.SALE, t12.REFUND, t12.d_date_sk, t12.d_date_id, t12.d_date, t12.d_month_seq, t12.d_week_seq, t12.d_quarter_seq, t12.d_year, t12.d_dow, t12.d_moy, t12.d_dom, t12.d_qoy, t12.d_fy_year, t12.d_fy_quarter_seq, t12.d_fy_week_seq, t12.d_day_name, t12.d_quarter_name, t12.d_holiday, t12.d_weekend, t12.d_following_holiday, t12.d_first_dom, t12.d_last_dom, t12.d_same_day_ly, t12.d_same_day_lq, t12.d_current_day, t12.d_current_week, t12.d_current_month, t12.d_current_quarter, t12.d_current_year, t12.d_date_sk0, t12.d_date_id0, t12.d_date0, t12.d_month_seq0, t12.d_week_seq0, t12.d_quarter_seq0, t12.d_year0, t12.d_dow0, t12.d_moy0, t12.d_dom0, t12.d_qoy0, t12.d_fy_year0, t12.d_fy_quarter_seq0, t12.d_fy_week_seq0, t12.d_day_name0, t12.d_quarter_name0, t12.d_holiday0, t12.d_weekend0, t12.d_following_holiday0, t12.d_first_dom0, t12.d_last_dom0, t12.d_same_day_ly0, t12.d_same_day_lq0, t12.d_current_day0, t12.d_current_week0, t12.d_current_month0, t12.d_current_quarter0, t12.d_current_year0, t12.d_date_sk1, t12.d_date_id1, t12.d_date1, t12.d_month_seq1, t12.d_week_seq1, t12.d_quarter_seq1, t12.d_year1, t12.d_dow1, t12.d_moy1, t12.d_dom1, t12.d_qoy1, t12.d_fy_year1, t12.d_fy_quarter_seq1, t12.d_fy_week_seq1, t12.d_day_name1, t12.d_quarter_name1, t12.d_holiday1, t12.d_weekend1, t12.d_following_holiday1, t12.d_first_dom1, t12.d_last_dom1, t12.d_same_day_ly1, t12.d_same_day_lq1, t12.d_current_day1, t12.d_current_week1, t12.d_current_month1, t12.d_current_quarter1, t12.d_current_year1, t12.s_store_sk, t12.s_store_id, t12.s_rec_start_date, t12.s_rec_end_date, t12.s_closed_date_sk, t12.s_store_name, t12.s_number_employees, t12.s_floor_space, t12.s_hours, t12.s_manager, t12.s_market_id, t12.s_geography_class, t12.s_market_desc, t12.s_market_manager, t12.s_division_id, t12.s_division_name, t12.s_company_id, t12.s_company_name, t12.s_street_number, t12.s_street_name, t12.s_street_type, t12.s_suite_number, t12.s_city, t12.s_county, t12.s_state, t12.s_zip, t12.s_country, t12.s_gmt_offset, t12.s_tax_percentage, t12.c_customer_sk, t12.c_customer_id, t12.c_current_cdemo_sk, t12.c_current_hdemo_sk, t12.c_current_addr_sk, t12.c_first_shipto_date_sk, t12.c_first_sales_date_sk, t12.c_salutation, t12.c_first_name, t12.c_last_name, t12.c_preferred_cust_flag, t12.c_birth_day, t12.c_birth_month, t12.c_birth_year, t12.c_birth_country, t12.c_login, t12.c_email_address, t12.c_last_review_date_sk, t12.cd_demo_sk, t12.cd_gender, t12.cd_marital_status, t12.cd_education_status, t12.cd_purchase_estimate, t12.cd_credit_rating, t12.cd_dep_count, t12.cd_dep_employed_count, t12.cd_dep_college_count, t12.cd_demo_sk0, t12.cd_gender0, t12.cd_marital_status0, t12.cd_education_status0, t12.cd_purchase_estimate0, t12.cd_credit_rating0, t12.cd_dep_count0, t12.cd_dep_employed_count0, t12.cd_dep_college_count0, t12.p_promo_sk, t12.p_promo_id, t12.p_start_date_sk, t12.p_end_date_sk, t12.p_item_sk, t12.p_cost, t12.p_response_target, t12.p_promo_name, t12.p_channel_dmail, t12.p_channel_email, t12.p_channel_catalog, t12.p_channel_tv, t12.p_channel_radio, t12.p_channel_press, t12.p_channel_event, t12.p_channel_demo, t12.p_channel_details, t12.p_purpose, t12.p_discount_active, t12.hd_demo_sk, t12.hd_income_band_sk, t12.hd_buy_potential, t12.hd_dep_count, t12.hd_vehicle_count, household_demographics.hd_demo_sk AS hd_demo_sk0, household_demographics.hd_income_band_sk AS hd_income_band_sk0, household_demographics.hd_buy_potential AS hd_buy_potential0, household_demographics.hd_dep_count AS hd_dep_count0, household_demographics.hd_vehicle_count AS hd_vehicle_count0
FROM household_demographics
INNER JOIN (SELECT t11.ss_sold_date_sk, t11.ss_sold_time_sk, t11.ss_item_sk, t11.ss_customer_sk, t11.ss_cdemo_sk, t11.ss_hdemo_sk, t11.ss_addr_sk, t11.ss_store_sk, t11.ss_promo_sk, t11.ss_ticket_number, t11.ss_quantity, t11.ss_wholesale_cost, t11.ss_list_price, t11.ss_sales_price, t11.ss_ext_discount_amt, t11.ss_ext_sales_price, t11.ss_ext_wholesale_cost, t11.ss_ext_list_price, t11.ss_ext_tax, t11.ss_coupon_amt, t11.ss_net_paid, t11.ss_net_paid_inc_tax, t11.ss_net_profit, t11.sr_returned_date_sk, t11.sr_return_time_sk, t11.sr_item_sk, t11.sr_customer_sk, t11.sr_cdemo_sk, t11.sr_hdemo_sk, t11.sr_addr_sk, t11.sr_store_sk, t11.sr_reason_sk, t11.sr_ticket_number, t11.sr_return_quantity, t11.sr_return_amt, t11.sr_return_tax, t11.sr_return_amt_inc_tax, t11.sr_fee, t11.sr_return_ship_cost, t11.sr_refunded_cash, t11.sr_reversed_charge, t11.sr_store_credit, t11.sr_net_loss, t11.CS_ITEM_SK, t11.SALE, t11.REFUND, t11.d_date_sk, t11.d_date_id, t11.d_date, t11.d_month_seq, t11.d_week_seq, t11.d_quarter_seq, t11.d_year, t11.d_dow, t11.d_moy, t11.d_dom, t11.d_qoy, t11.d_fy_year, t11.d_fy_quarter_seq, t11.d_fy_week_seq, t11.d_day_name, t11.d_quarter_name, t11.d_holiday, t11.d_weekend, t11.d_following_holiday, t11.d_first_dom, t11.d_last_dom, t11.d_same_day_ly, t11.d_same_day_lq, t11.d_current_day, t11.d_current_week, t11.d_current_month, t11.d_current_quarter, t11.d_current_year, t11.d_date_sk0, t11.d_date_id0, t11.d_date0, t11.d_month_seq0, t11.d_week_seq0, t11.d_quarter_seq0, t11.d_year0, t11.d_dow0, t11.d_moy0, t11.d_dom0, t11.d_qoy0, t11.d_fy_year0, t11.d_fy_quarter_seq0, t11.d_fy_week_seq0, t11.d_day_name0, t11.d_quarter_name0, t11.d_holiday0, t11.d_weekend0, t11.d_following_holiday0, t11.d_first_dom0, t11.d_last_dom0, t11.d_same_day_ly0, t11.d_same_day_lq0, t11.d_current_day0, t11.d_current_week0, t11.d_current_month0, t11.d_current_quarter0, t11.d_current_year0, t11.d_date_sk1, t11.d_date_id1, t11.d_date1, t11.d_month_seq1, t11.d_week_seq1, t11.d_quarter_seq1, t11.d_year1, t11.d_dow1, t11.d_moy1, t11.d_dom1, t11.d_qoy1, t11.d_fy_year1, t11.d_fy_quarter_seq1, t11.d_fy_week_seq1, t11.d_day_name1, t11.d_quarter_name1, t11.d_holiday1, t11.d_weekend1, t11.d_following_holiday1, t11.d_first_dom1, t11.d_last_dom1, t11.d_same_day_ly1, t11.d_same_day_lq1, t11.d_current_day1, t11.d_current_week1, t11.d_current_month1, t11.d_current_quarter1, t11.d_current_year1, t11.s_store_sk, t11.s_store_id, t11.s_rec_start_date, t11.s_rec_end_date, t11.s_closed_date_sk, t11.s_store_name, t11.s_number_employees, t11.s_floor_space, t11.s_hours, t11.s_manager, t11.s_market_id, t11.s_geography_class, t11.s_market_desc, t11.s_market_manager, t11.s_division_id, t11.s_division_name, t11.s_company_id, t11.s_company_name, t11.s_street_number, t11.s_street_name, t11.s_street_type, t11.s_suite_number, t11.s_city, t11.s_county, t11.s_state, t11.s_zip, t11.s_country, t11.s_gmt_offset, t11.s_tax_percentage, t11.c_customer_sk, t11.c_customer_id, t11.c_current_cdemo_sk, t11.c_current_hdemo_sk, t11.c_current_addr_sk, t11.c_first_shipto_date_sk, t11.c_first_sales_date_sk, t11.c_salutation, t11.c_first_name, t11.c_last_name, t11.c_preferred_cust_flag, t11.c_birth_day, t11.c_birth_month, t11.c_birth_year, t11.c_birth_country, t11.c_login, t11.c_email_address, t11.c_last_review_date_sk, t11.cd_demo_sk, t11.cd_gender, t11.cd_marital_status, t11.cd_education_status, t11.cd_purchase_estimate, t11.cd_credit_rating, t11.cd_dep_count, t11.cd_dep_employed_count, t11.cd_dep_college_count, t11.cd_demo_sk0, t11.cd_gender0, t11.cd_marital_status0, t11.cd_education_status0, t11.cd_purchase_estimate0, t11.cd_credit_rating0, t11.cd_dep_count0, t11.cd_dep_employed_count0, t11.cd_dep_college_count0, t11.p_promo_sk, t11.p_promo_id, t11.p_start_date_sk, t11.p_end_date_sk, t11.p_item_sk, t11.p_cost, t11.p_response_target, t11.p_promo_name, t11.p_channel_dmail, t11.p_channel_email, t11.p_channel_catalog, t11.p_channel_tv, t11.p_channel_radio, t11.p_channel_press, t11.p_channel_event, t11.p_channel_demo, t11.p_channel_details, t11.p_purpose, t11.p_discount_active, household_demographics0.hd_demo_sk, household_demographics0.hd_income_band_sk, household_demographics0.hd_buy_potential, household_demographics0.hd_dep_count, household_demographics0.hd_vehicle_count
FROM household_demographics AS household_demographics0
INNER JOIN (SELECT t10.ss_sold_date_sk, t10.ss_sold_time_sk, t10.ss_item_sk, t10.ss_customer_sk, t10.ss_cdemo_sk, t10.ss_hdemo_sk, t10.ss_addr_sk, t10.ss_store_sk, t10.ss_promo_sk, t10.ss_ticket_number, t10.ss_quantity, t10.ss_wholesale_cost, t10.ss_list_price, t10.ss_sales_price, t10.ss_ext_discount_amt, t10.ss_ext_sales_price, t10.ss_ext_wholesale_cost, t10.ss_ext_list_price, t10.ss_ext_tax, t10.ss_coupon_amt, t10.ss_net_paid, t10.ss_net_paid_inc_tax, t10.ss_net_profit, t10.sr_returned_date_sk, t10.sr_return_time_sk, t10.sr_item_sk, t10.sr_customer_sk, t10.sr_cdemo_sk, t10.sr_hdemo_sk, t10.sr_addr_sk, t10.sr_store_sk, t10.sr_reason_sk, t10.sr_ticket_number, t10.sr_return_quantity, t10.sr_return_amt, t10.sr_return_tax, t10.sr_return_amt_inc_tax, t10.sr_fee, t10.sr_return_ship_cost, t10.sr_refunded_cash, t10.sr_reversed_charge, t10.sr_store_credit, t10.sr_net_loss, t10.CS_ITEM_SK, t10.SALE, t10.REFUND, t10.d_date_sk, t10.d_date_id, t10.d_date, t10.d_month_seq, t10.d_week_seq, t10.d_quarter_seq, t10.d_year, t10.d_dow, t10.d_moy, t10.d_dom, t10.d_qoy, t10.d_fy_year, t10.d_fy_quarter_seq, t10.d_fy_week_seq, t10.d_day_name, t10.d_quarter_name, t10.d_holiday, t10.d_weekend, t10.d_following_holiday, t10.d_first_dom, t10.d_last_dom, t10.d_same_day_ly, t10.d_same_day_lq, t10.d_current_day, t10.d_current_week, t10.d_current_month, t10.d_current_quarter, t10.d_current_year, t10.d_date_sk0, t10.d_date_id0, t10.d_date0, t10.d_month_seq0, t10.d_week_seq0, t10.d_quarter_seq0, t10.d_year0, t10.d_dow0, t10.d_moy0, t10.d_dom0, t10.d_qoy0, t10.d_fy_year0, t10.d_fy_quarter_seq0, t10.d_fy_week_seq0, t10.d_day_name0, t10.d_quarter_name0, t10.d_holiday0, t10.d_weekend0, t10.d_following_holiday0, t10.d_first_dom0, t10.d_last_dom0, t10.d_same_day_ly0, t10.d_same_day_lq0, t10.d_current_day0, t10.d_current_week0, t10.d_current_month0, t10.d_current_quarter0, t10.d_current_year0, t10.d_date_sk1, t10.d_date_id1, t10.d_date1, t10.d_month_seq1, t10.d_week_seq1, t10.d_quarter_seq1, t10.d_year1, t10.d_dow1, t10.d_moy1, t10.d_dom1, t10.d_qoy1, t10.d_fy_year1, t10.d_fy_quarter_seq1, t10.d_fy_week_seq1, t10.d_day_name1, t10.d_quarter_name1, t10.d_holiday1, t10.d_weekend1, t10.d_following_holiday1, t10.d_first_dom1, t10.d_last_dom1, t10.d_same_day_ly1, t10.d_same_day_lq1, t10.d_current_day1, t10.d_current_week1, t10.d_current_month1, t10.d_current_quarter1, t10.d_current_year1, t10.s_store_sk, t10.s_store_id, t10.s_rec_start_date, t10.s_rec_end_date, t10.s_closed_date_sk, t10.s_store_name, t10.s_number_employees, t10.s_floor_space, t10.s_hours, t10.s_manager, t10.s_market_id, t10.s_geography_class, t10.s_market_desc, t10.s_market_manager, t10.s_division_id, t10.s_division_name, t10.s_company_id, t10.s_company_name, t10.s_street_number, t10.s_street_name, t10.s_street_type, t10.s_suite_number, t10.s_city, t10.s_county, t10.s_state, t10.s_zip, t10.s_country, t10.s_gmt_offset, t10.s_tax_percentage, t10.c_customer_sk, t10.c_customer_id, t10.c_current_cdemo_sk, t10.c_current_hdemo_sk, t10.c_current_addr_sk, t10.c_first_shipto_date_sk, t10.c_first_sales_date_sk, t10.c_salutation, t10.c_first_name, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_last_review_date_sk, t10.cd_demo_sk, t10.cd_gender, t10.cd_marital_status, t10.cd_education_status, t10.cd_purchase_estimate, t10.cd_credit_rating, t10.cd_dep_count, t10.cd_dep_employed_count, t10.cd_dep_college_count, t10.cd_demo_sk0, t10.cd_gender0, t10.cd_marital_status0, t10.cd_education_status0, t10.cd_purchase_estimate0, t10.cd_credit_rating0, t10.cd_dep_count0, t10.cd_dep_employed_count0, t10.cd_dep_college_count0, promotion.p_promo_sk, promotion.p_promo_id, promotion.p_start_date_sk, promotion.p_end_date_sk, promotion.p_item_sk, promotion.p_cost, promotion.p_response_target, promotion.p_promo_name, promotion.p_channel_dmail, promotion.p_channel_email, promotion.p_channel_catalog, promotion.p_channel_tv, promotion.p_channel_radio, promotion.p_channel_press, promotion.p_channel_event, promotion.p_channel_demo, promotion.p_channel_details, promotion.p_purpose, promotion.p_discount_active
FROM promotion
INNER JOIN (SELECT t9.ss_sold_date_sk, t9.ss_sold_time_sk, t9.ss_item_sk, t9.ss_customer_sk, t9.ss_cdemo_sk, t9.ss_hdemo_sk, t9.ss_addr_sk, t9.ss_store_sk, t9.ss_promo_sk, t9.ss_ticket_number, t9.ss_quantity, t9.ss_wholesale_cost, t9.ss_list_price, t9.ss_sales_price, t9.ss_ext_discount_amt, t9.ss_ext_sales_price, t9.ss_ext_wholesale_cost, t9.ss_ext_list_price, t9.ss_ext_tax, t9.ss_coupon_amt, t9.ss_net_paid, t9.ss_net_paid_inc_tax, t9.ss_net_profit, t9.sr_returned_date_sk, t9.sr_return_time_sk, t9.sr_item_sk, t9.sr_customer_sk, t9.sr_cdemo_sk, t9.sr_hdemo_sk, t9.sr_addr_sk, t9.sr_store_sk, t9.sr_reason_sk, t9.sr_ticket_number, t9.sr_return_quantity, t9.sr_return_amt, t9.sr_return_tax, t9.sr_return_amt_inc_tax, t9.sr_fee, t9.sr_return_ship_cost, t9.sr_refunded_cash, t9.sr_reversed_charge, t9.sr_store_credit, t9.sr_net_loss, t9.CS_ITEM_SK, t9.SALE, t9.REFUND, t9.d_date_sk, t9.d_date_id, t9.d_date, t9.d_month_seq, t9.d_week_seq, t9.d_quarter_seq, t9.d_year, t9.d_dow, t9.d_moy, t9.d_dom, t9.d_qoy, t9.d_fy_year, t9.d_fy_quarter_seq, t9.d_fy_week_seq, t9.d_day_name, t9.d_quarter_name, t9.d_holiday, t9.d_weekend, t9.d_following_holiday, t9.d_first_dom, t9.d_last_dom, t9.d_same_day_ly, t9.d_same_day_lq, t9.d_current_day, t9.d_current_week, t9.d_current_month, t9.d_current_quarter, t9.d_current_year, t9.d_date_sk0, t9.d_date_id0, t9.d_date0, t9.d_month_seq0, t9.d_week_seq0, t9.d_quarter_seq0, t9.d_year0, t9.d_dow0, t9.d_moy0, t9.d_dom0, t9.d_qoy0, t9.d_fy_year0, t9.d_fy_quarter_seq0, t9.d_fy_week_seq0, t9.d_day_name0, t9.d_quarter_name0, t9.d_holiday0, t9.d_weekend0, t9.d_following_holiday0, t9.d_first_dom0, t9.d_last_dom0, t9.d_same_day_ly0, t9.d_same_day_lq0, t9.d_current_day0, t9.d_current_week0, t9.d_current_month0, t9.d_current_quarter0, t9.d_current_year0, t9.d_date_sk1, t9.d_date_id1, t9.d_date1, t9.d_month_seq1, t9.d_week_seq1, t9.d_quarter_seq1, t9.d_year1, t9.d_dow1, t9.d_moy1, t9.d_dom1, t9.d_qoy1, t9.d_fy_year1, t9.d_fy_quarter_seq1, t9.d_fy_week_seq1, t9.d_day_name1, t9.d_quarter_name1, t9.d_holiday1, t9.d_weekend1, t9.d_following_holiday1, t9.d_first_dom1, t9.d_last_dom1, t9.d_same_day_ly1, t9.d_same_day_lq1, t9.d_current_day1, t9.d_current_week1, t9.d_current_month1, t9.d_current_quarter1, t9.d_current_year1, t9.s_store_sk, t9.s_store_id, t9.s_rec_start_date, t9.s_rec_end_date, t9.s_closed_date_sk, t9.s_store_name, t9.s_number_employees, t9.s_floor_space, t9.s_hours, t9.s_manager, t9.s_market_id, t9.s_geography_class, t9.s_market_desc, t9.s_market_manager, t9.s_division_id, t9.s_division_name, t9.s_company_id, t9.s_company_name, t9.s_street_number, t9.s_street_name, t9.s_street_type, t9.s_suite_number, t9.s_city, t9.s_county, t9.s_state, t9.s_zip, t9.s_country, t9.s_gmt_offset, t9.s_tax_percentage, t9.c_customer_sk, t9.c_customer_id, t9.c_current_cdemo_sk, t9.c_current_hdemo_sk, t9.c_current_addr_sk, t9.c_first_shipto_date_sk, t9.c_first_sales_date_sk, t9.c_salutation, t9.c_first_name, t9.c_last_name, t9.c_preferred_cust_flag, t9.c_birth_day, t9.c_birth_month, t9.c_birth_year, t9.c_birth_country, t9.c_login, t9.c_email_address, t9.c_last_review_date_sk, t9.cd_demo_sk, t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, t9.cd_purchase_estimate, t9.cd_credit_rating, t9.cd_dep_count, t9.cd_dep_employed_count, t9.cd_dep_college_count, customer_demographics.cd_demo_sk AS cd_demo_sk0, customer_demographics.cd_gender AS cd_gender0, customer_demographics.cd_marital_status AS cd_marital_status0, customer_demographics.cd_education_status AS cd_education_status0, customer_demographics.cd_purchase_estimate AS cd_purchase_estimate0, customer_demographics.cd_credit_rating AS cd_credit_rating0, customer_demographics.cd_dep_count AS cd_dep_count0, customer_demographics.cd_dep_employed_count AS cd_dep_employed_count0, customer_demographics.cd_dep_college_count AS cd_dep_college_count0
FROM customer_demographics
INNER JOIN (SELECT t8.ss_sold_date_sk, t8.ss_sold_time_sk, t8.ss_item_sk, t8.ss_customer_sk, t8.ss_cdemo_sk, t8.ss_hdemo_sk, t8.ss_addr_sk, t8.ss_store_sk, t8.ss_promo_sk, t8.ss_ticket_number, t8.ss_quantity, t8.ss_wholesale_cost, t8.ss_list_price, t8.ss_sales_price, t8.ss_ext_discount_amt, t8.ss_ext_sales_price, t8.ss_ext_wholesale_cost, t8.ss_ext_list_price, t8.ss_ext_tax, t8.ss_coupon_amt, t8.ss_net_paid, t8.ss_net_paid_inc_tax, t8.ss_net_profit, t8.sr_returned_date_sk, t8.sr_return_time_sk, t8.sr_item_sk, t8.sr_customer_sk, t8.sr_cdemo_sk, t8.sr_hdemo_sk, t8.sr_addr_sk, t8.sr_store_sk, t8.sr_reason_sk, t8.sr_ticket_number, t8.sr_return_quantity, t8.sr_return_amt, t8.sr_return_tax, t8.sr_return_amt_inc_tax, t8.sr_fee, t8.sr_return_ship_cost, t8.sr_refunded_cash, t8.sr_reversed_charge, t8.sr_store_credit, t8.sr_net_loss, t8.CS_ITEM_SK, t8.SALE, t8.REFUND, t8.d_date_sk, t8.d_date_id, t8.d_date, t8.d_month_seq, t8.d_week_seq, t8.d_quarter_seq, t8.d_year, t8.d_dow, t8.d_moy, t8.d_dom, t8.d_qoy, t8.d_fy_year, t8.d_fy_quarter_seq, t8.d_fy_week_seq, t8.d_day_name, t8.d_quarter_name, t8.d_holiday, t8.d_weekend, t8.d_following_holiday, t8.d_first_dom, t8.d_last_dom, t8.d_same_day_ly, t8.d_same_day_lq, t8.d_current_day, t8.d_current_week, t8.d_current_month, t8.d_current_quarter, t8.d_current_year, t8.d_date_sk0, t8.d_date_id0, t8.d_date0, t8.d_month_seq0, t8.d_week_seq0, t8.d_quarter_seq0, t8.d_year0, t8.d_dow0, t8.d_moy0, t8.d_dom0, t8.d_qoy0, t8.d_fy_year0, t8.d_fy_quarter_seq0, t8.d_fy_week_seq0, t8.d_day_name0, t8.d_quarter_name0, t8.d_holiday0, t8.d_weekend0, t8.d_following_holiday0, t8.d_first_dom0, t8.d_last_dom0, t8.d_same_day_ly0, t8.d_same_day_lq0, t8.d_current_day0, t8.d_current_week0, t8.d_current_month0, t8.d_current_quarter0, t8.d_current_year0, t8.d_date_sk1, t8.d_date_id1, t8.d_date1, t8.d_month_seq1, t8.d_week_seq1, t8.d_quarter_seq1, t8.d_year1, t8.d_dow1, t8.d_moy1, t8.d_dom1, t8.d_qoy1, t8.d_fy_year1, t8.d_fy_quarter_seq1, t8.d_fy_week_seq1, t8.d_day_name1, t8.d_quarter_name1, t8.d_holiday1, t8.d_weekend1, t8.d_following_holiday1, t8.d_first_dom1, t8.d_last_dom1, t8.d_same_day_ly1, t8.d_same_day_lq1, t8.d_current_day1, t8.d_current_week1, t8.d_current_month1, t8.d_current_quarter1, t8.d_current_year1, t8.s_store_sk, t8.s_store_id, t8.s_rec_start_date, t8.s_rec_end_date, t8.s_closed_date_sk, t8.s_store_name, t8.s_number_employees, t8.s_floor_space, t8.s_hours, t8.s_manager, t8.s_market_id, t8.s_geography_class, t8.s_market_desc, t8.s_market_manager, t8.s_division_id, t8.s_division_name, t8.s_company_id, t8.s_company_name, t8.s_street_number, t8.s_street_name, t8.s_street_type, t8.s_suite_number, t8.s_city, t8.s_county, t8.s_state, t8.s_zip, t8.s_country, t8.s_gmt_offset, t8.s_tax_percentage, t8.c_customer_sk, t8.c_customer_id, t8.c_current_cdemo_sk, t8.c_current_hdemo_sk, t8.c_current_addr_sk, t8.c_first_shipto_date_sk, t8.c_first_sales_date_sk, t8.c_salutation, t8.c_first_name, t8.c_last_name, t8.c_preferred_cust_flag, t8.c_birth_day, t8.c_birth_month, t8.c_birth_year, t8.c_birth_country, t8.c_login, t8.c_email_address, t8.c_last_review_date_sk, customer_demographics0.cd_demo_sk, customer_demographics0.cd_gender, customer_demographics0.cd_marital_status, customer_demographics0.cd_education_status, customer_demographics0.cd_purchase_estimate, customer_demographics0.cd_credit_rating, customer_demographics0.cd_dep_count, customer_demographics0.cd_dep_employed_count, customer_demographics0.cd_dep_college_count
FROM customer_demographics AS customer_demographics0
INNER JOIN (SELECT t7.ss_sold_date_sk, t7.ss_sold_time_sk, t7.ss_item_sk, t7.ss_customer_sk, t7.ss_cdemo_sk, t7.ss_hdemo_sk, t7.ss_addr_sk, t7.ss_store_sk, t7.ss_promo_sk, t7.ss_ticket_number, t7.ss_quantity, t7.ss_wholesale_cost, t7.ss_list_price, t7.ss_sales_price, t7.ss_ext_discount_amt, t7.ss_ext_sales_price, t7.ss_ext_wholesale_cost, t7.ss_ext_list_price, t7.ss_ext_tax, t7.ss_coupon_amt, t7.ss_net_paid, t7.ss_net_paid_inc_tax, t7.ss_net_profit, t7.sr_returned_date_sk, t7.sr_return_time_sk, t7.sr_item_sk, t7.sr_customer_sk, t7.sr_cdemo_sk, t7.sr_hdemo_sk, t7.sr_addr_sk, t7.sr_store_sk, t7.sr_reason_sk, t7.sr_ticket_number, t7.sr_return_quantity, t7.sr_return_amt, t7.sr_return_tax, t7.sr_return_amt_inc_tax, t7.sr_fee, t7.sr_return_ship_cost, t7.sr_refunded_cash, t7.sr_reversed_charge, t7.sr_store_credit, t7.sr_net_loss, t7.CS_ITEM_SK, t7.SALE, t7.REFUND, t7.d_date_sk, t7.d_date_id, t7.d_date, t7.d_month_seq, t7.d_week_seq, t7.d_quarter_seq, t7.d_year, t7.d_dow, t7.d_moy, t7.d_dom, t7.d_qoy, t7.d_fy_year, t7.d_fy_quarter_seq, t7.d_fy_week_seq, t7.d_day_name, t7.d_quarter_name, t7.d_holiday, t7.d_weekend, t7.d_following_holiday, t7.d_first_dom, t7.d_last_dom, t7.d_same_day_ly, t7.d_same_day_lq, t7.d_current_day, t7.d_current_week, t7.d_current_month, t7.d_current_quarter, t7.d_current_year, t7.d_date_sk0, t7.d_date_id0, t7.d_date0, t7.d_month_seq0, t7.d_week_seq0, t7.d_quarter_seq0, t7.d_year0, t7.d_dow0, t7.d_moy0, t7.d_dom0, t7.d_qoy0, t7.d_fy_year0, t7.d_fy_quarter_seq0, t7.d_fy_week_seq0, t7.d_day_name0, t7.d_quarter_name0, t7.d_holiday0, t7.d_weekend0, t7.d_following_holiday0, t7.d_first_dom0, t7.d_last_dom0, t7.d_same_day_ly0, t7.d_same_day_lq0, t7.d_current_day0, t7.d_current_week0, t7.d_current_month0, t7.d_current_quarter0, t7.d_current_year0, t7.d_date_sk1, t7.d_date_id1, t7.d_date1, t7.d_month_seq1, t7.d_week_seq1, t7.d_quarter_seq1, t7.d_year1, t7.d_dow1, t7.d_moy1, t7.d_dom1, t7.d_qoy1, t7.d_fy_year1, t7.d_fy_quarter_seq1, t7.d_fy_week_seq1, t7.d_day_name1, t7.d_quarter_name1, t7.d_holiday1, t7.d_weekend1, t7.d_following_holiday1, t7.d_first_dom1, t7.d_last_dom1, t7.d_same_day_ly1, t7.d_same_day_lq1, t7.d_current_day1, t7.d_current_week1, t7.d_current_month1, t7.d_current_quarter1, t7.d_current_year1, t7.s_store_sk, t7.s_store_id, t7.s_rec_start_date, t7.s_rec_end_date, t7.s_closed_date_sk, t7.s_store_name, t7.s_number_employees, t7.s_floor_space, t7.s_hours, t7.s_manager, t7.s_market_id, t7.s_geography_class, t7.s_market_desc, t7.s_market_manager, t7.s_division_id, t7.s_division_name, t7.s_company_id, t7.s_company_name, t7.s_street_number, t7.s_street_name, t7.s_street_type, t7.s_suite_number, t7.s_city, t7.s_county, t7.s_state, t7.s_zip, t7.s_country, t7.s_gmt_offset, t7.s_tax_percentage, customer.c_customer_sk, customer.c_customer_id, customer.c_current_cdemo_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_salutation, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_last_review_date_sk
FROM customer
INNER JOIN (SELECT t6.ss_sold_date_sk, t6.ss_sold_time_sk, t6.ss_item_sk, t6.ss_customer_sk, t6.ss_cdemo_sk, t6.ss_hdemo_sk, t6.ss_addr_sk, t6.ss_store_sk, t6.ss_promo_sk, t6.ss_ticket_number, t6.ss_quantity, t6.ss_wholesale_cost, t6.ss_list_price, t6.ss_sales_price, t6.ss_ext_discount_amt, t6.ss_ext_sales_price, t6.ss_ext_wholesale_cost, t6.ss_ext_list_price, t6.ss_ext_tax, t6.ss_coupon_amt, t6.ss_net_paid, t6.ss_net_paid_inc_tax, t6.ss_net_profit, t6.sr_returned_date_sk, t6.sr_return_time_sk, t6.sr_item_sk, t6.sr_customer_sk, t6.sr_cdemo_sk, t6.sr_hdemo_sk, t6.sr_addr_sk, t6.sr_store_sk, t6.sr_reason_sk, t6.sr_ticket_number, t6.sr_return_quantity, t6.sr_return_amt, t6.sr_return_tax, t6.sr_return_amt_inc_tax, t6.sr_fee, t6.sr_return_ship_cost, t6.sr_refunded_cash, t6.sr_reversed_charge, t6.sr_store_credit, t6.sr_net_loss, t6.CS_ITEM_SK, t6.SALE, t6.REFUND, t6.d_date_sk, t6.d_date_id, t6.d_date, t6.d_month_seq, t6.d_week_seq, t6.d_quarter_seq, t6.d_year, t6.d_dow, t6.d_moy, t6.d_dom, t6.d_qoy, t6.d_fy_year, t6.d_fy_quarter_seq, t6.d_fy_week_seq, t6.d_day_name, t6.d_quarter_name, t6.d_holiday, t6.d_weekend, t6.d_following_holiday, t6.d_first_dom, t6.d_last_dom, t6.d_same_day_ly, t6.d_same_day_lq, t6.d_current_day, t6.d_current_week, t6.d_current_month, t6.d_current_quarter, t6.d_current_year, t6.d_date_sk0, t6.d_date_id0, t6.d_date0, t6.d_month_seq0, t6.d_week_seq0, t6.d_quarter_seq0, t6.d_year0, t6.d_dow0, t6.d_moy0, t6.d_dom0, t6.d_qoy0, t6.d_fy_year0, t6.d_fy_quarter_seq0, t6.d_fy_week_seq0, t6.d_day_name0, t6.d_quarter_name0, t6.d_holiday0, t6.d_weekend0, t6.d_following_holiday0, t6.d_first_dom0, t6.d_last_dom0, t6.d_same_day_ly0, t6.d_same_day_lq0, t6.d_current_day0, t6.d_current_week0, t6.d_current_month0, t6.d_current_quarter0, t6.d_current_year0, t6.d_date_sk1, t6.d_date_id1, t6.d_date1, t6.d_month_seq1, t6.d_week_seq1, t6.d_quarter_seq1, t6.d_year1, t6.d_dow1, t6.d_moy1, t6.d_dom1, t6.d_qoy1, t6.d_fy_year1, t6.d_fy_quarter_seq1, t6.d_fy_week_seq1, t6.d_day_name1, t6.d_quarter_name1, t6.d_holiday1, t6.d_weekend1, t6.d_following_holiday1, t6.d_first_dom1, t6.d_last_dom1, t6.d_same_day_ly1, t6.d_same_day_lq1, t6.d_current_day1, t6.d_current_week1, t6.d_current_month1, t6.d_current_quarter1, t6.d_current_year1, store.s_store_sk, store.s_store_id, store.s_rec_start_date, store.s_rec_end_date, store.s_closed_date_sk, store.s_store_name, store.s_number_employees, store.s_floor_space, store.s_hours, store.s_manager, store.s_market_id, store.s_geography_class, store.s_market_desc, store.s_market_manager, store.s_division_id, store.s_division_name, store.s_company_id, store.s_company_name, store.s_street_number, store.s_street_name, store.s_street_type, store.s_suite_number, store.s_city, store.s_county, store.s_state, store.s_zip, store.s_country, store.s_gmt_offset, store.s_tax_percentage
FROM store
INNER JOIN (SELECT t5.ss_sold_date_sk, t5.ss_sold_time_sk, t5.ss_item_sk, t5.ss_customer_sk, t5.ss_cdemo_sk, t5.ss_hdemo_sk, t5.ss_addr_sk, t5.ss_store_sk, t5.ss_promo_sk, t5.ss_ticket_number, t5.ss_quantity, t5.ss_wholesale_cost, t5.ss_list_price, t5.ss_sales_price, t5.ss_ext_discount_amt, t5.ss_ext_sales_price, t5.ss_ext_wholesale_cost, t5.ss_ext_list_price, t5.ss_ext_tax, t5.ss_coupon_amt, t5.ss_net_paid, t5.ss_net_paid_inc_tax, t5.ss_net_profit, t5.sr_returned_date_sk, t5.sr_return_time_sk, t5.sr_item_sk, t5.sr_customer_sk, t5.sr_cdemo_sk, t5.sr_hdemo_sk, t5.sr_addr_sk, t5.sr_store_sk, t5.sr_reason_sk, t5.sr_ticket_number, t5.sr_return_quantity, t5.sr_return_amt, t5.sr_return_tax, t5.sr_return_amt_inc_tax, t5.sr_fee, t5.sr_return_ship_cost, t5.sr_refunded_cash, t5.sr_reversed_charge, t5.sr_store_credit, t5.sr_net_loss, t5.CS_ITEM_SK, t5.SALE, t5.REFUND, t5.d_date_sk, t5.d_date_id, t5.d_date, t5.d_month_seq, t5.d_week_seq, t5.d_quarter_seq, t5.d_year, t5.d_dow, t5.d_moy, t5.d_dom, t5.d_qoy, t5.d_fy_year, t5.d_fy_quarter_seq, t5.d_fy_week_seq, t5.d_day_name, t5.d_quarter_name, t5.d_holiday, t5.d_weekend, t5.d_following_holiday, t5.d_first_dom, t5.d_last_dom, t5.d_same_day_ly, t5.d_same_day_lq, t5.d_current_day, t5.d_current_week, t5.d_current_month, t5.d_current_quarter, t5.d_current_year, t5.d_date_sk0, t5.d_date_id0, t5.d_date0, t5.d_month_seq0, t5.d_week_seq0, t5.d_quarter_seq0, t5.d_year0, t5.d_dow0, t5.d_moy0, t5.d_dom0, t5.d_qoy0, t5.d_fy_year0, t5.d_fy_quarter_seq0, t5.d_fy_week_seq0, t5.d_day_name0, t5.d_quarter_name0, t5.d_holiday0, t5.d_weekend0, t5.d_following_holiday0, t5.d_first_dom0, t5.d_last_dom0, t5.d_same_day_ly0, t5.d_same_day_lq0, t5.d_current_day0, t5.d_current_week0, t5.d_current_month0, t5.d_current_quarter0, t5.d_current_year0, date_dim.d_date_sk AS d_date_sk1, date_dim.d_date_id AS d_date_id1, date_dim.d_date AS d_date1, date_dim.d_month_seq AS d_month_seq1, date_dim.d_week_seq AS d_week_seq1, date_dim.d_quarter_seq AS d_quarter_seq1, date_dim.d_year AS d_year1, date_dim.d_dow AS d_dow1, date_dim.d_moy AS d_moy1, date_dim.d_dom AS d_dom1, date_dim.d_qoy AS d_qoy1, date_dim.d_fy_year AS d_fy_year1, date_dim.d_fy_quarter_seq AS d_fy_quarter_seq1, date_dim.d_fy_week_seq AS d_fy_week_seq1, date_dim.d_day_name AS d_day_name1, date_dim.d_quarter_name AS d_quarter_name1, date_dim.d_holiday AS d_holiday1, date_dim.d_weekend AS d_weekend1, date_dim.d_following_holiday AS d_following_holiday1, date_dim.d_first_dom AS d_first_dom1, date_dim.d_last_dom AS d_last_dom1, date_dim.d_same_day_ly AS d_same_day_ly1, date_dim.d_same_day_lq AS d_same_day_lq1, date_dim.d_current_day AS d_current_day1, date_dim.d_current_week AS d_current_week1, date_dim.d_current_month AS d_current_month1, date_dim.d_current_quarter AS d_current_quarter1, date_dim.d_current_year AS d_current_year1
FROM date_dim,
(SELECT t4.ss_sold_date_sk, t4.ss_sold_time_sk, t4.ss_item_sk, t4.ss_customer_sk, t4.ss_cdemo_sk, t4.ss_hdemo_sk, t4.ss_addr_sk, t4.ss_store_sk, t4.ss_promo_sk, t4.ss_ticket_number, t4.ss_quantity, t4.ss_wholesale_cost, t4.ss_list_price, t4.ss_sales_price, t4.ss_ext_discount_amt, t4.ss_ext_sales_price, t4.ss_ext_wholesale_cost, t4.ss_ext_list_price, t4.ss_ext_tax, t4.ss_coupon_amt, t4.ss_net_paid, t4.ss_net_paid_inc_tax, t4.ss_net_profit, t4.sr_returned_date_sk, t4.sr_return_time_sk, t4.sr_item_sk, t4.sr_customer_sk, t4.sr_cdemo_sk, t4.sr_hdemo_sk, t4.sr_addr_sk, t4.sr_store_sk, t4.sr_reason_sk, t4.sr_ticket_number, t4.sr_return_quantity, t4.sr_return_amt, t4.sr_return_tax, t4.sr_return_amt_inc_tax, t4.sr_fee, t4.sr_return_ship_cost, t4.sr_refunded_cash, t4.sr_reversed_charge, t4.sr_store_credit, t4.sr_net_loss, t4.CS_ITEM_SK, t4.SALE, t4.REFUND, t4.d_date_sk, t4.d_date_id, t4.d_date, t4.d_month_seq, t4.d_week_seq, t4.d_quarter_seq, t4.d_year, t4.d_dow, t4.d_moy, t4.d_dom, t4.d_qoy, t4.d_fy_year, t4.d_fy_quarter_seq, t4.d_fy_week_seq, t4.d_day_name, t4.d_quarter_name, t4.d_holiday, t4.d_weekend, t4.d_following_holiday, t4.d_first_dom, t4.d_last_dom, t4.d_same_day_ly, t4.d_same_day_lq, t4.d_current_day, t4.d_current_week, t4.d_current_month, t4.d_current_quarter, t4.d_current_year, date_dim0.d_date_sk AS d_date_sk0, date_dim0.d_date_id AS d_date_id0, date_dim0.d_date AS d_date0, date_dim0.d_month_seq AS d_month_seq0, date_dim0.d_week_seq AS d_week_seq0, date_dim0.d_quarter_seq AS d_quarter_seq0, date_dim0.d_year AS d_year0, date_dim0.d_dow AS d_dow0, date_dim0.d_moy AS d_moy0, date_dim0.d_dom AS d_dom0, date_dim0.d_qoy AS d_qoy0, date_dim0.d_fy_year AS d_fy_year0, date_dim0.d_fy_quarter_seq AS d_fy_quarter_seq0, date_dim0.d_fy_week_seq AS d_fy_week_seq0, date_dim0.d_day_name AS d_day_name0, date_dim0.d_quarter_name AS d_quarter_name0, date_dim0.d_holiday AS d_holiday0, date_dim0.d_weekend AS d_weekend0, date_dim0.d_following_holiday AS d_following_holiday0, date_dim0.d_first_dom AS d_first_dom0, date_dim0.d_last_dom AS d_last_dom0, date_dim0.d_same_day_ly AS d_same_day_ly0, date_dim0.d_same_day_lq AS d_same_day_lq0, date_dim0.d_current_day AS d_current_day0, date_dim0.d_current_week AS d_current_week0, date_dim0.d_current_month AS d_current_month0, date_dim0.d_current_quarter AS d_current_quarter0, date_dim0.d_current_year AS d_current_year0
FROM date_dim AS date_dim0,
(SELECT store_sales.ss_sold_date_sk, store_sales.ss_sold_time_sk, store_sales.ss_item_sk, store_sales.ss_customer_sk, store_sales.ss_cdemo_sk, store_sales.ss_hdemo_sk, store_sales.ss_addr_sk, store_sales.ss_store_sk, store_sales.ss_promo_sk, store_sales.ss_ticket_number, store_sales.ss_quantity, store_sales.ss_wholesale_cost, store_sales.ss_list_price, store_sales.ss_sales_price, store_sales.ss_ext_discount_amt, store_sales.ss_ext_sales_price, store_sales.ss_ext_wholesale_cost, store_sales.ss_ext_list_price, store_sales.ss_ext_tax, store_sales.ss_coupon_amt, store_sales.ss_net_paid, store_sales.ss_net_paid_inc_tax, store_sales.ss_net_profit, store_returns.sr_returned_date_sk, store_returns.sr_return_time_sk, store_returns.sr_item_sk, store_returns.sr_customer_sk, store_returns.sr_cdemo_sk, store_returns.sr_hdemo_sk, store_returns.sr_addr_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk, store_returns.sr_ticket_number, store_returns.sr_return_quantity, store_returns.sr_return_amt, store_returns.sr_return_tax, store_returns.sr_return_amt_inc_tax, store_returns.sr_fee, store_returns.sr_return_ship_cost, store_returns.sr_refunded_cash, store_returns.sr_reversed_charge, store_returns.sr_store_credit, store_returns.sr_net_loss, t3.CS_ITEM_SK, t3.SALE, t3.REFUND, date_dim1.d_date_sk, date_dim1.d_date_id, date_dim1.d_date, date_dim1.d_month_seq, date_dim1.d_week_seq, date_dim1.d_quarter_seq, date_dim1.d_year, date_dim1.d_dow, date_dim1.d_moy, date_dim1.d_dom, date_dim1.d_qoy, date_dim1.d_fy_year, date_dim1.d_fy_quarter_seq, date_dim1.d_fy_week_seq, date_dim1.d_day_name, date_dim1.d_quarter_name, date_dim1.d_holiday, date_dim1.d_weekend, date_dim1.d_following_holiday, date_dim1.d_first_dom, date_dim1.d_last_dom, date_dim1.d_same_day_ly, date_dim1.d_same_day_lq, date_dim1.d_current_day, date_dim1.d_current_week, date_dim1.d_current_month, date_dim1.d_current_quarter, date_dim1.d_current_year
FROM date_dim AS date_dim1
INNER JOIN (store_sales INNER JOIN store_returns ON store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number INNER JOIN (SELECT catalog_sales.cs_item_sk AS CS_ITEM_SK, SUM(catalog_sales.cs_ext_list_price) AS SALE, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS REFUND
FROM catalog_sales
INNER JOIN catalog_returns ON catalog_sales.cs_item_sk = catalog_returns.cr_item_sk AND catalog_sales.cs_order_number = catalog_returns.cr_order_number
GROUP BY catalog_sales.cs_item_sk
HAVING SUM(catalog_sales.cs_ext_list_price) > 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t3 ON store_sales.ss_item_sk = t3.CS_ITEM_SK) ON date_dim1.d_date_sk = store_sales.ss_sold_date_sk) AS t4) AS t5) AS t6 ON store.s_store_sk = t6.ss_store_sk) AS t7 ON customer.c_customer_sk = t7.ss_customer_sk AND customer.c_first_sales_date_sk = t7.d_date_sk0 AND customer.c_first_shipto_date_sk = t7.d_date_sk1) AS t8 ON customer_demographics0.cd_demo_sk = t8.ss_cdemo_sk) AS t9 ON customer_demographics.cd_demo_sk = t9.c_current_cdemo_sk AND t9.cd_marital_status <> customer_demographics.cd_marital_status) AS t10 ON promotion.p_promo_sk = t10.ss_promo_sk) AS t11 ON household_demographics0.hd_demo_sk = t11.ss_hdemo_sk) AS t12 ON household_demographics.hd_demo_sk = t12.c_current_hdemo_sk) AS t13 ON customer_address0.ca_address_sk = t13.ss_addr_sk) AS t14 ON customer_address.ca_address_sk = t14.c_current_addr_sk) AS t15 ON income_band0.ib_income_band_sk = t15.hd_income_band_sk) AS t16 ON income_band.ib_income_band_sk = t16.hd_income_band_sk0) AS t17 ON t.i_item_sk = t17.ss_item_sk
GROUP BY t.i_product_name, t.i_item_sk, t17.s_store_name, t17.s_zip, t17.ca_street_number, t17.ca_street_name, t17.ca_city, t17.ca_zip, t17.ca_street_number0, t17.ca_street_name0, t17.ca_city0, t17.ca_zip0, t17.d_year, t17.d_year0, t17.d_year1
HAVING t17.d_year = 1999) AS t22
INNER JOIN (SELECT t23.i_product_name AS PRODUCT_NAME, t23.i_item_sk AS ITEM_SK, t41.s_store_name AS STORE_NAME, t41.s_zip AS STORE_ZIP, t41.ca_street_number AS B_STREET_NUMBER, t41.ca_street_name AS B_STREET_NAME, t41.ca_city AS B_CITY, t41.ca_zip AS B_ZIP, t41.ca_street_number0 AS C_STREET_NUMBER, t41.ca_street_name0 AS C_STREET_NAME, t41.ca_city0 AS C_CITY, t41.ca_zip0 AS C_ZIP, t41.d_year AS SYEAR, t41.d_year0 AS FSYEAR, t41.d_year1 AS S2YEAR, COUNT(*) AS CNT, SUM(t41.ss_wholesale_cost) AS S1, SUM(t41.ss_list_price) AS S2, SUM(t41.ss_coupon_amt) AS S3
FROM (SELECT *
FROM item
WHERE i_color IN ('burlywood', 'floral', 'indian', 'medium', 'purple', 'spring') AND i_current_price >= 64 AND i_current_price <= 64 + 10 AND i_current_price >= 64 + 1 AND i_current_price <= 64 + 15) AS t23
INNER JOIN (SELECT t40.ss_sold_date_sk, t40.ss_sold_time_sk, t40.ss_item_sk, t40.ss_customer_sk, t40.ss_cdemo_sk, t40.ss_hdemo_sk, t40.ss_addr_sk, t40.ss_store_sk, t40.ss_promo_sk, t40.ss_ticket_number, t40.ss_quantity, t40.ss_wholesale_cost, t40.ss_list_price, t40.ss_sales_price, t40.ss_ext_discount_amt, t40.ss_ext_sales_price, t40.ss_ext_wholesale_cost, t40.ss_ext_list_price, t40.ss_ext_tax, t40.ss_coupon_amt, t40.ss_net_paid, t40.ss_net_paid_inc_tax, t40.ss_net_profit, t40.sr_returned_date_sk, t40.sr_return_time_sk, t40.sr_item_sk, t40.sr_customer_sk, t40.sr_cdemo_sk, t40.sr_hdemo_sk, t40.sr_addr_sk, t40.sr_store_sk, t40.sr_reason_sk, t40.sr_ticket_number, t40.sr_return_quantity, t40.sr_return_amt, t40.sr_return_tax, t40.sr_return_amt_inc_tax, t40.sr_fee, t40.sr_return_ship_cost, t40.sr_refunded_cash, t40.sr_reversed_charge, t40.sr_store_credit, t40.sr_net_loss, t40.CS_ITEM_SK, t40.SALE, t40.REFUND, t40.d_date_sk, t40.d_date_id, t40.d_date, t40.d_month_seq, t40.d_week_seq, t40.d_quarter_seq, t40.d_year, t40.d_dow, t40.d_moy, t40.d_dom, t40.d_qoy, t40.d_fy_year, t40.d_fy_quarter_seq, t40.d_fy_week_seq, t40.d_day_name, t40.d_quarter_name, t40.d_holiday, t40.d_weekend, t40.d_following_holiday, t40.d_first_dom, t40.d_last_dom, t40.d_same_day_ly, t40.d_same_day_lq, t40.d_current_day, t40.d_current_week, t40.d_current_month, t40.d_current_quarter, t40.d_current_year, t40.d_date_sk0, t40.d_date_id0, t40.d_date0, t40.d_month_seq0, t40.d_week_seq0, t40.d_quarter_seq0, t40.d_year0, t40.d_dow0, t40.d_moy0, t40.d_dom0, t40.d_qoy0, t40.d_fy_year0, t40.d_fy_quarter_seq0, t40.d_fy_week_seq0, t40.d_day_name0, t40.d_quarter_name0, t40.d_holiday0, t40.d_weekend0, t40.d_following_holiday0, t40.d_first_dom0, t40.d_last_dom0, t40.d_same_day_ly0, t40.d_same_day_lq0, t40.d_current_day0, t40.d_current_week0, t40.d_current_month0, t40.d_current_quarter0, t40.d_current_year0, t40.d_date_sk1, t40.d_date_id1, t40.d_date1, t40.d_month_seq1, t40.d_week_seq1, t40.d_quarter_seq1, t40.d_year1, t40.d_dow1, t40.d_moy1, t40.d_dom1, t40.d_qoy1, t40.d_fy_year1, t40.d_fy_quarter_seq1, t40.d_fy_week_seq1, t40.d_day_name1, t40.d_quarter_name1, t40.d_holiday1, t40.d_weekend1, t40.d_following_holiday1, t40.d_first_dom1, t40.d_last_dom1, t40.d_same_day_ly1, t40.d_same_day_lq1, t40.d_current_day1, t40.d_current_week1, t40.d_current_month1, t40.d_current_quarter1, t40.d_current_year1, t40.s_store_sk, t40.s_store_id, t40.s_rec_start_date, t40.s_rec_end_date, t40.s_closed_date_sk, t40.s_store_name, t40.s_number_employees, t40.s_floor_space, t40.s_hours, t40.s_manager, t40.s_market_id, t40.s_geography_class, t40.s_market_desc, t40.s_market_manager, t40.s_division_id, t40.s_division_name, t40.s_company_id, t40.s_company_name, t40.s_street_number, t40.s_street_name, t40.s_street_type, t40.s_suite_number, t40.s_city, t40.s_county, t40.s_state, t40.s_zip, t40.s_country, t40.s_gmt_offset, t40.s_tax_percentage, t40.c_customer_sk, t40.c_customer_id, t40.c_current_cdemo_sk, t40.c_current_hdemo_sk, t40.c_current_addr_sk, t40.c_first_shipto_date_sk, t40.c_first_sales_date_sk, t40.c_salutation, t40.c_first_name, t40.c_last_name, t40.c_preferred_cust_flag, t40.c_birth_day, t40.c_birth_month, t40.c_birth_year, t40.c_birth_country, t40.c_login, t40.c_email_address, t40.c_last_review_date_sk, t40.cd_demo_sk, t40.cd_gender, t40.cd_marital_status, t40.cd_education_status, t40.cd_purchase_estimate, t40.cd_credit_rating, t40.cd_dep_count, t40.cd_dep_employed_count, t40.cd_dep_college_count, t40.cd_demo_sk0, t40.cd_gender0, t40.cd_marital_status0, t40.cd_education_status0, t40.cd_purchase_estimate0, t40.cd_credit_rating0, t40.cd_dep_count0, t40.cd_dep_employed_count0, t40.cd_dep_college_count0, t40.p_promo_sk, t40.p_promo_id, t40.p_start_date_sk, t40.p_end_date_sk, t40.p_item_sk, t40.p_cost, t40.p_response_target, t40.p_promo_name, t40.p_channel_dmail, t40.p_channel_email, t40.p_channel_catalog, t40.p_channel_tv, t40.p_channel_radio, t40.p_channel_press, t40.p_channel_event, t40.p_channel_demo, t40.p_channel_details, t40.p_purpose, t40.p_discount_active, t40.hd_demo_sk, t40.hd_income_band_sk, t40.hd_buy_potential, t40.hd_dep_count, t40.hd_vehicle_count, t40.hd_demo_sk0, t40.hd_income_band_sk0, t40.hd_buy_potential0, t40.hd_dep_count0, t40.hd_vehicle_count0, t40.ca_address_sk, t40.ca_address_id, t40.ca_street_number, t40.ca_street_name, t40.ca_street_type, t40.ca_suite_number, t40.ca_city, t40.ca_county, t40.ca_state, t40.ca_zip, t40.ca_country, t40.ca_gmt_offset, t40.ca_location_type, t40.ca_address_sk0, t40.ca_address_id0, t40.ca_street_number0, t40.ca_street_name0, t40.ca_street_type0, t40.ca_suite_number0, t40.ca_city0, t40.ca_county0, t40.ca_state0, t40.ca_zip0, t40.ca_country0, t40.ca_gmt_offset0, t40.ca_location_type0, t40.ib_income_band_sk, t40.ib_lower_bound, t40.ib_upper_bound, income_band1.ib_income_band_sk AS ib_income_band_sk0, income_band1.ib_lower_bound AS ib_lower_bound0, income_band1.ib_upper_bound AS ib_upper_bound0
FROM income_band AS income_band1
INNER JOIN (SELECT t39.ss_sold_date_sk, t39.ss_sold_time_sk, t39.ss_item_sk, t39.ss_customer_sk, t39.ss_cdemo_sk, t39.ss_hdemo_sk, t39.ss_addr_sk, t39.ss_store_sk, t39.ss_promo_sk, t39.ss_ticket_number, t39.ss_quantity, t39.ss_wholesale_cost, t39.ss_list_price, t39.ss_sales_price, t39.ss_ext_discount_amt, t39.ss_ext_sales_price, t39.ss_ext_wholesale_cost, t39.ss_ext_list_price, t39.ss_ext_tax, t39.ss_coupon_amt, t39.ss_net_paid, t39.ss_net_paid_inc_tax, t39.ss_net_profit, t39.sr_returned_date_sk, t39.sr_return_time_sk, t39.sr_item_sk, t39.sr_customer_sk, t39.sr_cdemo_sk, t39.sr_hdemo_sk, t39.sr_addr_sk, t39.sr_store_sk, t39.sr_reason_sk, t39.sr_ticket_number, t39.sr_return_quantity, t39.sr_return_amt, t39.sr_return_tax, t39.sr_return_amt_inc_tax, t39.sr_fee, t39.sr_return_ship_cost, t39.sr_refunded_cash, t39.sr_reversed_charge, t39.sr_store_credit, t39.sr_net_loss, t39.CS_ITEM_SK, t39.SALE, t39.REFUND, t39.d_date_sk, t39.d_date_id, t39.d_date, t39.d_month_seq, t39.d_week_seq, t39.d_quarter_seq, t39.d_year, t39.d_dow, t39.d_moy, t39.d_dom, t39.d_qoy, t39.d_fy_year, t39.d_fy_quarter_seq, t39.d_fy_week_seq, t39.d_day_name, t39.d_quarter_name, t39.d_holiday, t39.d_weekend, t39.d_following_holiday, t39.d_first_dom, t39.d_last_dom, t39.d_same_day_ly, t39.d_same_day_lq, t39.d_current_day, t39.d_current_week, t39.d_current_month, t39.d_current_quarter, t39.d_current_year, t39.d_date_sk0, t39.d_date_id0, t39.d_date0, t39.d_month_seq0, t39.d_week_seq0, t39.d_quarter_seq0, t39.d_year0, t39.d_dow0, t39.d_moy0, t39.d_dom0, t39.d_qoy0, t39.d_fy_year0, t39.d_fy_quarter_seq0, t39.d_fy_week_seq0, t39.d_day_name0, t39.d_quarter_name0, t39.d_holiday0, t39.d_weekend0, t39.d_following_holiday0, t39.d_first_dom0, t39.d_last_dom0, t39.d_same_day_ly0, t39.d_same_day_lq0, t39.d_current_day0, t39.d_current_week0, t39.d_current_month0, t39.d_current_quarter0, t39.d_current_year0, t39.d_date_sk1, t39.d_date_id1, t39.d_date1, t39.d_month_seq1, t39.d_week_seq1, t39.d_quarter_seq1, t39.d_year1, t39.d_dow1, t39.d_moy1, t39.d_dom1, t39.d_qoy1, t39.d_fy_year1, t39.d_fy_quarter_seq1, t39.d_fy_week_seq1, t39.d_day_name1, t39.d_quarter_name1, t39.d_holiday1, t39.d_weekend1, t39.d_following_holiday1, t39.d_first_dom1, t39.d_last_dom1, t39.d_same_day_ly1, t39.d_same_day_lq1, t39.d_current_day1, t39.d_current_week1, t39.d_current_month1, t39.d_current_quarter1, t39.d_current_year1, t39.s_store_sk, t39.s_store_id, t39.s_rec_start_date, t39.s_rec_end_date, t39.s_closed_date_sk, t39.s_store_name, t39.s_number_employees, t39.s_floor_space, t39.s_hours, t39.s_manager, t39.s_market_id, t39.s_geography_class, t39.s_market_desc, t39.s_market_manager, t39.s_division_id, t39.s_division_name, t39.s_company_id, t39.s_company_name, t39.s_street_number, t39.s_street_name, t39.s_street_type, t39.s_suite_number, t39.s_city, t39.s_county, t39.s_state, t39.s_zip, t39.s_country, t39.s_gmt_offset, t39.s_tax_percentage, t39.c_customer_sk, t39.c_customer_id, t39.c_current_cdemo_sk, t39.c_current_hdemo_sk, t39.c_current_addr_sk, t39.c_first_shipto_date_sk, t39.c_first_sales_date_sk, t39.c_salutation, t39.c_first_name, t39.c_last_name, t39.c_preferred_cust_flag, t39.c_birth_day, t39.c_birth_month, t39.c_birth_year, t39.c_birth_country, t39.c_login, t39.c_email_address, t39.c_last_review_date_sk, t39.cd_demo_sk, t39.cd_gender, t39.cd_marital_status, t39.cd_education_status, t39.cd_purchase_estimate, t39.cd_credit_rating, t39.cd_dep_count, t39.cd_dep_employed_count, t39.cd_dep_college_count, t39.cd_demo_sk0, t39.cd_gender0, t39.cd_marital_status0, t39.cd_education_status0, t39.cd_purchase_estimate0, t39.cd_credit_rating0, t39.cd_dep_count0, t39.cd_dep_employed_count0, t39.cd_dep_college_count0, t39.p_promo_sk, t39.p_promo_id, t39.p_start_date_sk, t39.p_end_date_sk, t39.p_item_sk, t39.p_cost, t39.p_response_target, t39.p_promo_name, t39.p_channel_dmail, t39.p_channel_email, t39.p_channel_catalog, t39.p_channel_tv, t39.p_channel_radio, t39.p_channel_press, t39.p_channel_event, t39.p_channel_demo, t39.p_channel_details, t39.p_purpose, t39.p_discount_active, t39.hd_demo_sk, t39.hd_income_band_sk, t39.hd_buy_potential, t39.hd_dep_count, t39.hd_vehicle_count, t39.hd_demo_sk0, t39.hd_income_band_sk0, t39.hd_buy_potential0, t39.hd_dep_count0, t39.hd_vehicle_count0, t39.ca_address_sk, t39.ca_address_id, t39.ca_street_number, t39.ca_street_name, t39.ca_street_type, t39.ca_suite_number, t39.ca_city, t39.ca_county, t39.ca_state, t39.ca_zip, t39.ca_country, t39.ca_gmt_offset, t39.ca_location_type, t39.ca_address_sk0, t39.ca_address_id0, t39.ca_street_number0, t39.ca_street_name0, t39.ca_street_type0, t39.ca_suite_number0, t39.ca_city0, t39.ca_county0, t39.ca_state0, t39.ca_zip0, t39.ca_country0, t39.ca_gmt_offset0, t39.ca_location_type0, income_band2.ib_income_band_sk, income_band2.ib_lower_bound, income_band2.ib_upper_bound
FROM income_band AS income_band2
INNER JOIN (SELECT t38.ss_sold_date_sk, t38.ss_sold_time_sk, t38.ss_item_sk, t38.ss_customer_sk, t38.ss_cdemo_sk, t38.ss_hdemo_sk, t38.ss_addr_sk, t38.ss_store_sk, t38.ss_promo_sk, t38.ss_ticket_number, t38.ss_quantity, t38.ss_wholesale_cost, t38.ss_list_price, t38.ss_sales_price, t38.ss_ext_discount_amt, t38.ss_ext_sales_price, t38.ss_ext_wholesale_cost, t38.ss_ext_list_price, t38.ss_ext_tax, t38.ss_coupon_amt, t38.ss_net_paid, t38.ss_net_paid_inc_tax, t38.ss_net_profit, t38.sr_returned_date_sk, t38.sr_return_time_sk, t38.sr_item_sk, t38.sr_customer_sk, t38.sr_cdemo_sk, t38.sr_hdemo_sk, t38.sr_addr_sk, t38.sr_store_sk, t38.sr_reason_sk, t38.sr_ticket_number, t38.sr_return_quantity, t38.sr_return_amt, t38.sr_return_tax, t38.sr_return_amt_inc_tax, t38.sr_fee, t38.sr_return_ship_cost, t38.sr_refunded_cash, t38.sr_reversed_charge, t38.sr_store_credit, t38.sr_net_loss, t38.CS_ITEM_SK, t38.SALE, t38.REFUND, t38.d_date_sk, t38.d_date_id, t38.d_date, t38.d_month_seq, t38.d_week_seq, t38.d_quarter_seq, t38.d_year, t38.d_dow, t38.d_moy, t38.d_dom, t38.d_qoy, t38.d_fy_year, t38.d_fy_quarter_seq, t38.d_fy_week_seq, t38.d_day_name, t38.d_quarter_name, t38.d_holiday, t38.d_weekend, t38.d_following_holiday, t38.d_first_dom, t38.d_last_dom, t38.d_same_day_ly, t38.d_same_day_lq, t38.d_current_day, t38.d_current_week, t38.d_current_month, t38.d_current_quarter, t38.d_current_year, t38.d_date_sk0, t38.d_date_id0, t38.d_date0, t38.d_month_seq0, t38.d_week_seq0, t38.d_quarter_seq0, t38.d_year0, t38.d_dow0, t38.d_moy0, t38.d_dom0, t38.d_qoy0, t38.d_fy_year0, t38.d_fy_quarter_seq0, t38.d_fy_week_seq0, t38.d_day_name0, t38.d_quarter_name0, t38.d_holiday0, t38.d_weekend0, t38.d_following_holiday0, t38.d_first_dom0, t38.d_last_dom0, t38.d_same_day_ly0, t38.d_same_day_lq0, t38.d_current_day0, t38.d_current_week0, t38.d_current_month0, t38.d_current_quarter0, t38.d_current_year0, t38.d_date_sk1, t38.d_date_id1, t38.d_date1, t38.d_month_seq1, t38.d_week_seq1, t38.d_quarter_seq1, t38.d_year1, t38.d_dow1, t38.d_moy1, t38.d_dom1, t38.d_qoy1, t38.d_fy_year1, t38.d_fy_quarter_seq1, t38.d_fy_week_seq1, t38.d_day_name1, t38.d_quarter_name1, t38.d_holiday1, t38.d_weekend1, t38.d_following_holiday1, t38.d_first_dom1, t38.d_last_dom1, t38.d_same_day_ly1, t38.d_same_day_lq1, t38.d_current_day1, t38.d_current_week1, t38.d_current_month1, t38.d_current_quarter1, t38.d_current_year1, t38.s_store_sk, t38.s_store_id, t38.s_rec_start_date, t38.s_rec_end_date, t38.s_closed_date_sk, t38.s_store_name, t38.s_number_employees, t38.s_floor_space, t38.s_hours, t38.s_manager, t38.s_market_id, t38.s_geography_class, t38.s_market_desc, t38.s_market_manager, t38.s_division_id, t38.s_division_name, t38.s_company_id, t38.s_company_name, t38.s_street_number, t38.s_street_name, t38.s_street_type, t38.s_suite_number, t38.s_city, t38.s_county, t38.s_state, t38.s_zip, t38.s_country, t38.s_gmt_offset, t38.s_tax_percentage, t38.c_customer_sk, t38.c_customer_id, t38.c_current_cdemo_sk, t38.c_current_hdemo_sk, t38.c_current_addr_sk, t38.c_first_shipto_date_sk, t38.c_first_sales_date_sk, t38.c_salutation, t38.c_first_name, t38.c_last_name, t38.c_preferred_cust_flag, t38.c_birth_day, t38.c_birth_month, t38.c_birth_year, t38.c_birth_country, t38.c_login, t38.c_email_address, t38.c_last_review_date_sk, t38.cd_demo_sk, t38.cd_gender, t38.cd_marital_status, t38.cd_education_status, t38.cd_purchase_estimate, t38.cd_credit_rating, t38.cd_dep_count, t38.cd_dep_employed_count, t38.cd_dep_college_count, t38.cd_demo_sk0, t38.cd_gender0, t38.cd_marital_status0, t38.cd_education_status0, t38.cd_purchase_estimate0, t38.cd_credit_rating0, t38.cd_dep_count0, t38.cd_dep_employed_count0, t38.cd_dep_college_count0, t38.p_promo_sk, t38.p_promo_id, t38.p_start_date_sk, t38.p_end_date_sk, t38.p_item_sk, t38.p_cost, t38.p_response_target, t38.p_promo_name, t38.p_channel_dmail, t38.p_channel_email, t38.p_channel_catalog, t38.p_channel_tv, t38.p_channel_radio, t38.p_channel_press, t38.p_channel_event, t38.p_channel_demo, t38.p_channel_details, t38.p_purpose, t38.p_discount_active, t38.hd_demo_sk, t38.hd_income_band_sk, t38.hd_buy_potential, t38.hd_dep_count, t38.hd_vehicle_count, t38.hd_demo_sk0, t38.hd_income_band_sk0, t38.hd_buy_potential0, t38.hd_dep_count0, t38.hd_vehicle_count0, t38.ca_address_sk, t38.ca_address_id, t38.ca_street_number, t38.ca_street_name, t38.ca_street_type, t38.ca_suite_number, t38.ca_city, t38.ca_county, t38.ca_state, t38.ca_zip, t38.ca_country, t38.ca_gmt_offset, t38.ca_location_type, customer_address1.ca_address_sk AS ca_address_sk0, customer_address1.ca_address_id AS ca_address_id0, customer_address1.ca_street_number AS ca_street_number0, customer_address1.ca_street_name AS ca_street_name0, customer_address1.ca_street_type AS ca_street_type0, customer_address1.ca_suite_number AS ca_suite_number0, customer_address1.ca_city AS ca_city0, customer_address1.ca_county AS ca_county0, customer_address1.ca_state AS ca_state0, customer_address1.ca_zip AS ca_zip0, customer_address1.ca_country AS ca_country0, customer_address1.ca_gmt_offset AS ca_gmt_offset0, customer_address1.ca_location_type AS ca_location_type0
FROM customer_address AS customer_address1
INNER JOIN (SELECT t37.ss_sold_date_sk, t37.ss_sold_time_sk, t37.ss_item_sk, t37.ss_customer_sk, t37.ss_cdemo_sk, t37.ss_hdemo_sk, t37.ss_addr_sk, t37.ss_store_sk, t37.ss_promo_sk, t37.ss_ticket_number, t37.ss_quantity, t37.ss_wholesale_cost, t37.ss_list_price, t37.ss_sales_price, t37.ss_ext_discount_amt, t37.ss_ext_sales_price, t37.ss_ext_wholesale_cost, t37.ss_ext_list_price, t37.ss_ext_tax, t37.ss_coupon_amt, t37.ss_net_paid, t37.ss_net_paid_inc_tax, t37.ss_net_profit, t37.sr_returned_date_sk, t37.sr_return_time_sk, t37.sr_item_sk, t37.sr_customer_sk, t37.sr_cdemo_sk, t37.sr_hdemo_sk, t37.sr_addr_sk, t37.sr_store_sk, t37.sr_reason_sk, t37.sr_ticket_number, t37.sr_return_quantity, t37.sr_return_amt, t37.sr_return_tax, t37.sr_return_amt_inc_tax, t37.sr_fee, t37.sr_return_ship_cost, t37.sr_refunded_cash, t37.sr_reversed_charge, t37.sr_store_credit, t37.sr_net_loss, t37.CS_ITEM_SK, t37.SALE, t37.REFUND, t37.d_date_sk, t37.d_date_id, t37.d_date, t37.d_month_seq, t37.d_week_seq, t37.d_quarter_seq, t37.d_year, t37.d_dow, t37.d_moy, t37.d_dom, t37.d_qoy, t37.d_fy_year, t37.d_fy_quarter_seq, t37.d_fy_week_seq, t37.d_day_name, t37.d_quarter_name, t37.d_holiday, t37.d_weekend, t37.d_following_holiday, t37.d_first_dom, t37.d_last_dom, t37.d_same_day_ly, t37.d_same_day_lq, t37.d_current_day, t37.d_current_week, t37.d_current_month, t37.d_current_quarter, t37.d_current_year, t37.d_date_sk0, t37.d_date_id0, t37.d_date0, t37.d_month_seq0, t37.d_week_seq0, t37.d_quarter_seq0, t37.d_year0, t37.d_dow0, t37.d_moy0, t37.d_dom0, t37.d_qoy0, t37.d_fy_year0, t37.d_fy_quarter_seq0, t37.d_fy_week_seq0, t37.d_day_name0, t37.d_quarter_name0, t37.d_holiday0, t37.d_weekend0, t37.d_following_holiday0, t37.d_first_dom0, t37.d_last_dom0, t37.d_same_day_ly0, t37.d_same_day_lq0, t37.d_current_day0, t37.d_current_week0, t37.d_current_month0, t37.d_current_quarter0, t37.d_current_year0, t37.d_date_sk1, t37.d_date_id1, t37.d_date1, t37.d_month_seq1, t37.d_week_seq1, t37.d_quarter_seq1, t37.d_year1, t37.d_dow1, t37.d_moy1, t37.d_dom1, t37.d_qoy1, t37.d_fy_year1, t37.d_fy_quarter_seq1, t37.d_fy_week_seq1, t37.d_day_name1, t37.d_quarter_name1, t37.d_holiday1, t37.d_weekend1, t37.d_following_holiday1, t37.d_first_dom1, t37.d_last_dom1, t37.d_same_day_ly1, t37.d_same_day_lq1, t37.d_current_day1, t37.d_current_week1, t37.d_current_month1, t37.d_current_quarter1, t37.d_current_year1, t37.s_store_sk, t37.s_store_id, t37.s_rec_start_date, t37.s_rec_end_date, t37.s_closed_date_sk, t37.s_store_name, t37.s_number_employees, t37.s_floor_space, t37.s_hours, t37.s_manager, t37.s_market_id, t37.s_geography_class, t37.s_market_desc, t37.s_market_manager, t37.s_division_id, t37.s_division_name, t37.s_company_id, t37.s_company_name, t37.s_street_number, t37.s_street_name, t37.s_street_type, t37.s_suite_number, t37.s_city, t37.s_county, t37.s_state, t37.s_zip, t37.s_country, t37.s_gmt_offset, t37.s_tax_percentage, t37.c_customer_sk, t37.c_customer_id, t37.c_current_cdemo_sk, t37.c_current_hdemo_sk, t37.c_current_addr_sk, t37.c_first_shipto_date_sk, t37.c_first_sales_date_sk, t37.c_salutation, t37.c_first_name, t37.c_last_name, t37.c_preferred_cust_flag, t37.c_birth_day, t37.c_birth_month, t37.c_birth_year, t37.c_birth_country, t37.c_login, t37.c_email_address, t37.c_last_review_date_sk, t37.cd_demo_sk, t37.cd_gender, t37.cd_marital_status, t37.cd_education_status, t37.cd_purchase_estimate, t37.cd_credit_rating, t37.cd_dep_count, t37.cd_dep_employed_count, t37.cd_dep_college_count, t37.cd_demo_sk0, t37.cd_gender0, t37.cd_marital_status0, t37.cd_education_status0, t37.cd_purchase_estimate0, t37.cd_credit_rating0, t37.cd_dep_count0, t37.cd_dep_employed_count0, t37.cd_dep_college_count0, t37.p_promo_sk, t37.p_promo_id, t37.p_start_date_sk, t37.p_end_date_sk, t37.p_item_sk, t37.p_cost, t37.p_response_target, t37.p_promo_name, t37.p_channel_dmail, t37.p_channel_email, t37.p_channel_catalog, t37.p_channel_tv, t37.p_channel_radio, t37.p_channel_press, t37.p_channel_event, t37.p_channel_demo, t37.p_channel_details, t37.p_purpose, t37.p_discount_active, t37.hd_demo_sk, t37.hd_income_band_sk, t37.hd_buy_potential, t37.hd_dep_count, t37.hd_vehicle_count, t37.hd_demo_sk0, t37.hd_income_band_sk0, t37.hd_buy_potential0, t37.hd_dep_count0, t37.hd_vehicle_count0, customer_address2.ca_address_sk, customer_address2.ca_address_id, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_street_type, customer_address2.ca_suite_number, customer_address2.ca_city, customer_address2.ca_county, customer_address2.ca_state, customer_address2.ca_zip, customer_address2.ca_country, customer_address2.ca_gmt_offset, customer_address2.ca_location_type
FROM customer_address AS customer_address2
INNER JOIN (SELECT t36.ss_sold_date_sk, t36.ss_sold_time_sk, t36.ss_item_sk, t36.ss_customer_sk, t36.ss_cdemo_sk, t36.ss_hdemo_sk, t36.ss_addr_sk, t36.ss_store_sk, t36.ss_promo_sk, t36.ss_ticket_number, t36.ss_quantity, t36.ss_wholesale_cost, t36.ss_list_price, t36.ss_sales_price, t36.ss_ext_discount_amt, t36.ss_ext_sales_price, t36.ss_ext_wholesale_cost, t36.ss_ext_list_price, t36.ss_ext_tax, t36.ss_coupon_amt, t36.ss_net_paid, t36.ss_net_paid_inc_tax, t36.ss_net_profit, t36.sr_returned_date_sk, t36.sr_return_time_sk, t36.sr_item_sk, t36.sr_customer_sk, t36.sr_cdemo_sk, t36.sr_hdemo_sk, t36.sr_addr_sk, t36.sr_store_sk, t36.sr_reason_sk, t36.sr_ticket_number, t36.sr_return_quantity, t36.sr_return_amt, t36.sr_return_tax, t36.sr_return_amt_inc_tax, t36.sr_fee, t36.sr_return_ship_cost, t36.sr_refunded_cash, t36.sr_reversed_charge, t36.sr_store_credit, t36.sr_net_loss, t36.CS_ITEM_SK, t36.SALE, t36.REFUND, t36.d_date_sk, t36.d_date_id, t36.d_date, t36.d_month_seq, t36.d_week_seq, t36.d_quarter_seq, t36.d_year, t36.d_dow, t36.d_moy, t36.d_dom, t36.d_qoy, t36.d_fy_year, t36.d_fy_quarter_seq, t36.d_fy_week_seq, t36.d_day_name, t36.d_quarter_name, t36.d_holiday, t36.d_weekend, t36.d_following_holiday, t36.d_first_dom, t36.d_last_dom, t36.d_same_day_ly, t36.d_same_day_lq, t36.d_current_day, t36.d_current_week, t36.d_current_month, t36.d_current_quarter, t36.d_current_year, t36.d_date_sk0, t36.d_date_id0, t36.d_date0, t36.d_month_seq0, t36.d_week_seq0, t36.d_quarter_seq0, t36.d_year0, t36.d_dow0, t36.d_moy0, t36.d_dom0, t36.d_qoy0, t36.d_fy_year0, t36.d_fy_quarter_seq0, t36.d_fy_week_seq0, t36.d_day_name0, t36.d_quarter_name0, t36.d_holiday0, t36.d_weekend0, t36.d_following_holiday0, t36.d_first_dom0, t36.d_last_dom0, t36.d_same_day_ly0, t36.d_same_day_lq0, t36.d_current_day0, t36.d_current_week0, t36.d_current_month0, t36.d_current_quarter0, t36.d_current_year0, t36.d_date_sk1, t36.d_date_id1, t36.d_date1, t36.d_month_seq1, t36.d_week_seq1, t36.d_quarter_seq1, t36.d_year1, t36.d_dow1, t36.d_moy1, t36.d_dom1, t36.d_qoy1, t36.d_fy_year1, t36.d_fy_quarter_seq1, t36.d_fy_week_seq1, t36.d_day_name1, t36.d_quarter_name1, t36.d_holiday1, t36.d_weekend1, t36.d_following_holiday1, t36.d_first_dom1, t36.d_last_dom1, t36.d_same_day_ly1, t36.d_same_day_lq1, t36.d_current_day1, t36.d_current_week1, t36.d_current_month1, t36.d_current_quarter1, t36.d_current_year1, t36.s_store_sk, t36.s_store_id, t36.s_rec_start_date, t36.s_rec_end_date, t36.s_closed_date_sk, t36.s_store_name, t36.s_number_employees, t36.s_floor_space, t36.s_hours, t36.s_manager, t36.s_market_id, t36.s_geography_class, t36.s_market_desc, t36.s_market_manager, t36.s_division_id, t36.s_division_name, t36.s_company_id, t36.s_company_name, t36.s_street_number, t36.s_street_name, t36.s_street_type, t36.s_suite_number, t36.s_city, t36.s_county, t36.s_state, t36.s_zip, t36.s_country, t36.s_gmt_offset, t36.s_tax_percentage, t36.c_customer_sk, t36.c_customer_id, t36.c_current_cdemo_sk, t36.c_current_hdemo_sk, t36.c_current_addr_sk, t36.c_first_shipto_date_sk, t36.c_first_sales_date_sk, t36.c_salutation, t36.c_first_name, t36.c_last_name, t36.c_preferred_cust_flag, t36.c_birth_day, t36.c_birth_month, t36.c_birth_year, t36.c_birth_country, t36.c_login, t36.c_email_address, t36.c_last_review_date_sk, t36.cd_demo_sk, t36.cd_gender, t36.cd_marital_status, t36.cd_education_status, t36.cd_purchase_estimate, t36.cd_credit_rating, t36.cd_dep_count, t36.cd_dep_employed_count, t36.cd_dep_college_count, t36.cd_demo_sk0, t36.cd_gender0, t36.cd_marital_status0, t36.cd_education_status0, t36.cd_purchase_estimate0, t36.cd_credit_rating0, t36.cd_dep_count0, t36.cd_dep_employed_count0, t36.cd_dep_college_count0, t36.p_promo_sk, t36.p_promo_id, t36.p_start_date_sk, t36.p_end_date_sk, t36.p_item_sk, t36.p_cost, t36.p_response_target, t36.p_promo_name, t36.p_channel_dmail, t36.p_channel_email, t36.p_channel_catalog, t36.p_channel_tv, t36.p_channel_radio, t36.p_channel_press, t36.p_channel_event, t36.p_channel_demo, t36.p_channel_details, t36.p_purpose, t36.p_discount_active, t36.hd_demo_sk, t36.hd_income_band_sk, t36.hd_buy_potential, t36.hd_dep_count, t36.hd_vehicle_count, household_demographics1.hd_demo_sk AS hd_demo_sk0, household_demographics1.hd_income_band_sk AS hd_income_band_sk0, household_demographics1.hd_buy_potential AS hd_buy_potential0, household_demographics1.hd_dep_count AS hd_dep_count0, household_demographics1.hd_vehicle_count AS hd_vehicle_count0
FROM household_demographics AS household_demographics1
INNER JOIN (SELECT t35.ss_sold_date_sk, t35.ss_sold_time_sk, t35.ss_item_sk, t35.ss_customer_sk, t35.ss_cdemo_sk, t35.ss_hdemo_sk, t35.ss_addr_sk, t35.ss_store_sk, t35.ss_promo_sk, t35.ss_ticket_number, t35.ss_quantity, t35.ss_wholesale_cost, t35.ss_list_price, t35.ss_sales_price, t35.ss_ext_discount_amt, t35.ss_ext_sales_price, t35.ss_ext_wholesale_cost, t35.ss_ext_list_price, t35.ss_ext_tax, t35.ss_coupon_amt, t35.ss_net_paid, t35.ss_net_paid_inc_tax, t35.ss_net_profit, t35.sr_returned_date_sk, t35.sr_return_time_sk, t35.sr_item_sk, t35.sr_customer_sk, t35.sr_cdemo_sk, t35.sr_hdemo_sk, t35.sr_addr_sk, t35.sr_store_sk, t35.sr_reason_sk, t35.sr_ticket_number, t35.sr_return_quantity, t35.sr_return_amt, t35.sr_return_tax, t35.sr_return_amt_inc_tax, t35.sr_fee, t35.sr_return_ship_cost, t35.sr_refunded_cash, t35.sr_reversed_charge, t35.sr_store_credit, t35.sr_net_loss, t35.CS_ITEM_SK, t35.SALE, t35.REFUND, t35.d_date_sk, t35.d_date_id, t35.d_date, t35.d_month_seq, t35.d_week_seq, t35.d_quarter_seq, t35.d_year, t35.d_dow, t35.d_moy, t35.d_dom, t35.d_qoy, t35.d_fy_year, t35.d_fy_quarter_seq, t35.d_fy_week_seq, t35.d_day_name, t35.d_quarter_name, t35.d_holiday, t35.d_weekend, t35.d_following_holiday, t35.d_first_dom, t35.d_last_dom, t35.d_same_day_ly, t35.d_same_day_lq, t35.d_current_day, t35.d_current_week, t35.d_current_month, t35.d_current_quarter, t35.d_current_year, t35.d_date_sk0, t35.d_date_id0, t35.d_date0, t35.d_month_seq0, t35.d_week_seq0, t35.d_quarter_seq0, t35.d_year0, t35.d_dow0, t35.d_moy0, t35.d_dom0, t35.d_qoy0, t35.d_fy_year0, t35.d_fy_quarter_seq0, t35.d_fy_week_seq0, t35.d_day_name0, t35.d_quarter_name0, t35.d_holiday0, t35.d_weekend0, t35.d_following_holiday0, t35.d_first_dom0, t35.d_last_dom0, t35.d_same_day_ly0, t35.d_same_day_lq0, t35.d_current_day0, t35.d_current_week0, t35.d_current_month0, t35.d_current_quarter0, t35.d_current_year0, t35.d_date_sk1, t35.d_date_id1, t35.d_date1, t35.d_month_seq1, t35.d_week_seq1, t35.d_quarter_seq1, t35.d_year1, t35.d_dow1, t35.d_moy1, t35.d_dom1, t35.d_qoy1, t35.d_fy_year1, t35.d_fy_quarter_seq1, t35.d_fy_week_seq1, t35.d_day_name1, t35.d_quarter_name1, t35.d_holiday1, t35.d_weekend1, t35.d_following_holiday1, t35.d_first_dom1, t35.d_last_dom1, t35.d_same_day_ly1, t35.d_same_day_lq1, t35.d_current_day1, t35.d_current_week1, t35.d_current_month1, t35.d_current_quarter1, t35.d_current_year1, t35.s_store_sk, t35.s_store_id, t35.s_rec_start_date, t35.s_rec_end_date, t35.s_closed_date_sk, t35.s_store_name, t35.s_number_employees, t35.s_floor_space, t35.s_hours, t35.s_manager, t35.s_market_id, t35.s_geography_class, t35.s_market_desc, t35.s_market_manager, t35.s_division_id, t35.s_division_name, t35.s_company_id, t35.s_company_name, t35.s_street_number, t35.s_street_name, t35.s_street_type, t35.s_suite_number, t35.s_city, t35.s_county, t35.s_state, t35.s_zip, t35.s_country, t35.s_gmt_offset, t35.s_tax_percentage, t35.c_customer_sk, t35.c_customer_id, t35.c_current_cdemo_sk, t35.c_current_hdemo_sk, t35.c_current_addr_sk, t35.c_first_shipto_date_sk, t35.c_first_sales_date_sk, t35.c_salutation, t35.c_first_name, t35.c_last_name, t35.c_preferred_cust_flag, t35.c_birth_day, t35.c_birth_month, t35.c_birth_year, t35.c_birth_country, t35.c_login, t35.c_email_address, t35.c_last_review_date_sk, t35.cd_demo_sk, t35.cd_gender, t35.cd_marital_status, t35.cd_education_status, t35.cd_purchase_estimate, t35.cd_credit_rating, t35.cd_dep_count, t35.cd_dep_employed_count, t35.cd_dep_college_count, t35.cd_demo_sk0, t35.cd_gender0, t35.cd_marital_status0, t35.cd_education_status0, t35.cd_purchase_estimate0, t35.cd_credit_rating0, t35.cd_dep_count0, t35.cd_dep_employed_count0, t35.cd_dep_college_count0, t35.p_promo_sk, t35.p_promo_id, t35.p_start_date_sk, t35.p_end_date_sk, t35.p_item_sk, t35.p_cost, t35.p_response_target, t35.p_promo_name, t35.p_channel_dmail, t35.p_channel_email, t35.p_channel_catalog, t35.p_channel_tv, t35.p_channel_radio, t35.p_channel_press, t35.p_channel_event, t35.p_channel_demo, t35.p_channel_details, t35.p_purpose, t35.p_discount_active, household_demographics2.hd_demo_sk, household_demographics2.hd_income_band_sk, household_demographics2.hd_buy_potential, household_demographics2.hd_dep_count, household_demographics2.hd_vehicle_count
FROM household_demographics AS household_demographics2
INNER JOIN (SELECT t34.ss_sold_date_sk, t34.ss_sold_time_sk, t34.ss_item_sk, t34.ss_customer_sk, t34.ss_cdemo_sk, t34.ss_hdemo_sk, t34.ss_addr_sk, t34.ss_store_sk, t34.ss_promo_sk, t34.ss_ticket_number, t34.ss_quantity, t34.ss_wholesale_cost, t34.ss_list_price, t34.ss_sales_price, t34.ss_ext_discount_amt, t34.ss_ext_sales_price, t34.ss_ext_wholesale_cost, t34.ss_ext_list_price, t34.ss_ext_tax, t34.ss_coupon_amt, t34.ss_net_paid, t34.ss_net_paid_inc_tax, t34.ss_net_profit, t34.sr_returned_date_sk, t34.sr_return_time_sk, t34.sr_item_sk, t34.sr_customer_sk, t34.sr_cdemo_sk, t34.sr_hdemo_sk, t34.sr_addr_sk, t34.sr_store_sk, t34.sr_reason_sk, t34.sr_ticket_number, t34.sr_return_quantity, t34.sr_return_amt, t34.sr_return_tax, t34.sr_return_amt_inc_tax, t34.sr_fee, t34.sr_return_ship_cost, t34.sr_refunded_cash, t34.sr_reversed_charge, t34.sr_store_credit, t34.sr_net_loss, t34.CS_ITEM_SK, t34.SALE, t34.REFUND, t34.d_date_sk, t34.d_date_id, t34.d_date, t34.d_month_seq, t34.d_week_seq, t34.d_quarter_seq, t34.d_year, t34.d_dow, t34.d_moy, t34.d_dom, t34.d_qoy, t34.d_fy_year, t34.d_fy_quarter_seq, t34.d_fy_week_seq, t34.d_day_name, t34.d_quarter_name, t34.d_holiday, t34.d_weekend, t34.d_following_holiday, t34.d_first_dom, t34.d_last_dom, t34.d_same_day_ly, t34.d_same_day_lq, t34.d_current_day, t34.d_current_week, t34.d_current_month, t34.d_current_quarter, t34.d_current_year, t34.d_date_sk0, t34.d_date_id0, t34.d_date0, t34.d_month_seq0, t34.d_week_seq0, t34.d_quarter_seq0, t34.d_year0, t34.d_dow0, t34.d_moy0, t34.d_dom0, t34.d_qoy0, t34.d_fy_year0, t34.d_fy_quarter_seq0, t34.d_fy_week_seq0, t34.d_day_name0, t34.d_quarter_name0, t34.d_holiday0, t34.d_weekend0, t34.d_following_holiday0, t34.d_first_dom0, t34.d_last_dom0, t34.d_same_day_ly0, t34.d_same_day_lq0, t34.d_current_day0, t34.d_current_week0, t34.d_current_month0, t34.d_current_quarter0, t34.d_current_year0, t34.d_date_sk1, t34.d_date_id1, t34.d_date1, t34.d_month_seq1, t34.d_week_seq1, t34.d_quarter_seq1, t34.d_year1, t34.d_dow1, t34.d_moy1, t34.d_dom1, t34.d_qoy1, t34.d_fy_year1, t34.d_fy_quarter_seq1, t34.d_fy_week_seq1, t34.d_day_name1, t34.d_quarter_name1, t34.d_holiday1, t34.d_weekend1, t34.d_following_holiday1, t34.d_first_dom1, t34.d_last_dom1, t34.d_same_day_ly1, t34.d_same_day_lq1, t34.d_current_day1, t34.d_current_week1, t34.d_current_month1, t34.d_current_quarter1, t34.d_current_year1, t34.s_store_sk, t34.s_store_id, t34.s_rec_start_date, t34.s_rec_end_date, t34.s_closed_date_sk, t34.s_store_name, t34.s_number_employees, t34.s_floor_space, t34.s_hours, t34.s_manager, t34.s_market_id, t34.s_geography_class, t34.s_market_desc, t34.s_market_manager, t34.s_division_id, t34.s_division_name, t34.s_company_id, t34.s_company_name, t34.s_street_number, t34.s_street_name, t34.s_street_type, t34.s_suite_number, t34.s_city, t34.s_county, t34.s_state, t34.s_zip, t34.s_country, t34.s_gmt_offset, t34.s_tax_percentage, t34.c_customer_sk, t34.c_customer_id, t34.c_current_cdemo_sk, t34.c_current_hdemo_sk, t34.c_current_addr_sk, t34.c_first_shipto_date_sk, t34.c_first_sales_date_sk, t34.c_salutation, t34.c_first_name, t34.c_last_name, t34.c_preferred_cust_flag, t34.c_birth_day, t34.c_birth_month, t34.c_birth_year, t34.c_birth_country, t34.c_login, t34.c_email_address, t34.c_last_review_date_sk, t34.cd_demo_sk, t34.cd_gender, t34.cd_marital_status, t34.cd_education_status, t34.cd_purchase_estimate, t34.cd_credit_rating, t34.cd_dep_count, t34.cd_dep_employed_count, t34.cd_dep_college_count, t34.cd_demo_sk0, t34.cd_gender0, t34.cd_marital_status0, t34.cd_education_status0, t34.cd_purchase_estimate0, t34.cd_credit_rating0, t34.cd_dep_count0, t34.cd_dep_employed_count0, t34.cd_dep_college_count0, promotion0.p_promo_sk, promotion0.p_promo_id, promotion0.p_start_date_sk, promotion0.p_end_date_sk, promotion0.p_item_sk, promotion0.p_cost, promotion0.p_response_target, promotion0.p_promo_name, promotion0.p_channel_dmail, promotion0.p_channel_email, promotion0.p_channel_catalog, promotion0.p_channel_tv, promotion0.p_channel_radio, promotion0.p_channel_press, promotion0.p_channel_event, promotion0.p_channel_demo, promotion0.p_channel_details, promotion0.p_purpose, promotion0.p_discount_active
FROM promotion AS promotion0
INNER JOIN (SELECT t33.ss_sold_date_sk, t33.ss_sold_time_sk, t33.ss_item_sk, t33.ss_customer_sk, t33.ss_cdemo_sk, t33.ss_hdemo_sk, t33.ss_addr_sk, t33.ss_store_sk, t33.ss_promo_sk, t33.ss_ticket_number, t33.ss_quantity, t33.ss_wholesale_cost, t33.ss_list_price, t33.ss_sales_price, t33.ss_ext_discount_amt, t33.ss_ext_sales_price, t33.ss_ext_wholesale_cost, t33.ss_ext_list_price, t33.ss_ext_tax, t33.ss_coupon_amt, t33.ss_net_paid, t33.ss_net_paid_inc_tax, t33.ss_net_profit, t33.sr_returned_date_sk, t33.sr_return_time_sk, t33.sr_item_sk, t33.sr_customer_sk, t33.sr_cdemo_sk, t33.sr_hdemo_sk, t33.sr_addr_sk, t33.sr_store_sk, t33.sr_reason_sk, t33.sr_ticket_number, t33.sr_return_quantity, t33.sr_return_amt, t33.sr_return_tax, t33.sr_return_amt_inc_tax, t33.sr_fee, t33.sr_return_ship_cost, t33.sr_refunded_cash, t33.sr_reversed_charge, t33.sr_store_credit, t33.sr_net_loss, t33.CS_ITEM_SK, t33.SALE, t33.REFUND, t33.d_date_sk, t33.d_date_id, t33.d_date, t33.d_month_seq, t33.d_week_seq, t33.d_quarter_seq, t33.d_year, t33.d_dow, t33.d_moy, t33.d_dom, t33.d_qoy, t33.d_fy_year, t33.d_fy_quarter_seq, t33.d_fy_week_seq, t33.d_day_name, t33.d_quarter_name, t33.d_holiday, t33.d_weekend, t33.d_following_holiday, t33.d_first_dom, t33.d_last_dom, t33.d_same_day_ly, t33.d_same_day_lq, t33.d_current_day, t33.d_current_week, t33.d_current_month, t33.d_current_quarter, t33.d_current_year, t33.d_date_sk0, t33.d_date_id0, t33.d_date0, t33.d_month_seq0, t33.d_week_seq0, t33.d_quarter_seq0, t33.d_year0, t33.d_dow0, t33.d_moy0, t33.d_dom0, t33.d_qoy0, t33.d_fy_year0, t33.d_fy_quarter_seq0, t33.d_fy_week_seq0, t33.d_day_name0, t33.d_quarter_name0, t33.d_holiday0, t33.d_weekend0, t33.d_following_holiday0, t33.d_first_dom0, t33.d_last_dom0, t33.d_same_day_ly0, t33.d_same_day_lq0, t33.d_current_day0, t33.d_current_week0, t33.d_current_month0, t33.d_current_quarter0, t33.d_current_year0, t33.d_date_sk1, t33.d_date_id1, t33.d_date1, t33.d_month_seq1, t33.d_week_seq1, t33.d_quarter_seq1, t33.d_year1, t33.d_dow1, t33.d_moy1, t33.d_dom1, t33.d_qoy1, t33.d_fy_year1, t33.d_fy_quarter_seq1, t33.d_fy_week_seq1, t33.d_day_name1, t33.d_quarter_name1, t33.d_holiday1, t33.d_weekend1, t33.d_following_holiday1, t33.d_first_dom1, t33.d_last_dom1, t33.d_same_day_ly1, t33.d_same_day_lq1, t33.d_current_day1, t33.d_current_week1, t33.d_current_month1, t33.d_current_quarter1, t33.d_current_year1, t33.s_store_sk, t33.s_store_id, t33.s_rec_start_date, t33.s_rec_end_date, t33.s_closed_date_sk, t33.s_store_name, t33.s_number_employees, t33.s_floor_space, t33.s_hours, t33.s_manager, t33.s_market_id, t33.s_geography_class, t33.s_market_desc, t33.s_market_manager, t33.s_division_id, t33.s_division_name, t33.s_company_id, t33.s_company_name, t33.s_street_number, t33.s_street_name, t33.s_street_type, t33.s_suite_number, t33.s_city, t33.s_county, t33.s_state, t33.s_zip, t33.s_country, t33.s_gmt_offset, t33.s_tax_percentage, t33.c_customer_sk, t33.c_customer_id, t33.c_current_cdemo_sk, t33.c_current_hdemo_sk, t33.c_current_addr_sk, t33.c_first_shipto_date_sk, t33.c_first_sales_date_sk, t33.c_salutation, t33.c_first_name, t33.c_last_name, t33.c_preferred_cust_flag, t33.c_birth_day, t33.c_birth_month, t33.c_birth_year, t33.c_birth_country, t33.c_login, t33.c_email_address, t33.c_last_review_date_sk, t33.cd_demo_sk, t33.cd_gender, t33.cd_marital_status, t33.cd_education_status, t33.cd_purchase_estimate, t33.cd_credit_rating, t33.cd_dep_count, t33.cd_dep_employed_count, t33.cd_dep_college_count, customer_demographics1.cd_demo_sk AS cd_demo_sk0, customer_demographics1.cd_gender AS cd_gender0, customer_demographics1.cd_marital_status AS cd_marital_status0, customer_demographics1.cd_education_status AS cd_education_status0, customer_demographics1.cd_purchase_estimate AS cd_purchase_estimate0, customer_demographics1.cd_credit_rating AS cd_credit_rating0, customer_demographics1.cd_dep_count AS cd_dep_count0, customer_demographics1.cd_dep_employed_count AS cd_dep_employed_count0, customer_demographics1.cd_dep_college_count AS cd_dep_college_count0
FROM customer_demographics AS customer_demographics1
INNER JOIN (SELECT t32.ss_sold_date_sk, t32.ss_sold_time_sk, t32.ss_item_sk, t32.ss_customer_sk, t32.ss_cdemo_sk, t32.ss_hdemo_sk, t32.ss_addr_sk, t32.ss_store_sk, t32.ss_promo_sk, t32.ss_ticket_number, t32.ss_quantity, t32.ss_wholesale_cost, t32.ss_list_price, t32.ss_sales_price, t32.ss_ext_discount_amt, t32.ss_ext_sales_price, t32.ss_ext_wholesale_cost, t32.ss_ext_list_price, t32.ss_ext_tax, t32.ss_coupon_amt, t32.ss_net_paid, t32.ss_net_paid_inc_tax, t32.ss_net_profit, t32.sr_returned_date_sk, t32.sr_return_time_sk, t32.sr_item_sk, t32.sr_customer_sk, t32.sr_cdemo_sk, t32.sr_hdemo_sk, t32.sr_addr_sk, t32.sr_store_sk, t32.sr_reason_sk, t32.sr_ticket_number, t32.sr_return_quantity, t32.sr_return_amt, t32.sr_return_tax, t32.sr_return_amt_inc_tax, t32.sr_fee, t32.sr_return_ship_cost, t32.sr_refunded_cash, t32.sr_reversed_charge, t32.sr_store_credit, t32.sr_net_loss, t32.CS_ITEM_SK, t32.SALE, t32.REFUND, t32.d_date_sk, t32.d_date_id, t32.d_date, t32.d_month_seq, t32.d_week_seq, t32.d_quarter_seq, t32.d_year, t32.d_dow, t32.d_moy, t32.d_dom, t32.d_qoy, t32.d_fy_year, t32.d_fy_quarter_seq, t32.d_fy_week_seq, t32.d_day_name, t32.d_quarter_name, t32.d_holiday, t32.d_weekend, t32.d_following_holiday, t32.d_first_dom, t32.d_last_dom, t32.d_same_day_ly, t32.d_same_day_lq, t32.d_current_day, t32.d_current_week, t32.d_current_month, t32.d_current_quarter, t32.d_current_year, t32.d_date_sk0, t32.d_date_id0, t32.d_date0, t32.d_month_seq0, t32.d_week_seq0, t32.d_quarter_seq0, t32.d_year0, t32.d_dow0, t32.d_moy0, t32.d_dom0, t32.d_qoy0, t32.d_fy_year0, t32.d_fy_quarter_seq0, t32.d_fy_week_seq0, t32.d_day_name0, t32.d_quarter_name0, t32.d_holiday0, t32.d_weekend0, t32.d_following_holiday0, t32.d_first_dom0, t32.d_last_dom0, t32.d_same_day_ly0, t32.d_same_day_lq0, t32.d_current_day0, t32.d_current_week0, t32.d_current_month0, t32.d_current_quarter0, t32.d_current_year0, t32.d_date_sk1, t32.d_date_id1, t32.d_date1, t32.d_month_seq1, t32.d_week_seq1, t32.d_quarter_seq1, t32.d_year1, t32.d_dow1, t32.d_moy1, t32.d_dom1, t32.d_qoy1, t32.d_fy_year1, t32.d_fy_quarter_seq1, t32.d_fy_week_seq1, t32.d_day_name1, t32.d_quarter_name1, t32.d_holiday1, t32.d_weekend1, t32.d_following_holiday1, t32.d_first_dom1, t32.d_last_dom1, t32.d_same_day_ly1, t32.d_same_day_lq1, t32.d_current_day1, t32.d_current_week1, t32.d_current_month1, t32.d_current_quarter1, t32.d_current_year1, t32.s_store_sk, t32.s_store_id, t32.s_rec_start_date, t32.s_rec_end_date, t32.s_closed_date_sk, t32.s_store_name, t32.s_number_employees, t32.s_floor_space, t32.s_hours, t32.s_manager, t32.s_market_id, t32.s_geography_class, t32.s_market_desc, t32.s_market_manager, t32.s_division_id, t32.s_division_name, t32.s_company_id, t32.s_company_name, t32.s_street_number, t32.s_street_name, t32.s_street_type, t32.s_suite_number, t32.s_city, t32.s_county, t32.s_state, t32.s_zip, t32.s_country, t32.s_gmt_offset, t32.s_tax_percentage, t32.c_customer_sk, t32.c_customer_id, t32.c_current_cdemo_sk, t32.c_current_hdemo_sk, t32.c_current_addr_sk, t32.c_first_shipto_date_sk, t32.c_first_sales_date_sk, t32.c_salutation, t32.c_first_name, t32.c_last_name, t32.c_preferred_cust_flag, t32.c_birth_day, t32.c_birth_month, t32.c_birth_year, t32.c_birth_country, t32.c_login, t32.c_email_address, t32.c_last_review_date_sk, customer_demographics2.cd_demo_sk, customer_demographics2.cd_gender, customer_demographics2.cd_marital_status, customer_demographics2.cd_education_status, customer_demographics2.cd_purchase_estimate, customer_demographics2.cd_credit_rating, customer_demographics2.cd_dep_count, customer_demographics2.cd_dep_employed_count, customer_demographics2.cd_dep_college_count
FROM customer_demographics AS customer_demographics2
INNER JOIN (SELECT t31.ss_sold_date_sk, t31.ss_sold_time_sk, t31.ss_item_sk, t31.ss_customer_sk, t31.ss_cdemo_sk, t31.ss_hdemo_sk, t31.ss_addr_sk, t31.ss_store_sk, t31.ss_promo_sk, t31.ss_ticket_number, t31.ss_quantity, t31.ss_wholesale_cost, t31.ss_list_price, t31.ss_sales_price, t31.ss_ext_discount_amt, t31.ss_ext_sales_price, t31.ss_ext_wholesale_cost, t31.ss_ext_list_price, t31.ss_ext_tax, t31.ss_coupon_amt, t31.ss_net_paid, t31.ss_net_paid_inc_tax, t31.ss_net_profit, t31.sr_returned_date_sk, t31.sr_return_time_sk, t31.sr_item_sk, t31.sr_customer_sk, t31.sr_cdemo_sk, t31.sr_hdemo_sk, t31.sr_addr_sk, t31.sr_store_sk, t31.sr_reason_sk, t31.sr_ticket_number, t31.sr_return_quantity, t31.sr_return_amt, t31.sr_return_tax, t31.sr_return_amt_inc_tax, t31.sr_fee, t31.sr_return_ship_cost, t31.sr_refunded_cash, t31.sr_reversed_charge, t31.sr_store_credit, t31.sr_net_loss, t31.CS_ITEM_SK, t31.SALE, t31.REFUND, t31.d_date_sk, t31.d_date_id, t31.d_date, t31.d_month_seq, t31.d_week_seq, t31.d_quarter_seq, t31.d_year, t31.d_dow, t31.d_moy, t31.d_dom, t31.d_qoy, t31.d_fy_year, t31.d_fy_quarter_seq, t31.d_fy_week_seq, t31.d_day_name, t31.d_quarter_name, t31.d_holiday, t31.d_weekend, t31.d_following_holiday, t31.d_first_dom, t31.d_last_dom, t31.d_same_day_ly, t31.d_same_day_lq, t31.d_current_day, t31.d_current_week, t31.d_current_month, t31.d_current_quarter, t31.d_current_year, t31.d_date_sk0, t31.d_date_id0, t31.d_date0, t31.d_month_seq0, t31.d_week_seq0, t31.d_quarter_seq0, t31.d_year0, t31.d_dow0, t31.d_moy0, t31.d_dom0, t31.d_qoy0, t31.d_fy_year0, t31.d_fy_quarter_seq0, t31.d_fy_week_seq0, t31.d_day_name0, t31.d_quarter_name0, t31.d_holiday0, t31.d_weekend0, t31.d_following_holiday0, t31.d_first_dom0, t31.d_last_dom0, t31.d_same_day_ly0, t31.d_same_day_lq0, t31.d_current_day0, t31.d_current_week0, t31.d_current_month0, t31.d_current_quarter0, t31.d_current_year0, t31.d_date_sk1, t31.d_date_id1, t31.d_date1, t31.d_month_seq1, t31.d_week_seq1, t31.d_quarter_seq1, t31.d_year1, t31.d_dow1, t31.d_moy1, t31.d_dom1, t31.d_qoy1, t31.d_fy_year1, t31.d_fy_quarter_seq1, t31.d_fy_week_seq1, t31.d_day_name1, t31.d_quarter_name1, t31.d_holiday1, t31.d_weekend1, t31.d_following_holiday1, t31.d_first_dom1, t31.d_last_dom1, t31.d_same_day_ly1, t31.d_same_day_lq1, t31.d_current_day1, t31.d_current_week1, t31.d_current_month1, t31.d_current_quarter1, t31.d_current_year1, t31.s_store_sk, t31.s_store_id, t31.s_rec_start_date, t31.s_rec_end_date, t31.s_closed_date_sk, t31.s_store_name, t31.s_number_employees, t31.s_floor_space, t31.s_hours, t31.s_manager, t31.s_market_id, t31.s_geography_class, t31.s_market_desc, t31.s_market_manager, t31.s_division_id, t31.s_division_name, t31.s_company_id, t31.s_company_name, t31.s_street_number, t31.s_street_name, t31.s_street_type, t31.s_suite_number, t31.s_city, t31.s_county, t31.s_state, t31.s_zip, t31.s_country, t31.s_gmt_offset, t31.s_tax_percentage, customer0.c_customer_sk, customer0.c_customer_id, customer0.c_current_cdemo_sk, customer0.c_current_hdemo_sk, customer0.c_current_addr_sk, customer0.c_first_shipto_date_sk, customer0.c_first_sales_date_sk, customer0.c_salutation, customer0.c_first_name, customer0.c_last_name, customer0.c_preferred_cust_flag, customer0.c_birth_day, customer0.c_birth_month, customer0.c_birth_year, customer0.c_birth_country, customer0.c_login, customer0.c_email_address, customer0.c_last_review_date_sk
FROM customer AS customer0
INNER JOIN (SELECT t30.ss_sold_date_sk, t30.ss_sold_time_sk, t30.ss_item_sk, t30.ss_customer_sk, t30.ss_cdemo_sk, t30.ss_hdemo_sk, t30.ss_addr_sk, t30.ss_store_sk, t30.ss_promo_sk, t30.ss_ticket_number, t30.ss_quantity, t30.ss_wholesale_cost, t30.ss_list_price, t30.ss_sales_price, t30.ss_ext_discount_amt, t30.ss_ext_sales_price, t30.ss_ext_wholesale_cost, t30.ss_ext_list_price, t30.ss_ext_tax, t30.ss_coupon_amt, t30.ss_net_paid, t30.ss_net_paid_inc_tax, t30.ss_net_profit, t30.sr_returned_date_sk, t30.sr_return_time_sk, t30.sr_item_sk, t30.sr_customer_sk, t30.sr_cdemo_sk, t30.sr_hdemo_sk, t30.sr_addr_sk, t30.sr_store_sk, t30.sr_reason_sk, t30.sr_ticket_number, t30.sr_return_quantity, t30.sr_return_amt, t30.sr_return_tax, t30.sr_return_amt_inc_tax, t30.sr_fee, t30.sr_return_ship_cost, t30.sr_refunded_cash, t30.sr_reversed_charge, t30.sr_store_credit, t30.sr_net_loss, t30.CS_ITEM_SK, t30.SALE, t30.REFUND, t30.d_date_sk, t30.d_date_id, t30.d_date, t30.d_month_seq, t30.d_week_seq, t30.d_quarter_seq, t30.d_year, t30.d_dow, t30.d_moy, t30.d_dom, t30.d_qoy, t30.d_fy_year, t30.d_fy_quarter_seq, t30.d_fy_week_seq, t30.d_day_name, t30.d_quarter_name, t30.d_holiday, t30.d_weekend, t30.d_following_holiday, t30.d_first_dom, t30.d_last_dom, t30.d_same_day_ly, t30.d_same_day_lq, t30.d_current_day, t30.d_current_week, t30.d_current_month, t30.d_current_quarter, t30.d_current_year, t30.d_date_sk0, t30.d_date_id0, t30.d_date0, t30.d_month_seq0, t30.d_week_seq0, t30.d_quarter_seq0, t30.d_year0, t30.d_dow0, t30.d_moy0, t30.d_dom0, t30.d_qoy0, t30.d_fy_year0, t30.d_fy_quarter_seq0, t30.d_fy_week_seq0, t30.d_day_name0, t30.d_quarter_name0, t30.d_holiday0, t30.d_weekend0, t30.d_following_holiday0, t30.d_first_dom0, t30.d_last_dom0, t30.d_same_day_ly0, t30.d_same_day_lq0, t30.d_current_day0, t30.d_current_week0, t30.d_current_month0, t30.d_current_quarter0, t30.d_current_year0, t30.d_date_sk1, t30.d_date_id1, t30.d_date1, t30.d_month_seq1, t30.d_week_seq1, t30.d_quarter_seq1, t30.d_year1, t30.d_dow1, t30.d_moy1, t30.d_dom1, t30.d_qoy1, t30.d_fy_year1, t30.d_fy_quarter_seq1, t30.d_fy_week_seq1, t30.d_day_name1, t30.d_quarter_name1, t30.d_holiday1, t30.d_weekend1, t30.d_following_holiday1, t30.d_first_dom1, t30.d_last_dom1, t30.d_same_day_ly1, t30.d_same_day_lq1, t30.d_current_day1, t30.d_current_week1, t30.d_current_month1, t30.d_current_quarter1, t30.d_current_year1, store0.s_store_sk, store0.s_store_id, store0.s_rec_start_date, store0.s_rec_end_date, store0.s_closed_date_sk, store0.s_store_name, store0.s_number_employees, store0.s_floor_space, store0.s_hours, store0.s_manager, store0.s_market_id, store0.s_geography_class, store0.s_market_desc, store0.s_market_manager, store0.s_division_id, store0.s_division_name, store0.s_company_id, store0.s_company_name, store0.s_street_number, store0.s_street_name, store0.s_street_type, store0.s_suite_number, store0.s_city, store0.s_county, store0.s_state, store0.s_zip, store0.s_country, store0.s_gmt_offset, store0.s_tax_percentage
FROM store AS store0
INNER JOIN (SELECT t29.ss_sold_date_sk, t29.ss_sold_time_sk, t29.ss_item_sk, t29.ss_customer_sk, t29.ss_cdemo_sk, t29.ss_hdemo_sk, t29.ss_addr_sk, t29.ss_store_sk, t29.ss_promo_sk, t29.ss_ticket_number, t29.ss_quantity, t29.ss_wholesale_cost, t29.ss_list_price, t29.ss_sales_price, t29.ss_ext_discount_amt, t29.ss_ext_sales_price, t29.ss_ext_wholesale_cost, t29.ss_ext_list_price, t29.ss_ext_tax, t29.ss_coupon_amt, t29.ss_net_paid, t29.ss_net_paid_inc_tax, t29.ss_net_profit, t29.sr_returned_date_sk, t29.sr_return_time_sk, t29.sr_item_sk, t29.sr_customer_sk, t29.sr_cdemo_sk, t29.sr_hdemo_sk, t29.sr_addr_sk, t29.sr_store_sk, t29.sr_reason_sk, t29.sr_ticket_number, t29.sr_return_quantity, t29.sr_return_amt, t29.sr_return_tax, t29.sr_return_amt_inc_tax, t29.sr_fee, t29.sr_return_ship_cost, t29.sr_refunded_cash, t29.sr_reversed_charge, t29.sr_store_credit, t29.sr_net_loss, t29.CS_ITEM_SK, t29.SALE, t29.REFUND, t29.d_date_sk, t29.d_date_id, t29.d_date, t29.d_month_seq, t29.d_week_seq, t29.d_quarter_seq, t29.d_year, t29.d_dow, t29.d_moy, t29.d_dom, t29.d_qoy, t29.d_fy_year, t29.d_fy_quarter_seq, t29.d_fy_week_seq, t29.d_day_name, t29.d_quarter_name, t29.d_holiday, t29.d_weekend, t29.d_following_holiday, t29.d_first_dom, t29.d_last_dom, t29.d_same_day_ly, t29.d_same_day_lq, t29.d_current_day, t29.d_current_week, t29.d_current_month, t29.d_current_quarter, t29.d_current_year, t29.d_date_sk0, t29.d_date_id0, t29.d_date0, t29.d_month_seq0, t29.d_week_seq0, t29.d_quarter_seq0, t29.d_year0, t29.d_dow0, t29.d_moy0, t29.d_dom0, t29.d_qoy0, t29.d_fy_year0, t29.d_fy_quarter_seq0, t29.d_fy_week_seq0, t29.d_day_name0, t29.d_quarter_name0, t29.d_holiday0, t29.d_weekend0, t29.d_following_holiday0, t29.d_first_dom0, t29.d_last_dom0, t29.d_same_day_ly0, t29.d_same_day_lq0, t29.d_current_day0, t29.d_current_week0, t29.d_current_month0, t29.d_current_quarter0, t29.d_current_year0, date_dim2.d_date_sk AS d_date_sk1, date_dim2.d_date_id AS d_date_id1, date_dim2.d_date AS d_date1, date_dim2.d_month_seq AS d_month_seq1, date_dim2.d_week_seq AS d_week_seq1, date_dim2.d_quarter_seq AS d_quarter_seq1, date_dim2.d_year AS d_year1, date_dim2.d_dow AS d_dow1, date_dim2.d_moy AS d_moy1, date_dim2.d_dom AS d_dom1, date_dim2.d_qoy AS d_qoy1, date_dim2.d_fy_year AS d_fy_year1, date_dim2.d_fy_quarter_seq AS d_fy_quarter_seq1, date_dim2.d_fy_week_seq AS d_fy_week_seq1, date_dim2.d_day_name AS d_day_name1, date_dim2.d_quarter_name AS d_quarter_name1, date_dim2.d_holiday AS d_holiday1, date_dim2.d_weekend AS d_weekend1, date_dim2.d_following_holiday AS d_following_holiday1, date_dim2.d_first_dom AS d_first_dom1, date_dim2.d_last_dom AS d_last_dom1, date_dim2.d_same_day_ly AS d_same_day_ly1, date_dim2.d_same_day_lq AS d_same_day_lq1, date_dim2.d_current_day AS d_current_day1, date_dim2.d_current_week AS d_current_week1, date_dim2.d_current_month AS d_current_month1, date_dim2.d_current_quarter AS d_current_quarter1, date_dim2.d_current_year AS d_current_year1
FROM date_dim AS date_dim2,
(SELECT t28.ss_sold_date_sk, t28.ss_sold_time_sk, t28.ss_item_sk, t28.ss_customer_sk, t28.ss_cdemo_sk, t28.ss_hdemo_sk, t28.ss_addr_sk, t28.ss_store_sk, t28.ss_promo_sk, t28.ss_ticket_number, t28.ss_quantity, t28.ss_wholesale_cost, t28.ss_list_price, t28.ss_sales_price, t28.ss_ext_discount_amt, t28.ss_ext_sales_price, t28.ss_ext_wholesale_cost, t28.ss_ext_list_price, t28.ss_ext_tax, t28.ss_coupon_amt, t28.ss_net_paid, t28.ss_net_paid_inc_tax, t28.ss_net_profit, t28.sr_returned_date_sk, t28.sr_return_time_sk, t28.sr_item_sk, t28.sr_customer_sk, t28.sr_cdemo_sk, t28.sr_hdemo_sk, t28.sr_addr_sk, t28.sr_store_sk, t28.sr_reason_sk, t28.sr_ticket_number, t28.sr_return_quantity, t28.sr_return_amt, t28.sr_return_tax, t28.sr_return_amt_inc_tax, t28.sr_fee, t28.sr_return_ship_cost, t28.sr_refunded_cash, t28.sr_reversed_charge, t28.sr_store_credit, t28.sr_net_loss, t28.CS_ITEM_SK, t28.SALE, t28.REFUND, t28.d_date_sk, t28.d_date_id, t28.d_date, t28.d_month_seq, t28.d_week_seq, t28.d_quarter_seq, t28.d_year, t28.d_dow, t28.d_moy, t28.d_dom, t28.d_qoy, t28.d_fy_year, t28.d_fy_quarter_seq, t28.d_fy_week_seq, t28.d_day_name, t28.d_quarter_name, t28.d_holiday, t28.d_weekend, t28.d_following_holiday, t28.d_first_dom, t28.d_last_dom, t28.d_same_day_ly, t28.d_same_day_lq, t28.d_current_day, t28.d_current_week, t28.d_current_month, t28.d_current_quarter, t28.d_current_year, date_dim3.d_date_sk AS d_date_sk0, date_dim3.d_date_id AS d_date_id0, date_dim3.d_date AS d_date0, date_dim3.d_month_seq AS d_month_seq0, date_dim3.d_week_seq AS d_week_seq0, date_dim3.d_quarter_seq AS d_quarter_seq0, date_dim3.d_year AS d_year0, date_dim3.d_dow AS d_dow0, date_dim3.d_moy AS d_moy0, date_dim3.d_dom AS d_dom0, date_dim3.d_qoy AS d_qoy0, date_dim3.d_fy_year AS d_fy_year0, date_dim3.d_fy_quarter_seq AS d_fy_quarter_seq0, date_dim3.d_fy_week_seq AS d_fy_week_seq0, date_dim3.d_day_name AS d_day_name0, date_dim3.d_quarter_name AS d_quarter_name0, date_dim3.d_holiday AS d_holiday0, date_dim3.d_weekend AS d_weekend0, date_dim3.d_following_holiday AS d_following_holiday0, date_dim3.d_first_dom AS d_first_dom0, date_dim3.d_last_dom AS d_last_dom0, date_dim3.d_same_day_ly AS d_same_day_ly0, date_dim3.d_same_day_lq AS d_same_day_lq0, date_dim3.d_current_day AS d_current_day0, date_dim3.d_current_week AS d_current_week0, date_dim3.d_current_month AS d_current_month0, date_dim3.d_current_quarter AS d_current_quarter0, date_dim3.d_current_year AS d_current_year0
FROM date_dim AS date_dim3,
(SELECT store_sales0.ss_sold_date_sk, store_sales0.ss_sold_time_sk, store_sales0.ss_item_sk, store_sales0.ss_customer_sk, store_sales0.ss_cdemo_sk, store_sales0.ss_hdemo_sk, store_sales0.ss_addr_sk, store_sales0.ss_store_sk, store_sales0.ss_promo_sk, store_sales0.ss_ticket_number, store_sales0.ss_quantity, store_sales0.ss_wholesale_cost, store_sales0.ss_list_price, store_sales0.ss_sales_price, store_sales0.ss_ext_discount_amt, store_sales0.ss_ext_sales_price, store_sales0.ss_ext_wholesale_cost, store_sales0.ss_ext_list_price, store_sales0.ss_ext_tax, store_sales0.ss_coupon_amt, store_sales0.ss_net_paid, store_sales0.ss_net_paid_inc_tax, store_sales0.ss_net_profit, store_returns0.sr_returned_date_sk, store_returns0.sr_return_time_sk, store_returns0.sr_item_sk, store_returns0.sr_customer_sk, store_returns0.sr_cdemo_sk, store_returns0.sr_hdemo_sk, store_returns0.sr_addr_sk, store_returns0.sr_store_sk, store_returns0.sr_reason_sk, store_returns0.sr_ticket_number, store_returns0.sr_return_quantity, store_returns0.sr_return_amt, store_returns0.sr_return_tax, store_returns0.sr_return_amt_inc_tax, store_returns0.sr_fee, store_returns0.sr_return_ship_cost, store_returns0.sr_refunded_cash, store_returns0.sr_reversed_charge, store_returns0.sr_store_credit, store_returns0.sr_net_loss, t27.CS_ITEM_SK, t27.SALE, t27.REFUND, date_dim4.d_date_sk, date_dim4.d_date_id, date_dim4.d_date, date_dim4.d_month_seq, date_dim4.d_week_seq, date_dim4.d_quarter_seq, date_dim4.d_year, date_dim4.d_dow, date_dim4.d_moy, date_dim4.d_dom, date_dim4.d_qoy, date_dim4.d_fy_year, date_dim4.d_fy_quarter_seq, date_dim4.d_fy_week_seq, date_dim4.d_day_name, date_dim4.d_quarter_name, date_dim4.d_holiday, date_dim4.d_weekend, date_dim4.d_following_holiday, date_dim4.d_first_dom, date_dim4.d_last_dom, date_dim4.d_same_day_ly, date_dim4.d_same_day_lq, date_dim4.d_current_day, date_dim4.d_current_week, date_dim4.d_current_month, date_dim4.d_current_quarter, date_dim4.d_current_year
FROM date_dim AS date_dim4
INNER JOIN (store_sales AS store_sales0 INNER JOIN store_returns AS store_returns0 ON store_sales0.ss_item_sk = store_returns0.sr_item_sk AND store_sales0.ss_ticket_number = store_returns0.sr_ticket_number INNER JOIN (SELECT catalog_sales0.cs_item_sk AS CS_ITEM_SK, SUM(catalog_sales0.cs_ext_list_price) AS SALE, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS REFUND
FROM catalog_sales AS catalog_sales0
INNER JOIN catalog_returns AS catalog_returns0 ON catalog_sales0.cs_item_sk = catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number = catalog_returns0.cr_order_number
GROUP BY catalog_sales0.cs_item_sk
HAVING SUM(catalog_sales0.cs_ext_list_price) > 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t27 ON store_sales0.ss_item_sk = t27.CS_ITEM_SK) ON date_dim4.d_date_sk = store_sales0.ss_sold_date_sk) AS t28) AS t29) AS t30 ON store0.s_store_sk = t30.ss_store_sk) AS t31 ON customer0.c_customer_sk = t31.ss_customer_sk AND customer0.c_first_sales_date_sk = t31.d_date_sk0 AND customer0.c_first_shipto_date_sk = t31.d_date_sk1) AS t32 ON customer_demographics2.cd_demo_sk = t32.ss_cdemo_sk) AS t33 ON customer_demographics1.cd_demo_sk = t33.c_current_cdemo_sk AND t33.cd_marital_status <> customer_demographics1.cd_marital_status) AS t34 ON promotion0.p_promo_sk = t34.ss_promo_sk) AS t35 ON household_demographics2.hd_demo_sk = t35.ss_hdemo_sk) AS t36 ON household_demographics1.hd_demo_sk = t36.c_current_hdemo_sk) AS t37 ON customer_address2.ca_address_sk = t37.ss_addr_sk) AS t38 ON customer_address1.ca_address_sk = t38.c_current_addr_sk) AS t39 ON income_band2.ib_income_band_sk = t39.hd_income_band_sk) AS t40 ON income_band1.ib_income_band_sk = t40.hd_income_band_sk0) AS t41 ON t23.i_item_sk = t41.ss_item_sk
GROUP BY t23.i_product_name, t23.i_item_sk, t41.s_store_name, t41.s_zip, t41.ca_street_number, t41.ca_street_name, t41.ca_city, t41.ca_zip, t41.ca_street_number0, t41.ca_street_name0, t41.ca_city0, t41.ca_zip0, t41.d_year, t41.d_year0, t41.d_year1
HAVING t41.d_year = CAST(1999 + 1 AS BIGINT)) AS t46 ON t22.ITEM_SK = t46.ITEM_SK AND t22.CNT >= t46.CNT AND t22.STORE_NAME = t46.STORE_NAME AND t22.STORE_ZIP = t46.STORE_ZIP
ORDER BY t22.PRODUCT_NAME, t22.STORE_NAME, t46.CNT, t22.S1, t46.S1