{
  "query": "q4",
  "status": "pending",
  "rules": [
    "FILTER_INTO_JOIN",
    "FILTER_PROJECT_TRANSPOSE",
    "FILTER_SCAN",
    "PROJECT_MERGE",
    "FILTER_AGGREGATE_TRANSPOSE",
    "JOIN_CONDITION_PUSH",
    "SORT_PROJECT_TRANSPOSE"
  ],
  "optimizedSql": "SELECT t22.CUSTOMER_ID, t22.CUSTOMER_FIRST_NAME, t22.CUSTOMER_LAST_NAME, t22.CUSTOMER_PREFERRED_CUST_FLAG\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT customer.c_customer_id AS CUSTOMER_ID, customer.c_first_name AS CUSTOMER_FIRST_NAME, customer.c_last_name AS CUSTOMER_LAST_NAME, customer.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer.c_login AS CUSTOMER_LOGIN, customer.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim.d_year AS DYEAR, SUM((store_sales.ss_ext_list_price - store_sales.ss_ext_wholesale_cost - store_sales.ss_ext_discount_amt + store_sales.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer\nINNER JOIN store_sales ON customer.c_customer_sk \u003d store_sales.ss_customer_sk\nINNER JOIN date_dim ON store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk\nGROUP BY customer.c_customer_id, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, date_dim.d_year\nUNION ALL\nSELECT customer0.c_customer_id AS CUSTOMER_ID, customer0.c_first_name AS CUSTOMER_FIRST_NAME, customer0.c_last_name AS CUSTOMER_LAST_NAME, customer0.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer0.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer0.c_login AS CUSTOMER_LOGIN, customer0.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim0.d_year AS DYEAR, SUM((catalog_sales.cs_ext_list_price - catalog_sales.cs_ext_wholesale_cost - catalog_sales.cs_ext_discount_amt + catalog_sales.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer0\nINNER JOIN catalog_sales ON customer0.c_customer_sk \u003d catalog_sales.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim0 ON catalog_sales.cs_sold_date_sk \u003d date_dim0.d_date_sk\nGROUP BY customer0.c_customer_id, customer0.c_first_name, customer0.c_last_name, customer0.c_preferred_cust_flag, customer0.c_birth_country, customer0.c_login, customer0.c_email_address, date_dim0.d_year)\nUNION ALL\nSELECT customer1.c_customer_id AS CUSTOMER_ID, customer1.c_first_name AS CUSTOMER_FIRST_NAME, customer1.c_last_name AS CUSTOMER_LAST_NAME, customer1.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer1.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer1.c_login AS CUSTOMER_LOGIN, customer1.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim1.d_year AS DYEAR, SUM((web_sales.ws_ext_list_price - web_sales.ws_ext_wholesale_cost - web_sales.ws_ext_discount_amt + web_sales.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer1\nINNER JOIN web_sales ON customer1.c_customer_sk \u003d web_sales.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim1 ON web_sales.ws_sold_date_sk \u003d date_dim1.d_date_sk\nGROUP BY customer1.c_customer_id, customer1.c_first_name, customer1.c_last_name, customer1.c_preferred_cust_flag, customer1.c_birth_country, customer1.c_login, customer1.c_email_address, date_dim1.d_year) AS t9\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND DYEAR \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t10\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer2.c_customer_id AS CUSTOMER_ID, customer2.c_first_name AS CUSTOMER_FIRST_NAME, customer2.c_last_name AS CUSTOMER_LAST_NAME, customer2.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer2.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer2.c_login AS CUSTOMER_LOGIN, customer2.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim2.d_year AS DYEAR, SUM((store_sales0.ss_ext_list_price - store_sales0.ss_ext_wholesale_cost - store_sales0.ss_ext_discount_amt + store_sales0.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer2\nINNER JOIN store_sales AS store_sales0 ON customer2.c_customer_sk \u003d store_sales0.ss_customer_sk\nINNER JOIN date_dim AS date_dim2 ON store_sales0.ss_sold_date_sk \u003d date_dim2.d_date_sk\nGROUP BY customer2.c_customer_id, customer2.c_first_name, customer2.c_last_name, customer2.c_preferred_cust_flag, customer2.c_birth_country, customer2.c_login, customer2.c_email_address, date_dim2.d_year\nUNION ALL\nSELECT customer3.c_customer_id AS CUSTOMER_ID, customer3.c_first_name AS CUSTOMER_FIRST_NAME, customer3.c_last_name AS CUSTOMER_LAST_NAME, customer3.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer3.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer3.c_login AS CUSTOMER_LOGIN, customer3.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim3.d_year AS DYEAR, SUM((catalog_sales0.cs_ext_list_price - catalog_sales0.cs_ext_wholesale_cost - catalog_sales0.cs_ext_discount_amt + catalog_sales0.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer3\nINNER JOIN catalog_sales AS catalog_sales0 ON customer3.c_customer_sk \u003d catalog_sales0.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim3 ON catalog_sales0.cs_sold_date_sk \u003d date_dim3.d_date_sk\nGROUP BY customer3.c_customer_id, customer3.c_first_name, customer3.c_last_name, customer3.c_preferred_cust_flag, customer3.c_birth_country, customer3.c_login, customer3.c_email_address, date_dim3.d_year)\nUNION ALL\nSELECT customer4.c_customer_id AS CUSTOMER_ID, customer4.c_first_name AS CUSTOMER_FIRST_NAME, customer4.c_last_name AS CUSTOMER_LAST_NAME, customer4.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer4.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer4.c_login AS CUSTOMER_LOGIN, customer4.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim4.d_year AS DYEAR, SUM((web_sales0.ws_ext_list_price - web_sales0.ws_ext_wholesale_cost - web_sales0.ws_ext_discount_amt + web_sales0.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer4\nINNER JOIN web_sales AS web_sales0 ON customer4.c_customer_sk \u003d web_sales0.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim4 ON web_sales0.ws_sold_date_sk \u003d date_dim4.d_date_sk\nGROUP BY customer4.c_customer_id, customer4.c_first_name, customer4.c_last_name, customer4.c_preferred_cust_flag, customer4.c_birth_country, customer4.c_login, customer4.c_email_address, date_dim4.d_year) AS t21\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND DYEAR \u003d CAST(2001 + 1 AS BIGINT)) AS t22 ON t10.CUSTOMER_ID \u003d t22.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer5.c_customer_id AS CUSTOMER_ID, customer5.c_first_name AS CUSTOMER_FIRST_NAME, customer5.c_last_name AS CUSTOMER_LAST_NAME, customer5.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer5.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer5.c_login AS CUSTOMER_LOGIN, customer5.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim5.d_year AS DYEAR, SUM((store_sales1.ss_ext_list_price - store_sales1.ss_ext_wholesale_cost - store_sales1.ss_ext_discount_amt + store_sales1.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer5\nINNER JOIN store_sales AS store_sales1 ON customer5.c_customer_sk \u003d store_sales1.ss_customer_sk\nINNER JOIN date_dim AS date_dim5 ON store_sales1.ss_sold_date_sk \u003d date_dim5.d_date_sk\nGROUP BY customer5.c_customer_id, customer5.c_first_name, customer5.c_last_name, customer5.c_preferred_cust_flag, customer5.c_birth_country, customer5.c_login, customer5.c_email_address, date_dim5.d_year\nUNION ALL\nSELECT customer6.c_customer_id AS CUSTOMER_ID, customer6.c_first_name AS CUSTOMER_FIRST_NAME, customer6.c_last_name AS CUSTOMER_LAST_NAME, customer6.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer6.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer6.c_login AS CUSTOMER_LOGIN, customer6.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim6.d_year AS DYEAR, SUM((catalog_sales1.cs_ext_list_price - catalog_sales1.cs_ext_wholesale_cost - catalog_sales1.cs_ext_discount_amt + catalog_sales1.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer6\nINNER JOIN catalog_sales AS catalog_sales1 ON customer6.c_customer_sk \u003d catalog_sales1.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim6 ON catalog_sales1.cs_sold_date_sk \u003d date_dim6.d_date_sk\nGROUP BY customer6.c_customer_id, customer6.c_first_name, customer6.c_last_name, customer6.c_preferred_cust_flag, customer6.c_birth_country, customer6.c_login, customer6.c_email_address, date_dim6.d_year)\nUNION ALL\nSELECT customer7.c_customer_id AS CUSTOMER_ID, customer7.c_first_name AS CUSTOMER_FIRST_NAME, customer7.c_last_name AS CUSTOMER_LAST_NAME, customer7.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer7.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer7.c_login AS CUSTOMER_LOGIN, customer7.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim7.d_year AS DYEAR, SUM((web_sales1.ws_ext_list_price - web_sales1.ws_ext_wholesale_cost - web_sales1.ws_ext_discount_amt + web_sales1.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer7\nINNER JOIN web_sales AS web_sales1 ON customer7.c_customer_sk \u003d web_sales1.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim7 ON web_sales1.ws_sold_date_sk \u003d date_dim7.d_date_sk\nGROUP BY customer7.c_customer_id, customer7.c_first_name, customer7.c_last_name, customer7.c_preferred_cust_flag, customer7.c_birth_country, customer7.c_login, customer7.c_email_address, date_dim7.d_year) AS t33\nWHERE SALE_TYPE \u003d \u0027c\u0027 AND DYEAR \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t34 ON t10.CUSTOMER_ID \u003d t34.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer8.c_customer_id AS CUSTOMER_ID, customer8.c_first_name AS CUSTOMER_FIRST_NAME, customer8.c_last_name AS CUSTOMER_LAST_NAME, customer8.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer8.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer8.c_login AS CUSTOMER_LOGIN, customer8.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim8.d_year AS DYEAR, SUM((store_sales2.ss_ext_list_price - store_sales2.ss_ext_wholesale_cost - store_sales2.ss_ext_discount_amt + store_sales2.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer8\nINNER JOIN store_sales AS store_sales2 ON customer8.c_customer_sk \u003d store_sales2.ss_customer_sk\nINNER JOIN date_dim AS date_dim8 ON store_sales2.ss_sold_date_sk \u003d date_dim8.d_date_sk\nGROUP BY customer8.c_customer_id, customer8.c_first_name, customer8.c_last_name, customer8.c_preferred_cust_flag, customer8.c_birth_country, customer8.c_login, customer8.c_email_address, date_dim8.d_year\nUNION ALL\nSELECT customer9.c_customer_id AS CUSTOMER_ID, customer9.c_first_name AS CUSTOMER_FIRST_NAME, customer9.c_last_name AS CUSTOMER_LAST_NAME, customer9.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer9.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer9.c_login AS CUSTOMER_LOGIN, customer9.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim9.d_year AS DYEAR, SUM((catalog_sales2.cs_ext_list_price - catalog_sales2.cs_ext_wholesale_cost - catalog_sales2.cs_ext_discount_amt + catalog_sales2.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer9\nINNER JOIN catalog_sales AS catalog_sales2 ON customer9.c_customer_sk \u003d catalog_sales2.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim9 ON catalog_sales2.cs_sold_date_sk \u003d date_dim9.d_date_sk\nGROUP BY customer9.c_customer_id, customer9.c_first_name, customer9.c_last_name, customer9.c_preferred_cust_flag, customer9.c_birth_country, customer9.c_login, customer9.c_email_address, date_dim9.d_year)\nUNION ALL\nSELECT customer10.c_customer_id AS CUSTOMER_ID, customer10.c_first_name AS CUSTOMER_FIRST_NAME, customer10.c_last_name AS CUSTOMER_LAST_NAME, customer10.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer10.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer10.c_login AS CUSTOMER_LOGIN, customer10.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim10.d_year AS DYEAR, SUM((web_sales2.ws_ext_list_price - web_sales2.ws_ext_wholesale_cost - web_sales2.ws_ext_discount_amt + web_sales2.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer10\nINNER JOIN web_sales AS web_sales2 ON customer10.c_customer_sk \u003d web_sales2.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim10 ON web_sales2.ws_sold_date_sk \u003d date_dim10.d_date_sk\nGROUP BY customer10.c_customer_id, customer10.c_first_name, customer10.c_last_name, customer10.c_preferred_cust_flag, customer10.c_birth_country, customer10.c_login, customer10.c_email_address, date_dim10.d_year) AS t45\nWHERE SALE_TYPE \u003d \u0027c\u0027 AND DYEAR \u003d CAST(2001 + 1 AS BIGINT)) AS t46 ON t10.CUSTOMER_ID \u003d t46.CUSTOMER_ID AND CASE WHEN t34.YEAR_TOTAL \u003e 0 THEN t46.YEAR_TOTAL / t34.YEAR_TOTAL ELSE NULL END \u003e CASE WHEN t10.YEAR_TOTAL \u003e 0 THEN t22.YEAR_TOTAL / t10.YEAR_TOTAL ELSE NULL END\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer11.c_customer_id AS CUSTOMER_ID, customer11.c_first_name AS CUSTOMER_FIRST_NAME, customer11.c_last_name AS CUSTOMER_LAST_NAME, customer11.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer11.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer11.c_login AS CUSTOMER_LOGIN, customer11.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim11.d_year AS DYEAR, SUM((store_sales3.ss_ext_list_price - store_sales3.ss_ext_wholesale_cost - store_sales3.ss_ext_discount_amt + store_sales3.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer11\nINNER JOIN store_sales AS store_sales3 ON customer11.c_customer_sk \u003d store_sales3.ss_customer_sk\nINNER JOIN date_dim AS date_dim11 ON store_sales3.ss_sold_date_sk \u003d date_dim11.d_date_sk\nGROUP BY customer11.c_customer_id, customer11.c_first_name, customer11.c_last_name, customer11.c_preferred_cust_flag, customer11.c_birth_country, customer11.c_login, customer11.c_email_address, date_dim11.d_year\nUNION ALL\nSELECT customer12.c_customer_id AS CUSTOMER_ID, customer12.c_first_name AS CUSTOMER_FIRST_NAME, customer12.c_last_name AS CUSTOMER_LAST_NAME, customer12.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer12.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer12.c_login AS CUSTOMER_LOGIN, customer12.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim12.d_year AS DYEAR, SUM((catalog_sales3.cs_ext_list_price - catalog_sales3.cs_ext_wholesale_cost - catalog_sales3.cs_ext_discount_amt + catalog_sales3.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer12\nINNER JOIN catalog_sales AS catalog_sales3 ON customer12.c_customer_sk \u003d catalog_sales3.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim12 ON catalog_sales3.cs_sold_date_sk \u003d date_dim12.d_date_sk\nGROUP BY customer12.c_customer_id, customer12.c_first_name, customer12.c_last_name, customer12.c_preferred_cust_flag, customer12.c_birth_country, customer12.c_login, customer12.c_email_address, date_dim12.d_year)\nUNION ALL\nSELECT customer13.c_customer_id AS CUSTOMER_ID, customer13.c_first_name AS CUSTOMER_FIRST_NAME, customer13.c_last_name AS CUSTOMER_LAST_NAME, customer13.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer13.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer13.c_login AS CUSTOMER_LOGIN, customer13.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim13.d_year AS DYEAR, SUM((web_sales3.ws_ext_list_price - web_sales3.ws_ext_wholesale_cost - web_sales3.ws_ext_discount_amt + web_sales3.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer13\nINNER JOIN web_sales AS web_sales3 ON customer13.c_customer_sk \u003d web_sales3.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim13 ON web_sales3.ws_sold_date_sk \u003d date_dim13.d_date_sk\nGROUP BY customer13.c_customer_id, customer13.c_first_name, customer13.c_last_name, customer13.c_preferred_cust_flag, customer13.c_birth_country, customer13.c_login, customer13.c_email_address, date_dim13.d_year) AS t57\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND DYEAR \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t58 ON t10.CUSTOMER_ID \u003d t58.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer14.c_customer_id AS CUSTOMER_ID, customer14.c_first_name AS CUSTOMER_FIRST_NAME, customer14.c_last_name AS CUSTOMER_LAST_NAME, customer14.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer14.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer14.c_login AS CUSTOMER_LOGIN, customer14.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim14.d_year AS DYEAR, SUM((store_sales4.ss_ext_list_price - store_sales4.ss_ext_wholesale_cost - store_sales4.ss_ext_discount_amt + store_sales4.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer14\nINNER JOIN store_sales AS store_sales4 ON customer14.c_customer_sk \u003d store_sales4.ss_customer_sk\nINNER JOIN date_dim AS date_dim14 ON store_sales4.ss_sold_date_sk \u003d date_dim14.d_date_sk\nGROUP BY customer14.c_customer_id, customer14.c_first_name, customer14.c_last_name, customer14.c_preferred_cust_flag, customer14.c_birth_country, customer14.c_login, customer14.c_email_address, date_dim14.d_year\nUNION ALL\nSELECT customer15.c_customer_id AS CUSTOMER_ID, customer15.c_first_name AS CUSTOMER_FIRST_NAME, customer15.c_last_name AS CUSTOMER_LAST_NAME, customer15.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer15.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer15.c_login AS CUSTOMER_LOGIN, customer15.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim15.d_year AS DYEAR, SUM((catalog_sales4.cs_ext_list_price - catalog_sales4.cs_ext_wholesale_cost - catalog_sales4.cs_ext_discount_amt + catalog_sales4.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer15\nINNER JOIN catalog_sales AS catalog_sales4 ON customer15.c_customer_sk \u003d catalog_sales4.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim15 ON catalog_sales4.cs_sold_date_sk \u003d date_dim15.d_date_sk\nGROUP BY customer15.c_customer_id, customer15.c_first_name, customer15.c_last_name, customer15.c_preferred_cust_flag, customer15.c_birth_country, customer15.c_login, customer15.c_email_address, date_dim15.d_year)\nUNION ALL\nSELECT customer16.c_customer_id AS CUSTOMER_ID, customer16.c_first_name AS CUSTOMER_FIRST_NAME, customer16.c_last_name AS CUSTOMER_LAST_NAME, customer16.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer16.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer16.c_login AS CUSTOMER_LOGIN, customer16.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim16.d_year AS DYEAR, SUM((web_sales4.ws_ext_list_price - web_sales4.ws_ext_wholesale_cost - web_sales4.ws_ext_discount_amt + web_sales4.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer16\nINNER JOIN web_sales AS web_sales4 ON customer16.c_customer_sk \u003d web_sales4.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim16 ON web_sales4.ws_sold_date_sk \u003d date_dim16.d_date_sk\nGROUP BY customer16.c_customer_id, customer16.c_first_name, customer16.c_last_name, customer16.c_preferred_cust_flag, customer16.c_birth_country, customer16.c_login, customer16.c_email_address, date_dim16.d_year) AS t69\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND DYEAR \u003d CAST(2001 + 1 AS BIGINT)) AS t70 ON t10.CUSTOMER_ID \u003d t70.CUSTOMER_ID AND CASE WHEN t34.YEAR_TOTAL \u003e 0 THEN t46.YEAR_TOTAL / t34.YEAR_TOTAL ELSE NULL END \u003e CASE WHEN t58.YEAR_TOTAL \u003e 0 THEN t70.YEAR_TOTAL / t58.YEAR_TOTAL ELSE NULL END\nORDER BY t22.CUSTOMER_ID NULLS FIRST, t22.CUSTOMER_FIRST_NAME NULLS FIRST, t22.CUSTOMER_LAST_NAME NULLS FIRST, t22.CUSTOMER_PREFERRED_CUST_FLAG NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    450,
    426
  ],
  "optimizedTimesMs": [
    416,
    424
  ],
  "originalAvgMs": 438,
  "optimizedAvgMs": 420,
  "speedup": 1.042857142857143,
  "originalRowCount": 0,
  "optimizedRowCount": 0,
  "validationPassed": true,
  "originalPlanMaxRows": 2878107,
  "optimizedPlanMaxRows": 2878107
}