{
  "query": "q74",
  "status": "pending",
  "rules": [
    "FILTER_INTO_JOIN",
    "FILTER_PROJECT_TRANSPOSE",
    "FILTER_SCAN",
    "JOIN_CONDITION_PUSH",
    "PROJECT_MERGE",
    "FILTER_AGGREGATE_TRANSPOSE"
  ],
  "optimizedSql": "SELECT t18.CUSTOMER_ID, t18.CUSTOMER_FIRST_NAME, t18.CUSTOMER_LAST_NAME\nFROM (SELECT *\nFROM (SELECT customer.c_customer_id AS CUSTOMER_ID, customer.c_first_name AS CUSTOMER_FIRST_NAME, customer.c_last_name AS CUSTOMER_LAST_NAME, t.d_year AS YEAR_, SUM(store_sales.ss_net_paid) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer\nINNER JOIN store_sales ON customer.c_customer_sk \u003d store_sales.ss_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nGROUP BY customer.c_customer_id, customer.c_first_name, customer.c_last_name, t.d_year\nUNION ALL\nSELECT customer0.c_customer_id AS CUSTOMER_ID, customer0.c_first_name AS CUSTOMER_FIRST_NAME, customer0.c_last_name AS CUSTOMER_LAST_NAME, t3.d_year AS YEAR_, SUM(web_sales.ws_net_paid) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer0\nINNER JOIN web_sales ON customer0.c_customer_sk \u003d web_sales.ws_bill_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t3 ON web_sales.ws_sold_date_sk \u003d t3.d_date_sk\nGROUP BY customer0.c_customer_id, customer0.c_first_name, customer0.c_last_name, t3.d_year) AS t7\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND YEAR_ \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t8\nINNER JOIN (SELECT *\nFROM (SELECT customer1.c_customer_id AS CUSTOMER_ID, customer1.c_first_name AS CUSTOMER_FIRST_NAME, customer1.c_last_name AS CUSTOMER_LAST_NAME, t9.d_year AS YEAR_, SUM(store_sales0.ss_net_paid) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer1\nINNER JOIN store_sales AS store_sales0 ON customer1.c_customer_sk \u003d store_sales0.ss_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t9 ON store_sales0.ss_sold_date_sk \u003d t9.d_date_sk\nGROUP BY customer1.c_customer_id, customer1.c_first_name, customer1.c_last_name, t9.d_year\nUNION ALL\nSELECT customer2.c_customer_id AS CUSTOMER_ID, customer2.c_first_name AS CUSTOMER_FIRST_NAME, customer2.c_last_name AS CUSTOMER_LAST_NAME, t13.d_year AS YEAR_, SUM(web_sales0.ws_net_paid) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer2\nINNER JOIN web_sales AS web_sales0 ON customer2.c_customer_sk \u003d web_sales0.ws_bill_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t13 ON web_sales0.ws_sold_date_sk \u003d t13.d_date_sk\nGROUP BY customer2.c_customer_id, customer2.c_first_name, customer2.c_last_name, t13.d_year) AS t17\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND YEAR_ \u003d CAST(2001 + 1 AS BIGINT)) AS t18 ON t8.CUSTOMER_ID \u003d t18.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT customer3.c_customer_id AS CUSTOMER_ID, customer3.c_first_name AS CUSTOMER_FIRST_NAME, customer3.c_last_name AS CUSTOMER_LAST_NAME, t19.d_year AS YEAR_, SUM(store_sales1.ss_net_paid) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer3\nINNER JOIN store_sales AS store_sales1 ON customer3.c_customer_sk \u003d store_sales1.ss_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t19 ON store_sales1.ss_sold_date_sk \u003d t19.d_date_sk\nGROUP BY customer3.c_customer_id, customer3.c_first_name, customer3.c_last_name, t19.d_year\nUNION ALL\nSELECT customer4.c_customer_id AS CUSTOMER_ID, customer4.c_first_name AS CUSTOMER_FIRST_NAME, customer4.c_last_name AS CUSTOMER_LAST_NAME, t23.d_year AS YEAR_, SUM(web_sales1.ws_net_paid) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer4\nINNER JOIN web_sales AS web_sales1 ON customer4.c_customer_sk \u003d web_sales1.ws_bill_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t23 ON web_sales1.ws_sold_date_sk \u003d t23.d_date_sk\nGROUP BY customer4.c_customer_id, customer4.c_first_name, customer4.c_last_name, t23.d_year) AS t27\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND YEAR_ \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t28 ON t8.CUSTOMER_ID \u003d t28.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT customer5.c_customer_id AS CUSTOMER_ID, customer5.c_first_name AS CUSTOMER_FIRST_NAME, customer5.c_last_name AS CUSTOMER_LAST_NAME, t29.d_year AS YEAR_, SUM(store_sales2.ss_net_paid) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer5\nINNER JOIN store_sales AS store_sales2 ON customer5.c_customer_sk \u003d store_sales2.ss_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t29 ON store_sales2.ss_sold_date_sk \u003d t29.d_date_sk\nGROUP BY customer5.c_customer_id, customer5.c_first_name, customer5.c_last_name, t29.d_year\nUNION ALL\nSELECT customer6.c_customer_id AS CUSTOMER_ID, customer6.c_first_name AS CUSTOMER_FIRST_NAME, customer6.c_last_name AS CUSTOMER_LAST_NAME, t33.d_year AS YEAR_, SUM(web_sales2.ws_net_paid) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer6\nINNER JOIN web_sales AS web_sales2 ON customer6.c_customer_sk \u003d web_sales2.ws_bill_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t33 ON web_sales2.ws_sold_date_sk \u003d t33.d_date_sk\nGROUP BY customer6.c_customer_id, customer6.c_first_name, customer6.c_last_name, t33.d_year) AS t37\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND YEAR_ \u003d CAST(2001 + 1 AS BIGINT)) AS t38 ON t8.CUSTOMER_ID \u003d t38.CUSTOMER_ID AND CASE WHEN t28.YEAR_TOTAL \u003e 0 THEN t38.YEAR_TOTAL / t28.YEAR_TOTAL ELSE NULL END \u003e CASE WHEN t8.YEAR_TOTAL \u003e 0 THEN t18.YEAR_TOTAL / t8.YEAR_TOTAL ELSE NULL END\nORDER BY t18.CUSTOMER_ID NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    198,
    202
  ],
  "optimizedTimesMs": [
    179,
    188
  ],
  "originalAvgMs": 200,
  "optimizedAvgMs": 183,
  "speedup": 1.092896174863388,
  "originalRowCount": 100,
  "optimizedRowCount": 100,
  "validationPassed": true,
  "originalPlanMaxRows": 45150932,
  "optimizedPlanMaxRows": 2878107
}