{
  "query": "q40",
  "status": "pending",
  "rules": [
    "FILTER_SCAN",
    "FILTER_INTO_JOIN",
    "PROJECT_MERGE",
    "SORT_REMOVE_REDUNDANT",
    "AGGREGATE_CASE_TO_FILTER"
  ],
  "optimizedSql": "SELECT warehouse.w_state AS W_STATE, t.i_item_id AS I_ITEM_ID, SUM(CASE WHEN t0.d_date \u003c DATE \u00272000-03-11\u0027 THEN catalog_sales.cs_sales_price - CASE WHEN catalog_returns.cr_refunded_cash IS NOT NULL THEN CAST(catalog_returns.cr_refunded_cash AS DECIMAL(19, 0)) ELSE 0 END ELSE 0 END) AS SALES_BEFORE, SUM(CASE WHEN t0.d_date \u003e\u003d DATE \u00272000-03-11\u0027 THEN catalog_sales.cs_sales_price - CASE WHEN catalog_returns.cr_refunded_cash IS NOT NULL THEN CAST(catalog_returns.cr_refunded_cash AS DECIMAL(19, 0)) ELSE 0 END ELSE 0 END) AS SALES_AFTER\nFROM catalog_sales\nLEFT JOIN catalog_returns ON catalog_sales.cs_order_number \u003d catalog_returns.cr_order_number AND catalog_sales.cs_item_sk \u003d catalog_returns.cr_item_sk\nINNER JOIN warehouse ON catalog_sales.cs_warehouse_sk \u003d warehouse.w_warehouse_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_current_price \u003e\u003d 0.99 AND i_current_price \u003c\u003d 1.49) AS t ON catalog_sales.cs_item_sk \u003d t.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-02-10\u0027 AND d_date \u003c\u003d DATE \u00272000-04-10\u0027) AS t0 ON catalog_sales.cs_sold_date_sk \u003d t0.d_date_sk\nGROUP BY warehouse.w_state, t.i_item_id\nORDER BY warehouse.w_state, t.i_item_id\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    16,
    18
  ],
  "optimizedTimesMs": [
    16,
    16
  ],
  "originalAvgMs": 17,
  "optimizedAvgMs": 16,
  "speedup": 1.0625,
  "originalRowCount": 100,
  "optimizedRowCount": 100,
  "validationPassed": true,
  "originalPlanMaxRows": 1439513,
  "optimizedPlanMaxRows": 1439513
}