[
  {
    "query": "q1",
    "status": "error",
    "error": "variable $cor0 is not found",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "SUBQUERY_REMOVE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q2",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "AGGREGATE_CASE_TO_FILTER",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t7.D_WEEK_SEQ1, ROUND(t7.SUN_SALES1 / t16.SUN_SALES2, 2) AS R1, ROUND(t7.MON_SALES1 / t16.MON_SALES2, 2) AS R2, ROUND(t7.TUE_SALES1 / t16.TUE_SALES2, 2) AS R3, ROUND(t7.WED_SALES1 / t16.WED_SALES2, 2) AS R4, ROUND(t7.THU_SALES1 / t16.THU_SALES2, 2) AS R5, ROUND(t7.FRI_SALES1 / t16.FRI_SALES2, 2) AS R6, ROUND(t7.SAT_SALES1 / t16.SAT_SALES2, 2)\nFROM (SELECT t5.D_WEEK_SEQ AS D_WEEK_SEQ1, t5.SUN_SALES AS SUN_SALES1, t5.MON_SALES AS MON_SALES1, t5.TUE_SALES AS TUE_SALES1, t5.WED_SALES AS WED_SALES1, t5.THU_SALES AS THU_SALES1, t5.FRI_SALES AS FRI_SALES1, t5.SAT_SALES AS SAT_SALES1\nFROM (SELECT date_dim.d_week_seq AS D_WEEK_SEQ, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Sunday\u0027 IS TRUE) AS SUN_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Monday\u0027 IS TRUE) AS MON_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Tuesday\u0027 IS TRUE) AS TUE_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Wednesday\u0027 IS TRUE) AS WED_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Thursday\u0027 IS TRUE) AS THU_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Friday\u0027 IS TRUE) AS FRI_SALES, SUM(t2.SALES_PRICE) FILTER (WHERE date_dim.d_day_name \u003d \u0027Saturday\u0027 IS TRUE) AS SAT_SALES\nFROM (SELECT *\nFROM (SELECT ws_sold_date_sk AS SOLD_DATE_SK, ws_ext_sales_price AS SALES_PRICE\nFROM web_sales\nUNION ALL\nSELECT cs_sold_date_sk AS SOLD_DATE_SK, cs_ext_sales_price AS SALES_PRICE\nFROM catalog_sales) AS t1) AS t2\nINNER JOIN date_dim ON t2.SOLD_DATE_SK \u003d date_dim.d_date_sk\nGROUP BY date_dim.d_week_seq) AS t5\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t6 ON t5.D_WEEK_SEQ \u003d t6.d_week_seq) AS t7\nINNER JOIN (SELECT t14.D_WEEK_SEQ AS D_WEEK_SEQ2, t14.SUN_SALES AS SUN_SALES2, t14.MON_SALES AS MON_SALES2, t14.TUE_SALES AS TUE_SALES2, t14.WED_SALES AS WED_SALES2, t14.THU_SALES AS THU_SALES2, t14.FRI_SALES AS FRI_SALES2, t14.SAT_SALES AS SAT_SALES2\nFROM (SELECT date_dim1.d_week_seq AS D_WEEK_SEQ, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Sunday\u0027 IS TRUE) AS SUN_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Monday\u0027 IS TRUE) AS MON_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Tuesday\u0027 IS TRUE) AS TUE_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Wednesday\u0027 IS TRUE) AS WED_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Thursday\u0027 IS TRUE) AS THU_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Friday\u0027 IS TRUE) AS FRI_SALES, SUM(t11.SALES_PRICE) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Saturday\u0027 IS TRUE) AS SAT_SALES\nFROM (SELECT *\nFROM (SELECT ws_sold_date_sk AS SOLD_DATE_SK, ws_ext_sales_price AS SALES_PRICE\nFROM web_sales\nUNION ALL\nSELECT cs_sold_date_sk AS SOLD_DATE_SK, cs_ext_sales_price AS SALES_PRICE\nFROM catalog_sales) AS t10) AS t11\nINNER JOIN date_dim AS date_dim1 ON t11.SOLD_DATE_SK \u003d date_dim1.d_date_sk\nGROUP BY date_dim1.d_week_seq) AS t14\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t15 ON t14.D_WEEK_SEQ \u003d t15.d_week_seq) AS t16 ON t7.D_WEEK_SEQ1 \u003d t16.D_WEEK_SEQ2 - 53\nORDER BY t7.D_WEEK_SEQ1 NULLS FIRST",
    "originalTimesMs": [
      32,
      23
    ],
    "optimizedTimesMs": [
      44,
      50
    ],
    "originalAvgMs": 27,
    "optimizedAvgMs": 47,
    "speedup": 0.574468085106383,
    "originalRowCount": 2513,
    "optimizedRowCount": 2513,
    "validationPassed": true,
    "originalPlanMaxRows": 2159358,
    "optimizedPlanMaxRows": 2159358
  },
  {
    "query": "q3",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t3.d_year AS D_YEAR, t3.i_brand_id AS BRAND_ID, t3.i_brand AS BRAND, t3.SUM_AGG\nFROM (SELECT t.d_year, t0.i_brand, t0.i_brand_id, SUM(store_sales.ss_ext_sales_price) AS SUM_AGG\nFROM (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 11) AS t\nINNER JOIN store_sales ON t.d_date_sk \u003d store_sales.ss_sold_date_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_manufact_id \u003d 128) AS t0 ON store_sales.ss_item_sk \u003d t0.i_item_sk\nGROUP BY t.d_year, t0.i_brand, t0.i_brand_id\nORDER BY t.d_year, 4 DESC, t0.i_brand_id\nFETCH NEXT 100 ROWS ONLY) AS t3",
    "originalTimesMs": [
      11,
      11
    ],
    "optimizedTimesMs": [
      11,
      11
    ],
    "originalAvgMs": 11,
    "optimizedAvgMs": 11,
    "speedup": 1.0,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q4",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t22.CUSTOMER_ID, t22.CUSTOMER_FIRST_NAME, t22.CUSTOMER_LAST_NAME, t22.CUSTOMER_PREFERRED_CUST_FLAG\nFROM (SELECT *\nFROM (SELECT *\nFROM (SELECT customer.c_customer_id AS CUSTOMER_ID, customer.c_first_name AS CUSTOMER_FIRST_NAME, customer.c_last_name AS CUSTOMER_LAST_NAME, customer.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer.c_login AS CUSTOMER_LOGIN, customer.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim.d_year AS DYEAR, SUM((store_sales.ss_ext_list_price - store_sales.ss_ext_wholesale_cost - store_sales.ss_ext_discount_amt + store_sales.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer\nINNER JOIN store_sales ON customer.c_customer_sk \u003d store_sales.ss_customer_sk\nINNER JOIN date_dim ON store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk\nGROUP BY customer.c_customer_id, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, date_dim.d_year\nUNION ALL\nSELECT customer0.c_customer_id AS CUSTOMER_ID, customer0.c_first_name AS CUSTOMER_FIRST_NAME, customer0.c_last_name AS CUSTOMER_LAST_NAME, customer0.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer0.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer0.c_login AS CUSTOMER_LOGIN, customer0.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim0.d_year AS DYEAR, SUM((catalog_sales.cs_ext_list_price - catalog_sales.cs_ext_wholesale_cost - catalog_sales.cs_ext_discount_amt + catalog_sales.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer0\nINNER JOIN catalog_sales ON customer0.c_customer_sk \u003d catalog_sales.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim0 ON catalog_sales.cs_sold_date_sk \u003d date_dim0.d_date_sk\nGROUP BY customer0.c_customer_id, customer0.c_first_name, customer0.c_last_name, customer0.c_preferred_cust_flag, customer0.c_birth_country, customer0.c_login, customer0.c_email_address, date_dim0.d_year)\nUNION ALL\nSELECT customer1.c_customer_id AS CUSTOMER_ID, customer1.c_first_name AS CUSTOMER_FIRST_NAME, customer1.c_last_name AS CUSTOMER_LAST_NAME, customer1.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer1.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer1.c_login AS CUSTOMER_LOGIN, customer1.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim1.d_year AS DYEAR, SUM((web_sales.ws_ext_list_price - web_sales.ws_ext_wholesale_cost - web_sales.ws_ext_discount_amt + web_sales.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer1\nINNER JOIN web_sales ON customer1.c_customer_sk \u003d web_sales.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim1 ON web_sales.ws_sold_date_sk \u003d date_dim1.d_date_sk\nGROUP BY customer1.c_customer_id, customer1.c_first_name, customer1.c_last_name, customer1.c_preferred_cust_flag, customer1.c_birth_country, customer1.c_login, customer1.c_email_address, date_dim1.d_year) AS t9\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND DYEAR \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t10\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer2.c_customer_id AS CUSTOMER_ID, customer2.c_first_name AS CUSTOMER_FIRST_NAME, customer2.c_last_name AS CUSTOMER_LAST_NAME, customer2.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer2.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer2.c_login AS CUSTOMER_LOGIN, customer2.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim2.d_year AS DYEAR, SUM((store_sales0.ss_ext_list_price - store_sales0.ss_ext_wholesale_cost - store_sales0.ss_ext_discount_amt + store_sales0.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer2\nINNER JOIN store_sales AS store_sales0 ON customer2.c_customer_sk \u003d store_sales0.ss_customer_sk\nINNER JOIN date_dim AS date_dim2 ON store_sales0.ss_sold_date_sk \u003d date_dim2.d_date_sk\nGROUP BY customer2.c_customer_id, customer2.c_first_name, customer2.c_last_name, customer2.c_preferred_cust_flag, customer2.c_birth_country, customer2.c_login, customer2.c_email_address, date_dim2.d_year\nUNION ALL\nSELECT customer3.c_customer_id AS CUSTOMER_ID, customer3.c_first_name AS CUSTOMER_FIRST_NAME, customer3.c_last_name AS CUSTOMER_LAST_NAME, customer3.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer3.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer3.c_login AS CUSTOMER_LOGIN, customer3.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim3.d_year AS DYEAR, SUM((catalog_sales0.cs_ext_list_price - catalog_sales0.cs_ext_wholesale_cost - catalog_sales0.cs_ext_discount_amt + catalog_sales0.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer3\nINNER JOIN catalog_sales AS catalog_sales0 ON customer3.c_customer_sk \u003d catalog_sales0.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim3 ON catalog_sales0.cs_sold_date_sk \u003d date_dim3.d_date_sk\nGROUP BY customer3.c_customer_id, customer3.c_first_name, customer3.c_last_name, customer3.c_preferred_cust_flag, customer3.c_birth_country, customer3.c_login, customer3.c_email_address, date_dim3.d_year)\nUNION ALL\nSELECT customer4.c_customer_id AS CUSTOMER_ID, customer4.c_first_name AS CUSTOMER_FIRST_NAME, customer4.c_last_name AS CUSTOMER_LAST_NAME, customer4.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer4.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer4.c_login AS CUSTOMER_LOGIN, customer4.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim4.d_year AS DYEAR, SUM((web_sales0.ws_ext_list_price - web_sales0.ws_ext_wholesale_cost - web_sales0.ws_ext_discount_amt + web_sales0.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer4\nINNER JOIN web_sales AS web_sales0 ON customer4.c_customer_sk \u003d web_sales0.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim4 ON web_sales0.ws_sold_date_sk \u003d date_dim4.d_date_sk\nGROUP BY customer4.c_customer_id, customer4.c_first_name, customer4.c_last_name, customer4.c_preferred_cust_flag, customer4.c_birth_country, customer4.c_login, customer4.c_email_address, date_dim4.d_year) AS t21\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND DYEAR \u003d CAST(2001 + 1 AS BIGINT)) AS t22 ON t10.CUSTOMER_ID \u003d t22.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer5.c_customer_id AS CUSTOMER_ID, customer5.c_first_name AS CUSTOMER_FIRST_NAME, customer5.c_last_name AS CUSTOMER_LAST_NAME, customer5.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer5.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer5.c_login AS CUSTOMER_LOGIN, customer5.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim5.d_year AS DYEAR, SUM((store_sales1.ss_ext_list_price - store_sales1.ss_ext_wholesale_cost - store_sales1.ss_ext_discount_amt + store_sales1.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer5\nINNER JOIN store_sales AS store_sales1 ON customer5.c_customer_sk \u003d store_sales1.ss_customer_sk\nINNER JOIN date_dim AS date_dim5 ON store_sales1.ss_sold_date_sk \u003d date_dim5.d_date_sk\nGROUP BY customer5.c_customer_id, customer5.c_first_name, customer5.c_last_name, customer5.c_preferred_cust_flag, customer5.c_birth_country, customer5.c_login, customer5.c_email_address, date_dim5.d_year\nUNION ALL\nSELECT customer6.c_customer_id AS CUSTOMER_ID, customer6.c_first_name AS CUSTOMER_FIRST_NAME, customer6.c_last_name AS CUSTOMER_LAST_NAME, customer6.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer6.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer6.c_login AS CUSTOMER_LOGIN, customer6.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim6.d_year AS DYEAR, SUM((catalog_sales1.cs_ext_list_price - catalog_sales1.cs_ext_wholesale_cost - catalog_sales1.cs_ext_discount_amt + catalog_sales1.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer6\nINNER JOIN catalog_sales AS catalog_sales1 ON customer6.c_customer_sk \u003d catalog_sales1.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim6 ON catalog_sales1.cs_sold_date_sk \u003d date_dim6.d_date_sk\nGROUP BY customer6.c_customer_id, customer6.c_first_name, customer6.c_last_name, customer6.c_preferred_cust_flag, customer6.c_birth_country, customer6.c_login, customer6.c_email_address, date_dim6.d_year)\nUNION ALL\nSELECT customer7.c_customer_id AS CUSTOMER_ID, customer7.c_first_name AS CUSTOMER_FIRST_NAME, customer7.c_last_name AS CUSTOMER_LAST_NAME, customer7.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer7.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer7.c_login AS CUSTOMER_LOGIN, customer7.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim7.d_year AS DYEAR, SUM((web_sales1.ws_ext_list_price - web_sales1.ws_ext_wholesale_cost - web_sales1.ws_ext_discount_amt + web_sales1.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer7\nINNER JOIN web_sales AS web_sales1 ON customer7.c_customer_sk \u003d web_sales1.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim7 ON web_sales1.ws_sold_date_sk \u003d date_dim7.d_date_sk\nGROUP BY customer7.c_customer_id, customer7.c_first_name, customer7.c_last_name, customer7.c_preferred_cust_flag, customer7.c_birth_country, customer7.c_login, customer7.c_email_address, date_dim7.d_year) AS t33\nWHERE SALE_TYPE \u003d \u0027c\u0027 AND DYEAR \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t34 ON t10.CUSTOMER_ID \u003d t34.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer8.c_customer_id AS CUSTOMER_ID, customer8.c_first_name AS CUSTOMER_FIRST_NAME, customer8.c_last_name AS CUSTOMER_LAST_NAME, customer8.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer8.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer8.c_login AS CUSTOMER_LOGIN, customer8.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim8.d_year AS DYEAR, SUM((store_sales2.ss_ext_list_price - store_sales2.ss_ext_wholesale_cost - store_sales2.ss_ext_discount_amt + store_sales2.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer8\nINNER JOIN store_sales AS store_sales2 ON customer8.c_customer_sk \u003d store_sales2.ss_customer_sk\nINNER JOIN date_dim AS date_dim8 ON store_sales2.ss_sold_date_sk \u003d date_dim8.d_date_sk\nGROUP BY customer8.c_customer_id, customer8.c_first_name, customer8.c_last_name, customer8.c_preferred_cust_flag, customer8.c_birth_country, customer8.c_login, customer8.c_email_address, date_dim8.d_year\nUNION ALL\nSELECT customer9.c_customer_id AS CUSTOMER_ID, customer9.c_first_name AS CUSTOMER_FIRST_NAME, customer9.c_last_name AS CUSTOMER_LAST_NAME, customer9.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer9.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer9.c_login AS CUSTOMER_LOGIN, customer9.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim9.d_year AS DYEAR, SUM((catalog_sales2.cs_ext_list_price - catalog_sales2.cs_ext_wholesale_cost - catalog_sales2.cs_ext_discount_amt + catalog_sales2.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer9\nINNER JOIN catalog_sales AS catalog_sales2 ON customer9.c_customer_sk \u003d catalog_sales2.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim9 ON catalog_sales2.cs_sold_date_sk \u003d date_dim9.d_date_sk\nGROUP BY customer9.c_customer_id, customer9.c_first_name, customer9.c_last_name, customer9.c_preferred_cust_flag, customer9.c_birth_country, customer9.c_login, customer9.c_email_address, date_dim9.d_year)\nUNION ALL\nSELECT customer10.c_customer_id AS CUSTOMER_ID, customer10.c_first_name AS CUSTOMER_FIRST_NAME, customer10.c_last_name AS CUSTOMER_LAST_NAME, customer10.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer10.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer10.c_login AS CUSTOMER_LOGIN, customer10.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim10.d_year AS DYEAR, SUM((web_sales2.ws_ext_list_price - web_sales2.ws_ext_wholesale_cost - web_sales2.ws_ext_discount_amt + web_sales2.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer10\nINNER JOIN web_sales AS web_sales2 ON customer10.c_customer_sk \u003d web_sales2.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim10 ON web_sales2.ws_sold_date_sk \u003d date_dim10.d_date_sk\nGROUP BY customer10.c_customer_id, customer10.c_first_name, customer10.c_last_name, customer10.c_preferred_cust_flag, customer10.c_birth_country, customer10.c_login, customer10.c_email_address, date_dim10.d_year) AS t45\nWHERE SALE_TYPE \u003d \u0027c\u0027 AND DYEAR \u003d CAST(2001 + 1 AS BIGINT)) AS t46 ON t10.CUSTOMER_ID \u003d t46.CUSTOMER_ID AND CASE WHEN t34.YEAR_TOTAL \u003e 0 THEN t46.YEAR_TOTAL / t34.YEAR_TOTAL ELSE NULL END \u003e CASE WHEN t10.YEAR_TOTAL \u003e 0 THEN t22.YEAR_TOTAL / t10.YEAR_TOTAL ELSE NULL END\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer11.c_customer_id AS CUSTOMER_ID, customer11.c_first_name AS CUSTOMER_FIRST_NAME, customer11.c_last_name AS CUSTOMER_LAST_NAME, customer11.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer11.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer11.c_login AS CUSTOMER_LOGIN, customer11.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim11.d_year AS DYEAR, SUM((store_sales3.ss_ext_list_price - store_sales3.ss_ext_wholesale_cost - store_sales3.ss_ext_discount_amt + store_sales3.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer11\nINNER JOIN store_sales AS store_sales3 ON customer11.c_customer_sk \u003d store_sales3.ss_customer_sk\nINNER JOIN date_dim AS date_dim11 ON store_sales3.ss_sold_date_sk \u003d date_dim11.d_date_sk\nGROUP BY customer11.c_customer_id, customer11.c_first_name, customer11.c_last_name, customer11.c_preferred_cust_flag, customer11.c_birth_country, customer11.c_login, customer11.c_email_address, date_dim11.d_year\nUNION ALL\nSELECT customer12.c_customer_id AS CUSTOMER_ID, customer12.c_first_name AS CUSTOMER_FIRST_NAME, customer12.c_last_name AS CUSTOMER_LAST_NAME, customer12.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer12.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer12.c_login AS CUSTOMER_LOGIN, customer12.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim12.d_year AS DYEAR, SUM((catalog_sales3.cs_ext_list_price - catalog_sales3.cs_ext_wholesale_cost - catalog_sales3.cs_ext_discount_amt + catalog_sales3.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer12\nINNER JOIN catalog_sales AS catalog_sales3 ON customer12.c_customer_sk \u003d catalog_sales3.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim12 ON catalog_sales3.cs_sold_date_sk \u003d date_dim12.d_date_sk\nGROUP BY customer12.c_customer_id, customer12.c_first_name, customer12.c_last_name, customer12.c_preferred_cust_flag, customer12.c_birth_country, customer12.c_login, customer12.c_email_address, date_dim12.d_year)\nUNION ALL\nSELECT customer13.c_customer_id AS CUSTOMER_ID, customer13.c_first_name AS CUSTOMER_FIRST_NAME, customer13.c_last_name AS CUSTOMER_LAST_NAME, customer13.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer13.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer13.c_login AS CUSTOMER_LOGIN, customer13.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim13.d_year AS DYEAR, SUM((web_sales3.ws_ext_list_price - web_sales3.ws_ext_wholesale_cost - web_sales3.ws_ext_discount_amt + web_sales3.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer13\nINNER JOIN web_sales AS web_sales3 ON customer13.c_customer_sk \u003d web_sales3.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim13 ON web_sales3.ws_sold_date_sk \u003d date_dim13.d_date_sk\nGROUP BY customer13.c_customer_id, customer13.c_first_name, customer13.c_last_name, customer13.c_preferred_cust_flag, customer13.c_birth_country, customer13.c_login, customer13.c_email_address, date_dim13.d_year) AS t57\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND DYEAR \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t58 ON t10.CUSTOMER_ID \u003d t58.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT *\nFROM (SELECT customer14.c_customer_id AS CUSTOMER_ID, customer14.c_first_name AS CUSTOMER_FIRST_NAME, customer14.c_last_name AS CUSTOMER_LAST_NAME, customer14.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer14.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer14.c_login AS CUSTOMER_LOGIN, customer14.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim14.d_year AS DYEAR, SUM((store_sales4.ss_ext_list_price - store_sales4.ss_ext_wholesale_cost - store_sales4.ss_ext_discount_amt + store_sales4.ss_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer14\nINNER JOIN store_sales AS store_sales4 ON customer14.c_customer_sk \u003d store_sales4.ss_customer_sk\nINNER JOIN date_dim AS date_dim14 ON store_sales4.ss_sold_date_sk \u003d date_dim14.d_date_sk\nGROUP BY customer14.c_customer_id, customer14.c_first_name, customer14.c_last_name, customer14.c_preferred_cust_flag, customer14.c_birth_country, customer14.c_login, customer14.c_email_address, date_dim14.d_year\nUNION ALL\nSELECT customer15.c_customer_id AS CUSTOMER_ID, customer15.c_first_name AS CUSTOMER_FIRST_NAME, customer15.c_last_name AS CUSTOMER_LAST_NAME, customer15.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer15.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer15.c_login AS CUSTOMER_LOGIN, customer15.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim15.d_year AS DYEAR, SUM((catalog_sales4.cs_ext_list_price - catalog_sales4.cs_ext_wholesale_cost - catalog_sales4.cs_ext_discount_amt + catalog_sales4.cs_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027c\u0027 AS SALE_TYPE\nFROM customer AS customer15\nINNER JOIN catalog_sales AS catalog_sales4 ON customer15.c_customer_sk \u003d catalog_sales4.cs_bill_customer_sk\nINNER JOIN date_dim AS date_dim15 ON catalog_sales4.cs_sold_date_sk \u003d date_dim15.d_date_sk\nGROUP BY customer15.c_customer_id, customer15.c_first_name, customer15.c_last_name, customer15.c_preferred_cust_flag, customer15.c_birth_country, customer15.c_login, customer15.c_email_address, date_dim15.d_year)\nUNION ALL\nSELECT customer16.c_customer_id AS CUSTOMER_ID, customer16.c_first_name AS CUSTOMER_FIRST_NAME, customer16.c_last_name AS CUSTOMER_LAST_NAME, customer16.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer16.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer16.c_login AS CUSTOMER_LOGIN, customer16.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim16.d_year AS DYEAR, SUM((web_sales4.ws_ext_list_price - web_sales4.ws_ext_wholesale_cost - web_sales4.ws_ext_discount_amt + web_sales4.ws_ext_sales_price) / 2) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer16\nINNER JOIN web_sales AS web_sales4 ON customer16.c_customer_sk \u003d web_sales4.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim16 ON web_sales4.ws_sold_date_sk \u003d date_dim16.d_date_sk\nGROUP BY customer16.c_customer_id, customer16.c_first_name, customer16.c_last_name, customer16.c_preferred_cust_flag, customer16.c_birth_country, customer16.c_login, customer16.c_email_address, date_dim16.d_year) AS t69\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND DYEAR \u003d CAST(2001 + 1 AS BIGINT)) AS t70 ON t10.CUSTOMER_ID \u003d t70.CUSTOMER_ID AND CASE WHEN t34.YEAR_TOTAL \u003e 0 THEN t46.YEAR_TOTAL / t34.YEAR_TOTAL ELSE NULL END \u003e CASE WHEN t58.YEAR_TOTAL \u003e 0 THEN t70.YEAR_TOTAL / t58.YEAR_TOTAL ELSE NULL END\nORDER BY t22.CUSTOMER_ID NULLS FIRST, t22.CUSTOMER_FIRST_NAME NULLS FIRST, t22.CUSTOMER_LAST_NAME NULLS FIRST, t22.CUSTOMER_PREFERRED_CUST_FLAG NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      450,
      426
    ],
    "optimizedTimesMs": [
      416,
      424
    ],
    "originalAvgMs": 438,
    "optimizedAvgMs": 420,
    "speedup": 1.042857142857143,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q5",
    "status": "error",
    "error": "From line 91, column 11 to line 91, column 37: No match found for function signature CONCAT(\u003cCHARACTER\u003e, \u003cCHARACTER\u003e)",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q6",
    "status": "error",
    "error": "variable $cor0 is not found",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "SUBQUERY_REMOVE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q7",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT item.i_item_id AS I_ITEM_ID, AVG(store_sales.ss_quantity) AS AGG1, AVG(store_sales.ss_list_price) AS AGG2, AVG(store_sales.ss_coupon_amt) AS AGG3, AVG(store_sales.ss_sales_price) AS AGG4\nFROM store_sales\nINNER JOIN (SELECT *\nFROM customer_demographics\nWHERE cd_gender \u003d \u0027M\u0027 AND cd_marital_status \u003d \u0027S\u0027 AND cd_education_status \u003d \u0027College\u0027) AS t ON store_sales.ss_cdemo_sk \u003d t.cd_demo_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000) AS t0 ON store_sales.ss_sold_date_sk \u003d t0.d_date_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nINNER JOIN (SELECT *\nFROM promotion\nWHERE p_channel_email \u003d \u0027N\u0027 OR p_channel_event \u003d \u0027N\u0027) AS t1 ON store_sales.ss_promo_sk \u003d t1.p_promo_sk\nGROUP BY item.i_item_id\nORDER BY item.i_item_id\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      39,
      39
    ],
    "optimizedTimesMs": [
      38,
      44
    ],
    "originalAvgMs": 39,
    "optimizedAvgMs": 41,
    "speedup": 0.9512195121951219,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q8",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"$\"",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "AGGREGATE_JOIN_TRANSPOSE",
      "FILTER_SCAN",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT store.s_store_name AS S_STORE_NAME, SUM(store_sales.ss_net_profit)\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_qoy \u003d 2 AND d_year \u003d 1998) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nINNER JOIN (SELECT *\nFROM (SELECT SUBSTRING(t0.ca_zip, 1, 5) AS CA_ZIP\nFROM (SELECT ca_address_sk, ca_address_id, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, SUBSTRING(ca_zip, 1, 5) AS $f13\nFROM customer_address) AS t0\nINNER JOIN (SELECT ROW_VALUE\nFROM (VALUES (\u002724128\u0027),\n(\u002776232\u0027),\n(\u002765084\u0027),\n(\u002787816\u0027),\n(\u002783926\u0027),\n(\u002777556\u0027),\n(\u002720548\u0027),\n(\u002726231\u0027),\n(\u002743848\u0027),\n(\u002715126\u0027),\n(\u002791137\u0027),\n(\u002761265\u0027),\n(\u002798294\u0027),\n(\u002725782\u0027),\n(\u002717920\u0027),\n(\u002718426\u0027),\n(\u002798235\u0027),\n(\u002740081\u0027),\n(\u002784093\u0027),\n(\u002728577\u0027),\n(\u002755565\u0027),\n(\u002717183\u0027),\n(\u002754601\u0027),\n(\u002767897\u0027),\n(\u002722752\u0027),\n(\u002786284\u0027),\n(\u002718376\u0027),\n(\u002738607\u0027),\n(\u002745200\u0027),\n(\u002721756\u0027),\n(\u002729741\u0027),\n(\u002796765\u0027),\n(\u002723932\u0027),\n(\u002789360\u0027),\n(\u002729839\u0027),\n(\u002725989\u0027),\n(\u002728898\u0027),\n(\u002791068\u0027),\n(\u002772550\u0027),\n(\u002710390\u0027),\n(\u002718845\u0027),\n(\u002747770\u0027),\n(\u002782636\u0027),\n(\u002741367\u0027),\n(\u002776638\u0027),\n(\u002786198\u0027),\n(\u002781312\u0027),\n(\u002737126\u0027),\n(\u002739192\u0027),\n(\u002788424\u0027),\n(\u002772175\u0027),\n(\u002781426\u0027),\n(\u002753672\u0027),\n(\u002710445\u0027),\n(\u002742666\u0027),\n(\u002766864\u0027),\n(\u002766708\u0027),\n(\u002741248\u0027),\n(\u002748583\u0027),\n(\u002782276\u0027),\n(\u002718842\u0027),\n(\u002778890\u0027),\n(\u002749448\u0027),\n(\u002714089\u0027),\n(\u002738122\u0027),\n(\u002734425\u0027),\n(\u002779077\u0027),\n(\u002719849\u0027),\n(\u002743285\u0027),\n(\u002739861\u0027),\n(\u002766162\u0027),\n(\u002777610\u0027),\n(\u002713695\u0027),\n(\u002799543\u0027),\n(\u002783444\u0027),\n(\u002783041\u0027),\n(\u002712305\u0027),\n(\u002757665\u0027),\n(\u002768341\u0027),\n(\u002725003\u0027),\n(\u002757834\u0027),\n(\u002762878\u0027),\n(\u002749130\u0027),\n(\u002781096\u0027),\n(\u002718840\u0027),\n(\u002727700\u0027),\n(\u002723470\u0027),\n(\u002750412\u0027),\n(\u002721195\u0027),\n(\u002716021\u0027),\n(\u002776107\u0027),\n(\u002771954\u0027),\n(\u002768309\u0027),\n(\u002718119\u0027),\n(\u002798359\u0027),\n(\u002764544\u0027),\n(\u002710336\u0027),\n(\u002786379\u0027),\n(\u002727068\u0027),\n(\u002739736\u0027),\n(\u002798569\u0027),\n(\u002728915\u0027),\n(\u002724206\u0027),\n(\u002756529\u0027),\n(\u002757647\u0027),\n(\u002754917\u0027),\n(\u002742961\u0027),\n(\u002791110\u0027),\n(\u002763981\u0027),\n(\u002714922\u0027),\n(\u002736420\u0027),\n(\u002723006\u0027),\n(\u002767467\u0027),\n(\u002732754\u0027),\n(\u002730903\u0027),\n(\u002720260\u0027),\n(\u002731671\u0027),\n(\u002751798\u0027),\n(\u002772325\u0027),\n(\u002785816\u0027),\n(\u002768621\u0027),\n(\u002713955\u0027),\n(\u002736446\u0027),\n(\u002741766\u0027),\n(\u002768806\u0027),\n(\u002716725\u0027),\n(\u002715146\u0027),\n(\u002722744\u0027),\n(\u002735850\u0027),\n(\u002788086\u0027),\n(\u002751649\u0027),\n(\u002718270\u0027),\n(\u002752867\u0027),\n(\u002739972\u0027),\n(\u002796976\u0027),\n(\u002763792\u0027),\n(\u002711376\u0027),\n(\u002794898\u0027),\n(\u002713595\u0027),\n(\u002710516\u0027),\n(\u002790225\u0027),\n(\u002758943\u0027),\n(\u002739371\u0027),\n(\u002794945\u0027),\n(\u002728587\u0027),\n(\u002796576\u0027),\n(\u002757855\u0027),\n(\u002728488\u0027),\n(\u002726105\u0027),\n(\u002783933\u0027),\n(\u002725858\u0027),\n(\u002734322\u0027),\n(\u002744438\u0027),\n(\u002773171\u0027),\n(\u002730122\u0027),\n(\u002734102\u0027),\n(\u002722685\u0027),\n(\u002771256\u0027),\n(\u002778451\u0027),\n(\u002754364\u0027),\n(\u002713354\u0027),\n(\u002745375\u0027),\n(\u002740558\u0027),\n(\u002756458\u0027),\n(\u002728286\u0027),\n(\u002745266\u0027),\n(\u002747305\u0027),\n(\u002769399\u0027),\n(\u002783921\u0027),\n(\u002726233\u0027),\n(\u002711101\u0027),\n(\u002715371\u0027),\n(\u002769913\u0027),\n(\u002735942\u0027),\n(\u002715882\u0027),\n(\u002725631\u0027),\n(\u002724610\u0027),\n(\u002744165\u0027),\n(\u002799076\u0027),\n(\u002733786\u0027),\n(\u002770738\u0027),\n(\u002726653\u0027),\n(\u002714328\u0027),\n(\u002772305\u0027),\n(\u002762496\u0027),\n(\u002722152\u0027),\n(\u002710144\u0027),\n(\u002764147\u0027),\n(\u002748425\u0027),\n(\u002714663\u0027),\n(\u002721076\u0027),\n(\u002718799\u0027),\n(\u002730450\u0027),\n(\u002763089\u0027),\n(\u002781019\u0027),\n(\u002768893\u0027),\n(\u002724996\u0027),\n(\u002751200\u0027),\n(\u002751211\u0027),\n(\u002745692\u0027),\n(\u002792712\u0027),\n(\u002770466\u0027),\n(\u002779994\u0027),\n(\u002722437\u0027),\n(\u002725280\u0027),\n(\u002738935\u0027),\n(\u002771791\u0027),\n(\u002773134\u0027),\n(\u002756571\u0027),\n(\u002714060\u0027),\n(\u002719505\u0027),\n(\u002772425\u0027),\n(\u002756575\u0027),\n(\u002774351\u0027),\n(\u002768786\u0027),\n(\u002751650\u0027),\n(\u002720004\u0027),\n(\u002718383\u0027),\n(\u002776614\u0027),\n(\u002711634\u0027),\n(\u002718906\u0027),\n(\u002715765\u0027),\n(\u002741368\u0027),\n(\u002773241\u0027),\n(\u002776698\u0027),\n(\u002778567\u0027),\n(\u002797189\u0027),\n(\u002728545\u0027),\n(\u002776231\u0027),\n(\u002775691\u0027),\n(\u002722246\u0027),\n(\u002751061\u0027),\n(\u002790578\u0027),\n(\u002756691\u0027),\n(\u002768014\u0027),\n(\u002751103\u0027),\n(\u002794167\u0027),\n(\u002757047\u0027),\n(\u002714867\u0027),\n(\u002773520\u0027),\n(\u002715734\u0027),\n(\u002763435\u0027),\n(\u002725733\u0027),\n(\u002735474\u0027),\n(\u002724676\u0027),\n(\u002794627\u0027),\n(\u002753535\u0027),\n(\u002717879\u0027),\n(\u002715559\u0027),\n(\u002753268\u0027),\n(\u002759166\u0027),\n(\u002711928\u0027),\n(\u002759402\u0027),\n(\u002733282\u0027),\n(\u002745721\u0027),\n(\u002743933\u0027),\n(\u002768101\u0027),\n(\u002733515\u0027),\n(\u002736634\u0027),\n(\u002771286\u0027),\n(\u002719736\u0027),\n(\u002758058\u0027),\n(\u002755253\u0027),\n(\u002767473\u0027),\n(\u002741918\u0027),\n(\u002719515\u0027),\n(\u002736495\u0027),\n(\u002719430\u0027),\n(\u002722351\u0027),\n(\u002777191\u0027),\n(\u002791393\u0027),\n(\u002749156\u0027),\n(\u002750298\u0027),\n(\u002787501\u0027),\n(\u002718652\u0027),\n(\u002753179\u0027),\n(\u002718767\u0027),\n(\u002763193\u0027),\n(\u002723968\u0027),\n(\u002765164\u0027),\n(\u002768880\u0027),\n(\u002721286\u0027),\n(\u002772823\u0027),\n(\u002758470\u0027),\n(\u002767301\u0027),\n(\u002713394\u0027),\n(\u002731016\u0027),\n(\u002770372\u0027),\n(\u002767030\u0027),\n(\u002740604\u0027),\n(\u002724317\u0027),\n(\u002745748\u0027),\n(\u002739127\u0027),\n(\u002726065\u0027),\n(\u002777721\u0027),\n(\u002731029\u0027),\n(\u002731880\u0027),\n(\u002760576\u0027),\n(\u002724671\u0027),\n(\u002745549\u0027),\n(\u002713376\u0027),\n(\u002750016\u0027),\n(\u002733123\u0027),\n(\u002719769\u0027),\n(\u002722927\u0027),\n(\u002797789\u0027),\n(\u002746081\u0027),\n(\u002772151\u0027),\n(\u002715723\u0027),\n(\u002746136\u0027),\n(\u002751949\u0027),\n(\u002768100\u0027),\n(\u002796888\u0027),\n(\u002764528\u0027),\n(\u002714171\u0027),\n(\u002779777\u0027),\n(\u002728709\u0027),\n(\u002711489\u0027),\n(\u002725103\u0027),\n(\u002732213\u0027),\n(\u002778668\u0027),\n(\u002722245\u0027),\n(\u002715798\u0027),\n(\u002727156\u0027),\n(\u002737930\u0027),\n(\u002762971\u0027),\n(\u002721337\u0027),\n(\u002751622\u0027),\n(\u002767853\u0027),\n(\u002710567\u0027),\n(\u002738415\u0027),\n(\u002715455\u0027),\n(\u002758263\u0027),\n(\u002742029\u0027),\n(\u002760279\u0027),\n(\u002737125\u0027),\n(\u002756240\u0027),\n(\u002788190\u0027),\n(\u002750308\u0027),\n(\u002726859\u0027),\n(\u002764457\u0027),\n(\u002789091\u0027),\n(\u002782136\u0027),\n(\u002762377\u0027),\n(\u002736233\u0027),\n(\u002763837\u0027),\n(\u002758078\u0027),\n(\u002717043\u0027),\n(\u002730010\u0027),\n(\u002760099\u0027),\n(\u002728810\u0027),\n(\u002798025\u0027),\n(\u002729178\u0027),\n(\u002787343\u0027),\n(\u002773273\u0027),\n(\u002730469\u0027),\n(\u002764034\u0027),\n(\u002739516\u0027),\n(\u002786057\u0027),\n(\u002721309\u0027),\n(\u002790257\u0027),\n(\u002767875\u0027),\n(\u002740162\u0027),\n(\u002711356\u0027),\n(\u002773650\u0027),\n(\u002761810\u0027),\n(\u002772013\u0027),\n(\u002730431\u0027),\n(\u002722461\u0027),\n(\u002719512\u0027),\n(\u002713375\u0027),\n(\u002755307\u0027),\n(\u002730625\u0027),\n(\u002783849\u0027),\n(\u002768908\u0027),\n(\u002726689\u0027),\n(\u002796451\u0027),\n(\u002738193\u0027),\n(\u002746820\u0027),\n(\u002788885\u0027),\n(\u002784935\u0027),\n(\u002769035\u0027),\n(\u002783144\u0027),\n(\u002747537\u0027),\n(\u002756616\u0027),\n(\u002794983\u0027),\n(\u002748033\u0027),\n(\u002769952\u0027),\n(\u002725486\u0027),\n(\u002761547\u0027),\n(\u002727385\u0027),\n(\u002761860\u0027),\n(\u002758048\u0027),\n(\u002756910\u0027),\n(\u002716807\u0027),\n(\u002717871\u0027),\n(\u002735258\u0027),\n(\u002731387\u0027),\n(\u002735458\u0027),\n(\u002735576\u0027)) AS t1 (ROW_VALUE)\nGROUP BY ROW_VALUE) AS t2 ON t0.$f13 \u003d t2.ROW_VALUE\nINTERSECT\nSELECT SUBSTRING(customer_address0.ca_zip, 1, 5) AS CA_ZIP\nFROM customer_address AS customer_address0\nINNER JOIN (SELECT *\nFROM customer\nWHERE c_preferred_cust_flag \u003d \u0027Y\u0027) AS t4 ON customer_address0.ca_address_sk \u003d t4.c_current_addr_sk\nGROUP BY customer_address0.ca_zip\nHAVING COUNT(*) \u003e 10) AS t9) AS t10 ON SUBSTRING(store.s_zip, 1, 2) \u003d SUBSTRING(t10.CA_ZIP, 1, 2)\nGROUP BY store.s_store_name\nORDER BY store.s_store_name\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q9",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "SUBQUERY_REMOVE"
    ],
    "optimizedSql": "SELECT CASE WHEN t1.EXPR$0 \u003e 74129 THEN t4.EXPR$0 ELSE t7.EXPR$0 END AS BUCKET1, CASE WHEN t9.EXPR$0 \u003e 122840 THEN t12.EXPR$0 ELSE t15.EXPR$0 END AS BUCKET2, CASE WHEN t17.EXPR$0 \u003e 56580 THEN t20.EXPR$0 ELSE t23.EXPR$0 END AS BUCKET3, CASE WHEN t25.EXPR$0 \u003e 10097 THEN t28.EXPR$0 ELSE t31.EXPR$0 END AS BUCKET4, CASE WHEN t33.EXPR$0 \u003e 165306 THEN t36.EXPR$0 ELSE t39.EXPR$0 END AS BUCKET5\nFROM (SELECT *\nFROM reason\nWHERE r_reason_sk \u003d 1) AS t\nLEFT JOIN (SELECT COUNT(*) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 1 AND ss_quantity \u003c\u003d 20) AS t1 ON TRUE\nLEFT JOIN (SELECT AVG(ss_ext_discount_amt) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 1 AND ss_quantity \u003c\u003d 20) AS t4 ON TRUE\nLEFT JOIN (SELECT AVG(ss_net_paid) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 1 AND ss_quantity \u003c\u003d 20) AS t7 ON TRUE\nLEFT JOIN (SELECT COUNT(*) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 21 AND ss_quantity \u003c\u003d 40) AS t9 ON TRUE\nLEFT JOIN (SELECT AVG(ss_ext_discount_amt) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 21 AND ss_quantity \u003c\u003d 40) AS t12 ON TRUE\nLEFT JOIN (SELECT AVG(ss_net_paid) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 21 AND ss_quantity \u003c\u003d 40) AS t15 ON TRUE\nLEFT JOIN (SELECT COUNT(*) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 41 AND ss_quantity \u003c\u003d 60) AS t17 ON TRUE\nLEFT JOIN (SELECT AVG(ss_ext_discount_amt) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 41 AND ss_quantity \u003c\u003d 60) AS t20 ON TRUE\nLEFT JOIN (SELECT AVG(ss_net_paid) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 41 AND ss_quantity \u003c\u003d 60) AS t23 ON TRUE\nLEFT JOIN (SELECT COUNT(*) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 61 AND ss_quantity \u003c\u003d 80) AS t25 ON TRUE\nLEFT JOIN (SELECT AVG(ss_ext_discount_amt) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 61 AND ss_quantity \u003c\u003d 80) AS t28 ON TRUE\nLEFT JOIN (SELECT AVG(ss_net_paid) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 61 AND ss_quantity \u003c\u003d 80) AS t31 ON TRUE\nLEFT JOIN (SELECT COUNT(*) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 81 AND ss_quantity \u003c\u003d 100) AS t33 ON TRUE\nLEFT JOIN (SELECT AVG(ss_ext_discount_amt) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 81 AND ss_quantity \u003c\u003d 100) AS t36 ON TRUE\nLEFT JOIN (SELECT AVG(ss_net_paid) AS EXPR$0\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 81 AND ss_quantity \u003c\u003d 100) AS t39 ON TRUE",
    "originalTimesMs": [
      70,
      69
    ],
    "optimizedTimesMs": [
      33,
      32
    ],
    "originalAvgMs": 69,
    "optimizedAvgMs": 32,
    "speedup": 2.15625,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 575621,
    "optimizedPlanMaxRows": 575621
  },
  {
    "query": "q10",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"$\"",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_SUB_QUERY_TO_CORRELATE",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer_demographics.cd_gender AS CD_GENDER, customer_demographics.cd_marital_status AS CD_MARITAL_STATUS, customer_demographics.cd_education_status AS CD_EDUCATION_STATUS, COUNT(*) AS CNT1, customer_demographics.cd_purchase_estimate AS CD_PURCHASE_ESTIMATE, COUNT(*) AS CNT2, customer_demographics.cd_credit_rating AS CD_CREDIT_RATING, COUNT(*) AS CNT3, customer_demographics.cd_dep_count AS CD_DEP_COUNT, COUNT(*) AS CNT4, customer_demographics.cd_dep_employed_count AS CD_DEP_EMPLOYED_COUNT, COUNT(*) AS CNT5, customer_demographics.cd_dep_college_count AS CD_DEP_COLLEGE_COUNT, COUNT(*) AS CNT6\nFROM (SELECT $cor0.c_customer_sk, $cor0.c_customer_id, $cor0.c_current_cdemo_sk, $cor0.c_current_hdemo_sk, $cor0.c_current_addr_sk, $cor0.c_first_shipto_date_sk, $cor0.c_first_sales_date_sk, $cor0.c_salutation, $cor0.c_first_name, $cor0.c_last_name, $cor0.c_preferred_cust_flag, $cor0.c_birth_day, $cor0.c_birth_month, $cor0.c_birth_year, $cor0.c_birth_country, $cor0.c_login, $cor0.c_email_address, $cor0.c_last_review_date_sk\nFROM ((customer AS $cor0, LATERAL (SELECT TRUE AS i\nFROM store_sales,\ndate_dim\nWHERE $cor0.c_customer_sk \u003d store_sales.ss_customer_sk AND store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk AND date_dim.d_year \u003d 2002 AND date_dim.d_moy \u003e\u003d 1 AND date_dim.d_moy \u003c\u003d 1 + 3\nGROUP BY TRUE) AS t1) AS $cor0, LATERAL (SELECT TRUE AS i\nFROM web_sales,\ndate_dim AS date_dim0\nWHERE $cor0.c_customer_sk \u003d web_sales.ws_bill_customer_sk AND web_sales.ws_sold_date_sk \u003d date_dim0.d_date_sk AND date_dim0.d_year \u003d 2002 AND date_dim0.d_moy \u003e\u003d 1 AND date_dim0.d_moy \u003c\u003d 1 + 3\nGROUP BY TRUE) AS t4) AS $cor0,\nLATERAL (SELECT TRUE AS i\nFROM catalog_sales,\ndate_dim AS date_dim1\nWHERE $cor0.c_customer_sk \u003d catalog_sales.cs_ship_customer_sk AND catalog_sales.cs_sold_date_sk \u003d date_dim1.d_date_sk AND date_dim1.d_year \u003d 2002 AND date_dim1.d_moy \u003e\u003d 1 AND date_dim1.d_moy \u003c\u003d 1 + 3\nGROUP BY TRUE) AS t7\nWHERE $cor0.i0 IS NOT NULL OR $cor0.i1 IS NOT NULL) AS t9\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_county IN (\u0027Dona Ana County\u0027, \u0027Jefferson County\u0027, \u0027La Porte County\u0027, \u0027Rush County\u0027, \u0027Toole County\u0027)) AS t10 ON t9.c_current_addr_sk \u003d t10.ca_address_sk\nINNER JOIN customer_demographics ON t9.c_current_cdemo_sk \u003d customer_demographics.cd_demo_sk\nGROUP BY customer_demographics.cd_gender, customer_demographics.cd_marital_status, customer_demographics.cd_education_status, customer_demographics.cd_purchase_estimate, customer_demographics.cd_credit_rating, customer_demographics.cd_dep_count, customer_demographics.cd_dep_employed_count, customer_demographics.cd_dep_college_count\nORDER BY customer_demographics.cd_gender, customer_demographics.cd_marital_status, customer_demographics.cd_education_status, customer_demographics.cd_purchase_estimate, customer_demographics.cd_credit_rating, customer_demographics.cd_dep_count, customer_demographics.cd_dep_employed_count, customer_demographics.cd_dep_college_count\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q11",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t14.CUSTOMER_ID, t14.CUSTOMER_FIRST_NAME, t14.CUSTOMER_LAST_NAME, t14.CUSTOMER_PREFERRED_CUST_FLAG\nFROM (SELECT *\nFROM (SELECT customer.c_customer_id AS CUSTOMER_ID, customer.c_first_name AS CUSTOMER_FIRST_NAME, customer.c_last_name AS CUSTOMER_LAST_NAME, customer.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer.c_login AS CUSTOMER_LOGIN, customer.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim.d_year AS DYEAR, SUM(store_sales.ss_ext_list_price - store_sales.ss_ext_discount_amt) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer\nINNER JOIN store_sales ON customer.c_customer_sk \u003d store_sales.ss_customer_sk\nINNER JOIN date_dim ON store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk\nGROUP BY customer.c_customer_id, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_country, customer.c_login, customer.c_email_address, date_dim.d_year\nUNION ALL\nSELECT customer0.c_customer_id AS CUSTOMER_ID, customer0.c_first_name AS CUSTOMER_FIRST_NAME, customer0.c_last_name AS CUSTOMER_LAST_NAME, customer0.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer0.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer0.c_login AS CUSTOMER_LOGIN, customer0.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim0.d_year AS DYEAR, SUM(web_sales.ws_ext_list_price - web_sales.ws_ext_discount_amt) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer0\nINNER JOIN web_sales ON customer0.c_customer_sk \u003d web_sales.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim0 ON web_sales.ws_sold_date_sk \u003d date_dim0.d_date_sk\nGROUP BY customer0.c_customer_id, customer0.c_first_name, customer0.c_last_name, customer0.c_preferred_cust_flag, customer0.c_birth_country, customer0.c_login, customer0.c_email_address, date_dim0.d_year) AS t5\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND DYEAR \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t6\nINNER JOIN (SELECT *\nFROM (SELECT customer1.c_customer_id AS CUSTOMER_ID, customer1.c_first_name AS CUSTOMER_FIRST_NAME, customer1.c_last_name AS CUSTOMER_LAST_NAME, customer1.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer1.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer1.c_login AS CUSTOMER_LOGIN, customer1.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim1.d_year AS DYEAR, SUM(store_sales0.ss_ext_list_price - store_sales0.ss_ext_discount_amt) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer1\nINNER JOIN store_sales AS store_sales0 ON customer1.c_customer_sk \u003d store_sales0.ss_customer_sk\nINNER JOIN date_dim AS date_dim1 ON store_sales0.ss_sold_date_sk \u003d date_dim1.d_date_sk\nGROUP BY customer1.c_customer_id, customer1.c_first_name, customer1.c_last_name, customer1.c_preferred_cust_flag, customer1.c_birth_country, customer1.c_login, customer1.c_email_address, date_dim1.d_year\nUNION ALL\nSELECT customer2.c_customer_id AS CUSTOMER_ID, customer2.c_first_name AS CUSTOMER_FIRST_NAME, customer2.c_last_name AS CUSTOMER_LAST_NAME, customer2.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer2.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer2.c_login AS CUSTOMER_LOGIN, customer2.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim2.d_year AS DYEAR, SUM(web_sales0.ws_ext_list_price - web_sales0.ws_ext_discount_amt) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer2\nINNER JOIN web_sales AS web_sales0 ON customer2.c_customer_sk \u003d web_sales0.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim2 ON web_sales0.ws_sold_date_sk \u003d date_dim2.d_date_sk\nGROUP BY customer2.c_customer_id, customer2.c_first_name, customer2.c_last_name, customer2.c_preferred_cust_flag, customer2.c_birth_country, customer2.c_login, customer2.c_email_address, date_dim2.d_year) AS t13\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND DYEAR \u003d CAST(2001 + 1 AS BIGINT)) AS t14 ON t6.CUSTOMER_ID \u003d t14.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT customer3.c_customer_id AS CUSTOMER_ID, customer3.c_first_name AS CUSTOMER_FIRST_NAME, customer3.c_last_name AS CUSTOMER_LAST_NAME, customer3.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer3.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer3.c_login AS CUSTOMER_LOGIN, customer3.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim3.d_year AS DYEAR, SUM(store_sales1.ss_ext_list_price - store_sales1.ss_ext_discount_amt) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer3\nINNER JOIN store_sales AS store_sales1 ON customer3.c_customer_sk \u003d store_sales1.ss_customer_sk\nINNER JOIN date_dim AS date_dim3 ON store_sales1.ss_sold_date_sk \u003d date_dim3.d_date_sk\nGROUP BY customer3.c_customer_id, customer3.c_first_name, customer3.c_last_name, customer3.c_preferred_cust_flag, customer3.c_birth_country, customer3.c_login, customer3.c_email_address, date_dim3.d_year\nUNION ALL\nSELECT customer4.c_customer_id AS CUSTOMER_ID, customer4.c_first_name AS CUSTOMER_FIRST_NAME, customer4.c_last_name AS CUSTOMER_LAST_NAME, customer4.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer4.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer4.c_login AS CUSTOMER_LOGIN, customer4.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim4.d_year AS DYEAR, SUM(web_sales1.ws_ext_list_price - web_sales1.ws_ext_discount_amt) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer4\nINNER JOIN web_sales AS web_sales1 ON customer4.c_customer_sk \u003d web_sales1.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim4 ON web_sales1.ws_sold_date_sk \u003d date_dim4.d_date_sk\nGROUP BY customer4.c_customer_id, customer4.c_first_name, customer4.c_last_name, customer4.c_preferred_cust_flag, customer4.c_birth_country, customer4.c_login, customer4.c_email_address, date_dim4.d_year) AS t21\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND DYEAR \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t22 ON t6.CUSTOMER_ID \u003d t22.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT customer5.c_customer_id AS CUSTOMER_ID, customer5.c_first_name AS CUSTOMER_FIRST_NAME, customer5.c_last_name AS CUSTOMER_LAST_NAME, customer5.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer5.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer5.c_login AS CUSTOMER_LOGIN, customer5.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim5.d_year AS DYEAR, SUM(store_sales2.ss_ext_list_price - store_sales2.ss_ext_discount_amt) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer5\nINNER JOIN store_sales AS store_sales2 ON customer5.c_customer_sk \u003d store_sales2.ss_customer_sk\nINNER JOIN date_dim AS date_dim5 ON store_sales2.ss_sold_date_sk \u003d date_dim5.d_date_sk\nGROUP BY customer5.c_customer_id, customer5.c_first_name, customer5.c_last_name, customer5.c_preferred_cust_flag, customer5.c_birth_country, customer5.c_login, customer5.c_email_address, date_dim5.d_year\nUNION ALL\nSELECT customer6.c_customer_id AS CUSTOMER_ID, customer6.c_first_name AS CUSTOMER_FIRST_NAME, customer6.c_last_name AS CUSTOMER_LAST_NAME, customer6.c_preferred_cust_flag AS CUSTOMER_PREFERRED_CUST_FLAG, customer6.c_birth_country AS CUSTOMER_BIRTH_COUNTRY, customer6.c_login AS CUSTOMER_LOGIN, customer6.c_email_address AS CUSTOMER_EMAIL_ADDRESS, date_dim6.d_year AS DYEAR, SUM(web_sales2.ws_ext_list_price - web_sales2.ws_ext_discount_amt) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer6\nINNER JOIN web_sales AS web_sales2 ON customer6.c_customer_sk \u003d web_sales2.ws_bill_customer_sk\nINNER JOIN date_dim AS date_dim6 ON web_sales2.ws_sold_date_sk \u003d date_dim6.d_date_sk\nGROUP BY customer6.c_customer_id, customer6.c_first_name, customer6.c_last_name, customer6.c_preferred_cust_flag, customer6.c_birth_country, customer6.c_login, customer6.c_email_address, date_dim6.d_year) AS t29\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND DYEAR \u003d CAST(2001 + 1 AS BIGINT)) AS t30 ON t6.CUSTOMER_ID \u003d t30.CUSTOMER_ID AND CASE WHEN t22.YEAR_TOTAL \u003e 0 THEN t30.YEAR_TOTAL * 1.0000 / t22.YEAR_TOTAL ELSE 0.0 END \u003e CASE WHEN t6.YEAR_TOTAL \u003e 0 THEN t14.YEAR_TOTAL * 1.0000 / t6.YEAR_TOTAL ELSE 0.0 END\nORDER BY t14.CUSTOMER_ID NULLS FIRST, t14.CUSTOMER_FIRST_NAME NULLS FIRST, t14.CUSTOMER_LAST_NAME NULLS FIRST, t14.CUSTOMER_PREFERRED_CUST_FLAG NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      283,
      276
    ],
    "optimizedTimesMs": [
      283,
      289
    ],
    "originalAvgMs": 279,
    "optimizedAvgMs": 286,
    "speedup": 0.9755244755244755,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 45150932,
    "optimizedPlanMaxRows": 45150932
  },
  {
    "query": "q12",
    "status": "error",
    "error": "while converting SUM(`WS_EXT_SALES_PRICE`) * 100.0000 / (SUM(SUM(`WS_EXT_SALES_PRICE`)) OVER (PARTITION BY `I_CLASS`))",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q13",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "PROJECT_REMOVE"
    ],
    "optimizedSql": "SELECT AVG(store_sales.ss_quantity) AS AVG1, AVG(store_sales.ss_ext_sales_price) AS AVG2, AVG(store_sales.ss_ext_wholesale_cost) AS AVG3, SUM(store_sales.ss_ext_wholesale_cost)\nFROM store_sales\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nCROSS JOIN customer_demographics\nINNER JOIN household_demographics ON store_sales.ss_hdemo_sk \u003d household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk \u003d store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status \u003d \u0027M\u0027) AND (customer_demographics.cd_education_status \u003d \u0027Advanced Degree\u0027 AND (store_sales.ss_sales_price \u003e\u003d 100.00 AND store_sales.ss_sales_price \u003c\u003d 150.00 AND household_demographics.hd_dep_count \u003d 3)) OR store_sales.ss_hdemo_sk \u003d household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk \u003d store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status \u003d \u0027S\u0027) AND (customer_demographics.cd_education_status \u003d \u0027College\u0027 AND (store_sales.ss_sales_price \u003e\u003d 50.00 AND store_sales.ss_sales_price \u003c\u003d 100.00 AND household_demographics.hd_dep_count \u003d 1)) OR store_sales.ss_hdemo_sk \u003d household_demographics.hd_demo_sk AND (customer_demographics.cd_demo_sk \u003d store_sales.ss_cdemo_sk AND customer_demographics.cd_marital_status \u003d \u0027W\u0027) AND (customer_demographics.cd_education_status \u003d \u00272 yr Degree\u0027 AND (store_sales.ss_sales_price \u003e\u003d 150.00 AND store_sales.ss_sales_price \u003c\u003d 200.00 AND household_demographics.hd_dep_count \u003d 1))\nINNER JOIN customer_address ON store_sales.ss_addr_sk \u003d customer_address.ca_address_sk AND customer_address.ca_country \u003d \u0027United States\u0027 AND customer_address.ca_state IN (\u0027OH\u0027, \u0027TX\u0027) AND (store_sales.ss_net_profit \u003e\u003d 100 AND store_sales.ss_net_profit \u003c\u003d 200) OR store_sales.ss_addr_sk \u003d customer_address.ca_address_sk AND customer_address.ca_country \u003d \u0027United States\u0027 AND customer_address.ca_state IN (\u0027KY\u0027, \u0027NM\u0027, \u0027OR\u0027) AND (store_sales.ss_net_profit \u003e\u003d 150 AND store_sales.ss_net_profit \u003c\u003d 300) OR store_sales.ss_addr_sk \u003d customer_address.ca_address_sk AND customer_address.ca_country \u003d \u0027United States\u0027 AND customer_address.ca_state IN (\u0027MS\u0027, \u0027TX\u0027, \u0027VA\u0027) AND (store_sales.ss_net_profit \u003e\u003d 50 AND store_sales.ss_net_profit \u003c\u003d 250)\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk",
    "originalTimesMs": [
      60,
      67
    ],
    "optimizedTimesMs": [
      64,
      62
    ],
    "originalAvgMs": 63,
    "optimizedAvgMs": 63,
    "speedup": 1.0,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q14",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "FILTER_SUB_QUERY_TO_CORRELATE",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, SUM(SALES) AS SUM_SALES, SUM(NUMBER_SALES) AS SUM_NUMBER_SALES\nFROM (SELECT *\nFROM (SELECT \u0027store\u0027 AS CHANNEL, t13.i_brand_id AS I_BRAND_ID, t13.i_class_id AS I_CLASS_ID, t13.i_category_id AS I_CATEGORY_ID, t13.SALES, t13.NUMBER_SALES\nFROM (SELECT item3.i_brand_id, item3.i_class_id, item3.i_category_id, SUM(t10.ss_quantity * t10.ss_list_price) AS SALES, COUNT(*) AS NUMBER_SALES\nFROM (SELECT store_sales.ss_sold_date_sk, store_sales.ss_sold_time_sk, store_sales.ss_item_sk, store_sales.ss_customer_sk, store_sales.ss_cdemo_sk, store_sales.ss_hdemo_sk, store_sales.ss_addr_sk, store_sales.ss_store_sk, store_sales.ss_promo_sk, store_sales.ss_ticket_number, store_sales.ss_quantity, store_sales.ss_wholesale_cost, store_sales.ss_list_price, store_sales.ss_sales_price, store_sales.ss_ext_discount_amt, store_sales.ss_ext_sales_price, store_sales.ss_ext_wholesale_cost, store_sales.ss_ext_list_price, store_sales.ss_ext_tax, store_sales.ss_coupon_amt, store_sales.ss_net_paid, store_sales.ss_net_paid_inc_tax, store_sales.ss_net_profit\nFROM store_sales\nINNER JOIN (SELECT item.i_item_sk AS SS_ITEM_SK\nFROM item,\n(SELECT *\nFROM (SELECT item0.i_brand_id AS BRAND_ID, item0.i_class_id AS CLASS_ID, item0.i_category_id AS CATEGORY_ID\nFROM store_sales AS store_sales0,\nitem AS item0,\ndate_dim\nWHERE store_sales0.ss_item_sk \u003d item0.i_item_sk AND store_sales0.ss_sold_date_sk \u003d date_dim.d_date_sk AND date_dim.d_year \u003e\u003d 1999 AND date_dim.d_year \u003c\u003d 1999 + 2\nINTERSECT\nSELECT item1.i_brand_id AS I_BRAND_ID, item1.i_class_id AS I_CLASS_ID, item1.i_category_id AS I_CATEGORY_ID\nFROM catalog_sales,\nitem AS item1,\ndate_dim AS date_dim0\nWHERE catalog_sales.cs_item_sk \u003d item1.i_item_sk AND catalog_sales.cs_sold_date_sk \u003d date_dim0.d_date_sk AND date_dim0.d_year \u003e\u003d 1999 AND date_dim0.d_year \u003c\u003d 1999 + 2)\nINTERSECT\nSELECT item2.i_brand_id AS I_BRAND_ID, item2.i_class_id AS I_CLASS_ID, item2.i_category_id AS I_CATEGORY_ID\nFROM web_sales,\nitem AS item2,\ndate_dim AS date_dim1\nWHERE web_sales.ws_item_sk \u003d item2.i_item_sk AND web_sales.ws_sold_date_sk \u003d date_dim1.d_date_sk AND date_dim1.d_year \u003e\u003d 1999 AND date_dim1.d_year \u003c\u003d 1999 + 2) AS t6\nWHERE item.i_brand_id \u003d t6.BRAND_ID AND item.i_class_id \u003d t6.CLASS_ID AND item.i_category_id \u003d t6.CATEGORY_ID\nGROUP BY item.i_item_sk) AS t9 ON store_sales.ss_item_sk \u003d t9.SS_ITEM_SK) AS t10\nINNER JOIN item AS item3 ON t10.ss_item_sk \u003d item3.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d CAST(1999 + 2 AS BIGINT) AND d_moy \u003d 11) AS t11 ON t10.ss_sold_date_sk \u003d t11.d_date_sk\nGROUP BY item3.i_brand_id, item3.i_class_id, item3.i_category_id) AS t13\nLEFT JOIN (SELECT AVG(QUANTITY * LIST_PRICE) AS AVERAGE_SALES\nFROM (SELECT *\nFROM (SELECT store_sales1.ss_quantity AS QUANTITY, store_sales1.ss_list_price AS LIST_PRICE\nFROM store_sales AS store_sales1,\ndate_dim AS date_dim3\nWHERE store_sales1.ss_sold_date_sk \u003d date_dim3.d_date_sk AND date_dim3.d_year \u003e\u003d 1999 AND date_dim3.d_year \u003c\u003d 1999 + 2\nUNION ALL\nSELECT catalog_sales0.cs_quantity AS QUANTITY, catalog_sales0.cs_list_price AS LIST_PRICE\nFROM catalog_sales AS catalog_sales0,\ndate_dim AS date_dim4\nWHERE catalog_sales0.cs_sold_date_sk \u003d date_dim4.d_date_sk AND date_dim4.d_year \u003e\u003d 1999 AND date_dim4.d_year \u003c\u003d 1999 + 2)\nUNION ALL\nSELECT web_sales0.ws_quantity AS QUANTITY, web_sales0.ws_list_price AS LIST_PRICE\nFROM web_sales AS web_sales0,\ndate_dim AS date_dim5\nWHERE web_sales0.ws_sold_date_sk \u003d date_dim5.d_date_sk AND date_dim5.d_year \u003e\u003d 1999 AND date_dim5.d_year \u003c\u003d 1999 + 2) AS t21) AS t24 ON TRUE\nWHERE t13.SALES \u003e t24.AVERAGE_SALES\nUNION ALL\nSELECT \u0027catalog\u0027 AS CHANNEL, t41.i_brand_id AS I_BRAND_ID, t41.i_class_id AS I_CLASS_ID, t41.i_category_id AS I_CATEGORY_ID, t41.SALES, t41.NUMBER_SALES\nFROM (SELECT item8.i_brand_id, item8.i_class_id, item8.i_category_id, SUM(t38.cs_quantity * t38.cs_list_price) AS SALES, COUNT(*) AS NUMBER_SALES\nFROM (SELECT catalog_sales1.cs_sold_date_sk, catalog_sales1.cs_sold_time_sk, catalog_sales1.cs_ship_date_sk, catalog_sales1.cs_bill_customer_sk, catalog_sales1.cs_bill_cdemo_sk, catalog_sales1.cs_bill_hdemo_sk, catalog_sales1.cs_bill_addr_sk, catalog_sales1.cs_ship_customer_sk, catalog_sales1.cs_ship_cdemo_sk, catalog_sales1.cs_ship_hdemo_sk, catalog_sales1.cs_ship_addr_sk, catalog_sales1.cs_call_center_sk, catalog_sales1.cs_catalog_page_sk, catalog_sales1.cs_ship_mode_sk, catalog_sales1.cs_warehouse_sk, catalog_sales1.cs_item_sk, catalog_sales1.cs_promo_sk, catalog_sales1.cs_order_number, catalog_sales1.cs_quantity, catalog_sales1.cs_wholesale_cost, catalog_sales1.cs_list_price, catalog_sales1.cs_sales_price, catalog_sales1.cs_ext_discount_amt, catalog_sales1.cs_ext_sales_price, catalog_sales1.cs_ext_wholesale_cost, catalog_sales1.cs_ext_list_price, catalog_sales1.cs_ext_tax, catalog_sales1.cs_coupon_amt, catalog_sales1.cs_ext_ship_cost, catalog_sales1.cs_net_paid, catalog_sales1.cs_net_paid_inc_tax, catalog_sales1.cs_net_paid_inc_ship, catalog_sales1.cs_net_paid_inc_ship_tax, catalog_sales1.cs_net_profit\nFROM catalog_sales AS catalog_sales1\nINNER JOIN (SELECT item4.i_item_sk AS SS_ITEM_SK\nFROM item AS item4,\n(SELECT *\nFROM (SELECT item5.i_brand_id AS BRAND_ID, item5.i_class_id AS CLASS_ID, item5.i_category_id AS CATEGORY_ID\nFROM store_sales AS store_sales2,\nitem AS item5,\ndate_dim AS date_dim6\nWHERE store_sales2.ss_item_sk \u003d item5.i_item_sk AND store_sales2.ss_sold_date_sk \u003d date_dim6.d_date_sk AND date_dim6.d_year \u003e\u003d 1999 AND date_dim6.d_year \u003c\u003d 1999 + 2\nINTERSECT\nSELECT item6.i_brand_id AS I_BRAND_ID, item6.i_class_id AS I_CLASS_ID, item6.i_category_id AS I_CATEGORY_ID\nFROM catalog_sales AS catalog_sales2,\nitem AS item6,\ndate_dim AS date_dim7\nWHERE catalog_sales2.cs_item_sk \u003d item6.i_item_sk AND catalog_sales2.cs_sold_date_sk \u003d date_dim7.d_date_sk AND date_dim7.d_year \u003e\u003d 1999 AND date_dim7.d_year \u003c\u003d 1999 + 2)\nINTERSECT\nSELECT item7.i_brand_id AS I_BRAND_ID, item7.i_class_id AS I_CLASS_ID, item7.i_category_id AS I_CATEGORY_ID\nFROM web_sales AS web_sales1,\nitem AS item7,\ndate_dim AS date_dim8\nWHERE web_sales1.ws_item_sk \u003d item7.i_item_sk AND web_sales1.ws_sold_date_sk \u003d date_dim8.d_date_sk AND date_dim8.d_year \u003e\u003d 1999 AND date_dim8.d_year \u003c\u003d 1999 + 2) AS t34\nWHERE item4.i_brand_id \u003d t34.BRAND_ID AND item4.i_class_id \u003d t34.CLASS_ID AND item4.i_category_id \u003d t34.CATEGORY_ID\nGROUP BY item4.i_item_sk) AS t37 ON catalog_sales1.cs_item_sk \u003d t37.SS_ITEM_SK) AS t38\nINNER JOIN item AS item8 ON t38.cs_item_sk \u003d item8.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d CAST(1999 + 2 AS BIGINT) AND d_moy \u003d 11) AS t39 ON t38.cs_sold_date_sk \u003d t39.d_date_sk\nGROUP BY item8.i_brand_id, item8.i_class_id, item8.i_category_id) AS t41\nLEFT JOIN (SELECT AVG(QUANTITY * LIST_PRICE) AS AVERAGE_SALES\nFROM (SELECT *\nFROM (SELECT store_sales3.ss_quantity AS QUANTITY, store_sales3.ss_list_price AS LIST_PRICE\nFROM store_sales AS store_sales3,\ndate_dim AS date_dim10\nWHERE store_sales3.ss_sold_date_sk \u003d date_dim10.d_date_sk AND date_dim10.d_year \u003e\u003d 1999 AND date_dim10.d_year \u003c\u003d 1999 + 2\nUNION ALL\nSELECT catalog_sales3.cs_quantity AS QUANTITY, catalog_sales3.cs_list_price AS LIST_PRICE\nFROM catalog_sales AS catalog_sales3,\ndate_dim AS date_dim11\nWHERE catalog_sales3.cs_sold_date_sk \u003d date_dim11.d_date_sk AND date_dim11.d_year \u003e\u003d 1999 AND date_dim11.d_year \u003c\u003d 1999 + 2)\nUNION ALL\nSELECT web_sales2.ws_quantity AS QUANTITY, web_sales2.ws_list_price AS LIST_PRICE\nFROM web_sales AS web_sales2,\ndate_dim AS date_dim12\nWHERE web_sales2.ws_sold_date_sk \u003d date_dim12.d_date_sk AND date_dim12.d_year \u003e\u003d 1999 AND date_dim12.d_year \u003c\u003d 1999 + 2) AS t49) AS t52 ON TRUE\nWHERE t41.SALES \u003e t52.AVERAGE_SALES)\nUNION ALL\nSELECT \u0027web\u0027 AS CHANNEL, t70.i_brand_id AS I_BRAND_ID, t70.i_class_id AS I_CLASS_ID, t70.i_category_id AS I_CATEGORY_ID, t70.SALES, t70.NUMBER_SALES\nFROM (SELECT item13.i_brand_id, item13.i_class_id, item13.i_category_id, SUM(t67.ws_quantity * t67.ws_list_price) AS SALES, COUNT(*) AS NUMBER_SALES\nFROM (SELECT web_sales3.ws_sold_date_sk, web_sales3.ws_sold_time_sk, web_sales3.ws_ship_date_sk, web_sales3.ws_item_sk, web_sales3.ws_bill_customer_sk, web_sales3.ws_bill_cdemo_sk, web_sales3.ws_bill_hdemo_sk, web_sales3.ws_bill_addr_sk, web_sales3.ws_ship_customer_sk, web_sales3.ws_ship_cdemo_sk, web_sales3.ws_ship_hdemo_sk, web_sales3.ws_ship_addr_sk, web_sales3.ws_web_page_sk, web_sales3.ws_web_site_sk, web_sales3.ws_ship_mode_sk, web_sales3.ws_warehouse_sk, web_sales3.ws_promo_sk, web_sales3.ws_order_number, web_sales3.ws_quantity, web_sales3.ws_wholesale_cost, web_sales3.ws_list_price, web_sales3.ws_sales_price, web_sales3.ws_ext_discount_amt, web_sales3.ws_ext_sales_price, web_sales3.ws_ext_wholesale_cost, web_sales3.ws_ext_list_price, web_sales3.ws_ext_tax, web_sales3.ws_coupon_amt, web_sales3.ws_ext_ship_cost, web_sales3.ws_net_paid, web_sales3.ws_net_paid_inc_tax, web_sales3.ws_net_paid_inc_ship, web_sales3.ws_net_paid_inc_ship_tax, web_sales3.ws_net_profit\nFROM web_sales AS web_sales3\nINNER JOIN (SELECT item9.i_item_sk AS SS_ITEM_SK\nFROM item AS item9,\n(SELECT *\nFROM (SELECT item10.i_brand_id AS BRAND_ID, item10.i_class_id AS CLASS_ID, item10.i_category_id AS CATEGORY_ID\nFROM store_sales AS store_sales4,\nitem AS item10,\ndate_dim AS date_dim13\nWHERE store_sales4.ss_item_sk \u003d item10.i_item_sk AND store_sales4.ss_sold_date_sk \u003d date_dim13.d_date_sk AND date_dim13.d_year \u003e\u003d 1999 AND date_dim13.d_year \u003c\u003d 1999 + 2\nINTERSECT\nSELECT item11.i_brand_id AS I_BRAND_ID, item11.i_class_id AS I_CLASS_ID, item11.i_category_id AS I_CATEGORY_ID\nFROM catalog_sales AS catalog_sales4,\nitem AS item11,\ndate_dim AS date_dim14\nWHERE catalog_sales4.cs_item_sk \u003d item11.i_item_sk AND catalog_sales4.cs_sold_date_sk \u003d date_dim14.d_date_sk AND date_dim14.d_year \u003e\u003d 1999 AND date_dim14.d_year \u003c\u003d 1999 + 2)\nINTERSECT\nSELECT item12.i_brand_id AS I_BRAND_ID, item12.i_class_id AS I_CLASS_ID, item12.i_category_id AS I_CATEGORY_ID\nFROM web_sales AS web_sales4,\nitem AS item12,\ndate_dim AS date_dim15\nWHERE web_sales4.ws_item_sk \u003d item12.i_item_sk AND web_sales4.ws_sold_date_sk \u003d date_dim15.d_date_sk AND date_dim15.d_year \u003e\u003d 1999 AND date_dim15.d_year \u003c\u003d 1999 + 2) AS t63\nWHERE item9.i_brand_id \u003d t63.BRAND_ID AND item9.i_class_id \u003d t63.CLASS_ID AND item9.i_category_id \u003d t63.CATEGORY_ID\nGROUP BY item9.i_item_sk) AS t66 ON web_sales3.ws_item_sk \u003d t66.SS_ITEM_SK) AS t67\nINNER JOIN item AS item13 ON t67.ws_item_sk \u003d item13.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d CAST(1999 + 2 AS BIGINT) AND d_moy \u003d 11) AS t68 ON t67.ws_sold_date_sk \u003d t68.d_date_sk\nGROUP BY item13.i_brand_id, item13.i_class_id, item13.i_category_id) AS t70\nLEFT JOIN (SELECT AVG(QUANTITY * LIST_PRICE) AS AVERAGE_SALES\nFROM (SELECT *\nFROM (SELECT store_sales5.ss_quantity AS QUANTITY, store_sales5.ss_list_price AS LIST_PRICE\nFROM store_sales AS store_sales5,\ndate_dim AS date_dim17\nWHERE store_sales5.ss_sold_date_sk \u003d date_dim17.d_date_sk AND date_dim17.d_year \u003e\u003d 1999 AND date_dim17.d_year \u003c\u003d 1999 + 2\nUNION ALL\nSELECT catalog_sales5.cs_quantity AS QUANTITY, catalog_sales5.cs_list_price AS LIST_PRICE\nFROM catalog_sales AS catalog_sales5,\ndate_dim AS date_dim18\nWHERE catalog_sales5.cs_sold_date_sk \u003d date_dim18.d_date_sk AND date_dim18.d_year \u003e\u003d 1999 AND date_dim18.d_year \u003c\u003d 1999 + 2)\nUNION ALL\nSELECT web_sales5.ws_quantity AS QUANTITY, web_sales5.ws_list_price AS LIST_PRICE\nFROM web_sales AS web_sales5,\ndate_dim AS date_dim19\nWHERE web_sales5.ws_sold_date_sk \u003d date_dim19.d_date_sk AND date_dim19.d_year \u003e\u003d 1999 AND date_dim19.d_year \u003c\u003d 1999 + 2) AS t78) AS t81 ON TRUE\nWHERE t70.SALES \u003e t81.AVERAGE_SALES) AS t84\nGROUP BY ROLLUP(CHANNEL, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID)\nORDER BY CHANNEL NULLS FIRST, I_BRAND_ID NULLS FIRST, I_CLASS_ID NULLS FIRST, I_CATEGORY_ID NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      338,
      350
    ],
    "optimizedTimesMs": [
      336,
      340
    ],
    "originalAvgMs": 344,
    "optimizedAvgMs": 338,
    "speedup": 1.017751479289941,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 5037465,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q15",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer_address.ca_zip AS CA_ZIP, SUM(catalog_sales.cs_sales_price)\nFROM catalog_sales\nINNER JOIN customer ON catalog_sales.cs_bill_customer_sk \u003d customer.c_customer_sk\nINNER JOIN customer_address ON customer.c_current_addr_sk \u003d customer_address.ca_address_sk AND (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002785669\u0027 OR SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002786197\u0027 OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002788274\u0027 OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002783405\u0027 OR SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002786475\u0027)) OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002785392\u0027 OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002785460\u0027 OR SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002780348\u0027) OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002781792\u0027 OR (customer_address.ca_state IN (\u0027CA\u0027, \u0027GA\u0027, \u0027WA\u0027) OR catalog_sales.cs_sales_price \u003e 500))))\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_qoy \u003d 2 AND d_year \u003d 2001) AS t ON catalog_sales.cs_sold_date_sk \u003d t.d_date_sk\nGROUP BY customer_address.ca_zip\nORDER BY customer_address.ca_zip NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      119,
      117
    ],
    "optimizedTimesMs": [
      21,
      18
    ],
    "originalAvgMs": 118,
    "optimizedAvgMs": 19,
    "speedup": 6.2105263157894735,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2000000,
    "optimizedPlanMaxRows": 2000000
  },
  {
    "query": "q16",
    "status": "error",
    "error": "variable $cor0 is not found",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q17",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT item.i_item_id AS I_ITEM_ID, item.i_item_desc AS I_ITEM_DESC, store.s_state AS S_STATE, COUNT(store_sales.ss_quantity) AS STORE_SALES_QUANTITYCOUNT, AVG(store_sales.ss_quantity) AS STORE_SALES_QUANTITYAVE, STDDEV_SAMP(store_sales.ss_quantity) AS STORE_SALES_QUANTITYSTDEV, STDDEV_SAMP(store_sales.ss_quantity) / AVG(store_sales.ss_quantity) AS STORE_SALES_QUANTITYCOV, COUNT(store_returns.sr_return_quantity) AS STORE_RETURNS_QUANTITYCOUNT, AVG(store_returns.sr_return_quantity) AS STORE_RETURNS_QUANTITYAVE, STDDEV_SAMP(store_returns.sr_return_quantity) AS STORE_RETURNS_QUANTITYSTDEV, STDDEV_SAMP(store_returns.sr_return_quantity) / AVG(store_returns.sr_return_quantity) AS STORE_RETURNS_QUANTITYCOV, COUNT(catalog_sales.cs_quantity) AS CATALOG_SALES_QUANTITYCOUNT, AVG(catalog_sales.cs_quantity) AS CATALOG_SALES_QUANTITYAVE, STDDEV_SAMP(catalog_sales.cs_quantity) AS CATALOG_SALES_QUANTITYSTDEV, STDDEV_SAMP(catalog_sales.cs_quantity) / AVG(catalog_sales.cs_quantity) AS CATALOG_SALES_QUANTITYCOV\nFROM store_sales\nINNER JOIN store_returns ON store_sales.ss_customer_sk \u003d store_returns.sr_customer_sk AND store_sales.ss_item_sk \u003d store_returns.sr_item_sk AND store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number\nINNER JOIN catalog_sales ON store_returns.sr_customer_sk \u003d catalog_sales.cs_bill_customer_sk AND store_returns.sr_item_sk \u003d catalog_sales.cs_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_quarter_name \u003d \u00272001Q1\u0027) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_quarter_name IN (\u00272001Q1\u0027, \u00272001Q2\u0027, \u00272001Q3\u0027)) AS t0 ON store_returns.sr_returned_date_sk \u003d t0.d_date_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_quarter_name IN (\u00272001Q1\u0027, \u00272001Q2\u0027, \u00272001Q3\u0027)) AS t1 ON catalog_sales.cs_sold_date_sk \u003d t1.d_date_sk\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nGROUP BY item.i_item_id, item.i_item_desc, store.s_state\nORDER BY item.i_item_id NULLS FIRST, item.i_item_desc NULLS FIRST, store.s_state NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      29,
      28
    ],
    "optimizedTimesMs": [
      35,
      27
    ],
    "originalAvgMs": 28,
    "optimizedAvgMs": 31,
    "speedup": 0.9032258064516129,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q18",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT item.i_item_id AS I_ITEM_ID, t1.ca_country AS CA_COUNTRY, t1.ca_state AS CA_STATE, t1.ca_county AS CA_COUNTY, AVG(CAST(catalog_sales.cs_quantity AS DECIMAL(12, 2))) AS AGG1, AVG(CAST(catalog_sales.cs_list_price AS DECIMAL(12, 2))) AS AGG2, AVG(CAST(catalog_sales.cs_coupon_amt AS DECIMAL(12, 2))) AS AGG3, AVG(CAST(catalog_sales.cs_sales_price AS DECIMAL(12, 2))) AS AGG4, AVG(CAST(catalog_sales.cs_net_profit AS DECIMAL(12, 2))) AS AGG5, AVG(CAST(t0.c_birth_year AS DECIMAL(12, 2))) AS AGG6, AVG(CAST(t.cd_dep_count AS DECIMAL(12, 2))) AS AGG7\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM customer_demographics\nWHERE cd_gender \u003d \u0027F\u0027 AND cd_education_status \u003d \u0027Unknown\u0027) AS t ON catalog_sales.cs_bill_cdemo_sk \u003d t.cd_demo_sk\nCROSS JOIN customer_demographics AS customer_demographics0\nINNER JOIN (SELECT *\nFROM customer\nWHERE c_birth_month IN (1, 2, 6, 8, 9, 12)) AS t0 ON catalog_sales.cs_bill_customer_sk \u003d t0.c_customer_sk AND customer_demographics0.cd_demo_sk \u003d t0.c_current_cdemo_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_state IN (\u0027IN\u0027, \u0027MS\u0027, \u0027ND\u0027, \u0027NM\u0027, \u0027OK\u0027, \u0027VA\u0027)) AS t1 ON t0.c_current_addr_sk \u003d t1.ca_address_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998) AS t2 ON catalog_sales.cs_sold_date_sk \u003d t2.d_date_sk\nINNER JOIN item ON catalog_sales.cs_item_sk \u003d item.i_item_sk\nGROUP BY ROLLUP(item.i_item_id, t1.ca_country, t1.ca_state, t1.ca_county)\nORDER BY t1.ca_country NULLS FIRST, t1.ca_state NULLS FIRST, t1.ca_county NULLS FIRST, item.i_item_id NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      55,
      59
    ],
    "optimizedTimesMs": [
      58,
      56
    ],
    "originalAvgMs": 57,
    "optimizedAvgMs": 57,
    "speedup": 1.0,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2000000,
    "optimizedPlanMaxRows": 2000000
  },
  {
    "query": "q19",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t3.i_brand_id AS BRAND_ID, t3.i_brand AS BRAND, t3.i_manufact_id AS I_MANUFACT_ID, t3.i_manufact AS I_MANUFACT, t3.EXT_PRICE\nFROM (SELECT t0.i_brand, t0.i_brand_id, t0.i_manufact_id, t0.i_manufact, SUM(store_sales.ss_ext_sales_price) AS EXT_PRICE\nFROM (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 11 AND d_year \u003d 1998) AS t\nINNER JOIN store_sales ON t.d_date_sk \u003d store_sales.ss_sold_date_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_manager_id \u003d 8) AS t0 ON store_sales.ss_item_sk \u003d t0.i_item_sk\nINNER JOIN customer ON store_sales.ss_customer_sk \u003d customer.c_customer_sk\nINNER JOIN customer_address ON customer.c_current_addr_sk \u003d customer_address.ca_address_sk\nINNER JOIN store ON SUBSTRING(customer_address.ca_zip, 1, 5) \u003c\u003e SUBSTRING(store.s_zip, 1, 5) AND store_sales.ss_store_sk \u003d store.s_store_sk\nGROUP BY t0.i_brand, t0.i_brand_id, t0.i_manufact_id, t0.i_manufact\nORDER BY 5 DESC, t0.i_brand, t0.i_brand_id, t0.i_manufact_id, t0.i_manufact\nFETCH NEXT 100 ROWS ONLY) AS t3",
    "originalTimesMs": [
      25,
      24
    ],
    "optimizedTimesMs": [
      30,
      26
    ],
    "originalAvgMs": 24,
    "optimizedAvgMs": 28,
    "speedup": 0.8571428571428571,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q20",
    "status": "error",
    "error": "while converting SUM(`CS_EXT_SALES_PRICE`) * 100.0000 / (SUM(SUM(`CS_EXT_SALES_PRICE`)) OVER (PARTITION BY `I_CLASS`))",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q21",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE"
    ],
    "optimizedSql": "SELECT warehouse.w_warehouse_name AS W_WAREHOUSE_NAME, t.i_item_id AS I_ITEM_ID, SUM(CASE WHEN t0.d_date \u003c DATE \u00272000-03-11\u0027 THEN inventory.inv_quantity_on_hand ELSE 0 END) AS INV_BEFORE, SUM(CASE WHEN t0.d_date \u003e\u003d DATE \u00272000-03-11\u0027 THEN inventory.inv_quantity_on_hand ELSE 0 END) AS INV_AFTER\nFROM inventory\nINNER JOIN warehouse ON inventory.inv_warehouse_sk \u003d warehouse.w_warehouse_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_current_price \u003e\u003d 0.99 AND i_current_price \u003c\u003d 1.49) AS t ON inventory.inv_item_sk \u003d t.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-02-10\u0027 AND d_date \u003c\u003d DATE \u00272000-04-10\u0027) AS t0 ON inventory.inv_date_sk \u003d t0.d_date_sk\nGROUP BY warehouse.w_warehouse_name, t.i_item_id\nHAVING CASE WHEN SUM(CASE WHEN t0.d_date \u003c DATE \u00272000-03-11\u0027 THEN inventory.inv_quantity_on_hand ELSE 0 END) \u003e 0 THEN SUM(CASE WHEN t0.d_date \u003e\u003d DATE \u00272000-03-11\u0027 THEN inventory.inv_quantity_on_hand ELSE 0 END) * 1.000 / SUM(CASE WHEN t0.d_date \u003c DATE \u00272000-03-11\u0027 THEN inventory.inv_quantity_on_hand ELSE 0 END) ELSE NULL END \u003e\u003d 2.000 / 3.000 AND CASE WHEN SUM(CASE WHEN t0.d_date \u003c DATE \u00272000-03-11\u0027 THEN inventory.inv_quantity_on_hand ELSE 0 END) \u003e 0 THEN SUM(CASE WHEN t0.d_date \u003e\u003d DATE \u00272000-03-11\u0027 THEN inventory.inv_quantity_on_hand ELSE 0 END) * 1.000 / SUM(CASE WHEN t0.d_date \u003c DATE \u00272000-03-11\u0027 THEN inventory.inv_quantity_on_hand ELSE 0 END) ELSE NULL END \u003c\u003d 3.000 / 2.000\nORDER BY warehouse.w_warehouse_name NULLS FIRST, t.i_item_id NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      11,
      10
    ],
    "optimizedTimesMs": [
      11,
      11
    ],
    "originalAvgMs": 10,
    "optimizedAvgMs": 11,
    "speedup": 0.9090909090909091,
    "originalRowCount": 47,
    "optimizedRowCount": 47,
    "validationPassed": true,
    "originalPlanMaxRows": 3995568,
    "optimizedPlanMaxRows": 3995568
  },
  {
    "query": "q22",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t2.i_product_name AS I_PRODUCT_NAME, t2.i_brand AS I_BRAND, t2.i_class AS I_CLASS, t2.i_category AS I_CATEGORY, t2.QOH\nFROM (SELECT item.i_product_name, item.i_brand, item.i_class, item.i_category, AVG(inventory.inv_quantity_on_hand) AS QOH\nFROM inventory\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t ON inventory.inv_date_sk \u003d t.d_date_sk\nINNER JOIN item ON inventory.inv_item_sk \u003d item.i_item_sk\nGROUP BY ROLLUP(item.i_product_name, item.i_brand, item.i_class, item.i_category)\nORDER BY 5 NULLS FIRST, item.i_product_name NULLS FIRST, item.i_brand NULLS FIRST, item.i_class NULLS FIRST, item.i_category NULLS FIRST\nFETCH NEXT 100 ROWS ONLY) AS t2",
    "originalTimesMs": [
      355,
      292
    ],
    "optimizedTimesMs": [
      274,
      277
    ],
    "originalAvgMs": 323,
    "optimizedAvgMs": 275,
    "speedup": 1.1745454545454546,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 3995568,
    "optimizedPlanMaxRows": 3995568
  },
  {
    "query": "q23",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT C_LAST_NAME, C_FIRST_NAME, SALES\nFROM (SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, SUM(catalog_sales.cs_quantity * catalog_sales.cs_list_price) AS SALES\nFROM catalog_sales\nINNER JOIN customer ON catalog_sales.cs_bill_customer_sk \u003d customer.c_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 AND d_moy \u003d 2) AS t ON catalog_sales.cs_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT t1.ITEMDESC, t1.i_item_sk AS ITEM_SK, t0.d_date AS SOLDDATE, COUNT(*) AS CNT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 OR d_year \u003d CAST(2000 + 1 AS BIGINT) OR d_year \u003d CAST(2000 + 2 AS BIGINT) OR d_year \u003d CAST(2000 + 3 AS BIGINT)) AS t0 ON store_sales.ss_sold_date_sk \u003d t0.d_date_sk\nINNER JOIN (SELECT SUBSTRING(i_item_desc, 1, 30) AS ITEMDESC, i_item_sk, i_item_id, i_rec_start_date, i_rec_end_date, i_item_desc, i_current_price, i_wholesale_cost, i_brand_id, i_brand, i_class_id, i_class, i_category_id, i_category, i_manufact_id, i_manufact, i_size, i_formulation, i_color, i_units, i_container, i_manager_id, i_product_name\nFROM item) AS t1 ON store_sales.ss_item_sk \u003d t1.i_item_sk\nGROUP BY t1.ITEMDESC, t1.i_item_sk, t0.d_date\nHAVING COUNT(*) \u003e 4) AS t5 ON catalog_sales.cs_item_sk \u003d t5.ITEM_SK\nINNER JOIN (SELECT customer0.c_customer_sk AS C_CUSTOMER_SK, SUM(store_sales0.ss_quantity * store_sales0.ss_sales_price) AS SSALES\nFROM store_sales AS store_sales0\nINNER JOIN customer AS customer0 ON store_sales0.ss_customer_sk \u003d customer0.c_customer_sk\nCROSS JOIN (SELECT MAX(t9.CSALES) AS TPCDS_CMAX\nFROM (SELECT SUM(store_sales1.ss_quantity * store_sales1.ss_sales_price) AS CSALES\nFROM store_sales AS store_sales1\nINNER JOIN customer AS customer1 ON store_sales1.ss_customer_sk \u003d customer1.c_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 OR d_year \u003d CAST(2000 + 1 AS BIGINT) OR d_year \u003d CAST(2000 + 2 AS BIGINT) OR d_year \u003d CAST(2000 + 3 AS BIGINT)) AS t6 ON store_sales1.ss_sold_date_sk \u003d t6.d_date_sk\nGROUP BY customer1.c_customer_sk) AS t9) AS t10\nGROUP BY customer0.c_customer_sk\nHAVING SUM(store_sales0.ss_quantity * store_sales0.ss_sales_price) \u003e 50 / 100.0 * MAX(t10.TPCDS_CMAX)) AS t14 ON catalog_sales.cs_bill_customer_sk \u003d t14.C_CUSTOMER_SK\nGROUP BY customer.c_last_name, customer.c_first_name\nUNION ALL\nSELECT customer2.c_last_name AS C_LAST_NAME, customer2.c_first_name AS C_FIRST_NAME, SUM(web_sales.ws_quantity * web_sales.ws_list_price) AS SALES\nFROM web_sales\nINNER JOIN customer AS customer2 ON web_sales.ws_bill_customer_sk \u003d customer2.c_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 AND d_moy \u003d 2) AS t18 ON web_sales.ws_sold_date_sk \u003d t18.d_date_sk\nINNER JOIN (SELECT t20.ITEMDESC, t20.i_item_sk AS ITEM_SK, t19.d_date AS SOLDDATE, COUNT(*) AS CNT\nFROM store_sales AS store_sales2\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 OR d_year \u003d CAST(2000 + 1 AS BIGINT) OR d_year \u003d CAST(2000 + 2 AS BIGINT) OR d_year \u003d CAST(2000 + 3 AS BIGINT)) AS t19 ON store_sales2.ss_sold_date_sk \u003d t19.d_date_sk\nINNER JOIN (SELECT SUBSTRING(i_item_desc, 1, 30) AS ITEMDESC, i_item_sk, i_item_id, i_rec_start_date, i_rec_end_date, i_item_desc, i_current_price, i_wholesale_cost, i_brand_id, i_brand, i_class_id, i_class, i_category_id, i_category, i_manufact_id, i_manufact, i_size, i_formulation, i_color, i_units, i_container, i_manager_id, i_product_name\nFROM item) AS t20 ON store_sales2.ss_item_sk \u003d t20.i_item_sk\nGROUP BY t20.ITEMDESC, t20.i_item_sk, t19.d_date\nHAVING COUNT(*) \u003e 4) AS t24 ON web_sales.ws_item_sk \u003d t24.ITEM_SK\nINNER JOIN (SELECT customer3.c_customer_sk AS C_CUSTOMER_SK, SUM(store_sales3.ss_quantity * store_sales3.ss_sales_price) AS SSALES\nFROM store_sales AS store_sales3\nINNER JOIN customer AS customer3 ON store_sales3.ss_customer_sk \u003d customer3.c_customer_sk\nCROSS JOIN (SELECT MAX(t28.CSALES) AS TPCDS_CMAX\nFROM (SELECT SUM(store_sales4.ss_quantity * store_sales4.ss_sales_price) AS CSALES\nFROM store_sales AS store_sales4\nINNER JOIN customer AS customer4 ON store_sales4.ss_customer_sk \u003d customer4.c_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 OR d_year \u003d CAST(2000 + 1 AS BIGINT) OR d_year \u003d CAST(2000 + 2 AS BIGINT) OR d_year \u003d CAST(2000 + 3 AS BIGINT)) AS t25 ON store_sales4.ss_sold_date_sk \u003d t25.d_date_sk\nGROUP BY customer4.c_customer_sk) AS t28) AS t29\nGROUP BY customer3.c_customer_sk\nHAVING SUM(store_sales3.ss_quantity * store_sales3.ss_sales_price) \u003e 50 / 100.0 * MAX(t29.TPCDS_CMAX)) AS t33 ON web_sales.ws_bill_customer_sk \u003d t33.C_CUSTOMER_SK\nGROUP BY customer2.c_last_name, customer2.c_first_name)\nORDER BY C_LAST_NAME NULLS FIRST, C_FIRST_NAME NULLS FIRST, SALES NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      375,
      382
    ],
    "optimizedTimesMs": [
      716,
      742
    ],
    "originalAvgMs": 378,
    "optimizedAvgMs": 729,
    "speedup": 0.5185185185185185,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 3099951,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q24",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "SUBQUERY_REMOVE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t3.C_LAST_NAME, t3.C_FIRST_NAME, t3.S_STORE_NAME, SUM(t3.NETPAID) AS PAID\nFROM (SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, t.s_store_name AS S_STORE_NAME, SUM(store_sales.ss_net_paid) AS NETPAID\nFROM store_sales\nINNER JOIN store_returns ON store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number AND store_sales.ss_item_sk \u003d store_returns.sr_item_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_market_id \u003d 8) AS t ON store_sales.ss_store_sk \u003d t.s_store_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nINNER JOIN customer ON store_sales.ss_customer_sk \u003d customer.c_customer_sk\nINNER JOIN customer_address ON customer.c_current_addr_sk \u003d customer_address.ca_address_sk AND customer.c_birth_country \u003c\u003e UPPER(customer_address.ca_country) AND t.s_zip \u003d customer_address.ca_zip\nGROUP BY customer.c_last_name, customer.c_first_name, t.s_store_name, customer_address.ca_state, t.s_state, item.i_color, item.i_current_price, item.i_manager_id, item.i_units, item.i_size\nHAVING item.i_color \u003d \u0027peach\u0027) AS t3\nGROUP BY t3.C_LAST_NAME, t3.C_FIRST_NAME, t3.S_STORE_NAME\nHAVING SUM(t3.NETPAID) \u003e (((SELECT 0.05 * AVG(t8.NETPAID)\nFROM (SELECT SUM(store_sales0.ss_net_paid) AS NETPAID\nFROM store_sales AS store_sales0,\nstore_returns AS store_returns0,\nstore AS store0,\nitem AS item0,\ncustomer AS customer0,\ncustomer_address AS customer_address0\nWHERE store_sales0.ss_ticket_number \u003d store_returns0.sr_ticket_number AND store_sales0.ss_item_sk \u003d store_returns0.sr_item_sk AND (store_sales0.ss_customer_sk \u003d customer0.c_customer_sk AND store_sales0.ss_item_sk \u003d item0.i_item_sk) AND (store_sales0.ss_store_sk \u003d store0.s_store_sk AND customer0.c_current_addr_sk \u003d customer_address0.ca_address_sk AND (customer0.c_birth_country \u003c\u003e UPPER(customer_address0.ca_country) AND (store0.s_zip \u003d customer_address0.ca_zip AND store0.s_market_id \u003d 8)))\nGROUP BY customer0.c_last_name, customer0.c_first_name, store0.s_store_name, customer_address0.ca_state, store0.s_state, item0.i_color, item0.i_current_price, item0.i_manager_id, item0.i_units, item0.i_size) AS t8)))\nORDER BY t3.C_LAST_NAME, t3.C_FIRST_NAME, t3.S_STORE_NAME",
    "originalTimesMs": [
      57,
      55
    ],
    "optimizedTimesMs": [
      70,
      73
    ],
    "originalAvgMs": 56,
    "optimizedAvgMs": 71,
    "speedup": 0.7887323943661971,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q25",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT item.i_item_id AS I_ITEM_ID, item.i_item_desc AS I_ITEM_DESC, store.s_store_id AS S_STORE_ID, store.s_store_name AS S_STORE_NAME, SUM(store_sales.ss_net_profit) AS STORE_SALES_PROFIT, SUM(store_returns.sr_net_loss) AS STORE_RETURNS_LOSS, SUM(catalog_sales.cs_net_profit) AS CATALOG_SALES_PROFIT\nFROM store_sales\nINNER JOIN store_returns ON store_sales.ss_customer_sk \u003d store_returns.sr_customer_sk AND store_sales.ss_item_sk \u003d store_returns.sr_item_sk AND store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number\nINNER JOIN catalog_sales ON store_returns.sr_customer_sk \u003d catalog_sales.cs_bill_customer_sk AND store_returns.sr_item_sk \u003d catalog_sales.cs_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 4 AND d_year \u003d 2001) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_moy \u003e\u003d 4 AND d_moy \u003c\u003d 10 AND d_year \u003d 2001) AS t0 ON store_returns.sr_returned_date_sk \u003d t0.d_date_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_moy \u003e\u003d 4 AND d_moy \u003c\u003d 10 AND d_year \u003d 2001) AS t1 ON catalog_sales.cs_sold_date_sk \u003d t1.d_date_sk\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nGROUP BY item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name\nORDER BY item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      12,
      13
    ],
    "optimizedTimesMs": [
      14,
      13
    ],
    "originalAvgMs": 12,
    "optimizedAvgMs": 13,
    "speedup": 0.9230769230769231,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q26",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT item.i_item_id AS I_ITEM_ID, AVG(catalog_sales.cs_quantity) AS AGG1, AVG(catalog_sales.cs_list_price) AS AGG2, AVG(catalog_sales.cs_coupon_amt) AS AGG3, AVG(catalog_sales.cs_sales_price) AS AGG4\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM customer_demographics\nWHERE cd_gender \u003d \u0027M\u0027 AND cd_marital_status \u003d \u0027S\u0027 AND cd_education_status \u003d \u0027College\u0027) AS t ON catalog_sales.cs_bill_cdemo_sk \u003d t.cd_demo_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000) AS t0 ON catalog_sales.cs_sold_date_sk \u003d t0.d_date_sk\nINNER JOIN item ON catalog_sales.cs_item_sk \u003d item.i_item_sk\nINNER JOIN (SELECT *\nFROM promotion\nWHERE p_channel_email \u003d \u0027N\u0027 OR p_channel_event \u003d \u0027N\u0027) AS t1 ON catalog_sales.cs_promo_sk \u003d t1.p_promo_sk\nGROUP BY item.i_item_id\nORDER BY item.i_item_id\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      29,
      27
    ],
    "optimizedTimesMs": [
      27,
      29
    ],
    "originalAvgMs": 28,
    "optimizedAvgMs": 28,
    "speedup": 1.0,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 1439513,
    "optimizedPlanMaxRows": 1439513
  },
  {
    "query": "q27",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT I_ITEM_ID, S_STATE, G_STATE, AGG1, AGG2, AGG3, AGG4\nFROM (SELECT *\nFROM (SELECT item.i_item_id AS I_ITEM_ID, t1.s_state AS S_STATE, 0 AS G_STATE, AVG(store_sales.ss_quantity) AS AGG1, AVG(store_sales.ss_list_price) AS AGG2, AVG(store_sales.ss_coupon_amt) AS AGG3, AVG(store_sales.ss_sales_price) AS AGG4\nFROM store_sales\nINNER JOIN (SELECT *\nFROM customer_demographics\nWHERE cd_gender \u003d \u0027M\u0027 AND cd_marital_status \u003d \u0027S\u0027 AND cd_education_status \u003d \u0027College\u0027) AS t ON store_sales.ss_cdemo_sk \u003d t.cd_demo_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2002) AS t0 ON store_sales.ss_sold_date_sk \u003d t0.d_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_state \u003d \u0027TN\u0027) AS t1 ON store_sales.ss_store_sk \u003d t1.s_store_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nGROUP BY item.i_item_id, t1.s_state\nUNION ALL\nSELECT item0.i_item_id AS I_ITEM_ID, NULL AS S_STATE, 1 AS G_STATE, AVG(store_sales0.ss_quantity) AS AGG1, AVG(store_sales0.ss_list_price) AS AGG2, AVG(store_sales0.ss_coupon_amt) AS AGG3, AVG(store_sales0.ss_sales_price) AS AGG4\nFROM store_sales AS store_sales0\nINNER JOIN (SELECT *\nFROM customer_demographics\nWHERE cd_gender \u003d \u0027M\u0027 AND cd_marital_status \u003d \u0027S\u0027 AND cd_education_status \u003d \u0027College\u0027) AS t5 ON store_sales0.ss_cdemo_sk \u003d t5.cd_demo_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2002) AS t6 ON store_sales0.ss_sold_date_sk \u003d t6.d_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_state \u003d \u0027TN\u0027) AS t7 ON store_sales0.ss_store_sk \u003d t7.s_store_sk\nINNER JOIN item AS item0 ON store_sales0.ss_item_sk \u003d item0.i_item_sk\nGROUP BY item0.i_item_id)\nUNION ALL\nSELECT NULL AS I_ITEM_ID, NULL AS S_STATE, 1 AS G_STATE, AVG(store_sales1.ss_quantity) AS AGG1, AVG(store_sales1.ss_list_price) AS AGG2, AVG(store_sales1.ss_coupon_amt) AS AGG3, AVG(store_sales1.ss_sales_price) AS AGG4\nFROM store_sales AS store_sales1\nINNER JOIN (SELECT *\nFROM customer_demographics\nWHERE cd_gender \u003d \u0027M\u0027 AND cd_marital_status \u003d \u0027S\u0027 AND cd_education_status \u003d \u0027College\u0027) AS t12 ON store_sales1.ss_cdemo_sk \u003d t12.cd_demo_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2002) AS t13 ON store_sales1.ss_sold_date_sk \u003d t13.d_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_state \u003d \u0027TN\u0027) AS t14 ON store_sales1.ss_store_sk \u003d t14.s_store_sk\nINNER JOIN item AS item1 ON store_sales1.ss_item_sk \u003d item1.i_item_sk)\nORDER BY I_ITEM_ID NULLS FIRST, S_STATE NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      42,
      41
    ],
    "optimizedTimesMs": [
      46,
      41
    ],
    "originalAvgMs": 41,
    "optimizedAvgMs": 43,
    "speedup": 0.9534883720930233,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q28",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "AGGREGATE_REDUCE_FUNCTIONS",
      "PROJECT_MERGE",
      "PROJECT_REMOVE"
    ],
    "optimizedSql": "SELECT *\nFROM (SELECT CASE WHEN COUNT(ss_list_price) \u003d 0 THEN NULL ELSE COALESCE(SUM(ss_list_price), 0) END / COUNT(ss_list_price) AS B1_LP, COUNT(ss_list_price) AS B1_CNT, COUNT(DISTINCT ss_list_price) AS B1_CNTD\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 0 AND ss_quantity \u003c\u003d 5 AND (ss_list_price \u003e\u003d 8 AND ss_list_price \u003c\u003d 8 + 10 OR ss_coupon_amt \u003e\u003d 459 AND ss_coupon_amt \u003c\u003d 459 + 1000 OR ss_wholesale_cost \u003e\u003d 57 AND ss_wholesale_cost \u003c\u003d 57 + 20)) AS t2,\n(SELECT CASE WHEN COUNT(ss_list_price) \u003d 0 THEN NULL ELSE COALESCE(SUM(ss_list_price), 0) END / COUNT(ss_list_price) AS B2_LP, COUNT(ss_list_price) AS B2_CNT, COUNT(DISTINCT ss_list_price) AS B2_CNTD\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 6 AND ss_quantity \u003c\u003d 10 AND (ss_list_price \u003e\u003d 90 AND ss_list_price \u003c\u003d 90 + 10 OR ss_coupon_amt \u003e\u003d 2323 AND ss_coupon_amt \u003c\u003d 2323 + 1000 OR ss_wholesale_cost \u003e\u003d 31 AND ss_wholesale_cost \u003c\u003d 31 + 20)) AS t6,\n(SELECT CASE WHEN COUNT(ss_list_price) \u003d 0 THEN NULL ELSE COALESCE(SUM(ss_list_price), 0) END / COUNT(ss_list_price) AS B3_LP, COUNT(ss_list_price) AS B3_CNT, COUNT(DISTINCT ss_list_price) AS B3_CNTD\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 11 AND ss_quantity \u003c\u003d 15 AND (ss_list_price \u003e\u003d 142 AND ss_list_price \u003c\u003d 142 + 10 OR ss_coupon_amt \u003e\u003d 12214 AND ss_coupon_amt \u003c\u003d 12214 + 1000 OR ss_wholesale_cost \u003e\u003d 79 AND ss_wholesale_cost \u003c\u003d 79 + 20)) AS t10,\n(SELECT CASE WHEN COUNT(ss_list_price) \u003d 0 THEN NULL ELSE COALESCE(SUM(ss_list_price), 0) END / COUNT(ss_list_price) AS B4_LP, COUNT(ss_list_price) AS B4_CNT, COUNT(DISTINCT ss_list_price) AS B4_CNTD\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 16 AND ss_quantity \u003c\u003d 20 AND (ss_list_price \u003e\u003d 135 AND ss_list_price \u003c\u003d 135 + 10 OR ss_coupon_amt \u003e\u003d 6071 AND ss_coupon_amt \u003c\u003d 6071 + 1000 OR ss_wholesale_cost \u003e\u003d 38 AND ss_wholesale_cost \u003c\u003d 38 + 20)) AS t14,\n(SELECT CASE WHEN COUNT(ss_list_price) \u003d 0 THEN NULL ELSE COALESCE(SUM(ss_list_price), 0) END / COUNT(ss_list_price) AS B5_LP, COUNT(ss_list_price) AS B5_CNT, COUNT(DISTINCT ss_list_price) AS B5_CNTD\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 21 AND ss_quantity \u003c\u003d 25 AND (ss_list_price \u003e\u003d 122 AND ss_list_price \u003c\u003d 122 + 10 OR ss_coupon_amt \u003e\u003d 836 AND ss_coupon_amt \u003c\u003d 836 + 1000 OR ss_wholesale_cost \u003e\u003d 17 AND ss_wholesale_cost \u003c\u003d 17 + 20)) AS t18,\n(SELECT CASE WHEN COUNT(ss_list_price) \u003d 0 THEN NULL ELSE COALESCE(SUM(ss_list_price), 0) END / COUNT(ss_list_price) AS B6_LP, COUNT(ss_list_price) AS B6_CNT, COUNT(DISTINCT ss_list_price) AS B6_CNTD\nFROM store_sales\nWHERE ss_quantity \u003e\u003d 26 AND ss_quantity \u003c\u003d 30 AND (ss_list_price \u003e\u003d 154 AND ss_list_price \u003c\u003d 154 + 10 OR ss_coupon_amt \u003e\u003d 7326 AND ss_coupon_amt \u003c\u003d 7326 + 1000 OR ss_wholesale_cost \u003e\u003d 7 AND ss_wholesale_cost \u003c\u003d 7 + 20)) AS t22\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      41,
      39
    ],
    "optimizedTimesMs": [
      36,
      37
    ],
    "originalAvgMs": 40,
    "optimizedAvgMs": 36,
    "speedup": 1.1111111111111112,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 575621,
    "optimizedPlanMaxRows": 575621
  },
  {
    "query": "q29",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT item.i_item_id AS I_ITEM_ID, item.i_item_desc AS I_ITEM_DESC, store.s_store_id AS S_STORE_ID, store.s_store_name AS S_STORE_NAME, SUM(store_sales.ss_quantity) AS STORE_SALES_QUANTITY, SUM(store_returns.sr_return_quantity) AS STORE_RETURNS_QUANTITY, SUM(catalog_sales.cs_quantity) AS CATALOG_SALES_QUANTITY\nFROM store_sales\nINNER JOIN store_returns ON store_sales.ss_customer_sk \u003d store_returns.sr_customer_sk AND store_sales.ss_item_sk \u003d store_returns.sr_item_sk AND store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number\nINNER JOIN catalog_sales ON store_returns.sr_customer_sk \u003d catalog_sales.cs_bill_customer_sk AND store_returns.sr_item_sk \u003d catalog_sales.cs_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 9 AND d_year \u003d 1999) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_moy \u003e\u003d 9 AND d_moy \u003c\u003d 9 + 3 AND d_year \u003d 1999) AS t0 ON store_returns.sr_returned_date_sk \u003d t0.d_date_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1999 OR d_year \u003d CAST(1999 + 1 AS BIGINT) OR d_year \u003d CAST(1999 + 2 AS BIGINT)) AS t1 ON catalog_sales.cs_sold_date_sk \u003d t1.d_date_sk\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nGROUP BY item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name\nORDER BY item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      19,
      17
    ],
    "optimizedTimesMs": [
      18,
      18
    ],
    "originalAvgMs": 18,
    "optimizedAvgMs": 18,
    "speedup": 1.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q30",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"$\"",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_SUB_QUERY_TO_CORRELATE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer.c_customer_id AS C_CUSTOMER_ID, customer.c_salutation AS C_SALUTATION, customer.c_first_name AS C_FIRST_NAME, customer.c_last_name AS C_LAST_NAME, customer.c_preferred_cust_flag AS C_PREFERRED_CUST_FLAG, customer.c_birth_day AS C_BIRTH_DAY, customer.c_birth_month AS C_BIRTH_MONTH, customer.c_birth_year AS C_BIRTH_YEAR, customer.c_birth_country AS C_BIRTH_COUNTRY, customer.c_login AS C_LOGIN, customer.c_email_address AS C_EMAIL_ADDRESS, customer.c_last_review_date_sk AS C_LAST_REVIEW_DATE_SK, t12.CTR_TOTAL_RETURN\nFROM (SELECT $cor0.wr_returning_customer_sk AS CTR_CUSTOMER_SK, $cor0.ca_state AS CTR_STATE, $cor0.CTR_TOTAL_RETURN\nFROM (SELECT web_returns.wr_returning_customer_sk, customer_address.ca_state, SUM(web_returns.wr_return_amt) AS CTR_TOTAL_RETURN\nFROM web_returns\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2002) AS t ON web_returns.wr_returned_date_sk \u003d t.d_date_sk\nINNER JOIN customer_address ON web_returns.wr_returning_addr_sk \u003d customer_address.ca_address_sk\nGROUP BY web_returns.wr_returning_customer_sk, customer_address.ca_state) AS $cor0,\nLATERAL (SELECT AVG(CTR_TOTAL_RETURN) * 1.2 AS EXPR$0\nFROM (SELECT web_returns0.wr_returning_customer_sk AS CTR_CUSTOMER_SK, customer_address0.ca_state AS CTR_STATE, SUM(web_returns0.wr_return_amt) AS CTR_TOTAL_RETURN\nFROM web_returns AS web_returns0,\ndate_dim AS date_dim0,\ncustomer_address AS customer_address0\nWHERE web_returns0.wr_returned_date_sk \u003d date_dim0.d_date_sk AND date_dim0.d_year \u003d 2002 AND web_returns0.wr_returning_addr_sk \u003d customer_address0.ca_address_sk\nGROUP BY web_returns0.wr_returning_customer_sk, customer_address0.ca_state) AS t5\nWHERE $cor0.ca_state \u003d t5.CTR_STATE) AS t9\nWHERE $cor0.CTR_TOTAL_RETURN \u003e $cor0.EXPR$0) AS t12\nCROSS JOIN (SELECT *\nFROM customer_address\nWHERE ca_state \u003d \u0027GA\u0027) AS t13\nINNER JOIN customer ON t13.ca_address_sk \u003d customer.c_current_addr_sk AND t12.CTR_CUSTOMER_SK \u003d customer.c_customer_sk\nORDER BY customer.c_customer_id NULLS FIRST, customer.c_salutation NULLS FIRST, customer.c_first_name NULLS FIRST, customer.c_last_name NULLS FIRST, customer.c_preferred_cust_flag NULLS FIRST, customer.c_birth_day NULLS FIRST, customer.c_birth_month NULLS FIRST, customer.c_birth_year NULLS FIRST, customer.c_birth_country NULLS FIRST, customer.c_login NULLS FIRST, customer.c_email_address NULLS FIRST, customer.c_last_review_date_sk NULLS FIRST, t12.CTR_TOTAL_RETURN NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q31",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t2.CA_COUNTY, t2.D_YEAR, CAST(t18.WEB_SALES AS DECIMAL(19, 4)) / t14.WEB_SALES AS WEB_Q1_Q2_INCREASE, CAST(t6.STORE_SALES AS DECIMAL(19, 4)) / t2.STORE_SALES AS STORE_Q1_Q2_INCREASE, CAST(t22.WEB_SALES AS DECIMAL(19, 4)) / t18.WEB_SALES AS WEB_Q2_Q3_INCREASE, CAST(t10.STORE_SALES AS DECIMAL(19, 4)) / t6.STORE_SALES AS STORE_Q2_Q3_INCREASE\nFROM (SELECT customer_address.ca_county AS CA_COUNTY, date_dim.d_qoy AS D_QOY, date_dim.d_year AS D_YEAR, SUM(store_sales.ss_ext_sales_price) AS STORE_SALES\nFROM store_sales\nINNER JOIN date_dim ON store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk\nINNER JOIN customer_address ON store_sales.ss_addr_sk \u003d customer_address.ca_address_sk\nGROUP BY customer_address.ca_county, date_dim.d_qoy, date_dim.d_year\nHAVING date_dim.d_qoy \u003d 1 AND date_dim.d_year \u003d 2000) AS t2\nINNER JOIN (SELECT customer_address0.ca_county AS CA_COUNTY, date_dim0.d_qoy AS D_QOY, date_dim0.d_year AS D_YEAR, SUM(store_sales0.ss_ext_sales_price) AS STORE_SALES\nFROM store_sales AS store_sales0\nINNER JOIN date_dim AS date_dim0 ON store_sales0.ss_sold_date_sk \u003d date_dim0.d_date_sk\nINNER JOIN customer_address AS customer_address0 ON store_sales0.ss_addr_sk \u003d customer_address0.ca_address_sk\nGROUP BY customer_address0.ca_county, date_dim0.d_qoy, date_dim0.d_year\nHAVING date_dim0.d_qoy \u003d 2 AND date_dim0.d_year \u003d 2000) AS t6 ON t2.CA_COUNTY \u003d t6.CA_COUNTY\nINNER JOIN (SELECT customer_address1.ca_county AS CA_COUNTY, date_dim1.d_qoy AS D_QOY, date_dim1.d_year AS D_YEAR, SUM(store_sales1.ss_ext_sales_price) AS STORE_SALES\nFROM store_sales AS store_sales1\nINNER JOIN date_dim AS date_dim1 ON store_sales1.ss_sold_date_sk \u003d date_dim1.d_date_sk\nINNER JOIN customer_address AS customer_address1 ON store_sales1.ss_addr_sk \u003d customer_address1.ca_address_sk\nGROUP BY customer_address1.ca_county, date_dim1.d_qoy, date_dim1.d_year\nHAVING date_dim1.d_qoy \u003d 3 AND date_dim1.d_year \u003d 2000) AS t10 ON t6.CA_COUNTY \u003d t10.CA_COUNTY\nINNER JOIN (SELECT customer_address2.ca_county AS CA_COUNTY, date_dim2.d_qoy AS D_QOY, date_dim2.d_year AS D_YEAR, SUM(web_sales.ws_ext_sales_price) AS WEB_SALES\nFROM web_sales\nINNER JOIN date_dim AS date_dim2 ON web_sales.ws_sold_date_sk \u003d date_dim2.d_date_sk\nINNER JOIN customer_address AS customer_address2 ON web_sales.ws_bill_addr_sk \u003d customer_address2.ca_address_sk\nGROUP BY customer_address2.ca_county, date_dim2.d_qoy, date_dim2.d_year\nHAVING date_dim2.d_qoy \u003d 1 AND date_dim2.d_year \u003d 2000) AS t14 ON t2.CA_COUNTY \u003d t14.CA_COUNTY\nINNER JOIN (SELECT customer_address3.ca_county AS CA_COUNTY, date_dim3.d_qoy AS D_QOY, date_dim3.d_year AS D_YEAR, SUM(web_sales0.ws_ext_sales_price) AS WEB_SALES\nFROM web_sales AS web_sales0\nINNER JOIN date_dim AS date_dim3 ON web_sales0.ws_sold_date_sk \u003d date_dim3.d_date_sk\nINNER JOIN customer_address AS customer_address3 ON web_sales0.ws_bill_addr_sk \u003d customer_address3.ca_address_sk\nGROUP BY customer_address3.ca_county, date_dim3.d_qoy, date_dim3.d_year\nHAVING date_dim3.d_qoy \u003d 2 AND date_dim3.d_year \u003d 2000) AS t18 ON t14.CA_COUNTY \u003d t18.CA_COUNTY AND CASE WHEN t14.WEB_SALES \u003e 0 THEN CAST(t18.WEB_SALES AS DECIMAL(19, 4)) / t14.WEB_SALES ELSE NULL END \u003e CASE WHEN t2.STORE_SALES \u003e 0 THEN CAST(t6.STORE_SALES AS DECIMAL(19, 4)) / t2.STORE_SALES ELSE NULL END\nINNER JOIN (SELECT customer_address4.ca_county AS CA_COUNTY, date_dim4.d_qoy AS D_QOY, date_dim4.d_year AS D_YEAR, SUM(web_sales1.ws_ext_sales_price) AS WEB_SALES\nFROM web_sales AS web_sales1\nINNER JOIN date_dim AS date_dim4 ON web_sales1.ws_sold_date_sk \u003d date_dim4.d_date_sk\nINNER JOIN customer_address AS customer_address4 ON web_sales1.ws_bill_addr_sk \u003d customer_address4.ca_address_sk\nGROUP BY customer_address4.ca_county, date_dim4.d_qoy, date_dim4.d_year\nHAVING date_dim4.d_qoy \u003d 3 AND date_dim4.d_year \u003d 2000) AS t22 ON t14.CA_COUNTY \u003d t22.CA_COUNTY AND CASE WHEN t18.WEB_SALES \u003e 0 THEN t22.WEB_SALES * 1.0000 / t18.WEB_SALES ELSE NULL END \u003e CASE WHEN t6.STORE_SALES \u003e 0 THEN t10.STORE_SALES * 1.0000 / t6.STORE_SALES ELSE NULL END\nORDER BY t2.CA_COUNTY",
    "originalTimesMs": [
      55,
      57
    ],
    "optimizedTimesMs": [
      79,
      84
    ],
    "originalAvgMs": 56,
    "optimizedAvgMs": 81,
    "speedup": 0.691358024691358,
    "originalRowCount": 301,
    "optimizedRowCount": 301,
    "validationPassed": true,
    "originalPlanMaxRows": 1965317291,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q32",
    "status": "error",
    "error": "variable $cor0 is not found",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "SUBQUERY_REMOVE",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q33",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT I_MANUFACT_ID, SUM(TOTAL_SALES) AS TOTAL_SALES\nFROM (SELECT *\nFROM (SELECT t3.i_manufact_id AS I_MANUFACT_ID, SUM(store_sales.ss_ext_sales_price) AS TOTAL_SALES\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 5) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t0 ON store_sales.ss_addr_sk \u003d t0.ca_address_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_manufact_id IN (SELECT i_manufact_id AS I_MANUFACT_ID\nFROM item\nWHERE i_category \u003d \u0027Electronics\u0027)) AS t3 ON store_sales.ss_item_sk \u003d t3.i_item_sk\nGROUP BY t3.i_manufact_id\nUNION ALL\nSELECT t11.i_manufact_id AS I_MANUFACT_ID, SUM(catalog_sales.cs_ext_sales_price) AS TOTAL_SALES\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 5) AS t7 ON catalog_sales.cs_sold_date_sk \u003d t7.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t8 ON catalog_sales.cs_bill_addr_sk \u003d t8.ca_address_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_manufact_id IN (SELECT i_manufact_id AS I_MANUFACT_ID\nFROM item\nWHERE i_category \u003d \u0027Electronics\u0027)) AS t11 ON catalog_sales.cs_item_sk \u003d t11.i_item_sk\nGROUP BY t11.i_manufact_id)\nUNION ALL\nSELECT t20.i_manufact_id AS I_MANUFACT_ID, SUM(web_sales.ws_ext_sales_price) AS TOTAL_SALES\nFROM web_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 5) AS t16 ON web_sales.ws_sold_date_sk \u003d t16.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t17 ON web_sales.ws_bill_addr_sk \u003d t17.ca_address_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_manufact_id IN (SELECT i_manufact_id AS I_MANUFACT_ID\nFROM item\nWHERE i_category \u003d \u0027Electronics\u0027)) AS t20 ON web_sales.ws_item_sk \u003d t20.i_item_sk\nGROUP BY t20.i_manufact_id) AS t24\nGROUP BY I_MANUFACT_ID\nORDER BY 2\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      22,
      34
    ],
    "optimizedTimesMs": [
      22,
      25
    ],
    "originalAvgMs": 28,
    "optimizedAvgMs": 23,
    "speedup": 1.2173913043478262,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q34",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "FILTER_AGGREGATE_TRANSPOSE",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, customer.c_salutation AS C_SALUTATION, customer.c_preferred_cust_flag AS C_PREFERRED_CUST_FLAG, t5.SS_TICKET_NUMBER, t5.CNT\nFROM (SELECT *\nFROM (SELECT store_sales.ss_ticket_number AS SS_TICKET_NUMBER, store_sales.ss_customer_sk AS SS_CUSTOMER_SK, COUNT(*) AS CNT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE (d_dom \u003e\u003d 1 AND d_dom \u003c\u003d 3 OR d_dom \u003e\u003d 25 AND d_dom \u003c\u003d 28) AND (d_year \u003d 1999 OR d_year \u003d CAST(1999 + 1 AS BIGINT) OR d_year \u003d CAST(1999 + 2 AS BIGINT))) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_county \u003d \u0027Williamson County\u0027) AS t0 ON store_sales.ss_store_sk \u003d t0.s_store_sk\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_buy_potential IN (\u0027\u003e10000\u0027, \u0027Unknown\u0027) AND hd_vehicle_count \u003e 0 AND CASE WHEN hd_vehicle_count \u003e 0 THEN CAST(hd_dep_count AS DECIMAL(19, 3)) / hd_vehicle_count ELSE NULL END \u003e 1.2) AS t1 ON store_sales.ss_hdemo_sk \u003d t1.hd_demo_sk\nGROUP BY store_sales.ss_ticket_number, store_sales.ss_customer_sk) AS t4\nWHERE t4.CNT \u003e\u003d 15 AND t4.CNT \u003c\u003d 20) AS t5\nINNER JOIN customer ON t5.SS_CUSTOMER_SK \u003d customer.c_customer_sk\nORDER BY customer.c_last_name NULLS FIRST, customer.c_first_name NULLS FIRST, customer.c_salutation NULLS FIRST, customer.c_preferred_cust_flag DESC, t5.SS_TICKET_NUMBER NULLS FIRST",
    "originalTimesMs": [
      17,
      17
    ],
    "optimizedTimesMs": [
      17,
      15
    ],
    "originalAvgMs": 17,
    "optimizedAvgMs": 16,
    "speedup": 1.0625,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q35",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"$\"",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_SUB_QUERY_TO_CORRELATE",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer_address.ca_state AS CA_STATE, customer_demographics.cd_gender AS CD_GENDER, customer_demographics.cd_marital_status AS CD_MARITAL_STATUS, customer_demographics.cd_dep_count AS CD_DEP_COUNT, COUNT(*) AS CNT1, MIN(customer_demographics.cd_dep_count) AS MIN1, MAX(customer_demographics.cd_dep_count) AS MAX1, AVG(customer_demographics.cd_dep_count) AS AVG1, customer_demographics.cd_dep_employed_count AS CD_DEP_EMPLOYED_COUNT, COUNT(*) AS CNT2, MIN(customer_demographics.cd_dep_employed_count) AS MIN2, MAX(customer_demographics.cd_dep_employed_count) AS MAX2, AVG(customer_demographics.cd_dep_employed_count) AS AVG2, customer_demographics.cd_dep_college_count AS CD_DEP_COLLEGE_COUNT, COUNT(*) AS CNT3, MIN(customer_demographics.cd_dep_college_count), MAX(customer_demographics.cd_dep_college_count), AVG(customer_demographics.cd_dep_college_count)\nFROM (SELECT $cor0.c_customer_sk, $cor0.c_customer_id, $cor0.c_current_cdemo_sk, $cor0.c_current_hdemo_sk, $cor0.c_current_addr_sk, $cor0.c_first_shipto_date_sk, $cor0.c_first_sales_date_sk, $cor0.c_salutation, $cor0.c_first_name, $cor0.c_last_name, $cor0.c_preferred_cust_flag, $cor0.c_birth_day, $cor0.c_birth_month, $cor0.c_birth_year, $cor0.c_birth_country, $cor0.c_login, $cor0.c_email_address, $cor0.c_last_review_date_sk\nFROM ((customer AS $cor0, LATERAL (SELECT TRUE AS i\nFROM store_sales,\ndate_dim\nWHERE $cor0.c_customer_sk \u003d store_sales.ss_customer_sk AND store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk AND date_dim.d_year \u003d 2002 AND date_dim.d_qoy \u003c 4\nGROUP BY TRUE) AS t1) AS $cor0, LATERAL (SELECT TRUE AS i\nFROM web_sales,\ndate_dim AS date_dim0\nWHERE $cor0.c_customer_sk \u003d web_sales.ws_bill_customer_sk AND web_sales.ws_sold_date_sk \u003d date_dim0.d_date_sk AND date_dim0.d_year \u003d 2002 AND date_dim0.d_qoy \u003c 4\nGROUP BY TRUE) AS t4) AS $cor0,\nLATERAL (SELECT TRUE AS i\nFROM catalog_sales,\ndate_dim AS date_dim1\nWHERE $cor0.c_customer_sk \u003d catalog_sales.cs_ship_customer_sk AND catalog_sales.cs_sold_date_sk \u003d date_dim1.d_date_sk AND date_dim1.d_year \u003d 2002 AND date_dim1.d_qoy \u003c 4\nGROUP BY TRUE) AS t7\nWHERE $cor0.i0 IS NOT NULL OR $cor0.i1 IS NOT NULL) AS t9\nINNER JOIN customer_address ON t9.c_current_addr_sk \u003d customer_address.ca_address_sk\nINNER JOIN customer_demographics ON t9.c_current_cdemo_sk \u003d customer_demographics.cd_demo_sk\nGROUP BY customer_address.ca_state, customer_demographics.cd_gender, customer_demographics.cd_marital_status, customer_demographics.cd_dep_count, customer_demographics.cd_dep_employed_count, customer_demographics.cd_dep_college_count\nORDER BY customer_address.ca_state NULLS FIRST, customer_demographics.cd_gender NULLS FIRST, customer_demographics.cd_marital_status NULLS FIRST, customer_demographics.cd_dep_count NULLS FIRST, customer_demographics.cd_dep_employed_count NULLS FIRST, customer_demographics.cd_dep_college_count NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q36",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "optimizedSql": "SELECT GROSS_MARGIN, I_CATEGORY, I_CLASS, LOCHIERARCHY, RANK() OVER (PARTITION BY LOCHIERARCHY, CASE WHEN T_CLASS \u003d 0 THEN I_CATEGORY ELSE NULL END ORDER BY GROSS_MARGIN) AS RANK_WITHIN_PARENT, CASE WHEN LOCHIERARCHY \u003d 0 THEN I_CATEGORY ELSE NULL END\nFROM (SELECT *\nFROM (SELECT CAST(SUM(store_sales.ss_net_profit) AS DECIMAL(19, 4)) / SUM(store_sales.ss_ext_sales_price) AS GROSS_MARGIN, item.i_category AS I_CATEGORY, item.i_class AS I_CLASS, 0 AS T_CATEGORY, 0 AS T_CLASS, 0 AS LOCHIERARCHY\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_state \u003d \u0027TN\u0027) AS t0 ON store_sales.ss_store_sk \u003d t0.s_store_sk\nGROUP BY item.i_category, item.i_class\nUNION\nSELECT CAST(SUM(t8.SS_NET_PROFIT) AS DECIMAL(19, 4)) / SUM(t8.SS_EXT_SALES_PRICE) AS GROSS_MARGIN, t8.I_CATEGORY, NULL AS I_CLASS, 0 AS T_CATEGORY, 1 AS T_CLASS, 1 AS LOCHIERARCHY\nFROM (SELECT item0.i_category AS I_CATEGORY, SUM(store_sales0.ss_net_profit) AS SS_NET_PROFIT, SUM(store_sales0.ss_ext_sales_price) AS SS_EXT_SALES_PRICE\nFROM store_sales AS store_sales0\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t4 ON store_sales0.ss_sold_date_sk \u003d t4.d_date_sk\nINNER JOIN item AS item0 ON store_sales0.ss_item_sk \u003d item0.i_item_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_state \u003d \u0027TN\u0027) AS t5 ON store_sales0.ss_store_sk \u003d t5.s_store_sk\nGROUP BY item0.i_category, item0.i_class) AS t8\nGROUP BY t8.I_CATEGORY)\nUNION\nSELECT CAST(SUM(t16.SS_NET_PROFIT) AS DECIMAL(19, 4)) / SUM(t16.SS_EXT_SALES_PRICE) AS GROSS_MARGIN, NULL AS I_CATEGORY, NULL AS I_CLASS, 1 AS T_CATEGORY, 1 AS T_CLASS, 2 AS LOCHIERARCHY\nFROM (SELECT SUM(store_sales1.ss_net_profit) AS SS_NET_PROFIT, SUM(store_sales1.ss_ext_sales_price) AS SS_EXT_SALES_PRICE\nFROM store_sales AS store_sales1\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t12 ON store_sales1.ss_sold_date_sk \u003d t12.d_date_sk\nINNER JOIN item AS item1 ON store_sales1.ss_item_sk \u003d item1.i_item_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_state \u003d \u0027TN\u0027) AS t13 ON store_sales1.ss_store_sk \u003d t13.s_store_sk\nGROUP BY item1.i_category, item1.i_class) AS t16) AS t19\nORDER BY LOCHIERARCHY DESC, 6 NULLS FIRST, 5 NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      27,
      27
    ],
    "optimizedTimesMs": [
      39,
      38
    ],
    "originalAvgMs": 27,
    "optimizedAvgMs": 38,
    "speedup": 0.7105263157894737,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": false,
    "originalPlanMaxRows": 3099951,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q37",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t.i_item_id AS I_ITEM_ID, t.i_item_desc AS I_ITEM_DESC, t.i_current_price AS I_CURRENT_PRICE\nFROM (SELECT *\nFROM item\nWHERE i_current_price \u003e\u003d 68 AND i_current_price \u003c\u003d 68 + 30 AND i_manufact_id IN (677, 694, 808, 940)) AS t\nINNER JOIN (SELECT *\nFROM inventory\nWHERE inv_quantity_on_hand \u003e\u003d 100 AND inv_quantity_on_hand \u003c\u003d 500) AS t0 ON t.i_item_sk \u003d t0.inv_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-02-01\u0027 AND d_date \u003c\u003d DATE \u00272000-04-01\u0027) AS t1 ON t0.inv_date_sk \u003d t1.d_date_sk\nINNER JOIN catalog_sales ON t.i_item_sk \u003d catalog_sales.cs_item_sk\nGROUP BY t.i_item_id, t.i_item_desc, t.i_current_price\nORDER BY t.i_item_id\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      22,
      21
    ],
    "optimizedTimesMs": [
      17,
      19
    ],
    "originalAvgMs": 21,
    "optimizedAvgMs": 18,
    "speedup": 1.1666666666666667,
    "originalRowCount": 2,
    "optimizedRowCount": 2,
    "validationPassed": true,
    "originalPlanMaxRows": 1439513,
    "optimizedPlanMaxRows": 1439513
  },
  {
    "query": "q38",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"$\"",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "INTERSECT_TO_DISTINCT"
    ],
    "optimizedSql": "SELECT COUNT(*)\nFROM (SELECT C_LAST_NAME, C_FIRST_NAME, D_DATE\nFROM (SELECT C_LAST_NAME, C_FIRST_NAME, D_DATE, COUNT(*) AS $f3\nFROM (SELECT C_LAST_NAME, C_FIRST_NAME, D_DATE\nFROM (SELECT t1.C_LAST_NAME, t1.C_FIRST_NAME, t1.D_DATE, COUNT(*) AS $f3\nFROM (SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, t.d_date AS D_DATE\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN customer ON store_sales.ss_customer_sk \u003d customer.c_customer_sk\nGROUP BY customer.c_last_name, customer.c_first_name, t.d_date) AS t1\nGROUP BY t1.C_LAST_NAME, t1.C_FIRST_NAME, t1.D_DATE\nUNION ALL\nSELECT t5.C_LAST_NAME, t5.C_FIRST_NAME, t5.D_DATE, COUNT(*) AS $f3\nFROM (SELECT customer0.c_last_name AS C_LAST_NAME, customer0.c_first_name AS C_FIRST_NAME, t3.d_date AS D_DATE\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t3 ON catalog_sales.cs_sold_date_sk \u003d t3.d_date_sk\nINNER JOIN customer AS customer0 ON catalog_sales.cs_bill_customer_sk \u003d customer0.c_customer_sk\nGROUP BY customer0.c_last_name, customer0.c_first_name, t3.d_date) AS t5\nGROUP BY t5.C_LAST_NAME, t5.C_FIRST_NAME, t5.D_DATE) AS t7\nGROUP BY C_LAST_NAME, C_FIRST_NAME, D_DATE\nHAVING COUNT(*) \u003d 2) AS t10\nGROUP BY C_LAST_NAME, C_FIRST_NAME, D_DATE\nUNION ALL\nSELECT t14.C_LAST_NAME, t14.C_FIRST_NAME, t14.D_DATE, COUNT(*) AS $f3\nFROM (SELECT customer1.c_last_name AS C_LAST_NAME, customer1.c_first_name AS C_FIRST_NAME, t12.d_date AS D_DATE\nFROM web_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t12 ON web_sales.ws_sold_date_sk \u003d t12.d_date_sk\nINNER JOIN customer AS customer1 ON web_sales.ws_bill_customer_sk \u003d customer1.c_customer_sk\nGROUP BY customer1.c_last_name, customer1.c_first_name, t12.d_date) AS t14\nGROUP BY t14.C_LAST_NAME, t14.C_FIRST_NAME, t14.D_DATE) AS t16\nGROUP BY C_LAST_NAME, C_FIRST_NAME, D_DATE\nHAVING COUNT(*) \u003d 2) AS t19\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q39",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"$\"",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "AGGREGATE_PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t4.W_WAREHOUSE_SK AS WSK1, t4.I_ITEM_SK AS ISK1, t4.D_MOY AS DMOY1, t4.MEAN AS MEAN1, t4.COV AS COV1, t10.W_WAREHOUSE_SK, t10.I_ITEM_SK, t10.D_MOY, t10.MEAN, t10.COV\nFROM (SELECT w_warehouse_name AS W_WAREHOUSE_NAME, w_warehouse_sk AS W_WAREHOUSE_SK, i_item_sk AS I_ITEM_SK, d_moy AS D_MOY, CAST($f4 AS DECIMAL(14, 3)) AS STDEV, MEAN, CASE WHEN MEAN \u003d 0 THEN NULL ELSE CAST($f4 AS DECIMAL(14, 3)) / MEAN END AS COV\nFROM (SELECT *\nFROM (SELECT warehouse.w_warehouse_name, warehouse.w_warehouse_sk, item.i_item_sk, t.d_moy, STDDEV_SAMP(inventory.inv_quantity_on_hand) AS $f4, AVG(inventory.inv_quantity_on_hand) AS MEAN\nFROM inventory\nINNER JOIN item ON inventory.inv_item_sk \u003d item.i_item_sk\nINNER JOIN warehouse ON inventory.inv_warehouse_sk \u003d warehouse.w_warehouse_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t ON inventory.inv_date_sk \u003d t.d_date_sk\nGROUP BY item.i_item_sk, warehouse.w_warehouse_sk, warehouse.w_warehouse_name, t.d_moy) AS t1\nWHERE CASE WHEN t1.MEAN \u003d 0 THEN 0 ELSE CAST(t1.$f4 AS DECIMAL(14, 3)) / t1.MEAN END \u003e 1) AS t2\nWHERE d_moy \u003d 1) AS t4\nINNER JOIN (SELECT w_warehouse_name AS W_WAREHOUSE_NAME, w_warehouse_sk AS W_WAREHOUSE_SK, i_item_sk AS I_ITEM_SK, d_moy AS D_MOY, CAST($f4 AS DECIMAL(14, 3)) AS STDEV, MEAN, CASE WHEN MEAN \u003d 0 THEN NULL ELSE CAST($f4 AS DECIMAL(14, 3)) / MEAN END AS COV\nFROM (SELECT *\nFROM (SELECT warehouse0.w_warehouse_name, warehouse0.w_warehouse_sk, item0.i_item_sk, t5.d_moy, STDDEV_SAMP(inventory0.inv_quantity_on_hand) AS $f4, AVG(inventory0.inv_quantity_on_hand) AS MEAN\nFROM inventory AS inventory0\nINNER JOIN item AS item0 ON inventory0.inv_item_sk \u003d item0.i_item_sk\nINNER JOIN warehouse AS warehouse0 ON inventory0.inv_warehouse_sk \u003d warehouse0.w_warehouse_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t5 ON inventory0.inv_date_sk \u003d t5.d_date_sk\nGROUP BY item0.i_item_sk, warehouse0.w_warehouse_sk, warehouse0.w_warehouse_name, t5.d_moy) AS t7\nWHERE CASE WHEN t7.MEAN \u003d 0 THEN 0 ELSE CAST(t7.$f4 AS DECIMAL(14, 3)) / t7.MEAN END \u003e 1) AS t8\nWHERE d_moy \u003d CAST(1 + 1 AS BIGINT)) AS t10 ON t4.I_ITEM_SK \u003d t10.I_ITEM_SK AND t4.W_WAREHOUSE_SK \u003d t10.W_WAREHOUSE_SK\nORDER BY t4.W_WAREHOUSE_SK NULLS FIRST, t4.I_ITEM_SK NULLS FIRST, t4.D_MOY NULLS FIRST, t4.MEAN NULLS FIRST, t4.COV NULLS FIRST, t10.D_MOY NULLS FIRST, t10.MEAN NULLS FIRST, t10.COV NULLS FIRST",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q40",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "PROJECT_MERGE",
      "SORT_REMOVE_REDUNDANT",
      "AGGREGATE_CASE_TO_FILTER"
    ],
    "optimizedSql": "SELECT warehouse.w_state AS W_STATE, t.i_item_id AS I_ITEM_ID, SUM(CASE WHEN t0.d_date \u003c DATE \u00272000-03-11\u0027 THEN catalog_sales.cs_sales_price - CASE WHEN catalog_returns.cr_refunded_cash IS NOT NULL THEN CAST(catalog_returns.cr_refunded_cash AS DECIMAL(19, 0)) ELSE 0 END ELSE 0 END) AS SALES_BEFORE, SUM(CASE WHEN t0.d_date \u003e\u003d DATE \u00272000-03-11\u0027 THEN catalog_sales.cs_sales_price - CASE WHEN catalog_returns.cr_refunded_cash IS NOT NULL THEN CAST(catalog_returns.cr_refunded_cash AS DECIMAL(19, 0)) ELSE 0 END ELSE 0 END) AS SALES_AFTER\nFROM catalog_sales\nLEFT JOIN catalog_returns ON catalog_sales.cs_order_number \u003d catalog_returns.cr_order_number AND catalog_sales.cs_item_sk \u003d catalog_returns.cr_item_sk\nINNER JOIN warehouse ON catalog_sales.cs_warehouse_sk \u003d warehouse.w_warehouse_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_current_price \u003e\u003d 0.99 AND i_current_price \u003c\u003d 1.49) AS t ON catalog_sales.cs_item_sk \u003d t.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-02-10\u0027 AND d_date \u003c\u003d DATE \u00272000-04-10\u0027) AS t0 ON catalog_sales.cs_sold_date_sk \u003d t0.d_date_sk\nGROUP BY warehouse.w_state, t.i_item_id\nORDER BY warehouse.w_state, t.i_item_id\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      16,
      18
    ],
    "optimizedTimesMs": [
      16,
      16
    ],
    "originalAvgMs": 17,
    "optimizedAvgMs": 16,
    "speedup": 1.0625,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 1439513,
    "optimizedPlanMaxRows": 1439513
  },
  {
    "query": "q41",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"$\"",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "FILTER_SUB_QUERY_TO_CORRELATE",
      "SUBQUERY_REMOVE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT $cor0.i_product_name AS I_PRODUCT_NAME\nFROM item AS $cor0,\nLATERAL (SELECT COUNT(*) AS ITEM_CNT\nFROM item\nWHERE i_manufact \u003d $cor0.i_manufact AND (i_category \u003d \u0027Women\u0027 AND (i_color \u003d \u0027powder\u0027 OR i_color \u003d \u0027khaki\u0027) AND (i_units \u003d \u0027Ounce\u0027 OR i_units \u003d \u0027Oz\u0027) AND (i_size \u003d \u0027medium\u0027 OR i_size \u003d \u0027extra large\u0027) OR i_category \u003d \u0027Women\u0027 AND (i_color \u003d \u0027brown\u0027 OR i_color \u003d \u0027honeydew\u0027) AND (i_units \u003d \u0027Bunch\u0027 OR i_units \u003d \u0027Ton\u0027) AND (i_size \u003d \u0027N/A\u0027 OR i_size \u003d \u0027small\u0027) OR i_category \u003d \u0027Men\u0027 AND (i_color \u003d \u0027floral\u0027 OR i_color \u003d \u0027deep\u0027) AND (i_units \u003d \u0027N/A\u0027 OR i_units \u003d \u0027Dozen\u0027) AND (i_size \u003d \u0027petite\u0027 OR i_size \u003d \u0027petite\u0027) OR i_category \u003d \u0027Men\u0027 AND (i_color \u003d \u0027light\u0027 OR i_color \u003d \u0027cornflower\u0027) AND (i_units \u003d \u0027Box\u0027 OR i_units \u003d \u0027Pound\u0027) AND (i_size \u003d \u0027medium\u0027 OR i_size \u003d \u0027extra large\u0027)) OR i_manufact \u003d $cor0.i_manufact AND (i_category \u003d \u0027Women\u0027 AND (i_color \u003d \u0027midnight\u0027 OR i_color \u003d \u0027snow\u0027) AND (i_units \u003d \u0027Pallet\u0027 OR i_units \u003d \u0027Gross\u0027) AND (i_size \u003d \u0027medium\u0027 OR i_size \u003d \u0027extra large\u0027) OR i_category \u003d \u0027Women\u0027 AND (i_color \u003d \u0027cyan\u0027 OR i_color \u003d \u0027papaya\u0027) AND (i_units \u003d \u0027Cup\u0027 OR i_units \u003d \u0027Dram\u0027) AND (i_size \u003d \u0027N/A\u0027 OR i_size \u003d \u0027small\u0027) OR i_category \u003d \u0027Men\u0027 AND (i_color \u003d \u0027orange\u0027 OR i_color \u003d \u0027frosted\u0027) AND (i_units \u003d \u0027Each\u0027 OR i_units \u003d \u0027Tbl\u0027) AND (i_size \u003d \u0027petite\u0027 OR i_size \u003d \u0027petite\u0027) OR i_category \u003d \u0027Men\u0027 AND (i_color \u003d \u0027forest\u0027 OR i_color \u003d \u0027ghost\u0027) AND (i_units \u003d \u0027Lb\u0027 OR i_units \u003d \u0027Bundle\u0027) AND (i_size \u003d \u0027medium\u0027 OR i_size \u003d \u0027extra large\u0027))) AS t0\nWHERE $cor0.i_manufact_id \u003e\u003d 738 AND $cor0.i_manufact_id \u003c\u003d 738 + 40 AND $cor0.ITEM_CNT \u003e 0\nGROUP BY $cor0.i_product_name\nORDER BY $cor0.i_product_name\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q42",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t3.d_year AS D_YEAR, t3.i_category_id AS I_CATEGORY_ID, t3.i_category AS I_CATEGORY, t3.EXPR$3\nFROM (SELECT t.d_year, t0.i_category_id, t0.i_category, SUM(store_sales.ss_ext_sales_price) AS EXPR$3\nFROM (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 11 AND d_year \u003d 2000) AS t\nINNER JOIN store_sales ON t.d_date_sk \u003d store_sales.ss_sold_date_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_manager_id \u003d 1) AS t0 ON store_sales.ss_item_sk \u003d t0.i_item_sk\nGROUP BY t.d_year, t0.i_category_id, t0.i_category\nORDER BY 4 DESC, t.d_year, t0.i_category_id, t0.i_category\nFETCH NEXT 100 ROWS ONLY) AS t3",
    "originalTimesMs": [
      9,
      12
    ],
    "optimizedTimesMs": [
      9,
      7
    ],
    "originalAvgMs": 10,
    "optimizedAvgMs": 8,
    "speedup": 1.25,
    "originalRowCount": 10,
    "optimizedRowCount": 10,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q43",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "AGGREGATE_CASE_TO_FILTER",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t3.s_store_name AS S_STORE_NAME, t3.s_store_id AS S_STORE_ID, t3.SUN_SALES, t3.MON_SALES, t3.TUE_SALES, t3.WED_SALES, t3.THU_SALES, t3.FRI_SALES, t3.SAT_SALES\nFROM (SELECT t0.s_store_name, t0.s_store_id, SUM(store_sales.ss_sales_price) FILTER (WHERE t.d_day_name \u003d \u0027Sunday\u0027 IS TRUE) AS SUN_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE t.d_day_name \u003d \u0027Monday\u0027 IS TRUE) AS MON_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE t.d_day_name \u003d \u0027Tuesday\u0027 IS TRUE) AS TUE_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE t.d_day_name \u003d \u0027Wednesday\u0027 IS TRUE) AS WED_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE t.d_day_name \u003d \u0027Thursday\u0027 IS TRUE) AS THU_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE t.d_day_name \u003d \u0027Friday\u0027 IS TRUE) AS FRI_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE t.d_day_name \u003d \u0027Saturday\u0027 IS TRUE) AS SAT_SALES\nFROM (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000) AS t\nINNER JOIN store_sales ON t.d_date_sk \u003d store_sales.ss_sold_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_gmt_offset \u003d -5) AS t0 ON store_sales.ss_store_sk \u003d t0.s_store_sk\nGROUP BY t0.s_store_name, t0.s_store_id\nORDER BY t0.s_store_name, t0.s_store_id, 3, 4, 5, 6, 7, 8, 9\nFETCH NEXT 100 ROWS ONLY) AS t3",
    "originalTimesMs": [
      17,
      16
    ],
    "optimizedTimesMs": [
      20,
      20
    ],
    "originalAvgMs": 16,
    "optimizedAvgMs": 20,
    "speedup": 0.8,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q44",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "FILTER_AGGREGATE_TRANSPOSE",
      "PROJECT_MERGE",
      "SUBQUERY_REMOVE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "optimizedSql": "SELECT t9.RNK, item.i_product_name AS BEST_PERFORMING, item0.i_product_name AS WORST_PERFORMING\nFROM (SELECT *\nFROM (SELECT ss_item_sk AS ITEM_SK, RANK() OVER (ORDER BY RANK_COL) AS RNK\nFROM (SELECT ss_item_sk, AVG(ss_net_profit) AS RANK_COL\nFROM store_sales\nWHERE ss_store_sk \u003d 4\nGROUP BY ss_item_sk\nHAVING AVG(ss_net_profit) \u003e 0.9 * (((SELECT AVG(ss_net_profit) AS RANK_COL\nFROM store_sales\nWHERE ss_store_sk \u003d 4 AND ss_addr_sk IS NULL\nGROUP BY ss_store_sk)))) AS t6) AS t7\nWHERE RNK \u003c 11) AS t9\nINNER JOIN (SELECT *\nFROM (SELECT ss_item_sk AS ITEM_SK, RANK() OVER (ORDER BY RANK_COL DESC) AS RNK\nFROM (SELECT ss_item_sk, AVG(ss_net_profit) AS RANK_COL\nFROM store_sales\nWHERE ss_store_sk \u003d 4\nGROUP BY ss_item_sk\nHAVING AVG(ss_net_profit) \u003e 0.9 * (((SELECT AVG(ss_net_profit) AS RANK_COL\nFROM store_sales\nWHERE ss_store_sk \u003d 4 AND ss_addr_sk IS NULL\nGROUP BY ss_store_sk)))) AS t17) AS t18\nWHERE RNK \u003c 11) AS t20 ON t9.RNK \u003d t20.RNK\nINNER JOIN item ON t9.ITEM_SK \u003d item.i_item_sk\nINNER JOIN item AS item0 ON t20.ITEM_SK \u003d item0.i_item_sk\nORDER BY t9.RNK\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      24,
      23
    ],
    "optimizedTimesMs": [
      21,
      23
    ],
    "originalAvgMs": 23,
    "optimizedAvgMs": 22,
    "speedup": 1.0454545454545454,
    "originalRowCount": 10,
    "optimizedRowCount": 10,
    "validationPassed": true,
    "originalPlanMaxRows": 204000,
    "optimizedPlanMaxRows": 204000
  },
  {
    "query": "q45",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_SCAN",
      "FILTER_SUB_QUERY_TO_CORRELATE",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer_address.ca_zip AS CA_ZIP, customer_address.ca_city AS CA_CITY, SUM(web_sales.ws_sales_price)\nFROM web_sales\nINNER JOIN customer ON web_sales.ws_bill_customer_sk \u003d customer.c_customer_sk\nINNER JOIN customer_address ON customer.c_current_addr_sk \u003d customer_address.ca_address_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_qoy \u003d 2 AND d_year \u003d 2001) AS t ON web_sales.ws_sold_date_sk \u003d t.d_date_sk\nINNER JOIN item ON web_sales.ws_item_sk \u003d item.i_item_sk AND (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002785669\u0027 OR SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002786197\u0027 OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002788274\u0027 OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002783405\u0027 OR SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002786475\u0027)) OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002785392\u0027 OR SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002785460\u0027 OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002780348\u0027 OR (SUBSTRING(customer_address.ca_zip, 1, 5) \u003d \u002781792\u0027 OR item.i_item_id IN (SELECT i_item_id AS I_ITEM_ID\nFROM item\nWHERE i_item_sk \u003d 2 OR i_item_sk \u003d 3 OR (i_item_sk \u003d 5 OR (i_item_sk \u003d 7 OR i_item_sk \u003d 11)) OR (i_item_sk \u003d 13 OR i_item_sk \u003d 17 OR (i_item_sk \u003d 19 OR (i_item_sk \u003d 23 OR i_item_sk \u003d 29))))))))\nGROUP BY customer_address.ca_zip, customer_address.ca_city\nORDER BY customer_address.ca_zip, customer_address.ca_city\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      25,
      26
    ],
    "optimizedTimesMs": [
      32,
      30
    ],
    "originalAvgMs": 25,
    "optimizedAvgMs": 31,
    "speedup": 0.8064516129032258,
    "originalRowCount": 3,
    "optimizedRowCount": 3,
    "validationPassed": true,
    "originalPlanMaxRows": 2000000,
    "optimizedPlanMaxRows": 2000000
  },
  {
    "query": "q46",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "FILTER_AGGREGATE_TRANSPOSE",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, customer_address0.ca_city AS CA_CITY, t4.BOUGHT_CITY, t4.SS_TICKET_NUMBER, t4.AMT, t4.PROFIT\nFROM (SELECT store_sales.ss_ticket_number AS SS_TICKET_NUMBER, store_sales.ss_customer_sk AS SS_CUSTOMER_SK, customer_address.ca_city AS BOUGHT_CITY, SUM(store_sales.ss_coupon_amt) AS AMT, SUM(store_sales.ss_net_profit) AS PROFIT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_dow IN (0, 6) AND (d_year \u003d 1999 OR d_year \u003d CAST(1999 + 1 AS BIGINT) OR d_year \u003d CAST(1999 + 2 AS BIGINT))) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_city IN (\u0027Fairview\u0027, \u0027Midway\u0027)) AS t0 ON store_sales.ss_store_sk \u003d t0.s_store_sk\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 OR hd_vehicle_count \u003d 3) AS t1 ON store_sales.ss_hdemo_sk \u003d t1.hd_demo_sk\nINNER JOIN customer_address ON store_sales.ss_addr_sk \u003d customer_address.ca_address_sk\nGROUP BY store_sales.ss_ticket_number, store_sales.ss_customer_sk, store_sales.ss_addr_sk, customer_address.ca_city) AS t4\nINNER JOIN customer ON t4.SS_CUSTOMER_SK \u003d customer.c_customer_sk\nINNER JOIN customer_address AS customer_address0 ON customer.c_current_addr_sk \u003d customer_address0.ca_address_sk AND customer_address0.ca_city \u003c\u003e t4.BOUGHT_CITY\nORDER BY customer.c_last_name NULLS FIRST, customer.c_first_name NULLS FIRST, customer_address0.ca_city NULLS FIRST, t4.BOUGHT_CITY NULLS FIRST, t4.SS_TICKET_NUMBER NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      41,
      38
    ],
    "optimizedTimesMs": [
      37,
      40
    ],
    "originalAvgMs": 39,
    "optimizedAvgMs": 38,
    "speedup": 1.0263157894736843,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q47",
    "status": "error",
    "error": "class org.apache.calcite.sql.SqlBasicCall: AVG(SUM(`SS_SALES_PRICE`))",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "FILTER_AGGREGATE_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q48",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "PROJECT_REMOVE"
    ],
    "optimizedSql": "SELECT SUM(store_sales.ss_quantity)\nFROM store_sales\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nINNER JOIN customer_demographics ON store_sales.ss_cdemo_sk \u003d customer_demographics.cd_demo_sk AND customer_demographics.cd_marital_status \u003d \u0027M\u0027 AND customer_demographics.cd_education_status \u003d \u00274 yr Degree\u0027 AND (store_sales.ss_sales_price \u003e\u003d 100.00 AND store_sales.ss_sales_price \u003c\u003d 150.00) OR store_sales.ss_cdemo_sk \u003d customer_demographics.cd_demo_sk AND customer_demographics.cd_marital_status \u003d \u0027D\u0027 AND customer_demographics.cd_education_status \u003d \u00272 yr Degree\u0027 AND (store_sales.ss_sales_price \u003e\u003d 50.00 AND store_sales.ss_sales_price \u003c\u003d 100.00) OR store_sales.ss_cdemo_sk \u003d customer_demographics.cd_demo_sk AND customer_demographics.cd_marital_status \u003d \u0027S\u0027 AND customer_demographics.cd_education_status \u003d \u0027College\u0027 AND (store_sales.ss_sales_price \u003e\u003d 150.00 AND store_sales.ss_sales_price \u003c\u003d 200.00)\nINNER JOIN customer_address ON store_sales.ss_addr_sk \u003d customer_address.ca_address_sk AND customer_address.ca_country \u003d \u0027United States\u0027 AND customer_address.ca_state IN (\u0027CO\u0027, \u0027OH\u0027, \u0027TX\u0027) AND (store_sales.ss_net_profit \u003e\u003d 0 AND store_sales.ss_net_profit \u003c\u003d 2000) OR store_sales.ss_addr_sk \u003d customer_address.ca_address_sk AND customer_address.ca_country \u003d \u0027United States\u0027 AND customer_address.ca_state IN (\u0027KY\u0027, \u0027MN\u0027, \u0027OR\u0027) AND (store_sales.ss_net_profit \u003e\u003d 150 AND store_sales.ss_net_profit \u003c\u003d 3000) OR store_sales.ss_addr_sk \u003d customer_address.ca_address_sk AND customer_address.ca_country \u003d \u0027United States\u0027 AND customer_address.ca_state IN (\u0027CA\u0027, \u0027MS\u0027, \u0027VA\u0027) AND (store_sales.ss_net_profit \u003e\u003d 50 AND store_sales.ss_net_profit \u003c\u003d 25000)\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk",
    "originalTimesMs": [
      58,
      62
    ],
    "optimizedTimesMs": [
      61,
      55
    ],
    "originalAvgMs": 60,
    "optimizedAvgMs": 58,
    "speedup": 1.0344827586206897,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q49",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"$\"",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "PROJECT_REMOVE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "optimizedSql": "SELECT *\nFROM (SELECT *\nFROM (SELECT \u0027web\u0027 AS CHANNEL, ITEM, RETURN_RATIO, RETURN_RANK, CURRENCY_RANK\nFROM (SELECT t3.ws_item_sk AS ITEM, CAST(t3.$f1 AS DECIMAL(15, 4)) / CAST(t3.$f2 AS DECIMAL(15, 4)) AS RETURN_RATIO, CAST(t3.$f3 AS DECIMAL(15, 4)) / CAST(t3.$f4 AS DECIMAL(15, 4)) AS CURRENCY_RATIO, RANK() OVER (ORDER BY CAST(t3.$f1 AS DECIMAL(15, 4)) / CAST(t3.$f2 AS DECIMAL(15, 4))) AS RETURN_RANK, RANK() OVER (ORDER BY CAST(t3.$f3 AS DECIMAL(15, 4)) / CAST(t3.$f4 AS DECIMAL(15, 4))) AS CURRENCY_RANK\nFROM (SELECT t.ws_item_sk, SUM(CASE WHEN t0.wr_return_quantity IS NOT NULL THEN CAST(t0.wr_return_quantity AS BIGINT) ELSE 0 END) AS $f1, SUM(CASE WHEN t.ws_quantity IS NOT NULL THEN CAST(t.ws_quantity AS BIGINT) ELSE 0 END) AS $f2, SUM(CASE WHEN t0.wr_return_amt IS NOT NULL THEN CAST(t0.wr_return_amt AS DECIMAL(19, 0)) ELSE 0 END) AS $f3, SUM(CASE WHEN t.ws_net_paid IS NOT NULL THEN CAST(t.ws_net_paid AS DECIMAL(19, 0)) ELSE 0 END) AS $f4\nFROM (SELECT *\nFROM web_sales\nWHERE ws_net_profit \u003e 1 AND ws_net_paid \u003e 0 AND ws_quantity \u003e 0) AS t\nINNER JOIN (SELECT *\nFROM web_returns\nWHERE wr_return_amt \u003e 10000) AS t0 ON t.ws_order_number \u003d t0.wr_order_number AND t.ws_item_sk \u003d t0.wr_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 AND d_moy \u003d 12) AS t1 ON t.ws_sold_date_sk \u003d t1.d_date_sk\nGROUP BY t.ws_item_sk) AS t3) AS t4\nWHERE RETURN_RANK \u003c\u003d 10 OR CURRENCY_RANK \u003c\u003d 10\nUNION\nSELECT \u0027catalog\u0027 AS CHANNEL, ITEM, RETURN_RATIO, RETURN_RANK, CURRENCY_RANK\nFROM (SELECT t11.cs_item_sk AS ITEM, CAST(t11.$f1 AS DECIMAL(15, 4)) / CAST(t11.$f2 AS DECIMAL(15, 4)) AS RETURN_RATIO, CAST(t11.$f3 AS DECIMAL(15, 4)) / CAST(t11.$f4 AS DECIMAL(15, 4)) AS CURRENCY_RATIO, RANK() OVER (ORDER BY CAST(t11.$f1 AS DECIMAL(15, 4)) / CAST(t11.$f2 AS DECIMAL(15, 4))) AS RETURN_RANK, RANK() OVER (ORDER BY CAST(t11.$f3 AS DECIMAL(15, 4)) / CAST(t11.$f4 AS DECIMAL(15, 4))) AS CURRENCY_RANK\nFROM (SELECT t7.cs_item_sk, SUM(CASE WHEN t8.cr_return_quantity IS NOT NULL THEN CAST(t8.cr_return_quantity AS BIGINT) ELSE 0 END) AS $f1, SUM(CASE WHEN t7.cs_quantity IS NOT NULL THEN CAST(t7.cs_quantity AS BIGINT) ELSE 0 END) AS $f2, SUM(CASE WHEN t8.cr_return_amount IS NOT NULL THEN CAST(t8.cr_return_amount AS DECIMAL(19, 0)) ELSE 0 END) AS $f3, SUM(CASE WHEN t7.cs_net_paid IS NOT NULL THEN CAST(t7.cs_net_paid AS DECIMAL(19, 0)) ELSE 0 END) AS $f4\nFROM (SELECT *\nFROM catalog_sales\nWHERE cs_net_profit \u003e 1 AND cs_net_paid \u003e 0 AND cs_quantity \u003e 0) AS t7\nINNER JOIN (SELECT *\nFROM catalog_returns\nWHERE cr_return_amount \u003e 10000) AS t8 ON t7.cs_order_number \u003d t8.cr_order_number AND t7.cs_item_sk \u003d t8.cr_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 AND d_moy \u003d 12) AS t9 ON t7.cs_sold_date_sk \u003d t9.d_date_sk\nGROUP BY t7.cs_item_sk) AS t11) AS t12\nWHERE RETURN_RANK \u003c\u003d 10 OR CURRENCY_RANK \u003c\u003d 10)\nUNION\nSELECT \u0027store\u0027 AS CHANNEL, ITEM, RETURN_RATIO, RETURN_RANK, CURRENCY_RANK\nFROM (SELECT t20.ss_item_sk AS ITEM, CAST(t20.$f1 AS DECIMAL(15, 4)) / CAST(t20.$f2 AS DECIMAL(15, 4)) AS RETURN_RATIO, CAST(t20.$f3 AS DECIMAL(15, 4)) / CAST(t20.$f4 AS DECIMAL(15, 4)) AS CURRENCY_RATIO, RANK() OVER (ORDER BY CAST(t20.$f1 AS DECIMAL(15, 4)) / CAST(t20.$f2 AS DECIMAL(15, 4))) AS RETURN_RANK, RANK() OVER (ORDER BY CAST(t20.$f3 AS DECIMAL(15, 4)) / CAST(t20.$f4 AS DECIMAL(15, 4))) AS CURRENCY_RANK\nFROM (SELECT t16.ss_item_sk, SUM(CASE WHEN t17.sr_return_quantity IS NOT NULL THEN CAST(t17.sr_return_quantity AS BIGINT) ELSE 0 END) AS $f1, SUM(CASE WHEN t16.ss_quantity IS NOT NULL THEN CAST(t16.ss_quantity AS BIGINT) ELSE 0 END) AS $f2, SUM(CASE WHEN t17.sr_return_amt IS NOT NULL THEN CAST(t17.sr_return_amt AS DECIMAL(19, 0)) ELSE 0 END) AS $f3, SUM(CASE WHEN t16.ss_net_paid IS NOT NULL THEN CAST(t16.ss_net_paid AS DECIMAL(19, 0)) ELSE 0 END) AS $f4\nFROM (SELECT *\nFROM store_sales\nWHERE ss_net_profit \u003e 1 AND ss_net_paid \u003e 0 AND ss_quantity \u003e 0) AS t16\nINNER JOIN (SELECT *\nFROM store_returns\nWHERE sr_return_amt \u003e 10000) AS t17 ON t16.ss_ticket_number \u003d t17.sr_ticket_number AND t16.ss_item_sk \u003d t17.sr_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 AND d_moy \u003d 12) AS t18 ON t16.ss_sold_date_sk \u003d t18.d_date_sk\nGROUP BY t16.ss_item_sk) AS t20) AS t21\nWHERE RETURN_RANK \u003c\u003d 10 OR CURRENCY_RANK \u003c\u003d 10)\nORDER BY CHANNEL NULLS FIRST, RETURN_RANK NULLS FIRST, CURRENCY_RANK NULLS FIRST, ITEM NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q50",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"30\"",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "AGGREGATE_CASE_TO_FILTER",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT store.s_store_name AS S_STORE_NAME, store.s_company_id AS S_COMPANY_ID, store.s_street_number AS S_STREET_NUMBER, store.s_street_name AS S_STREET_NAME, store.s_street_type AS S_STREET_TYPE, store.s_suite_number AS S_SUITE_NUMBER, store.s_city AS S_CITY, store.s_county AS S_COUNTY, store.s_state AS S_STATE, store.s_zip AS S_ZIP, SUM(CASE WHEN store_returns.sr_returned_date_sk - store_sales.ss_sold_date_sk \u003c\u003d 30 THEN 1 ELSE 0 END) AS 30 days, SUM(CASE WHEN store_returns.sr_returned_date_sk - store_sales.ss_sold_date_sk \u003e 30 AND store_returns.sr_returned_date_sk - store_sales.ss_sold_date_sk \u003c\u003d 60 THEN 1 ELSE 0 END) AS 31-60 days, SUM(CASE WHEN store_returns.sr_returned_date_sk - store_sales.ss_sold_date_sk \u003e 60 AND store_returns.sr_returned_date_sk - store_sales.ss_sold_date_sk \u003c\u003d 90 THEN 1 ELSE 0 END) AS 61-90 days, SUM(CASE WHEN store_returns.sr_returned_date_sk - store_sales.ss_sold_date_sk \u003e 90 AND store_returns.sr_returned_date_sk - store_sales.ss_sold_date_sk \u003c\u003d 120 THEN 1 ELSE 0 END) AS 91-120 days, SUM(CASE WHEN store_returns.sr_returned_date_sk - store_sales.ss_sold_date_sk \u003e 120 THEN 1 ELSE 0 END) AS \u003e120 days\nFROM store_sales\nINNER JOIN store_returns ON store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number AND store_sales.ss_item_sk \u003d store_returns.sr_item_sk AND store_sales.ss_customer_sk \u003d store_returns.sr_customer_sk\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nINNER JOIN date_dim ON store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 AND d_moy \u003d 8) AS t ON store_returns.sr_returned_date_sk \u003d t.d_date_sk\nGROUP BY store.s_store_name, store.s_company_id, store.s_street_number, store.s_street_name, store.s_street_type, store.s_suite_number, store.s_city, store.s_county, store.s_state, store.s_zip\nORDER BY store.s_store_name, store.s_company_id, store.s_street_number, store.s_street_name, store.s_street_type, store.s_suite_number, store.s_city, store.s_county, store.s_state, store.s_zip\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q51",
    "status": "error",
    "error": "class org.apache.calcite.sql.SqlBasicCall: SUM(SUM(`WS_SALES_PRICE`)) OVER (PARTITION BY `WS_ITEM_SK` ORDER BY `D_DATE` ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "AGGREGATE_PROJECT_MERGE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q52",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t3.d_year AS D_YEAR, t3.i_brand_id AS BRAND_ID, t3.i_brand AS BRAND, t3.EXT_PRICE\nFROM (SELECT t.d_year, t0.i_brand, t0.i_brand_id, SUM(store_sales.ss_ext_sales_price) AS EXT_PRICE\nFROM (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 11 AND d_year \u003d 2000) AS t\nINNER JOIN store_sales ON t.d_date_sk \u003d store_sales.ss_sold_date_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_manager_id \u003d 1) AS t0 ON store_sales.ss_item_sk \u003d t0.i_item_sk\nGROUP BY t.d_year, t0.i_brand, t0.i_brand_id\nORDER BY t.d_year, 4 DESC, t0.i_brand_id\nFETCH NEXT 100 ROWS ONLY) AS t3",
    "originalTimesMs": [
      11,
      11
    ],
    "optimizedTimesMs": [
      10,
      11
    ],
    "originalAvgMs": 11,
    "optimizedAvgMs": 10,
    "speedup": 1.1,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q53",
    "status": "error",
    "error": "class org.apache.calcite.sql.SqlBasicCall: AVG(SUM(`SS_SALES_PRICE`))",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q54",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SUBQUERY_REMOVE",
      "MULTI_JOIN_OPTIMIZE"
    ],
    "optimizedSql": "SELECT t15.SEGMENT, COUNT(*) AS NUM_CUSTOMERS, t15.SEGMENT * 50 AS SEGMENT_BASE\nFROM (SELECT CAST(ROUND(SUM(store_sales.ss_ext_sales_price) / 50) AS INTEGER) AS SEGMENT\nFROM (SELECT customer.c_customer_sk AS C_CUSTOMER_SK, customer.c_current_addr_sk AS C_CURRENT_ADDR_SK\nFROM (SELECT cs_sold_date_sk AS SOLD_DATE_SK, cs_bill_customer_sk AS CUSTOMER_SK, cs_item_sk AS ITEM_SK\nFROM catalog_sales\nUNION ALL\nSELECT ws_sold_date_sk AS SOLD_DATE_SK, ws_bill_customer_sk AS CUSTOMER_SK, ws_item_sk AS ITEM_SK\nFROM web_sales) AS t1\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Women\u0027 AND i_class \u003d \u0027maternity\u0027) AS t2 ON t1.ITEM_SK \u003d t2.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 12 AND d_year \u003d 1998) AS t3 ON t1.SOLD_DATE_SK \u003d t3.d_date_sk\nINNER JOIN customer ON t1.CUSTOMER_SK \u003d customer.c_customer_sk\nGROUP BY customer.c_customer_sk, customer.c_current_addr_sk) AS t5\nINNER JOIN store_sales ON t5.C_CUSTOMER_SK \u003d store_sales.ss_customer_sk\nINNER JOIN customer_address ON t5.C_CURRENT_ADDR_SK \u003d customer_address.ca_address_sk\nINNER JOIN store ON customer_address.ca_county \u003d store.s_county AND customer_address.ca_state \u003d store.s_state\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d (((SELECT d_month_seq + 1\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 12\nGROUP BY d_month_seq + 1))) AND d_month_seq \u003c\u003d (((SELECT d_month_seq + 3\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 12\nGROUP BY d_month_seq + 3)))) AS t12 ON store_sales.ss_sold_date_sk \u003d t12.d_date_sk\nGROUP BY t5.C_CUSTOMER_SK) AS t15\nGROUP BY t15.SEGMENT\nORDER BY t15.SEGMENT NULLS FIRST, 2 NULLS FIRST, 3\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      29,
      27
    ],
    "optimizedTimesMs": [
      24,
      25
    ],
    "originalAvgMs": 28,
    "optimizedAvgMs": 24,
    "speedup": 1.1666666666666667,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q55",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t3.i_brand_id AS BRAND_ID, t3.i_brand AS BRAND, t3.EXT_PRICE\nFROM (SELECT t0.i_brand, t0.i_brand_id, SUM(store_sales.ss_ext_sales_price) AS EXT_PRICE\nFROM (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 11 AND d_year \u003d 1999) AS t\nINNER JOIN store_sales ON t.d_date_sk \u003d store_sales.ss_sold_date_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_manager_id \u003d 28) AS t0 ON store_sales.ss_item_sk \u003d t0.i_item_sk\nGROUP BY t0.i_brand, t0.i_brand_id\nORDER BY 3 DESC, t0.i_brand_id\nFETCH NEXT 100 ROWS ONLY) AS t3",
    "originalTimesMs": [
      11,
      15
    ],
    "optimizedTimesMs": [
      11,
      14
    ],
    "originalAvgMs": 13,
    "optimizedAvgMs": 12,
    "speedup": 1.0833333333333333,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q56",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT I_ITEM_ID, SUM(TOTAL_SALES) AS TOTAL_SALES\nFROM (SELECT *\nFROM (SELECT t3.i_item_id AS I_ITEM_ID, SUM(store_sales.ss_ext_sales_price) AS TOTAL_SALES\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 AND d_moy \u003d 2) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t0 ON store_sales.ss_addr_sk \u003d t0.ca_address_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_item_id IN (SELECT i_item_id AS I_ITEM_ID\nFROM item\nWHERE i_color \u003d \u0027slate\u0027 OR i_color \u003d \u0027blanched\u0027 OR i_color \u003d \u0027burnished\u0027)) AS t3 ON store_sales.ss_item_sk \u003d t3.i_item_sk\nGROUP BY t3.i_item_id\nUNION ALL\nSELECT t11.i_item_id AS I_ITEM_ID, SUM(catalog_sales.cs_ext_sales_price) AS TOTAL_SALES\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 AND d_moy \u003d 2) AS t7 ON catalog_sales.cs_sold_date_sk \u003d t7.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t8 ON catalog_sales.cs_bill_addr_sk \u003d t8.ca_address_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_item_id IN (SELECT i_item_id AS I_ITEM_ID\nFROM item\nWHERE i_color \u003d \u0027slate\u0027 OR i_color \u003d \u0027blanched\u0027 OR i_color \u003d \u0027burnished\u0027)) AS t11 ON catalog_sales.cs_item_sk \u003d t11.i_item_sk\nGROUP BY t11.i_item_id)\nUNION ALL\nSELECT t20.i_item_id AS I_ITEM_ID, SUM(web_sales.ws_ext_sales_price) AS TOTAL_SALES\nFROM web_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 AND d_moy \u003d 2) AS t16 ON web_sales.ws_sold_date_sk \u003d t16.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t17 ON web_sales.ws_bill_addr_sk \u003d t17.ca_address_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_item_id IN (SELECT i_item_id AS I_ITEM_ID\nFROM item\nWHERE i_color \u003d \u0027slate\u0027 OR i_color \u003d \u0027blanched\u0027 OR i_color \u003d \u0027burnished\u0027)) AS t20 ON web_sales.ws_item_sk \u003d t20.i_item_sk\nGROUP BY t20.i_item_id) AS t24\nGROUP BY I_ITEM_ID\nORDER BY 2 NULLS FIRST, I_ITEM_ID NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      32,
      30
    ],
    "optimizedTimesMs": [
      32,
      30
    ],
    "originalAvgMs": 31,
    "optimizedAvgMs": 31,
    "speedup": 1.0,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q57",
    "status": "error",
    "error": "class org.apache.calcite.sql.SqlBasicCall: AVG(SUM(`CS_SALES_PRICE`))",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "FILTER_AGGREGATE_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q58",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"$\"",
    "rules": [
      "FILTER_SCAN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SUB_QUERY_TO_CORRELATE",
      "PROJECT_MERGE",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t6.ITEM_ID, t6.SS_ITEM_REV, t6.SS_ITEM_REV / ((t6.SS_ITEM_REV + t14.CS_ITEM_REV + t22.WS_ITEM_REV) / 3) * 100 AS SS_DEV, t14.CS_ITEM_REV, t14.CS_ITEM_REV / ((t6.SS_ITEM_REV + t14.CS_ITEM_REV + t22.WS_ITEM_REV) / 3) * 100 AS CS_DEV, t22.WS_ITEM_REV, t22.WS_ITEM_REV / ((t6.SS_ITEM_REV + t14.CS_ITEM_REV + t22.WS_ITEM_REV) / 3) * 100 AS WS_DEV, (t6.SS_ITEM_REV + t14.CS_ITEM_REV + t22.WS_ITEM_REV) / 3 AS AVERAGE\nFROM (SELECT item.i_item_id AS ITEM_ID, SUM(store_sales.ss_ext_sales_price) AS SS_ITEM_REV\nFROM store_sales\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nINNER JOIN date_dim ON store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk\nINNER JOIN (SELECT date_dim0.d_date AS D_DATE\nFROM date_dim AS date_dim0\nINNER JOIN (SELECT SINGLE_VALUE(d_week_seq) AS $f0\nFROM date_dim\nWHERE d_date \u003d \u00272000-01-03\u0027) AS t1 ON date_dim0.d_week_seq \u003d t1.$f0\nGROUP BY date_dim0.d_date) AS t3 ON date_dim.d_date \u003d t3.D_DATE\nGROUP BY item.i_item_id) AS t6\nINNER JOIN (SELECT item0.i_item_id AS ITEM_ID, SUM(catalog_sales.cs_ext_sales_price) AS CS_ITEM_REV\nFROM catalog_sales\nINNER JOIN item AS item0 ON catalog_sales.cs_item_sk \u003d item0.i_item_sk\nINNER JOIN date_dim AS date_dim2 ON catalog_sales.cs_sold_date_sk \u003d date_dim2.d_date_sk\nINNER JOIN (SELECT date_dim3.d_date AS D_DATE\nFROM date_dim AS date_dim3\nINNER JOIN (SELECT SINGLE_VALUE(d_week_seq) AS $f0\nFROM date_dim\nWHERE d_date \u003d \u00272000-01-03\u0027) AS t9 ON date_dim3.d_week_seq \u003d t9.$f0\nGROUP BY date_dim3.d_date) AS t11 ON date_dim2.d_date \u003d t11.D_DATE\nGROUP BY item0.i_item_id) AS t14 ON t6.ITEM_ID \u003d t14.ITEM_ID AND t6.SS_ITEM_REV \u003e\u003d 0.9 * t14.CS_ITEM_REV AND t6.SS_ITEM_REV \u003c\u003d 1.1 * t14.CS_ITEM_REV AND t14.CS_ITEM_REV \u003e\u003d 0.9 * t6.SS_ITEM_REV AND t14.CS_ITEM_REV \u003c\u003d 1.1 * t6.SS_ITEM_REV\nINNER JOIN (SELECT item1.i_item_id AS ITEM_ID, SUM(web_sales.ws_ext_sales_price) AS WS_ITEM_REV\nFROM web_sales\nINNER JOIN item AS item1 ON web_sales.ws_item_sk \u003d item1.i_item_sk\nINNER JOIN date_dim AS date_dim5 ON web_sales.ws_sold_date_sk \u003d date_dim5.d_date_sk\nINNER JOIN (SELECT date_dim6.d_date AS D_DATE\nFROM date_dim AS date_dim6\nINNER JOIN (SELECT SINGLE_VALUE(d_week_seq) AS $f0\nFROM date_dim\nWHERE d_date \u003d \u00272000-01-03\u0027) AS t17 ON date_dim6.d_week_seq \u003d t17.$f0\nGROUP BY date_dim6.d_date) AS t19 ON date_dim5.d_date \u003d t19.D_DATE\nGROUP BY item1.i_item_id) AS t22 ON t6.ITEM_ID \u003d t22.ITEM_ID AND t6.SS_ITEM_REV \u003e\u003d 0.9 * t22.WS_ITEM_REV AND (t6.SS_ITEM_REV \u003c\u003d 1.1 * t22.WS_ITEM_REV AND t14.CS_ITEM_REV \u003e\u003d 0.9 * t22.WS_ITEM_REV) AND (t14.CS_ITEM_REV \u003c\u003d 1.1 * t22.WS_ITEM_REV AND t22.WS_ITEM_REV \u003e\u003d 0.9 * t6.SS_ITEM_REV AND (t22.WS_ITEM_REV \u003c\u003d 1.1 * t6.SS_ITEM_REV AND (t22.WS_ITEM_REV \u003e\u003d 0.9 * t14.CS_ITEM_REV AND t22.WS_ITEM_REV \u003c\u003d 1.1 * t14.CS_ITEM_REV)))\nORDER BY t6.ITEM_ID NULLS FIRST, t6.SS_ITEM_REV NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q59",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "AGGREGATE_CASE_TO_FILTER",
      "PROJECT_MERGE",
      "PROJECT_REMOVE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t2.S_STORE_NAME1, t2.S_STORE_ID1, t2.D_WEEK_SEQ1, t2.SUN_SALES1 / t6.SUN_SALES2 AS SUN_SALES_RATIO, t2.MON_SALES1 / t6.MON_SALES2 AS MON_SALES_RATIO, t2.TUE_SALES1 / t6.TUE_SALES2 AS TUE_SALES_RATIO, t2.WED_SALES1 / t6.WED_SALES2 AS WED_SALES_RATIO, t2.THU_SALES1 / t6.THU_SALES2 AS THU_SALES_RATIO, t2.FRI_SALES1 / t6.FRI_SALES2 AS FRI_SALES_RATIO, t2.SAT_SALES1 / t6.SAT_SALES2 AS SAT_SALES_RATIO\nFROM (SELECT store.s_store_name AS S_STORE_NAME1, t0.d_week_seq AS D_WEEK_SEQ1, store.s_store_id AS S_STORE_ID1, t0.SUN_SALES AS SUN_SALES1, t0.MON_SALES AS MON_SALES1, t0.TUE_SALES AS TUE_SALES1, t0.WED_SALES AS WED_SALES1, t0.THU_SALES AS THU_SALES1, t0.FRI_SALES AS FRI_SALES1, t0.SAT_SALES AS SAT_SALES1\nFROM (SELECT date_dim.d_week_seq, store_sales.ss_store_sk, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Sunday\u0027 IS TRUE) AS SUN_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Monday\u0027 IS TRUE) AS MON_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Tuesday\u0027 IS TRUE) AS TUE_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Wednesday\u0027 IS TRUE) AS WED_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Thursday\u0027 IS TRUE) AS THU_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Friday\u0027 IS TRUE) AS FRI_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Saturday\u0027 IS TRUE) AS SAT_SALES\nFROM store_sales\nINNER JOIN date_dim ON store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk\nGROUP BY date_dim.d_week_seq, store_sales.ss_store_sk) AS t0\nINNER JOIN store ON t0.ss_store_sk \u003d store.s_store_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1212 AND d_month_seq \u003c\u003d 1212 + 11) AS t1 ON t0.d_week_seq \u003d t1.d_week_seq) AS t2\nINNER JOIN (SELECT store0.s_store_name AS S_STORE_NAME2, t4.d_week_seq AS D_WEEK_SEQ2, store0.s_store_id AS S_STORE_ID2, t4.SUN_SALES AS SUN_SALES2, t4.MON_SALES AS MON_SALES2, t4.TUE_SALES AS TUE_SALES2, t4.WED_SALES AS WED_SALES2, t4.THU_SALES AS THU_SALES2, t4.FRI_SALES AS FRI_SALES2, t4.SAT_SALES AS SAT_SALES2\nFROM (SELECT date_dim1.d_week_seq, store_sales0.ss_store_sk, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Sunday\u0027 IS TRUE) AS SUN_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Monday\u0027 IS TRUE) AS MON_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Tuesday\u0027 IS TRUE) AS TUE_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Wednesday\u0027 IS TRUE) AS WED_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Thursday\u0027 IS TRUE) AS THU_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Friday\u0027 IS TRUE) AS FRI_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Saturday\u0027 IS TRUE) AS SAT_SALES\nFROM store_sales AS store_sales0\nINNER JOIN date_dim AS date_dim1 ON store_sales0.ss_sold_date_sk \u003d date_dim1.d_date_sk\nGROUP BY date_dim1.d_week_seq, store_sales0.ss_store_sk) AS t4\nINNER JOIN store AS store0 ON t4.ss_store_sk \u003d store0.s_store_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1212 + 12 AND d_month_seq \u003c\u003d 1212 + 23) AS t5 ON t4.d_week_seq \u003d t5.d_week_seq) AS t6 ON t2.S_STORE_ID1 \u003d t6.S_STORE_ID2 AND t2.D_WEEK_SEQ1 \u003d t6.D_WEEK_SEQ2 - 52\nORDER BY t2.S_STORE_NAME1 NULLS FIRST, t2.S_STORE_ID1 NULLS FIRST, t2.D_WEEK_SEQ1 NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      260,
      251
    ],
    "optimizedTimesMs": [
      323,
      317
    ],
    "originalAvgMs": 255,
    "optimizedAvgMs": 320,
    "speedup": 0.796875,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q60",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT I_ITEM_ID, SUM(TOTAL_SALES) AS TOTAL_SALES\nFROM (SELECT *\nFROM (SELECT t3.i_item_id AS I_ITEM_ID, SUM(store_sales.ss_ext_sales_price) AS TOTAL_SALES\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 9) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t0 ON store_sales.ss_addr_sk \u003d t0.ca_address_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_item_id IN (SELECT i_item_id AS I_ITEM_ID\nFROM item\nWHERE i_category \u003d \u0027Music\u0027)) AS t3 ON store_sales.ss_item_sk \u003d t3.i_item_sk\nGROUP BY t3.i_item_id\nUNION ALL\nSELECT t11.i_item_id AS I_ITEM_ID, SUM(catalog_sales.cs_ext_sales_price) AS TOTAL_SALES\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 9) AS t7 ON catalog_sales.cs_sold_date_sk \u003d t7.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t8 ON catalog_sales.cs_bill_addr_sk \u003d t8.ca_address_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_item_id IN (SELECT i_item_id AS I_ITEM_ID\nFROM item\nWHERE i_category \u003d \u0027Music\u0027)) AS t11 ON catalog_sales.cs_item_sk \u003d t11.i_item_sk\nGROUP BY t11.i_item_id)\nUNION ALL\nSELECT t20.i_item_id AS I_ITEM_ID, SUM(web_sales.ws_ext_sales_price) AS TOTAL_SALES\nFROM web_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 9) AS t16 ON web_sales.ws_sold_date_sk \u003d t16.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t17 ON web_sales.ws_bill_addr_sk \u003d t17.ca_address_sk\nINNER JOIN (SELECT *\nFROM item\nWHERE i_item_id IN (SELECT i_item_id AS I_ITEM_ID\nFROM item\nWHERE i_category \u003d \u0027Music\u0027)) AS t20 ON web_sales.ws_item_sk \u003d t20.i_item_sk\nGROUP BY t20.i_item_id) AS t24\nGROUP BY I_ITEM_ID\nORDER BY I_ITEM_ID, 2\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      32,
      32
    ],
    "optimizedTimesMs": [
      35,
      32
    ],
    "originalAvgMs": 32,
    "optimizedAvgMs": 33,
    "speedup": 0.9696969696969697,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q61",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "JOIN_TO_MULTI_JOIN",
      "MULTI_JOIN_OPTIMIZE"
    ],
    "optimizedSql": "SELECT t10.PROMOTIONS, t20.TOTAL, CAST(t10.PROMOTIONS AS DECIMAL(15, 4)) / CAST(t20.TOTAL AS DECIMAL(15, 4)) * 100\nFROM (SELECT SUM(t7.ss_ext_sales_price) AS PROMOTIONS\nFROM (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Jewelry\u0027) AS t\nINNER JOIN (SELECT t6.ss_sold_date_sk, t6.ss_sold_time_sk, t6.ss_item_sk, t6.ss_customer_sk, t6.ss_cdemo_sk, t6.ss_hdemo_sk, t6.ss_addr_sk, t6.ss_store_sk, t6.ss_promo_sk, t6.ss_ticket_number, t6.ss_quantity, t6.ss_wholesale_cost, t6.ss_list_price, t6.ss_sales_price, t6.ss_ext_discount_amt, t6.ss_ext_sales_price, t6.ss_ext_wholesale_cost, t6.ss_ext_list_price, t6.ss_ext_tax, t6.ss_coupon_amt, t6.ss_net_paid, t6.ss_net_paid_inc_tax, t6.ss_net_profit, t6.s_store_sk, t6.s_store_id, t6.s_rec_start_date, t6.s_rec_end_date, t6.s_closed_date_sk, t6.s_store_name, t6.s_number_employees, t6.s_floor_space, t6.s_hours, t6.s_manager, t6.s_market_id, t6.s_geography_class, t6.s_market_desc, t6.s_market_manager, t6.s_division_id, t6.s_division_name, t6.s_company_id, t6.s_company_name, t6.s_street_number, t6.s_street_name, t6.s_street_type, t6.s_suite_number, t6.s_city, t6.s_county, t6.s_state, t6.s_zip, t6.s_country, t6.s_gmt_offset, t6.s_tax_percentage, t6.p_promo_sk, t6.p_promo_id, t6.p_start_date_sk, t6.p_end_date_sk, t6.p_item_sk, t6.p_cost, t6.p_response_target, t6.p_promo_name, t6.p_channel_dmail, t6.p_channel_email, t6.p_channel_catalog, t6.p_channel_tv, t6.p_channel_radio, t6.p_channel_press, t6.p_channel_event, t6.p_channel_demo, t6.p_channel_details, t6.p_purpose, t6.p_discount_active, t6.d_date_sk, t6.d_date_id, t6.d_date, t6.d_month_seq, t6.d_week_seq, t6.d_quarter_seq, t6.d_year, t6.d_dow, t6.d_moy, t6.d_dom, t6.d_qoy, t6.d_fy_year, t6.d_fy_quarter_seq, t6.d_fy_week_seq, t6.d_day_name, t6.d_quarter_name, t6.d_holiday, t6.d_weekend, t6.d_following_holiday, t6.d_first_dom, t6.d_last_dom, t6.d_same_day_ly, t6.d_same_day_lq, t6.d_current_day, t6.d_current_week, t6.d_current_month, t6.d_current_quarter, t6.d_current_year, t6.c_customer_sk, t6.c_customer_id, t6.c_current_cdemo_sk, t6.c_current_hdemo_sk, t6.c_current_addr_sk, t6.c_first_shipto_date_sk, t6.c_first_sales_date_sk, t6.c_salutation, t6.c_first_name, t6.c_last_name, t6.c_preferred_cust_flag, t6.c_birth_day, t6.c_birth_month, t6.c_birth_year, t6.c_birth_country, t6.c_login, t6.c_email_address, t6.c_last_review_date_sk, t0.ca_address_sk, t0.ca_address_id, t0.ca_street_number, t0.ca_street_name, t0.ca_street_type, t0.ca_suite_number, t0.ca_city, t0.ca_county, t0.ca_state, t0.ca_zip, t0.ca_country, t0.ca_gmt_offset, t0.ca_location_type\nFROM (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t0\nINNER JOIN (SELECT t5.ss_sold_date_sk, t5.ss_sold_time_sk, t5.ss_item_sk, t5.ss_customer_sk, t5.ss_cdemo_sk, t5.ss_hdemo_sk, t5.ss_addr_sk, t5.ss_store_sk, t5.ss_promo_sk, t5.ss_ticket_number, t5.ss_quantity, t5.ss_wholesale_cost, t5.ss_list_price, t5.ss_sales_price, t5.ss_ext_discount_amt, t5.ss_ext_sales_price, t5.ss_ext_wholesale_cost, t5.ss_ext_list_price, t5.ss_ext_tax, t5.ss_coupon_amt, t5.ss_net_paid, t5.ss_net_paid_inc_tax, t5.ss_net_profit, t5.s_store_sk, t5.s_store_id, t5.s_rec_start_date, t5.s_rec_end_date, t5.s_closed_date_sk, t5.s_store_name, t5.s_number_employees, t5.s_floor_space, t5.s_hours, t5.s_manager, t5.s_market_id, t5.s_geography_class, t5.s_market_desc, t5.s_market_manager, t5.s_division_id, t5.s_division_name, t5.s_company_id, t5.s_company_name, t5.s_street_number, t5.s_street_name, t5.s_street_type, t5.s_suite_number, t5.s_city, t5.s_county, t5.s_state, t5.s_zip, t5.s_country, t5.s_gmt_offset, t5.s_tax_percentage, t5.p_promo_sk, t5.p_promo_id, t5.p_start_date_sk, t5.p_end_date_sk, t5.p_item_sk, t5.p_cost, t5.p_response_target, t5.p_promo_name, t5.p_channel_dmail, t5.p_channel_email, t5.p_channel_catalog, t5.p_channel_tv, t5.p_channel_radio, t5.p_channel_press, t5.p_channel_event, t5.p_channel_demo, t5.p_channel_details, t5.p_purpose, t5.p_discount_active, t5.d_date_sk, t5.d_date_id, t5.d_date, t5.d_month_seq, t5.d_week_seq, t5.d_quarter_seq, t5.d_year, t5.d_dow, t5.d_moy, t5.d_dom, t5.d_qoy, t5.d_fy_year, t5.d_fy_quarter_seq, t5.d_fy_week_seq, t5.d_day_name, t5.d_quarter_name, t5.d_holiday, t5.d_weekend, t5.d_following_holiday, t5.d_first_dom, t5.d_last_dom, t5.d_same_day_ly, t5.d_same_day_lq, t5.d_current_day, t5.d_current_week, t5.d_current_month, t5.d_current_quarter, t5.d_current_year, customer.c_customer_sk, customer.c_customer_id, customer.c_current_cdemo_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_salutation, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_last_review_date_sk\nFROM customer\nINNER JOIN (SELECT t4.ss_sold_date_sk, t4.ss_sold_time_sk, t4.ss_item_sk, t4.ss_customer_sk, t4.ss_cdemo_sk, t4.ss_hdemo_sk, t4.ss_addr_sk, t4.ss_store_sk, t4.ss_promo_sk, t4.ss_ticket_number, t4.ss_quantity, t4.ss_wholesale_cost, t4.ss_list_price, t4.ss_sales_price, t4.ss_ext_discount_amt, t4.ss_ext_sales_price, t4.ss_ext_wholesale_cost, t4.ss_ext_list_price, t4.ss_ext_tax, t4.ss_coupon_amt, t4.ss_net_paid, t4.ss_net_paid_inc_tax, t4.ss_net_profit, t4.s_store_sk, t4.s_store_id, t4.s_rec_start_date, t4.s_rec_end_date, t4.s_closed_date_sk, t4.s_store_name, t4.s_number_employees, t4.s_floor_space, t4.s_hours, t4.s_manager, t4.s_market_id, t4.s_geography_class, t4.s_market_desc, t4.s_market_manager, t4.s_division_id, t4.s_division_name, t4.s_company_id, t4.s_company_name, t4.s_street_number, t4.s_street_name, t4.s_street_type, t4.s_suite_number, t4.s_city, t4.s_county, t4.s_state, t4.s_zip, t4.s_country, t4.s_gmt_offset, t4.s_tax_percentage, t4.p_promo_sk, t4.p_promo_id, t4.p_start_date_sk, t4.p_end_date_sk, t4.p_item_sk, t4.p_cost, t4.p_response_target, t4.p_promo_name, t4.p_channel_dmail, t4.p_channel_email, t4.p_channel_catalog, t4.p_channel_tv, t4.p_channel_radio, t4.p_channel_press, t4.p_channel_event, t4.p_channel_demo, t4.p_channel_details, t4.p_purpose, t4.p_discount_active, t1.d_date_sk, t1.d_date_id, t1.d_date, t1.d_month_seq, t1.d_week_seq, t1.d_quarter_seq, t1.d_year, t1.d_dow, t1.d_moy, t1.d_dom, t1.d_qoy, t1.d_fy_year, t1.d_fy_quarter_seq, t1.d_fy_week_seq, t1.d_day_name, t1.d_quarter_name, t1.d_holiday, t1.d_weekend, t1.d_following_holiday, t1.d_first_dom, t1.d_last_dom, t1.d_same_day_ly, t1.d_same_day_lq, t1.d_current_day, t1.d_current_week, t1.d_current_month, t1.d_current_quarter, t1.d_current_year\nFROM (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 11) AS t1\nINNER JOIN (SELECT store_sales.ss_sold_date_sk, store_sales.ss_sold_time_sk, store_sales.ss_item_sk, store_sales.ss_customer_sk, store_sales.ss_cdemo_sk, store_sales.ss_hdemo_sk, store_sales.ss_addr_sk, store_sales.ss_store_sk, store_sales.ss_promo_sk, store_sales.ss_ticket_number, store_sales.ss_quantity, store_sales.ss_wholesale_cost, store_sales.ss_list_price, store_sales.ss_sales_price, store_sales.ss_ext_discount_amt, store_sales.ss_ext_sales_price, store_sales.ss_ext_wholesale_cost, store_sales.ss_ext_list_price, store_sales.ss_ext_tax, store_sales.ss_coupon_amt, store_sales.ss_net_paid, store_sales.ss_net_paid_inc_tax, store_sales.ss_net_profit, t3.s_store_sk, t3.s_store_id, t3.s_rec_start_date, t3.s_rec_end_date, t3.s_closed_date_sk, t3.s_store_name, t3.s_number_employees, t3.s_floor_space, t3.s_hours, t3.s_manager, t3.s_market_id, t3.s_geography_class, t3.s_market_desc, t3.s_market_manager, t3.s_division_id, t3.s_division_name, t3.s_company_id, t3.s_company_name, t3.s_street_number, t3.s_street_name, t3.s_street_type, t3.s_suite_number, t3.s_city, t3.s_county, t3.s_state, t3.s_zip, t3.s_country, t3.s_gmt_offset, t3.s_tax_percentage, t2.p_promo_sk, t2.p_promo_id, t2.p_start_date_sk, t2.p_end_date_sk, t2.p_item_sk, t2.p_cost, t2.p_response_target, t2.p_promo_name, t2.p_channel_dmail, t2.p_channel_email, t2.p_channel_catalog, t2.p_channel_tv, t2.p_channel_radio, t2.p_channel_press, t2.p_channel_event, t2.p_channel_demo, t2.p_channel_details, t2.p_purpose, t2.p_discount_active\nFROM (SELECT *\nFROM promotion\nWHERE p_channel_dmail \u003d \u0027Y\u0027 OR p_channel_email \u003d \u0027Y\u0027 OR p_channel_tv \u003d \u0027Y\u0027) AS t2\nINNER JOIN (store_sales INNER JOIN (SELECT *\nFROM store\nWHERE s_gmt_offset \u003d -5) AS t3 ON store_sales.ss_store_sk \u003d t3.s_store_sk) ON t2.p_promo_sk \u003d store_sales.ss_promo_sk) AS t4 ON t1.d_date_sk \u003d t4.ss_sold_date_sk) AS t5 ON customer.c_customer_sk \u003d t5.ss_customer_sk) AS t6 ON t0.ca_address_sk \u003d t6.c_current_addr_sk) AS t7 ON t.i_item_sk \u003d t7.ss_item_sk) AS t10,\n(SELECT SUM(t17.ss_ext_sales_price) AS TOTAL\nFROM (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Jewelry\u0027) AS t11\nINNER JOIN (SELECT t16.ss_sold_date_sk, t16.ss_sold_time_sk, t16.ss_item_sk, t16.ss_customer_sk, t16.ss_cdemo_sk, t16.ss_hdemo_sk, t16.ss_addr_sk, t16.ss_store_sk, t16.ss_promo_sk, t16.ss_ticket_number, t16.ss_quantity, t16.ss_wholesale_cost, t16.ss_list_price, t16.ss_sales_price, t16.ss_ext_discount_amt, t16.ss_ext_sales_price, t16.ss_ext_wholesale_cost, t16.ss_ext_list_price, t16.ss_ext_tax, t16.ss_coupon_amt, t16.ss_net_paid, t16.ss_net_paid_inc_tax, t16.ss_net_profit, t16.s_store_sk, t16.s_store_id, t16.s_rec_start_date, t16.s_rec_end_date, t16.s_closed_date_sk, t16.s_store_name, t16.s_number_employees, t16.s_floor_space, t16.s_hours, t16.s_manager, t16.s_market_id, t16.s_geography_class, t16.s_market_desc, t16.s_market_manager, t16.s_division_id, t16.s_division_name, t16.s_company_id, t16.s_company_name, t16.s_street_number, t16.s_street_name, t16.s_street_type, t16.s_suite_number, t16.s_city, t16.s_county, t16.s_state, t16.s_zip, t16.s_country, t16.s_gmt_offset, t16.s_tax_percentage, t16.d_date_sk, t16.d_date_id, t16.d_date, t16.d_month_seq, t16.d_week_seq, t16.d_quarter_seq, t16.d_year, t16.d_dow, t16.d_moy, t16.d_dom, t16.d_qoy, t16.d_fy_year, t16.d_fy_quarter_seq, t16.d_fy_week_seq, t16.d_day_name, t16.d_quarter_name, t16.d_holiday, t16.d_weekend, t16.d_following_holiday, t16.d_first_dom, t16.d_last_dom, t16.d_same_day_ly, t16.d_same_day_lq, t16.d_current_day, t16.d_current_week, t16.d_current_month, t16.d_current_quarter, t16.d_current_year, t16.c_customer_sk, t16.c_customer_id, t16.c_current_cdemo_sk, t16.c_current_hdemo_sk, t16.c_current_addr_sk, t16.c_first_shipto_date_sk, t16.c_first_sales_date_sk, t16.c_salutation, t16.c_first_name, t16.c_last_name, t16.c_preferred_cust_flag, t16.c_birth_day, t16.c_birth_month, t16.c_birth_year, t16.c_birth_country, t16.c_login, t16.c_email_address, t16.c_last_review_date_sk, t12.ca_address_sk, t12.ca_address_id, t12.ca_street_number, t12.ca_street_name, t12.ca_street_type, t12.ca_suite_number, t12.ca_city, t12.ca_county, t12.ca_state, t12.ca_zip, t12.ca_country, t12.ca_gmt_offset, t12.ca_location_type\nFROM (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -5) AS t12\nINNER JOIN (SELECT t15.ss_sold_date_sk, t15.ss_sold_time_sk, t15.ss_item_sk, t15.ss_customer_sk, t15.ss_cdemo_sk, t15.ss_hdemo_sk, t15.ss_addr_sk, t15.ss_store_sk, t15.ss_promo_sk, t15.ss_ticket_number, t15.ss_quantity, t15.ss_wholesale_cost, t15.ss_list_price, t15.ss_sales_price, t15.ss_ext_discount_amt, t15.ss_ext_sales_price, t15.ss_ext_wholesale_cost, t15.ss_ext_list_price, t15.ss_ext_tax, t15.ss_coupon_amt, t15.ss_net_paid, t15.ss_net_paid_inc_tax, t15.ss_net_profit, t15.s_store_sk, t15.s_store_id, t15.s_rec_start_date, t15.s_rec_end_date, t15.s_closed_date_sk, t15.s_store_name, t15.s_number_employees, t15.s_floor_space, t15.s_hours, t15.s_manager, t15.s_market_id, t15.s_geography_class, t15.s_market_desc, t15.s_market_manager, t15.s_division_id, t15.s_division_name, t15.s_company_id, t15.s_company_name, t15.s_street_number, t15.s_street_name, t15.s_street_type, t15.s_suite_number, t15.s_city, t15.s_county, t15.s_state, t15.s_zip, t15.s_country, t15.s_gmt_offset, t15.s_tax_percentage, t15.d_date_sk, t15.d_date_id, t15.d_date, t15.d_month_seq, t15.d_week_seq, t15.d_quarter_seq, t15.d_year, t15.d_dow, t15.d_moy, t15.d_dom, t15.d_qoy, t15.d_fy_year, t15.d_fy_quarter_seq, t15.d_fy_week_seq, t15.d_day_name, t15.d_quarter_name, t15.d_holiday, t15.d_weekend, t15.d_following_holiday, t15.d_first_dom, t15.d_last_dom, t15.d_same_day_ly, t15.d_same_day_lq, t15.d_current_day, t15.d_current_week, t15.d_current_month, t15.d_current_quarter, t15.d_current_year, customer0.c_customer_sk, customer0.c_customer_id, customer0.c_current_cdemo_sk, customer0.c_current_hdemo_sk, customer0.c_current_addr_sk, customer0.c_first_shipto_date_sk, customer0.c_first_sales_date_sk, customer0.c_salutation, customer0.c_first_name, customer0.c_last_name, customer0.c_preferred_cust_flag, customer0.c_birth_day, customer0.c_birth_month, customer0.c_birth_year, customer0.c_birth_country, customer0.c_login, customer0.c_email_address, customer0.c_last_review_date_sk\nFROM customer AS customer0\nINNER JOIN (SELECT store_sales0.ss_sold_date_sk, store_sales0.ss_sold_time_sk, store_sales0.ss_item_sk, store_sales0.ss_customer_sk, store_sales0.ss_cdemo_sk, store_sales0.ss_hdemo_sk, store_sales0.ss_addr_sk, store_sales0.ss_store_sk, store_sales0.ss_promo_sk, store_sales0.ss_ticket_number, store_sales0.ss_quantity, store_sales0.ss_wholesale_cost, store_sales0.ss_list_price, store_sales0.ss_sales_price, store_sales0.ss_ext_discount_amt, store_sales0.ss_ext_sales_price, store_sales0.ss_ext_wholesale_cost, store_sales0.ss_ext_list_price, store_sales0.ss_ext_tax, store_sales0.ss_coupon_amt, store_sales0.ss_net_paid, store_sales0.ss_net_paid_inc_tax, store_sales0.ss_net_profit, t14.s_store_sk, t14.s_store_id, t14.s_rec_start_date, t14.s_rec_end_date, t14.s_closed_date_sk, t14.s_store_name, t14.s_number_employees, t14.s_floor_space, t14.s_hours, t14.s_manager, t14.s_market_id, t14.s_geography_class, t14.s_market_desc, t14.s_market_manager, t14.s_division_id, t14.s_division_name, t14.s_company_id, t14.s_company_name, t14.s_street_number, t14.s_street_name, t14.s_street_type, t14.s_suite_number, t14.s_city, t14.s_county, t14.s_state, t14.s_zip, t14.s_country, t14.s_gmt_offset, t14.s_tax_percentage, t13.d_date_sk, t13.d_date_id, t13.d_date, t13.d_month_seq, t13.d_week_seq, t13.d_quarter_seq, t13.d_year, t13.d_dow, t13.d_moy, t13.d_dom, t13.d_qoy, t13.d_fy_year, t13.d_fy_quarter_seq, t13.d_fy_week_seq, t13.d_day_name, t13.d_quarter_name, t13.d_holiday, t13.d_weekend, t13.d_following_holiday, t13.d_first_dom, t13.d_last_dom, t13.d_same_day_ly, t13.d_same_day_lq, t13.d_current_day, t13.d_current_week, t13.d_current_month, t13.d_current_quarter, t13.d_current_year\nFROM store_sales AS store_sales0\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 11) AS t13 ON store_sales0.ss_sold_date_sk \u003d t13.d_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_gmt_offset \u003d -5) AS t14 ON store_sales0.ss_store_sk \u003d t14.s_store_sk) AS t15 ON customer0.c_customer_sk \u003d t15.ss_customer_sk) AS t16 ON t12.ca_address_sk \u003d t16.c_current_addr_sk) AS t17 ON t11.i_item_sk \u003d t17.ss_item_sk) AS t20\nORDER BY t10.PROMOTIONS, t20.TOTAL\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      23,
      23
    ],
    "optimizedTimesMs": [
      30,
      33
    ],
    "originalAvgMs": 23,
    "optimizedAvgMs": 31,
    "speedup": 0.7419354838709677,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q62",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"30\"",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "AGGREGATE_CASE_TO_FILTER",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t.W_SUBSTR, ship_mode.sm_type AS SM_TYPE, web_site.web_name AS WEB_NAME, SUM(CASE WHEN web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk \u003c\u003d 30 THEN 1 ELSE 0 END) AS 30 days, SUM(CASE WHEN web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk \u003e 30 AND web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk \u003c\u003d 60 THEN 1 ELSE 0 END) AS 31-60 days, SUM(CASE WHEN web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk \u003e 60 AND web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk \u003c\u003d 90 THEN 1 ELSE 0 END) AS 61-90 days, SUM(CASE WHEN web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk \u003e 90 AND web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk \u003c\u003d 120 THEN 1 ELSE 0 END) AS 91-120 days, SUM(CASE WHEN web_sales.ws_ship_date_sk - web_sales.ws_sold_date_sk \u003e 120 THEN 1 ELSE 0 END) AS \u003e120 days\nFROM web_sales\nINNER JOIN (SELECT SUBSTRING(w_warehouse_name, 1, 20) AS W_SUBSTR, w_warehouse_sk, w_warehouse_id, w_warehouse_name, w_warehouse_sq_ft, w_street_number, w_street_name, w_street_type, w_suite_number, w_city, w_county, w_state, w_zip, w_country, w_gmt_offset\nFROM warehouse) AS t ON web_sales.ws_warehouse_sk \u003d t.w_warehouse_sk\nINNER JOIN ship_mode ON web_sales.ws_ship_mode_sk \u003d ship_mode.sm_ship_mode_sk\nINNER JOIN web_site ON web_sales.ws_web_site_sk \u003d web_site.web_site_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t0 ON web_sales.ws_ship_date_sk \u003d t0.d_date_sk\nGROUP BY t.W_SUBSTR, ship_mode.sm_type, web_site.web_name\nORDER BY t.W_SUBSTR NULLS FIRST, ship_mode.sm_type NULLS FIRST, web_site.web_name NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q63",
    "status": "error",
    "error": "class org.apache.calcite.sql.SqlBasicCall: AVG(SUM(`SS_SALES_PRICE`))",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q64",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "JOIN_TO_MULTI_JOIN",
      "MULTI_JOIN_OPTIMIZE",
      "AGGREGATE_JOIN_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t22.PRODUCT_NAME, t22.STORE_NAME, t22.STORE_ZIP, t22.B_STREET_NUMBER, t22.B_STREET_NAME, t22.B_CITY, t22.B_ZIP, t22.C_STREET_NUMBER, t22.C_STREET_NAME, t22.C_CITY, t22.C_ZIP, t22.SYEAR AS CS1SYEAR, t22.CNT AS CS1CNT, t22.S1 AS S11, t22.S2 AS S21, t22.S3 AS S31, t46.S1 AS S12, t46.S2 AS S22, t46.S3 AS S32, t46.SYEAR, t46.CNT\nFROM (SELECT t.i_product_name AS PRODUCT_NAME, t.i_item_sk AS ITEM_SK, t17.s_store_name AS STORE_NAME, t17.s_zip AS STORE_ZIP, t17.ca_street_number AS B_STREET_NUMBER, t17.ca_street_name AS B_STREET_NAME, t17.ca_city AS B_CITY, t17.ca_zip AS B_ZIP, t17.ca_street_number0 AS C_STREET_NUMBER, t17.ca_street_name0 AS C_STREET_NAME, t17.ca_city0 AS C_CITY, t17.ca_zip0 AS C_ZIP, t17.d_year AS SYEAR, t17.d_year0 AS FSYEAR, t17.d_year1 AS S2YEAR, COUNT(*) AS CNT, SUM(t17.ss_wholesale_cost) AS S1, SUM(t17.ss_list_price) AS S2, SUM(t17.ss_coupon_amt) AS S3\nFROM (SELECT *\nFROM item\nWHERE i_color IN (\u0027burlywood\u0027, \u0027floral\u0027, \u0027indian\u0027, \u0027medium\u0027, \u0027purple\u0027, \u0027spring\u0027) AND i_current_price \u003e\u003d 64 AND i_current_price \u003c\u003d 64 + 10 AND i_current_price \u003e\u003d 64 + 1 AND i_current_price \u003c\u003d 64 + 15) AS t\nINNER JOIN (SELECT t16.ss_sold_date_sk, t16.ss_sold_time_sk, t16.ss_item_sk, t16.ss_customer_sk, t16.ss_cdemo_sk, t16.ss_hdemo_sk, t16.ss_addr_sk, t16.ss_store_sk, t16.ss_promo_sk, t16.ss_ticket_number, t16.ss_quantity, t16.ss_wholesale_cost, t16.ss_list_price, t16.ss_sales_price, t16.ss_ext_discount_amt, t16.ss_ext_sales_price, t16.ss_ext_wholesale_cost, t16.ss_ext_list_price, t16.ss_ext_tax, t16.ss_coupon_amt, t16.ss_net_paid, t16.ss_net_paid_inc_tax, t16.ss_net_profit, t16.sr_returned_date_sk, t16.sr_return_time_sk, t16.sr_item_sk, t16.sr_customer_sk, t16.sr_cdemo_sk, t16.sr_hdemo_sk, t16.sr_addr_sk, t16.sr_store_sk, t16.sr_reason_sk, t16.sr_ticket_number, t16.sr_return_quantity, t16.sr_return_amt, t16.sr_return_tax, t16.sr_return_amt_inc_tax, t16.sr_fee, t16.sr_return_ship_cost, t16.sr_refunded_cash, t16.sr_reversed_charge, t16.sr_store_credit, t16.sr_net_loss, t16.CS_ITEM_SK, t16.SALE, t16.REFUND, t16.d_date_sk, t16.d_date_id, t16.d_date, t16.d_month_seq, t16.d_week_seq, t16.d_quarter_seq, t16.d_year, t16.d_dow, t16.d_moy, t16.d_dom, t16.d_qoy, t16.d_fy_year, t16.d_fy_quarter_seq, t16.d_fy_week_seq, t16.d_day_name, t16.d_quarter_name, t16.d_holiday, t16.d_weekend, t16.d_following_holiday, t16.d_first_dom, t16.d_last_dom, t16.d_same_day_ly, t16.d_same_day_lq, t16.d_current_day, t16.d_current_week, t16.d_current_month, t16.d_current_quarter, t16.d_current_year, t16.d_date_sk0, t16.d_date_id0, t16.d_date0, t16.d_month_seq0, t16.d_week_seq0, t16.d_quarter_seq0, t16.d_year0, t16.d_dow0, t16.d_moy0, t16.d_dom0, t16.d_qoy0, t16.d_fy_year0, t16.d_fy_quarter_seq0, t16.d_fy_week_seq0, t16.d_day_name0, t16.d_quarter_name0, t16.d_holiday0, t16.d_weekend0, t16.d_following_holiday0, t16.d_first_dom0, t16.d_last_dom0, t16.d_same_day_ly0, t16.d_same_day_lq0, t16.d_current_day0, t16.d_current_week0, t16.d_current_month0, t16.d_current_quarter0, t16.d_current_year0, t16.d_date_sk1, t16.d_date_id1, t16.d_date1, t16.d_month_seq1, t16.d_week_seq1, t16.d_quarter_seq1, t16.d_year1, t16.d_dow1, t16.d_moy1, t16.d_dom1, t16.d_qoy1, t16.d_fy_year1, t16.d_fy_quarter_seq1, t16.d_fy_week_seq1, t16.d_day_name1, t16.d_quarter_name1, t16.d_holiday1, t16.d_weekend1, t16.d_following_holiday1, t16.d_first_dom1, t16.d_last_dom1, t16.d_same_day_ly1, t16.d_same_day_lq1, t16.d_current_day1, t16.d_current_week1, t16.d_current_month1, t16.d_current_quarter1, t16.d_current_year1, t16.s_store_sk, t16.s_store_id, t16.s_rec_start_date, t16.s_rec_end_date, t16.s_closed_date_sk, t16.s_store_name, t16.s_number_employees, t16.s_floor_space, t16.s_hours, t16.s_manager, t16.s_market_id, t16.s_geography_class, t16.s_market_desc, t16.s_market_manager, t16.s_division_id, t16.s_division_name, t16.s_company_id, t16.s_company_name, t16.s_street_number, t16.s_street_name, t16.s_street_type, t16.s_suite_number, t16.s_city, t16.s_county, t16.s_state, t16.s_zip, t16.s_country, t16.s_gmt_offset, t16.s_tax_percentage, t16.c_customer_sk, t16.c_customer_id, t16.c_current_cdemo_sk, t16.c_current_hdemo_sk, t16.c_current_addr_sk, t16.c_first_shipto_date_sk, t16.c_first_sales_date_sk, t16.c_salutation, t16.c_first_name, t16.c_last_name, t16.c_preferred_cust_flag, t16.c_birth_day, t16.c_birth_month, t16.c_birth_year, t16.c_birth_country, t16.c_login, t16.c_email_address, t16.c_last_review_date_sk, t16.cd_demo_sk, t16.cd_gender, t16.cd_marital_status, t16.cd_education_status, t16.cd_purchase_estimate, t16.cd_credit_rating, t16.cd_dep_count, t16.cd_dep_employed_count, t16.cd_dep_college_count, t16.cd_demo_sk0, t16.cd_gender0, t16.cd_marital_status0, t16.cd_education_status0, t16.cd_purchase_estimate0, t16.cd_credit_rating0, t16.cd_dep_count0, t16.cd_dep_employed_count0, t16.cd_dep_college_count0, t16.p_promo_sk, t16.p_promo_id, t16.p_start_date_sk, t16.p_end_date_sk, t16.p_item_sk, t16.p_cost, t16.p_response_target, t16.p_promo_name, t16.p_channel_dmail, t16.p_channel_email, t16.p_channel_catalog, t16.p_channel_tv, t16.p_channel_radio, t16.p_channel_press, t16.p_channel_event, t16.p_channel_demo, t16.p_channel_details, t16.p_purpose, t16.p_discount_active, t16.hd_demo_sk, t16.hd_income_band_sk, t16.hd_buy_potential, t16.hd_dep_count, t16.hd_vehicle_count, t16.hd_demo_sk0, t16.hd_income_band_sk0, t16.hd_buy_potential0, t16.hd_dep_count0, t16.hd_vehicle_count0, t16.ca_address_sk, t16.ca_address_id, t16.ca_street_number, t16.ca_street_name, t16.ca_street_type, t16.ca_suite_number, t16.ca_city, t16.ca_county, t16.ca_state, t16.ca_zip, t16.ca_country, t16.ca_gmt_offset, t16.ca_location_type, t16.ca_address_sk0, t16.ca_address_id0, t16.ca_street_number0, t16.ca_street_name0, t16.ca_street_type0, t16.ca_suite_number0, t16.ca_city0, t16.ca_county0, t16.ca_state0, t16.ca_zip0, t16.ca_country0, t16.ca_gmt_offset0, t16.ca_location_type0, t16.ib_income_band_sk, t16.ib_lower_bound, t16.ib_upper_bound, income_band.ib_income_band_sk AS ib_income_band_sk0, income_band.ib_lower_bound AS ib_lower_bound0, income_band.ib_upper_bound AS ib_upper_bound0\nFROM income_band\nINNER JOIN (SELECT t15.ss_sold_date_sk, t15.ss_sold_time_sk, t15.ss_item_sk, t15.ss_customer_sk, t15.ss_cdemo_sk, t15.ss_hdemo_sk, t15.ss_addr_sk, t15.ss_store_sk, t15.ss_promo_sk, t15.ss_ticket_number, t15.ss_quantity, t15.ss_wholesale_cost, t15.ss_list_price, t15.ss_sales_price, t15.ss_ext_discount_amt, t15.ss_ext_sales_price, t15.ss_ext_wholesale_cost, t15.ss_ext_list_price, t15.ss_ext_tax, t15.ss_coupon_amt, t15.ss_net_paid, t15.ss_net_paid_inc_tax, t15.ss_net_profit, t15.sr_returned_date_sk, t15.sr_return_time_sk, t15.sr_item_sk, t15.sr_customer_sk, t15.sr_cdemo_sk, t15.sr_hdemo_sk, t15.sr_addr_sk, t15.sr_store_sk, t15.sr_reason_sk, t15.sr_ticket_number, t15.sr_return_quantity, t15.sr_return_amt, t15.sr_return_tax, t15.sr_return_amt_inc_tax, t15.sr_fee, t15.sr_return_ship_cost, t15.sr_refunded_cash, t15.sr_reversed_charge, t15.sr_store_credit, t15.sr_net_loss, t15.CS_ITEM_SK, t15.SALE, t15.REFUND, t15.d_date_sk, t15.d_date_id, t15.d_date, t15.d_month_seq, t15.d_week_seq, t15.d_quarter_seq, t15.d_year, t15.d_dow, t15.d_moy, t15.d_dom, t15.d_qoy, t15.d_fy_year, t15.d_fy_quarter_seq, t15.d_fy_week_seq, t15.d_day_name, t15.d_quarter_name, t15.d_holiday, t15.d_weekend, t15.d_following_holiday, t15.d_first_dom, t15.d_last_dom, t15.d_same_day_ly, t15.d_same_day_lq, t15.d_current_day, t15.d_current_week, t15.d_current_month, t15.d_current_quarter, t15.d_current_year, t15.d_date_sk0, t15.d_date_id0, t15.d_date0, t15.d_month_seq0, t15.d_week_seq0, t15.d_quarter_seq0, t15.d_year0, t15.d_dow0, t15.d_moy0, t15.d_dom0, t15.d_qoy0, t15.d_fy_year0, t15.d_fy_quarter_seq0, t15.d_fy_week_seq0, t15.d_day_name0, t15.d_quarter_name0, t15.d_holiday0, t15.d_weekend0, t15.d_following_holiday0, t15.d_first_dom0, t15.d_last_dom0, t15.d_same_day_ly0, t15.d_same_day_lq0, t15.d_current_day0, t15.d_current_week0, t15.d_current_month0, t15.d_current_quarter0, t15.d_current_year0, t15.d_date_sk1, t15.d_date_id1, t15.d_date1, t15.d_month_seq1, t15.d_week_seq1, t15.d_quarter_seq1, t15.d_year1, t15.d_dow1, t15.d_moy1, t15.d_dom1, t15.d_qoy1, t15.d_fy_year1, t15.d_fy_quarter_seq1, t15.d_fy_week_seq1, t15.d_day_name1, t15.d_quarter_name1, t15.d_holiday1, t15.d_weekend1, t15.d_following_holiday1, t15.d_first_dom1, t15.d_last_dom1, t15.d_same_day_ly1, t15.d_same_day_lq1, t15.d_current_day1, t15.d_current_week1, t15.d_current_month1, t15.d_current_quarter1, t15.d_current_year1, t15.s_store_sk, t15.s_store_id, t15.s_rec_start_date, t15.s_rec_end_date, t15.s_closed_date_sk, t15.s_store_name, t15.s_number_employees, t15.s_floor_space, t15.s_hours, t15.s_manager, t15.s_market_id, t15.s_geography_class, t15.s_market_desc, t15.s_market_manager, t15.s_division_id, t15.s_division_name, t15.s_company_id, t15.s_company_name, t15.s_street_number, t15.s_street_name, t15.s_street_type, t15.s_suite_number, t15.s_city, t15.s_county, t15.s_state, t15.s_zip, t15.s_country, t15.s_gmt_offset, t15.s_tax_percentage, t15.c_customer_sk, t15.c_customer_id, t15.c_current_cdemo_sk, t15.c_current_hdemo_sk, t15.c_current_addr_sk, t15.c_first_shipto_date_sk, t15.c_first_sales_date_sk, t15.c_salutation, t15.c_first_name, t15.c_last_name, t15.c_preferred_cust_flag, t15.c_birth_day, t15.c_birth_month, t15.c_birth_year, t15.c_birth_country, t15.c_login, t15.c_email_address, t15.c_last_review_date_sk, t15.cd_demo_sk, t15.cd_gender, t15.cd_marital_status, t15.cd_education_status, t15.cd_purchase_estimate, t15.cd_credit_rating, t15.cd_dep_count, t15.cd_dep_employed_count, t15.cd_dep_college_count, t15.cd_demo_sk0, t15.cd_gender0, t15.cd_marital_status0, t15.cd_education_status0, t15.cd_purchase_estimate0, t15.cd_credit_rating0, t15.cd_dep_count0, t15.cd_dep_employed_count0, t15.cd_dep_college_count0, t15.p_promo_sk, t15.p_promo_id, t15.p_start_date_sk, t15.p_end_date_sk, t15.p_item_sk, t15.p_cost, t15.p_response_target, t15.p_promo_name, t15.p_channel_dmail, t15.p_channel_email, t15.p_channel_catalog, t15.p_channel_tv, t15.p_channel_radio, t15.p_channel_press, t15.p_channel_event, t15.p_channel_demo, t15.p_channel_details, t15.p_purpose, t15.p_discount_active, t15.hd_demo_sk, t15.hd_income_band_sk, t15.hd_buy_potential, t15.hd_dep_count, t15.hd_vehicle_count, t15.hd_demo_sk0, t15.hd_income_band_sk0, t15.hd_buy_potential0, t15.hd_dep_count0, t15.hd_vehicle_count0, t15.ca_address_sk, t15.ca_address_id, t15.ca_street_number, t15.ca_street_name, t15.ca_street_type, t15.ca_suite_number, t15.ca_city, t15.ca_county, t15.ca_state, t15.ca_zip, t15.ca_country, t15.ca_gmt_offset, t15.ca_location_type, t15.ca_address_sk0, t15.ca_address_id0, t15.ca_street_number0, t15.ca_street_name0, t15.ca_street_type0, t15.ca_suite_number0, t15.ca_city0, t15.ca_county0, t15.ca_state0, t15.ca_zip0, t15.ca_country0, t15.ca_gmt_offset0, t15.ca_location_type0, income_band0.ib_income_band_sk, income_band0.ib_lower_bound, income_band0.ib_upper_bound\nFROM income_band AS income_band0\nINNER JOIN (SELECT t14.ss_sold_date_sk, t14.ss_sold_time_sk, t14.ss_item_sk, t14.ss_customer_sk, t14.ss_cdemo_sk, t14.ss_hdemo_sk, t14.ss_addr_sk, t14.ss_store_sk, t14.ss_promo_sk, t14.ss_ticket_number, t14.ss_quantity, t14.ss_wholesale_cost, t14.ss_list_price, t14.ss_sales_price, t14.ss_ext_discount_amt, t14.ss_ext_sales_price, t14.ss_ext_wholesale_cost, t14.ss_ext_list_price, t14.ss_ext_tax, t14.ss_coupon_amt, t14.ss_net_paid, t14.ss_net_paid_inc_tax, t14.ss_net_profit, t14.sr_returned_date_sk, t14.sr_return_time_sk, t14.sr_item_sk, t14.sr_customer_sk, t14.sr_cdemo_sk, t14.sr_hdemo_sk, t14.sr_addr_sk, t14.sr_store_sk, t14.sr_reason_sk, t14.sr_ticket_number, t14.sr_return_quantity, t14.sr_return_amt, t14.sr_return_tax, t14.sr_return_amt_inc_tax, t14.sr_fee, t14.sr_return_ship_cost, t14.sr_refunded_cash, t14.sr_reversed_charge, t14.sr_store_credit, t14.sr_net_loss, t14.CS_ITEM_SK, t14.SALE, t14.REFUND, t14.d_date_sk, t14.d_date_id, t14.d_date, t14.d_month_seq, t14.d_week_seq, t14.d_quarter_seq, t14.d_year, t14.d_dow, t14.d_moy, t14.d_dom, t14.d_qoy, t14.d_fy_year, t14.d_fy_quarter_seq, t14.d_fy_week_seq, t14.d_day_name, t14.d_quarter_name, t14.d_holiday, t14.d_weekend, t14.d_following_holiday, t14.d_first_dom, t14.d_last_dom, t14.d_same_day_ly, t14.d_same_day_lq, t14.d_current_day, t14.d_current_week, t14.d_current_month, t14.d_current_quarter, t14.d_current_year, t14.d_date_sk0, t14.d_date_id0, t14.d_date0, t14.d_month_seq0, t14.d_week_seq0, t14.d_quarter_seq0, t14.d_year0, t14.d_dow0, t14.d_moy0, t14.d_dom0, t14.d_qoy0, t14.d_fy_year0, t14.d_fy_quarter_seq0, t14.d_fy_week_seq0, t14.d_day_name0, t14.d_quarter_name0, t14.d_holiday0, t14.d_weekend0, t14.d_following_holiday0, t14.d_first_dom0, t14.d_last_dom0, t14.d_same_day_ly0, t14.d_same_day_lq0, t14.d_current_day0, t14.d_current_week0, t14.d_current_month0, t14.d_current_quarter0, t14.d_current_year0, t14.d_date_sk1, t14.d_date_id1, t14.d_date1, t14.d_month_seq1, t14.d_week_seq1, t14.d_quarter_seq1, t14.d_year1, t14.d_dow1, t14.d_moy1, t14.d_dom1, t14.d_qoy1, t14.d_fy_year1, t14.d_fy_quarter_seq1, t14.d_fy_week_seq1, t14.d_day_name1, t14.d_quarter_name1, t14.d_holiday1, t14.d_weekend1, t14.d_following_holiday1, t14.d_first_dom1, t14.d_last_dom1, t14.d_same_day_ly1, t14.d_same_day_lq1, t14.d_current_day1, t14.d_current_week1, t14.d_current_month1, t14.d_current_quarter1, t14.d_current_year1, t14.s_store_sk, t14.s_store_id, t14.s_rec_start_date, t14.s_rec_end_date, t14.s_closed_date_sk, t14.s_store_name, t14.s_number_employees, t14.s_floor_space, t14.s_hours, t14.s_manager, t14.s_market_id, t14.s_geography_class, t14.s_market_desc, t14.s_market_manager, t14.s_division_id, t14.s_division_name, t14.s_company_id, t14.s_company_name, t14.s_street_number, t14.s_street_name, t14.s_street_type, t14.s_suite_number, t14.s_city, t14.s_county, t14.s_state, t14.s_zip, t14.s_country, t14.s_gmt_offset, t14.s_tax_percentage, t14.c_customer_sk, t14.c_customer_id, t14.c_current_cdemo_sk, t14.c_current_hdemo_sk, t14.c_current_addr_sk, t14.c_first_shipto_date_sk, t14.c_first_sales_date_sk, t14.c_salutation, t14.c_first_name, t14.c_last_name, t14.c_preferred_cust_flag, t14.c_birth_day, t14.c_birth_month, t14.c_birth_year, t14.c_birth_country, t14.c_login, t14.c_email_address, t14.c_last_review_date_sk, t14.cd_demo_sk, t14.cd_gender, t14.cd_marital_status, t14.cd_education_status, t14.cd_purchase_estimate, t14.cd_credit_rating, t14.cd_dep_count, t14.cd_dep_employed_count, t14.cd_dep_college_count, t14.cd_demo_sk0, t14.cd_gender0, t14.cd_marital_status0, t14.cd_education_status0, t14.cd_purchase_estimate0, t14.cd_credit_rating0, t14.cd_dep_count0, t14.cd_dep_employed_count0, t14.cd_dep_college_count0, t14.p_promo_sk, t14.p_promo_id, t14.p_start_date_sk, t14.p_end_date_sk, t14.p_item_sk, t14.p_cost, t14.p_response_target, t14.p_promo_name, t14.p_channel_dmail, t14.p_channel_email, t14.p_channel_catalog, t14.p_channel_tv, t14.p_channel_radio, t14.p_channel_press, t14.p_channel_event, t14.p_channel_demo, t14.p_channel_details, t14.p_purpose, t14.p_discount_active, t14.hd_demo_sk, t14.hd_income_band_sk, t14.hd_buy_potential, t14.hd_dep_count, t14.hd_vehicle_count, t14.hd_demo_sk0, t14.hd_income_band_sk0, t14.hd_buy_potential0, t14.hd_dep_count0, t14.hd_vehicle_count0, t14.ca_address_sk, t14.ca_address_id, t14.ca_street_number, t14.ca_street_name, t14.ca_street_type, t14.ca_suite_number, t14.ca_city, t14.ca_county, t14.ca_state, t14.ca_zip, t14.ca_country, t14.ca_gmt_offset, t14.ca_location_type, customer_address.ca_address_sk AS ca_address_sk0, customer_address.ca_address_id AS ca_address_id0, customer_address.ca_street_number AS ca_street_number0, customer_address.ca_street_name AS ca_street_name0, customer_address.ca_street_type AS ca_street_type0, customer_address.ca_suite_number AS ca_suite_number0, customer_address.ca_city AS ca_city0, customer_address.ca_county AS ca_county0, customer_address.ca_state AS ca_state0, customer_address.ca_zip AS ca_zip0, customer_address.ca_country AS ca_country0, customer_address.ca_gmt_offset AS ca_gmt_offset0, customer_address.ca_location_type AS ca_location_type0\nFROM customer_address\nINNER JOIN (SELECT t13.ss_sold_date_sk, t13.ss_sold_time_sk, t13.ss_item_sk, t13.ss_customer_sk, t13.ss_cdemo_sk, t13.ss_hdemo_sk, t13.ss_addr_sk, t13.ss_store_sk, t13.ss_promo_sk, t13.ss_ticket_number, t13.ss_quantity, t13.ss_wholesale_cost, t13.ss_list_price, t13.ss_sales_price, t13.ss_ext_discount_amt, t13.ss_ext_sales_price, t13.ss_ext_wholesale_cost, t13.ss_ext_list_price, t13.ss_ext_tax, t13.ss_coupon_amt, t13.ss_net_paid, t13.ss_net_paid_inc_tax, t13.ss_net_profit, t13.sr_returned_date_sk, t13.sr_return_time_sk, t13.sr_item_sk, t13.sr_customer_sk, t13.sr_cdemo_sk, t13.sr_hdemo_sk, t13.sr_addr_sk, t13.sr_store_sk, t13.sr_reason_sk, t13.sr_ticket_number, t13.sr_return_quantity, t13.sr_return_amt, t13.sr_return_tax, t13.sr_return_amt_inc_tax, t13.sr_fee, t13.sr_return_ship_cost, t13.sr_refunded_cash, t13.sr_reversed_charge, t13.sr_store_credit, t13.sr_net_loss, t13.CS_ITEM_SK, t13.SALE, t13.REFUND, t13.d_date_sk, t13.d_date_id, t13.d_date, t13.d_month_seq, t13.d_week_seq, t13.d_quarter_seq, t13.d_year, t13.d_dow, t13.d_moy, t13.d_dom, t13.d_qoy, t13.d_fy_year, t13.d_fy_quarter_seq, t13.d_fy_week_seq, t13.d_day_name, t13.d_quarter_name, t13.d_holiday, t13.d_weekend, t13.d_following_holiday, t13.d_first_dom, t13.d_last_dom, t13.d_same_day_ly, t13.d_same_day_lq, t13.d_current_day, t13.d_current_week, t13.d_current_month, t13.d_current_quarter, t13.d_current_year, t13.d_date_sk0, t13.d_date_id0, t13.d_date0, t13.d_month_seq0, t13.d_week_seq0, t13.d_quarter_seq0, t13.d_year0, t13.d_dow0, t13.d_moy0, t13.d_dom0, t13.d_qoy0, t13.d_fy_year0, t13.d_fy_quarter_seq0, t13.d_fy_week_seq0, t13.d_day_name0, t13.d_quarter_name0, t13.d_holiday0, t13.d_weekend0, t13.d_following_holiday0, t13.d_first_dom0, t13.d_last_dom0, t13.d_same_day_ly0, t13.d_same_day_lq0, t13.d_current_day0, t13.d_current_week0, t13.d_current_month0, t13.d_current_quarter0, t13.d_current_year0, t13.d_date_sk1, t13.d_date_id1, t13.d_date1, t13.d_month_seq1, t13.d_week_seq1, t13.d_quarter_seq1, t13.d_year1, t13.d_dow1, t13.d_moy1, t13.d_dom1, t13.d_qoy1, t13.d_fy_year1, t13.d_fy_quarter_seq1, t13.d_fy_week_seq1, t13.d_day_name1, t13.d_quarter_name1, t13.d_holiday1, t13.d_weekend1, t13.d_following_holiday1, t13.d_first_dom1, t13.d_last_dom1, t13.d_same_day_ly1, t13.d_same_day_lq1, t13.d_current_day1, t13.d_current_week1, t13.d_current_month1, t13.d_current_quarter1, t13.d_current_year1, t13.s_store_sk, t13.s_store_id, t13.s_rec_start_date, t13.s_rec_end_date, t13.s_closed_date_sk, t13.s_store_name, t13.s_number_employees, t13.s_floor_space, t13.s_hours, t13.s_manager, t13.s_market_id, t13.s_geography_class, t13.s_market_desc, t13.s_market_manager, t13.s_division_id, t13.s_division_name, t13.s_company_id, t13.s_company_name, t13.s_street_number, t13.s_street_name, t13.s_street_type, t13.s_suite_number, t13.s_city, t13.s_county, t13.s_state, t13.s_zip, t13.s_country, t13.s_gmt_offset, t13.s_tax_percentage, t13.c_customer_sk, t13.c_customer_id, t13.c_current_cdemo_sk, t13.c_current_hdemo_sk, t13.c_current_addr_sk, t13.c_first_shipto_date_sk, t13.c_first_sales_date_sk, t13.c_salutation, t13.c_first_name, t13.c_last_name, t13.c_preferred_cust_flag, t13.c_birth_day, t13.c_birth_month, t13.c_birth_year, t13.c_birth_country, t13.c_login, t13.c_email_address, t13.c_last_review_date_sk, t13.cd_demo_sk, t13.cd_gender, t13.cd_marital_status, t13.cd_education_status, t13.cd_purchase_estimate, t13.cd_credit_rating, t13.cd_dep_count, t13.cd_dep_employed_count, t13.cd_dep_college_count, t13.cd_demo_sk0, t13.cd_gender0, t13.cd_marital_status0, t13.cd_education_status0, t13.cd_purchase_estimate0, t13.cd_credit_rating0, t13.cd_dep_count0, t13.cd_dep_employed_count0, t13.cd_dep_college_count0, t13.p_promo_sk, t13.p_promo_id, t13.p_start_date_sk, t13.p_end_date_sk, t13.p_item_sk, t13.p_cost, t13.p_response_target, t13.p_promo_name, t13.p_channel_dmail, t13.p_channel_email, t13.p_channel_catalog, t13.p_channel_tv, t13.p_channel_radio, t13.p_channel_press, t13.p_channel_event, t13.p_channel_demo, t13.p_channel_details, t13.p_purpose, t13.p_discount_active, t13.hd_demo_sk, t13.hd_income_band_sk, t13.hd_buy_potential, t13.hd_dep_count, t13.hd_vehicle_count, t13.hd_demo_sk0, t13.hd_income_band_sk0, t13.hd_buy_potential0, t13.hd_dep_count0, t13.hd_vehicle_count0, customer_address0.ca_address_sk, customer_address0.ca_address_id, customer_address0.ca_street_number, customer_address0.ca_street_name, customer_address0.ca_street_type, customer_address0.ca_suite_number, customer_address0.ca_city, customer_address0.ca_county, customer_address0.ca_state, customer_address0.ca_zip, customer_address0.ca_country, customer_address0.ca_gmt_offset, customer_address0.ca_location_type\nFROM customer_address AS customer_address0\nINNER JOIN (SELECT t12.ss_sold_date_sk, t12.ss_sold_time_sk, t12.ss_item_sk, t12.ss_customer_sk, t12.ss_cdemo_sk, t12.ss_hdemo_sk, t12.ss_addr_sk, t12.ss_store_sk, t12.ss_promo_sk, t12.ss_ticket_number, t12.ss_quantity, t12.ss_wholesale_cost, t12.ss_list_price, t12.ss_sales_price, t12.ss_ext_discount_amt, t12.ss_ext_sales_price, t12.ss_ext_wholesale_cost, t12.ss_ext_list_price, t12.ss_ext_tax, t12.ss_coupon_amt, t12.ss_net_paid, t12.ss_net_paid_inc_tax, t12.ss_net_profit, t12.sr_returned_date_sk, t12.sr_return_time_sk, t12.sr_item_sk, t12.sr_customer_sk, t12.sr_cdemo_sk, t12.sr_hdemo_sk, t12.sr_addr_sk, t12.sr_store_sk, t12.sr_reason_sk, t12.sr_ticket_number, t12.sr_return_quantity, t12.sr_return_amt, t12.sr_return_tax, t12.sr_return_amt_inc_tax, t12.sr_fee, t12.sr_return_ship_cost, t12.sr_refunded_cash, t12.sr_reversed_charge, t12.sr_store_credit, t12.sr_net_loss, t12.CS_ITEM_SK, t12.SALE, t12.REFUND, t12.d_date_sk, t12.d_date_id, t12.d_date, t12.d_month_seq, t12.d_week_seq, t12.d_quarter_seq, t12.d_year, t12.d_dow, t12.d_moy, t12.d_dom, t12.d_qoy, t12.d_fy_year, t12.d_fy_quarter_seq, t12.d_fy_week_seq, t12.d_day_name, t12.d_quarter_name, t12.d_holiday, t12.d_weekend, t12.d_following_holiday, t12.d_first_dom, t12.d_last_dom, t12.d_same_day_ly, t12.d_same_day_lq, t12.d_current_day, t12.d_current_week, t12.d_current_month, t12.d_current_quarter, t12.d_current_year, t12.d_date_sk0, t12.d_date_id0, t12.d_date0, t12.d_month_seq0, t12.d_week_seq0, t12.d_quarter_seq0, t12.d_year0, t12.d_dow0, t12.d_moy0, t12.d_dom0, t12.d_qoy0, t12.d_fy_year0, t12.d_fy_quarter_seq0, t12.d_fy_week_seq0, t12.d_day_name0, t12.d_quarter_name0, t12.d_holiday0, t12.d_weekend0, t12.d_following_holiday0, t12.d_first_dom0, t12.d_last_dom0, t12.d_same_day_ly0, t12.d_same_day_lq0, t12.d_current_day0, t12.d_current_week0, t12.d_current_month0, t12.d_current_quarter0, t12.d_current_year0, t12.d_date_sk1, t12.d_date_id1, t12.d_date1, t12.d_month_seq1, t12.d_week_seq1, t12.d_quarter_seq1, t12.d_year1, t12.d_dow1, t12.d_moy1, t12.d_dom1, t12.d_qoy1, t12.d_fy_year1, t12.d_fy_quarter_seq1, t12.d_fy_week_seq1, t12.d_day_name1, t12.d_quarter_name1, t12.d_holiday1, t12.d_weekend1, t12.d_following_holiday1, t12.d_first_dom1, t12.d_last_dom1, t12.d_same_day_ly1, t12.d_same_day_lq1, t12.d_current_day1, t12.d_current_week1, t12.d_current_month1, t12.d_current_quarter1, t12.d_current_year1, t12.s_store_sk, t12.s_store_id, t12.s_rec_start_date, t12.s_rec_end_date, t12.s_closed_date_sk, t12.s_store_name, t12.s_number_employees, t12.s_floor_space, t12.s_hours, t12.s_manager, t12.s_market_id, t12.s_geography_class, t12.s_market_desc, t12.s_market_manager, t12.s_division_id, t12.s_division_name, t12.s_company_id, t12.s_company_name, t12.s_street_number, t12.s_street_name, t12.s_street_type, t12.s_suite_number, t12.s_city, t12.s_county, t12.s_state, t12.s_zip, t12.s_country, t12.s_gmt_offset, t12.s_tax_percentage, t12.c_customer_sk, t12.c_customer_id, t12.c_current_cdemo_sk, t12.c_current_hdemo_sk, t12.c_current_addr_sk, t12.c_first_shipto_date_sk, t12.c_first_sales_date_sk, t12.c_salutation, t12.c_first_name, t12.c_last_name, t12.c_preferred_cust_flag, t12.c_birth_day, t12.c_birth_month, t12.c_birth_year, t12.c_birth_country, t12.c_login, t12.c_email_address, t12.c_last_review_date_sk, t12.cd_demo_sk, t12.cd_gender, t12.cd_marital_status, t12.cd_education_status, t12.cd_purchase_estimate, t12.cd_credit_rating, t12.cd_dep_count, t12.cd_dep_employed_count, t12.cd_dep_college_count, t12.cd_demo_sk0, t12.cd_gender0, t12.cd_marital_status0, t12.cd_education_status0, t12.cd_purchase_estimate0, t12.cd_credit_rating0, t12.cd_dep_count0, t12.cd_dep_employed_count0, t12.cd_dep_college_count0, t12.p_promo_sk, t12.p_promo_id, t12.p_start_date_sk, t12.p_end_date_sk, t12.p_item_sk, t12.p_cost, t12.p_response_target, t12.p_promo_name, t12.p_channel_dmail, t12.p_channel_email, t12.p_channel_catalog, t12.p_channel_tv, t12.p_channel_radio, t12.p_channel_press, t12.p_channel_event, t12.p_channel_demo, t12.p_channel_details, t12.p_purpose, t12.p_discount_active, t12.hd_demo_sk, t12.hd_income_band_sk, t12.hd_buy_potential, t12.hd_dep_count, t12.hd_vehicle_count, household_demographics.hd_demo_sk AS hd_demo_sk0, household_demographics.hd_income_band_sk AS hd_income_band_sk0, household_demographics.hd_buy_potential AS hd_buy_potential0, household_demographics.hd_dep_count AS hd_dep_count0, household_demographics.hd_vehicle_count AS hd_vehicle_count0\nFROM household_demographics\nINNER JOIN (SELECT t11.ss_sold_date_sk, t11.ss_sold_time_sk, t11.ss_item_sk, t11.ss_customer_sk, t11.ss_cdemo_sk, t11.ss_hdemo_sk, t11.ss_addr_sk, t11.ss_store_sk, t11.ss_promo_sk, t11.ss_ticket_number, t11.ss_quantity, t11.ss_wholesale_cost, t11.ss_list_price, t11.ss_sales_price, t11.ss_ext_discount_amt, t11.ss_ext_sales_price, t11.ss_ext_wholesale_cost, t11.ss_ext_list_price, t11.ss_ext_tax, t11.ss_coupon_amt, t11.ss_net_paid, t11.ss_net_paid_inc_tax, t11.ss_net_profit, t11.sr_returned_date_sk, t11.sr_return_time_sk, t11.sr_item_sk, t11.sr_customer_sk, t11.sr_cdemo_sk, t11.sr_hdemo_sk, t11.sr_addr_sk, t11.sr_store_sk, t11.sr_reason_sk, t11.sr_ticket_number, t11.sr_return_quantity, t11.sr_return_amt, t11.sr_return_tax, t11.sr_return_amt_inc_tax, t11.sr_fee, t11.sr_return_ship_cost, t11.sr_refunded_cash, t11.sr_reversed_charge, t11.sr_store_credit, t11.sr_net_loss, t11.CS_ITEM_SK, t11.SALE, t11.REFUND, t11.d_date_sk, t11.d_date_id, t11.d_date, t11.d_month_seq, t11.d_week_seq, t11.d_quarter_seq, t11.d_year, t11.d_dow, t11.d_moy, t11.d_dom, t11.d_qoy, t11.d_fy_year, t11.d_fy_quarter_seq, t11.d_fy_week_seq, t11.d_day_name, t11.d_quarter_name, t11.d_holiday, t11.d_weekend, t11.d_following_holiday, t11.d_first_dom, t11.d_last_dom, t11.d_same_day_ly, t11.d_same_day_lq, t11.d_current_day, t11.d_current_week, t11.d_current_month, t11.d_current_quarter, t11.d_current_year, t11.d_date_sk0, t11.d_date_id0, t11.d_date0, t11.d_month_seq0, t11.d_week_seq0, t11.d_quarter_seq0, t11.d_year0, t11.d_dow0, t11.d_moy0, t11.d_dom0, t11.d_qoy0, t11.d_fy_year0, t11.d_fy_quarter_seq0, t11.d_fy_week_seq0, t11.d_day_name0, t11.d_quarter_name0, t11.d_holiday0, t11.d_weekend0, t11.d_following_holiday0, t11.d_first_dom0, t11.d_last_dom0, t11.d_same_day_ly0, t11.d_same_day_lq0, t11.d_current_day0, t11.d_current_week0, t11.d_current_month0, t11.d_current_quarter0, t11.d_current_year0, t11.d_date_sk1, t11.d_date_id1, t11.d_date1, t11.d_month_seq1, t11.d_week_seq1, t11.d_quarter_seq1, t11.d_year1, t11.d_dow1, t11.d_moy1, t11.d_dom1, t11.d_qoy1, t11.d_fy_year1, t11.d_fy_quarter_seq1, t11.d_fy_week_seq1, t11.d_day_name1, t11.d_quarter_name1, t11.d_holiday1, t11.d_weekend1, t11.d_following_holiday1, t11.d_first_dom1, t11.d_last_dom1, t11.d_same_day_ly1, t11.d_same_day_lq1, t11.d_current_day1, t11.d_current_week1, t11.d_current_month1, t11.d_current_quarter1, t11.d_current_year1, t11.s_store_sk, t11.s_store_id, t11.s_rec_start_date, t11.s_rec_end_date, t11.s_closed_date_sk, t11.s_store_name, t11.s_number_employees, t11.s_floor_space, t11.s_hours, t11.s_manager, t11.s_market_id, t11.s_geography_class, t11.s_market_desc, t11.s_market_manager, t11.s_division_id, t11.s_division_name, t11.s_company_id, t11.s_company_name, t11.s_street_number, t11.s_street_name, t11.s_street_type, t11.s_suite_number, t11.s_city, t11.s_county, t11.s_state, t11.s_zip, t11.s_country, t11.s_gmt_offset, t11.s_tax_percentage, t11.c_customer_sk, t11.c_customer_id, t11.c_current_cdemo_sk, t11.c_current_hdemo_sk, t11.c_current_addr_sk, t11.c_first_shipto_date_sk, t11.c_first_sales_date_sk, t11.c_salutation, t11.c_first_name, t11.c_last_name, t11.c_preferred_cust_flag, t11.c_birth_day, t11.c_birth_month, t11.c_birth_year, t11.c_birth_country, t11.c_login, t11.c_email_address, t11.c_last_review_date_sk, t11.cd_demo_sk, t11.cd_gender, t11.cd_marital_status, t11.cd_education_status, t11.cd_purchase_estimate, t11.cd_credit_rating, t11.cd_dep_count, t11.cd_dep_employed_count, t11.cd_dep_college_count, t11.cd_demo_sk0, t11.cd_gender0, t11.cd_marital_status0, t11.cd_education_status0, t11.cd_purchase_estimate0, t11.cd_credit_rating0, t11.cd_dep_count0, t11.cd_dep_employed_count0, t11.cd_dep_college_count0, t11.p_promo_sk, t11.p_promo_id, t11.p_start_date_sk, t11.p_end_date_sk, t11.p_item_sk, t11.p_cost, t11.p_response_target, t11.p_promo_name, t11.p_channel_dmail, t11.p_channel_email, t11.p_channel_catalog, t11.p_channel_tv, t11.p_channel_radio, t11.p_channel_press, t11.p_channel_event, t11.p_channel_demo, t11.p_channel_details, t11.p_purpose, t11.p_discount_active, household_demographics0.hd_demo_sk, household_demographics0.hd_income_band_sk, household_demographics0.hd_buy_potential, household_demographics0.hd_dep_count, household_demographics0.hd_vehicle_count\nFROM household_demographics AS household_demographics0\nINNER JOIN (SELECT t10.ss_sold_date_sk, t10.ss_sold_time_sk, t10.ss_item_sk, t10.ss_customer_sk, t10.ss_cdemo_sk, t10.ss_hdemo_sk, t10.ss_addr_sk, t10.ss_store_sk, t10.ss_promo_sk, t10.ss_ticket_number, t10.ss_quantity, t10.ss_wholesale_cost, t10.ss_list_price, t10.ss_sales_price, t10.ss_ext_discount_amt, t10.ss_ext_sales_price, t10.ss_ext_wholesale_cost, t10.ss_ext_list_price, t10.ss_ext_tax, t10.ss_coupon_amt, t10.ss_net_paid, t10.ss_net_paid_inc_tax, t10.ss_net_profit, t10.sr_returned_date_sk, t10.sr_return_time_sk, t10.sr_item_sk, t10.sr_customer_sk, t10.sr_cdemo_sk, t10.sr_hdemo_sk, t10.sr_addr_sk, t10.sr_store_sk, t10.sr_reason_sk, t10.sr_ticket_number, t10.sr_return_quantity, t10.sr_return_amt, t10.sr_return_tax, t10.sr_return_amt_inc_tax, t10.sr_fee, t10.sr_return_ship_cost, t10.sr_refunded_cash, t10.sr_reversed_charge, t10.sr_store_credit, t10.sr_net_loss, t10.CS_ITEM_SK, t10.SALE, t10.REFUND, t10.d_date_sk, t10.d_date_id, t10.d_date, t10.d_month_seq, t10.d_week_seq, t10.d_quarter_seq, t10.d_year, t10.d_dow, t10.d_moy, t10.d_dom, t10.d_qoy, t10.d_fy_year, t10.d_fy_quarter_seq, t10.d_fy_week_seq, t10.d_day_name, t10.d_quarter_name, t10.d_holiday, t10.d_weekend, t10.d_following_holiday, t10.d_first_dom, t10.d_last_dom, t10.d_same_day_ly, t10.d_same_day_lq, t10.d_current_day, t10.d_current_week, t10.d_current_month, t10.d_current_quarter, t10.d_current_year, t10.d_date_sk0, t10.d_date_id0, t10.d_date0, t10.d_month_seq0, t10.d_week_seq0, t10.d_quarter_seq0, t10.d_year0, t10.d_dow0, t10.d_moy0, t10.d_dom0, t10.d_qoy0, t10.d_fy_year0, t10.d_fy_quarter_seq0, t10.d_fy_week_seq0, t10.d_day_name0, t10.d_quarter_name0, t10.d_holiday0, t10.d_weekend0, t10.d_following_holiday0, t10.d_first_dom0, t10.d_last_dom0, t10.d_same_day_ly0, t10.d_same_day_lq0, t10.d_current_day0, t10.d_current_week0, t10.d_current_month0, t10.d_current_quarter0, t10.d_current_year0, t10.d_date_sk1, t10.d_date_id1, t10.d_date1, t10.d_month_seq1, t10.d_week_seq1, t10.d_quarter_seq1, t10.d_year1, t10.d_dow1, t10.d_moy1, t10.d_dom1, t10.d_qoy1, t10.d_fy_year1, t10.d_fy_quarter_seq1, t10.d_fy_week_seq1, t10.d_day_name1, t10.d_quarter_name1, t10.d_holiday1, t10.d_weekend1, t10.d_following_holiday1, t10.d_first_dom1, t10.d_last_dom1, t10.d_same_day_ly1, t10.d_same_day_lq1, t10.d_current_day1, t10.d_current_week1, t10.d_current_month1, t10.d_current_quarter1, t10.d_current_year1, t10.s_store_sk, t10.s_store_id, t10.s_rec_start_date, t10.s_rec_end_date, t10.s_closed_date_sk, t10.s_store_name, t10.s_number_employees, t10.s_floor_space, t10.s_hours, t10.s_manager, t10.s_market_id, t10.s_geography_class, t10.s_market_desc, t10.s_market_manager, t10.s_division_id, t10.s_division_name, t10.s_company_id, t10.s_company_name, t10.s_street_number, t10.s_street_name, t10.s_street_type, t10.s_suite_number, t10.s_city, t10.s_county, t10.s_state, t10.s_zip, t10.s_country, t10.s_gmt_offset, t10.s_tax_percentage, t10.c_customer_sk, t10.c_customer_id, t10.c_current_cdemo_sk, t10.c_current_hdemo_sk, t10.c_current_addr_sk, t10.c_first_shipto_date_sk, t10.c_first_sales_date_sk, t10.c_salutation, t10.c_first_name, t10.c_last_name, t10.c_preferred_cust_flag, t10.c_birth_day, t10.c_birth_month, t10.c_birth_year, t10.c_birth_country, t10.c_login, t10.c_email_address, t10.c_last_review_date_sk, t10.cd_demo_sk, t10.cd_gender, t10.cd_marital_status, t10.cd_education_status, t10.cd_purchase_estimate, t10.cd_credit_rating, t10.cd_dep_count, t10.cd_dep_employed_count, t10.cd_dep_college_count, t10.cd_demo_sk0, t10.cd_gender0, t10.cd_marital_status0, t10.cd_education_status0, t10.cd_purchase_estimate0, t10.cd_credit_rating0, t10.cd_dep_count0, t10.cd_dep_employed_count0, t10.cd_dep_college_count0, promotion.p_promo_sk, promotion.p_promo_id, promotion.p_start_date_sk, promotion.p_end_date_sk, promotion.p_item_sk, promotion.p_cost, promotion.p_response_target, promotion.p_promo_name, promotion.p_channel_dmail, promotion.p_channel_email, promotion.p_channel_catalog, promotion.p_channel_tv, promotion.p_channel_radio, promotion.p_channel_press, promotion.p_channel_event, promotion.p_channel_demo, promotion.p_channel_details, promotion.p_purpose, promotion.p_discount_active\nFROM promotion\nINNER JOIN (SELECT t9.ss_sold_date_sk, t9.ss_sold_time_sk, t9.ss_item_sk, t9.ss_customer_sk, t9.ss_cdemo_sk, t9.ss_hdemo_sk, t9.ss_addr_sk, t9.ss_store_sk, t9.ss_promo_sk, t9.ss_ticket_number, t9.ss_quantity, t9.ss_wholesale_cost, t9.ss_list_price, t9.ss_sales_price, t9.ss_ext_discount_amt, t9.ss_ext_sales_price, t9.ss_ext_wholesale_cost, t9.ss_ext_list_price, t9.ss_ext_tax, t9.ss_coupon_amt, t9.ss_net_paid, t9.ss_net_paid_inc_tax, t9.ss_net_profit, t9.sr_returned_date_sk, t9.sr_return_time_sk, t9.sr_item_sk, t9.sr_customer_sk, t9.sr_cdemo_sk, t9.sr_hdemo_sk, t9.sr_addr_sk, t9.sr_store_sk, t9.sr_reason_sk, t9.sr_ticket_number, t9.sr_return_quantity, t9.sr_return_amt, t9.sr_return_tax, t9.sr_return_amt_inc_tax, t9.sr_fee, t9.sr_return_ship_cost, t9.sr_refunded_cash, t9.sr_reversed_charge, t9.sr_store_credit, t9.sr_net_loss, t9.CS_ITEM_SK, t9.SALE, t9.REFUND, t9.d_date_sk, t9.d_date_id, t9.d_date, t9.d_month_seq, t9.d_week_seq, t9.d_quarter_seq, t9.d_year, t9.d_dow, t9.d_moy, t9.d_dom, t9.d_qoy, t9.d_fy_year, t9.d_fy_quarter_seq, t9.d_fy_week_seq, t9.d_day_name, t9.d_quarter_name, t9.d_holiday, t9.d_weekend, t9.d_following_holiday, t9.d_first_dom, t9.d_last_dom, t9.d_same_day_ly, t9.d_same_day_lq, t9.d_current_day, t9.d_current_week, t9.d_current_month, t9.d_current_quarter, t9.d_current_year, t9.d_date_sk0, t9.d_date_id0, t9.d_date0, t9.d_month_seq0, t9.d_week_seq0, t9.d_quarter_seq0, t9.d_year0, t9.d_dow0, t9.d_moy0, t9.d_dom0, t9.d_qoy0, t9.d_fy_year0, t9.d_fy_quarter_seq0, t9.d_fy_week_seq0, t9.d_day_name0, t9.d_quarter_name0, t9.d_holiday0, t9.d_weekend0, t9.d_following_holiday0, t9.d_first_dom0, t9.d_last_dom0, t9.d_same_day_ly0, t9.d_same_day_lq0, t9.d_current_day0, t9.d_current_week0, t9.d_current_month0, t9.d_current_quarter0, t9.d_current_year0, t9.d_date_sk1, t9.d_date_id1, t9.d_date1, t9.d_month_seq1, t9.d_week_seq1, t9.d_quarter_seq1, t9.d_year1, t9.d_dow1, t9.d_moy1, t9.d_dom1, t9.d_qoy1, t9.d_fy_year1, t9.d_fy_quarter_seq1, t9.d_fy_week_seq1, t9.d_day_name1, t9.d_quarter_name1, t9.d_holiday1, t9.d_weekend1, t9.d_following_holiday1, t9.d_first_dom1, t9.d_last_dom1, t9.d_same_day_ly1, t9.d_same_day_lq1, t9.d_current_day1, t9.d_current_week1, t9.d_current_month1, t9.d_current_quarter1, t9.d_current_year1, t9.s_store_sk, t9.s_store_id, t9.s_rec_start_date, t9.s_rec_end_date, t9.s_closed_date_sk, t9.s_store_name, t9.s_number_employees, t9.s_floor_space, t9.s_hours, t9.s_manager, t9.s_market_id, t9.s_geography_class, t9.s_market_desc, t9.s_market_manager, t9.s_division_id, t9.s_division_name, t9.s_company_id, t9.s_company_name, t9.s_street_number, t9.s_street_name, t9.s_street_type, t9.s_suite_number, t9.s_city, t9.s_county, t9.s_state, t9.s_zip, t9.s_country, t9.s_gmt_offset, t9.s_tax_percentage, t9.c_customer_sk, t9.c_customer_id, t9.c_current_cdemo_sk, t9.c_current_hdemo_sk, t9.c_current_addr_sk, t9.c_first_shipto_date_sk, t9.c_first_sales_date_sk, t9.c_salutation, t9.c_first_name, t9.c_last_name, t9.c_preferred_cust_flag, t9.c_birth_day, t9.c_birth_month, t9.c_birth_year, t9.c_birth_country, t9.c_login, t9.c_email_address, t9.c_last_review_date_sk, t9.cd_demo_sk, t9.cd_gender, t9.cd_marital_status, t9.cd_education_status, t9.cd_purchase_estimate, t9.cd_credit_rating, t9.cd_dep_count, t9.cd_dep_employed_count, t9.cd_dep_college_count, customer_demographics.cd_demo_sk AS cd_demo_sk0, customer_demographics.cd_gender AS cd_gender0, customer_demographics.cd_marital_status AS cd_marital_status0, customer_demographics.cd_education_status AS cd_education_status0, customer_demographics.cd_purchase_estimate AS cd_purchase_estimate0, customer_demographics.cd_credit_rating AS cd_credit_rating0, customer_demographics.cd_dep_count AS cd_dep_count0, customer_demographics.cd_dep_employed_count AS cd_dep_employed_count0, customer_demographics.cd_dep_college_count AS cd_dep_college_count0\nFROM customer_demographics\nINNER JOIN (SELECT t8.ss_sold_date_sk, t8.ss_sold_time_sk, t8.ss_item_sk, t8.ss_customer_sk, t8.ss_cdemo_sk, t8.ss_hdemo_sk, t8.ss_addr_sk, t8.ss_store_sk, t8.ss_promo_sk, t8.ss_ticket_number, t8.ss_quantity, t8.ss_wholesale_cost, t8.ss_list_price, t8.ss_sales_price, t8.ss_ext_discount_amt, t8.ss_ext_sales_price, t8.ss_ext_wholesale_cost, t8.ss_ext_list_price, t8.ss_ext_tax, t8.ss_coupon_amt, t8.ss_net_paid, t8.ss_net_paid_inc_tax, t8.ss_net_profit, t8.sr_returned_date_sk, t8.sr_return_time_sk, t8.sr_item_sk, t8.sr_customer_sk, t8.sr_cdemo_sk, t8.sr_hdemo_sk, t8.sr_addr_sk, t8.sr_store_sk, t8.sr_reason_sk, t8.sr_ticket_number, t8.sr_return_quantity, t8.sr_return_amt, t8.sr_return_tax, t8.sr_return_amt_inc_tax, t8.sr_fee, t8.sr_return_ship_cost, t8.sr_refunded_cash, t8.sr_reversed_charge, t8.sr_store_credit, t8.sr_net_loss, t8.CS_ITEM_SK, t8.SALE, t8.REFUND, t8.d_date_sk, t8.d_date_id, t8.d_date, t8.d_month_seq, t8.d_week_seq, t8.d_quarter_seq, t8.d_year, t8.d_dow, t8.d_moy, t8.d_dom, t8.d_qoy, t8.d_fy_year, t8.d_fy_quarter_seq, t8.d_fy_week_seq, t8.d_day_name, t8.d_quarter_name, t8.d_holiday, t8.d_weekend, t8.d_following_holiday, t8.d_first_dom, t8.d_last_dom, t8.d_same_day_ly, t8.d_same_day_lq, t8.d_current_day, t8.d_current_week, t8.d_current_month, t8.d_current_quarter, t8.d_current_year, t8.d_date_sk0, t8.d_date_id0, t8.d_date0, t8.d_month_seq0, t8.d_week_seq0, t8.d_quarter_seq0, t8.d_year0, t8.d_dow0, t8.d_moy0, t8.d_dom0, t8.d_qoy0, t8.d_fy_year0, t8.d_fy_quarter_seq0, t8.d_fy_week_seq0, t8.d_day_name0, t8.d_quarter_name0, t8.d_holiday0, t8.d_weekend0, t8.d_following_holiday0, t8.d_first_dom0, t8.d_last_dom0, t8.d_same_day_ly0, t8.d_same_day_lq0, t8.d_current_day0, t8.d_current_week0, t8.d_current_month0, t8.d_current_quarter0, t8.d_current_year0, t8.d_date_sk1, t8.d_date_id1, t8.d_date1, t8.d_month_seq1, t8.d_week_seq1, t8.d_quarter_seq1, t8.d_year1, t8.d_dow1, t8.d_moy1, t8.d_dom1, t8.d_qoy1, t8.d_fy_year1, t8.d_fy_quarter_seq1, t8.d_fy_week_seq1, t8.d_day_name1, t8.d_quarter_name1, t8.d_holiday1, t8.d_weekend1, t8.d_following_holiday1, t8.d_first_dom1, t8.d_last_dom1, t8.d_same_day_ly1, t8.d_same_day_lq1, t8.d_current_day1, t8.d_current_week1, t8.d_current_month1, t8.d_current_quarter1, t8.d_current_year1, t8.s_store_sk, t8.s_store_id, t8.s_rec_start_date, t8.s_rec_end_date, t8.s_closed_date_sk, t8.s_store_name, t8.s_number_employees, t8.s_floor_space, t8.s_hours, t8.s_manager, t8.s_market_id, t8.s_geography_class, t8.s_market_desc, t8.s_market_manager, t8.s_division_id, t8.s_division_name, t8.s_company_id, t8.s_company_name, t8.s_street_number, t8.s_street_name, t8.s_street_type, t8.s_suite_number, t8.s_city, t8.s_county, t8.s_state, t8.s_zip, t8.s_country, t8.s_gmt_offset, t8.s_tax_percentage, t8.c_customer_sk, t8.c_customer_id, t8.c_current_cdemo_sk, t8.c_current_hdemo_sk, t8.c_current_addr_sk, t8.c_first_shipto_date_sk, t8.c_first_sales_date_sk, t8.c_salutation, t8.c_first_name, t8.c_last_name, t8.c_preferred_cust_flag, t8.c_birth_day, t8.c_birth_month, t8.c_birth_year, t8.c_birth_country, t8.c_login, t8.c_email_address, t8.c_last_review_date_sk, customer_demographics0.cd_demo_sk, customer_demographics0.cd_gender, customer_demographics0.cd_marital_status, customer_demographics0.cd_education_status, customer_demographics0.cd_purchase_estimate, customer_demographics0.cd_credit_rating, customer_demographics0.cd_dep_count, customer_demographics0.cd_dep_employed_count, customer_demographics0.cd_dep_college_count\nFROM customer_demographics AS customer_demographics0\nINNER JOIN (SELECT t7.ss_sold_date_sk, t7.ss_sold_time_sk, t7.ss_item_sk, t7.ss_customer_sk, t7.ss_cdemo_sk, t7.ss_hdemo_sk, t7.ss_addr_sk, t7.ss_store_sk, t7.ss_promo_sk, t7.ss_ticket_number, t7.ss_quantity, t7.ss_wholesale_cost, t7.ss_list_price, t7.ss_sales_price, t7.ss_ext_discount_amt, t7.ss_ext_sales_price, t7.ss_ext_wholesale_cost, t7.ss_ext_list_price, t7.ss_ext_tax, t7.ss_coupon_amt, t7.ss_net_paid, t7.ss_net_paid_inc_tax, t7.ss_net_profit, t7.sr_returned_date_sk, t7.sr_return_time_sk, t7.sr_item_sk, t7.sr_customer_sk, t7.sr_cdemo_sk, t7.sr_hdemo_sk, t7.sr_addr_sk, t7.sr_store_sk, t7.sr_reason_sk, t7.sr_ticket_number, t7.sr_return_quantity, t7.sr_return_amt, t7.sr_return_tax, t7.sr_return_amt_inc_tax, t7.sr_fee, t7.sr_return_ship_cost, t7.sr_refunded_cash, t7.sr_reversed_charge, t7.sr_store_credit, t7.sr_net_loss, t7.CS_ITEM_SK, t7.SALE, t7.REFUND, t7.d_date_sk, t7.d_date_id, t7.d_date, t7.d_month_seq, t7.d_week_seq, t7.d_quarter_seq, t7.d_year, t7.d_dow, t7.d_moy, t7.d_dom, t7.d_qoy, t7.d_fy_year, t7.d_fy_quarter_seq, t7.d_fy_week_seq, t7.d_day_name, t7.d_quarter_name, t7.d_holiday, t7.d_weekend, t7.d_following_holiday, t7.d_first_dom, t7.d_last_dom, t7.d_same_day_ly, t7.d_same_day_lq, t7.d_current_day, t7.d_current_week, t7.d_current_month, t7.d_current_quarter, t7.d_current_year, t7.d_date_sk0, t7.d_date_id0, t7.d_date0, t7.d_month_seq0, t7.d_week_seq0, t7.d_quarter_seq0, t7.d_year0, t7.d_dow0, t7.d_moy0, t7.d_dom0, t7.d_qoy0, t7.d_fy_year0, t7.d_fy_quarter_seq0, t7.d_fy_week_seq0, t7.d_day_name0, t7.d_quarter_name0, t7.d_holiday0, t7.d_weekend0, t7.d_following_holiday0, t7.d_first_dom0, t7.d_last_dom0, t7.d_same_day_ly0, t7.d_same_day_lq0, t7.d_current_day0, t7.d_current_week0, t7.d_current_month0, t7.d_current_quarter0, t7.d_current_year0, t7.d_date_sk1, t7.d_date_id1, t7.d_date1, t7.d_month_seq1, t7.d_week_seq1, t7.d_quarter_seq1, t7.d_year1, t7.d_dow1, t7.d_moy1, t7.d_dom1, t7.d_qoy1, t7.d_fy_year1, t7.d_fy_quarter_seq1, t7.d_fy_week_seq1, t7.d_day_name1, t7.d_quarter_name1, t7.d_holiday1, t7.d_weekend1, t7.d_following_holiday1, t7.d_first_dom1, t7.d_last_dom1, t7.d_same_day_ly1, t7.d_same_day_lq1, t7.d_current_day1, t7.d_current_week1, t7.d_current_month1, t7.d_current_quarter1, t7.d_current_year1, t7.s_store_sk, t7.s_store_id, t7.s_rec_start_date, t7.s_rec_end_date, t7.s_closed_date_sk, t7.s_store_name, t7.s_number_employees, t7.s_floor_space, t7.s_hours, t7.s_manager, t7.s_market_id, t7.s_geography_class, t7.s_market_desc, t7.s_market_manager, t7.s_division_id, t7.s_division_name, t7.s_company_id, t7.s_company_name, t7.s_street_number, t7.s_street_name, t7.s_street_type, t7.s_suite_number, t7.s_city, t7.s_county, t7.s_state, t7.s_zip, t7.s_country, t7.s_gmt_offset, t7.s_tax_percentage, customer.c_customer_sk, customer.c_customer_id, customer.c_current_cdemo_sk, customer.c_current_hdemo_sk, customer.c_current_addr_sk, customer.c_first_shipto_date_sk, customer.c_first_sales_date_sk, customer.c_salutation, customer.c_first_name, customer.c_last_name, customer.c_preferred_cust_flag, customer.c_birth_day, customer.c_birth_month, customer.c_birth_year, customer.c_birth_country, customer.c_login, customer.c_email_address, customer.c_last_review_date_sk\nFROM customer\nINNER JOIN (SELECT t6.ss_sold_date_sk, t6.ss_sold_time_sk, t6.ss_item_sk, t6.ss_customer_sk, t6.ss_cdemo_sk, t6.ss_hdemo_sk, t6.ss_addr_sk, t6.ss_store_sk, t6.ss_promo_sk, t6.ss_ticket_number, t6.ss_quantity, t6.ss_wholesale_cost, t6.ss_list_price, t6.ss_sales_price, t6.ss_ext_discount_amt, t6.ss_ext_sales_price, t6.ss_ext_wholesale_cost, t6.ss_ext_list_price, t6.ss_ext_tax, t6.ss_coupon_amt, t6.ss_net_paid, t6.ss_net_paid_inc_tax, t6.ss_net_profit, t6.sr_returned_date_sk, t6.sr_return_time_sk, t6.sr_item_sk, t6.sr_customer_sk, t6.sr_cdemo_sk, t6.sr_hdemo_sk, t6.sr_addr_sk, t6.sr_store_sk, t6.sr_reason_sk, t6.sr_ticket_number, t6.sr_return_quantity, t6.sr_return_amt, t6.sr_return_tax, t6.sr_return_amt_inc_tax, t6.sr_fee, t6.sr_return_ship_cost, t6.sr_refunded_cash, t6.sr_reversed_charge, t6.sr_store_credit, t6.sr_net_loss, t6.CS_ITEM_SK, t6.SALE, t6.REFUND, t6.d_date_sk, t6.d_date_id, t6.d_date, t6.d_month_seq, t6.d_week_seq, t6.d_quarter_seq, t6.d_year, t6.d_dow, t6.d_moy, t6.d_dom, t6.d_qoy, t6.d_fy_year, t6.d_fy_quarter_seq, t6.d_fy_week_seq, t6.d_day_name, t6.d_quarter_name, t6.d_holiday, t6.d_weekend, t6.d_following_holiday, t6.d_first_dom, t6.d_last_dom, t6.d_same_day_ly, t6.d_same_day_lq, t6.d_current_day, t6.d_current_week, t6.d_current_month, t6.d_current_quarter, t6.d_current_year, t6.d_date_sk0, t6.d_date_id0, t6.d_date0, t6.d_month_seq0, t6.d_week_seq0, t6.d_quarter_seq0, t6.d_year0, t6.d_dow0, t6.d_moy0, t6.d_dom0, t6.d_qoy0, t6.d_fy_year0, t6.d_fy_quarter_seq0, t6.d_fy_week_seq0, t6.d_day_name0, t6.d_quarter_name0, t6.d_holiday0, t6.d_weekend0, t6.d_following_holiday0, t6.d_first_dom0, t6.d_last_dom0, t6.d_same_day_ly0, t6.d_same_day_lq0, t6.d_current_day0, t6.d_current_week0, t6.d_current_month0, t6.d_current_quarter0, t6.d_current_year0, t6.d_date_sk1, t6.d_date_id1, t6.d_date1, t6.d_month_seq1, t6.d_week_seq1, t6.d_quarter_seq1, t6.d_year1, t6.d_dow1, t6.d_moy1, t6.d_dom1, t6.d_qoy1, t6.d_fy_year1, t6.d_fy_quarter_seq1, t6.d_fy_week_seq1, t6.d_day_name1, t6.d_quarter_name1, t6.d_holiday1, t6.d_weekend1, t6.d_following_holiday1, t6.d_first_dom1, t6.d_last_dom1, t6.d_same_day_ly1, t6.d_same_day_lq1, t6.d_current_day1, t6.d_current_week1, t6.d_current_month1, t6.d_current_quarter1, t6.d_current_year1, store.s_store_sk, store.s_store_id, store.s_rec_start_date, store.s_rec_end_date, store.s_closed_date_sk, store.s_store_name, store.s_number_employees, store.s_floor_space, store.s_hours, store.s_manager, store.s_market_id, store.s_geography_class, store.s_market_desc, store.s_market_manager, store.s_division_id, store.s_division_name, store.s_company_id, store.s_company_name, store.s_street_number, store.s_street_name, store.s_street_type, store.s_suite_number, store.s_city, store.s_county, store.s_state, store.s_zip, store.s_country, store.s_gmt_offset, store.s_tax_percentage\nFROM store\nINNER JOIN (SELECT t5.ss_sold_date_sk, t5.ss_sold_time_sk, t5.ss_item_sk, t5.ss_customer_sk, t5.ss_cdemo_sk, t5.ss_hdemo_sk, t5.ss_addr_sk, t5.ss_store_sk, t5.ss_promo_sk, t5.ss_ticket_number, t5.ss_quantity, t5.ss_wholesale_cost, t5.ss_list_price, t5.ss_sales_price, t5.ss_ext_discount_amt, t5.ss_ext_sales_price, t5.ss_ext_wholesale_cost, t5.ss_ext_list_price, t5.ss_ext_tax, t5.ss_coupon_amt, t5.ss_net_paid, t5.ss_net_paid_inc_tax, t5.ss_net_profit, t5.sr_returned_date_sk, t5.sr_return_time_sk, t5.sr_item_sk, t5.sr_customer_sk, t5.sr_cdemo_sk, t5.sr_hdemo_sk, t5.sr_addr_sk, t5.sr_store_sk, t5.sr_reason_sk, t5.sr_ticket_number, t5.sr_return_quantity, t5.sr_return_amt, t5.sr_return_tax, t5.sr_return_amt_inc_tax, t5.sr_fee, t5.sr_return_ship_cost, t5.sr_refunded_cash, t5.sr_reversed_charge, t5.sr_store_credit, t5.sr_net_loss, t5.CS_ITEM_SK, t5.SALE, t5.REFUND, t5.d_date_sk, t5.d_date_id, t5.d_date, t5.d_month_seq, t5.d_week_seq, t5.d_quarter_seq, t5.d_year, t5.d_dow, t5.d_moy, t5.d_dom, t5.d_qoy, t5.d_fy_year, t5.d_fy_quarter_seq, t5.d_fy_week_seq, t5.d_day_name, t5.d_quarter_name, t5.d_holiday, t5.d_weekend, t5.d_following_holiday, t5.d_first_dom, t5.d_last_dom, t5.d_same_day_ly, t5.d_same_day_lq, t5.d_current_day, t5.d_current_week, t5.d_current_month, t5.d_current_quarter, t5.d_current_year, t5.d_date_sk0, t5.d_date_id0, t5.d_date0, t5.d_month_seq0, t5.d_week_seq0, t5.d_quarter_seq0, t5.d_year0, t5.d_dow0, t5.d_moy0, t5.d_dom0, t5.d_qoy0, t5.d_fy_year0, t5.d_fy_quarter_seq0, t5.d_fy_week_seq0, t5.d_day_name0, t5.d_quarter_name0, t5.d_holiday0, t5.d_weekend0, t5.d_following_holiday0, t5.d_first_dom0, t5.d_last_dom0, t5.d_same_day_ly0, t5.d_same_day_lq0, t5.d_current_day0, t5.d_current_week0, t5.d_current_month0, t5.d_current_quarter0, t5.d_current_year0, date_dim.d_date_sk AS d_date_sk1, date_dim.d_date_id AS d_date_id1, date_dim.d_date AS d_date1, date_dim.d_month_seq AS d_month_seq1, date_dim.d_week_seq AS d_week_seq1, date_dim.d_quarter_seq AS d_quarter_seq1, date_dim.d_year AS d_year1, date_dim.d_dow AS d_dow1, date_dim.d_moy AS d_moy1, date_dim.d_dom AS d_dom1, date_dim.d_qoy AS d_qoy1, date_dim.d_fy_year AS d_fy_year1, date_dim.d_fy_quarter_seq AS d_fy_quarter_seq1, date_dim.d_fy_week_seq AS d_fy_week_seq1, date_dim.d_day_name AS d_day_name1, date_dim.d_quarter_name AS d_quarter_name1, date_dim.d_holiday AS d_holiday1, date_dim.d_weekend AS d_weekend1, date_dim.d_following_holiday AS d_following_holiday1, date_dim.d_first_dom AS d_first_dom1, date_dim.d_last_dom AS d_last_dom1, date_dim.d_same_day_ly AS d_same_day_ly1, date_dim.d_same_day_lq AS d_same_day_lq1, date_dim.d_current_day AS d_current_day1, date_dim.d_current_week AS d_current_week1, date_dim.d_current_month AS d_current_month1, date_dim.d_current_quarter AS d_current_quarter1, date_dim.d_current_year AS d_current_year1\nFROM date_dim,\n(SELECT t4.ss_sold_date_sk, t4.ss_sold_time_sk, t4.ss_item_sk, t4.ss_customer_sk, t4.ss_cdemo_sk, t4.ss_hdemo_sk, t4.ss_addr_sk, t4.ss_store_sk, t4.ss_promo_sk, t4.ss_ticket_number, t4.ss_quantity, t4.ss_wholesale_cost, t4.ss_list_price, t4.ss_sales_price, t4.ss_ext_discount_amt, t4.ss_ext_sales_price, t4.ss_ext_wholesale_cost, t4.ss_ext_list_price, t4.ss_ext_tax, t4.ss_coupon_amt, t4.ss_net_paid, t4.ss_net_paid_inc_tax, t4.ss_net_profit, t4.sr_returned_date_sk, t4.sr_return_time_sk, t4.sr_item_sk, t4.sr_customer_sk, t4.sr_cdemo_sk, t4.sr_hdemo_sk, t4.sr_addr_sk, t4.sr_store_sk, t4.sr_reason_sk, t4.sr_ticket_number, t4.sr_return_quantity, t4.sr_return_amt, t4.sr_return_tax, t4.sr_return_amt_inc_tax, t4.sr_fee, t4.sr_return_ship_cost, t4.sr_refunded_cash, t4.sr_reversed_charge, t4.sr_store_credit, t4.sr_net_loss, t4.CS_ITEM_SK, t4.SALE, t4.REFUND, t4.d_date_sk, t4.d_date_id, t4.d_date, t4.d_month_seq, t4.d_week_seq, t4.d_quarter_seq, t4.d_year, t4.d_dow, t4.d_moy, t4.d_dom, t4.d_qoy, t4.d_fy_year, t4.d_fy_quarter_seq, t4.d_fy_week_seq, t4.d_day_name, t4.d_quarter_name, t4.d_holiday, t4.d_weekend, t4.d_following_holiday, t4.d_first_dom, t4.d_last_dom, t4.d_same_day_ly, t4.d_same_day_lq, t4.d_current_day, t4.d_current_week, t4.d_current_month, t4.d_current_quarter, t4.d_current_year, date_dim0.d_date_sk AS d_date_sk0, date_dim0.d_date_id AS d_date_id0, date_dim0.d_date AS d_date0, date_dim0.d_month_seq AS d_month_seq0, date_dim0.d_week_seq AS d_week_seq0, date_dim0.d_quarter_seq AS d_quarter_seq0, date_dim0.d_year AS d_year0, date_dim0.d_dow AS d_dow0, date_dim0.d_moy AS d_moy0, date_dim0.d_dom AS d_dom0, date_dim0.d_qoy AS d_qoy0, date_dim0.d_fy_year AS d_fy_year0, date_dim0.d_fy_quarter_seq AS d_fy_quarter_seq0, date_dim0.d_fy_week_seq AS d_fy_week_seq0, date_dim0.d_day_name AS d_day_name0, date_dim0.d_quarter_name AS d_quarter_name0, date_dim0.d_holiday AS d_holiday0, date_dim0.d_weekend AS d_weekend0, date_dim0.d_following_holiday AS d_following_holiday0, date_dim0.d_first_dom AS d_first_dom0, date_dim0.d_last_dom AS d_last_dom0, date_dim0.d_same_day_ly AS d_same_day_ly0, date_dim0.d_same_day_lq AS d_same_day_lq0, date_dim0.d_current_day AS d_current_day0, date_dim0.d_current_week AS d_current_week0, date_dim0.d_current_month AS d_current_month0, date_dim0.d_current_quarter AS d_current_quarter0, date_dim0.d_current_year AS d_current_year0\nFROM date_dim AS date_dim0,\n(SELECT store_sales.ss_sold_date_sk, store_sales.ss_sold_time_sk, store_sales.ss_item_sk, store_sales.ss_customer_sk, store_sales.ss_cdemo_sk, store_sales.ss_hdemo_sk, store_sales.ss_addr_sk, store_sales.ss_store_sk, store_sales.ss_promo_sk, store_sales.ss_ticket_number, store_sales.ss_quantity, store_sales.ss_wholesale_cost, store_sales.ss_list_price, store_sales.ss_sales_price, store_sales.ss_ext_discount_amt, store_sales.ss_ext_sales_price, store_sales.ss_ext_wholesale_cost, store_sales.ss_ext_list_price, store_sales.ss_ext_tax, store_sales.ss_coupon_amt, store_sales.ss_net_paid, store_sales.ss_net_paid_inc_tax, store_sales.ss_net_profit, store_returns.sr_returned_date_sk, store_returns.sr_return_time_sk, store_returns.sr_item_sk, store_returns.sr_customer_sk, store_returns.sr_cdemo_sk, store_returns.sr_hdemo_sk, store_returns.sr_addr_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk, store_returns.sr_ticket_number, store_returns.sr_return_quantity, store_returns.sr_return_amt, store_returns.sr_return_tax, store_returns.sr_return_amt_inc_tax, store_returns.sr_fee, store_returns.sr_return_ship_cost, store_returns.sr_refunded_cash, store_returns.sr_reversed_charge, store_returns.sr_store_credit, store_returns.sr_net_loss, t3.CS_ITEM_SK, t3.SALE, t3.REFUND, date_dim1.d_date_sk, date_dim1.d_date_id, date_dim1.d_date, date_dim1.d_month_seq, date_dim1.d_week_seq, date_dim1.d_quarter_seq, date_dim1.d_year, date_dim1.d_dow, date_dim1.d_moy, date_dim1.d_dom, date_dim1.d_qoy, date_dim1.d_fy_year, date_dim1.d_fy_quarter_seq, date_dim1.d_fy_week_seq, date_dim1.d_day_name, date_dim1.d_quarter_name, date_dim1.d_holiday, date_dim1.d_weekend, date_dim1.d_following_holiday, date_dim1.d_first_dom, date_dim1.d_last_dom, date_dim1.d_same_day_ly, date_dim1.d_same_day_lq, date_dim1.d_current_day, date_dim1.d_current_week, date_dim1.d_current_month, date_dim1.d_current_quarter, date_dim1.d_current_year\nFROM date_dim AS date_dim1\nINNER JOIN (store_sales INNER JOIN store_returns ON store_sales.ss_item_sk \u003d store_returns.sr_item_sk AND store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number INNER JOIN (SELECT catalog_sales.cs_item_sk AS CS_ITEM_SK, SUM(catalog_sales.cs_ext_list_price) AS SALE, SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit) AS REFUND\nFROM catalog_sales\nINNER JOIN catalog_returns ON catalog_sales.cs_item_sk \u003d catalog_returns.cr_item_sk AND catalog_sales.cs_order_number \u003d catalog_returns.cr_order_number\nGROUP BY catalog_sales.cs_item_sk\nHAVING SUM(catalog_sales.cs_ext_list_price) \u003e 2 * SUM(catalog_returns.cr_refunded_cash + catalog_returns.cr_reversed_charge + catalog_returns.cr_store_credit)) AS t3 ON store_sales.ss_item_sk \u003d t3.CS_ITEM_SK) ON date_dim1.d_date_sk \u003d store_sales.ss_sold_date_sk) AS t4) AS t5) AS t6 ON store.s_store_sk \u003d t6.ss_store_sk) AS t7 ON customer.c_customer_sk \u003d t7.ss_customer_sk AND customer.c_first_sales_date_sk \u003d t7.d_date_sk0 AND customer.c_first_shipto_date_sk \u003d t7.d_date_sk1) AS t8 ON customer_demographics0.cd_demo_sk \u003d t8.ss_cdemo_sk) AS t9 ON customer_demographics.cd_demo_sk \u003d t9.c_current_cdemo_sk AND t9.cd_marital_status \u003c\u003e customer_demographics.cd_marital_status) AS t10 ON promotion.p_promo_sk \u003d t10.ss_promo_sk) AS t11 ON household_demographics0.hd_demo_sk \u003d t11.ss_hdemo_sk) AS t12 ON household_demographics.hd_demo_sk \u003d t12.c_current_hdemo_sk) AS t13 ON customer_address0.ca_address_sk \u003d t13.ss_addr_sk) AS t14 ON customer_address.ca_address_sk \u003d t14.c_current_addr_sk) AS t15 ON income_band0.ib_income_band_sk \u003d t15.hd_income_band_sk) AS t16 ON income_band.ib_income_band_sk \u003d t16.hd_income_band_sk0) AS t17 ON t.i_item_sk \u003d t17.ss_item_sk\nGROUP BY t.i_product_name, t.i_item_sk, t17.s_store_name, t17.s_zip, t17.ca_street_number, t17.ca_street_name, t17.ca_city, t17.ca_zip, t17.ca_street_number0, t17.ca_street_name0, t17.ca_city0, t17.ca_zip0, t17.d_year, t17.d_year0, t17.d_year1\nHAVING t17.d_year \u003d 1999) AS t22\nINNER JOIN (SELECT t23.i_product_name AS PRODUCT_NAME, t23.i_item_sk AS ITEM_SK, t41.s_store_name AS STORE_NAME, t41.s_zip AS STORE_ZIP, t41.ca_street_number AS B_STREET_NUMBER, t41.ca_street_name AS B_STREET_NAME, t41.ca_city AS B_CITY, t41.ca_zip AS B_ZIP, t41.ca_street_number0 AS C_STREET_NUMBER, t41.ca_street_name0 AS C_STREET_NAME, t41.ca_city0 AS C_CITY, t41.ca_zip0 AS C_ZIP, t41.d_year AS SYEAR, t41.d_year0 AS FSYEAR, t41.d_year1 AS S2YEAR, COUNT(*) AS CNT, SUM(t41.ss_wholesale_cost) AS S1, SUM(t41.ss_list_price) AS S2, SUM(t41.ss_coupon_amt) AS S3\nFROM (SELECT *\nFROM item\nWHERE i_color IN (\u0027burlywood\u0027, \u0027floral\u0027, \u0027indian\u0027, \u0027medium\u0027, \u0027purple\u0027, \u0027spring\u0027) AND i_current_price \u003e\u003d 64 AND i_current_price \u003c\u003d 64 + 10 AND i_current_price \u003e\u003d 64 + 1 AND i_current_price \u003c\u003d 64 + 15) AS t23\nINNER JOIN (SELECT t40.ss_sold_date_sk, t40.ss_sold_time_sk, t40.ss_item_sk, t40.ss_customer_sk, t40.ss_cdemo_sk, t40.ss_hdemo_sk, t40.ss_addr_sk, t40.ss_store_sk, t40.ss_promo_sk, t40.ss_ticket_number, t40.ss_quantity, t40.ss_wholesale_cost, t40.ss_list_price, t40.ss_sales_price, t40.ss_ext_discount_amt, t40.ss_ext_sales_price, t40.ss_ext_wholesale_cost, t40.ss_ext_list_price, t40.ss_ext_tax, t40.ss_coupon_amt, t40.ss_net_paid, t40.ss_net_paid_inc_tax, t40.ss_net_profit, t40.sr_returned_date_sk, t40.sr_return_time_sk, t40.sr_item_sk, t40.sr_customer_sk, t40.sr_cdemo_sk, t40.sr_hdemo_sk, t40.sr_addr_sk, t40.sr_store_sk, t40.sr_reason_sk, t40.sr_ticket_number, t40.sr_return_quantity, t40.sr_return_amt, t40.sr_return_tax, t40.sr_return_amt_inc_tax, t40.sr_fee, t40.sr_return_ship_cost, t40.sr_refunded_cash, t40.sr_reversed_charge, t40.sr_store_credit, t40.sr_net_loss, t40.CS_ITEM_SK, t40.SALE, t40.REFUND, t40.d_date_sk, t40.d_date_id, t40.d_date, t40.d_month_seq, t40.d_week_seq, t40.d_quarter_seq, t40.d_year, t40.d_dow, t40.d_moy, t40.d_dom, t40.d_qoy, t40.d_fy_year, t40.d_fy_quarter_seq, t40.d_fy_week_seq, t40.d_day_name, t40.d_quarter_name, t40.d_holiday, t40.d_weekend, t40.d_following_holiday, t40.d_first_dom, t40.d_last_dom, t40.d_same_day_ly, t40.d_same_day_lq, t40.d_current_day, t40.d_current_week, t40.d_current_month, t40.d_current_quarter, t40.d_current_year, t40.d_date_sk0, t40.d_date_id0, t40.d_date0, t40.d_month_seq0, t40.d_week_seq0, t40.d_quarter_seq0, t40.d_year0, t40.d_dow0, t40.d_moy0, t40.d_dom0, t40.d_qoy0, t40.d_fy_year0, t40.d_fy_quarter_seq0, t40.d_fy_week_seq0, t40.d_day_name0, t40.d_quarter_name0, t40.d_holiday0, t40.d_weekend0, t40.d_following_holiday0, t40.d_first_dom0, t40.d_last_dom0, t40.d_same_day_ly0, t40.d_same_day_lq0, t40.d_current_day0, t40.d_current_week0, t40.d_current_month0, t40.d_current_quarter0, t40.d_current_year0, t40.d_date_sk1, t40.d_date_id1, t40.d_date1, t40.d_month_seq1, t40.d_week_seq1, t40.d_quarter_seq1, t40.d_year1, t40.d_dow1, t40.d_moy1, t40.d_dom1, t40.d_qoy1, t40.d_fy_year1, t40.d_fy_quarter_seq1, t40.d_fy_week_seq1, t40.d_day_name1, t40.d_quarter_name1, t40.d_holiday1, t40.d_weekend1, t40.d_following_holiday1, t40.d_first_dom1, t40.d_last_dom1, t40.d_same_day_ly1, t40.d_same_day_lq1, t40.d_current_day1, t40.d_current_week1, t40.d_current_month1, t40.d_current_quarter1, t40.d_current_year1, t40.s_store_sk, t40.s_store_id, t40.s_rec_start_date, t40.s_rec_end_date, t40.s_closed_date_sk, t40.s_store_name, t40.s_number_employees, t40.s_floor_space, t40.s_hours, t40.s_manager, t40.s_market_id, t40.s_geography_class, t40.s_market_desc, t40.s_market_manager, t40.s_division_id, t40.s_division_name, t40.s_company_id, t40.s_company_name, t40.s_street_number, t40.s_street_name, t40.s_street_type, t40.s_suite_number, t40.s_city, t40.s_county, t40.s_state, t40.s_zip, t40.s_country, t40.s_gmt_offset, t40.s_tax_percentage, t40.c_customer_sk, t40.c_customer_id, t40.c_current_cdemo_sk, t40.c_current_hdemo_sk, t40.c_current_addr_sk, t40.c_first_shipto_date_sk, t40.c_first_sales_date_sk, t40.c_salutation, t40.c_first_name, t40.c_last_name, t40.c_preferred_cust_flag, t40.c_birth_day, t40.c_birth_month, t40.c_birth_year, t40.c_birth_country, t40.c_login, t40.c_email_address, t40.c_last_review_date_sk, t40.cd_demo_sk, t40.cd_gender, t40.cd_marital_status, t40.cd_education_status, t40.cd_purchase_estimate, t40.cd_credit_rating, t40.cd_dep_count, t40.cd_dep_employed_count, t40.cd_dep_college_count, t40.cd_demo_sk0, t40.cd_gender0, t40.cd_marital_status0, t40.cd_education_status0, t40.cd_purchase_estimate0, t40.cd_credit_rating0, t40.cd_dep_count0, t40.cd_dep_employed_count0, t40.cd_dep_college_count0, t40.p_promo_sk, t40.p_promo_id, t40.p_start_date_sk, t40.p_end_date_sk, t40.p_item_sk, t40.p_cost, t40.p_response_target, t40.p_promo_name, t40.p_channel_dmail, t40.p_channel_email, t40.p_channel_catalog, t40.p_channel_tv, t40.p_channel_radio, t40.p_channel_press, t40.p_channel_event, t40.p_channel_demo, t40.p_channel_details, t40.p_purpose, t40.p_discount_active, t40.hd_demo_sk, t40.hd_income_band_sk, t40.hd_buy_potential, t40.hd_dep_count, t40.hd_vehicle_count, t40.hd_demo_sk0, t40.hd_income_band_sk0, t40.hd_buy_potential0, t40.hd_dep_count0, t40.hd_vehicle_count0, t40.ca_address_sk, t40.ca_address_id, t40.ca_street_number, t40.ca_street_name, t40.ca_street_type, t40.ca_suite_number, t40.ca_city, t40.ca_county, t40.ca_state, t40.ca_zip, t40.ca_country, t40.ca_gmt_offset, t40.ca_location_type, t40.ca_address_sk0, t40.ca_address_id0, t40.ca_street_number0, t40.ca_street_name0, t40.ca_street_type0, t40.ca_suite_number0, t40.ca_city0, t40.ca_county0, t40.ca_state0, t40.ca_zip0, t40.ca_country0, t40.ca_gmt_offset0, t40.ca_location_type0, t40.ib_income_band_sk, t40.ib_lower_bound, t40.ib_upper_bound, income_band1.ib_income_band_sk AS ib_income_band_sk0, income_band1.ib_lower_bound AS ib_lower_bound0, income_band1.ib_upper_bound AS ib_upper_bound0\nFROM income_band AS income_band1\nINNER JOIN (SELECT t39.ss_sold_date_sk, t39.ss_sold_time_sk, t39.ss_item_sk, t39.ss_customer_sk, t39.ss_cdemo_sk, t39.ss_hdemo_sk, t39.ss_addr_sk, t39.ss_store_sk, t39.ss_promo_sk, t39.ss_ticket_number, t39.ss_quantity, t39.ss_wholesale_cost, t39.ss_list_price, t39.ss_sales_price, t39.ss_ext_discount_amt, t39.ss_ext_sales_price, t39.ss_ext_wholesale_cost, t39.ss_ext_list_price, t39.ss_ext_tax, t39.ss_coupon_amt, t39.ss_net_paid, t39.ss_net_paid_inc_tax, t39.ss_net_profit, t39.sr_returned_date_sk, t39.sr_return_time_sk, t39.sr_item_sk, t39.sr_customer_sk, t39.sr_cdemo_sk, t39.sr_hdemo_sk, t39.sr_addr_sk, t39.sr_store_sk, t39.sr_reason_sk, t39.sr_ticket_number, t39.sr_return_quantity, t39.sr_return_amt, t39.sr_return_tax, t39.sr_return_amt_inc_tax, t39.sr_fee, t39.sr_return_ship_cost, t39.sr_refunded_cash, t39.sr_reversed_charge, t39.sr_store_credit, t39.sr_net_loss, t39.CS_ITEM_SK, t39.SALE, t39.REFUND, t39.d_date_sk, t39.d_date_id, t39.d_date, t39.d_month_seq, t39.d_week_seq, t39.d_quarter_seq, t39.d_year, t39.d_dow, t39.d_moy, t39.d_dom, t39.d_qoy, t39.d_fy_year, t39.d_fy_quarter_seq, t39.d_fy_week_seq, t39.d_day_name, t39.d_quarter_name, t39.d_holiday, t39.d_weekend, t39.d_following_holiday, t39.d_first_dom, t39.d_last_dom, t39.d_same_day_ly, t39.d_same_day_lq, t39.d_current_day, t39.d_current_week, t39.d_current_month, t39.d_current_quarter, t39.d_current_year, t39.d_date_sk0, t39.d_date_id0, t39.d_date0, t39.d_month_seq0, t39.d_week_seq0, t39.d_quarter_seq0, t39.d_year0, t39.d_dow0, t39.d_moy0, t39.d_dom0, t39.d_qoy0, t39.d_fy_year0, t39.d_fy_quarter_seq0, t39.d_fy_week_seq0, t39.d_day_name0, t39.d_quarter_name0, t39.d_holiday0, t39.d_weekend0, t39.d_following_holiday0, t39.d_first_dom0, t39.d_last_dom0, t39.d_same_day_ly0, t39.d_same_day_lq0, t39.d_current_day0, t39.d_current_week0, t39.d_current_month0, t39.d_current_quarter0, t39.d_current_year0, t39.d_date_sk1, t39.d_date_id1, t39.d_date1, t39.d_month_seq1, t39.d_week_seq1, t39.d_quarter_seq1, t39.d_year1, t39.d_dow1, t39.d_moy1, t39.d_dom1, t39.d_qoy1, t39.d_fy_year1, t39.d_fy_quarter_seq1, t39.d_fy_week_seq1, t39.d_day_name1, t39.d_quarter_name1, t39.d_holiday1, t39.d_weekend1, t39.d_following_holiday1, t39.d_first_dom1, t39.d_last_dom1, t39.d_same_day_ly1, t39.d_same_day_lq1, t39.d_current_day1, t39.d_current_week1, t39.d_current_month1, t39.d_current_quarter1, t39.d_current_year1, t39.s_store_sk, t39.s_store_id, t39.s_rec_start_date, t39.s_rec_end_date, t39.s_closed_date_sk, t39.s_store_name, t39.s_number_employees, t39.s_floor_space, t39.s_hours, t39.s_manager, t39.s_market_id, t39.s_geography_class, t39.s_market_desc, t39.s_market_manager, t39.s_division_id, t39.s_division_name, t39.s_company_id, t39.s_company_name, t39.s_street_number, t39.s_street_name, t39.s_street_type, t39.s_suite_number, t39.s_city, t39.s_county, t39.s_state, t39.s_zip, t39.s_country, t39.s_gmt_offset, t39.s_tax_percentage, t39.c_customer_sk, t39.c_customer_id, t39.c_current_cdemo_sk, t39.c_current_hdemo_sk, t39.c_current_addr_sk, t39.c_first_shipto_date_sk, t39.c_first_sales_date_sk, t39.c_salutation, t39.c_first_name, t39.c_last_name, t39.c_preferred_cust_flag, t39.c_birth_day, t39.c_birth_month, t39.c_birth_year, t39.c_birth_country, t39.c_login, t39.c_email_address, t39.c_last_review_date_sk, t39.cd_demo_sk, t39.cd_gender, t39.cd_marital_status, t39.cd_education_status, t39.cd_purchase_estimate, t39.cd_credit_rating, t39.cd_dep_count, t39.cd_dep_employed_count, t39.cd_dep_college_count, t39.cd_demo_sk0, t39.cd_gender0, t39.cd_marital_status0, t39.cd_education_status0, t39.cd_purchase_estimate0, t39.cd_credit_rating0, t39.cd_dep_count0, t39.cd_dep_employed_count0, t39.cd_dep_college_count0, t39.p_promo_sk, t39.p_promo_id, t39.p_start_date_sk, t39.p_end_date_sk, t39.p_item_sk, t39.p_cost, t39.p_response_target, t39.p_promo_name, t39.p_channel_dmail, t39.p_channel_email, t39.p_channel_catalog, t39.p_channel_tv, t39.p_channel_radio, t39.p_channel_press, t39.p_channel_event, t39.p_channel_demo, t39.p_channel_details, t39.p_purpose, t39.p_discount_active, t39.hd_demo_sk, t39.hd_income_band_sk, t39.hd_buy_potential, t39.hd_dep_count, t39.hd_vehicle_count, t39.hd_demo_sk0, t39.hd_income_band_sk0, t39.hd_buy_potential0, t39.hd_dep_count0, t39.hd_vehicle_count0, t39.ca_address_sk, t39.ca_address_id, t39.ca_street_number, t39.ca_street_name, t39.ca_street_type, t39.ca_suite_number, t39.ca_city, t39.ca_county, t39.ca_state, t39.ca_zip, t39.ca_country, t39.ca_gmt_offset, t39.ca_location_type, t39.ca_address_sk0, t39.ca_address_id0, t39.ca_street_number0, t39.ca_street_name0, t39.ca_street_type0, t39.ca_suite_number0, t39.ca_city0, t39.ca_county0, t39.ca_state0, t39.ca_zip0, t39.ca_country0, t39.ca_gmt_offset0, t39.ca_location_type0, income_band2.ib_income_band_sk, income_band2.ib_lower_bound, income_band2.ib_upper_bound\nFROM income_band AS income_band2\nINNER JOIN (SELECT t38.ss_sold_date_sk, t38.ss_sold_time_sk, t38.ss_item_sk, t38.ss_customer_sk, t38.ss_cdemo_sk, t38.ss_hdemo_sk, t38.ss_addr_sk, t38.ss_store_sk, t38.ss_promo_sk, t38.ss_ticket_number, t38.ss_quantity, t38.ss_wholesale_cost, t38.ss_list_price, t38.ss_sales_price, t38.ss_ext_discount_amt, t38.ss_ext_sales_price, t38.ss_ext_wholesale_cost, t38.ss_ext_list_price, t38.ss_ext_tax, t38.ss_coupon_amt, t38.ss_net_paid, t38.ss_net_paid_inc_tax, t38.ss_net_profit, t38.sr_returned_date_sk, t38.sr_return_time_sk, t38.sr_item_sk, t38.sr_customer_sk, t38.sr_cdemo_sk, t38.sr_hdemo_sk, t38.sr_addr_sk, t38.sr_store_sk, t38.sr_reason_sk, t38.sr_ticket_number, t38.sr_return_quantity, t38.sr_return_amt, t38.sr_return_tax, t38.sr_return_amt_inc_tax, t38.sr_fee, t38.sr_return_ship_cost, t38.sr_refunded_cash, t38.sr_reversed_charge, t38.sr_store_credit, t38.sr_net_loss, t38.CS_ITEM_SK, t38.SALE, t38.REFUND, t38.d_date_sk, t38.d_date_id, t38.d_date, t38.d_month_seq, t38.d_week_seq, t38.d_quarter_seq, t38.d_year, t38.d_dow, t38.d_moy, t38.d_dom, t38.d_qoy, t38.d_fy_year, t38.d_fy_quarter_seq, t38.d_fy_week_seq, t38.d_day_name, t38.d_quarter_name, t38.d_holiday, t38.d_weekend, t38.d_following_holiday, t38.d_first_dom, t38.d_last_dom, t38.d_same_day_ly, t38.d_same_day_lq, t38.d_current_day, t38.d_current_week, t38.d_current_month, t38.d_current_quarter, t38.d_current_year, t38.d_date_sk0, t38.d_date_id0, t38.d_date0, t38.d_month_seq0, t38.d_week_seq0, t38.d_quarter_seq0, t38.d_year0, t38.d_dow0, t38.d_moy0, t38.d_dom0, t38.d_qoy0, t38.d_fy_year0, t38.d_fy_quarter_seq0, t38.d_fy_week_seq0, t38.d_day_name0, t38.d_quarter_name0, t38.d_holiday0, t38.d_weekend0, t38.d_following_holiday0, t38.d_first_dom0, t38.d_last_dom0, t38.d_same_day_ly0, t38.d_same_day_lq0, t38.d_current_day0, t38.d_current_week0, t38.d_current_month0, t38.d_current_quarter0, t38.d_current_year0, t38.d_date_sk1, t38.d_date_id1, t38.d_date1, t38.d_month_seq1, t38.d_week_seq1, t38.d_quarter_seq1, t38.d_year1, t38.d_dow1, t38.d_moy1, t38.d_dom1, t38.d_qoy1, t38.d_fy_year1, t38.d_fy_quarter_seq1, t38.d_fy_week_seq1, t38.d_day_name1, t38.d_quarter_name1, t38.d_holiday1, t38.d_weekend1, t38.d_following_holiday1, t38.d_first_dom1, t38.d_last_dom1, t38.d_same_day_ly1, t38.d_same_day_lq1, t38.d_current_day1, t38.d_current_week1, t38.d_current_month1, t38.d_current_quarter1, t38.d_current_year1, t38.s_store_sk, t38.s_store_id, t38.s_rec_start_date, t38.s_rec_end_date, t38.s_closed_date_sk, t38.s_store_name, t38.s_number_employees, t38.s_floor_space, t38.s_hours, t38.s_manager, t38.s_market_id, t38.s_geography_class, t38.s_market_desc, t38.s_market_manager, t38.s_division_id, t38.s_division_name, t38.s_company_id, t38.s_company_name, t38.s_street_number, t38.s_street_name, t38.s_street_type, t38.s_suite_number, t38.s_city, t38.s_county, t38.s_state, t38.s_zip, t38.s_country, t38.s_gmt_offset, t38.s_tax_percentage, t38.c_customer_sk, t38.c_customer_id, t38.c_current_cdemo_sk, t38.c_current_hdemo_sk, t38.c_current_addr_sk, t38.c_first_shipto_date_sk, t38.c_first_sales_date_sk, t38.c_salutation, t38.c_first_name, t38.c_last_name, t38.c_preferred_cust_flag, t38.c_birth_day, t38.c_birth_month, t38.c_birth_year, t38.c_birth_country, t38.c_login, t38.c_email_address, t38.c_last_review_date_sk, t38.cd_demo_sk, t38.cd_gender, t38.cd_marital_status, t38.cd_education_status, t38.cd_purchase_estimate, t38.cd_credit_rating, t38.cd_dep_count, t38.cd_dep_employed_count, t38.cd_dep_college_count, t38.cd_demo_sk0, t38.cd_gender0, t38.cd_marital_status0, t38.cd_education_status0, t38.cd_purchase_estimate0, t38.cd_credit_rating0, t38.cd_dep_count0, t38.cd_dep_employed_count0, t38.cd_dep_college_count0, t38.p_promo_sk, t38.p_promo_id, t38.p_start_date_sk, t38.p_end_date_sk, t38.p_item_sk, t38.p_cost, t38.p_response_target, t38.p_promo_name, t38.p_channel_dmail, t38.p_channel_email, t38.p_channel_catalog, t38.p_channel_tv, t38.p_channel_radio, t38.p_channel_press, t38.p_channel_event, t38.p_channel_demo, t38.p_channel_details, t38.p_purpose, t38.p_discount_active, t38.hd_demo_sk, t38.hd_income_band_sk, t38.hd_buy_potential, t38.hd_dep_count, t38.hd_vehicle_count, t38.hd_demo_sk0, t38.hd_income_band_sk0, t38.hd_buy_potential0, t38.hd_dep_count0, t38.hd_vehicle_count0, t38.ca_address_sk, t38.ca_address_id, t38.ca_street_number, t38.ca_street_name, t38.ca_street_type, t38.ca_suite_number, t38.ca_city, t38.ca_county, t38.ca_state, t38.ca_zip, t38.ca_country, t38.ca_gmt_offset, t38.ca_location_type, customer_address1.ca_address_sk AS ca_address_sk0, customer_address1.ca_address_id AS ca_address_id0, customer_address1.ca_street_number AS ca_street_number0, customer_address1.ca_street_name AS ca_street_name0, customer_address1.ca_street_type AS ca_street_type0, customer_address1.ca_suite_number AS ca_suite_number0, customer_address1.ca_city AS ca_city0, customer_address1.ca_county AS ca_county0, customer_address1.ca_state AS ca_state0, customer_address1.ca_zip AS ca_zip0, customer_address1.ca_country AS ca_country0, customer_address1.ca_gmt_offset AS ca_gmt_offset0, customer_address1.ca_location_type AS ca_location_type0\nFROM customer_address AS customer_address1\nINNER JOIN (SELECT t37.ss_sold_date_sk, t37.ss_sold_time_sk, t37.ss_item_sk, t37.ss_customer_sk, t37.ss_cdemo_sk, t37.ss_hdemo_sk, t37.ss_addr_sk, t37.ss_store_sk, t37.ss_promo_sk, t37.ss_ticket_number, t37.ss_quantity, t37.ss_wholesale_cost, t37.ss_list_price, t37.ss_sales_price, t37.ss_ext_discount_amt, t37.ss_ext_sales_price, t37.ss_ext_wholesale_cost, t37.ss_ext_list_price, t37.ss_ext_tax, t37.ss_coupon_amt, t37.ss_net_paid, t37.ss_net_paid_inc_tax, t37.ss_net_profit, t37.sr_returned_date_sk, t37.sr_return_time_sk, t37.sr_item_sk, t37.sr_customer_sk, t37.sr_cdemo_sk, t37.sr_hdemo_sk, t37.sr_addr_sk, t37.sr_store_sk, t37.sr_reason_sk, t37.sr_ticket_number, t37.sr_return_quantity, t37.sr_return_amt, t37.sr_return_tax, t37.sr_return_amt_inc_tax, t37.sr_fee, t37.sr_return_ship_cost, t37.sr_refunded_cash, t37.sr_reversed_charge, t37.sr_store_credit, t37.sr_net_loss, t37.CS_ITEM_SK, t37.SALE, t37.REFUND, t37.d_date_sk, t37.d_date_id, t37.d_date, t37.d_month_seq, t37.d_week_seq, t37.d_quarter_seq, t37.d_year, t37.d_dow, t37.d_moy, t37.d_dom, t37.d_qoy, t37.d_fy_year, t37.d_fy_quarter_seq, t37.d_fy_week_seq, t37.d_day_name, t37.d_quarter_name, t37.d_holiday, t37.d_weekend, t37.d_following_holiday, t37.d_first_dom, t37.d_last_dom, t37.d_same_day_ly, t37.d_same_day_lq, t37.d_current_day, t37.d_current_week, t37.d_current_month, t37.d_current_quarter, t37.d_current_year, t37.d_date_sk0, t37.d_date_id0, t37.d_date0, t37.d_month_seq0, t37.d_week_seq0, t37.d_quarter_seq0, t37.d_year0, t37.d_dow0, t37.d_moy0, t37.d_dom0, t37.d_qoy0, t37.d_fy_year0, t37.d_fy_quarter_seq0, t37.d_fy_week_seq0, t37.d_day_name0, t37.d_quarter_name0, t37.d_holiday0, t37.d_weekend0, t37.d_following_holiday0, t37.d_first_dom0, t37.d_last_dom0, t37.d_same_day_ly0, t37.d_same_day_lq0, t37.d_current_day0, t37.d_current_week0, t37.d_current_month0, t37.d_current_quarter0, t37.d_current_year0, t37.d_date_sk1, t37.d_date_id1, t37.d_date1, t37.d_month_seq1, t37.d_week_seq1, t37.d_quarter_seq1, t37.d_year1, t37.d_dow1, t37.d_moy1, t37.d_dom1, t37.d_qoy1, t37.d_fy_year1, t37.d_fy_quarter_seq1, t37.d_fy_week_seq1, t37.d_day_name1, t37.d_quarter_name1, t37.d_holiday1, t37.d_weekend1, t37.d_following_holiday1, t37.d_first_dom1, t37.d_last_dom1, t37.d_same_day_ly1, t37.d_same_day_lq1, t37.d_current_day1, t37.d_current_week1, t37.d_current_month1, t37.d_current_quarter1, t37.d_current_year1, t37.s_store_sk, t37.s_store_id, t37.s_rec_start_date, t37.s_rec_end_date, t37.s_closed_date_sk, t37.s_store_name, t37.s_number_employees, t37.s_floor_space, t37.s_hours, t37.s_manager, t37.s_market_id, t37.s_geography_class, t37.s_market_desc, t37.s_market_manager, t37.s_division_id, t37.s_division_name, t37.s_company_id, t37.s_company_name, t37.s_street_number, t37.s_street_name, t37.s_street_type, t37.s_suite_number, t37.s_city, t37.s_county, t37.s_state, t37.s_zip, t37.s_country, t37.s_gmt_offset, t37.s_tax_percentage, t37.c_customer_sk, t37.c_customer_id, t37.c_current_cdemo_sk, t37.c_current_hdemo_sk, t37.c_current_addr_sk, t37.c_first_shipto_date_sk, t37.c_first_sales_date_sk, t37.c_salutation, t37.c_first_name, t37.c_last_name, t37.c_preferred_cust_flag, t37.c_birth_day, t37.c_birth_month, t37.c_birth_year, t37.c_birth_country, t37.c_login, t37.c_email_address, t37.c_last_review_date_sk, t37.cd_demo_sk, t37.cd_gender, t37.cd_marital_status, t37.cd_education_status, t37.cd_purchase_estimate, t37.cd_credit_rating, t37.cd_dep_count, t37.cd_dep_employed_count, t37.cd_dep_college_count, t37.cd_demo_sk0, t37.cd_gender0, t37.cd_marital_status0, t37.cd_education_status0, t37.cd_purchase_estimate0, t37.cd_credit_rating0, t37.cd_dep_count0, t37.cd_dep_employed_count0, t37.cd_dep_college_count0, t37.p_promo_sk, t37.p_promo_id, t37.p_start_date_sk, t37.p_end_date_sk, t37.p_item_sk, t37.p_cost, t37.p_response_target, t37.p_promo_name, t37.p_channel_dmail, t37.p_channel_email, t37.p_channel_catalog, t37.p_channel_tv, t37.p_channel_radio, t37.p_channel_press, t37.p_channel_event, t37.p_channel_demo, t37.p_channel_details, t37.p_purpose, t37.p_discount_active, t37.hd_demo_sk, t37.hd_income_band_sk, t37.hd_buy_potential, t37.hd_dep_count, t37.hd_vehicle_count, t37.hd_demo_sk0, t37.hd_income_band_sk0, t37.hd_buy_potential0, t37.hd_dep_count0, t37.hd_vehicle_count0, customer_address2.ca_address_sk, customer_address2.ca_address_id, customer_address2.ca_street_number, customer_address2.ca_street_name, customer_address2.ca_street_type, customer_address2.ca_suite_number, customer_address2.ca_city, customer_address2.ca_county, customer_address2.ca_state, customer_address2.ca_zip, customer_address2.ca_country, customer_address2.ca_gmt_offset, customer_address2.ca_location_type\nFROM customer_address AS customer_address2\nINNER JOIN (SELECT t36.ss_sold_date_sk, t36.ss_sold_time_sk, t36.ss_item_sk, t36.ss_customer_sk, t36.ss_cdemo_sk, t36.ss_hdemo_sk, t36.ss_addr_sk, t36.ss_store_sk, t36.ss_promo_sk, t36.ss_ticket_number, t36.ss_quantity, t36.ss_wholesale_cost, t36.ss_list_price, t36.ss_sales_price, t36.ss_ext_discount_amt, t36.ss_ext_sales_price, t36.ss_ext_wholesale_cost, t36.ss_ext_list_price, t36.ss_ext_tax, t36.ss_coupon_amt, t36.ss_net_paid, t36.ss_net_paid_inc_tax, t36.ss_net_profit, t36.sr_returned_date_sk, t36.sr_return_time_sk, t36.sr_item_sk, t36.sr_customer_sk, t36.sr_cdemo_sk, t36.sr_hdemo_sk, t36.sr_addr_sk, t36.sr_store_sk, t36.sr_reason_sk, t36.sr_ticket_number, t36.sr_return_quantity, t36.sr_return_amt, t36.sr_return_tax, t36.sr_return_amt_inc_tax, t36.sr_fee, t36.sr_return_ship_cost, t36.sr_refunded_cash, t36.sr_reversed_charge, t36.sr_store_credit, t36.sr_net_loss, t36.CS_ITEM_SK, t36.SALE, t36.REFUND, t36.d_date_sk, t36.d_date_id, t36.d_date, t36.d_month_seq, t36.d_week_seq, t36.d_quarter_seq, t36.d_year, t36.d_dow, t36.d_moy, t36.d_dom, t36.d_qoy, t36.d_fy_year, t36.d_fy_quarter_seq, t36.d_fy_week_seq, t36.d_day_name, t36.d_quarter_name, t36.d_holiday, t36.d_weekend, t36.d_following_holiday, t36.d_first_dom, t36.d_last_dom, t36.d_same_day_ly, t36.d_same_day_lq, t36.d_current_day, t36.d_current_week, t36.d_current_month, t36.d_current_quarter, t36.d_current_year, t36.d_date_sk0, t36.d_date_id0, t36.d_date0, t36.d_month_seq0, t36.d_week_seq0, t36.d_quarter_seq0, t36.d_year0, t36.d_dow0, t36.d_moy0, t36.d_dom0, t36.d_qoy0, t36.d_fy_year0, t36.d_fy_quarter_seq0, t36.d_fy_week_seq0, t36.d_day_name0, t36.d_quarter_name0, t36.d_holiday0, t36.d_weekend0, t36.d_following_holiday0, t36.d_first_dom0, t36.d_last_dom0, t36.d_same_day_ly0, t36.d_same_day_lq0, t36.d_current_day0, t36.d_current_week0, t36.d_current_month0, t36.d_current_quarter0, t36.d_current_year0, t36.d_date_sk1, t36.d_date_id1, t36.d_date1, t36.d_month_seq1, t36.d_week_seq1, t36.d_quarter_seq1, t36.d_year1, t36.d_dow1, t36.d_moy1, t36.d_dom1, t36.d_qoy1, t36.d_fy_year1, t36.d_fy_quarter_seq1, t36.d_fy_week_seq1, t36.d_day_name1, t36.d_quarter_name1, t36.d_holiday1, t36.d_weekend1, t36.d_following_holiday1, t36.d_first_dom1, t36.d_last_dom1, t36.d_same_day_ly1, t36.d_same_day_lq1, t36.d_current_day1, t36.d_current_week1, t36.d_current_month1, t36.d_current_quarter1, t36.d_current_year1, t36.s_store_sk, t36.s_store_id, t36.s_rec_start_date, t36.s_rec_end_date, t36.s_closed_date_sk, t36.s_store_name, t36.s_number_employees, t36.s_floor_space, t36.s_hours, t36.s_manager, t36.s_market_id, t36.s_geography_class, t36.s_market_desc, t36.s_market_manager, t36.s_division_id, t36.s_division_name, t36.s_company_id, t36.s_company_name, t36.s_street_number, t36.s_street_name, t36.s_street_type, t36.s_suite_number, t36.s_city, t36.s_county, t36.s_state, t36.s_zip, t36.s_country, t36.s_gmt_offset, t36.s_tax_percentage, t36.c_customer_sk, t36.c_customer_id, t36.c_current_cdemo_sk, t36.c_current_hdemo_sk, t36.c_current_addr_sk, t36.c_first_shipto_date_sk, t36.c_first_sales_date_sk, t36.c_salutation, t36.c_first_name, t36.c_last_name, t36.c_preferred_cust_flag, t36.c_birth_day, t36.c_birth_month, t36.c_birth_year, t36.c_birth_country, t36.c_login, t36.c_email_address, t36.c_last_review_date_sk, t36.cd_demo_sk, t36.cd_gender, t36.cd_marital_status, t36.cd_education_status, t36.cd_purchase_estimate, t36.cd_credit_rating, t36.cd_dep_count, t36.cd_dep_employed_count, t36.cd_dep_college_count, t36.cd_demo_sk0, t36.cd_gender0, t36.cd_marital_status0, t36.cd_education_status0, t36.cd_purchase_estimate0, t36.cd_credit_rating0, t36.cd_dep_count0, t36.cd_dep_employed_count0, t36.cd_dep_college_count0, t36.p_promo_sk, t36.p_promo_id, t36.p_start_date_sk, t36.p_end_date_sk, t36.p_item_sk, t36.p_cost, t36.p_response_target, t36.p_promo_name, t36.p_channel_dmail, t36.p_channel_email, t36.p_channel_catalog, t36.p_channel_tv, t36.p_channel_radio, t36.p_channel_press, t36.p_channel_event, t36.p_channel_demo, t36.p_channel_details, t36.p_purpose, t36.p_discount_active, t36.hd_demo_sk, t36.hd_income_band_sk, t36.hd_buy_potential, t36.hd_dep_count, t36.hd_vehicle_count, household_demographics1.hd_demo_sk AS hd_demo_sk0, household_demographics1.hd_income_band_sk AS hd_income_band_sk0, household_demographics1.hd_buy_potential AS hd_buy_potential0, household_demographics1.hd_dep_count AS hd_dep_count0, household_demographics1.hd_vehicle_count AS hd_vehicle_count0\nFROM household_demographics AS household_demographics1\nINNER JOIN (SELECT t35.ss_sold_date_sk, t35.ss_sold_time_sk, t35.ss_item_sk, t35.ss_customer_sk, t35.ss_cdemo_sk, t35.ss_hdemo_sk, t35.ss_addr_sk, t35.ss_store_sk, t35.ss_promo_sk, t35.ss_ticket_number, t35.ss_quantity, t35.ss_wholesale_cost, t35.ss_list_price, t35.ss_sales_price, t35.ss_ext_discount_amt, t35.ss_ext_sales_price, t35.ss_ext_wholesale_cost, t35.ss_ext_list_price, t35.ss_ext_tax, t35.ss_coupon_amt, t35.ss_net_paid, t35.ss_net_paid_inc_tax, t35.ss_net_profit, t35.sr_returned_date_sk, t35.sr_return_time_sk, t35.sr_item_sk, t35.sr_customer_sk, t35.sr_cdemo_sk, t35.sr_hdemo_sk, t35.sr_addr_sk, t35.sr_store_sk, t35.sr_reason_sk, t35.sr_ticket_number, t35.sr_return_quantity, t35.sr_return_amt, t35.sr_return_tax, t35.sr_return_amt_inc_tax, t35.sr_fee, t35.sr_return_ship_cost, t35.sr_refunded_cash, t35.sr_reversed_charge, t35.sr_store_credit, t35.sr_net_loss, t35.CS_ITEM_SK, t35.SALE, t35.REFUND, t35.d_date_sk, t35.d_date_id, t35.d_date, t35.d_month_seq, t35.d_week_seq, t35.d_quarter_seq, t35.d_year, t35.d_dow, t35.d_moy, t35.d_dom, t35.d_qoy, t35.d_fy_year, t35.d_fy_quarter_seq, t35.d_fy_week_seq, t35.d_day_name, t35.d_quarter_name, t35.d_holiday, t35.d_weekend, t35.d_following_holiday, t35.d_first_dom, t35.d_last_dom, t35.d_same_day_ly, t35.d_same_day_lq, t35.d_current_day, t35.d_current_week, t35.d_current_month, t35.d_current_quarter, t35.d_current_year, t35.d_date_sk0, t35.d_date_id0, t35.d_date0, t35.d_month_seq0, t35.d_week_seq0, t35.d_quarter_seq0, t35.d_year0, t35.d_dow0, t35.d_moy0, t35.d_dom0, t35.d_qoy0, t35.d_fy_year0, t35.d_fy_quarter_seq0, t35.d_fy_week_seq0, t35.d_day_name0, t35.d_quarter_name0, t35.d_holiday0, t35.d_weekend0, t35.d_following_holiday0, t35.d_first_dom0, t35.d_last_dom0, t35.d_same_day_ly0, t35.d_same_day_lq0, t35.d_current_day0, t35.d_current_week0, t35.d_current_month0, t35.d_current_quarter0, t35.d_current_year0, t35.d_date_sk1, t35.d_date_id1, t35.d_date1, t35.d_month_seq1, t35.d_week_seq1, t35.d_quarter_seq1, t35.d_year1, t35.d_dow1, t35.d_moy1, t35.d_dom1, t35.d_qoy1, t35.d_fy_year1, t35.d_fy_quarter_seq1, t35.d_fy_week_seq1, t35.d_day_name1, t35.d_quarter_name1, t35.d_holiday1, t35.d_weekend1, t35.d_following_holiday1, t35.d_first_dom1, t35.d_last_dom1, t35.d_same_day_ly1, t35.d_same_day_lq1, t35.d_current_day1, t35.d_current_week1, t35.d_current_month1, t35.d_current_quarter1, t35.d_current_year1, t35.s_store_sk, t35.s_store_id, t35.s_rec_start_date, t35.s_rec_end_date, t35.s_closed_date_sk, t35.s_store_name, t35.s_number_employees, t35.s_floor_space, t35.s_hours, t35.s_manager, t35.s_market_id, t35.s_geography_class, t35.s_market_desc, t35.s_market_manager, t35.s_division_id, t35.s_division_name, t35.s_company_id, t35.s_company_name, t35.s_street_number, t35.s_street_name, t35.s_street_type, t35.s_suite_number, t35.s_city, t35.s_county, t35.s_state, t35.s_zip, t35.s_country, t35.s_gmt_offset, t35.s_tax_percentage, t35.c_customer_sk, t35.c_customer_id, t35.c_current_cdemo_sk, t35.c_current_hdemo_sk, t35.c_current_addr_sk, t35.c_first_shipto_date_sk, t35.c_first_sales_date_sk, t35.c_salutation, t35.c_first_name, t35.c_last_name, t35.c_preferred_cust_flag, t35.c_birth_day, t35.c_birth_month, t35.c_birth_year, t35.c_birth_country, t35.c_login, t35.c_email_address, t35.c_last_review_date_sk, t35.cd_demo_sk, t35.cd_gender, t35.cd_marital_status, t35.cd_education_status, t35.cd_purchase_estimate, t35.cd_credit_rating, t35.cd_dep_count, t35.cd_dep_employed_count, t35.cd_dep_college_count, t35.cd_demo_sk0, t35.cd_gender0, t35.cd_marital_status0, t35.cd_education_status0, t35.cd_purchase_estimate0, t35.cd_credit_rating0, t35.cd_dep_count0, t35.cd_dep_employed_count0, t35.cd_dep_college_count0, t35.p_promo_sk, t35.p_promo_id, t35.p_start_date_sk, t35.p_end_date_sk, t35.p_item_sk, t35.p_cost, t35.p_response_target, t35.p_promo_name, t35.p_channel_dmail, t35.p_channel_email, t35.p_channel_catalog, t35.p_channel_tv, t35.p_channel_radio, t35.p_channel_press, t35.p_channel_event, t35.p_channel_demo, t35.p_channel_details, t35.p_purpose, t35.p_discount_active, household_demographics2.hd_demo_sk, household_demographics2.hd_income_band_sk, household_demographics2.hd_buy_potential, household_demographics2.hd_dep_count, household_demographics2.hd_vehicle_count\nFROM household_demographics AS household_demographics2\nINNER JOIN (SELECT t34.ss_sold_date_sk, t34.ss_sold_time_sk, t34.ss_item_sk, t34.ss_customer_sk, t34.ss_cdemo_sk, t34.ss_hdemo_sk, t34.ss_addr_sk, t34.ss_store_sk, t34.ss_promo_sk, t34.ss_ticket_number, t34.ss_quantity, t34.ss_wholesale_cost, t34.ss_list_price, t34.ss_sales_price, t34.ss_ext_discount_amt, t34.ss_ext_sales_price, t34.ss_ext_wholesale_cost, t34.ss_ext_list_price, t34.ss_ext_tax, t34.ss_coupon_amt, t34.ss_net_paid, t34.ss_net_paid_inc_tax, t34.ss_net_profit, t34.sr_returned_date_sk, t34.sr_return_time_sk, t34.sr_item_sk, t34.sr_customer_sk, t34.sr_cdemo_sk, t34.sr_hdemo_sk, t34.sr_addr_sk, t34.sr_store_sk, t34.sr_reason_sk, t34.sr_ticket_number, t34.sr_return_quantity, t34.sr_return_amt, t34.sr_return_tax, t34.sr_return_amt_inc_tax, t34.sr_fee, t34.sr_return_ship_cost, t34.sr_refunded_cash, t34.sr_reversed_charge, t34.sr_store_credit, t34.sr_net_loss, t34.CS_ITEM_SK, t34.SALE, t34.REFUND, t34.d_date_sk, t34.d_date_id, t34.d_date, t34.d_month_seq, t34.d_week_seq, t34.d_quarter_seq, t34.d_year, t34.d_dow, t34.d_moy, t34.d_dom, t34.d_qoy, t34.d_fy_year, t34.d_fy_quarter_seq, t34.d_fy_week_seq, t34.d_day_name, t34.d_quarter_name, t34.d_holiday, t34.d_weekend, t34.d_following_holiday, t34.d_first_dom, t34.d_last_dom, t34.d_same_day_ly, t34.d_same_day_lq, t34.d_current_day, t34.d_current_week, t34.d_current_month, t34.d_current_quarter, t34.d_current_year, t34.d_date_sk0, t34.d_date_id0, t34.d_date0, t34.d_month_seq0, t34.d_week_seq0, t34.d_quarter_seq0, t34.d_year0, t34.d_dow0, t34.d_moy0, t34.d_dom0, t34.d_qoy0, t34.d_fy_year0, t34.d_fy_quarter_seq0, t34.d_fy_week_seq0, t34.d_day_name0, t34.d_quarter_name0, t34.d_holiday0, t34.d_weekend0, t34.d_following_holiday0, t34.d_first_dom0, t34.d_last_dom0, t34.d_same_day_ly0, t34.d_same_day_lq0, t34.d_current_day0, t34.d_current_week0, t34.d_current_month0, t34.d_current_quarter0, t34.d_current_year0, t34.d_date_sk1, t34.d_date_id1, t34.d_date1, t34.d_month_seq1, t34.d_week_seq1, t34.d_quarter_seq1, t34.d_year1, t34.d_dow1, t34.d_moy1, t34.d_dom1, t34.d_qoy1, t34.d_fy_year1, t34.d_fy_quarter_seq1, t34.d_fy_week_seq1, t34.d_day_name1, t34.d_quarter_name1, t34.d_holiday1, t34.d_weekend1, t34.d_following_holiday1, t34.d_first_dom1, t34.d_last_dom1, t34.d_same_day_ly1, t34.d_same_day_lq1, t34.d_current_day1, t34.d_current_week1, t34.d_current_month1, t34.d_current_quarter1, t34.d_current_year1, t34.s_store_sk, t34.s_store_id, t34.s_rec_start_date, t34.s_rec_end_date, t34.s_closed_date_sk, t34.s_store_name, t34.s_number_employees, t34.s_floor_space, t34.s_hours, t34.s_manager, t34.s_market_id, t34.s_geography_class, t34.s_market_desc, t34.s_market_manager, t34.s_division_id, t34.s_division_name, t34.s_company_id, t34.s_company_name, t34.s_street_number, t34.s_street_name, t34.s_street_type, t34.s_suite_number, t34.s_city, t34.s_county, t34.s_state, t34.s_zip, t34.s_country, t34.s_gmt_offset, t34.s_tax_percentage, t34.c_customer_sk, t34.c_customer_id, t34.c_current_cdemo_sk, t34.c_current_hdemo_sk, t34.c_current_addr_sk, t34.c_first_shipto_date_sk, t34.c_first_sales_date_sk, t34.c_salutation, t34.c_first_name, t34.c_last_name, t34.c_preferred_cust_flag, t34.c_birth_day, t34.c_birth_month, t34.c_birth_year, t34.c_birth_country, t34.c_login, t34.c_email_address, t34.c_last_review_date_sk, t34.cd_demo_sk, t34.cd_gender, t34.cd_marital_status, t34.cd_education_status, t34.cd_purchase_estimate, t34.cd_credit_rating, t34.cd_dep_count, t34.cd_dep_employed_count, t34.cd_dep_college_count, t34.cd_demo_sk0, t34.cd_gender0, t34.cd_marital_status0, t34.cd_education_status0, t34.cd_purchase_estimate0, t34.cd_credit_rating0, t34.cd_dep_count0, t34.cd_dep_employed_count0, t34.cd_dep_college_count0, promotion0.p_promo_sk, promotion0.p_promo_id, promotion0.p_start_date_sk, promotion0.p_end_date_sk, promotion0.p_item_sk, promotion0.p_cost, promotion0.p_response_target, promotion0.p_promo_name, promotion0.p_channel_dmail, promotion0.p_channel_email, promotion0.p_channel_catalog, promotion0.p_channel_tv, promotion0.p_channel_radio, promotion0.p_channel_press, promotion0.p_channel_event, promotion0.p_channel_demo, promotion0.p_channel_details, promotion0.p_purpose, promotion0.p_discount_active\nFROM promotion AS promotion0\nINNER JOIN (SELECT t33.ss_sold_date_sk, t33.ss_sold_time_sk, t33.ss_item_sk, t33.ss_customer_sk, t33.ss_cdemo_sk, t33.ss_hdemo_sk, t33.ss_addr_sk, t33.ss_store_sk, t33.ss_promo_sk, t33.ss_ticket_number, t33.ss_quantity, t33.ss_wholesale_cost, t33.ss_list_price, t33.ss_sales_price, t33.ss_ext_discount_amt, t33.ss_ext_sales_price, t33.ss_ext_wholesale_cost, t33.ss_ext_list_price, t33.ss_ext_tax, t33.ss_coupon_amt, t33.ss_net_paid, t33.ss_net_paid_inc_tax, t33.ss_net_profit, t33.sr_returned_date_sk, t33.sr_return_time_sk, t33.sr_item_sk, t33.sr_customer_sk, t33.sr_cdemo_sk, t33.sr_hdemo_sk, t33.sr_addr_sk, t33.sr_store_sk, t33.sr_reason_sk, t33.sr_ticket_number, t33.sr_return_quantity, t33.sr_return_amt, t33.sr_return_tax, t33.sr_return_amt_inc_tax, t33.sr_fee, t33.sr_return_ship_cost, t33.sr_refunded_cash, t33.sr_reversed_charge, t33.sr_store_credit, t33.sr_net_loss, t33.CS_ITEM_SK, t33.SALE, t33.REFUND, t33.d_date_sk, t33.d_date_id, t33.d_date, t33.d_month_seq, t33.d_week_seq, t33.d_quarter_seq, t33.d_year, t33.d_dow, t33.d_moy, t33.d_dom, t33.d_qoy, t33.d_fy_year, t33.d_fy_quarter_seq, t33.d_fy_week_seq, t33.d_day_name, t33.d_quarter_name, t33.d_holiday, t33.d_weekend, t33.d_following_holiday, t33.d_first_dom, t33.d_last_dom, t33.d_same_day_ly, t33.d_same_day_lq, t33.d_current_day, t33.d_current_week, t33.d_current_month, t33.d_current_quarter, t33.d_current_year, t33.d_date_sk0, t33.d_date_id0, t33.d_date0, t33.d_month_seq0, t33.d_week_seq0, t33.d_quarter_seq0, t33.d_year0, t33.d_dow0, t33.d_moy0, t33.d_dom0, t33.d_qoy0, t33.d_fy_year0, t33.d_fy_quarter_seq0, t33.d_fy_week_seq0, t33.d_day_name0, t33.d_quarter_name0, t33.d_holiday0, t33.d_weekend0, t33.d_following_holiday0, t33.d_first_dom0, t33.d_last_dom0, t33.d_same_day_ly0, t33.d_same_day_lq0, t33.d_current_day0, t33.d_current_week0, t33.d_current_month0, t33.d_current_quarter0, t33.d_current_year0, t33.d_date_sk1, t33.d_date_id1, t33.d_date1, t33.d_month_seq1, t33.d_week_seq1, t33.d_quarter_seq1, t33.d_year1, t33.d_dow1, t33.d_moy1, t33.d_dom1, t33.d_qoy1, t33.d_fy_year1, t33.d_fy_quarter_seq1, t33.d_fy_week_seq1, t33.d_day_name1, t33.d_quarter_name1, t33.d_holiday1, t33.d_weekend1, t33.d_following_holiday1, t33.d_first_dom1, t33.d_last_dom1, t33.d_same_day_ly1, t33.d_same_day_lq1, t33.d_current_day1, t33.d_current_week1, t33.d_current_month1, t33.d_current_quarter1, t33.d_current_year1, t33.s_store_sk, t33.s_store_id, t33.s_rec_start_date, t33.s_rec_end_date, t33.s_closed_date_sk, t33.s_store_name, t33.s_number_employees, t33.s_floor_space, t33.s_hours, t33.s_manager, t33.s_market_id, t33.s_geography_class, t33.s_market_desc, t33.s_market_manager, t33.s_division_id, t33.s_division_name, t33.s_company_id, t33.s_company_name, t33.s_street_number, t33.s_street_name, t33.s_street_type, t33.s_suite_number, t33.s_city, t33.s_county, t33.s_state, t33.s_zip, t33.s_country, t33.s_gmt_offset, t33.s_tax_percentage, t33.c_customer_sk, t33.c_customer_id, t33.c_current_cdemo_sk, t33.c_current_hdemo_sk, t33.c_current_addr_sk, t33.c_first_shipto_date_sk, t33.c_first_sales_date_sk, t33.c_salutation, t33.c_first_name, t33.c_last_name, t33.c_preferred_cust_flag, t33.c_birth_day, t33.c_birth_month, t33.c_birth_year, t33.c_birth_country, t33.c_login, t33.c_email_address, t33.c_last_review_date_sk, t33.cd_demo_sk, t33.cd_gender, t33.cd_marital_status, t33.cd_education_status, t33.cd_purchase_estimate, t33.cd_credit_rating, t33.cd_dep_count, t33.cd_dep_employed_count, t33.cd_dep_college_count, customer_demographics1.cd_demo_sk AS cd_demo_sk0, customer_demographics1.cd_gender AS cd_gender0, customer_demographics1.cd_marital_status AS cd_marital_status0, customer_demographics1.cd_education_status AS cd_education_status0, customer_demographics1.cd_purchase_estimate AS cd_purchase_estimate0, customer_demographics1.cd_credit_rating AS cd_credit_rating0, customer_demographics1.cd_dep_count AS cd_dep_count0, customer_demographics1.cd_dep_employed_count AS cd_dep_employed_count0, customer_demographics1.cd_dep_college_count AS cd_dep_college_count0\nFROM customer_demographics AS customer_demographics1\nINNER JOIN (SELECT t32.ss_sold_date_sk, t32.ss_sold_time_sk, t32.ss_item_sk, t32.ss_customer_sk, t32.ss_cdemo_sk, t32.ss_hdemo_sk, t32.ss_addr_sk, t32.ss_store_sk, t32.ss_promo_sk, t32.ss_ticket_number, t32.ss_quantity, t32.ss_wholesale_cost, t32.ss_list_price, t32.ss_sales_price, t32.ss_ext_discount_amt, t32.ss_ext_sales_price, t32.ss_ext_wholesale_cost, t32.ss_ext_list_price, t32.ss_ext_tax, t32.ss_coupon_amt, t32.ss_net_paid, t32.ss_net_paid_inc_tax, t32.ss_net_profit, t32.sr_returned_date_sk, t32.sr_return_time_sk, t32.sr_item_sk, t32.sr_customer_sk, t32.sr_cdemo_sk, t32.sr_hdemo_sk, t32.sr_addr_sk, t32.sr_store_sk, t32.sr_reason_sk, t32.sr_ticket_number, t32.sr_return_quantity, t32.sr_return_amt, t32.sr_return_tax, t32.sr_return_amt_inc_tax, t32.sr_fee, t32.sr_return_ship_cost, t32.sr_refunded_cash, t32.sr_reversed_charge, t32.sr_store_credit, t32.sr_net_loss, t32.CS_ITEM_SK, t32.SALE, t32.REFUND, t32.d_date_sk, t32.d_date_id, t32.d_date, t32.d_month_seq, t32.d_week_seq, t32.d_quarter_seq, t32.d_year, t32.d_dow, t32.d_moy, t32.d_dom, t32.d_qoy, t32.d_fy_year, t32.d_fy_quarter_seq, t32.d_fy_week_seq, t32.d_day_name, t32.d_quarter_name, t32.d_holiday, t32.d_weekend, t32.d_following_holiday, t32.d_first_dom, t32.d_last_dom, t32.d_same_day_ly, t32.d_same_day_lq, t32.d_current_day, t32.d_current_week, t32.d_current_month, t32.d_current_quarter, t32.d_current_year, t32.d_date_sk0, t32.d_date_id0, t32.d_date0, t32.d_month_seq0, t32.d_week_seq0, t32.d_quarter_seq0, t32.d_year0, t32.d_dow0, t32.d_moy0, t32.d_dom0, t32.d_qoy0, t32.d_fy_year0, t32.d_fy_quarter_seq0, t32.d_fy_week_seq0, t32.d_day_name0, t32.d_quarter_name0, t32.d_holiday0, t32.d_weekend0, t32.d_following_holiday0, t32.d_first_dom0, t32.d_last_dom0, t32.d_same_day_ly0, t32.d_same_day_lq0, t32.d_current_day0, t32.d_current_week0, t32.d_current_month0, t32.d_current_quarter0, t32.d_current_year0, t32.d_date_sk1, t32.d_date_id1, t32.d_date1, t32.d_month_seq1, t32.d_week_seq1, t32.d_quarter_seq1, t32.d_year1, t32.d_dow1, t32.d_moy1, t32.d_dom1, t32.d_qoy1, t32.d_fy_year1, t32.d_fy_quarter_seq1, t32.d_fy_week_seq1, t32.d_day_name1, t32.d_quarter_name1, t32.d_holiday1, t32.d_weekend1, t32.d_following_holiday1, t32.d_first_dom1, t32.d_last_dom1, t32.d_same_day_ly1, t32.d_same_day_lq1, t32.d_current_day1, t32.d_current_week1, t32.d_current_month1, t32.d_current_quarter1, t32.d_current_year1, t32.s_store_sk, t32.s_store_id, t32.s_rec_start_date, t32.s_rec_end_date, t32.s_closed_date_sk, t32.s_store_name, t32.s_number_employees, t32.s_floor_space, t32.s_hours, t32.s_manager, t32.s_market_id, t32.s_geography_class, t32.s_market_desc, t32.s_market_manager, t32.s_division_id, t32.s_division_name, t32.s_company_id, t32.s_company_name, t32.s_street_number, t32.s_street_name, t32.s_street_type, t32.s_suite_number, t32.s_city, t32.s_county, t32.s_state, t32.s_zip, t32.s_country, t32.s_gmt_offset, t32.s_tax_percentage, t32.c_customer_sk, t32.c_customer_id, t32.c_current_cdemo_sk, t32.c_current_hdemo_sk, t32.c_current_addr_sk, t32.c_first_shipto_date_sk, t32.c_first_sales_date_sk, t32.c_salutation, t32.c_first_name, t32.c_last_name, t32.c_preferred_cust_flag, t32.c_birth_day, t32.c_birth_month, t32.c_birth_year, t32.c_birth_country, t32.c_login, t32.c_email_address, t32.c_last_review_date_sk, customer_demographics2.cd_demo_sk, customer_demographics2.cd_gender, customer_demographics2.cd_marital_status, customer_demographics2.cd_education_status, customer_demographics2.cd_purchase_estimate, customer_demographics2.cd_credit_rating, customer_demographics2.cd_dep_count, customer_demographics2.cd_dep_employed_count, customer_demographics2.cd_dep_college_count\nFROM customer_demographics AS customer_demographics2\nINNER JOIN (SELECT t31.ss_sold_date_sk, t31.ss_sold_time_sk, t31.ss_item_sk, t31.ss_customer_sk, t31.ss_cdemo_sk, t31.ss_hdemo_sk, t31.ss_addr_sk, t31.ss_store_sk, t31.ss_promo_sk, t31.ss_ticket_number, t31.ss_quantity, t31.ss_wholesale_cost, t31.ss_list_price, t31.ss_sales_price, t31.ss_ext_discount_amt, t31.ss_ext_sales_price, t31.ss_ext_wholesale_cost, t31.ss_ext_list_price, t31.ss_ext_tax, t31.ss_coupon_amt, t31.ss_net_paid, t31.ss_net_paid_inc_tax, t31.ss_net_profit, t31.sr_returned_date_sk, t31.sr_return_time_sk, t31.sr_item_sk, t31.sr_customer_sk, t31.sr_cdemo_sk, t31.sr_hdemo_sk, t31.sr_addr_sk, t31.sr_store_sk, t31.sr_reason_sk, t31.sr_ticket_number, t31.sr_return_quantity, t31.sr_return_amt, t31.sr_return_tax, t31.sr_return_amt_inc_tax, t31.sr_fee, t31.sr_return_ship_cost, t31.sr_refunded_cash, t31.sr_reversed_charge, t31.sr_store_credit, t31.sr_net_loss, t31.CS_ITEM_SK, t31.SALE, t31.REFUND, t31.d_date_sk, t31.d_date_id, t31.d_date, t31.d_month_seq, t31.d_week_seq, t31.d_quarter_seq, t31.d_year, t31.d_dow, t31.d_moy, t31.d_dom, t31.d_qoy, t31.d_fy_year, t31.d_fy_quarter_seq, t31.d_fy_week_seq, t31.d_day_name, t31.d_quarter_name, t31.d_holiday, t31.d_weekend, t31.d_following_holiday, t31.d_first_dom, t31.d_last_dom, t31.d_same_day_ly, t31.d_same_day_lq, t31.d_current_day, t31.d_current_week, t31.d_current_month, t31.d_current_quarter, t31.d_current_year, t31.d_date_sk0, t31.d_date_id0, t31.d_date0, t31.d_month_seq0, t31.d_week_seq0, t31.d_quarter_seq0, t31.d_year0, t31.d_dow0, t31.d_moy0, t31.d_dom0, t31.d_qoy0, t31.d_fy_year0, t31.d_fy_quarter_seq0, t31.d_fy_week_seq0, t31.d_day_name0, t31.d_quarter_name0, t31.d_holiday0, t31.d_weekend0, t31.d_following_holiday0, t31.d_first_dom0, t31.d_last_dom0, t31.d_same_day_ly0, t31.d_same_day_lq0, t31.d_current_day0, t31.d_current_week0, t31.d_current_month0, t31.d_current_quarter0, t31.d_current_year0, t31.d_date_sk1, t31.d_date_id1, t31.d_date1, t31.d_month_seq1, t31.d_week_seq1, t31.d_quarter_seq1, t31.d_year1, t31.d_dow1, t31.d_moy1, t31.d_dom1, t31.d_qoy1, t31.d_fy_year1, t31.d_fy_quarter_seq1, t31.d_fy_week_seq1, t31.d_day_name1, t31.d_quarter_name1, t31.d_holiday1, t31.d_weekend1, t31.d_following_holiday1, t31.d_first_dom1, t31.d_last_dom1, t31.d_same_day_ly1, t31.d_same_day_lq1, t31.d_current_day1, t31.d_current_week1, t31.d_current_month1, t31.d_current_quarter1, t31.d_current_year1, t31.s_store_sk, t31.s_store_id, t31.s_rec_start_date, t31.s_rec_end_date, t31.s_closed_date_sk, t31.s_store_name, t31.s_number_employees, t31.s_floor_space, t31.s_hours, t31.s_manager, t31.s_market_id, t31.s_geography_class, t31.s_market_desc, t31.s_market_manager, t31.s_division_id, t31.s_division_name, t31.s_company_id, t31.s_company_name, t31.s_street_number, t31.s_street_name, t31.s_street_type, t31.s_suite_number, t31.s_city, t31.s_county, t31.s_state, t31.s_zip, t31.s_country, t31.s_gmt_offset, t31.s_tax_percentage, customer0.c_customer_sk, customer0.c_customer_id, customer0.c_current_cdemo_sk, customer0.c_current_hdemo_sk, customer0.c_current_addr_sk, customer0.c_first_shipto_date_sk, customer0.c_first_sales_date_sk, customer0.c_salutation, customer0.c_first_name, customer0.c_last_name, customer0.c_preferred_cust_flag, customer0.c_birth_day, customer0.c_birth_month, customer0.c_birth_year, customer0.c_birth_country, customer0.c_login, customer0.c_email_address, customer0.c_last_review_date_sk\nFROM customer AS customer0\nINNER JOIN (SELECT t30.ss_sold_date_sk, t30.ss_sold_time_sk, t30.ss_item_sk, t30.ss_customer_sk, t30.ss_cdemo_sk, t30.ss_hdemo_sk, t30.ss_addr_sk, t30.ss_store_sk, t30.ss_promo_sk, t30.ss_ticket_number, t30.ss_quantity, t30.ss_wholesale_cost, t30.ss_list_price, t30.ss_sales_price, t30.ss_ext_discount_amt, t30.ss_ext_sales_price, t30.ss_ext_wholesale_cost, t30.ss_ext_list_price, t30.ss_ext_tax, t30.ss_coupon_amt, t30.ss_net_paid, t30.ss_net_paid_inc_tax, t30.ss_net_profit, t30.sr_returned_date_sk, t30.sr_return_time_sk, t30.sr_item_sk, t30.sr_customer_sk, t30.sr_cdemo_sk, t30.sr_hdemo_sk, t30.sr_addr_sk, t30.sr_store_sk, t30.sr_reason_sk, t30.sr_ticket_number, t30.sr_return_quantity, t30.sr_return_amt, t30.sr_return_tax, t30.sr_return_amt_inc_tax, t30.sr_fee, t30.sr_return_ship_cost, t30.sr_refunded_cash, t30.sr_reversed_charge, t30.sr_store_credit, t30.sr_net_loss, t30.CS_ITEM_SK, t30.SALE, t30.REFUND, t30.d_date_sk, t30.d_date_id, t30.d_date, t30.d_month_seq, t30.d_week_seq, t30.d_quarter_seq, t30.d_year, t30.d_dow, t30.d_moy, t30.d_dom, t30.d_qoy, t30.d_fy_year, t30.d_fy_quarter_seq, t30.d_fy_week_seq, t30.d_day_name, t30.d_quarter_name, t30.d_holiday, t30.d_weekend, t30.d_following_holiday, t30.d_first_dom, t30.d_last_dom, t30.d_same_day_ly, t30.d_same_day_lq, t30.d_current_day, t30.d_current_week, t30.d_current_month, t30.d_current_quarter, t30.d_current_year, t30.d_date_sk0, t30.d_date_id0, t30.d_date0, t30.d_month_seq0, t30.d_week_seq0, t30.d_quarter_seq0, t30.d_year0, t30.d_dow0, t30.d_moy0, t30.d_dom0, t30.d_qoy0, t30.d_fy_year0, t30.d_fy_quarter_seq0, t30.d_fy_week_seq0, t30.d_day_name0, t30.d_quarter_name0, t30.d_holiday0, t30.d_weekend0, t30.d_following_holiday0, t30.d_first_dom0, t30.d_last_dom0, t30.d_same_day_ly0, t30.d_same_day_lq0, t30.d_current_day0, t30.d_current_week0, t30.d_current_month0, t30.d_current_quarter0, t30.d_current_year0, t30.d_date_sk1, t30.d_date_id1, t30.d_date1, t30.d_month_seq1, t30.d_week_seq1, t30.d_quarter_seq1, t30.d_year1, t30.d_dow1, t30.d_moy1, t30.d_dom1, t30.d_qoy1, t30.d_fy_year1, t30.d_fy_quarter_seq1, t30.d_fy_week_seq1, t30.d_day_name1, t30.d_quarter_name1, t30.d_holiday1, t30.d_weekend1, t30.d_following_holiday1, t30.d_first_dom1, t30.d_last_dom1, t30.d_same_day_ly1, t30.d_same_day_lq1, t30.d_current_day1, t30.d_current_week1, t30.d_current_month1, t30.d_current_quarter1, t30.d_current_year1, store0.s_store_sk, store0.s_store_id, store0.s_rec_start_date, store0.s_rec_end_date, store0.s_closed_date_sk, store0.s_store_name, store0.s_number_employees, store0.s_floor_space, store0.s_hours, store0.s_manager, store0.s_market_id, store0.s_geography_class, store0.s_market_desc, store0.s_market_manager, store0.s_division_id, store0.s_division_name, store0.s_company_id, store0.s_company_name, store0.s_street_number, store0.s_street_name, store0.s_street_type, store0.s_suite_number, store0.s_city, store0.s_county, store0.s_state, store0.s_zip, store0.s_country, store0.s_gmt_offset, store0.s_tax_percentage\nFROM store AS store0\nINNER JOIN (SELECT t29.ss_sold_date_sk, t29.ss_sold_time_sk, t29.ss_item_sk, t29.ss_customer_sk, t29.ss_cdemo_sk, t29.ss_hdemo_sk, t29.ss_addr_sk, t29.ss_store_sk, t29.ss_promo_sk, t29.ss_ticket_number, t29.ss_quantity, t29.ss_wholesale_cost, t29.ss_list_price, t29.ss_sales_price, t29.ss_ext_discount_amt, t29.ss_ext_sales_price, t29.ss_ext_wholesale_cost, t29.ss_ext_list_price, t29.ss_ext_tax, t29.ss_coupon_amt, t29.ss_net_paid, t29.ss_net_paid_inc_tax, t29.ss_net_profit, t29.sr_returned_date_sk, t29.sr_return_time_sk, t29.sr_item_sk, t29.sr_customer_sk, t29.sr_cdemo_sk, t29.sr_hdemo_sk, t29.sr_addr_sk, t29.sr_store_sk, t29.sr_reason_sk, t29.sr_ticket_number, t29.sr_return_quantity, t29.sr_return_amt, t29.sr_return_tax, t29.sr_return_amt_inc_tax, t29.sr_fee, t29.sr_return_ship_cost, t29.sr_refunded_cash, t29.sr_reversed_charge, t29.sr_store_credit, t29.sr_net_loss, t29.CS_ITEM_SK, t29.SALE, t29.REFUND, t29.d_date_sk, t29.d_date_id, t29.d_date, t29.d_month_seq, t29.d_week_seq, t29.d_quarter_seq, t29.d_year, t29.d_dow, t29.d_moy, t29.d_dom, t29.d_qoy, t29.d_fy_year, t29.d_fy_quarter_seq, t29.d_fy_week_seq, t29.d_day_name, t29.d_quarter_name, t29.d_holiday, t29.d_weekend, t29.d_following_holiday, t29.d_first_dom, t29.d_last_dom, t29.d_same_day_ly, t29.d_same_day_lq, t29.d_current_day, t29.d_current_week, t29.d_current_month, t29.d_current_quarter, t29.d_current_year, t29.d_date_sk0, t29.d_date_id0, t29.d_date0, t29.d_month_seq0, t29.d_week_seq0, t29.d_quarter_seq0, t29.d_year0, t29.d_dow0, t29.d_moy0, t29.d_dom0, t29.d_qoy0, t29.d_fy_year0, t29.d_fy_quarter_seq0, t29.d_fy_week_seq0, t29.d_day_name0, t29.d_quarter_name0, t29.d_holiday0, t29.d_weekend0, t29.d_following_holiday0, t29.d_first_dom0, t29.d_last_dom0, t29.d_same_day_ly0, t29.d_same_day_lq0, t29.d_current_day0, t29.d_current_week0, t29.d_current_month0, t29.d_current_quarter0, t29.d_current_year0, date_dim2.d_date_sk AS d_date_sk1, date_dim2.d_date_id AS d_date_id1, date_dim2.d_date AS d_date1, date_dim2.d_month_seq AS d_month_seq1, date_dim2.d_week_seq AS d_week_seq1, date_dim2.d_quarter_seq AS d_quarter_seq1, date_dim2.d_year AS d_year1, date_dim2.d_dow AS d_dow1, date_dim2.d_moy AS d_moy1, date_dim2.d_dom AS d_dom1, date_dim2.d_qoy AS d_qoy1, date_dim2.d_fy_year AS d_fy_year1, date_dim2.d_fy_quarter_seq AS d_fy_quarter_seq1, date_dim2.d_fy_week_seq AS d_fy_week_seq1, date_dim2.d_day_name AS d_day_name1, date_dim2.d_quarter_name AS d_quarter_name1, date_dim2.d_holiday AS d_holiday1, date_dim2.d_weekend AS d_weekend1, date_dim2.d_following_holiday AS d_following_holiday1, date_dim2.d_first_dom AS d_first_dom1, date_dim2.d_last_dom AS d_last_dom1, date_dim2.d_same_day_ly AS d_same_day_ly1, date_dim2.d_same_day_lq AS d_same_day_lq1, date_dim2.d_current_day AS d_current_day1, date_dim2.d_current_week AS d_current_week1, date_dim2.d_current_month AS d_current_month1, date_dim2.d_current_quarter AS d_current_quarter1, date_dim2.d_current_year AS d_current_year1\nFROM date_dim AS date_dim2,\n(SELECT t28.ss_sold_date_sk, t28.ss_sold_time_sk, t28.ss_item_sk, t28.ss_customer_sk, t28.ss_cdemo_sk, t28.ss_hdemo_sk, t28.ss_addr_sk, t28.ss_store_sk, t28.ss_promo_sk, t28.ss_ticket_number, t28.ss_quantity, t28.ss_wholesale_cost, t28.ss_list_price, t28.ss_sales_price, t28.ss_ext_discount_amt, t28.ss_ext_sales_price, t28.ss_ext_wholesale_cost, t28.ss_ext_list_price, t28.ss_ext_tax, t28.ss_coupon_amt, t28.ss_net_paid, t28.ss_net_paid_inc_tax, t28.ss_net_profit, t28.sr_returned_date_sk, t28.sr_return_time_sk, t28.sr_item_sk, t28.sr_customer_sk, t28.sr_cdemo_sk, t28.sr_hdemo_sk, t28.sr_addr_sk, t28.sr_store_sk, t28.sr_reason_sk, t28.sr_ticket_number, t28.sr_return_quantity, t28.sr_return_amt, t28.sr_return_tax, t28.sr_return_amt_inc_tax, t28.sr_fee, t28.sr_return_ship_cost, t28.sr_refunded_cash, t28.sr_reversed_charge, t28.sr_store_credit, t28.sr_net_loss, t28.CS_ITEM_SK, t28.SALE, t28.REFUND, t28.d_date_sk, t28.d_date_id, t28.d_date, t28.d_month_seq, t28.d_week_seq, t28.d_quarter_seq, t28.d_year, t28.d_dow, t28.d_moy, t28.d_dom, t28.d_qoy, t28.d_fy_year, t28.d_fy_quarter_seq, t28.d_fy_week_seq, t28.d_day_name, t28.d_quarter_name, t28.d_holiday, t28.d_weekend, t28.d_following_holiday, t28.d_first_dom, t28.d_last_dom, t28.d_same_day_ly, t28.d_same_day_lq, t28.d_current_day, t28.d_current_week, t28.d_current_month, t28.d_current_quarter, t28.d_current_year, date_dim3.d_date_sk AS d_date_sk0, date_dim3.d_date_id AS d_date_id0, date_dim3.d_date AS d_date0, date_dim3.d_month_seq AS d_month_seq0, date_dim3.d_week_seq AS d_week_seq0, date_dim3.d_quarter_seq AS d_quarter_seq0, date_dim3.d_year AS d_year0, date_dim3.d_dow AS d_dow0, date_dim3.d_moy AS d_moy0, date_dim3.d_dom AS d_dom0, date_dim3.d_qoy AS d_qoy0, date_dim3.d_fy_year AS d_fy_year0, date_dim3.d_fy_quarter_seq AS d_fy_quarter_seq0, date_dim3.d_fy_week_seq AS d_fy_week_seq0, date_dim3.d_day_name AS d_day_name0, date_dim3.d_quarter_name AS d_quarter_name0, date_dim3.d_holiday AS d_holiday0, date_dim3.d_weekend AS d_weekend0, date_dim3.d_following_holiday AS d_following_holiday0, date_dim3.d_first_dom AS d_first_dom0, date_dim3.d_last_dom AS d_last_dom0, date_dim3.d_same_day_ly AS d_same_day_ly0, date_dim3.d_same_day_lq AS d_same_day_lq0, date_dim3.d_current_day AS d_current_day0, date_dim3.d_current_week AS d_current_week0, date_dim3.d_current_month AS d_current_month0, date_dim3.d_current_quarter AS d_current_quarter0, date_dim3.d_current_year AS d_current_year0\nFROM date_dim AS date_dim3,\n(SELECT store_sales0.ss_sold_date_sk, store_sales0.ss_sold_time_sk, store_sales0.ss_item_sk, store_sales0.ss_customer_sk, store_sales0.ss_cdemo_sk, store_sales0.ss_hdemo_sk, store_sales0.ss_addr_sk, store_sales0.ss_store_sk, store_sales0.ss_promo_sk, store_sales0.ss_ticket_number, store_sales0.ss_quantity, store_sales0.ss_wholesale_cost, store_sales0.ss_list_price, store_sales0.ss_sales_price, store_sales0.ss_ext_discount_amt, store_sales0.ss_ext_sales_price, store_sales0.ss_ext_wholesale_cost, store_sales0.ss_ext_list_price, store_sales0.ss_ext_tax, store_sales0.ss_coupon_amt, store_sales0.ss_net_paid, store_sales0.ss_net_paid_inc_tax, store_sales0.ss_net_profit, store_returns0.sr_returned_date_sk, store_returns0.sr_return_time_sk, store_returns0.sr_item_sk, store_returns0.sr_customer_sk, store_returns0.sr_cdemo_sk, store_returns0.sr_hdemo_sk, store_returns0.sr_addr_sk, store_returns0.sr_store_sk, store_returns0.sr_reason_sk, store_returns0.sr_ticket_number, store_returns0.sr_return_quantity, store_returns0.sr_return_amt, store_returns0.sr_return_tax, store_returns0.sr_return_amt_inc_tax, store_returns0.sr_fee, store_returns0.sr_return_ship_cost, store_returns0.sr_refunded_cash, store_returns0.sr_reversed_charge, store_returns0.sr_store_credit, store_returns0.sr_net_loss, t27.CS_ITEM_SK, t27.SALE, t27.REFUND, date_dim4.d_date_sk, date_dim4.d_date_id, date_dim4.d_date, date_dim4.d_month_seq, date_dim4.d_week_seq, date_dim4.d_quarter_seq, date_dim4.d_year, date_dim4.d_dow, date_dim4.d_moy, date_dim4.d_dom, date_dim4.d_qoy, date_dim4.d_fy_year, date_dim4.d_fy_quarter_seq, date_dim4.d_fy_week_seq, date_dim4.d_day_name, date_dim4.d_quarter_name, date_dim4.d_holiday, date_dim4.d_weekend, date_dim4.d_following_holiday, date_dim4.d_first_dom, date_dim4.d_last_dom, date_dim4.d_same_day_ly, date_dim4.d_same_day_lq, date_dim4.d_current_day, date_dim4.d_current_week, date_dim4.d_current_month, date_dim4.d_current_quarter, date_dim4.d_current_year\nFROM date_dim AS date_dim4\nINNER JOIN (store_sales AS store_sales0 INNER JOIN store_returns AS store_returns0 ON store_sales0.ss_item_sk \u003d store_returns0.sr_item_sk AND store_sales0.ss_ticket_number \u003d store_returns0.sr_ticket_number INNER JOIN (SELECT catalog_sales0.cs_item_sk AS CS_ITEM_SK, SUM(catalog_sales0.cs_ext_list_price) AS SALE, SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit) AS REFUND\nFROM catalog_sales AS catalog_sales0\nINNER JOIN catalog_returns AS catalog_returns0 ON catalog_sales0.cs_item_sk \u003d catalog_returns0.cr_item_sk AND catalog_sales0.cs_order_number \u003d catalog_returns0.cr_order_number\nGROUP BY catalog_sales0.cs_item_sk\nHAVING SUM(catalog_sales0.cs_ext_list_price) \u003e 2 * SUM(catalog_returns0.cr_refunded_cash + catalog_returns0.cr_reversed_charge + catalog_returns0.cr_store_credit)) AS t27 ON store_sales0.ss_item_sk \u003d t27.CS_ITEM_SK) ON date_dim4.d_date_sk \u003d store_sales0.ss_sold_date_sk) AS t28) AS t29) AS t30 ON store0.s_store_sk \u003d t30.ss_store_sk) AS t31 ON customer0.c_customer_sk \u003d t31.ss_customer_sk AND customer0.c_first_sales_date_sk \u003d t31.d_date_sk0 AND customer0.c_first_shipto_date_sk \u003d t31.d_date_sk1) AS t32 ON customer_demographics2.cd_demo_sk \u003d t32.ss_cdemo_sk) AS t33 ON customer_demographics1.cd_demo_sk \u003d t33.c_current_cdemo_sk AND t33.cd_marital_status \u003c\u003e customer_demographics1.cd_marital_status) AS t34 ON promotion0.p_promo_sk \u003d t34.ss_promo_sk) AS t35 ON household_demographics2.hd_demo_sk \u003d t35.ss_hdemo_sk) AS t36 ON household_demographics1.hd_demo_sk \u003d t36.c_current_hdemo_sk) AS t37 ON customer_address2.ca_address_sk \u003d t37.ss_addr_sk) AS t38 ON customer_address1.ca_address_sk \u003d t38.c_current_addr_sk) AS t39 ON income_band2.ib_income_band_sk \u003d t39.hd_income_band_sk) AS t40 ON income_band1.ib_income_band_sk \u003d t40.hd_income_band_sk0) AS t41 ON t23.i_item_sk \u003d t41.ss_item_sk\nGROUP BY t23.i_product_name, t23.i_item_sk, t41.s_store_name, t41.s_zip, t41.ca_street_number, t41.ca_street_name, t41.ca_city, t41.ca_zip, t41.ca_street_number0, t41.ca_street_name0, t41.ca_city0, t41.ca_zip0, t41.d_year, t41.d_year0, t41.d_year1\nHAVING t41.d_year \u003d CAST(1999 + 1 AS BIGINT)) AS t46 ON t22.ITEM_SK \u003d t46.ITEM_SK AND t22.CNT \u003e\u003d t46.CNT AND t22.STORE_NAME \u003d t46.STORE_NAME AND t22.STORE_ZIP \u003d t46.STORE_ZIP\nORDER BY t22.PRODUCT_NAME, t22.STORE_NAME, t46.CNT, t22.S1, t46.S1",
    "originalTimesMs": [
      147,
      137
    ],
    "optimizedTimesMs": [
      4447,
      5246
    ],
    "originalAvgMs": 142,
    "optimizedAvgMs": 4846,
    "speedup": 0.029302517540239374,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q65",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT store.s_store_name AS S_STORE_NAME, item.i_item_desc AS I_ITEM_DESC, t7.REVENUE, item.i_current_price AS I_CURRENT_PRICE, item.i_wholesale_cost AS I_WHOLESALE_COST, item.i_brand AS I_BRAND\nFROM store\nCROSS JOIN item\nINNER JOIN (SELECT t2.SS_STORE_SK, AVG(t2.REVENUE) AS AVE\nFROM (SELECT store_sales.ss_store_sk AS SS_STORE_SK, SUM(store_sales.ss_sales_price) AS REVENUE\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1176 AND d_month_seq \u003c\u003d 1176 + 11) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nGROUP BY store_sales.ss_store_sk, store_sales.ss_item_sk) AS t2\nGROUP BY t2.SS_STORE_SK) AS t3 ON store.s_store_sk \u003d t3.SS_STORE_SK\nINNER JOIN (SELECT store_sales0.ss_store_sk AS SS_STORE_SK, store_sales0.ss_item_sk AS SS_ITEM_SK, SUM(store_sales0.ss_sales_price) AS REVENUE\nFROM store_sales AS store_sales0\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1176 AND d_month_seq \u003c\u003d 1176 + 11) AS t4 ON store_sales0.ss_sold_date_sk \u003d t4.d_date_sk\nGROUP BY store_sales0.ss_store_sk, store_sales0.ss_item_sk) AS t7 ON t7.REVENUE \u003c\u003d 0.1 * t3.AVE AND t3.SS_STORE_SK \u003d t7.SS_STORE_SK AND item.i_item_sk \u003d t7.SS_ITEM_SK\nORDER BY store.s_store_name NULLS FIRST, item.i_item_desc NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      105,
      114
    ],
    "optimizedTimesMs": [
      105,
      107
    ],
    "originalAvgMs": 109,
    "optimizedAvgMs": 106,
    "speedup": 1.028301886792453,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q66",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "AGGREGATE_CASE_TO_FILTER",
      "PROJECT_MERGE",
      "AGGREGATE_MERGE",
      "UNION_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT W_WAREHOUSE_NAME, W_WAREHOUSE_SQ_FT, W_CITY, W_COUNTY, W_STATE, W_COUNTRY, SHIP_CARRIERS, YEAR_, SUM(JAN_SALES) AS JAN_SALES, SUM(FEB_SALES) AS FEB_SALES, SUM(MAR_SALES) AS MAR_SALES, SUM(APR_SALES) AS APR_SALES, SUM(MAY_SALES) AS MAY_SALES, SUM(JUN_SALES) AS JUN_SALES, SUM(JUL_SALES) AS JUL_SALES, SUM(AUG_SALES) AS AUG_SALES, SUM(SEP_SALES) AS SEP_SALES, SUM(OCT_SALES) AS OCT_SALES, SUM(NOV_SALES) AS NOV_SALES, SUM(DEC_SALES) AS DEC_SALES, SUM(JAN_SALES / W_WAREHOUSE_SQ_FT) AS JAN_SALES_PER_SQ_FOOT, SUM(FEB_SALES / W_WAREHOUSE_SQ_FT) AS FEB_SALES_PER_SQ_FOOT, SUM(MAR_SALES / W_WAREHOUSE_SQ_FT) AS MAR_SALES_PER_SQ_FOOT, SUM(APR_SALES / W_WAREHOUSE_SQ_FT) AS APR_SALES_PER_SQ_FOOT, SUM(MAY_SALES / W_WAREHOUSE_SQ_FT) AS MAY_SALES_PER_SQ_FOOT, SUM(JUN_SALES / W_WAREHOUSE_SQ_FT) AS JUN_SALES_PER_SQ_FOOT, SUM(JUL_SALES / W_WAREHOUSE_SQ_FT) AS JUL_SALES_PER_SQ_FOOT, SUM(AUG_SALES / W_WAREHOUSE_SQ_FT) AS AUG_SALES_PER_SQ_FOOT, SUM(SEP_SALES / W_WAREHOUSE_SQ_FT) AS SEP_SALES_PER_SQ_FOOT, SUM(OCT_SALES / W_WAREHOUSE_SQ_FT) AS OCT_SALES_PER_SQ_FOOT, SUM(NOV_SALES / W_WAREHOUSE_SQ_FT) AS NOV_SALES_PER_SQ_FOOT, SUM(DEC_SALES / W_WAREHOUSE_SQ_FT) AS DEC_SALES_PER_SQ_FOOT, SUM(JAN_NET) AS JAN_NET, SUM(FEB_NET) AS FEB_NET, SUM(MAR_NET) AS MAR_NET, SUM(APR_NET) AS APR_NET, SUM(MAY_NET) AS MAY_NET, SUM(JUN_NET) AS JUN_NET, SUM(JUL_NET) AS JUL_NET, SUM(AUG_NET) AS AUG_NET, SUM(SEP_NET) AS SEP_NET, SUM(OCT_NET) AS OCT_NET, SUM(NOV_NET) AS NOV_NET, SUM(DEC_NET) AS DEC_NET\nFROM (SELECT warehouse.w_warehouse_name AS W_WAREHOUSE_NAME, warehouse.w_warehouse_sq_ft AS W_WAREHOUSE_SQ_FT, warehouse.w_city AS W_CITY, warehouse.w_county AS W_COUNTY, warehouse.w_state AS W_STATE, warehouse.w_country AS W_COUNTRY, \u0027DHL,BARIAN\u0027 AS SHIP_CARRIERS, t.d_year AS YEAR_, SUM(CASE WHEN t.d_moy \u003d 1 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS JAN_SALES, SUM(CASE WHEN t.d_moy \u003d 2 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS FEB_SALES, SUM(CASE WHEN t.d_moy \u003d 3 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS MAR_SALES, SUM(CASE WHEN t.d_moy \u003d 4 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS APR_SALES, SUM(CASE WHEN t.d_moy \u003d 5 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS MAY_SALES, SUM(CASE WHEN t.d_moy \u003d 6 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS JUN_SALES, SUM(CASE WHEN t.d_moy \u003d 7 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS JUL_SALES, SUM(CASE WHEN t.d_moy \u003d 8 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS AUG_SALES, SUM(CASE WHEN t.d_moy \u003d 9 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS SEP_SALES, SUM(CASE WHEN t.d_moy \u003d 10 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS OCT_SALES, SUM(CASE WHEN t.d_moy \u003d 11 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS NOV_SALES, SUM(CASE WHEN t.d_moy \u003d 12 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS DEC_SALES, SUM(CASE WHEN t.d_moy \u003d 1 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS JAN_NET, SUM(CASE WHEN t.d_moy \u003d 2 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS FEB_NET, SUM(CASE WHEN t.d_moy \u003d 3 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS MAR_NET, SUM(CASE WHEN t.d_moy \u003d 4 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS APR_NET, SUM(CASE WHEN t.d_moy \u003d 5 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS MAY_NET, SUM(CASE WHEN t.d_moy \u003d 6 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS JUN_NET, SUM(CASE WHEN t.d_moy \u003d 7 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS JUL_NET, SUM(CASE WHEN t.d_moy \u003d 8 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS AUG_NET, SUM(CASE WHEN t.d_moy \u003d 9 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS SEP_NET, SUM(CASE WHEN t.d_moy \u003d 10 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS OCT_NET, SUM(CASE WHEN t.d_moy \u003d 11 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS NOV_NET, SUM(CASE WHEN t.d_moy \u003d 12 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS DEC_NET\nFROM web_sales\nINNER JOIN warehouse ON web_sales.ws_warehouse_sk \u003d warehouse.w_warehouse_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t ON web_sales.ws_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_time \u003e\u003d 30838 AND t_time \u003c\u003d 30838 + 28800) AS t0 ON web_sales.ws_sold_time_sk \u003d t0.t_time_sk\nINNER JOIN (SELECT *\nFROM ship_mode\nWHERE sm_carrier IN (\u0027BARIAN\u0027, \u0027DHL\u0027)) AS t1 ON web_sales.ws_ship_mode_sk \u003d t1.sm_ship_mode_sk\nGROUP BY warehouse.w_warehouse_name, warehouse.w_warehouse_sq_ft, warehouse.w_city, warehouse.w_county, warehouse.w_state, warehouse.w_country, t.d_year\nUNION ALL\nSELECT warehouse0.w_warehouse_name AS W_WAREHOUSE_NAME, warehouse0.w_warehouse_sq_ft AS W_WAREHOUSE_SQ_FT, warehouse0.w_city AS W_CITY, warehouse0.w_county AS W_COUNTY, warehouse0.w_state AS W_STATE, warehouse0.w_country AS W_COUNTRY, \u0027DHL,BARIAN\u0027 AS SHIP_CARRIERS, t5.d_year AS YEAR_, SUM(CASE WHEN t5.d_moy \u003d 1 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS JAN_SALES, SUM(CASE WHEN t5.d_moy \u003d 2 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS FEB_SALES, SUM(CASE WHEN t5.d_moy \u003d 3 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS MAR_SALES, SUM(CASE WHEN t5.d_moy \u003d 4 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS APR_SALES, SUM(CASE WHEN t5.d_moy \u003d 5 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS MAY_SALES, SUM(CASE WHEN t5.d_moy \u003d 6 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS JUN_SALES, SUM(CASE WHEN t5.d_moy \u003d 7 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS JUL_SALES, SUM(CASE WHEN t5.d_moy \u003d 8 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS AUG_SALES, SUM(CASE WHEN t5.d_moy \u003d 9 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS SEP_SALES, SUM(CASE WHEN t5.d_moy \u003d 10 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS OCT_SALES, SUM(CASE WHEN t5.d_moy \u003d 11 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS NOV_SALES, SUM(CASE WHEN t5.d_moy \u003d 12 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS DEC_SALES, SUM(CASE WHEN t5.d_moy \u003d 1 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS JAN_NET, SUM(CASE WHEN t5.d_moy \u003d 2 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS FEB_NET, SUM(CASE WHEN t5.d_moy \u003d 3 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS MAR_NET, SUM(CASE WHEN t5.d_moy \u003d 4 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS APR_NET, SUM(CASE WHEN t5.d_moy \u003d 5 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS MAY_NET, SUM(CASE WHEN t5.d_moy \u003d 6 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS JUN_NET, SUM(CASE WHEN t5.d_moy \u003d 7 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS JUL_NET, SUM(CASE WHEN t5.d_moy \u003d 8 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS AUG_NET, SUM(CASE WHEN t5.d_moy \u003d 9 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS SEP_NET, SUM(CASE WHEN t5.d_moy \u003d 10 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS OCT_NET, SUM(CASE WHEN t5.d_moy \u003d 11 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS NOV_NET, SUM(CASE WHEN t5.d_moy \u003d 12 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS DEC_NET\nFROM catalog_sales\nINNER JOIN warehouse AS warehouse0 ON catalog_sales.cs_warehouse_sk \u003d warehouse0.w_warehouse_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t5 ON catalog_sales.cs_sold_date_sk \u003d t5.d_date_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_time \u003e\u003d 30838 AND t_time \u003c\u003d 30838 + 28800) AS t6 ON catalog_sales.cs_sold_time_sk \u003d t6.t_time_sk\nINNER JOIN (SELECT *\nFROM ship_mode\nWHERE sm_carrier IN (\u0027BARIAN\u0027, \u0027DHL\u0027)) AS t7 ON catalog_sales.cs_ship_mode_sk \u003d t7.sm_ship_mode_sk\nGROUP BY warehouse0.w_warehouse_name, warehouse0.w_warehouse_sq_ft, warehouse0.w_city, warehouse0.w_county, warehouse0.w_state, warehouse0.w_country, t5.d_year) AS t11\nGROUP BY W_WAREHOUSE_NAME, W_WAREHOUSE_SQ_FT, W_CITY, W_COUNTY, W_STATE, W_COUNTRY, SHIP_CARRIERS, YEAR_\nORDER BY W_WAREHOUSE_NAME NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      21,
      20
    ],
    "optimizedTimesMs": [
      20,
      20
    ],
    "originalAvgMs": 20,
    "optimizedAvgMs": 20,
    "speedup": 1.0,
    "originalRowCount": 15,
    "optimizedRowCount": 15,
    "validationPassed": true,
    "originalPlanMaxRows": 1439513,
    "optimizedPlanMaxRows": 1439513
  },
  {
    "query": "q67",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "optimizedSql": "SELECT I_CATEGORY, I_CLASS, I_BRAND, I_PRODUCT_NAME, D_YEAR, D_QOY, D_MOY, S_STORE_ID, SUMSALES, RK\nFROM (SELECT t1.i_category AS I_CATEGORY, t1.i_class AS I_CLASS, t1.i_brand AS I_BRAND, t1.i_product_name AS I_PRODUCT_NAME, t1.d_year AS D_YEAR, t1.d_qoy AS D_QOY, t1.d_moy AS D_MOY, t1.s_store_id AS S_STORE_ID, t1.SUMSALES, RANK() OVER (PARTITION BY t1.i_category ORDER BY t1.SUMSALES DESC) AS RK\nFROM (SELECT item.i_category, item.i_class, item.i_brand, item.i_product_name, t.d_year, t.d_qoy, t.d_moy, store.s_store_id, SUM(CASE WHEN store_sales.ss_sales_price IS NOT NULL AND store_sales.ss_quantity IS NOT NULL THEN CAST(store_sales.ss_sales_price * store_sales.ss_quantity AS DECIMAL(19, 0)) ELSE 0 END) AS SUMSALES\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nGROUP BY ROLLUP(item.i_category, item.i_class, item.i_brand, item.i_product_name, t.d_year, t.d_qoy, t.d_moy, store.s_store_id)) AS t1) AS t2\nWHERE RK \u003c\u003d 100\nORDER BY I_CATEGORY NULLS FIRST, I_CLASS NULLS FIRST, I_BRAND NULLS FIRST, I_PRODUCT_NAME NULLS FIRST, D_YEAR NULLS FIRST, D_QOY NULLS FIRST, D_MOY NULLS FIRST, S_STORE_ID NULLS FIRST, SUMSALES NULLS FIRST, RK NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      699,
      639
    ],
    "optimizedTimesMs": [
      671,
      667
    ],
    "originalAvgMs": 669,
    "optimizedAvgMs": 669,
    "speedup": 1.0,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": false,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q68",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "FILTER_AGGREGATE_TRANSPOSE",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, customer_address0.ca_city AS CA_CITY, t4.BOUGHT_CITY, t4.SS_TICKET_NUMBER, t4.EXTENDED_PRICE, t4.EXTENDED_TAX, t4.LIST_PRICE\nFROM (SELECT store_sales.ss_ticket_number AS SS_TICKET_NUMBER, store_sales.ss_customer_sk AS SS_CUSTOMER_SK, customer_address.ca_city AS BOUGHT_CITY, SUM(store_sales.ss_ext_sales_price) AS EXTENDED_PRICE, SUM(store_sales.ss_ext_list_price) AS LIST_PRICE, SUM(store_sales.ss_ext_tax) AS EXTENDED_TAX\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_dom \u003e\u003d 1 AND d_dom \u003c\u003d 2 AND (d_year \u003d 1999 OR d_year \u003d CAST(1999 + 1 AS BIGINT) OR d_year \u003d CAST(1999 + 2 AS BIGINT))) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_city IN (\u0027Fairview\u0027, \u0027Midway\u0027)) AS t0 ON store_sales.ss_store_sk \u003d t0.s_store_sk\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 OR hd_vehicle_count \u003d 3) AS t1 ON store_sales.ss_hdemo_sk \u003d t1.hd_demo_sk\nINNER JOIN customer_address ON store_sales.ss_addr_sk \u003d customer_address.ca_address_sk\nGROUP BY store_sales.ss_ticket_number, store_sales.ss_customer_sk, store_sales.ss_addr_sk, customer_address.ca_city) AS t4\nINNER JOIN customer ON t4.SS_CUSTOMER_SK \u003d customer.c_customer_sk\nINNER JOIN customer_address AS customer_address0 ON customer.c_current_addr_sk \u003d customer_address0.ca_address_sk AND customer_address0.ca_city \u003c\u003e t4.BOUGHT_CITY\nORDER BY customer.c_last_name NULLS FIRST, t4.SS_TICKET_NUMBER NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      32,
      32
    ],
    "optimizedTimesMs": [
      32,
      33
    ],
    "originalAvgMs": 32,
    "optimizedAvgMs": 32,
    "speedup": 1.0,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q69",
    "status": "error",
    "error": "variable $cor0 is not found",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_PROJECT_TRANSPOSE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "PROJECT_REMOVE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q70",
    "status": "error",
    "error": "while converting `D1`.`d_month_seq` BETWEEN ASYMMETRIC 1200 AND 1200 + 11 AND `D1`.`d_date_sk` \u003d `STORE_SALES`.`ss_sold_date_sk` AND `STORE`.`s_store_sk` \u003d `STORE_SALES`.`ss_store_sk` AND `STORE`.`s_state` IN (SELECT `S_STATE`\nFROM (SELECT `S_STATE` AS `S_STATE`, RANK() OVER (PARTITION BY `S_STATE` ORDER BY SUM(`SS_NET_PROFIT`) DESC) AS `RANKING`\nFROM `STORE_SALES`,\n`STORE`,\n`DATE_DIM`\nWHERE `DATE_DIM`.`d_month_seq` BETWEEN ASYMMETRIC 1200 AND 1200 + 11 AND `DATE_DIM`.`d_date_sk` \u003d `STORE_SALES`.`ss_sold_date_sk` AND `STORE`.`s_store_sk` \u003d `STORE_SALES`.`ss_store_sk`\nGROUP BY `STORE`.`s_state`) AS `TMP1`\nWHERE `TMP1`.`RANKING` \u003c\u003d 5)",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "JOIN_TO_MULTI_JOIN",
      "MULTI_JOIN_OPTIMIZE",
      "AGGREGATE_MERGE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q71",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "PROJECT_REMOVE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t11.i_brand_id AS BRAND_ID, t11.i_brand AS BRAND, t11.t_hour AS T_HOUR, t11.t_minute AS T_MINUTE, t11.EXT_PRICE\nFROM (SELECT t.i_brand, t.i_brand_id, t8.t_hour, t8.t_minute, SUM(t7.EXT_PRICE) AS EXT_PRICE\nFROM (SELECT *\nFROM item\nWHERE i_manager_id \u003d 1) AS t\nINNER JOIN (SELECT *\nFROM (SELECT web_sales.ws_ext_sales_price AS EXT_PRICE, web_sales.ws_sold_date_sk AS SOLD_DATE_SK, web_sales.ws_item_sk AS SOLD_ITEM_SK, web_sales.ws_sold_time_sk AS TIME_SK\nFROM web_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 11 AND d_year \u003d 1999) AS t0 ON web_sales.ws_sold_date_sk \u003d t0.d_date_sk\nUNION ALL\nSELECT catalog_sales.cs_ext_sales_price AS EXT_PRICE, catalog_sales.cs_sold_date_sk AS SOLD_DATE_SK, catalog_sales.cs_item_sk AS SOLD_ITEM_SK, catalog_sales.cs_sold_time_sk AS TIME_SK\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 11 AND d_year \u003d 1999) AS t2 ON catalog_sales.cs_sold_date_sk \u003d t2.d_date_sk)\nUNION ALL\nSELECT store_sales.ss_ext_sales_price AS EXT_PRICE, store_sales.ss_sold_date_sk AS SOLD_DATE_SK, store_sales.ss_item_sk AS SOLD_ITEM_SK, store_sales.ss_sold_time_sk AS TIME_SK\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_moy \u003d 11 AND d_year \u003d 1999) AS t5 ON store_sales.ss_sold_date_sk \u003d t5.d_date_sk) AS t7 ON t.i_item_sk \u003d t7.SOLD_ITEM_SK\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_meal_time IN (\u0027breakfast\u0027, \u0027dinner\u0027)) AS t8 ON t7.TIME_SK \u003d t8.t_time_sk\nGROUP BY t.i_brand, t.i_brand_id, t8.t_hour, t8.t_minute\nORDER BY 5 DESC, t.i_brand_id NULLS FIRST, t8.t_hour NULLS FIRST) AS t11",
    "originalTimesMs": [
      15,
      15
    ],
    "optimizedTimesMs": [
      15,
      17
    ],
    "originalAvgMs": 15,
    "optimizedAvgMs": 16,
    "speedup": 0.9375,
    "originalRowCount": 1046,
    "optimizedRowCount": 1046,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q72",
    "status": "error",
    "error": "From line 27, column 19 to line 27, column 31: Cannot apply \u0027+\u0027 to arguments of type \u0027\u003cDATE\u003e + \u003cINTEGER\u003e\u0027. Supported form(s): \u0027\u003cNUMERIC\u003e + \u003cNUMERIC\u003e\u0027\n\u0027\u003cDATETIME_INTERVAL\u003e + \u003cDATETIME_INTERVAL\u003e\u0027\n\u0027\u003cDATETIME\u003e + \u003cDATETIME_INTERVAL\u003e\u0027\n\u0027\u003cDATETIME_INTERVAL\u003e + \u003cDATETIME\u003e\u0027",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q73",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "FILTER_AGGREGATE_TRANSPOSE",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, customer.c_salutation AS C_SALUTATION, customer.c_preferred_cust_flag AS C_PREFERRED_CUST_FLAG, t5.SS_TICKET_NUMBER, t5.CNT\nFROM (SELECT *\nFROM (SELECT store_sales.ss_ticket_number AS SS_TICKET_NUMBER, store_sales.ss_customer_sk AS SS_CUSTOMER_SK, COUNT(*) AS CNT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_dom \u003e\u003d 1 AND d_dom \u003c\u003d 2 AND (d_year \u003d 1999 OR d_year \u003d CAST(1999 + 1 AS BIGINT) OR d_year \u003d CAST(1999 + 2 AS BIGINT))) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_county IN (\u0027Bronx County\u0027, \u0027Franklin Parish\u0027, \u0027Orange County\u0027, \u0027Williamson County\u0027)) AS t0 ON store_sales.ss_store_sk \u003d t0.s_store_sk\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_buy_potential IN (\u0027\u003e10000\u0027, \u0027Unknown\u0027) AND hd_vehicle_count \u003e 0 AND CASE WHEN hd_vehicle_count \u003e 0 THEN CAST(hd_dep_count AS DECIMAL(19, 3)) / hd_vehicle_count ELSE NULL END \u003e 1) AS t1 ON store_sales.ss_hdemo_sk \u003d t1.hd_demo_sk\nGROUP BY store_sales.ss_ticket_number, store_sales.ss_customer_sk) AS t4\nWHERE t4.CNT \u003e\u003d 1 AND t4.CNT \u003c\u003d 5) AS t5\nINNER JOIN customer ON t5.SS_CUSTOMER_SK \u003d customer.c_customer_sk\nORDER BY t5.CNT DESC, customer.c_last_name",
    "originalTimesMs": [
      28,
      27
    ],
    "optimizedTimesMs": [
      26,
      26
    ],
    "originalAvgMs": 27,
    "optimizedAvgMs": 26,
    "speedup": 1.0384615384615385,
    "originalRowCount": 3430,
    "optimizedRowCount": 3430,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q74",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t18.CUSTOMER_ID, t18.CUSTOMER_FIRST_NAME, t18.CUSTOMER_LAST_NAME\nFROM (SELECT *\nFROM (SELECT customer.c_customer_id AS CUSTOMER_ID, customer.c_first_name AS CUSTOMER_FIRST_NAME, customer.c_last_name AS CUSTOMER_LAST_NAME, t.d_year AS YEAR_, SUM(store_sales.ss_net_paid) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer\nINNER JOIN store_sales ON customer.c_customer_sk \u003d store_sales.ss_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nGROUP BY customer.c_customer_id, customer.c_first_name, customer.c_last_name, t.d_year\nUNION ALL\nSELECT customer0.c_customer_id AS CUSTOMER_ID, customer0.c_first_name AS CUSTOMER_FIRST_NAME, customer0.c_last_name AS CUSTOMER_LAST_NAME, t3.d_year AS YEAR_, SUM(web_sales.ws_net_paid) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer0\nINNER JOIN web_sales ON customer0.c_customer_sk \u003d web_sales.ws_bill_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t3 ON web_sales.ws_sold_date_sk \u003d t3.d_date_sk\nGROUP BY customer0.c_customer_id, customer0.c_first_name, customer0.c_last_name, t3.d_year) AS t7\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND YEAR_ \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t8\nINNER JOIN (SELECT *\nFROM (SELECT customer1.c_customer_id AS CUSTOMER_ID, customer1.c_first_name AS CUSTOMER_FIRST_NAME, customer1.c_last_name AS CUSTOMER_LAST_NAME, t9.d_year AS YEAR_, SUM(store_sales0.ss_net_paid) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer1\nINNER JOIN store_sales AS store_sales0 ON customer1.c_customer_sk \u003d store_sales0.ss_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t9 ON store_sales0.ss_sold_date_sk \u003d t9.d_date_sk\nGROUP BY customer1.c_customer_id, customer1.c_first_name, customer1.c_last_name, t9.d_year\nUNION ALL\nSELECT customer2.c_customer_id AS CUSTOMER_ID, customer2.c_first_name AS CUSTOMER_FIRST_NAME, customer2.c_last_name AS CUSTOMER_LAST_NAME, t13.d_year AS YEAR_, SUM(web_sales0.ws_net_paid) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer2\nINNER JOIN web_sales AS web_sales0 ON customer2.c_customer_sk \u003d web_sales0.ws_bill_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t13 ON web_sales0.ws_sold_date_sk \u003d t13.d_date_sk\nGROUP BY customer2.c_customer_id, customer2.c_first_name, customer2.c_last_name, t13.d_year) AS t17\nWHERE SALE_TYPE \u003d \u0027s\u0027 AND YEAR_ \u003d CAST(2001 + 1 AS BIGINT)) AS t18 ON t8.CUSTOMER_ID \u003d t18.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT customer3.c_customer_id AS CUSTOMER_ID, customer3.c_first_name AS CUSTOMER_FIRST_NAME, customer3.c_last_name AS CUSTOMER_LAST_NAME, t19.d_year AS YEAR_, SUM(store_sales1.ss_net_paid) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer3\nINNER JOIN store_sales AS store_sales1 ON customer3.c_customer_sk \u003d store_sales1.ss_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t19 ON store_sales1.ss_sold_date_sk \u003d t19.d_date_sk\nGROUP BY customer3.c_customer_id, customer3.c_first_name, customer3.c_last_name, t19.d_year\nUNION ALL\nSELECT customer4.c_customer_id AS CUSTOMER_ID, customer4.c_first_name AS CUSTOMER_FIRST_NAME, customer4.c_last_name AS CUSTOMER_LAST_NAME, t23.d_year AS YEAR_, SUM(web_sales1.ws_net_paid) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer4\nINNER JOIN web_sales AS web_sales1 ON customer4.c_customer_sk \u003d web_sales1.ws_bill_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t23 ON web_sales1.ws_sold_date_sk \u003d t23.d_date_sk\nGROUP BY customer4.c_customer_id, customer4.c_first_name, customer4.c_last_name, t23.d_year) AS t27\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND YEAR_ \u003d 2001 AND YEAR_TOTAL \u003e 0) AS t28 ON t8.CUSTOMER_ID \u003d t28.CUSTOMER_ID\nINNER JOIN (SELECT *\nFROM (SELECT customer5.c_customer_id AS CUSTOMER_ID, customer5.c_first_name AS CUSTOMER_FIRST_NAME, customer5.c_last_name AS CUSTOMER_LAST_NAME, t29.d_year AS YEAR_, SUM(store_sales2.ss_net_paid) AS YEAR_TOTAL, \u0027s\u0027 AS SALE_TYPE\nFROM customer AS customer5\nINNER JOIN store_sales AS store_sales2 ON customer5.c_customer_sk \u003d store_sales2.ss_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t29 ON store_sales2.ss_sold_date_sk \u003d t29.d_date_sk\nGROUP BY customer5.c_customer_id, customer5.c_first_name, customer5.c_last_name, t29.d_year\nUNION ALL\nSELECT customer6.c_customer_id AS CUSTOMER_ID, customer6.c_first_name AS CUSTOMER_FIRST_NAME, customer6.c_last_name AS CUSTOMER_LAST_NAME, t33.d_year AS YEAR_, SUM(web_sales2.ws_net_paid) AS YEAR_TOTAL, \u0027w\u0027 AS SALE_TYPE\nFROM customer AS customer6\nINNER JOIN web_sales AS web_sales2 ON customer6.c_customer_sk \u003d web_sales2.ws_bill_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001 OR d_year \u003d CAST(2001 + 1 AS BIGINT)) AS t33 ON web_sales2.ws_sold_date_sk \u003d t33.d_date_sk\nGROUP BY customer6.c_customer_id, customer6.c_first_name, customer6.c_last_name, t33.d_year) AS t37\nWHERE SALE_TYPE \u003d \u0027w\u0027 AND YEAR_ \u003d CAST(2001 + 1 AS BIGINT)) AS t38 ON t8.CUSTOMER_ID \u003d t38.CUSTOMER_ID AND CASE WHEN t28.YEAR_TOTAL \u003e 0 THEN t38.YEAR_TOTAL / t28.YEAR_TOTAL ELSE NULL END \u003e CASE WHEN t8.YEAR_TOTAL \u003e 0 THEN t18.YEAR_TOTAL / t8.YEAR_TOTAL ELSE NULL END\nORDER BY t18.CUSTOMER_ID NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      198,
      202
    ],
    "optimizedTimesMs": [
      179,
      188
    ],
    "originalAvgMs": 200,
    "optimizedAvgMs": 183,
    "speedup": 1.092896174863388,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 45150932,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q75",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "AGGREGATE_PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t18.D_YEAR AS PREV_YEAR, t8.D_YEAR AS YEAR_, t8.I_BRAND_ID, t8.I_CLASS_ID, t8.I_CATEGORY_ID, t8.I_MANUFACT_ID, t18.SALES_CNT AS PREV_YR_CNT, t8.SALES_CNT AS CURR_YR_CNT, t8.SALES_CNT - t18.SALES_CNT AS SALES_CNT_DIFF, t8.SALES_AMT - t18.SALES_AMT AS SALES_AMT_DIFF\nFROM (SELECT D_YEAR, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, I_MANUFACT_ID, SUM(SALES_CNT) AS SALES_CNT, SUM(SALES_AMT) AS SALES_AMT\nFROM (SELECT *\nFROM (SELECT date_dim.d_year AS D_YEAR, t.i_brand_id AS I_BRAND_ID, t.i_class_id AS I_CLASS_ID, t.i_category_id AS I_CATEGORY_ID, t.i_manufact_id AS I_MANUFACT_ID, catalog_sales.cs_quantity - CASE WHEN catalog_returns.cr_return_quantity IS NOT NULL THEN CAST(catalog_returns.cr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, catalog_sales.cs_ext_sales_price - CASE WHEN catalog_returns.cr_return_amount IS NOT NULL THEN CAST(catalog_returns.cr_return_amount AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t ON catalog_sales.cs_item_sk \u003d t.i_item_sk\nINNER JOIN date_dim ON catalog_sales.cs_sold_date_sk \u003d date_dim.d_date_sk\nLEFT JOIN catalog_returns ON catalog_sales.cs_order_number \u003d catalog_returns.cr_order_number AND catalog_sales.cs_item_sk \u003d catalog_returns.cr_item_sk\nUNION\nSELECT date_dim0.d_year AS D_YEAR, t1.i_brand_id AS I_BRAND_ID, t1.i_class_id AS I_CLASS_ID, t1.i_category_id AS I_CATEGORY_ID, t1.i_manufact_id AS I_MANUFACT_ID, store_sales.ss_quantity - CASE WHEN store_returns.sr_return_quantity IS NOT NULL THEN CAST(store_returns.sr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, store_sales.ss_ext_sales_price - CASE WHEN store_returns.sr_return_amt IS NOT NULL THEN CAST(store_returns.sr_return_amt AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t1 ON store_sales.ss_item_sk \u003d t1.i_item_sk\nINNER JOIN date_dim AS date_dim0 ON store_sales.ss_sold_date_sk \u003d date_dim0.d_date_sk\nLEFT JOIN store_returns ON store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number AND store_sales.ss_item_sk \u003d store_returns.sr_item_sk)\nUNION\nSELECT date_dim1.d_year AS D_YEAR, t4.i_brand_id AS I_BRAND_ID, t4.i_class_id AS I_CLASS_ID, t4.i_category_id AS I_CATEGORY_ID, t4.i_manufact_id AS I_MANUFACT_ID, web_sales.ws_quantity - CASE WHEN web_returns.wr_return_quantity IS NOT NULL THEN CAST(web_returns.wr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, web_sales.ws_ext_sales_price - CASE WHEN web_returns.wr_return_amt IS NOT NULL THEN CAST(web_returns.wr_return_amt AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM web_sales\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t4 ON web_sales.ws_item_sk \u003d t4.i_item_sk\nINNER JOIN date_dim AS date_dim1 ON web_sales.ws_sold_date_sk \u003d date_dim1.d_date_sk\nLEFT JOIN web_returns ON web_sales.ws_order_number \u003d web_returns.wr_order_number AND web_sales.ws_item_sk \u003d web_returns.wr_item_sk) AS t6\nWHERE D_YEAR \u003d 2002\nGROUP BY D_YEAR, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, I_MANUFACT_ID) AS t8\nINNER JOIN (SELECT D_YEAR, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, I_MANUFACT_ID, SUM(SALES_CNT) AS SALES_CNT, SUM(SALES_AMT) AS SALES_AMT\nFROM (SELECT *\nFROM (SELECT date_dim2.d_year AS D_YEAR, t9.i_brand_id AS I_BRAND_ID, t9.i_class_id AS I_CLASS_ID, t9.i_category_id AS I_CATEGORY_ID, t9.i_manufact_id AS I_MANUFACT_ID, catalog_sales0.cs_quantity - CASE WHEN catalog_returns0.cr_return_quantity IS NOT NULL THEN CAST(catalog_returns0.cr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, catalog_sales0.cs_ext_sales_price - CASE WHEN catalog_returns0.cr_return_amount IS NOT NULL THEN CAST(catalog_returns0.cr_return_amount AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM catalog_sales AS catalog_sales0\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t9 ON catalog_sales0.cs_item_sk \u003d t9.i_item_sk\nINNER JOIN date_dim AS date_dim2 ON catalog_sales0.cs_sold_date_sk \u003d date_dim2.d_date_sk\nLEFT JOIN catalog_returns AS catalog_returns0 ON catalog_sales0.cs_order_number \u003d catalog_returns0.cr_order_number AND catalog_sales0.cs_item_sk \u003d catalog_returns0.cr_item_sk\nUNION\nSELECT date_dim3.d_year AS D_YEAR, t11.i_brand_id AS I_BRAND_ID, t11.i_class_id AS I_CLASS_ID, t11.i_category_id AS I_CATEGORY_ID, t11.i_manufact_id AS I_MANUFACT_ID, store_sales0.ss_quantity - CASE WHEN store_returns0.sr_return_quantity IS NOT NULL THEN CAST(store_returns0.sr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, store_sales0.ss_ext_sales_price - CASE WHEN store_returns0.sr_return_amt IS NOT NULL THEN CAST(store_returns0.sr_return_amt AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM store_sales AS store_sales0\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t11 ON store_sales0.ss_item_sk \u003d t11.i_item_sk\nINNER JOIN date_dim AS date_dim3 ON store_sales0.ss_sold_date_sk \u003d date_dim3.d_date_sk\nLEFT JOIN store_returns AS store_returns0 ON store_sales0.ss_ticket_number \u003d store_returns0.sr_ticket_number AND store_sales0.ss_item_sk \u003d store_returns0.sr_item_sk)\nUNION\nSELECT date_dim4.d_year AS D_YEAR, t14.i_brand_id AS I_BRAND_ID, t14.i_class_id AS I_CLASS_ID, t14.i_category_id AS I_CATEGORY_ID, t14.i_manufact_id AS I_MANUFACT_ID, web_sales0.ws_quantity - CASE WHEN web_returns0.wr_return_quantity IS NOT NULL THEN CAST(web_returns0.wr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, web_sales0.ws_ext_sales_price - CASE WHEN web_returns0.wr_return_amt IS NOT NULL THEN CAST(web_returns0.wr_return_amt AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM web_sales AS web_sales0\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t14 ON web_sales0.ws_item_sk \u003d t14.i_item_sk\nINNER JOIN date_dim AS date_dim4 ON web_sales0.ws_sold_date_sk \u003d date_dim4.d_date_sk\nLEFT JOIN web_returns AS web_returns0 ON web_sales0.ws_order_number \u003d web_returns0.wr_order_number AND web_sales0.ws_item_sk \u003d web_returns0.wr_item_sk) AS t16\nWHERE D_YEAR \u003d CAST(2002 - 1 AS BIGINT)\nGROUP BY D_YEAR, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, I_MANUFACT_ID) AS t18 ON t8.I_BRAND_ID \u003d t18.I_BRAND_ID AND t8.I_CLASS_ID \u003d t18.I_CLASS_ID AND t8.I_CATEGORY_ID \u003d t18.I_CATEGORY_ID AND t8.I_MANUFACT_ID \u003d t18.I_MANUFACT_ID AND CAST(t8.SALES_CNT AS DECIMAL(17, 2)) / CAST(t18.SALES_CNT AS DECIMAL(17, 2)) \u003c 0.9\nORDER BY 9, 10\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      53,
      52
    ],
    "optimizedTimesMs": [
      76,
      75
    ],
    "originalAvgMs": 52,
    "optimizedAvgMs": 75,
    "speedup": 0.6933333333333334,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": false,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q76",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT CHANNEL, COL_NAME, D_YEAR, D_QOY, I_CATEGORY, COUNT(*) AS SALES_CNT, SUM(EXT_SALES_PRICE) AS SALES_AMT\nFROM (SELECT *\nFROM (SELECT \u0027store\u0027 AS CHANNEL, \u0027ss_store_sk\u0027 AS COL_NAME, date_dim.d_year AS D_YEAR, date_dim.d_qoy AS D_QOY, item.i_category AS I_CATEGORY, t.ss_ext_sales_price AS EXT_SALES_PRICE\nFROM (SELECT *\nFROM store_sales\nWHERE ss_store_sk IS NULL) AS t\nINNER JOIN item ON t.ss_item_sk \u003d item.i_item_sk\nINNER JOIN date_dim ON t.ss_sold_date_sk \u003d date_dim.d_date_sk\nUNION ALL\nSELECT \u0027web\u0027 AS CHANNEL, \u0027ws_ship_customer_sk\u0027 AS COL_NAME, date_dim0.d_year AS D_YEAR, date_dim0.d_qoy AS D_QOY, item0.i_category AS I_CATEGORY, t1.ws_ext_sales_price AS EXT_SALES_PRICE\nFROM (SELECT *\nFROM web_sales\nWHERE ws_ship_customer_sk IS NULL) AS t1\nINNER JOIN item AS item0 ON t1.ws_item_sk \u003d item0.i_item_sk\nINNER JOIN date_dim AS date_dim0 ON t1.ws_sold_date_sk \u003d date_dim0.d_date_sk)\nUNION ALL\nSELECT \u0027catalog\u0027 AS CHANNEL, \u0027cs_ship_addr_sk\u0027 AS COL_NAME, date_dim1.d_year AS D_YEAR, date_dim1.d_qoy AS D_QOY, item1.i_category AS I_CATEGORY, t4.cs_ext_sales_price AS EXT_SALES_PRICE\nFROM (SELECT *\nFROM catalog_sales\nWHERE cs_ship_addr_sk IS NULL) AS t4\nINNER JOIN item AS item1 ON t4.cs_item_sk \u003d item1.i_item_sk\nINNER JOIN date_dim AS date_dim1 ON t4.cs_sold_date_sk \u003d date_dim1.d_date_sk) AS t6\nGROUP BY CHANNEL, COL_NAME, D_YEAR, D_QOY, I_CATEGORY\nORDER BY CHANNEL NULLS FIRST, COL_NAME NULLS FIRST, D_YEAR NULLS FIRST, D_QOY NULLS FIRST, I_CATEGORY NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      21,
      24
    ],
    "optimizedTimesMs": [
      23,
      21
    ],
    "originalAvgMs": 22,
    "optimizedAvgMs": 22,
    "speedup": 1.0,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q77",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT CHANNEL, ID, SUM(SALES) AS SALES, SUM(RETURNS_) AS RETURNS_, SUM(PROFIT) AS PROFIT\nFROM (SELECT *\nFROM (SELECT \u0027store channel\u0027 AS CHANNEL, t2.S_STORE_SK AS ID, t2.SALES, CASE WHEN t6.RETURNS_ IS NOT NULL THEN CAST(t6.RETURNS_ AS DECIMAL(19, 0)) ELSE 0 END AS RETURNS_, t2.PROFIT - CASE WHEN t6.PROFIT_LOSS IS NOT NULL THEN CAST(t6.PROFIT_LOSS AS DECIMAL(19, 0)) ELSE 0 END AS PROFIT\nFROM (SELECT store.s_store_sk AS S_STORE_SK, SUM(store_sales.ss_ext_sales_price) AS SALES, SUM(store_sales.ss_net_profit) AS PROFIT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nGROUP BY store.s_store_sk) AS t2\nLEFT JOIN (SELECT store0.s_store_sk AS S_STORE_SK, SUM(store_returns.sr_return_amt) AS RETURNS_, SUM(store_returns.sr_net_loss) AS PROFIT_LOSS\nFROM store_returns\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t3 ON store_returns.sr_returned_date_sk \u003d t3.d_date_sk\nINNER JOIN store AS store0 ON store_returns.sr_store_sk \u003d store0.s_store_sk\nGROUP BY store0.s_store_sk) AS t6 ON t2.S_STORE_SK \u003d t6.S_STORE_SK\nUNION ALL\nSELECT \u0027catalog channel\u0027 AS CHANNEL, t11.CS_CALL_CENTER_SK AS ID, t11.SALES, t15.RETURNS_, t11.PROFIT - t15.PROFIT_LOSS AS PROFIT\nFROM (SELECT catalog_sales.cs_call_center_sk AS CS_CALL_CENTER_SK, SUM(catalog_sales.cs_ext_sales_price) AS SALES, SUM(catalog_sales.cs_net_profit) AS PROFIT\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t8 ON catalog_sales.cs_sold_date_sk \u003d t8.d_date_sk\nGROUP BY catalog_sales.cs_call_center_sk) AS t11,\n(SELECT catalog_returns.cr_call_center_sk AS CR_CALL_CENTER_SK, SUM(catalog_returns.cr_return_amount) AS RETURNS_, SUM(catalog_returns.cr_net_loss) AS PROFIT_LOSS\nFROM catalog_returns\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t12 ON catalog_returns.cr_returned_date_sk \u003d t12.d_date_sk\nGROUP BY catalog_returns.cr_call_center_sk) AS t15)\nUNION ALL\nSELECT \u0027web channel\u0027 AS CHANNEL, t21.WP_WEB_PAGE_SK AS ID, t21.SALES, CASE WHEN t25.RETURNS_ IS NOT NULL THEN CAST(t25.RETURNS_ AS DECIMAL(19, 0)) ELSE 0 END AS RETURNS_, t21.PROFIT - CASE WHEN t25.PROFIT_LOSS IS NOT NULL THEN CAST(t25.PROFIT_LOSS AS DECIMAL(19, 0)) ELSE 0 END AS PROFIT\nFROM (SELECT web_page.wp_web_page_sk AS WP_WEB_PAGE_SK, SUM(web_sales.ws_ext_sales_price) AS SALES, SUM(web_sales.ws_net_profit) AS PROFIT\nFROM web_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t18 ON web_sales.ws_sold_date_sk \u003d t18.d_date_sk\nINNER JOIN web_page ON web_sales.ws_web_page_sk \u003d web_page.wp_web_page_sk\nGROUP BY web_page.wp_web_page_sk) AS t21\nLEFT JOIN (SELECT web_page0.wp_web_page_sk AS WP_WEB_PAGE_SK, SUM(web_returns.wr_return_amt) AS RETURNS_, SUM(web_returns.wr_net_loss) AS PROFIT_LOSS\nFROM web_returns\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-08-23\u0027 AND d_date \u003c\u003d DATE \u00272000-09-22\u0027) AS t22 ON web_returns.wr_returned_date_sk \u003d t22.d_date_sk\nINNER JOIN web_page AS web_page0 ON web_returns.wr_web_page_sk \u003d web_page0.wp_web_page_sk\nGROUP BY web_page0.wp_web_page_sk) AS t25 ON t21.WP_WEB_PAGE_SK \u003d t25.WP_WEB_PAGE_SK) AS t27\nGROUP BY ROLLUP(CHANNEL, ID)\nORDER BY CHANNEL NULLS FIRST, ID NULLS FIRST, 4 DESC\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      15,
      16
    ],
    "optimizedTimesMs": [
      17,
      15
    ],
    "originalAvgMs": 15,
    "optimizedAvgMs": 16,
    "speedup": 0.9375,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": false,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q78",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "AGGREGATE_PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t3.SS_SOLD_YEAR, t3.SS_ITEM_SK, t3.SS_CUSTOMER_SK, ROUND(CAST(t3.SS_QTY AS DECIMAL(19, 2)) / (CASE WHEN t7.WS_QTY IS NOT NULL THEN CAST(t7.WS_QTY AS BIGINT) ELSE 0 END + CASE WHEN t11.CS_QTY IS NOT NULL THEN CAST(t11.CS_QTY AS BIGINT) ELSE 0 END), 2) AS RATIO, t3.SS_QTY AS STORE_QTY, t3.SS_WC AS STORE_WHOLESALE_COST, t3.SS_SP AS STORE_SALES_PRICE, CASE WHEN t7.WS_QTY IS NOT NULL THEN CAST(t7.WS_QTY AS BIGINT) ELSE 0 END + CASE WHEN t11.CS_QTY IS NOT NULL THEN CAST(t11.CS_QTY AS BIGINT) ELSE 0 END AS OTHER_CHAN_QTY, CASE WHEN t7.WS_WC IS NOT NULL THEN CAST(t7.WS_WC AS DECIMAL(19, 0)) ELSE 0 END + CASE WHEN t11.CS_WC IS NOT NULL THEN CAST(t11.CS_WC AS DECIMAL(19, 0)) ELSE 0 END AS OTHER_CHAN_WHOLESALE_COST, CASE WHEN t7.WS_SP IS NOT NULL THEN CAST(t7.WS_SP AS DECIMAL(19, 0)) ELSE 0 END + CASE WHEN t11.CS_SP IS NOT NULL THEN CAST(t11.CS_SP AS DECIMAL(19, 0)) ELSE 0 END AS OTHER_CHAN_SALES_PRICE\nFROM (SELECT d_year AS SS_SOLD_YEAR, ss_item_sk AS SS_ITEM_SK, ss_customer_sk AS SS_CUSTOMER_SK, SUM(ss_quantity) AS SS_QTY, SUM(ss_wholesale_cost) AS SS_WC, SUM(ss_sales_price) AS SS_SP\nFROM (SELECT date_dim.d_year, t.ss_item_sk, t.ss_customer_sk, t.ss_quantity, t.ss_wholesale_cost, t.ss_sales_price\nFROM (SELECT *\nFROM store_sales\nLEFT JOIN store_returns ON store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number AND store_sales.ss_item_sk \u003d store_returns.sr_item_sk\nWHERE store_returns.sr_ticket_number IS NULL) AS t\nINNER JOIN date_dim ON t.ss_sold_date_sk \u003d date_dim.d_date_sk) AS t0\nWHERE t0.d_year \u003d 2000\nGROUP BY d_year, ss_item_sk, ss_customer_sk) AS t3\nLEFT JOIN (SELECT date_dim0.d_year AS WS_SOLD_YEAR, t4.ws_item_sk AS WS_ITEM_SK, t4.ws_bill_customer_sk AS WS_CUSTOMER_SK, SUM(t4.ws_quantity) AS WS_QTY, SUM(t4.ws_wholesale_cost) AS WS_WC, SUM(t4.ws_sales_price) AS WS_SP\nFROM (SELECT *\nFROM web_sales\nLEFT JOIN web_returns ON web_sales.ws_order_number \u003d web_returns.wr_order_number AND web_sales.ws_item_sk \u003d web_returns.wr_item_sk\nWHERE web_returns.wr_order_number IS NULL) AS t4\nINNER JOIN date_dim AS date_dim0 ON t4.ws_sold_date_sk \u003d date_dim0.d_date_sk\nGROUP BY t4.ws_item_sk, t4.ws_bill_customer_sk, date_dim0.d_year) AS t7 ON t3.SS_SOLD_YEAR \u003d t7.WS_SOLD_YEAR AND t3.SS_ITEM_SK \u003d t7.WS_ITEM_SK AND t3.SS_CUSTOMER_SK \u003d t7.WS_CUSTOMER_SK\nLEFT JOIN (SELECT date_dim1.d_year AS CS_SOLD_YEAR, t8.cs_item_sk AS CS_ITEM_SK, t8.cs_bill_customer_sk AS CS_CUSTOMER_SK, SUM(t8.cs_quantity) AS CS_QTY, SUM(t8.cs_wholesale_cost) AS CS_WC, SUM(t8.cs_sales_price) AS CS_SP\nFROM (SELECT *\nFROM catalog_sales\nLEFT JOIN catalog_returns ON catalog_sales.cs_order_number \u003d catalog_returns.cr_order_number AND catalog_sales.cs_item_sk \u003d catalog_returns.cr_item_sk\nWHERE catalog_returns.cr_order_number IS NULL) AS t8\nINNER JOIN date_dim AS date_dim1 ON t8.cs_sold_date_sk \u003d date_dim1.d_date_sk\nGROUP BY t8.cs_bill_customer_sk, t8.cs_item_sk, date_dim1.d_year) AS t11 ON t3.SS_SOLD_YEAR \u003d t11.CS_SOLD_YEAR AND t3.SS_ITEM_SK \u003d t11.CS_ITEM_SK AND t3.SS_CUSTOMER_SK \u003d t11.CS_CUSTOMER_SK\nWHERE CASE WHEN t7.WS_QTY IS NOT NULL THEN CAST(t7.WS_QTY AS BIGINT) ELSE 0 END \u003e 0 OR CASE WHEN t11.CS_QTY IS NOT NULL THEN CAST(t11.CS_QTY AS BIGINT) ELSE 0 END \u003e 0\nORDER BY t3.SS_SOLD_YEAR, t3.SS_ITEM_SK, t3.SS_CUSTOMER_SK, t3.SS_QTY DESC, t3.SS_WC DESC, t3.SS_SP DESC, 8, 9, 10, 4\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      88,
      82
    ],
    "optimizedTimesMs": [
      266,
      254
    ],
    "originalAvgMs": 85,
    "optimizedAvgMs": 260,
    "speedup": 0.3269230769230769,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": false,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q79",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "FILTER_AGGREGATE_TRANSPOSE",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, SUBSTRING(t4.S_CITY, 1, 30), t4.SS_TICKET_NUMBER, t4.AMT, t4.PROFIT\nFROM (SELECT store_sales.ss_ticket_number AS SS_TICKET_NUMBER, store_sales.ss_customer_sk AS SS_CUSTOMER_SK, t0.s_city AS S_CITY, SUM(store_sales.ss_coupon_amt) AS AMT, SUM(store_sales.ss_net_profit) AS PROFIT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_dow \u003d 1 AND (d_year \u003d 1999 OR d_year \u003d CAST(1999 + 1 AS BIGINT) OR d_year \u003d CAST(1999 + 2 AS BIGINT))) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_number_employees \u003e\u003d 200 AND s_number_employees \u003c\u003d 295) AS t0 ON store_sales.ss_store_sk \u003d t0.s_store_sk\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 6 OR hd_vehicle_count \u003e 2) AS t1 ON store_sales.ss_hdemo_sk \u003d t1.hd_demo_sk\nGROUP BY store_sales.ss_ticket_number, store_sales.ss_customer_sk, store_sales.ss_addr_sk, t0.s_city) AS t4\nINNER JOIN customer ON t4.SS_CUSTOMER_SK \u003d customer.c_customer_sk\nORDER BY customer.c_last_name NULLS FIRST, customer.c_first_name NULLS FIRST, 3 NULLS FIRST, t4.PROFIT NULLS FIRST, t4.SS_TICKET_NUMBER\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      52,
      54
    ],
    "optimizedTimesMs": [
      54,
      50
    ],
    "originalAvgMs": 53,
    "optimizedAvgMs": 52,
    "speedup": 1.0192307692307692,
    "originalRowCount": 100,
    "optimizedRowCount": 100,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q80",
    "status": "error",
    "error": "From line 65, column 11 to line 65, column 35: No match found for function signature CONCAT(\u003cCHARACTER\u003e, \u003cCHARACTER\u003e)",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q81",
    "status": "error",
    "error": "variable $cor0 is not found",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "FILTER_AGGREGATE_TRANSPOSE",
      "SUBQUERY_REMOVE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q82",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t.i_item_id AS I_ITEM_ID, t.i_item_desc AS I_ITEM_DESC, t.i_current_price AS I_CURRENT_PRICE\nFROM (SELECT *\nFROM item\nWHERE i_current_price \u003e\u003d 62 AND i_current_price \u003c\u003d 62 + 30 AND i_manufact_id IN (129, 270, 423, 821)) AS t\nINNER JOIN (SELECT *\nFROM inventory\nWHERE inv_quantity_on_hand \u003e\u003d 100 AND inv_quantity_on_hand \u003c\u003d 500) AS t0 ON t.i_item_sk \u003d t0.inv_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00272000-05-25\u0027 AND d_date \u003c\u003d DATE \u00272000-07-24\u0027) AS t1 ON t0.inv_date_sk \u003d t1.d_date_sk\nINNER JOIN store_sales ON t.i_item_sk \u003d store_sales.ss_item_sk\nGROUP BY t.i_item_id, t.i_item_desc, t.i_current_price\nORDER BY t.i_item_id\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      21,
      18
    ],
    "optimizedTimesMs": [
      26,
      19
    ],
    "originalAvgMs": 19,
    "optimizedAvgMs": 22,
    "speedup": 0.8636363636363636,
    "originalRowCount": 6,
    "optimizedRowCount": 6,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q83",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t6.ITEM_ID, t6.SR_ITEM_QTY, CAST(t6.SR_ITEM_QTY AS DECIMAL(19, 4)) / (t6.SR_ITEM_QTY + t14.CR_ITEM_QTY + t22.WR_ITEM_QTY) / 3.0000 * 100 AS SR_DEV, t14.CR_ITEM_QTY, CAST(t14.CR_ITEM_QTY AS DECIMAL(19, 4)) / (t6.SR_ITEM_QTY + t14.CR_ITEM_QTY + t22.WR_ITEM_QTY) / 3.0000 * 100 AS CR_DEV, t22.WR_ITEM_QTY, CAST(t22.WR_ITEM_QTY AS DECIMAL(19, 4)) / (t6.SR_ITEM_QTY + t14.CR_ITEM_QTY + t22.WR_ITEM_QTY) / 3.0000 * 100 AS WR_DEV, (t6.SR_ITEM_QTY + t14.CR_ITEM_QTY + t22.WR_ITEM_QTY) / 3.0 AS AVERAGE\nFROM (SELECT item.i_item_id AS ITEM_ID, SUM(store_returns.sr_return_quantity) AS SR_ITEM_QTY\nFROM store_returns\nINNER JOIN item ON store_returns.sr_item_sk \u003d item.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date IN (SELECT d_date AS D_DATE\nFROM date_dim\nWHERE d_week_seq IN (SELECT d_week_seq AS D_WEEK_SEQ\nFROM date_dim\nWHERE d_date \u003d \u00272000-06-30\u0027 OR d_date \u003d \u00272000-09-27\u0027 OR d_date \u003d \u00272000-11-17\u0027))) AS t3 ON store_returns.sr_returned_date_sk \u003d t3.d_date_sk\nGROUP BY item.i_item_id) AS t6\nINNER JOIN (SELECT item0.i_item_id AS ITEM_ID, SUM(catalog_returns.cr_return_quantity) AS CR_ITEM_QTY\nFROM catalog_returns\nINNER JOIN item AS item0 ON catalog_returns.cr_item_sk \u003d item0.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date IN (SELECT d_date AS D_DATE\nFROM date_dim\nWHERE d_week_seq IN (SELECT d_week_seq AS D_WEEK_SEQ\nFROM date_dim\nWHERE d_date \u003d \u00272000-06-30\u0027 OR d_date \u003d \u00272000-09-27\u0027 OR d_date \u003d \u00272000-11-17\u0027))) AS t11 ON catalog_returns.cr_returned_date_sk \u003d t11.d_date_sk\nGROUP BY item0.i_item_id) AS t14 ON t6.ITEM_ID \u003d t14.ITEM_ID\nINNER JOIN (SELECT item1.i_item_id AS ITEM_ID, SUM(web_returns.wr_return_quantity) AS WR_ITEM_QTY\nFROM web_returns\nINNER JOIN item AS item1 ON web_returns.wr_item_sk \u003d item1.i_item_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date IN (SELECT d_date AS D_DATE\nFROM date_dim\nWHERE d_week_seq IN (SELECT d_week_seq AS D_WEEK_SEQ\nFROM date_dim\nWHERE d_date \u003d \u00272000-06-30\u0027 OR d_date \u003d \u00272000-09-27\u0027 OR d_date \u003d \u00272000-11-17\u0027))) AS t19 ON web_returns.wr_returned_date_sk \u003d t19.d_date_sk\nGROUP BY item1.i_item_id) AS t22 ON t6.ITEM_ID \u003d t22.ITEM_ID\nORDER BY t6.ITEM_ID NULLS FIRST, t6.SR_ITEM_QTY NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      14,
      13
    ],
    "optimizedTimesMs": [
      14,
      14
    ],
    "originalAvgMs": 13,
    "optimizedAvgMs": 14,
    "speedup": 0.9285714285714286,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 288581,
    "optimizedPlanMaxRows": 288581
  },
  {
    "query": "q84",
    "status": "error",
    "error": "From line 2, column 15 to line 2, column 54: No match found for function signature CONCAT(\u003cCHARACTER\u003e, \u003cCHARACTER\u003e)",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q85",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "optimizedSql": "SELECT SUBSTRING(reason.r_reason_desc, 1, 20), AVG(web_sales.ws_quantity) AS AVG1, AVG(web_returns.wr_refunded_cash) AS AVG2, AVG(web_returns.wr_fee)\nFROM web_sales\nINNER JOIN web_returns ON web_sales.ws_item_sk \u003d web_returns.wr_item_sk AND web_sales.ws_order_number \u003d web_returns.wr_order_number\nINNER JOIN web_page ON web_sales.ws_web_page_sk \u003d web_page.wp_web_page_sk\nINNER JOIN customer_demographics ON web_returns.wr_refunded_cdemo_sk \u003d customer_demographics.cd_demo_sk\nINNER JOIN customer_demographics AS customer_demographics0 ON web_returns.wr_returning_cdemo_sk \u003d customer_demographics0.cd_demo_sk AND (customer_demographics.cd_marital_status \u003d \u0027M\u0027 AND customer_demographics.cd_marital_status \u003d customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status \u003d \u0027Advanced Degree\u0027 AND customer_demographics.cd_education_status \u003d customer_demographics0.cd_education_status AND (web_sales.ws_sales_price \u003e\u003d 100.00 AND web_sales.ws_sales_price \u003c\u003d 150.00) OR customer_demographics.cd_marital_status \u003d \u0027S\u0027 AND customer_demographics.cd_marital_status \u003d customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status \u003d \u0027College\u0027 AND customer_demographics.cd_education_status \u003d customer_demographics0.cd_education_status AND (web_sales.ws_sales_price \u003e\u003d 50.00 AND web_sales.ws_sales_price \u003c\u003d 100.00) OR customer_demographics.cd_marital_status \u003d \u0027W\u0027 AND customer_demographics.cd_marital_status \u003d customer_demographics0.cd_marital_status AND customer_demographics.cd_education_status \u003d \u00272 yr Degree\u0027 AND customer_demographics.cd_education_status \u003d customer_demographics0.cd_education_status AND (web_sales.ws_sales_price \u003e\u003d 150.00 AND web_sales.ws_sales_price \u003c\u003d 200.00))\nINNER JOIN customer_address ON web_returns.wr_refunded_addr_sk \u003d customer_address.ca_address_sk AND (customer_address.ca_country \u003d \u0027United States\u0027 AND customer_address.ca_state IN (\u0027IN\u0027, \u0027NJ\u0027, \u0027OH\u0027) AND (web_sales.ws_net_profit \u003e\u003d 100 AND web_sales.ws_net_profit \u003c\u003d 200) OR customer_address.ca_country \u003d \u0027United States\u0027 AND customer_address.ca_state IN (\u0027CT\u0027, \u0027KY\u0027, \u0027WI\u0027) AND (web_sales.ws_net_profit \u003e\u003d 150 AND web_sales.ws_net_profit \u003c\u003d 300) OR customer_address.ca_country \u003d \u0027United States\u0027 AND customer_address.ca_state IN (\u0027AR\u0027, \u0027IA\u0027, \u0027LA\u0027) AND (web_sales.ws_net_profit \u003e\u003d 50 AND web_sales.ws_net_profit \u003c\u003d 250))\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000) AS t ON web_sales.ws_sold_date_sk \u003d t.d_date_sk\nINNER JOIN reason ON web_returns.wr_reason_sk \u003d reason.r_reason_sk\nGROUP BY reason.r_reason_desc\nORDER BY 1, 2, 3, 4\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      30,
      25
    ],
    "optimizedTimesMs": [
      23,
      24
    ],
    "originalAvgMs": 27,
    "optimizedAvgMs": 23,
    "speedup": 1.173913043478261,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": true,
    "originalPlanMaxRows": 1920800,
    "optimizedPlanMaxRows": 1920800
  },
  {
    "query": "q86",
    "status": "error",
    "error": "class org.apache.calcite.sql.SqlBasicCall: RANK() OVER (PARTITION BY GROUPING(`I_CATEGORY`) + GROUPING(`I_CLASS`), CASE WHEN GROUPING(`I_CLASS`) \u003d 0 THEN `I_CATEGORY` ELSE NULL END ORDER BY SUM(`WS_NET_PAID`) DESC)",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "PROJECT_MERGE",
      "SORT_REMOVE_REDUNDANT",
      "AGGREGATE_REDUCE_FUNCTIONS"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q87",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "PROJECT_MERGE",
      "MINUS_MERGE",
      "AGGREGATE_REMOVE",
      "PROJECT_REMOVE"
    ],
    "optimizedSql": "SELECT COUNT(*)\nFROM (SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, t.d_date AS D_DATE\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN customer ON store_sales.ss_customer_sk \u003d customer.c_customer_sk\nGROUP BY customer.c_last_name, customer.c_first_name, t.d_date\nEXCEPT\nSELECT customer0.c_last_name AS C_LAST_NAME, customer0.c_first_name AS C_FIRST_NAME, t2.d_date AS D_DATE\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t2 ON catalog_sales.cs_sold_date_sk \u003d t2.d_date_sk\nINNER JOIN customer AS customer0 ON catalog_sales.cs_bill_customer_sk \u003d customer0.c_customer_sk\nGROUP BY customer0.c_last_name, customer0.c_first_name, t2.d_date\nEXCEPT\nSELECT customer1.c_last_name AS C_LAST_NAME, customer1.c_first_name AS C_FIRST_NAME, t5.d_date AS D_DATE\nFROM web_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t5 ON web_sales.ws_sold_date_sk \u003d t5.d_date_sk\nINNER JOIN customer AS customer1 ON web_sales.ws_bill_customer_sk \u003d customer1.c_customer_sk\nGROUP BY customer1.c_last_name, customer1.c_first_name, t5.d_date) AS t8",
    "originalTimesMs": [
      141,
      144
    ],
    "optimizedTimesMs": [
      161,
      138
    ],
    "originalAvgMs": 142,
    "optimizedAvgMs": 149,
    "speedup": 0.9530201342281879,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q88",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "PROJECT_REMOVE"
    ],
    "optimizedSql": "SELECT *\nFROM (SELECT COUNT(*) AS H8_30_TO_9\nFROM store_sales\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 AND hd_vehicle_count \u003c\u003d 4 + 2 OR hd_dep_count \u003d 2 AND hd_vehicle_count \u003c\u003d 2 + 2 OR hd_dep_count \u003d 0 AND hd_vehicle_count \u003c\u003d 2) AS t ON store_sales.ss_hdemo_sk \u003d t.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003d 8 AND t_minute \u003e\u003d 30) AS t0 ON store_sales.ss_sold_time_sk \u003d t0.t_time_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_store_name \u003d \u0027ese\u0027) AS t1 ON store_sales.ss_store_sk \u003d t1.s_store_sk) AS t2,\n(SELECT COUNT(*) AS H9_TO_9_30\nFROM store_sales AS store_sales0\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 AND hd_vehicle_count \u003c\u003d 4 + 2 OR hd_dep_count \u003d 2 AND hd_vehicle_count \u003c\u003d 2 + 2 OR hd_dep_count \u003d 0 AND hd_vehicle_count \u003c\u003d 2) AS t3 ON store_sales0.ss_hdemo_sk \u003d t3.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003d 9 AND t_minute \u003c 30) AS t4 ON store_sales0.ss_sold_time_sk \u003d t4.t_time_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_store_name \u003d \u0027ese\u0027) AS t5 ON store_sales0.ss_store_sk \u003d t5.s_store_sk) AS t6,\n(SELECT COUNT(*) AS H9_30_TO_10\nFROM store_sales AS store_sales1\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 AND hd_vehicle_count \u003c\u003d 4 + 2 OR hd_dep_count \u003d 2 AND hd_vehicle_count \u003c\u003d 2 + 2 OR hd_dep_count \u003d 0 AND hd_vehicle_count \u003c\u003d 2) AS t7 ON store_sales1.ss_hdemo_sk \u003d t7.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003d 9 AND t_minute \u003e\u003d 30) AS t8 ON store_sales1.ss_sold_time_sk \u003d t8.t_time_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_store_name \u003d \u0027ese\u0027) AS t9 ON store_sales1.ss_store_sk \u003d t9.s_store_sk) AS t10,\n(SELECT COUNT(*) AS H10_TO_10_30\nFROM store_sales AS store_sales2\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 AND hd_vehicle_count \u003c\u003d 4 + 2 OR hd_dep_count \u003d 2 AND hd_vehicle_count \u003c\u003d 2 + 2 OR hd_dep_count \u003d 0 AND hd_vehicle_count \u003c\u003d 2) AS t11 ON store_sales2.ss_hdemo_sk \u003d t11.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003d 10 AND t_minute \u003c 30) AS t12 ON store_sales2.ss_sold_time_sk \u003d t12.t_time_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_store_name \u003d \u0027ese\u0027) AS t13 ON store_sales2.ss_store_sk \u003d t13.s_store_sk) AS t14,\n(SELECT COUNT(*) AS H10_30_TO_11\nFROM store_sales AS store_sales3\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 AND hd_vehicle_count \u003c\u003d 4 + 2 OR hd_dep_count \u003d 2 AND hd_vehicle_count \u003c\u003d 2 + 2 OR hd_dep_count \u003d 0 AND hd_vehicle_count \u003c\u003d 2) AS t15 ON store_sales3.ss_hdemo_sk \u003d t15.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003d 10 AND t_minute \u003e\u003d 30) AS t16 ON store_sales3.ss_sold_time_sk \u003d t16.t_time_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_store_name \u003d \u0027ese\u0027) AS t17 ON store_sales3.ss_store_sk \u003d t17.s_store_sk) AS t18,\n(SELECT COUNT(*) AS H11_TO_11_30\nFROM store_sales AS store_sales4\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 AND hd_vehicle_count \u003c\u003d 4 + 2 OR hd_dep_count \u003d 2 AND hd_vehicle_count \u003c\u003d 2 + 2 OR hd_dep_count \u003d 0 AND hd_vehicle_count \u003c\u003d 2) AS t19 ON store_sales4.ss_hdemo_sk \u003d t19.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003d 11 AND t_minute \u003c 30) AS t20 ON store_sales4.ss_sold_time_sk \u003d t20.t_time_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_store_name \u003d \u0027ese\u0027) AS t21 ON store_sales4.ss_store_sk \u003d t21.s_store_sk) AS t22,\n(SELECT COUNT(*) AS H11_30_TO_12\nFROM store_sales AS store_sales5\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 AND hd_vehicle_count \u003c\u003d 4 + 2 OR hd_dep_count \u003d 2 AND hd_vehicle_count \u003c\u003d 2 + 2 OR hd_dep_count \u003d 0 AND hd_vehicle_count \u003c\u003d 2) AS t23 ON store_sales5.ss_hdemo_sk \u003d t23.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003d 11 AND t_minute \u003e\u003d 30) AS t24 ON store_sales5.ss_sold_time_sk \u003d t24.t_time_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_store_name \u003d \u0027ese\u0027) AS t25 ON store_sales5.ss_store_sk \u003d t25.s_store_sk) AS t26,\n(SELECT COUNT(*) AS H12_TO_12_30\nFROM store_sales AS store_sales6\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 4 AND hd_vehicle_count \u003c\u003d 4 + 2 OR hd_dep_count \u003d 2 AND hd_vehicle_count \u003c\u003d 2 + 2 OR hd_dep_count \u003d 0 AND hd_vehicle_count \u003c\u003d 2) AS t27 ON store_sales6.ss_hdemo_sk \u003d t27.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003d 12 AND t_minute \u003c 30) AS t28 ON store_sales6.ss_sold_time_sk \u003d t28.t_time_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_store_name \u003d \u0027ese\u0027) AS t29 ON store_sales6.ss_store_sk \u003d t29.s_store_sk) AS t30",
    "originalTimesMs": [
      42,
      45
    ],
    "optimizedTimesMs": [
      45,
      46
    ],
    "originalAvgMs": 43,
    "optimizedAvgMs": 45,
    "speedup": 0.9555555555555556,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q89",
    "status": "error",
    "error": "class org.apache.calcite.sql.SqlBasicCall: AVG(SUM(`SS_SALES_PRICE`))",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_SCAN",
      "FILTER_AGGREGATE_TRANSPOSE",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "AGGREGATE_PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q90",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT CASE WHEN t6.PMC \u003d 0 THEN NULL ELSE CAST(t2.AMC AS DECIMAL(15, 4)) / CAST(t6.PMC AS DECIMAL(15, 4)) END AS AM_PM_RATIO\nFROM (SELECT COUNT(*) AS AMC\nFROM web_sales\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 6) AS t ON web_sales.ws_ship_hdemo_sk \u003d t.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003e\u003d 8 AND t_hour \u003c\u003d 8 + 1) AS t0 ON web_sales.ws_sold_time_sk \u003d t0.t_time_sk\nINNER JOIN (SELECT *\nFROM web_page\nWHERE wp_char_count \u003e\u003d 5000 AND wp_char_count \u003c\u003d 5200) AS t1 ON web_sales.ws_web_page_sk \u003d t1.wp_web_page_sk) AS t2,\n(SELECT COUNT(*) AS PMC\nFROM web_sales AS web_sales0\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 6) AS t3 ON web_sales0.ws_ship_hdemo_sk \u003d t3.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003e\u003d 19 AND t_hour \u003c\u003d 19 + 1) AS t4 ON web_sales0.ws_sold_time_sk \u003d t4.t_time_sk\nINNER JOIN (SELECT *\nFROM web_page\nWHERE wp_char_count \u003e\u003d 5000 AND wp_char_count \u003c\u003d 5200) AS t5 ON web_sales0.ws_web_page_sk \u003d t5.wp_web_page_sk) AS t6\nORDER BY 1\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      4,
      5
    ],
    "optimizedTimesMs": [
      5,
      5
    ],
    "originalAvgMs": 4,
    "optimizedAvgMs": 5,
    "speedup": 0.8,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 719845,
    "optimizedPlanMaxRows": 719845
  },
  {
    "query": "q91",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t5.cc_call_center_id AS CALL_CENTER, t5.cc_name AS CALL_CENTER_NAME, t5.cc_manager AS MANAGER, t5.RETURNS_LOSS\nFROM (SELECT call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, t1.cd_marital_status, t1.cd_education_status, SUM(catalog_returns.cr_net_loss) AS RETURNS_LOSS\nFROM call_center\nINNER JOIN catalog_returns ON call_center.cc_call_center_sk \u003d catalog_returns.cr_call_center_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 1998 AND d_moy \u003d 11) AS t ON catalog_returns.cr_returned_date_sk \u003d t.d_date_sk\nINNER JOIN customer ON catalog_returns.cr_returning_customer_sk \u003d customer.c_customer_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_gmt_offset \u003d -7) AS t0 ON customer.c_current_addr_sk \u003d t0.ca_address_sk\nINNER JOIN (SELECT *\nFROM customer_demographics\nWHERE cd_marital_status \u003d \u0027M\u0027 AND cd_education_status \u003d \u0027Unknown\u0027 OR cd_marital_status \u003d \u0027W\u0027 AND cd_education_status \u003d \u0027Advanced Degree\u0027) AS t1 ON customer.c_current_cdemo_sk \u003d t1.cd_demo_sk\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_buy_potential LIKE \u0027Unknown%\u0027) AS t2 ON customer.c_current_hdemo_sk \u003d t2.hd_demo_sk\nGROUP BY call_center.cc_call_center_id, call_center.cc_name, call_center.cc_manager, t1.cd_marital_status, t1.cd_education_status\nORDER BY 6 DESC) AS t5",
    "originalTimesMs": [
      17,
      16
    ],
    "optimizedTimesMs": [
      16,
      15
    ],
    "originalAvgMs": 16,
    "optimizedAvgMs": 15,
    "speedup": 1.0666666666666667,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 2000000,
    "optimizedPlanMaxRows": 2000000
  },
  {
    "query": "q92",
    "status": "error",
    "error": "variable $cor0 is not found",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "SUBQUERY_REMOVE",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q93",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT store_sales.ss_customer_sk AS SS_CUSTOMER_SK, SUM(CASE WHEN store_returns.sr_return_quantity IS NOT NULL THEN (store_sales.ss_quantity - store_returns.sr_return_quantity) * store_sales.ss_sales_price ELSE store_sales.ss_quantity * store_sales.ss_sales_price END) AS SUMSALES\nFROM store_sales\nLEFT JOIN store_returns ON store_sales.ss_item_sk \u003d store_returns.sr_item_sk AND store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number\nINNER JOIN (SELECT *\nFROM reason\nWHERE r_reason_desc \u003d \u0027reason 28\u0027) AS t ON store_returns.sr_reason_sk \u003d t.r_reason_sk\nGROUP BY store_sales.ss_customer_sk\nORDER BY 2 NULLS FIRST, store_sales.ss_customer_sk NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      26,
      25
    ],
    "optimizedTimesMs": [
      23,
      23
    ],
    "originalAvgMs": 25,
    "optimizedAvgMs": 23,
    "speedup": 1.0869565217391304,
    "originalRowCount": 37,
    "optimizedRowCount": 37,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q94",
    "status": "error",
    "error": "variable $cor0 is not found",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q95",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"count\"",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "JOIN_CONDITION_PUSH",
      "PROJECT_MERGE",
      "SORT_REMOVE_REDUNDANT"
    ],
    "optimizedSql": "SELECT COUNT(DISTINCT t5.ws_order_number) AS order count, SUM(t5.ws_ext_ship_cost) AS total shipping cost, SUM(t5.ws_net_profit) AS total net profit\nFROM (SELECT *\nFROM web_sales\nWHERE ws_order_number IN (SELECT web_sales0.ws_order_number AS WS_ORDER_NUMBER\nFROM web_sales AS web_sales0,\nweb_sales AS web_sales1\nWHERE web_sales0.ws_order_number \u003d web_sales1.ws_order_number AND web_sales0.ws_warehouse_sk \u003c\u003e web_sales1.ws_warehouse_sk) AND ws_order_number IN (SELECT web_returns.wr_order_number AS WR_ORDER_NUMBER\nFROM web_returns,\n(SELECT web_sales2.ws_order_number AS WS_ORDER_NUMBER, web_sales2.ws_warehouse_sk AS WH1, web_sales3.ws_warehouse_sk AS WH2\nFROM web_sales AS web_sales2,\nweb_sales AS web_sales3\nWHERE web_sales2.ws_order_number \u003d web_sales3.ws_order_number AND web_sales2.ws_warehouse_sk \u003c\u003e web_sales3.ws_warehouse_sk) AS t2\nWHERE web_returns.wr_order_number \u003d t2.WS_ORDER_NUMBER)) AS t5\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_date \u003e\u003d DATE \u00271999-02-01\u0027 AND d_date \u003c\u003d DATE \u00271999-04-02\u0027) AS t6 ON t5.ws_ship_date_sk \u003d t6.d_date_sk\nINNER JOIN (SELECT *\nFROM customer_address\nWHERE ca_state \u003d \u0027IL\u0027) AS t7 ON t5.ws_ship_addr_sk \u003d t7.ca_address_sk\nINNER JOIN (SELECT *\nFROM web_site\nWHERE web_company_name \u003d \u0027pri\u0027) AS t8 ON t5.ws_web_site_sk \u003d t8.web_site_sk",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q96",
    "status": "success",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT COUNT(*)\nFROM store_sales\nINNER JOIN (SELECT *\nFROM household_demographics\nWHERE hd_dep_count \u003d 7) AS t ON store_sales.ss_hdemo_sk \u003d t.hd_demo_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_hour \u003d 20 AND t_minute \u003e\u003d 30) AS t0 ON store_sales.ss_sold_time_sk \u003d t0.t_time_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_store_name \u003d \u0027ese\u0027) AS t1 ON store_sales.ss_store_sk \u003d t1.s_store_sk\nORDER BY 1\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      9,
      7
    ],
    "optimizedTimesMs": [
      7,
      7
    ],
    "originalAvgMs": 8,
    "optimizedAvgMs": 7,
    "speedup": 1.1428571428571428,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q97",
    "status": "success",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "PROJECT_MERGE",
      "AGGREGATE_JOIN_TRANSPOSE",
      "JOIN_CONDITION_PUSH"
    ],
    "optimizedSql": "SELECT SUM(CASE WHEN t2.CUSTOMER_SK IS NOT NULL AND t6.CUSTOMER_SK IS NULL THEN 1 ELSE 0 END) AS STORE_ONLY, SUM(CASE WHEN t2.CUSTOMER_SK IS NULL AND t6.CUSTOMER_SK IS NOT NULL THEN 1 ELSE 0 END) AS CATALOG_ONLY, SUM(CASE WHEN t2.CUSTOMER_SK IS NOT NULL AND t6.CUSTOMER_SK IS NOT NULL THEN 1 ELSE 0 END) AS STORE_AND_CATALOG\nFROM (SELECT store_sales.ss_customer_sk AS CUSTOMER_SK, store_sales.ss_item_sk AS ITEM_SK\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nGROUP BY store_sales.ss_customer_sk, store_sales.ss_item_sk) AS t2\nFULL JOIN (SELECT catalog_sales.cs_bill_customer_sk AS CUSTOMER_SK, catalog_sales.cs_item_sk AS ITEM_SK\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t3 ON catalog_sales.cs_sold_date_sk \u003d t3.d_date_sk\nGROUP BY catalog_sales.cs_bill_customer_sk, catalog_sales.cs_item_sk) AS t6 ON t2.CUSTOMER_SK \u003d t6.CUSTOMER_SK AND t2.ITEM_SK \u003d t6.ITEM_SK\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [
      39,
      37
    ],
    "optimizedTimesMs": [
      36,
      37
    ],
    "originalAvgMs": 38,
    "optimizedAvgMs": 36,
    "speedup": 1.0555555555555556,
    "originalRowCount": 1,
    "optimizedRowCount": 1,
    "validationPassed": true,
    "originalPlanMaxRows": 2878107,
    "optimizedPlanMaxRows": 2878107
  },
  {
    "query": "q98",
    "status": "error",
    "error": "while converting SUM(`SS_EXT_SALES_PRICE`) * 100.0000 / (SUM(SUM(`SS_EXT_SALES_PRICE`)) OVER (PARTITION BY `I_CLASS`))",
    "rules": [
      "FILTER_INTO_JOIN",
      "FILTER_PROJECT_TRANSPOSE",
      "FILTER_SCAN",
      "PROJECT_MERGE",
      "JOIN_CONDITION_PUSH",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  },
  {
    "query": "q99",
    "status": "error",
    "error": "java.sql.SQLException: Parser Error: syntax error at or near \"30\"",
    "rules": [
      "FILTER_SCAN",
      "FILTER_INTO_JOIN",
      "AGGREGATE_CASE_TO_FILTER",
      "PROJECT_MERGE",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "optimizedSql": "SELECT t.W_SUBSTR, ship_mode.sm_type AS SM_TYPE, LOWER(call_center.cc_name) AS CC_NAME_LOWER, SUM(CASE WHEN catalog_sales.cs_ship_date_sk - catalog_sales.cs_sold_date_sk \u003c\u003d 30 THEN 1 ELSE 0 END) AS 30 days, SUM(CASE WHEN catalog_sales.cs_ship_date_sk - catalog_sales.cs_sold_date_sk \u003e 30 AND catalog_sales.cs_ship_date_sk - catalog_sales.cs_sold_date_sk \u003c\u003d 60 THEN 1 ELSE 0 END) AS 31-60 days, SUM(CASE WHEN catalog_sales.cs_ship_date_sk - catalog_sales.cs_sold_date_sk \u003e 60 AND catalog_sales.cs_ship_date_sk - catalog_sales.cs_sold_date_sk \u003c\u003d 90 THEN 1 ELSE 0 END) AS 61-90 days, SUM(CASE WHEN catalog_sales.cs_ship_date_sk - catalog_sales.cs_sold_date_sk \u003e 90 AND catalog_sales.cs_ship_date_sk - catalog_sales.cs_sold_date_sk \u003c\u003d 120 THEN 1 ELSE 0 END) AS 91-120 days, SUM(CASE WHEN catalog_sales.cs_ship_date_sk - catalog_sales.cs_sold_date_sk \u003e 120 THEN 1 ELSE 0 END) AS \u003e120 days\nFROM catalog_sales\nINNER JOIN (SELECT SUBSTRING(w_warehouse_name, 1, 20) AS W_SUBSTR, w_warehouse_sk, w_warehouse_id, w_warehouse_name, w_warehouse_sq_ft, w_street_number, w_street_name, w_street_type, w_suite_number, w_city, w_county, w_state, w_zip, w_country, w_gmt_offset\nFROM warehouse) AS t ON catalog_sales.cs_warehouse_sk \u003d t.w_warehouse_sk\nINNER JOIN ship_mode ON catalog_sales.cs_ship_mode_sk \u003d ship_mode.sm_ship_mode_sk\nINNER JOIN call_center ON catalog_sales.cs_call_center_sk \u003d call_center.cc_call_center_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t0 ON catalog_sales.cs_ship_date_sk \u003d t0.d_date_sk\nGROUP BY t.W_SUBSTR, ship_mode.sm_type, call_center.cc_name\nORDER BY t.W_SUBSTR NULLS FIRST, ship_mode.sm_type NULLS FIRST, 3 NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
    "originalTimesMs": [],
    "optimizedTimesMs": [],
    "originalAvgMs": 0,
    "optimizedAvgMs": 0,
    "speedup": 0.0,
    "originalRowCount": 0,
    "optimizedRowCount": 0,
    "validationPassed": false
  }
]