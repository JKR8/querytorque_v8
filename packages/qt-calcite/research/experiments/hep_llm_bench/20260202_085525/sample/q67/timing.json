{
  "query": "q67",
  "status": "pending",
  "rules": [
    "FILTER_INTO_JOIN",
    "FILTER_PROJECT_TRANSPOSE",
    "FILTER_SCAN",
    "PROJECT_MERGE",
    "FILTER_AGGREGATE_TRANSPOSE",
    "SORT_PROJECT_TRANSPOSE",
    "SORT_REMOVE_REDUNDANT"
  ],
  "optimizedSql": "SELECT I_CATEGORY, I_CLASS, I_BRAND, I_PRODUCT_NAME, D_YEAR, D_QOY, D_MOY, S_STORE_ID, SUMSALES, RK\nFROM (SELECT t1.i_category AS I_CATEGORY, t1.i_class AS I_CLASS, t1.i_brand AS I_BRAND, t1.i_product_name AS I_PRODUCT_NAME, t1.d_year AS D_YEAR, t1.d_qoy AS D_QOY, t1.d_moy AS D_MOY, t1.s_store_id AS S_STORE_ID, t1.SUMSALES, RANK() OVER (PARTITION BY t1.i_category ORDER BY t1.SUMSALES DESC) AS RK\nFROM (SELECT item.i_category, item.i_class, item.i_brand, item.i_product_name, t.d_year, t.d_qoy, t.d_moy, store.s_store_id, SUM(CASE WHEN store_sales.ss_sales_price IS NOT NULL AND store_sales.ss_quantity IS NOT NULL THEN CAST(store_sales.ss_sales_price * store_sales.ss_quantity AS DECIMAL(19, 0)) ELSE 0 END) AS SUMSALES\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1200 AND d_month_seq \u003c\u003d 1200 + 11) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN store ON store_sales.ss_store_sk \u003d store.s_store_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nGROUP BY ROLLUP(item.i_category, item.i_class, item.i_brand, item.i_product_name, t.d_year, t.d_qoy, t.d_moy, store.s_store_id)) AS t1) AS t2\nWHERE RK \u003c\u003d 100\nORDER BY I_CATEGORY NULLS FIRST, I_CLASS NULLS FIRST, I_BRAND NULLS FIRST, I_PRODUCT_NAME NULLS FIRST, D_YEAR NULLS FIRST, D_QOY NULLS FIRST, D_MOY NULLS FIRST, S_STORE_ID NULLS FIRST, SUMSALES NULLS FIRST, RK NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    699,
    639
  ],
  "optimizedTimesMs": [
    671,
    667
  ],
  "originalAvgMs": 669,
  "optimizedAvgMs": 669,
  "speedup": 1.0,
  "originalRowCount": 100,
  "optimizedRowCount": 100,
  "validationPassed": false,
  "originalPlanMaxRows": 2878107,
  "optimizedPlanMaxRows": 2878107
}