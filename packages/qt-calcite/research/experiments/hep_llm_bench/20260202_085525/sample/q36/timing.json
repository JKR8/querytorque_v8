{
  "query": "q36",
  "status": "pending",
  "rules": [
    "FILTER_SCAN",
    "FILTER_INTO_JOIN",
    "PROJECT_MERGE",
    "AGGREGATE_JOIN_TRANSPOSE",
    "SORT_PROJECT_TRANSPOSE",
    "SORT_REMOVE_REDUNDANT"
  ],
  "optimizedSql": "SELECT GROSS_MARGIN, I_CATEGORY, I_CLASS, LOCHIERARCHY, RANK() OVER (PARTITION BY LOCHIERARCHY, CASE WHEN T_CLASS \u003d 0 THEN I_CATEGORY ELSE NULL END ORDER BY GROSS_MARGIN) AS RANK_WITHIN_PARENT, CASE WHEN LOCHIERARCHY \u003d 0 THEN I_CATEGORY ELSE NULL END\nFROM (SELECT *\nFROM (SELECT CAST(SUM(store_sales.ss_net_profit) AS DECIMAL(19, 4)) / SUM(store_sales.ss_ext_sales_price) AS GROSS_MARGIN, item.i_category AS I_CATEGORY, item.i_class AS I_CLASS, 0 AS T_CATEGORY, 0 AS T_CLASS, 0 AS LOCHIERARCHY\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t ON store_sales.ss_sold_date_sk \u003d t.d_date_sk\nINNER JOIN item ON store_sales.ss_item_sk \u003d item.i_item_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_state \u003d \u0027TN\u0027) AS t0 ON store_sales.ss_store_sk \u003d t0.s_store_sk\nGROUP BY item.i_category, item.i_class\nUNION\nSELECT CAST(SUM(t8.SS_NET_PROFIT) AS DECIMAL(19, 4)) / SUM(t8.SS_EXT_SALES_PRICE) AS GROSS_MARGIN, t8.I_CATEGORY, NULL AS I_CLASS, 0 AS T_CATEGORY, 1 AS T_CLASS, 1 AS LOCHIERARCHY\nFROM (SELECT item0.i_category AS I_CATEGORY, SUM(store_sales0.ss_net_profit) AS SS_NET_PROFIT, SUM(store_sales0.ss_ext_sales_price) AS SS_EXT_SALES_PRICE\nFROM store_sales AS store_sales0\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t4 ON store_sales0.ss_sold_date_sk \u003d t4.d_date_sk\nINNER JOIN item AS item0 ON store_sales0.ss_item_sk \u003d item0.i_item_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_state \u003d \u0027TN\u0027) AS t5 ON store_sales0.ss_store_sk \u003d t5.s_store_sk\nGROUP BY item0.i_category, item0.i_class) AS t8\nGROUP BY t8.I_CATEGORY)\nUNION\nSELECT CAST(SUM(t16.SS_NET_PROFIT) AS DECIMAL(19, 4)) / SUM(t16.SS_EXT_SALES_PRICE) AS GROSS_MARGIN, NULL AS I_CATEGORY, NULL AS I_CLASS, 1 AS T_CATEGORY, 1 AS T_CLASS, 2 AS LOCHIERARCHY\nFROM (SELECT SUM(store_sales1.ss_net_profit) AS SS_NET_PROFIT, SUM(store_sales1.ss_ext_sales_price) AS SS_EXT_SALES_PRICE\nFROM store_sales AS store_sales1\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t12 ON store_sales1.ss_sold_date_sk \u003d t12.d_date_sk\nINNER JOIN item AS item1 ON store_sales1.ss_item_sk \u003d item1.i_item_sk\nINNER JOIN (SELECT *\nFROM store\nWHERE s_state \u003d \u0027TN\u0027) AS t13 ON store_sales1.ss_store_sk \u003d t13.s_store_sk\nGROUP BY item1.i_category, item1.i_class) AS t16) AS t19\nORDER BY LOCHIERARCHY DESC, 6 NULLS FIRST, 5 NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    27,
    27
  ],
  "optimizedTimesMs": [
    39,
    38
  ],
  "originalAvgMs": 27,
  "optimizedAvgMs": 38,
  "speedup": 0.7105263157894737,
  "originalRowCount": 100,
  "optimizedRowCount": 100,
  "validationPassed": false,
  "originalPlanMaxRows": 3099951,
  "optimizedPlanMaxRows": 2878107
}