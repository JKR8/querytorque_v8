{
  "query": "q23",
  "status": "pending",
  "rules": [
    "FILTER_INTO_JOIN",
    "FILTER_PROJECT_TRANSPOSE",
    "FILTER_SCAN",
    "JOIN_CONDITION_PUSH",
    "PROJECT_MERGE",
    "FILTER_AGGREGATE_TRANSPOSE",
    "SORT_PROJECT_TRANSPOSE"
  ],
  "optimizedSql": "SELECT C_LAST_NAME, C_FIRST_NAME, SALES\nFROM (SELECT customer.c_last_name AS C_LAST_NAME, customer.c_first_name AS C_FIRST_NAME, SUM(catalog_sales.cs_quantity * catalog_sales.cs_list_price) AS SALES\nFROM catalog_sales\nINNER JOIN customer ON catalog_sales.cs_bill_customer_sk \u003d customer.c_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 AND d_moy \u003d 2) AS t ON catalog_sales.cs_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT t1.ITEMDESC, t1.i_item_sk AS ITEM_SK, t0.d_date AS SOLDDATE, COUNT(*) AS CNT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 OR d_year \u003d CAST(2000 + 1 AS BIGINT) OR d_year \u003d CAST(2000 + 2 AS BIGINT) OR d_year \u003d CAST(2000 + 3 AS BIGINT)) AS t0 ON store_sales.ss_sold_date_sk \u003d t0.d_date_sk\nINNER JOIN (SELECT SUBSTRING(i_item_desc, 1, 30) AS ITEMDESC, i_item_sk, i_item_id, i_rec_start_date, i_rec_end_date, i_item_desc, i_current_price, i_wholesale_cost, i_brand_id, i_brand, i_class_id, i_class, i_category_id, i_category, i_manufact_id, i_manufact, i_size, i_formulation, i_color, i_units, i_container, i_manager_id, i_product_name\nFROM item) AS t1 ON store_sales.ss_item_sk \u003d t1.i_item_sk\nGROUP BY t1.ITEMDESC, t1.i_item_sk, t0.d_date\nHAVING COUNT(*) \u003e 4) AS t5 ON catalog_sales.cs_item_sk \u003d t5.ITEM_SK\nINNER JOIN (SELECT customer0.c_customer_sk AS C_CUSTOMER_SK, SUM(store_sales0.ss_quantity * store_sales0.ss_sales_price) AS SSALES\nFROM store_sales AS store_sales0\nINNER JOIN customer AS customer0 ON store_sales0.ss_customer_sk \u003d customer0.c_customer_sk\nCROSS JOIN (SELECT MAX(t9.CSALES) AS TPCDS_CMAX\nFROM (SELECT SUM(store_sales1.ss_quantity * store_sales1.ss_sales_price) AS CSALES\nFROM store_sales AS store_sales1\nINNER JOIN customer AS customer1 ON store_sales1.ss_customer_sk \u003d customer1.c_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 OR d_year \u003d CAST(2000 + 1 AS BIGINT) OR d_year \u003d CAST(2000 + 2 AS BIGINT) OR d_year \u003d CAST(2000 + 3 AS BIGINT)) AS t6 ON store_sales1.ss_sold_date_sk \u003d t6.d_date_sk\nGROUP BY customer1.c_customer_sk) AS t9) AS t10\nGROUP BY customer0.c_customer_sk\nHAVING SUM(store_sales0.ss_quantity * store_sales0.ss_sales_price) \u003e 50 / 100.0 * MAX(t10.TPCDS_CMAX)) AS t14 ON catalog_sales.cs_bill_customer_sk \u003d t14.C_CUSTOMER_SK\nGROUP BY customer.c_last_name, customer.c_first_name\nUNION ALL\nSELECT customer2.c_last_name AS C_LAST_NAME, customer2.c_first_name AS C_FIRST_NAME, SUM(web_sales.ws_quantity * web_sales.ws_list_price) AS SALES\nFROM web_sales\nINNER JOIN customer AS customer2 ON web_sales.ws_bill_customer_sk \u003d customer2.c_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 AND d_moy \u003d 2) AS t18 ON web_sales.ws_sold_date_sk \u003d t18.d_date_sk\nINNER JOIN (SELECT t20.ITEMDESC, t20.i_item_sk AS ITEM_SK, t19.d_date AS SOLDDATE, COUNT(*) AS CNT\nFROM store_sales AS store_sales2\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 OR d_year \u003d CAST(2000 + 1 AS BIGINT) OR d_year \u003d CAST(2000 + 2 AS BIGINT) OR d_year \u003d CAST(2000 + 3 AS BIGINT)) AS t19 ON store_sales2.ss_sold_date_sk \u003d t19.d_date_sk\nINNER JOIN (SELECT SUBSTRING(i_item_desc, 1, 30) AS ITEMDESC, i_item_sk, i_item_id, i_rec_start_date, i_rec_end_date, i_item_desc, i_current_price, i_wholesale_cost, i_brand_id, i_brand, i_class_id, i_class, i_category_id, i_category, i_manufact_id, i_manufact, i_size, i_formulation, i_color, i_units, i_container, i_manager_id, i_product_name\nFROM item) AS t20 ON store_sales2.ss_item_sk \u003d t20.i_item_sk\nGROUP BY t20.ITEMDESC, t20.i_item_sk, t19.d_date\nHAVING COUNT(*) \u003e 4) AS t24 ON web_sales.ws_item_sk \u003d t24.ITEM_SK\nINNER JOIN (SELECT customer3.c_customer_sk AS C_CUSTOMER_SK, SUM(store_sales3.ss_quantity * store_sales3.ss_sales_price) AS SSALES\nFROM store_sales AS store_sales3\nINNER JOIN customer AS customer3 ON store_sales3.ss_customer_sk \u003d customer3.c_customer_sk\nCROSS JOIN (SELECT MAX(t28.CSALES) AS TPCDS_CMAX\nFROM (SELECT SUM(store_sales4.ss_quantity * store_sales4.ss_sales_price) AS CSALES\nFROM store_sales AS store_sales4\nINNER JOIN customer AS customer4 ON store_sales4.ss_customer_sk \u003d customer4.c_customer_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2000 OR d_year \u003d CAST(2000 + 1 AS BIGINT) OR d_year \u003d CAST(2000 + 2 AS BIGINT) OR d_year \u003d CAST(2000 + 3 AS BIGINT)) AS t25 ON store_sales4.ss_sold_date_sk \u003d t25.d_date_sk\nGROUP BY customer4.c_customer_sk) AS t28) AS t29\nGROUP BY customer3.c_customer_sk\nHAVING SUM(store_sales3.ss_quantity * store_sales3.ss_sales_price) \u003e 50 / 100.0 * MAX(t29.TPCDS_CMAX)) AS t33 ON web_sales.ws_bill_customer_sk \u003d t33.C_CUSTOMER_SK\nGROUP BY customer2.c_last_name, customer2.c_first_name)\nORDER BY C_LAST_NAME NULLS FIRST, C_FIRST_NAME NULLS FIRST, SALES NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    375,
    382
  ],
  "optimizedTimesMs": [
    716,
    742
  ],
  "originalAvgMs": 378,
  "optimizedAvgMs": 729,
  "speedup": 0.5185185185185185,
  "originalRowCount": 0,
  "optimizedRowCount": 0,
  "validationPassed": true,
  "originalPlanMaxRows": 3099951,
  "optimizedPlanMaxRows": 2878107
}