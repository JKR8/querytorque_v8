{
  "query": "q75",
  "status": "pending",
  "rules": [
    "FILTER_INTO_JOIN",
    "FILTER_PROJECT_TRANSPOSE",
    "FILTER_SCAN",
    "PROJECT_MERGE",
    "FILTER_AGGREGATE_TRANSPOSE",
    "AGGREGATE_PROJECT_MERGE",
    "SORT_PROJECT_TRANSPOSE"
  ],
  "optimizedSql": "SELECT t18.D_YEAR AS PREV_YEAR, t8.D_YEAR AS YEAR_, t8.I_BRAND_ID, t8.I_CLASS_ID, t8.I_CATEGORY_ID, t8.I_MANUFACT_ID, t18.SALES_CNT AS PREV_YR_CNT, t8.SALES_CNT AS CURR_YR_CNT, t8.SALES_CNT - t18.SALES_CNT AS SALES_CNT_DIFF, t8.SALES_AMT - t18.SALES_AMT AS SALES_AMT_DIFF\nFROM (SELECT D_YEAR, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, I_MANUFACT_ID, SUM(SALES_CNT) AS SALES_CNT, SUM(SALES_AMT) AS SALES_AMT\nFROM (SELECT *\nFROM (SELECT date_dim.d_year AS D_YEAR, t.i_brand_id AS I_BRAND_ID, t.i_class_id AS I_CLASS_ID, t.i_category_id AS I_CATEGORY_ID, t.i_manufact_id AS I_MANUFACT_ID, catalog_sales.cs_quantity - CASE WHEN catalog_returns.cr_return_quantity IS NOT NULL THEN CAST(catalog_returns.cr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, catalog_sales.cs_ext_sales_price - CASE WHEN catalog_returns.cr_return_amount IS NOT NULL THEN CAST(catalog_returns.cr_return_amount AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM catalog_sales\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t ON catalog_sales.cs_item_sk \u003d t.i_item_sk\nINNER JOIN date_dim ON catalog_sales.cs_sold_date_sk \u003d date_dim.d_date_sk\nLEFT JOIN catalog_returns ON catalog_sales.cs_order_number \u003d catalog_returns.cr_order_number AND catalog_sales.cs_item_sk \u003d catalog_returns.cr_item_sk\nUNION\nSELECT date_dim0.d_year AS D_YEAR, t1.i_brand_id AS I_BRAND_ID, t1.i_class_id AS I_CLASS_ID, t1.i_category_id AS I_CATEGORY_ID, t1.i_manufact_id AS I_MANUFACT_ID, store_sales.ss_quantity - CASE WHEN store_returns.sr_return_quantity IS NOT NULL THEN CAST(store_returns.sr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, store_sales.ss_ext_sales_price - CASE WHEN store_returns.sr_return_amt IS NOT NULL THEN CAST(store_returns.sr_return_amt AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM store_sales\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t1 ON store_sales.ss_item_sk \u003d t1.i_item_sk\nINNER JOIN date_dim AS date_dim0 ON store_sales.ss_sold_date_sk \u003d date_dim0.d_date_sk\nLEFT JOIN store_returns ON store_sales.ss_ticket_number \u003d store_returns.sr_ticket_number AND store_sales.ss_item_sk \u003d store_returns.sr_item_sk)\nUNION\nSELECT date_dim1.d_year AS D_YEAR, t4.i_brand_id AS I_BRAND_ID, t4.i_class_id AS I_CLASS_ID, t4.i_category_id AS I_CATEGORY_ID, t4.i_manufact_id AS I_MANUFACT_ID, web_sales.ws_quantity - CASE WHEN web_returns.wr_return_quantity IS NOT NULL THEN CAST(web_returns.wr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, web_sales.ws_ext_sales_price - CASE WHEN web_returns.wr_return_amt IS NOT NULL THEN CAST(web_returns.wr_return_amt AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM web_sales\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t4 ON web_sales.ws_item_sk \u003d t4.i_item_sk\nINNER JOIN date_dim AS date_dim1 ON web_sales.ws_sold_date_sk \u003d date_dim1.d_date_sk\nLEFT JOIN web_returns ON web_sales.ws_order_number \u003d web_returns.wr_order_number AND web_sales.ws_item_sk \u003d web_returns.wr_item_sk) AS t6\nWHERE D_YEAR \u003d 2002\nGROUP BY D_YEAR, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, I_MANUFACT_ID) AS t8\nINNER JOIN (SELECT D_YEAR, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, I_MANUFACT_ID, SUM(SALES_CNT) AS SALES_CNT, SUM(SALES_AMT) AS SALES_AMT\nFROM (SELECT *\nFROM (SELECT date_dim2.d_year AS D_YEAR, t9.i_brand_id AS I_BRAND_ID, t9.i_class_id AS I_CLASS_ID, t9.i_category_id AS I_CATEGORY_ID, t9.i_manufact_id AS I_MANUFACT_ID, catalog_sales0.cs_quantity - CASE WHEN catalog_returns0.cr_return_quantity IS NOT NULL THEN CAST(catalog_returns0.cr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, catalog_sales0.cs_ext_sales_price - CASE WHEN catalog_returns0.cr_return_amount IS NOT NULL THEN CAST(catalog_returns0.cr_return_amount AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM catalog_sales AS catalog_sales0\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t9 ON catalog_sales0.cs_item_sk \u003d t9.i_item_sk\nINNER JOIN date_dim AS date_dim2 ON catalog_sales0.cs_sold_date_sk \u003d date_dim2.d_date_sk\nLEFT JOIN catalog_returns AS catalog_returns0 ON catalog_sales0.cs_order_number \u003d catalog_returns0.cr_order_number AND catalog_sales0.cs_item_sk \u003d catalog_returns0.cr_item_sk\nUNION\nSELECT date_dim3.d_year AS D_YEAR, t11.i_brand_id AS I_BRAND_ID, t11.i_class_id AS I_CLASS_ID, t11.i_category_id AS I_CATEGORY_ID, t11.i_manufact_id AS I_MANUFACT_ID, store_sales0.ss_quantity - CASE WHEN store_returns0.sr_return_quantity IS NOT NULL THEN CAST(store_returns0.sr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, store_sales0.ss_ext_sales_price - CASE WHEN store_returns0.sr_return_amt IS NOT NULL THEN CAST(store_returns0.sr_return_amt AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM store_sales AS store_sales0\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t11 ON store_sales0.ss_item_sk \u003d t11.i_item_sk\nINNER JOIN date_dim AS date_dim3 ON store_sales0.ss_sold_date_sk \u003d date_dim3.d_date_sk\nLEFT JOIN store_returns AS store_returns0 ON store_sales0.ss_ticket_number \u003d store_returns0.sr_ticket_number AND store_sales0.ss_item_sk \u003d store_returns0.sr_item_sk)\nUNION\nSELECT date_dim4.d_year AS D_YEAR, t14.i_brand_id AS I_BRAND_ID, t14.i_class_id AS I_CLASS_ID, t14.i_category_id AS I_CATEGORY_ID, t14.i_manufact_id AS I_MANUFACT_ID, web_sales0.ws_quantity - CASE WHEN web_returns0.wr_return_quantity IS NOT NULL THEN CAST(web_returns0.wr_return_quantity AS BIGINT) ELSE 0 END AS SALES_CNT, web_sales0.ws_ext_sales_price - CASE WHEN web_returns0.wr_return_amt IS NOT NULL THEN CAST(web_returns0.wr_return_amt AS DECIMAL(19, 0)) ELSE 0.0 END AS SALES_AMT\nFROM web_sales AS web_sales0\nINNER JOIN (SELECT *\nFROM item\nWHERE i_category \u003d \u0027Books\u0027) AS t14 ON web_sales0.ws_item_sk \u003d t14.i_item_sk\nINNER JOIN date_dim AS date_dim4 ON web_sales0.ws_sold_date_sk \u003d date_dim4.d_date_sk\nLEFT JOIN web_returns AS web_returns0 ON web_sales0.ws_order_number \u003d web_returns0.wr_order_number AND web_sales0.ws_item_sk \u003d web_returns0.wr_item_sk) AS t16\nWHERE D_YEAR \u003d CAST(2002 - 1 AS BIGINT)\nGROUP BY D_YEAR, I_BRAND_ID, I_CLASS_ID, I_CATEGORY_ID, I_MANUFACT_ID) AS t18 ON t8.I_BRAND_ID \u003d t18.I_BRAND_ID AND t8.I_CLASS_ID \u003d t18.I_CLASS_ID AND t8.I_CATEGORY_ID \u003d t18.I_CATEGORY_ID AND t8.I_MANUFACT_ID \u003d t18.I_MANUFACT_ID AND CAST(t8.SALES_CNT AS DECIMAL(17, 2)) / CAST(t18.SALES_CNT AS DECIMAL(17, 2)) \u003c 0.9\nORDER BY 9, 10\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    53,
    52
  ],
  "optimizedTimesMs": [
    76,
    75
  ],
  "originalAvgMs": 52,
  "optimizedAvgMs": 75,
  "speedup": 0.6933333333333334,
  "originalRowCount": 100,
  "optimizedRowCount": 100,
  "validationPassed": false,
  "originalPlanMaxRows": 2878107,
  "optimizedPlanMaxRows": 2878107
}