{
  "query": "q59",
  "status": "pending",
  "rules": [
    "FILTER_SCAN",
    "FILTER_INTO_JOIN",
    "AGGREGATE_CASE_TO_FILTER",
    "PROJECT_MERGE",
    "PROJECT_REMOVE",
    "SORT_PROJECT_TRANSPOSE"
  ],
  "optimizedSql": "SELECT t2.S_STORE_NAME1, t2.S_STORE_ID1, t2.D_WEEK_SEQ1, t2.SUN_SALES1 / t6.SUN_SALES2 AS SUN_SALES_RATIO, t2.MON_SALES1 / t6.MON_SALES2 AS MON_SALES_RATIO, t2.TUE_SALES1 / t6.TUE_SALES2 AS TUE_SALES_RATIO, t2.WED_SALES1 / t6.WED_SALES2 AS WED_SALES_RATIO, t2.THU_SALES1 / t6.THU_SALES2 AS THU_SALES_RATIO, t2.FRI_SALES1 / t6.FRI_SALES2 AS FRI_SALES_RATIO, t2.SAT_SALES1 / t6.SAT_SALES2 AS SAT_SALES_RATIO\nFROM (SELECT store.s_store_name AS S_STORE_NAME1, t0.d_week_seq AS D_WEEK_SEQ1, store.s_store_id AS S_STORE_ID1, t0.SUN_SALES AS SUN_SALES1, t0.MON_SALES AS MON_SALES1, t0.TUE_SALES AS TUE_SALES1, t0.WED_SALES AS WED_SALES1, t0.THU_SALES AS THU_SALES1, t0.FRI_SALES AS FRI_SALES1, t0.SAT_SALES AS SAT_SALES1\nFROM (SELECT date_dim.d_week_seq, store_sales.ss_store_sk, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Sunday\u0027 IS TRUE) AS SUN_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Monday\u0027 IS TRUE) AS MON_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Tuesday\u0027 IS TRUE) AS TUE_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Wednesday\u0027 IS TRUE) AS WED_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Thursday\u0027 IS TRUE) AS THU_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Friday\u0027 IS TRUE) AS FRI_SALES, SUM(store_sales.ss_sales_price) FILTER (WHERE date_dim.d_day_name \u003d \u0027Saturday\u0027 IS TRUE) AS SAT_SALES\nFROM store_sales\nINNER JOIN date_dim ON store_sales.ss_sold_date_sk \u003d date_dim.d_date_sk\nGROUP BY date_dim.d_week_seq, store_sales.ss_store_sk) AS t0\nINNER JOIN store ON t0.ss_store_sk \u003d store.s_store_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1212 AND d_month_seq \u003c\u003d 1212 + 11) AS t1 ON t0.d_week_seq \u003d t1.d_week_seq) AS t2\nINNER JOIN (SELECT store0.s_store_name AS S_STORE_NAME2, t4.d_week_seq AS D_WEEK_SEQ2, store0.s_store_id AS S_STORE_ID2, t4.SUN_SALES AS SUN_SALES2, t4.MON_SALES AS MON_SALES2, t4.TUE_SALES AS TUE_SALES2, t4.WED_SALES AS WED_SALES2, t4.THU_SALES AS THU_SALES2, t4.FRI_SALES AS FRI_SALES2, t4.SAT_SALES AS SAT_SALES2\nFROM (SELECT date_dim1.d_week_seq, store_sales0.ss_store_sk, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Sunday\u0027 IS TRUE) AS SUN_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Monday\u0027 IS TRUE) AS MON_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Tuesday\u0027 IS TRUE) AS TUE_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Wednesday\u0027 IS TRUE) AS WED_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Thursday\u0027 IS TRUE) AS THU_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Friday\u0027 IS TRUE) AS FRI_SALES, SUM(store_sales0.ss_sales_price) FILTER (WHERE date_dim1.d_day_name \u003d \u0027Saturday\u0027 IS TRUE) AS SAT_SALES\nFROM store_sales AS store_sales0\nINNER JOIN date_dim AS date_dim1 ON store_sales0.ss_sold_date_sk \u003d date_dim1.d_date_sk\nGROUP BY date_dim1.d_week_seq, store_sales0.ss_store_sk) AS t4\nINNER JOIN store AS store0 ON t4.ss_store_sk \u003d store0.s_store_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_month_seq \u003e\u003d 1212 + 12 AND d_month_seq \u003c\u003d 1212 + 23) AS t5 ON t4.d_week_seq \u003d t5.d_week_seq) AS t6 ON t2.S_STORE_ID1 \u003d t6.S_STORE_ID2 AND t2.D_WEEK_SEQ1 \u003d t6.D_WEEK_SEQ2 - 52\nORDER BY t2.S_STORE_NAME1 NULLS FIRST, t2.S_STORE_ID1 NULLS FIRST, t2.D_WEEK_SEQ1 NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    260,
    251
  ],
  "optimizedTimesMs": [
    323,
    317
  ],
  "originalAvgMs": 255,
  "optimizedAvgMs": 320,
  "speedup": 0.796875,
  "originalRowCount": 100,
  "optimizedRowCount": 100,
  "validationPassed": true,
  "originalPlanMaxRows": 2878107,
  "optimizedPlanMaxRows": 2878107
}