{
  "query": "q66",
  "status": "pending",
  "rules": [
    "FILTER_SCAN",
    "FILTER_INTO_JOIN",
    "AGGREGATE_CASE_TO_FILTER",
    "PROJECT_MERGE",
    "AGGREGATE_MERGE",
    "UNION_MERGE",
    "SORT_PROJECT_TRANSPOSE"
  ],
  "optimizedSql": "SELECT W_WAREHOUSE_NAME, W_WAREHOUSE_SQ_FT, W_CITY, W_COUNTY, W_STATE, W_COUNTRY, SHIP_CARRIERS, YEAR_, SUM(JAN_SALES) AS JAN_SALES, SUM(FEB_SALES) AS FEB_SALES, SUM(MAR_SALES) AS MAR_SALES, SUM(APR_SALES) AS APR_SALES, SUM(MAY_SALES) AS MAY_SALES, SUM(JUN_SALES) AS JUN_SALES, SUM(JUL_SALES) AS JUL_SALES, SUM(AUG_SALES) AS AUG_SALES, SUM(SEP_SALES) AS SEP_SALES, SUM(OCT_SALES) AS OCT_SALES, SUM(NOV_SALES) AS NOV_SALES, SUM(DEC_SALES) AS DEC_SALES, SUM(JAN_SALES / W_WAREHOUSE_SQ_FT) AS JAN_SALES_PER_SQ_FOOT, SUM(FEB_SALES / W_WAREHOUSE_SQ_FT) AS FEB_SALES_PER_SQ_FOOT, SUM(MAR_SALES / W_WAREHOUSE_SQ_FT) AS MAR_SALES_PER_SQ_FOOT, SUM(APR_SALES / W_WAREHOUSE_SQ_FT) AS APR_SALES_PER_SQ_FOOT, SUM(MAY_SALES / W_WAREHOUSE_SQ_FT) AS MAY_SALES_PER_SQ_FOOT, SUM(JUN_SALES / W_WAREHOUSE_SQ_FT) AS JUN_SALES_PER_SQ_FOOT, SUM(JUL_SALES / W_WAREHOUSE_SQ_FT) AS JUL_SALES_PER_SQ_FOOT, SUM(AUG_SALES / W_WAREHOUSE_SQ_FT) AS AUG_SALES_PER_SQ_FOOT, SUM(SEP_SALES / W_WAREHOUSE_SQ_FT) AS SEP_SALES_PER_SQ_FOOT, SUM(OCT_SALES / W_WAREHOUSE_SQ_FT) AS OCT_SALES_PER_SQ_FOOT, SUM(NOV_SALES / W_WAREHOUSE_SQ_FT) AS NOV_SALES_PER_SQ_FOOT, SUM(DEC_SALES / W_WAREHOUSE_SQ_FT) AS DEC_SALES_PER_SQ_FOOT, SUM(JAN_NET) AS JAN_NET, SUM(FEB_NET) AS FEB_NET, SUM(MAR_NET) AS MAR_NET, SUM(APR_NET) AS APR_NET, SUM(MAY_NET) AS MAY_NET, SUM(JUN_NET) AS JUN_NET, SUM(JUL_NET) AS JUL_NET, SUM(AUG_NET) AS AUG_NET, SUM(SEP_NET) AS SEP_NET, SUM(OCT_NET) AS OCT_NET, SUM(NOV_NET) AS NOV_NET, SUM(DEC_NET) AS DEC_NET\nFROM (SELECT warehouse.w_warehouse_name AS W_WAREHOUSE_NAME, warehouse.w_warehouse_sq_ft AS W_WAREHOUSE_SQ_FT, warehouse.w_city AS W_CITY, warehouse.w_county AS W_COUNTY, warehouse.w_state AS W_STATE, warehouse.w_country AS W_COUNTRY, \u0027DHL,BARIAN\u0027 AS SHIP_CARRIERS, t.d_year AS YEAR_, SUM(CASE WHEN t.d_moy \u003d 1 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS JAN_SALES, SUM(CASE WHEN t.d_moy \u003d 2 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS FEB_SALES, SUM(CASE WHEN t.d_moy \u003d 3 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS MAR_SALES, SUM(CASE WHEN t.d_moy \u003d 4 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS APR_SALES, SUM(CASE WHEN t.d_moy \u003d 5 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS MAY_SALES, SUM(CASE WHEN t.d_moy \u003d 6 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS JUN_SALES, SUM(CASE WHEN t.d_moy \u003d 7 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS JUL_SALES, SUM(CASE WHEN t.d_moy \u003d 8 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS AUG_SALES, SUM(CASE WHEN t.d_moy \u003d 9 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS SEP_SALES, SUM(CASE WHEN t.d_moy \u003d 10 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS OCT_SALES, SUM(CASE WHEN t.d_moy \u003d 11 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS NOV_SALES, SUM(CASE WHEN t.d_moy \u003d 12 THEN web_sales.ws_ext_sales_price * web_sales.ws_quantity ELSE 0 END) AS DEC_SALES, SUM(CASE WHEN t.d_moy \u003d 1 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS JAN_NET, SUM(CASE WHEN t.d_moy \u003d 2 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS FEB_NET, SUM(CASE WHEN t.d_moy \u003d 3 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS MAR_NET, SUM(CASE WHEN t.d_moy \u003d 4 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS APR_NET, SUM(CASE WHEN t.d_moy \u003d 5 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS MAY_NET, SUM(CASE WHEN t.d_moy \u003d 6 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS JUN_NET, SUM(CASE WHEN t.d_moy \u003d 7 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS JUL_NET, SUM(CASE WHEN t.d_moy \u003d 8 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS AUG_NET, SUM(CASE WHEN t.d_moy \u003d 9 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS SEP_NET, SUM(CASE WHEN t.d_moy \u003d 10 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS OCT_NET, SUM(CASE WHEN t.d_moy \u003d 11 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS NOV_NET, SUM(CASE WHEN t.d_moy \u003d 12 THEN web_sales.ws_net_paid * web_sales.ws_quantity ELSE 0 END) AS DEC_NET\nFROM web_sales\nINNER JOIN warehouse ON web_sales.ws_warehouse_sk \u003d warehouse.w_warehouse_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t ON web_sales.ws_sold_date_sk \u003d t.d_date_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_time \u003e\u003d 30838 AND t_time \u003c\u003d 30838 + 28800) AS t0 ON web_sales.ws_sold_time_sk \u003d t0.t_time_sk\nINNER JOIN (SELECT *\nFROM ship_mode\nWHERE sm_carrier IN (\u0027BARIAN\u0027, \u0027DHL\u0027)) AS t1 ON web_sales.ws_ship_mode_sk \u003d t1.sm_ship_mode_sk\nGROUP BY warehouse.w_warehouse_name, warehouse.w_warehouse_sq_ft, warehouse.w_city, warehouse.w_county, warehouse.w_state, warehouse.w_country, t.d_year\nUNION ALL\nSELECT warehouse0.w_warehouse_name AS W_WAREHOUSE_NAME, warehouse0.w_warehouse_sq_ft AS W_WAREHOUSE_SQ_FT, warehouse0.w_city AS W_CITY, warehouse0.w_county AS W_COUNTY, warehouse0.w_state AS W_STATE, warehouse0.w_country AS W_COUNTRY, \u0027DHL,BARIAN\u0027 AS SHIP_CARRIERS, t5.d_year AS YEAR_, SUM(CASE WHEN t5.d_moy \u003d 1 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS JAN_SALES, SUM(CASE WHEN t5.d_moy \u003d 2 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS FEB_SALES, SUM(CASE WHEN t5.d_moy \u003d 3 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS MAR_SALES, SUM(CASE WHEN t5.d_moy \u003d 4 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS APR_SALES, SUM(CASE WHEN t5.d_moy \u003d 5 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS MAY_SALES, SUM(CASE WHEN t5.d_moy \u003d 6 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS JUN_SALES, SUM(CASE WHEN t5.d_moy \u003d 7 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS JUL_SALES, SUM(CASE WHEN t5.d_moy \u003d 8 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS AUG_SALES, SUM(CASE WHEN t5.d_moy \u003d 9 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS SEP_SALES, SUM(CASE WHEN t5.d_moy \u003d 10 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS OCT_SALES, SUM(CASE WHEN t5.d_moy \u003d 11 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS NOV_SALES, SUM(CASE WHEN t5.d_moy \u003d 12 THEN catalog_sales.cs_sales_price * catalog_sales.cs_quantity ELSE 0 END) AS DEC_SALES, SUM(CASE WHEN t5.d_moy \u003d 1 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS JAN_NET, SUM(CASE WHEN t5.d_moy \u003d 2 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS FEB_NET, SUM(CASE WHEN t5.d_moy \u003d 3 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS MAR_NET, SUM(CASE WHEN t5.d_moy \u003d 4 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS APR_NET, SUM(CASE WHEN t5.d_moy \u003d 5 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS MAY_NET, SUM(CASE WHEN t5.d_moy \u003d 6 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS JUN_NET, SUM(CASE WHEN t5.d_moy \u003d 7 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS JUL_NET, SUM(CASE WHEN t5.d_moy \u003d 8 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS AUG_NET, SUM(CASE WHEN t5.d_moy \u003d 9 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS SEP_NET, SUM(CASE WHEN t5.d_moy \u003d 10 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS OCT_NET, SUM(CASE WHEN t5.d_moy \u003d 11 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS NOV_NET, SUM(CASE WHEN t5.d_moy \u003d 12 THEN catalog_sales.cs_net_paid_inc_tax * catalog_sales.cs_quantity ELSE 0 END) AS DEC_NET\nFROM catalog_sales\nINNER JOIN warehouse AS warehouse0 ON catalog_sales.cs_warehouse_sk \u003d warehouse0.w_warehouse_sk\nINNER JOIN (SELECT *\nFROM date_dim\nWHERE d_year \u003d 2001) AS t5 ON catalog_sales.cs_sold_date_sk \u003d t5.d_date_sk\nINNER JOIN (SELECT *\nFROM time_dim\nWHERE t_time \u003e\u003d 30838 AND t_time \u003c\u003d 30838 + 28800) AS t6 ON catalog_sales.cs_sold_time_sk \u003d t6.t_time_sk\nINNER JOIN (SELECT *\nFROM ship_mode\nWHERE sm_carrier IN (\u0027BARIAN\u0027, \u0027DHL\u0027)) AS t7 ON catalog_sales.cs_ship_mode_sk \u003d t7.sm_ship_mode_sk\nGROUP BY warehouse0.w_warehouse_name, warehouse0.w_warehouse_sq_ft, warehouse0.w_city, warehouse0.w_county, warehouse0.w_state, warehouse0.w_country, t5.d_year) AS t11\nGROUP BY W_WAREHOUSE_NAME, W_WAREHOUSE_SQ_FT, W_CITY, W_COUNTY, W_STATE, W_COUNTRY, SHIP_CARRIERS, YEAR_\nORDER BY W_WAREHOUSE_NAME NULLS FIRST\nFETCH NEXT 100 ROWS ONLY",
  "originalTimesMs": [
    21,
    20
  ],
  "optimizedTimesMs": [
    20,
    20
  ],
  "originalAvgMs": 20,
  "optimizedAvgMs": 20,
  "speedup": 1.0,
  "originalRowCount": 15,
  "optimizedRowCount": 15,
  "validationPassed": true,
  "originalPlanMaxRows": 1439513,
  "optimizedPlanMaxRows": 1439513
}