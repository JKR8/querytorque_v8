table 'ESG Entity Score Snapshot'
	lineageTag: 0dd320d5-bc34-4650-b800-1737b2853e98

	column Entity_Id
		dataType: int64
		formatString: 0
		lineageTag: 84522b4a-e64d-4f5f-9cd8-90d0980d2bfa
		summarizeBy: count
		sourceColumn: Entity_Id

		annotation SummarizationSetBy = Automatic

	column Entity_Date_Key
		dataType: string
		lineageTag: d4307154-2559-47c3-80aa-9f71a1caf5e8
		summarizeBy: none
		sourceColumn: Entity_Date_Key

		annotation SummarizationSetBy = Automatic

	/// The worst controversy category for an Entity
	column Highest_Level_Category
		dataType: string
		lineageTag: 153248c7-be8c-4a09-8c95-ae4cd9878d6e
		summarizeBy: none
		sourceColumn: Highest_Level_Category

		annotation SummarizationSetBy = Automatic

	/// The worst outlook for an Entity
	column Highest_Level_OutLook
		dataType: string
		lineageTag: 5c1921c3-ca33-4cef-8bbd-504a568bb949
		summarizeBy: none
		sourceColumn: Highest_Level_OutLook

		annotation SummarizationSetBy = Automatic

	/// The controversies for which the worst controversy score of an Entity correspond to 
	column Highest_Level_Controversy_Name
		dataType: string
		lineageTag: 58428425-b6bc-496f-9b45-9865bc34550d
		summarizeBy: none
		sourceColumn: Highest_Level_Controversy_Name

		annotation SummarizationSetBy = Automatic

	/// The worst controversy score for an Entity 
	column Highest_Level_Category_Score
		dataType: string
		lineageTag: c2d4ae0b-e0d2-4451-83d9-3ec014d37d65
		summarizeBy: none
		sourceColumn: Highest_Level_Category_Score

		annotation SummarizationSetBy = Automatic

	column Snapshot_Date
		dataType: dateTime
		formatString: Long Date
		lineageTag: f89124eb-8c23-4da9-935c-548612528676
		summarizeBy: none
		sourceColumn: Snapshot_Date

		variation Variation
			isDefault
			relationship: 03a121fd-993b-4588-ac84-79b09e6ba5a8
			defaultHierarchy: LocalDateTable_e6a8c727-c5e3-4f64-a0a5-7e92cb2c319e.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	/// The overall Global Standard Screening of an Entity (Compliant; Watchlist; Non-Compliant)
	column Overall_Global_Compact_Compliace_Status
		dataType: string
		lineageTag: 5e862d04-3ce9-4b92-8006-aab91fbf1e96
		summarizeBy: none
		sourceColumn: Overall_Global_Compact_Compliace_Status

		annotation SummarizationSetBy = Automatic

	column 'Table Status - Num' = IF('ESG Entity Score Snapshot'[Overall_Global_Compact_Compliace_Status] = "Compliant",1,IF('ESG Entity Score Snapshot'[Overall_Global_Compact_Compliace_Status] = "Watchlist",0,IF('ESG Entity Score Snapshot'[Overall_Global_Compact_Compliace_Status] = "Non-Compliant",-1,9)))
		formatString: 0
		lineageTag: f2d4ebbc-b60e-459a-8b65-0e38b046b284
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	column 'Status GSS Table' = IF('ESG Entity Score Snapshot'[Overall_Global_Compact_Compliace_Status] ="Compliant","1. Compliant",IF('ESG Entity Score Snapshot'[Overall_Global_Compact_Compliace_Status] ="Non-Compliant","3. Non-Compliant",IF('ESG Entity Score Snapshot'[Overall_Global_Compact_Compliace_Status] ="Watchlist","2. Watchlist", 'ESG Entity Score Snapshot'[Overall_Global_Compact_Compliace_Status])))
		lineageTag: cb47ec80-5322-4f13-b0e7-6e2b330e2ea5
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	partition 'ESG Entity Score Snapshot-b968c3fe-5299-4205-80cb-bcddd4e15987' = m
		mode: import
		queryGroup: Sustainalytics
		source = ```
				let
				    Source = DatabricksMultiCloud.Catalogs(p_databricks_host, p_databricks_path, [Catalog=null, Database=null, EnableAutomaticProxyDiscovery=null]),
				    hive_metastore_Database = Source{[Name=p_databricks_catalog,Kind="Database"]}[Data],
				    sustainalytics_Schema = hive_metastore_Database{[Name=p_sustainalytics_database,Kind="Schema"]}[Data],
				    semantic_esg_sustainalytics_controversy_snapshot_v1_Table = sustainalytics_Schema{[Name="semantic_esg_sustainalytics_entity_score_snapshot_v1",Kind="Table"]}[Data]
				    ,  FilterLogic = 
				    if 
				         p_limit_rows = "Y" 
				    then
				     Table.FirstN(
				      semantic_esg_sustainalytics_controversy_snapshot_v1_Table, 
				      100
				     )
				 else 
				    semantic_esg_sustainalytics_controversy_snapshot_v1_Table 
				     in
				  FilterLogic
				```

	annotation PBI_ResultType = Table

	annotation PBI_NavigationStepName = Navigation

