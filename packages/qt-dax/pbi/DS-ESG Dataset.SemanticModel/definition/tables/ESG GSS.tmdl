table 'ESG GSS'
	lineageTag: d212b027-a478-4ff9-bf87-98d04af4106e

	measure 'Unique Records1' = ```
			calculate( distinctcount('ESG GSS'[Entity_Id]), 'ESG GSS'[Entity_Id] <> BLANK())
			
			
			```
		formatString: 0
		lineageTag: 2dd8c251-460f-4790-8687-c4d70c53295c

	measure 'Justification Text' = MIN('ESG GSS'[Justification GSS])
		lineageTag: d2b6dd86-9355-4515-9c07-dbad82863a33

	column Entity_Id
		dataType: int64
		formatString: 0
		lineageTag: b3c3b18b-8d8f-4eb9-8d76-2bb886120421
		summarizeBy: none
		sourceColumn: Entity_Id

		annotation SummarizationSetBy = Automatic

	/// Justification on Sustainalytics's outlook
	column Outlook_Comment
		dataType: string
		lineageTag: 122094b6-b196-49c7-9899-c363cb9e4cc8
		summarizeBy: none
		sourceColumn: Outlook_Comment

		annotation SummarizationSetBy = Automatic

	/// Is the Status the most current
	column Is_Current
		dataType: string
		lineageTag: 354e4668-1ef8-4c07-95df-ec5c679a7c54
		summarizeBy: none
		sourceColumn: Is_Current

		annotation SummarizationSetBy = Automatic

	column 'GSS Status' =
			
			SWITCH(
			    TRUE(),
			    'ESG GSS'[Overall_Global_Compact_Compliance_Status] = "Compliant", "Compliant",
			    'ESG GSS'[Overall_Global_Compact_Compliance_Status] = "Watchlist", "Watchlist from " & 'ESG GSS'[Global_Compact_Watchlist_Effective_Since],
			    'ESG GSS'[Overall_Global_Compact_Compliance_Status] = "Non-Compliant", "Non-Compliant from " & 'ESG GSS'[Global_Compact_Non_Compliant_Effective_Since],
			    BLANK()
			)
		displayFolder: Status
		lineageTag: 36b58f3c-b198-426d-b981-b378b29d13f1
		summarizeBy: none
		sortByColumn: 'Status - Num'

		changedProperty = SortByColumn

		annotation SummarizationSetBy = Automatic

	/// Date of which entity was non-complaint
	column Previously_Non_Compliant
		dataType: string
		displayFolder: Status
		lineageTag: 333b880f-bd47-4306-aab6-438f57d5a2c3
		summarizeBy: none
		sourceColumn: Previously_Non_Compliant

		annotation SummarizationSetBy = Automatic

	/// Overall entity's GSS status
	column Overall_Global_Compact_Compliance_Status
		dataType: string
		displayFolder: Status
		lineageTag: 7a0fbcfb-30fd-42e2-b723-99b55607eaaf
		summarizeBy: none
		sourceColumn: Overall_Global_Compact_Compliance_Status

		annotation SummarizationSetBy = Automatic

	column Watchlist_Status_Applicable
		dataType: string
		lineageTag: 9aef7139-33d1-417e-9ae3-0dad7307992e
		summarizeBy: none
		sourceColumn: Watchlist_Status_Applicable

		annotation SummarizationSetBy = Automatic

	/// Date when the entity's GSS status last changed
	column Overall_Company_Status_Latest_Change
		dataType: dateTime
		formatString: Long Date
		displayFolder: Status
		lineageTag: 5df41b4c-3046-4167-989c-93d13500605e
		summarizeBy: none
		sourceColumn: Overall_Company_Status_Latest_Change

		variation Variation
			isDefault
			relationship: 3e8c95cd-bfe3-49aa-81e2-0ff68a3cb089
			defaultHierarchy: LocalDateTable_0da65c8d-85c5-498a-90f6-aa6d2965241b.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	/// Previous GSS status
	column Previous_Overall_Global_Compact_Status
		dataType: string
		displayFolder: Status
		lineageTag: 0532dc47-02ee-4b1c-bd15-34aea9658dbf
		summarizeBy: none
		sourceColumn: Previous_Overall_Global_Compact_Status

		annotation SummarizationSetBy = Automatic

	/// The last time Sustainalytics contacted Company
	column Company_Last_Contacted
		dataType: dateTime
		formatString: Long Date
		lineageTag: 017fbe6d-de3b-4a10-9e6c-e6e99242d050
		summarizeBy: none
		sourceColumn: Company_Last_Contacted

		variation Variation
			isDefault
			relationship: 311e99df-648a-4680-8995-0712dbee8c40
			defaultHierarchy: LocalDateTable_33175e62-f254-4e9f-aba0-9a40ca40efcf.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	/// Most recent date in which the Entity responded to Sustainalytics
	column Most_Recent_Company_Response
		dataType: string
		lineageTag: 0e607aa8-ee3f-4758-8562-06560e751514
		summarizeBy: none
		sourceColumn: Most_Recent_Company_Response

		annotation SummarizationSetBy = Automatic

	/// Justification on Overall entity's GSS status
	column Overall_Conclusion
		dataType: string
		lineageTag: 1dfcc57a-bb43-4e2f-9199-5270bc2ef90e
		summarizeBy: none
		sourceColumn: Overall_Conclusion

		annotation SummarizationSetBy = Automatic

	/// Principle Description of which Entity is deemed to be non-compliant by Sustainalytics
	column Global_Compact_Non_Compliant_Principle_Description
		dataType: string
		lineageTag: 376cb48e-41e4-4741-aa41-004bc22d77a9
		summarizeBy: none
		sourceColumn: Global_Compact_Non_Compliant_Principle_Description

		annotation SummarizationSetBy = Automatic

	/// Principle Code of which Entity is deemed to be non-compliant by Sustainalytics
	column Global_Compact_Non_Compliant_Principle_Code
		dataType: string
		lineageTag: 0762d6e9-b023-4c78-bd89-ef3574a92215
		summarizeBy: none
		sourceColumn: Global_Compact_Non_Compliant_Principle_Code

		annotation SummarizationSetBy = Automatic

	/// Justification on entity's Non-Compliant status
	column Reason_for_Non_Compliant_Status
		dataType: string
		displayFolder: Status
		lineageTag: e2324f17-65da-4d60-baf5-192d14ada6ee
		summarizeBy: none
		sourceColumn: Reason_for_Non_Compliant_Status

		annotation SummarizationSetBy = Automatic

	/// Principle Description of which Entity is deemed to be on the watchlist by Sustainalytics
	column Global_Compact_Watchlist_Principle_Description
		dataType: string
		lineageTag: 88222de8-dc66-44bd-ab60-24e82d6d4f42
		summarizeBy: none
		sourceColumn: Global_Compact_Watchlist_Principle_Description

		annotation SummarizationSetBy = Automatic

	/// Principle Code of which Entity is deemed to be on the watchlist by Sustainalytics
	column Global_Compact_Watchlist_Principle_Code
		dataType: string
		lineageTag: 541e28bb-cc72-4a1f-8e3c-3010ef97d168
		summarizeBy: none
		sourceColumn: Global_Compact_Watchlist_Principle_Code

		annotation SummarizationSetBy = Automatic

	/// Applicable OECD for Global Standards
	column Applicable_OECD_Guidelines_for_Multinational_Enterprises
		dataType: string
		lineageTag: ba05d471-eac1-4f95-a3b6-d805f2b50420
		summarizeBy: none
		sourceColumn: Applicable_OECD_Guidelines_for_Multinational_Enterprises

		annotation SummarizationSetBy = Automatic

	/// Applicable UN Guiding Principle for Global Standards
	column Applicable_UN_Guiding_Principles_on_Business_and_Human_Rights
		dataType: string
		lineageTag: 0c66a188-665a-4c2c-b065-6c4c7cedaec1
		summarizeBy: none
		sourceColumn: Applicable_UN_Guiding_Principles_on_Business_and_Human_Rights

		annotation SummarizationSetBy = Automatic

	/// Applicable Convention for Global Standards
	column Applicable_Other_Related_Conventions
		dataType: string
		lineageTag: 6e7d452f-4a30-4f7b-90be-5fc57f528b66
		summarizeBy: none
		sourceColumn: Applicable_Other_Related_Conventions

		annotation SummarizationSetBy = Automatic

	/// Justification on entity's Watchlist status
	column Reason_for_Watchlist_Status
		dataType: string
		displayFolder: Status
		lineageTag: b44cedeb-5c34-4fcc-b784-4bfa3af9fc5e
		summarizeBy: none
		sourceColumn: Reason_for_Watchlist_Status

		annotation SummarizationSetBy = Automatic

	/// Sustainalytics's outlook on the GSS Score of the entity 
	column Outlook
		dataType: string
		lineageTag: 3bfc2374-5702-4879-bbb4-05f2c6a48401
		summarizeBy: none
		sourceColumn: Outlook

		annotation SummarizationSetBy = Automatic

	/// Engagement Status of Company by Sustainalytics
	column Engagement_Status
		dataType: string
		displayFolder: Status
		lineageTag: 42b7f856-e609-4d23-aa85-96be626dc1fd
		summarizeBy: none
		sourceColumn: Engagement_Status

		annotation SummarizationSetBy = Automatic

	/// Date when Entity is deemed to be non-compliant by Sustainalytics
	column Global_Compact_Non_Compliant_Effective_Since
		dataType: string
		lineageTag: 64a8dbcf-78c4-4b6e-aa6d-2abcad65bb4c
		summarizeBy: none
		sourceColumn: Global_Compact_Non_Compliant_Effective_Since

		annotation SummarizationSetBy = Automatic

	/// Date when Entity is deemed to be on the watchlist by Sustainalytics
	column Global_Compact_Watchlist_Effective_Since
		dataType: string
		lineageTag: 6c676803-df63-47ee-9b6b-72f2f1229bcf
		summarizeBy: none
		sourceColumn: Global_Compact_Watchlist_Effective_Since

		annotation SummarizationSetBy = Automatic

	column 'Justification GSS' = IF('ESG GSS'[Overall_Global_Compact_Compliance_Status] = "Non-Compliant",'ESG GSS'[Reason_for_Non_Compliant_Status],IF('ESG GSS'[Overall_Global_Compact_Compliance_Status]="Watchlist",'ESG GSS'[Reason_for_Watchlist_Status],""))
		dataType: string
		lineageTag: 2457612d-fa96-4eb0-9cc7-77078838928b
		summarizeBy: none

		changedProperty = DataType

		annotation SummarizationSetBy = Automatic

	column 'Status - Num' = IF('ESG GSS'[Overall_Global_Compact_Compliance_Status] = "Compliant",1,IF('ESG GSS'[Overall_Global_Compact_Compliance_Status] = "Watchlist",0,IF('ESG GSS'[Overall_Global_Compact_Compliance_Status] = "Non-Compliant",-1,-9)))
		formatString: 0
		displayFolder: Status
		lineageTag: a5ef9036-aaed-4852-9260-c5aadf406916
		summarizeBy: sum

		annotation SummarizationSetBy = Automatic

	partition 'ESG GSS-f7063d05-43e2-4588-97f2-01e4c346ed00' = m
		mode: import
		queryGroup: Sustainalytics
		source = ```
				let
				    Source = DatabricksMultiCloud.Catalogs(p_databricks_host, p_databricks_path, [Catalog=null, Database=null, EnableAutomaticProxyDiscovery=null]),
				    hive_metastore_Database = Source{[Name=p_databricks_catalog,Kind="Database"]}[Data],
				    sustainalytics_Schema = hive_metastore_Database{[Name=p_sustainalytics_database,Kind="Schema"]}[Data],
				    semantic_esg_sustainalytics_gss_v1_Table = sustainalytics_Schema{[Name="semantic_esg_sustainalytics_gss_v1",Kind="Table"]}[Data]
				    ,  FilterLogic = 
				    if 
				         p_limit_rows = "Y" 
				    then
				     Table.FirstN(
				      semantic_esg_sustainalytics_gss_v1_Table, 
				      100
				     )
				 else 
				    semantic_esg_sustainalytics_gss_v1_Table 
				     in
				  FilterLogic
				```

	annotation PBI_ResultType = Table

	annotation PBI_NavigationStepName = Navigation

