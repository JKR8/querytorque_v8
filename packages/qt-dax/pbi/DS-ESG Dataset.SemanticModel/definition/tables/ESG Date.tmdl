table 'ESG Date'
	lineageTag: 2543b766-9554-4f63-aea3-546aeeeced5a

	column Date_Value
		dataType: dateTime
		formatString: d/m/yyyy
		lineageTag: 3d68081f-0f23-4d2a-8f73-c969af3e56fd
		summarizeBy: none
		sourceColumn: Date_Value

		variation Variation
			isDefault
			relationship: 0cbb2466-41b6-448b-bd04-46e9fb6b68ba
			defaultHierarchy: LocalDateTable_565f6070-b0dc-414d-b3bd-4feaf0c4e634.'Date Hierarchy'

		changedProperty = FormatString

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

		annotation PBI_FormatHint = {"isDateTimeCustom":true}

	column GS_Date_Value
		dataType: dateTime
		formatString: Long Date
		lineageTag: f67a38c5-8bcd-429b-bf7a-94b88b3e53d0
		summarizeBy: none
		sourceColumn: GS_Date_Value

		variation Variation
			isDefault
			relationship: 9fb543dc-d490-40a7-953c-6c40289d2910
			defaultHierarchy: LocalDateTable_7a0be10a-b724-46f9-89ab-f114a0bd19f0.'Date Hierarchy'

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column Calendar_Quarter
		dataType: string
		lineageTag: 782a5fba-7d0e-40b1-a4bb-4c4b8fb37a51
		summarizeBy: none
		sourceColumn: Calendar_Quarter

		annotation SummarizationSetBy = Automatic

	column Calendar_Quarter_Long
		dataType: string
		lineageTag: 1fefa268-804e-4a94-b90d-229beaa81955
		summarizeBy: none
		sourceColumn: Calendar_Quarter_Long

		annotation SummarizationSetBy = Automatic

	column Calendar_Quarter_Number
		dataType: double
		lineageTag: 66f87407-024d-4b07-a7ce-394debc567e6
		summarizeBy: sum
		sourceColumn: Calendar_Quarter_Number

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column Calendar_Year
		dataType: double
		lineageTag: 857def82-566f-455d-9cf7-3fa2ecd00e58
		summarizeBy: sum
		sourceColumn: Calendar_Year

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column Day_Of_Month
		dataType: double
		lineageTag: 47eb61f0-8c91-4390-a903-265456dae322
		summarizeBy: sum
		sourceColumn: Day_Of_Month

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column Day_Of_Week
		dataType: double
		lineageTag: 2b1b665a-dd3c-4445-b6f3-f6858b91ca63
		summarizeBy: sum
		sourceColumn: Day_Of_Week

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column Fiscal_Quarter
		dataType: string
		lineageTag: 0d9e9243-0ade-4f59-8a37-6cecc380eb36
		summarizeBy: none
		sourceColumn: Fiscal_Quarter

		annotation SummarizationSetBy = Automatic

	column Fiscal_Year
		dataType: string
		lineageTag: 395b081e-acb8-442e-937c-6551a7353a47
		summarizeBy: none
		sourceColumn: Fiscal_Year

		annotation SummarizationSetBy = Automatic

	column Is_End_Of_Month
		dataType: string
		lineageTag: 1b6cb813-56cd-451c-a34d-90e63f72d626
		summarizeBy: none
		sourceColumn: Is_End_Of_Month

		annotation SummarizationSetBy = Automatic

	column Month
		dataType: string
		lineageTag: 1a3c48e3-e782-4a04-a83b-ffe1d9af1cfc
		summarizeBy: none
		sourceColumn: Month

		annotation SummarizationSetBy = Automatic

	column Month_Number
		dataType: double
		lineageTag: 33193694-fd1e-405e-831b-2f721807fc8a
		summarizeBy: sum
		sourceColumn: Month_Number

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column Month_Of_Year
		dataType: string
		lineageTag: c664ba28-bacf-4df1-842b-7c0c131f1e91
		summarizeBy: none
		sourceColumn: Month_Of_Year

		annotation SummarizationSetBy = Automatic

	column Month_Of_Year_Long
		dataType: string
		lineageTag: 2d6054b2-3d38-45a5-b48a-44a865c58262
		summarizeBy: none
		sourceColumn: Month_Of_Year_Long

		annotation SummarizationSetBy = Automatic

	column Month_Sort
		dataType: double
		lineageTag: d33624ec-7194-455f-8948-4729df160851
		summarizeBy: sum
		sourceColumn: Month_Sort

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column Week_Of_Year
		dataType: double
		lineageTag: bc11ba91-21f8-47b2-b219-0f6400a74542
		summarizeBy: sum
		sourceColumn: Week_Of_Year

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column Is_Current
		dataType: string
		lineageTag: 933b34b1-92f9-4de2-a5ea-a6d3a09ee99d
		summarizeBy: none
		sourceColumn: Is_Current

		annotation SummarizationSetBy = Automatic

	column ASALMONMarketDate = ```
			IF ( 'ESG Date'[Is_Current] = "Y", 
			"Latest Date", 'ESG Date'[DateIDDisplay] )
			```
		dataType: string
		lineageTag: c85e3068-eb0d-4a2a-b9f6-1bf3d28ab79b
		summarizeBy: none
		sortByColumn: Date_Value

		changedProperty = DataType

		changedProperty = SortByColumn

		annotation SummarizationSetBy = Automatic

	column MaxASALMONMarketDate = ```
			
			            MAX ( 'ESG Date'[Date_Value]
			)
			```
		formatString: d/m/yyyy
		lineageTag: 31729b33-d4dc-42cc-bca0-3b10659edfdf
		summarizeBy: none

		variation Variation
			isDefault
			relationship: ea453a3e-69eb-4a05-91c6-b08ac561d9a9
			defaultHierarchy: LocalDateTable_7436099a-6055-4a13-b4f4-7045bb2eaa61.'Date Hierarchy'

		changedProperty = DataType

		changedProperty = FormatString

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

		annotation PBI_FormatHint = {"isDateTimeCustom":true}

	column DateIDDisplay = ```
			
			            FORMAT ( [Date_Value], "dd/mm/yyyy" )
			```
		dataType: string
		lineageTag: 81a9805a-243a-4dc5-8e44-74ce8d89a63c
		summarizeBy: none

		changedProperty = DataType

		annotation SummarizationSetBy = Automatic

	column DateID = ```
			
			            VALUE ( FORMAT ( [Date_Value], "dd/mm/yyyy" ) )
			```
		dataType: dateTime
		formatString: Long Date
		lineageTag: c7cfa8bd-31c2-45e9-b4d2-99c07b3459f1
		summarizeBy: none

		variation Variation
			isDefault
			relationship: dbd21403-69e6-49b7-b835-5b6366a4d472
			defaultHierarchy: LocalDateTable_80ea61ed-d06e-4f0f-a249-e4c1c0a7974b.'Date Hierarchy'

		changedProperty = DataType

		changedProperty = FormatString

		annotation SummarizationSetBy = Automatic

		annotation UnderlyingDateTimeDataType = Date

	column 'Max Date Display' = ```
			IF ( 'ESG Date'[Is_Current] = "Y", 
			'ESG Date'[DateIDDisplay],"Not Latest Date")
			```
		lineageTag: c34230e5-d81e-442f-a30e-72b61bc9b0a6
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column 'Time Series Filter' = IF(OR('ESG Date'[Is_End_Of_Month] = "Y",'ESG Date'[Is_Current] = "Y"),"Y","N")
		lineageTag: 80b46b57-1ef1-4c80-a0e9-e04782ed675f
		summarizeBy: none

		annotation SummarizationSetBy = Automatic

	column is_end_of_year
		dataType: string
		lineageTag: 07089f92-d9e6-4f27-b561-76bac6d8b5df
		summarizeBy: none
		sourceColumn: is_end_of_year

		annotation SummarizationSetBy = Automatic

	partition 'ESG Date-aecf8fdc-e040-423e-b10f-132cf3519b76' = m
		mode: import
		queryGroup: Sustainalytics
		source = ```
				let
				    Source = DatabricksMultiCloud.Catalogs(p_databricks_host, p_databricks_path, [Catalog=null, Database=null, EnableAutomaticProxyDiscovery=null]),
				    hive_metastore_Database = Source{[Name=p_databricks_catalog,Kind="Database"]}[Data],
				    sustainalytics_Schema = hive_metastore_Database{[Name=p_sustainalytics_database,Kind="Schema"]}[Data],
				    semantic_esg_date_v1_Table = sustainalytics_Schema{[Name="semantic_esg_date_v1",Kind="Table"]}[Data]
				    ,  FilterLogic = 
				    if 
				         p_limit_rows = "Y" 
				    then
				     Table.FirstN(
				      semantic_esg_date_v1_Table, 
				      100
				     )
				 else 
				    semantic_esg_date_v1_Table 
				     in
				  FilterLogic
				```

	annotation PBI_ResultType = Table

	annotation PBI_NavigationStepName = Navigation

