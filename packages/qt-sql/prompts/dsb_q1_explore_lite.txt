You are an autonomous PostgreSQL Query Rewrite Engine. Your goal is to maximize execution speed while strictly preserving semantic invariants.

## Rules
- Output must return identical rows, columns, and ordering
- We will diff results to validate - any difference = rejection
- Avoid scanning large tables multiple times

## Original Query
```sql

with customer_total_return as
(select sr_customer_sk as ctr_customer_sk
,sr_store_sk as ctr_store_sk
,sr_reason_sk as ctr_reason_sk
,sum(SR_REFUNDED_CASH) as ctr_total_return
from store_returns
,date_dim
where sr_returned_date_sk = d_date_sk
and d_year =2001
and sr_return_amt / sr_return_quantity between 236 and 295
group by sr_customer_sk
,sr_store_sk, sr_reason_sk)
 select  c_customer_id
from customer_total_return ctr1
,store
,customer
,customer_demographics
where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2
from customer_total_return ctr2
where ctr1.ctr_store_sk = ctr2.ctr_store_sk
)
and ctr1.ctr_reason_sk BETWEEN 28 AND 31
and s_store_sk = ctr1.ctr_store_sk
and s_state IN ('MI', 'NC', 'WI')
and ctr1.ctr_customer_sk = c_customer_sk
and c_current_cdemo_sk = cd_demo_sk
and cd_marital_status IN ('W', 'W')
and cd_education_status IN ('4 yr Degree', 'College')
and cd_gender = 'M'
and c_birth_month = 5
and c_birth_year BETWEEN 1950 AND 1956
order by c_customer_id
limit 100;



```

## Execution Plan
```
Limit  (rows=0, time=138.347)
  Aggregate  (rows=73, time=135.934)
    Sort  (rows=73, time=135.886)
      Nested Loop  (rows=73, time=135.776)
        Index Only Scan on date_dim  (rows=365, time=2.055)
        Index Scan on store_returns  (rows=0, time=0.365)
  Sort  (rows=0, time=138.343)
    Nested Loop  (rows=0, time=138.323)
      Nested Loop  (rows=0, time=138.322)
        Nested Loop  (rows=1, time=137.327)
          CTE Scan (ctr1)  (rows=2, time=136.021)
            Aggregate  (rows=1, time=0.018)
              CTE Scan (ctr2)  (rows=3, time=0.014)
          Seq Scan on store  (rows=8, time=0.65)
        Index Scan on customer  (rows=0, time=0.993)
      Index Scan on customer_demographics  (rows=0, time=0.0)
```

## Task
Find the bottleneck in the plan. Rewrite the query to fix it.

Output ONLY the optimized SQL:

```sql

```
