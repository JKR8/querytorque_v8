```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "d1_filtered": "SELECT d_date_sk FROM date_dim WHERE d_quarter_name = '2001Q1'",
        "d2_filtered": "SELECT d_date_sk FROM date_dim WHERE d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')",
        "d3_filtered": "SELECT d_date_sk FROM date_dim WHERE d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')",
        "filtered_store_sales": "SELECT ss_customer_sk, ss_item_sk, ss_ticket_number, ss_store_sk, ss_quantity FROM store_sales JOIN d1_filtered ON ss_sold_date_sk = d_date_sk",
        "filtered_store_returns": "SELECT sr_customer_sk, sr_item_sk, sr_ticket_number, sr_return_quantity, sr_returned_date_sk FROM store_returns JOIN d2_filtered ON sr_returned_date_sk = d_date_sk",
        "filtered_catalog_sales": "SELECT cs_bill_customer_sk, cs_item_sk, cs_quantity FROM catalog_sales JOIN d3_filtered ON cs_sold_date_sk = d_date_sk",
        "main_query": "SELECT i_item_id, i_item_desc, s_state, COUNT(ss_quantity) AS store_sales_quantitycount, AVG(ss_quantity) AS store_sales_quantityave, STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev, STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov, COUNT(sr_return_quantity) AS store_returns_quantitycount, AVG(sr_return_quantity) AS store_returns_quantityave, STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev, STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov, COUNT(cs_quantity) AS catalog_sales_quantitycount, AVG(cs_quantity) AS catalog_sales_quantityave, STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev, STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov FROM filtered_store_sales ss JOIN store ON s_store_sk = ss_store_sk JOIN item i ON i_item_sk = ss_item_sk JOIN filtered_store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN filtered_catalog_sales cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk GROUP BY i_item_id, i_item_desc, s_state ORDER BY i_item_id, i_item_desc, s_state LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same grouping and aggregation"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Extracted three date_dim instances into separate CTEs (d1_filtered, d2_filtered, d3_filtered) to isolate date filtering early. Pre-joined each date CTE with respective fact tables (store_sales, store_returns, catalog_sales) to filter rows before the main complex joins. This reduces data volume early in the execution pipeline and allows each date filter to be computed once. The execution plan shows massive misestimates (900k√ó) on intermediate row counts, suggesting the optimizer struggles with correlated date filters. Early isolation helps optimizer choose better join orders."
}
```