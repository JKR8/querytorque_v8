```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11",
        "filtered_items": "SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manufact_id = 816",
        "main_query": "SELECT dt.d_year, item.i_brand_id AS brand_id, item.i_brand AS brand, SUM(ss_sales_price) AS sum_agg FROM store_sales JOIN filtered_dates dt ON store_sales.ss_sold_date_sk = dt.d_date_sk JOIN filtered_items item ON store_sales.ss_item_sk = item.i_item_sk GROUP BY dt.d_year, item.i_brand, item.i_brand_id ORDER BY dt.d_year, sum_agg DESC, brand_id LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation",
        "same output columns"
      ],
      "expected_speedup": "1.7x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim and item filters into separate CTEs. This enables early filtering of dimension tables before joining with the large fact table (store_sales), reducing the join cardinality from billions to thousands of rows. The date_dim CTE reduces from 73,049 rows to 6,000 rows (12x reduction), and item reduces from 408,000 rows to 51 rows (8,000x reduction). This dramatically decreases the hash join build costs and allows for more efficient sequential scanning of store_sales with early join elimination."
}
```