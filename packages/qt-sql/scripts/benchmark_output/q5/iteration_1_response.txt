```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "date_range": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-19' AS DATE) AND (CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY)",
        "ssr": "SELECT s_store_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS \"returns\", SUM(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk UNION ALL SELECT sr_store_sk AS store_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns JOIN date_range ON sr_returned_date_sk = d_date_sk) AS salesreturns, store WHERE store_sk = s_store_sk GROUP BY s_store_id"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (s_store_id)",
        "same result rows"
      ],
      "expected_speedup": "1.5-2.0x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "date_cte_isolate",
      "nodes": {
        "date_range": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-19' AS DATE) AND (CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY)",
        "wsr": "SELECT web_site_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS \"returns\", SUM(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT OUTER JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number) JOIN date_range ON wr_returned_date_sk = d_date_sk) AS salesreturns, web_site WHERE wsr_web_site_sk = web_site_sk GROUP BY web_site_id"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (web_site_id)",
        "same result rows"
      ],
      "expected_speedup": "2.0-2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date filter into reusable CTE, pushed date join early into UNION ALL branches before store/website joins. This reduces fact table scans from full table to 15-day range immediately, avoiding Cartesian products with entire date_dim table."
}
```