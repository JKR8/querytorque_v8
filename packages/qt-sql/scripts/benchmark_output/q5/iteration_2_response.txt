```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "semantic_rewrite",
      "nodes": {
        "wsr": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-19' AS DATE) AND (CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY))\nSELECT web_site_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS \"returns\", SUM(net_loss) AS profit_loss\nFROM (\n    SELECT ws_web_site_sk AS wsr_web_site_sk, ws_sold_date_sk AS date_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales\n    WHERE ws_sold_date_sk IN (SELECT d_date_sk FROM date_range)\n  UNION ALL\n    SELECT ws.ws_web_site_sk AS wsr_web_site_sk, wr.wr_returned_date_sk AS date_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, wr.wr_return_amt AS return_amt, wr.wr_net_loss AS net_loss\n    FROM web_returns wr\n    LEFT OUTER JOIN web_sales ws ON (wr.wr_item_sk = ws.ws_item_sk AND wr.wr_order_number = ws.ws_order_number)\n    WHERE wr.wr_returned_date_sk IN (SELECT d_date_sk FROM date_range)\n) AS salesreturns\nJOIN web_site ON wsr_web_site_sk = web_site_sk\nGROUP BY web_site_id"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (web_site_id)",
        "same result rows"
      ],
      "expected_speedup": "1.5x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "early_filter",
      "nodes": {
        "wsr": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-19' AS DATE) AND (CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY))\nSELECT web_site_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS \"returns\", SUM(net_loss) AS profit_loss\nFROM (\n    SELECT ws_web_site_sk AS wsr_web_site_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales\n    WHERE ws_sold_date_sk IN (SELECT d_date_sk FROM date_range)\n  UNION ALL\n    SELECT ws.ws_web_site_sk AS wsr_web_site_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, wr.wr_return_amt AS return_amt, wr.wr_net_loss AS net_loss\n    FROM web_returns wr\n    LEFT OUTER JOIN web_sales ws ON (wr.wr_item_sk = ws.ws_item_sk AND wr.wr_order_number = ws.ws_order_number)\n    WHERE wr.wr_returned_date_sk IN (SELECT d_date_sk FROM date_range)\n) AS salesreturns\nJOIN web_site ON wsr_web_site_sk = web_site_sk\nGROUP BY web_site_id"
      },
      "invariants_kept": [
        "same output columns",
        "same grain",
        "same result rows"
      ],
      "expected_speedup": "1.3x",
      "risk": "low"
    }
  ],
  "explanation": "Applied two complementary optimizations to wsr CTE: 1) Semantic rewrite to push date filtering INTO the UNION ALL subqueries using IN clauses with date_range CTE, avoiding full table scans of web_sales/web_returns before filtering. 2) Early filter optimization by removing the unused date_sk column from the projection since it's only used for filtering and not in final output. This reduces data movement and allows predicate pushdown into the UNION ALL branches."
}
```