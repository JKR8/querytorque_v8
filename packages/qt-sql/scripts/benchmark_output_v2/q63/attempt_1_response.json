```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk, d_moy FROM date_dim WHERE d_month_seq IN (1181, 1182, 1183, 1184, 1185, 1186, 1187, 1188, 1189, 1190, 1191, 1192)",
        "branch1_sales": "SELECT i.i_manager_id, fd.d_moy, ss.ss_sales_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE i.i_category IN ('Books','Children','Electronics') AND i.i_class IN ('personal','portable','reference','self-help') AND i.i_brand IN ('scholaramalgamalg #14','scholaramalgamalg #7','exportiunivamalg #9','scholaramalgamalg #9')",
        "branch2_sales": "SELECT i.i_manager_id, fd.d_moy, ss.ss_sales_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE i.i_category IN ('Women','Music','Men') AND i.i_class IN ('accessories','classical','fragrances','pants') AND i.i_brand IN ('amalgimporto #1','edu packscholar #1','exportiimporto #1','importoamalg #1')",
        "all_sales": "SELECT i_manager_id, d_moy, ss_sales_price FROM branch1_sales UNION ALL SELECT i_manager_id, d_moy, ss_sales_price FROM branch2_sales",
        "grouped_sales": "SELECT i_manager_id, d_moy, SUM(ss_sales_price) AS sum_sales FROM all_sales GROUP BY i_manager_id, d_moy",
        "windowed_sales": "SELECT i_manager_id, d_moy, sum_sales, AVG(sum_sales) OVER (PARTITION BY i_manager_id) AS avg_monthly_sales FROM grouped_sales",
        "main_query": "SELECT i_manager_id, sum_sales, avg_monthly_sales FROM windowed_sales WHERE CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY i_manager_id, avg_monthly_sales, sum_sales LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same result rows",
        "same ordering",
        "same grouping and aggregation",
        "same window function computation"
      ],
      "expected_speedup": "2.5x",
      "risk": "medium"
    }
  ],
  "explanation": "Rewrote the complex OR condition on item table into two UNION ALL branches, allowing each branch to use focused indexes and reduce early rows. Isolated date filter into CTE to avoid repeated scanning. The UNION ALL ensures disjoint conditions are processed separately, improving predicate pushdown and join efficiency."
}
```