```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "materialize_cte",
      "nodes": {
        "store_avg_profit": "SELECT AVG(ss_net_profit) AS store_avg_net_profit FROM store_sales WHERE ss_store_sk = 146 AND ss_addr_sk IS NULL GROUP BY ss_store_sk",
        "item_performance": "SELECT ss_item_sk AS item_sk, AVG(ss_net_profit) AS avg_net_profit FROM store_sales WHERE ss_store_sk = 146 GROUP BY ss_item_sk HAVING AVG(ss_net_profit) > 0.9 * (SELECT store_avg_net_profit FROM store_avg_profit)",
        "ascending_ranks": "SELECT item_sk, RANK() OVER (ORDER BY avg_net_profit ASC) AS rnk FROM item_performance WHERE rnk < 11",
        "descending_ranks": "SELECT item_sk, RANK() OVER (ORDER BY avg_net_profit DESC) AS rnk FROM item_performance WHERE rnk < 11",
        "main_query": "SELECT asceding.rnk, i1.i_product_name AS best_performing, i2.i_product_name AS worst_performing FROM ascending_ranks AS asceding JOIN descending_ranks AS descending ON asceding.rnk = descending.rnk JOIN item AS i1 ON asceding.item_sk = i1.i_item_sk JOIN item AS i2 ON descending.item_sk = i2.i_item_sk ORDER BY asceding.rnk LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same grouping and aggregation semantics"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Extracted the repeated correlated subquery (average store profit calculation) into a reusable CTE 'store_avg_profit'. Materialized the expensive item-level aggregation with HAVING clause into CTE 'item_performance' computed once. Created separate CTEs for ascending/descending rankings from the same materialized data. This eliminates duplicate scans of store_sales and redundant calculations of the store average profit."
}
```