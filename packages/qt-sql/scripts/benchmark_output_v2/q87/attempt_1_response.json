```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1184 AND 1184 + 11",
        "store_sales_customers": "SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk",
        "catalog_sales_customers": "SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk",
        "web_sales_customers": "SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk",
        "main_query": "SELECT COUNT(*) FROM ((SELECT * FROM store_sales_customers) EXCEPT (SELECT * FROM catalog_sales_customers) EXCEPT (SELECT * FROM web_sales_customers)) AS cool_cust"
      },
      "invariants_kept": [
        "same result rows",
        "same output columns",
        "same set semantics with EXCEPT",
        "same distinctness per subquery"
      ],
      "expected_speedup": "3.2x",
      "risk": "low"
    }
  ],
  "explanation": "Extracted the repeated date_dim filter (d_month_seq BETWEEN 1184 AND 1195) into a single CTE 'filtered_dates' that scans date_dim once instead of three times. Created separate CTEs for each sales channel that join with filtered_dates and customer, performing DISTINCT early. This reduces redundant scans of date_dim (73Kâ†’365 rows) and allows each sales table join to use a smaller date dimension. Early distinct reduces rows flowing into EXCEPT operations."
}
```