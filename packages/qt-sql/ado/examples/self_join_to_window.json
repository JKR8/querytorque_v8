{
  "id": "SELF_JOIN_TO_WINDOW",
  "name": "Self Join To Window",
  "description": "Replace self-joins used to access group-level values with window\n      functions, eliminating the join entirely.",
  "category": "window_functions",
  "priority": "medium",
  "verified_speedup": "unknown",
  "example": {
    "before_sql": "SELECT a.*, b.max_salary\n      FROM employees a\n      JOIN (\n          SELECT department, MAX(salary) AS max_salary\n          FROM employees GROUP BY department\n      ) b ON a.department = b.department;",
    "after_sql": "SELECT *, MAX(salary) OVER (PARTITION BY department) AS max_salary\n      FROM employees;",
    "alternative_sql": "",
    "key_insight": "Self-join retrieves aggregate values or rankings within a group.",
    "transforms": [
      "self_join_to_window"
    ]
  },
  "metadata": {
    "pg_version": "8.4+",
    "auto_applied_by_pg": "false",
    "research_source": "",
    "notes": ""
  }
}