{
  "id": "CORRELATED_SCALAR_TO_LEFT_JOIN",
  "name": "Correlated Scalar to LEFT JOIN",
  "description": "Convert correlated scalar subqueries in SELECT clause to LEFT JOIN. PostgreSQL executes scalar subqueries as nested loops and cannot decorrelate them automatically.",
  "verified_speedup": "5-10x",
  "benchmark": "dsb",
  "database": "postgres",
  "example": {
    "opportunity": "CORRELATED_SCALAR_TO_LEFT_JOIN",
    "before_sql": "SELECT o.order_id, o.customer_id, (SELECT c.name FROM customers c WHERE c.id = o.customer_id) AS customer_name FROM orders o;",
    "after_sql": "SELECT o.order_id, o.customer_id, c.name AS customer_name FROM orders o LEFT JOIN customers c ON c.id = o.customer_id;",
    "transforms": ["decorrelate", "scalar_to_join"],
    "key_insight": "PostgreSQL executes scalar subqueries as nested loops. LEFT JOIN enables hash/merge join strategies.",
    "output": {
      "rewrite_sets": [
        {
          "id": "rs_01",
          "transform": "decorrelate",
          "nodes": {
            "main_query": "SELECT o.order_id, o.customer_id, c.name AS customer_name FROM orders o LEFT JOIN customers c ON c.id = o.customer_id;"
          },
          "invariants_kept": ["same result rows", "same output columns"],
          "expected_speedup": "5x+",
          "risk": "low"
        }
      ]
    }
  }
}
