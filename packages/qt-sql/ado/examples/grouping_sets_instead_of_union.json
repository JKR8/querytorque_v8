{
  "id": "GROUPING_SETS_INSTEAD_OF_UNION",
  "name": "Grouping Sets Instead Of Union",
  "description": "Replace multiple GROUP BY queries with UNION ALL using single\n      GROUPING SETS/ROLLUP/CUBE query for multi-level aggregations.",
  "category": "aggregation_optimization",
  "priority": "medium",
  "verified_speedup": "unknown",
  "example": {
    "before_sql": "SELECT region, NULL as product, SUM(sales) FROM sales GROUP BY region\n      UNION ALL\n      SELECT NULL, product, SUM(sales) FROM sales GROUP BY product\n      UNION ALL\n      SELECT NULL, NULL, SUM(sales) FROM sales;",
    "after_sql": "SELECT region, product, SUM(sales)\n      FROM sales\n      GROUP BY GROUPING SETS ((region), (product), ());",
    "alternative_sql": "-- For hierarchical rollups\n      SELECT region, product, SUM(sales)\n      FROM sales\n      GROUP BY ROLLUP (region, product);",
    "key_insight": "Reports requiring multiple aggregation levels (subtotals, grand totals).",
    "transforms": [
      "grouping_sets_instead_of_union"
    ]
  },
  "metadata": {
    "pg_version": "9.5+",
    "auto_applied_by_pg": "false",
    "research_source": "",
    "notes": ""
  }
}