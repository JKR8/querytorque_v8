{
  "failure_analysis": "All previous attempts failed to consistently reach 2.0x speedup because they didn't address the root cause: multiple full scans of massive fact tables (store_sales, catalog_sales, web_sales) due to correlated subqueries and disconnected optimizations. Worker 2's date isolation (1.94x) helped but still suffered from repeated store_sales scans for frequent_ss_items and best_ss_customer. Workers 1,3,4,5 achieved higher speedups but likely failed due to incorrect semantics: Worker 3's DISTINCT in frequent_ss_items lost per-date grouping, Worker 5's materialization didn't handle the complex HAVING condition correctly. All attempts missed the critical opportunity to consolidate multiple fact table scans into single-pass computations and share results across both main queries.",
  "unexplored": "1. **Cross-query materialization**: Create temporary tables for expensive CTEs (frequent_ss_items, best_ss_customer) and reuse them across both main queries.\n2. **Single-pass store_sales aggregation**: Compute both frequent_ss_items (with date filter) and max_store_sales in one scan of store_sales with multi-aggregation.\n3. **Join transformation**: Convert IN subqueries to hash joins with pre-materialized small dimension tables.\n4. **Date dimension pre-materialization**: Create two optimized date dimension tables (years 2000-2003 and May 2000) as physical tables.",
  "refined_strategy": "1. **Isolate and materialize date dimensions** as temporary tables for efficient reuse.\n2. **Single-pass store_sales scan** with filtered dates to compute both frequent_ss_items (distinct item_sk) and max_store_sales threshold.\n3. **Materialize best_ss_customer** as a temporary table by scanning store_sales once with the precomputed threshold.\n4. **Convert all IN subqueries to hash joins** using the materialized temporary tables.\n5. **Reuse materialized results** across both main queries to avoid recomputation.",
  "examples": [
    "single_pass_aggregation",
    "date_cte_isolate",
    "materialize_cte"
  ],
  "hint": "Create TEMP TABLE for frequent_ss_items and best_ss_customer after single-pass store_sales aggregation, then rewrite both main queries with explicit JOINs to these tables instead of IN subqueries. Use filtered date dimension CTEs for all fact table joins."
}