```sql
WITH store_sales_stats AS (
  SELECT
    COUNT(*) FILTER (WHERE ss_quantity BETWEEN 1 AND 20) AS cnt_1_20,
    AVG(ss_ext_sales_price) FILTER (WHERE ss_quantity BETWEEN 1 AND 20) AS avg_ext_1_20,
    AVG(ss_net_profit) FILTER (WHERE ss_quantity BETWEEN 1 AND 20) AS avg_net_1_20,
    
    COUNT(*) FILTER (WHERE ss_quantity BETWEEN 21 AND 40) AS cnt_21_40,
    AVG(ss_ext_sales_price) FILTER (WHERE ss_quantity BETWEEN 21 AND 40) AS avg_ext_21_40,
    AVG(ss_net_profit) FILTER (WHERE ss_quantity BETWEEN 21 AND 40) AS avg_net_21_40,
    
    COUNT(*) FILTER (WHERE ss_quantity BETWEEN 41 AND 60) AS cnt_41_60,
    AVG(ss_ext_sales_price) FILTER (WHERE ss_quantity BETWEEN 41 AND 60) AS avg_ext_41_60,
    AVG(ss_net_profit) FILTER (WHERE ss_quantity BETWEEN 41 AND 60) AS avg_net_41_60,
    
    COUNT(*) FILTER (WHERE ss_quantity BETWEEN 61 AND 80) AS cnt_61_80,
    AVG(ss_ext_sales_price) FILTER (WHERE ss_quantity BETWEEN 61 AND 80) AS avg_ext_61_80,
    AVG(ss_net_profit) FILTER (WHERE ss_quantity BETWEEN 61 AND 80) AS avg_net_61_80,
    
    COUNT(*) FILTER (WHERE ss_quantity BETWEEN 81 AND 100) AS cnt_81_100,
    AVG(ss_ext_sales_price) FILTER (WHERE ss_quantity BETWEEN 81 AND 100) AS avg_ext_81_100,
    AVG(ss_net_profit) FILTER (WHERE ss_quantity BETWEEN 81 AND 100) AS avg_net_81_100
  FROM store_sales
)
SELECT
  CASE
    WHEN cnt_1_20 > 2972190 THEN avg_ext_1_20
    ELSE avg_net_1_20
  END AS bucket1,
  CASE
    WHEN cnt_21_40 > 4505785 THEN avg_ext_21_40
    ELSE avg_net_21_40
  END AS bucket2,
  CASE
    WHEN cnt_41_60 > 1575726 THEN avg_ext_41_60
    ELSE avg_net_41_60
  END AS bucket3,
  CASE
    WHEN cnt_61_80 > 3188917 THEN avg_ext_61_80
    ELSE avg_net_61_80
  END AS bucket4,
  CASE
    WHEN cnt_81_100 > 3525216 THEN avg_ext_81_100
    ELSE avg_net_81_100
  END AS bucket5
FROM reason
CROSS JOIN store_sales_stats
WHERE r_reason_sk = 1
```

Changes: Consolidated 15 separate table scans of store_sales into a single CTE that computes all required aggregates (counts and averages for each quantity bucket) in one pass using FILTER clauses, then cross-joins the result with the filtered reason table.
Expected speedup: 4.0x+ (reduces 15 scans to 1)