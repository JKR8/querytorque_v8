```sql
WITH filtered_sales AS (
    SELECT
        ss_ext_sales_price,
        ss_customer_sk,
        ss_store_sk,
        i.i_brand_id,
        i.i_brand,
        i.i_manufact_id,
        i.i_manufact
    FROM store_sales
    JOIN date_dim d ON d.d_date_sk = ss_sold_date_sk
    JOIN item i ON i.i_item_sk = ss_item_sk
    WHERE d.d_moy = 12
      AND d.d_year = 1999
      AND i.i_manager_id = 2
),
customer_zip AS (
    SELECT
        c_customer_sk,
        SUBSTRING(ca_zip, 1, 5) AS zip_prefix
    FROM customer
    JOIN customer_address ON c_current_addr_sk = ca_address_sk
),
store_zip AS (
    SELECT
        s_store_sk,
        SUBSTRING(s_zip, 1, 5) AS zip_prefix
    FROM store
)
SELECT
    i_brand_id AS brand_id,
    i_brand AS brand,
    i_manufact_id,
    i_manufact,
    SUM(ss_ext_sales_price) AS ext_price
FROM filtered_sales fs
JOIN customer_zip cz ON fs.ss_customer_sk = cz.c_customer_sk
JOIN store_zip sz ON fs.ss_store_sk = sz.s_store_sk
WHERE cz.zip_prefix <> sz.zip_prefix
GROUP BY
    i_brand,
    i_brand_id,
    i_manufact_id,
    i_manufact
ORDER BY
    ext_price DESC,
    i_brand,
    i_brand_id,
    i_manufact_id,
    i_manufact
LIMIT 100
```

Changes: Isolated fact table joins into a compact CTE that filters date and item early, precomputed zip prefixes for customer and store in separate CTEs, then applied the inequality filter and aggregation last. This reduces data volume before the expensive zip comparison.

Expected speedup: 2-3x by minimizing rows before the inequality filter and leveraging precomputed CTEs.