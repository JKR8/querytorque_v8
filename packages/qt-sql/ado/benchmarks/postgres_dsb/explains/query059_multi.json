{
  "query_id": "query059_multi",
  "engine": "postgresql",
  "benchmark": "dsb",
  "scale_factor": 5,
  "execution_time_ms": 12667.591,
  "planning_time_ms": 0.746,
  "plan_json": [
    {
      "Plan": {
        "Node Type": "Limit",
        "Parallel Aware": false,
        "Async Capable": false,
        "Startup Cost": 397783.59,
        "Total Cost": 397783.6,
        "Plan Rows": 1,
        "Plan Width": 250,
        "Actual Startup Time": 12658.557,
        "Actual Total Time": 12658.627,
        "Actual Rows": 100,
        "Actual Loops": 1,
        "Output": [
          "store.s_store_name",
          "store.s_store_id",
          "wss.d_week_seq",
          "((wss.sun_sales / wss_1.sun_sales))",
          "((wss.mon_sales / wss_1.mon_sales))",
          "((wss.tue_sales / wss_1.tue_sales))",
          "((wss.wed_sales / wss_1.wed_sales))",
          "((wss.thu_sales / wss_1.thu_sales))",
          "((wss.fri_sales / wss_1.fri_sales))",
          "((wss.sat_sales / wss_1.sat_sales))"
        ],
        "Shared Hit Blocks": 184479,
        "Shared Read Blocks": 257000,
        "Shared Dirtied Blocks": 0,
        "Shared Written Blocks": 0,
        "Local Hit Blocks": 0,
        "Local Read Blocks": 0,
        "Local Dirtied Blocks": 0,
        "Local Written Blocks": 0,
        "Temp Read Blocks": 9123,
        "Temp Written Blocks": 9163,
        "Plans": [
          {
            "Node Type": "Aggregate",
            "Strategy": "Sorted",
            "Partial Mode": "Simple",
            "Parent Relationship": "InitPlan",
            "Subplan Name": "CTE wss",
            "Parallel Aware": false,
            "Async Capable": false,
            "Startup Cost": 381798.19,
            "Total Cost": 394438.89,
            "Plan Rows": 68712,
            "Plan Width": 232,
            "Actual Startup Time": 11495.319,
            "Actual Total Time": 12546.221,
            "Actual Rows": 5328,
            "Actual Loops": 1,
            "Output": [
              "date_dim.d_week_seq",
              "store_sales.ss_store_sk",
              "sum(CASE WHEN (date_dim.d_day_name = 'Sunday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END)",
              "sum(CASE WHEN (date_dim.d_day_name = 'Monday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END)",
              "sum(CASE WHEN (date_dim.d_day_name = 'Tuesday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END)",
              "sum(CASE WHEN (date_dim.d_day_name = 'Wednesday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END)",
              "sum(CASE WHEN (date_dim.d_day_name = 'Thursday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END)",
              "sum(CASE WHEN (date_dim.d_day_name = 'Friday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END)",
              "sum(CASE WHEN (date_dim.d_day_name = 'Saturday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END)"
            ],
            "Group Key": [
              "date_dim.d_week_seq",
              "store_sales.ss_store_sk"
            ],
            "Shared Hit Blocks": 12346,
            "Shared Read Blocks": 257000,
            "Shared Dirtied Blocks": 0,
            "Shared Written Blocks": 0,
            "Local Hit Blocks": 0,
            "Local Read Blocks": 0,
            "Local Dirtied Blocks": 0,
            "Local Written Blocks": 0,
            "Temp Read Blocks": 9123,
            "Temp Written Blocks": 9163,
            "Plans": [
              {
                "Node Type": "Gather Merge",
                "Parent Relationship": "Outer",
                "Parallel Aware": false,
                "Async Capable": false,
                "Startup Cost": 381798.19,
                "Total Cost": 389800.83,
                "Plan Rows": 68712,
                "Plan Width": 24,
                "Actual Startup Time": 11495.234,
                "Actual Total Time": 12138.972,
                "Actual Rows": 2138505,
                "Actual Loops": 1,
                "Output": [
                  "date_dim.d_week_seq",
                  "store_sales.ss_store_sk",
                  "date_dim.d_day_name",
                  "store_sales.ss_sales_price"
                ],
                "Workers Planned": 2,
                "Workers Launched": 2,
                "Shared Hit Blocks": 12346,
                "Shared Read Blocks": 257000,
                "Shared Dirtied Blocks": 0,
                "Shared Written Blocks": 0,
                "Local Hit Blocks": 0,
                "Local Read Blocks": 0,
                "Local Dirtied Blocks": 0,
                "Local Written Blocks": 0,
                "Temp Read Blocks": 9123,
                "Temp Written Blocks": 9163,
                "Plans": [
                  {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Async Capable": false,
                    "Startup Cost": 380798.16,
                    "Total Cost": 380869.74,
                    "Plan Rows": 28630,
                    "Plan Width": 24,
                    "Actual Startup Time": 11471.446,
                    "Actual Total Time": 11716.861,
                    "Actual Rows": 712835,
                    "Actual Loops": 3,
                    "Output": [
                      "date_dim.d_week_seq",
                      "store_sales.ss_store_sk",
                      "date_dim.d_day_name",
                      "store_sales.ss_sales_price"
                    ],
                    "Sort Key": [
                      "date_dim.d_week_seq",
                      "store_sales.ss_store_sk"
                    ],
                    "Sort Method": "external merge",
                    "Sort Space Used": 24440,
                    "Sort Space Type": "Disk",
                    "Shared Hit Blocks": 12346,
                    "Shared Read Blocks": 257000,
                    "Shared Dirtied Blocks": 0,
                    "Shared Written Blocks": 0,
                    "Local Hit Blocks": 0,
                    "Local Read Blocks": 0,
                    "Local Dirtied Blocks": 0,
                    "Local Written Blocks": 0,
                    "Temp Read Blocks": 9123,
                    "Temp Written Blocks": 9163,
                    "Workers": [
                      {
                        "Worker Number": 0,
                        "Actual Startup Time": 11470.581,
                        "Actual Total Time": 11710.619,
                        "Actual Rows": 709782,
                        "Actual Loops": 1,
                        "Sort Method": "external merge",
                        "Sort Space Used": 24224,
                        "Sort Space Type": "Disk",
                        "JIT": {
                          "Functions": 13,
                          "Options": {
                            "Inlining": false,
                            "Optimization": false,
                            "Expressions": true,
                            "Deforming": true
                          },
                          "Timing": {
                            "Generation": 0.601,
                            "Inlining": 0.0,
                            "Optimization": 0.497,
                            "Emission": 8.176,
                            "Total": 9.274
                          }
                        },
                        "Shared Hit Blocks": 4038,
                        "Shared Read Blocks": 85420,
                        "Shared Dirtied Blocks": 0,
                        "Shared Written Blocks": 0,
                        "Local Hit Blocks": 0,
                        "Local Read Blocks": 0,
                        "Local Dirtied Blocks": 0,
                        "Local Written Blocks": 0,
                        "Temp Read Blocks": 3028,
                        "Temp Written Blocks": 3041
                      },
                      {
                        "Worker Number": 1,
                        "Actual Startup Time": 11471.058,
                        "Actual Total Time": 11720.462,
                        "Actual Rows": 712713,
                        "Actual Loops": 1,
                        "Sort Method": "external merge",
                        "Sort Space Used": 24320,
                        "Sort Space Type": "Disk",
                        "JIT": {
                          "Functions": 13,
                          "Options": {
                            "Inlining": false,
                            "Optimization": false,
                            "Expressions": true,
                            "Deforming": true
                          },
                          "Timing": {
                            "Generation": 0.618,
                            "Inlining": 0.0,
                            "Optimization": 0.505,
                            "Emission": 8.177,
                            "Total": 9.3
                          }
                        },
                        "Shared Hit Blocks": 4202,
                        "Shared Read Blocks": 85511,
                        "Shared Dirtied Blocks": 0,
                        "Shared Written Blocks": 0,
                        "Local Hit Blocks": 0,
                        "Local Read Blocks": 0,
                        "Local Dirtied Blocks": 0,
                        "Local Written Blocks": 0,
                        "Temp Read Blocks": 3040,
                        "Temp Written Blocks": 3053
                      }
                    ],
                    "Plans": [
                      {
                        "Node Type": "Nested Loop",
                        "Parent Relationship": "Outer",
                        "Parallel Aware": false,
                        "Async Capable": false,
                        "Join Type": "Inner",
                        "Startup Cost": 0.3,
                        "Total Cost": 378678.79,
                        "Plan Rows": 28630,
                        "Plan Width": 24,
                        "Actual Startup Time": 6.261,
                        "Actual Total Time": 10856.303,
                        "Actual Rows": 712835,
                        "Actual Loops": 3,
                        "Output": [
                          "date_dim.d_week_seq",
                          "store_sales.ss_store_sk",
                          "date_dim.d_day_name",
                          "store_sales.ss_sales_price"
                        ],
                        "Inner Unique": true,
                        "Shared Hit Blocks": 12332,
                        "Shared Read Blocks": 257000,
                        "Shared Dirtied Blocks": 0,
                        "Shared Written Blocks": 0,
                        "Local Hit Blocks": 0,
                        "Local Read Blocks": 0,
                        "Local Dirtied Blocks": 0,
                        "Local Written Blocks": 0,
                        "Temp Read Blocks": 0,
                        "Temp Written Blocks": 0,
                        "Workers": [
                          {
                            "Worker Number": 0,
                            "Actual Startup Time": 9.246,
                            "Actual Total Time": 10848.248,
                            "Actual Rows": 709782,
                            "Actual Loops": 1,
                            "Shared Hit Blocks": 4031,
                            "Shared Read Blocks": 85420,
                            "Shared Dirtied Blocks": 0,
                            "Shared Written Blocks": 0,
                            "Local Hit Blocks": 0,
                            "Local Read Blocks": 0,
                            "Local Dirtied Blocks": 0,
                            "Local Written Blocks": 0,
                            "Temp Read Blocks": 0,
                            "Temp Written Blocks": 0
                          },
                          {
                            "Worker Number": 1,
                            "Actual Startup Time": 9.259,
                            "Actual Total Time": 10856.656,
                            "Actual Rows": 712713,
                            "Actual Loops": 1,
                            "Shared Hit Blocks": 4195,
                            "Shared Read Blocks": 85511,
                            "Shared Dirtied Blocks": 0,
                            "Shared Written Blocks": 0,
                            "Local Hit Blocks": 0,
                            "Local Read Blocks": 0,
                            "Local Dirtied Blocks": 0,
                            "Local Written Blocks": 0,
                            "Temp Read Blocks": 0,
                            "Temp Written Blocks": 0
                          }
                        ],
                        "Plans": [
                          {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": true,
                            "Async Capable": false,
                            "Relation Name": "store_sales",
                            "Schema": "public",
                            "Alias": "store_sales",
                            "Startup Cost": 0.0,
                            "Total Cost": 377103.7,
                            "Plan Rows": 30002,
                            "Plan Width": 14,
                            "Actual Startup Time": 6.217,
                            "Actual Total Time": 10529.584,
                            "Actual Rows": 721567,
                            "Actual Loops": 3,
                            "Output": [
                              "store_sales.ss_sold_date_sk",
                              "store_sales.ss_sold_time_sk",
                              "store_sales.ss_item_sk",
                              "store_sales.ss_customer_sk",
                              "store_sales.ss_cdemo_sk",
                              "store_sales.ss_hdemo_sk",
                              "store_sales.ss_addr_sk",
                              "store_sales.ss_store_sk",
                              "store_sales.ss_promo_sk",
                              "store_sales.ss_ticket_number",
                              "store_sales.ss_quantity",
                              "store_sales.ss_wholesale_cost",
                              "store_sales.ss_list_price",
                              "store_sales.ss_sales_price",
                              "store_sales.ss_ext_discount_amt",
                              "store_sales.ss_ext_sales_price",
                              "store_sales.ss_ext_wholesale_cost",
                              "store_sales.ss_ext_list_price",
                              "store_sales.ss_ext_tax",
                              "store_sales.ss_coupon_amt",
                              "store_sales.ss_net_paid",
                              "store_sales.ss_net_paid_inc_tax",
                              "store_sales.ss_net_profit"
                            ],
                            "Filter": "(((store_sales.ss_sales_price / store_sales.ss_list_price) >= 0.11) AND ((store_sales.ss_sales_price / store_sales.ss_list_price) <= 0.31))",
                            "Rows Removed by Filter": 4078450,
                            "Shared Hit Blocks": 96,
                            "Shared Read Blocks": 257000,
                            "Shared Dirtied Blocks": 0,
                            "Shared Written Blocks": 0,
                            "Local Hit Blocks": 0,
                            "Local Read Blocks": 0,
                            "Local Dirtied Blocks": 0,
                            "Local Written Blocks": 0,
                            "Temp Read Blocks": 0,
                            "Temp Written Blocks": 0,
                            "Workers": [
                              {
                                "Worker Number": 0,
                                "Actual Startup Time": 9.196,
                                "Actual Total Time": 10525.174,
                                "Actual Rows": 718540,
                                "Actual Loops": 1,
                                "Shared Hit Blocks": 31,
                                "Shared Read Blocks": 85420,
                                "Shared Dirtied Blocks": 0,
                                "Shared Written Blocks": 0,
                                "Local Hit Blocks": 0,
                                "Local Read Blocks": 0,
                                "Local Dirtied Blocks": 0,
                                "Local Written Blocks": 0,
                                "Temp Read Blocks": 0,
                                "Temp Written Blocks": 0
                              },
                              {
                                "Worker Number": 1,
                                "Actual Startup Time": 9.206,
                                "Actual Total Time": 10532.36,
                                "Actual Rows": 721412,
                                "Actual Loops": 1,
                                "Shared Hit Blocks": 30,
                                "Shared Read Blocks": 85511,
                                "Shared Dirtied Blocks": 0,
                                "Shared Written Blocks": 0,
                                "Local Hit Blocks": 0,
                                "Local Read Blocks": 0,
                                "Local Dirtied Blocks": 0,
                                "Local Written Blocks": 0,
                                "Temp Read Blocks": 0,
                                "Temp Written Blocks": 0
                              }
                            ]
                          },
                          {
                            "Node Type": "Memoize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Async Capable": false,
                            "Startup Cost": 0.3,
                            "Total Cost": 0.41,
                            "Plan Rows": 1,
                            "Plan Width": 18,
                            "Actual Startup Time": 0.0,
                            "Actual Total Time": 0.0,
                            "Actual Rows": 1,
                            "Actual Loops": 2164701,
                            "Output": [
                              "date_dim.d_week_seq",
                              "date_dim.d_day_name",
                              "date_dim.d_date_sk"
                            ],
                            "Cache Key": "store_sales.ss_sold_date_sk",
                            "Cache Mode": "logical",
                            "Cache Hits": 723391,
                            "Cache Misses": 1358,
                            "Cache Evictions": 0,
                            "Cache Overflows": 0,
                            "Peak Memory Usage": 160,
                            "Shared Hit Blocks": 12236,
                            "Shared Read Blocks": 0,
                            "Shared Dirtied Blocks": 0,
                            "Shared Written Blocks": 0,
                            "Local Hit Blocks": 0,
                            "Local Read Blocks": 0,
                            "Local Dirtied Blocks": 0,
                            "Local Written Blocks": 0,
                            "Temp Read Blocks": 0,
                            "Temp Written Blocks": 0,
                            "Workers": [
                              {
                                "Worker Number": 0,
                                "Actual Startup Time": 0.0,
                                "Actual Total Time": 0.0,
                                "Actual Rows": 1,
                                "Actual Loops": 718540,
                                "Cache Hits": 717206,
                                "Cache Misses": 1334,
                                "Cache Evictions": 0,
                                "Cache Overflows": 0,
                                "Peak Memory Usage": 157,
                                "Shared Hit Blocks": 4000,
                                "Shared Read Blocks": 0,
                                "Shared Dirtied Blocks": 0,
                                "Shared Written Blocks": 0,
                                "Local Hit Blocks": 0,
                                "Local Read Blocks": 0,
                                "Local Dirtied Blocks": 0,
                                "Local Written Blocks": 0,
                                "Temp Read Blocks": 0,
                                "Temp Written Blocks": 0
                              },
                              {
                                "Worker Number": 1,
                                "Actual Startup Time": 0.0,
                                "Actual Total Time": 0.0,
                                "Actual Rows": 1,
                                "Actual Loops": 721412,
                                "Cache Hits": 720023,
                                "Cache Misses": 1389,
                                "Cache Evictions": 0,
                                "Cache Overflows": 0,
                                "Peak Memory Usage": 163,
                                "Shared Hit Blocks": 4165,
                                "Shared Read Blocks": 0,
                                "Shared Dirtied Blocks": 0,
                                "Shared Written Blocks": 0,
                                "Local Hit Blocks": 0,
                                "Local Read Blocks": 0,
                                "Local Dirtied Blocks": 0,
                                "Local Written Blocks": 0,
                                "Temp Read Blocks": 0,
                                "Temp Written Blocks": 0
                              }
                            ],
                            "Plans": [
                              {
                                "Node Type": "Index Scan",
                                "Parent Relationship": "Outer",
                                "Parallel Aware": false,
                                "Async Capable": false,
                                "Scan Direction": "Forward",
                                "Index Name": "date_dim_pkey",
                                "Relation Name": "date_dim",
                                "Schema": "public",
                                "Alias": "date_dim",
                                "Startup Cost": 0.29,
                                "Total Cost": 0.4,
                                "Plan Rows": 1,
                                "Plan Width": 18,
                                "Actual Startup Time": 0.006,
                                "Actual Total Time": 0.006,
                                "Actual Rows": 1,
                                "Actual Loops": 4081,
                                "Output": [
                                  "date_dim.d_week_seq",
                                  "date_dim.d_day_name",
                                  "date_dim.d_date_sk"
                                ],
                                "Index Cond": "(date_dim.d_date_sk = store_sales.ss_sold_date_sk)",
                                "Rows Removed by Index Recheck": 0,
                                "Shared Hit Blocks": 12236,
                                "Shared Read Blocks": 0,
                                "Shared Dirtied Blocks": 0,
                                "Shared Written Blocks": 0,
                                "Local Hit Blocks": 0,
                                "Local Read Blocks": 0,
                                "Local Dirtied Blocks": 0,
                                "Local Written Blocks": 0,
                                "Temp Read Blocks": 0,
                                "Temp Written Blocks": 0,
                                "Workers": [
                                  {
                                    "Worker Number": 0,
                                    "Actual Startup Time": 0.006,
                                    "Actual Total Time": 0.006,
                                    "Actual Rows": 1,
                                    "Actual Loops": 1334,
                                    "Shared Hit Blocks": 4000,
                                    "Shared Read Blocks": 0,
                                    "Shared Dirtied Blocks": 0,
                                    "Shared Written Blocks": 0,
                                    "Local Hit Blocks": 0,
                                    "Local Read Blocks": 0,
                                    "Local Dirtied Blocks": 0,
                                    "Local Written Blocks": 0,
                                    "Temp Read Blocks": 0,
                                    "Temp Written Blocks": 0
                                  },
                                  {
                                    "Worker Number": 1,
                                    "Actual Startup Time": 0.006,
                                    "Actual Total Time": 0.006,
                                    "Actual Rows": 1,
                                    "Actual Loops": 1389,
                                    "Shared Hit Blocks": 4165,
                                    "Shared Read Blocks": 0,
                                    "Shared Dirtied Blocks": 0,
                                    "Shared Written Blocks": 0,
                                    "Local Hit Blocks": 0,
                                    "Local Read Blocks": 0,
                                    "Local Dirtied Blocks": 0,
                                    "Local Written Blocks": 0,
                                    "Temp Read Blocks": 0,
                                    "Temp Written Blocks": 0
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "Node Type": "Sort",
            "Parent Relationship": "Outer",
            "Parallel Aware": false,
            "Async Capable": false,
            "Startup Cost": 3344.7,
            "Total Cost": 3344.71,
            "Plan Rows": 1,
            "Plan Width": 250,
            "Actual Startup Time": 12631.629,
            "Actual Total Time": 12631.637,
            "Actual Rows": 100,
            "Actual Loops": 1,
            "Output": [
              "store.s_store_name",
              "store.s_store_id",
              "wss.d_week_seq",
              "((wss.sun_sales / wss_1.sun_sales))",
              "((wss.mon_sales / wss_1.mon_sales))",
              "((wss.tue_sales / wss_1.tue_sales))",
              "((wss.wed_sales / wss_1.wed_sales))",
              "((wss.thu_sales / wss_1.thu_sales))",
              "((wss.fri_sales / wss_1.fri_sales))",
              "((wss.sat_sales / wss_1.sat_sales))"
            ],
            "Sort Key": [
              "store.s_store_name",
              "store.s_store_id",
              "wss.d_week_seq"
            ],
            "Sort Method": "top-N heapsort",
            "Sort Space Used": 64,
            "Sort Space Type": "Memory",
            "Shared Hit Blocks": 176239,
            "Shared Read Blocks": 86069,
            "Shared Dirtied Blocks": 0,
            "Shared Written Blocks": 0,
            "Local Hit Blocks": 0,
            "Local Read Blocks": 0,
            "Local Dirtied Blocks": 0,
            "Local Written Blocks": 0,
            "Temp Read Blocks": 3055,
            "Temp Written Blocks": 3069,
            "Plans": [
              {
                "Node Type": "Nested Loop",
                "Parent Relationship": "Outer",
                "Parallel Aware": false,
                "Async Capable": false,
                "Join Type": "Inner",
                "Startup Cost": 1702.28,
                "Total Cost": 3344.69,
                "Plan Rows": 1,
                "Plan Width": 250,
                "Actual Startup Time": 12552.32,
                "Actual Total Time": 12630.475,
                "Actual Rows": 5062,
                "Actual Loops": 1,
                "Output": [
                  "store.s_store_name",
                  "store.s_store_id",
                  "wss.d_week_seq",
                  "(wss.sun_sales / wss_1.sun_sales)",
                  "(wss.mon_sales / wss_1.mon_sales)",
                  "(wss.tue_sales / wss_1.tue_sales)",
                  "(wss.wed_sales / wss_1.wed_sales)",
                  "(wss.thu_sales / wss_1.thu_sales)",
                  "(wss.fri_sales / wss_1.fri_sales)",
                  "(wss.sat_sales / wss_1.sat_sales)"
                ],
                "Inner Unique": true,
                "Join Filter": "(store.s_store_id = store_1.s_store_id)",
                "Rows Removed by Join Filter": 5062,
                "Shared Hit Blocks": 176239,
                "Shared Read Blocks": 86069,
                "Shared Dirtied Blocks": 0,
                "Shared Written Blocks": 0,
                "Local Hit Blocks": 0,
                "Local Read Blocks": 0,
                "Local Dirtied Blocks": 0,
                "Local Written Blocks": 0,
                "Temp Read Blocks": 3055,
                "Temp Written Blocks": 3069,
                "Plans": [
                  {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Async Capable": false,
                    "Join Type": "Inner",
                    "Startup Cost": 1702.14,
                    "Total Cost": 3334.58,
                    "Plan Rows": 56,
                    "Plan Width": 473,
                    "Actual Startup Time": 12552.142,
                    "Actual Total Time": 12562.038,
                    "Actual Rows": 91116,
                    "Actual Loops": 1,
                    "Output": [
                      "wss.d_week_seq",
                      "wss.sun_sales",
                      "wss.mon_sales",
                      "wss.tue_sales",
                      "wss.wed_sales",
                      "wss.thu_sales",
                      "wss.fri_sales",
                      "wss.sat_sales",
                      "wss.ss_store_sk",
                      "wss_1.sun_sales",
                      "wss_1.mon_sales",
                      "wss_1.tue_sales",
                      "wss_1.wed_sales",
                      "wss_1.thu_sales",
                      "wss_1.fri_sales",
                      "wss_1.sat_sales",
                      "store_1.s_store_id"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(wss.d_week_seq = d.d_week_seq)",
                    "Shared Hit Blocks": 4131,
                    "Shared Read Blocks": 86069,
                    "Shared Dirtied Blocks": 0,
                    "Shared Written Blocks": 0,
                    "Local Hit Blocks": 0,
                    "Local Read Blocks": 0,
                    "Local Dirtied Blocks": 0,
                    "Local Written Blocks": 0,
                    "Temp Read Blocks": 3055,
                    "Temp Written Blocks": 3069,
                    "Plans": [
                      {
                        "Node Type": "CTE Scan",
                        "Parent Relationship": "Outer",
                        "Parallel Aware": false,
                        "Async Capable": false,
                        "CTE Name": "wss",
                        "Alias": "wss",
                        "Startup Cost": 0.0,
                        "Total Cost": 1374.24,
                        "Plan Rows": 68712,
                        "Plan Width": 232,
                        "Actual Startup Time": 11495.324,
                        "Actual Total Time": 11495.645,
                        "Actual Rows": 5328,
                        "Actual Loops": 1,
                        "Output": [
                          "wss.d_week_seq",
                          "wss.ss_store_sk",
                          "wss.sun_sales",
                          "wss.mon_sales",
                          "wss.tue_sales",
                          "wss.wed_sales",
                          "wss.thu_sales",
                          "wss.fri_sales",
                          "wss.sat_sales"
                        ],
                        "Shared Hit Blocks": 4106,
                        "Shared Read Blocks": 86069,
                        "Shared Dirtied Blocks": 0,
                        "Shared Written Blocks": 0,
                        "Local Hit Blocks": 0,
                        "Local Read Blocks": 0,
                        "Local Dirtied Blocks": 0,
                        "Local Written Blocks": 0,
                        "Temp Read Blocks": 456,
                        "Temp Written Blocks": 3069
                      },
                      {
                        "Node Type": "Hash",
                        "Parent Relationship": "Inner",
                        "Parallel Aware": false,
                        "Async Capable": false,
                        "Startup Cost": 1702.04,
                        "Total Cost": 1702.04,
                        "Plan Rows": 8,
                        "Plan Width": 249,
                        "Actual Startup Time": 1056.569,
                        "Actual Total Time": 1056.573,
                        "Actual Rows": 5062,
                        "Actual Loops": 1,
                        "Output": [
                          "d.d_week_seq",
                          "wss_1.sun_sales",
                          "wss_1.mon_sales",
                          "wss_1.tue_sales",
                          "wss_1.wed_sales",
                          "wss_1.thu_sales",
                          "wss_1.fri_sales",
                          "wss_1.sat_sales",
                          "wss_1.d_week_seq",
                          "store_1.s_store_id"
                        ],
                        "Hash Buckets": 8192,
                        "Original Hash Buckets": 1024,
                        "Hash Batches": 1,
                        "Original Hash Batches": 1,
                        "Peak Memory Usage": 602,
                        "Shared Hit Blocks": 25,
                        "Shared Read Blocks": 0,
                        "Shared Dirtied Blocks": 0,
                        "Shared Written Blocks": 0,
                        "Local Hit Blocks": 0,
                        "Local Read Blocks": 0,
                        "Local Dirtied Blocks": 0,
                        "Local Written Blocks": 0,
                        "Temp Read Blocks": 2599,
                        "Temp Written Blocks": 0,
                        "Plans": [
                          {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Async Capable": false,
                            "Join Type": "Inner",
                            "Startup Cost": 63.3,
                            "Total Cost": 1702.04,
                            "Plan Rows": 8,
                            "Plan Width": 249,
                            "Actual Startup Time": 747.065,
                            "Actual Total Time": 1055.797,
                            "Actual Rows": 5062,
                            "Actual Loops": 1,
                            "Output": [
                              "d.d_week_seq",
                              "wss_1.sun_sales",
                              "wss_1.mon_sales",
                              "wss_1.tue_sales",
                              "wss_1.wed_sales",
                              "wss_1.thu_sales",
                              "wss_1.fri_sales",
                              "wss_1.sat_sales",
                              "wss_1.d_week_seq",
                              "store_1.s_store_id"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "((wss_1.d_week_seq - 52) = d.d_week_seq)",
                            "Shared Hit Blocks": 25,
                            "Shared Read Blocks": 0,
                            "Shared Dirtied Blocks": 0,
                            "Shared Written Blocks": 0,
                            "Local Hit Blocks": 0,
                            "Local Read Blocks": 0,
                            "Local Dirtied Blocks": 0,
                            "Local Written Blocks": 0,
                            "Temp Read Blocks": 2599,
                            "Temp Written Blocks": 0,
                            "Plans": [
                              {
                                "Node Type": "Hash Join",
                                "Parent Relationship": "Outer",
                                "Parallel Aware": false,
                                "Async Capable": false,
                                "Join Type": "Inner",
                                "Startup Cost": 31.3,
                                "Total Cost": 1665.44,
                                "Plan Rows": 226,
                                "Plan Width": 245,
                                "Actual Startup Time": 746.97,
                                "Actual Total Time": 1055.328,
                                "Actual Rows": 730,
                                "Actual Loops": 1,
                                "Output": [
                                  "wss_1.sun_sales",
                                  "wss_1.mon_sales",
                                  "wss_1.tue_sales",
                                  "wss_1.wed_sales",
                                  "wss_1.thu_sales",
                                  "wss_1.fri_sales",
                                  "wss_1.sat_sales",
                                  "wss_1.d_week_seq",
                                  "store_1.s_store_id"
                                ],
                                "Inner Unique": false,
                                "Hash Cond": "(wss_1.d_week_seq = d_1.d_week_seq)",
                                "Shared Hit Blocks": 14,
                                "Shared Read Blocks": 0,
                                "Shared Dirtied Blocks": 0,
                                "Shared Written Blocks": 0,
                                "Local Hit Blocks": 0,
                                "Local Read Blocks": 0,
                                "Local Dirtied Blocks": 0,
                                "Local Written Blocks": 0,
                                "Temp Read Blocks": 2599,
                                "Temp Written Blocks": 0,
                                "Plans": [
                                  {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Async Capable": false,
                                    "Join Type": "Inner",
                                    "Startup Cost": 4.28,
                                    "Total Cost": 1562.71,
                                    "Plan Rows": 6528,
                                    "Plan Width": 245,
                                    "Actual Startup Time": 0.743,
                                    "Actual Total Time": 1054.983,
                                    "Actual Rows": 592,
                                    "Actual Loops": 1,
                                    "Output": [
                                      "wss_1.sun_sales",
                                      "wss_1.mon_sales",
                                      "wss_1.tue_sales",
                                      "wss_1.wed_sales",
                                      "wss_1.thu_sales",
                                      "wss_1.fri_sales",
                                      "wss_1.sat_sales",
                                      "wss_1.d_week_seq",
                                      "store_1.s_store_id"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(wss_1.ss_store_sk = store_1.s_store_sk)",
                                    "Shared Hit Blocks": 3,
                                    "Shared Read Blocks": 0,
                                    "Shared Dirtied Blocks": 0,
                                    "Shared Written Blocks": 0,
                                    "Local Hit Blocks": 0,
                                    "Local Read Blocks": 0,
                                    "Local Dirtied Blocks": 0,
                                    "Local Written Blocks": 0,
                                    "Temp Read Blocks": 2599,
                                    "Temp Written Blocks": 0,
                                    "Plans": [
                                      {
                                        "Node Type": "CTE Scan",
                                        "Parent Relationship": "Outer",
                                        "Parallel Aware": false,
                                        "Async Capable": false,
                                        "CTE Name": "wss",
                                        "Alias": "wss_1",
                                        "Startup Cost": 0.0,
                                        "Total Cost": 1374.24,
                                        "Plan Rows": 68712,
                                        "Plan Width": 232,
                                        "Actual Startup Time": 0.001,
                                        "Actual Total Time": 1053.494,
                                        "Actual Rows": 5328,
                                        "Actual Loops": 1,
                                        "Output": [
                                          "wss_1.d_week_seq",
                                          "wss_1.ss_store_sk",
                                          "wss_1.sun_sales",
                                          "wss_1.mon_sales",
                                          "wss_1.tue_sales",
                                          "wss_1.wed_sales",
                                          "wss_1.thu_sales",
                                          "wss_1.fri_sales",
                                          "wss_1.sat_sales"
                                        ],
                                        "Shared Hit Blocks": 0,
                                        "Shared Read Blocks": 0,
                                        "Shared Dirtied Blocks": 0,
                                        "Shared Written Blocks": 0,
                                        "Local Hit Blocks": 0,
                                        "Local Read Blocks": 0,
                                        "Local Dirtied Blocks": 0,
                                        "Local Written Blocks": 0,
                                        "Temp Read Blocks": 2599,
                                        "Temp Written Blocks": 0
                                      },
                                      {
                                        "Node Type": "Hash",
                                        "Parent Relationship": "Inner",
                                        "Parallel Aware": false,
                                        "Async Capable": false,
                                        "Startup Cost": 4.04,
                                        "Total Cost": 4.04,
                                        "Plan Rows": 19,
                                        "Plan Width": 21,
                                        "Actual Startup Time": 0.027,
                                        "Actual Total Time": 0.028,
                                        "Actual Rows": 17,
                                        "Actual Loops": 1,
                                        "Output": [
                                          "store_1.s_store_sk",
                                          "store_1.s_store_id"
                                        ],
                                        "Hash Buckets": 1024,
                                        "Original Hash Buckets": 1024,
                                        "Hash Batches": 1,
                                        "Original Hash Batches": 1,
                                        "Peak Memory Usage": 9,
                                        "Shared Hit Blocks": 3,
                                        "Shared Read Blocks": 0,
                                        "Shared Dirtied Blocks": 0,
                                        "Shared Written Blocks": 0,
                                        "Local Hit Blocks": 0,
                                        "Local Read Blocks": 0,
                                        "Local Dirtied Blocks": 0,
                                        "Local Written Blocks": 0,
                                        "Temp Read Blocks": 0,
                                        "Temp Written Blocks": 0,
                                        "Plans": [
                                          {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Async Capable": false,
                                            "Relation Name": "store",
                                            "Schema": "public",
                                            "Alias": "store_1",
                                            "Startup Cost": 0.0,
                                            "Total Cost": 4.04,
                                            "Plan Rows": 19,
                                            "Plan Width": 21,
                                            "Actual Startup Time": 0.011,
                                            "Actual Total Time": 0.024,
                                            "Actual Rows": 17,
                                            "Actual Loops": 1,
                                            "Output": [
                                              "store_1.s_store_sk",
                                              "store_1.s_store_id"
                                            ],
                                            "Filter": "(store_1.s_state = ANY ('{GA,IA,LA,MO,SD,TN,TX,VA}'::bpchar[]))",
                                            "Rows Removed by Filter": 35,
                                            "Shared Hit Blocks": 3,
                                            "Shared Read Blocks": 0,
                                            "Shared Dirtied Blocks": 0,
                                            "Shared Written Blocks": 0,
                                            "Local Hit Blocks": 0,
                                            "Local Read Blocks": 0,
                                            "Local Dirtied Blocks": 0,
                                            "Local Written Blocks": 0,
                                            "Temp Read Blocks": 0,
                                            "Temp Written Blocks": 0
                                          }
                                        ]
                                      }
                                    ]
                                  },
                                  {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Async Capable": false,
                                    "Startup Cost": 22.51,
                                    "Total Cost": 22.51,
                                    "Plan Rows": 361,
                                    "Plan Width": 4,
                                    "Actual Startup Time": 0.067,
                                    "Actual Total Time": 0.068,
                                    "Actual Rows": 365,
                                    "Actual Loops": 1,
                                    "Output": [
                                      "d_1.d_week_seq"
                                    ],
                                    "Hash Buckets": 1024,
                                    "Original Hash Buckets": 1024,
                                    "Hash Batches": 1,
                                    "Original Hash Batches": 1,
                                    "Peak Memory Usage": 21,
                                    "Shared Hit Blocks": 11,
                                    "Shared Read Blocks": 0,
                                    "Shared Dirtied Blocks": 0,
                                    "Shared Written Blocks": 0,
                                    "Local Hit Blocks": 0,
                                    "Local Read Blocks": 0,
                                    "Local Dirtied Blocks": 0,
                                    "Local Written Blocks": 0,
                                    "Temp Read Blocks": 0,
                                    "Temp Written Blocks": 0,
                                    "Plans": [
                                      {
                                        "Node Type": "Index Scan",
                                        "Parent Relationship": "Outer",
                                        "Parallel Aware": false,
                                        "Async Capable": false,
                                        "Scan Direction": "Forward",
                                        "Index Name": "_dta_index_date_dim_6_661577395__k4_1",
                                        "Relation Name": "date_dim",
                                        "Schema": "public",
                                        "Alias": "d_1",
                                        "Startup Cost": 0.29,
                                        "Total Cost": 22.51,
                                        "Plan Rows": 361,
                                        "Plan Width": 4,
                                        "Actual Startup Time": 0.008,
                                        "Actual Total Time": 0.044,
                                        "Actual Rows": 365,
                                        "Actual Loops": 1,
                                        "Output": [
                                          "d_1.d_week_seq"
                                        ],
                                        "Index Cond": "((d_1.d_month_seq >= 1220) AND (d_1.d_month_seq <= 1231))",
                                        "Rows Removed by Index Recheck": 0,
                                        "Shared Hit Blocks": 11,
                                        "Shared Read Blocks": 0,
                                        "Shared Dirtied Blocks": 0,
                                        "Shared Written Blocks": 0,
                                        "Local Hit Blocks": 0,
                                        "Local Read Blocks": 0,
                                        "Local Dirtied Blocks": 0,
                                        "Local Written Blocks": 0,
                                        "Temp Read Blocks": 0,
                                        "Temp Written Blocks": 0
                                      }
                                    ]
                                  }
                                ]
                              },
                              {
                                "Node Type": "Hash",
                                "Parent Relationship": "Inner",
                                "Parallel Aware": false,
                                "Async Capable": false,
                                "Startup Cost": 27.11,
                                "Total Cost": 27.11,
                                "Plan Rows": 391,
                                "Plan Width": 4,
                                "Actual Startup Time": 0.087,
                                "Actual Total Time": 0.088,
                                "Actual Rows": 365,
                                "Actual Loops": 1,
                                "Output": [
                                  "d.d_week_seq"
                                ],
                                "Hash Buckets": 1024,
                                "Original Hash Buckets": 1024,
                                "Hash Batches": 1,
                                "Original Hash Batches": 1,
                                "Peak Memory Usage": 21,
                                "Shared Hit Blocks": 11,
                                "Shared Read Blocks": 0,
                                "Shared Dirtied Blocks": 0,
                                "Shared Written Blocks": 0,
                                "Local Hit Blocks": 0,
                                "Local Read Blocks": 0,
                                "Local Dirtied Blocks": 0,
                                "Local Written Blocks": 0,
                                "Temp Read Blocks": 0,
                                "Temp Written Blocks": 0,
                                "Plans": [
                                  {
                                    "Node Type": "Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Async Capable": false,
                                    "Scan Direction": "Forward",
                                    "Index Name": "_dta_index_date_dim_6_661577395__k4_1",
                                    "Relation Name": "date_dim",
                                    "Schema": "public",
                                    "Alias": "d",
                                    "Startup Cost": 0.29,
                                    "Total Cost": 27.11,
                                    "Plan Rows": 391,
                                    "Plan Width": 4,
                                    "Actual Startup Time": 0.026,
                                    "Actual Total Time": 0.063,
                                    "Actual Rows": 365,
                                    "Actual Loops": 1,
                                    "Output": [
                                      "d.d_week_seq"
                                    ],
                                    "Index Cond": "((d.d_month_seq >= 1208) AND (d.d_month_seq <= 1219))",
                                    "Rows Removed by Index Recheck": 0,
                                    "Shared Hit Blocks": 11,
                                    "Shared Read Blocks": 0,
                                    "Shared Dirtied Blocks": 0,
                                    "Shared Written Blocks": 0,
                                    "Local Hit Blocks": 0,
                                    "Local Read Blocks": 0,
                                    "Local Dirtied Blocks": 0,
                                    "Local Written Blocks": 0,
                                    "Temp Read Blocks": 0,
                                    "Temp Written Blocks": 0
                                  }
                                ]
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "Node Type": "Index Scan",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Async Capable": false,
                    "Scan Direction": "Forward",
                    "Index Name": "_dta_index_store_6_885578193__k1_2_6",
                    "Relation Name": "store",
                    "Schema": "public",
                    "Alias": "store",
                    "Startup Cost": 0.14,
                    "Total Cost": 0.17,
                    "Plan Rows": 1,
                    "Plan Width": 26,
                    "Actual Startup Time": 0.001,
                    "Actual Total Time": 0.001,
                    "Actual Rows": 0,
                    "Actual Loops": 91116,
                    "Output": [
                      "store.s_store_sk",
                      "store.s_store_id",
                      "store.s_rec_start_date",
                      "store.s_rec_end_date",
                      "store.s_closed_date_sk",
                      "store.s_store_name",
                      "store.s_number_employees",
                      "store.s_floor_space",
                      "store.s_hours",
                      "store.s_manager",
                      "store.s_market_id",
                      "store.s_geography_class",
                      "store.s_market_desc",
                      "store.s_market_manager",
                      "store.s_division_id",
                      "store.s_division_name",
                      "store.s_company_id",
                      "store.s_company_name",
                      "store.s_street_number",
                      "store.s_street_name",
                      "store.s_street_type",
                      "store.s_suite_number",
                      "store.s_city",
                      "store.s_county",
                      "store.s_state",
                      "store.s_zip",
                      "store.s_country",
                      "store.s_gmt_offset",
                      "store.s_tax_precentage"
                    ],
                    "Index Cond": "(store.s_store_sk = wss.ss_store_sk)",
                    "Rows Removed by Index Recheck": 0,
                    "Filter": "(store.s_state = ANY ('{GA,IA,LA,MO,SD,TN,TX,VA}'::bpchar[]))",
                    "Rows Removed by Filter": 1,
                    "Shared Hit Blocks": 172108,
                    "Shared Read Blocks": 0,
                    "Shared Dirtied Blocks": 0,
                    "Shared Written Blocks": 0,
                    "Local Hit Blocks": 0,
                    "Local Read Blocks": 0,
                    "Local Dirtied Blocks": 0,
                    "Local Written Blocks": 0,
                    "Temp Read Blocks": 0,
                    "Temp Written Blocks": 0
                  }
                ]
              }
            ]
          }
        ]
      },
      "Planning": {
        "Shared Hit Blocks": 10,
        "Shared Read Blocks": 0,
        "Shared Dirtied Blocks": 0,
        "Shared Written Blocks": 0,
        "Local Hit Blocks": 0,
        "Local Read Blocks": 0,
        "Local Dirtied Blocks": 0,
        "Local Written Blocks": 0,
        "Temp Read Blocks": 0,
        "Temp Written Blocks": 0
      },
      "Planning Time": 0.746,
      "Triggers": [],
      "JIT": {
        "Functions": 93,
        "Options": {
          "Inlining": false,
          "Optimization": false,
          "Expressions": true,
          "Deforming": true
        },
        "Timing": {
          "Generation": 3.384,
          "Inlining": 0.0,
          "Optimization": 2.224,
          "Emission": 42.164,
          "Total": 47.772
        }
      },
      "Execution Time": 12667.591
    }
  ],
  "plan_text": "Limit  (cost=397783.59..397783.60 rows=1 width=250) (actual time=15836.351..15836.428 rows=100 loops=1)\n  Output: store.s_store_name, store.s_store_id, wss.d_week_seq, ((wss.sun_sales / wss_1.sun_sales)), ((wss.mon_sales / wss_1.mon_sales)), ((wss.tue_sales / wss_1.tue_sales)), ((wss.wed_sales / wss_1.wed_sales)), ((wss.thu_sales / wss_1.thu_sales)), ((wss.fri_sales / wss_1.fri_sales)), ((wss.sat_sales / wss_1.sat_sales))\n  Buffers: shared hit=184355 read=257106, temp read=9122 written=9161\n  CTE wss\n    ->  GroupAggregate  (cost=381798.19..394438.89 rows=68712 width=232) (actual time=14684.741..15728.805 rows=5328 loops=1)\n          Output: date_dim.d_week_seq, store_sales.ss_store_sk, sum(CASE WHEN (date_dim.d_day_name = 'Sunday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END), sum(CASE WHEN (date_dim.d_day_name = 'Monday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END), sum(CASE WHEN (date_dim.d_day_name = 'Tuesday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END), sum(CASE WHEN (date_dim.d_day_name = 'Wednesday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END), sum(CASE WHEN (date_dim.d_day_name = 'Thursday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END), sum(CASE WHEN (date_dim.d_day_name = 'Friday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END), sum(CASE WHEN (date_dim.d_day_name = 'Saturday'::bpchar) THEN store_sales.ss_sales_price ELSE NULL::numeric END)\n          Group Key: date_dim.d_week_seq, store_sales.ss_store_sk\n          Buffers: shared hit=12226 read=257102, temp read=9122 written=9161\n          ->  Gather Merge  (cost=381798.19..389800.83 rows=68712 width=24) (actual time=14684.659..15319.451 rows=2138505 loops=1)\n                Output: date_dim.d_week_seq, store_sales.ss_store_sk, date_dim.d_day_name, store_sales.ss_sales_price\n                Workers Planned: 2\n                Workers Launched: 2\n                Buffers: shared hit=12226 read=257102, temp read=9122 written=9161\n                ->  Sort  (cost=380798.16..380869.74 rows=28630 width=24) (actual time=14655.820..14891.202 rows=712835 loops=3)\n                      Output: date_dim.d_week_seq, store_sales.ss_store_sk, date_dim.d_day_name, store_sales.ss_sales_price\n                      Sort Key: date_dim.d_week_seq, store_sales.ss_store_sk\n                      Sort Method: external merge  Disk: 24376kB\n                      Buffers: shared hit=12226 read=257102, temp read=9122 written=9161\n                      Worker 0:  actual time=14651.118..14892.476 rows=711624 loops=1\n                        Sort Method: external merge  Disk: 24280kB\n                        JIT:\n                          Functions: 13\n                          Options: Inlining false, Optimization false, Expressions true, Deforming true\n                          Timing: Generation 5.201 ms, Inlining 0.000 ms, Optimization 0.433 ms, Emission 7.678 ms, Total 13.312 ms\n                        Buffers: shared hit=4107 read=85621, temp read=3035 written=3048\n                      Worker 1:  actual time=14651.488..14892.359 rows=712779 loops=1\n                        Sort Method: external merge  Disk: 24320kB\n                        JIT:\n                          Functions: 13\n                          Options: Inlining false, Optimization false, Expressions true, Deforming true\n                          Timing: Generation 5.336 ms, Inlining 0.000 ms, Optimization 0.534 ms, Emission 9.530 ms, Total 15.400 ms\n                        Buffers: shared hit=4068 read=85758, temp read=3040 written=3053\n                      ->  Nested Loop  (cost=0.30..378678.79 rows=28630 width=24) (actual time=6.976..14041.402 rows=712835 loops=3)\n                            Output: date_dim.d_week_seq, store_sales.ss_store_sk, date_dim.d_day_name, store_sales.ss_sales_price\n                            Inner Unique: true\n                            Buffers: shared hit=12212 read=257102\n                            Worker 0:  actual time=9.098..14026.894 rows=711624 loops=1\n                              Buffers: shared hit=4100 read=85621\n                            Worker 1:  actual time=10.553..14044.340 rows=712779 loops=1\n                              Buffers: shared hit=4061 read=85758\n                            ->  Parallel Seq Scan on public.store_sales  (cost=0.00..377103.70 rows=30002 width=14) (actual time=6.678..13705.495 rows=721567 loops=3)\n                                  Output: store_sales.ss_sold_date_sk, store_sales.ss_sold_time_sk, store_sales.ss_item_sk, store_sales.ss_customer_sk, store_sales.ss_cdemo_sk, store_sales.ss_hdemo_sk, store_sales.ss_addr_sk, store_sales.ss_store_sk, store_sales.ss_promo_sk, store_sales.ss_ticket_number, store_sales.ss_quantity, store_sales.ss_wholesale_cost, store_sales.ss_list_price, store_sales.ss_sales_price, store_sales.ss_ext_discount_amt, store_sales.ss_ext_sales_price, store_sales.ss_ext_wholesale_cost, store_sales.ss_ext_list_price, store_sales.ss_ext_tax, store_sales.ss_coupon_amt, store_sales.ss_net_paid, store_sales.ss_net_paid_inc_tax, store_sales.ss_net_profit\n                                  Filter: (((store_sales.ss_sales_price / store_sales.ss_list_price) >= 0.11) AND ((store_sales.ss_sales_price / store_sales.ss_list_price) <= 0.31))\n                                  Rows Removed by Filter: 4078450\n                                  Buffers: shared read=257096\n                                  Worker 0:  actual time=8.533..13692.351 rows=720237 loops=1\n                                    Buffers: shared read=85619\n                                  Worker 1:  actual time=10.504..13714.463 rows=721497 loops=1\n                                    Buffers: shared read=85756\n                            ->  Memoize  (cost=0.30..0.41 rows=1 width=18) (actual time=0.000..0.000 rows=1 loops=2164701)\n                                  Output: date_dim.d_week_seq, date_dim.d_day_name, date_dim.d_date_sk\n                                  Cache Key: store_sales.ss_sold_date_sk\n                                  Cache Mode: logical\n                                  Hits: 721615  Misses: 1352  Evictions: 0  Overflows: 0  Memory Usage: 159kB\n                                  Buffers: shared hit=12212 read=6\n                                  Worker 0:  actual time=0.000..0.000 rows=1 loops=720237\n                                    Hits: 718869  Misses: 1368  Evictions: 0  Overflows: 0  Memory Usage: 161kB\n                                    Buffers: shared hit=4100 read=2\n                                  Worker 1:  actual time=0.000..0.000 rows=1 loops=721497\n                                    Hits: 720142  Misses: 1355  Evictions: 0  Overflows: 0  Memory Usage: 159kB\n                                    Buffers: shared hit=4061 read=2\n                                  ->  Index Scan using date_dim_pkey on public.date_dim  (cost=0.29..0.40 rows=1 width=18) (actual time=0.007..0.007 rows=1 loops=4075)\n                                        Output: date_dim.d_week_seq, date_dim.d_day_name, date_dim.d_date_sk\n                                        Index Cond: (date_dim.d_date_sk = store_sales.ss_sold_date_sk)\n                                        Buffers: shared hit=12212 read=6\n                                        Worker 0:  actual time=0.007..0.007 rows=1 loops=1368\n                                          Buffers: shared hit=4100 read=2\n                                        Worker 1:  actual time=0.007..0.007 rows=1 loops=1355\n                                          Buffers: shared hit=4061 read=2\n  ->  Sort  (cost=3344.70..3344.71 rows=1 width=250) (actual time=15808.678..15808.688 rows=100 loops=1)\n        Output: store.s_store_name, store.s_store_id, wss.d_week_seq, ((wss.sun_sales / wss_1.sun_sales)), ((wss.mon_sales / wss_1.mon_sales)), ((wss.tue_sales / wss_1.tue_sales)), ((wss.wed_sales / wss_1.wed_sales)), ((wss.thu_sales / wss_1.thu_sales)), ((wss.fri_sales / wss_1.fri_sales)), ((wss.sat_sales / wss_1.sat_sales))\n        Sort Key: store.s_store_name, store.s_store_id, wss.d_week_seq\n        Sort Method: top-N heapsort  Memory: 64kB\n        Buffers: shared hit=176180 read=85727, temp read=3047 written=3060\n        ->  Nested Loop  (cost=1702.28..3344.69 rows=1 width=250) (actual time=15736.207..15807.580 rows=5062 loops=1)\n              Output: store.s_store_name, store.s_store_id, wss.d_week_seq, (wss.sun_sales / wss_1.sun_sales), (wss.mon_sales / wss_1.mon_sales), (wss.tue_sales / wss_1.tue_sales), (wss.wed_sales / wss_1.wed_sales), (wss.thu_sales / wss_1.thu_sales), (wss.fri_sales / wss_1.fri_sales), (wss.sat_sales / wss_1.sat_sales)\n              Inner Unique: true\n              Join Filter: (store.s_store_id = store_1.s_store_id)\n              Rows Removed by Join Filter: 5062\n              Buffers: shared hit=176180 read=85727, temp read=3047 written=3060\n              ->  Hash Join  (cost=1702.14..3334.58 rows=56 width=473) (actual time=15736.029..15744.787 rows=91116 loops=1)\n                    Output: wss.d_week_seq, wss.sun_sales, wss.mon_sales, wss.tue_sales, wss.wed_sales, wss.thu_sales, wss.fri_sales, wss.sat_sales, wss.ss_store_sk, wss_1.sun_sales, wss_1.mon_sales, wss_1.tue_sales, wss_1.wed_sales, wss_1.thu_sales, wss_1.fri_sales, wss_1.sat_sales, store_1.s_store_id\n                    Hash Cond: (wss.d_week_seq = d.d_week_seq)\n                    Buffers: shared hit=4072 read=85727, temp read=3047 written=3060\n                    ->  CTE Scan on wss  (cost=0.00..1374.24 rows=68712 width=232) (actual time=14684.746..14685.012 rows=5328 loops=1)\n                          Output: wss.d_week_seq, wss.ss_store_sk, wss.sun_sales, wss.mon_sales, wss.tue_sales, wss.wed_sales, wss.thu_sales, wss.fri_sales, wss.sat_sales\n                          Buffers: shared hit=4051 read=85723, temp read=490 written=3060\n                    ->  Hash  (cost=1702.04..1702.04 rows=8 width=249) (actual time=1051.043..1051.047 rows=5062 loops=1)\n                          Output: d.d_week_seq, wss_1.sun_sales, wss_1.mon_sales, wss_1.tue_sales, wss_1.wed_sales, wss_1.thu_sales, wss_1.fri_sales, wss_1.sat_sales, wss_1.d_week_seq, store_1.s_store_id\n                          Buckets: 8192 (originally 1024)  Batches: 1 (originally 1)  Memory Usage: 602kB\n                          Buffers: shared hit=21 read=4, temp read=2557\n                          ->  Hash Join  (cost=63.30..1702.04 rows=8 width=249) (actual time=732.781..1050.277 rows=5062 loops=1)\n                                Output: d.d_week_seq, wss_1.sun_sales, wss_1.mon_sales, wss_1.tue_sales, wss_1.wed_sales, wss_1.thu_sales, wss_1.fri_sales, wss_1.sat_sales, wss_1.d_week_seq, store_1.s_store_id\n                                Hash Cond: ((wss_1.d_week_seq - 52) = d.d_week_seq)\n                                Buffers: shared hit=21 read=4, temp read=2557\n                                ->  Hash Join  (cost=31.30..1665.44 rows=226 width=245) (actual time=731.839..1048.974 rows=730 loops=1)\n                                      Output: wss_1.sun_sales, wss_1.mon_sales, wss_1.tue_sales, wss_1.wed_sales, wss_1.thu_sales, wss_1.fri_sales, wss_1.sat_sales, wss_1.d_week_seq, store_1.s_store_id\n                                      Hash Cond: (wss_1.d_week_seq = d_1.d_week_seq)\n                                      Buffers: shared hit=13 read=1, temp read=2557\n                                      ->  Hash Join  (cost=4.28..1562.71 rows=6528 width=245) (actual time=0.789..1048.339 rows=592 loops=1)\n                                            Output: wss_1.sun_sales, wss_1.mon_sales, wss_1.tue_sales, wss_1.wed_sales, wss_1.thu_sales, wss_1.fri_sales, wss_1.sat_sales, wss_1.d_week_seq, store_1.s_store_id\n                                            Inner Unique: true\n                                            Hash Cond: (wss_1.ss_store_sk = store_1.s_store_sk)\n                                            Buffers: shared hit=3, temp read=2557\n                                            ->  CTE Scan on wss wss_1  (cost=0.00..1374.24 rows=68712 width=232) (actual time=0.001..1046.793 rows=5328 loops=1)\n                                                  Output: wss_1.d_week_seq, wss_1.ss_store_sk, wss_1.sun_sales, wss_1.mon_sales, wss_1.tue_sales, wss_1.wed_sales, wss_1.thu_sales, wss_1.fri_sales, wss_1.sat_sales\n                                                  Buffers: temp read=2557\n                                            ->  Hash  (cost=4.04..4.04 rows=19 width=21) (actual time=0.031..0.032 rows=17 loops=1)\n                                                  Output: store_1.s_store_sk, store_1.s_store_id\n                                                  Buckets: 1024  Batches: 1  Memory Usage: 9kB\n                                                  Buffers: shared hit=3\n                                                  ->  Seq Scan on public.store store_1  (cost=0.00..4.04 rows=19 width=21) (actual time=0.015..0.028 rows=17 loops=1)\n                                                        Output: store_1.s_store_sk, store_1.s_store_id\n                                                        Filter: (store_1.s_state = ANY ('{GA,IA,LA,MO,SD,TN,TX,VA}'::bpchar[]))\n                                                        Rows Removed by Filter: 35\n                                                        Buffers: shared hit=3\n                                      ->  Hash  (cost=22.51..22.51 rows=361 width=4) (actual time=0.340..0.341 rows=365 loops=1)\n                                            Output: d_1.d_week_seq\n                                            Buckets: 1024  Batches: 1  Memory Usage: 21kB\n                                            Buffers: shared hit=10 read=1\n                                            ->  Index Scan using _dta_index_date_dim_6_661577395__k4_1 on public.date_dim d_1  (cost=0.29..22.51 rows=361 width=4) (actual time=0.012..0.307 rows=365 loops=1)\n                                                  Output: d_1.d_week_seq\n                                                  Index Cond: ((d_1.d_month_seq >= 1220) AND (d_1.d_month_seq <= 1231))\n                                                  Buffers: shared hit=10 read=1\n                                ->  Hash  (cost=27.11..27.11 rows=391 width=4) (actual time=0.934..0.934 rows=365 loops=1)\n                                      Output: d.d_week_seq\n                                      Buckets: 1024  Batches: 1  Memory Usage: 21kB\n                                      Buffers: shared hit=8 read=3\n                                      ->  Index Scan using _dta_index_date_dim_6_661577395__k4_1 on public.date_dim d  (cost=0.29..27.11 rows=391 width=4) (actual time=0.673..0.907 rows=365 loops=1)\n                                            Output: d.d_week_seq\n                                            Index Cond: ((d.d_month_seq >= 1208) AND (d.d_month_seq <= 1219))\n                                            Buffers: shared hit=8 read=3\n              ->  Index Scan using _dta_index_store_6_885578193__k1_2_6 on public.store  (cost=0.14..0.17 rows=1 width=26) (actual time=0.001..0.001 rows=0 loops=91116)\n                    Output: store.s_store_sk, store.s_store_id, store.s_rec_start_date, store.s_rec_end_date, store.s_closed_date_sk, store.s_store_name, store.s_number_employees, store.s_floor_space, store.s_hours, store.s_manager, store.s_market_id, store.s_geography_class, store.s_market_desc, store.s_market_manager, store.s_division_id, store.s_division_name, store.s_company_id, store.s_company_name, store.s_street_number, store.s_street_name, store.s_street_type, store.s_suite_number, store.s_city, store.s_county, store.s_state, store.s_zip, store.s_country, store.s_gmt_offset, store.s_tax_precentage\n                    Index Cond: (store.s_store_sk = wss.ss_store_sk)\n                    Filter: (store.s_state = ANY ('{GA,IA,LA,MO,SD,TN,TX,VA}'::bpchar[]))\n                    Rows Removed by Filter: 1\n                    Buffers: shared hit=172108\nPlanning:\n  Buffers: shared hit=10 read=3\nPlanning Time: 1.157 ms\nJIT:\n  Functions: 93\n  Options: Inlining false, Optimization false, Expressions true, Deforming true\n  Timing: Generation 12.930 ms, Inlining 0.000 ms, Optimization 2.289 ms, Emission 43.713 ms, Total 58.932 ms\nExecution Time: 15845.323 ms",
  "original_sql": "with wss as\n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n and ss_sales_price / ss_list_price BETWEEN 11 * 0.01 AND 31 * 0.01\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and\n        d_month_seq between 1208 and 1208 + 11\n        and s_state in ('GA','IA','LA'\n                    ,'MO','SD','TN','TX','VA')\n        ) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and\n        d_month_seq between 1208+ 12 and 1208 + 23\n        and s_state in ('GA','IA','LA'\n                    ,'MO','SD','TN','TX','VA')) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\nlimit 100"
}