{
  "id": "AGGREGATE_PUSH_BELOW_JOIN",
  "name": "Aggregate Push Below Join",
  "description": "Push aggregation below join when only aggregated values are needed\n      from one side, reducing join cardinality.",
  "category": "aggregation_optimization",
  "priority": "medium",
  "verified_speedup": "unknown",
  "example": {
    "before_sql": "SELECT c.region, SUM(o.amount)\n      FROM customers c\n      JOIN orders o ON c.id = o.customer_id\n      GROUP BY c.region;",
    "after_sql": "SELECT c.region, pre_agg.total_amount\n      FROM customers c\n      JOIN (\n          SELECT customer_id, SUM(amount) as total_amount\n          FROM orders GROUP BY customer_id\n      ) pre_agg ON c.id = pre_agg.customer_id\n      GROUP BY c.region;\n      -- May not always be faster; test with EXPLAIN ANALYZE\n\n  # ============================================================================\n  # PREDICATE REWRITES\n  # ============================================================================",
    "alternative_sql": "",
    "key_insight": "Join followed by aggregation where one side contributes only to\n      aggregate, not to grouping.",
    "transforms": [
      "aggregate_push_below_join"
    ]
  },
  "metadata": {
    "pg_version": "All",
    "auto_applied_by_pg": "false",
    "research_source": "",
    "notes": ""
  }
}