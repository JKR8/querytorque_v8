```sql
WITH sales_combined AS (
  SELECT
    ca_county,
    d_qoy,
    d_year,
    'store' AS channel,
    SUM(ss_ext_sales_price) AS sales
  FROM store_sales
  JOIN date_dim ON ss_sold_date_sk = d_date_sk
  JOIN customer_address ON ss_addr_sk = ca_address_sk
  JOIN item ON ss_item_sk = i_item_sk
  WHERE i_color IN ('blanched', 'rosy')
    AND i_manager_id BETWEEN 16 AND 35
    AND ss_list_price BETWEEN 286 AND 300
    AND ca_state IN ('TX', 'VA')
  GROUP BY ca_county, d_qoy, d_year
  
  UNION ALL
  
  SELECT
    ca_county,
    d_qoy,
    d_year,
    'web' AS channel,
    SUM(ws_ext_sales_price) AS sales
  FROM web_sales
  JOIN date_dim ON ws_sold_date_sk = d_date_sk
  JOIN customer_address ON ws_bill_addr_sk = ca_address_sk
  JOIN item ON ws_item_sk = i_item_sk
  WHERE i_color IN ('blanched', 'rosy')
    AND i_manager_id BETWEEN 16 AND 35
    AND ws_list_price BETWEEN 286 AND 300
    AND ca_state IN ('TX', 'VA')
  GROUP BY ca_county, d_qoy, d_year
),
pivoted AS (
  SELECT
    ca_county,
    d_year,
    MAX(CASE WHEN channel = 'web' AND d_qoy = 1 THEN sales END) AS web_q1,
    MAX(CASE WHEN channel = 'web' AND d_qoy = 2 THEN sales END) AS web_q2,
    MAX(CASE WHEN channel = 'web' AND d_qoy = 3 THEN sales END) AS web_q3,
    MAX(CASE WHEN channel = 'store' AND d_qoy = 1 THEN sales END) AS store_q1,
    MAX(CASE WHEN channel = 'store' AND d_qoy = 2 THEN sales END) AS store_q2,
    MAX(CASE WHEN channel = 'store' AND d_qoy = 3 THEN sales END) AS store_q3
  FROM sales_combined
  WHERE d_year = 1998
    AND d_qoy IN (1, 2, 3)
  GROUP BY ca_county, d_year
  HAVING COUNT(DISTINCT d_qoy) = 3
    AND COUNT(DISTINCT channel) = 2
)
SELECT
  ca_county,
  d_year,
  CASE WHEN web_q1 > 0 THEN web_q2 / web_q1 ELSE NULL END AS web_q1_q2_increase,
  CASE WHEN store_q1 > 0 THEN store_q2 / store_q1 ELSE NULL END AS store_q1_q2_increase,
  CASE WHEN web_q2 > 0 THEN web_q3 / web_q2 ELSE NULL END AS web_q2_q3_increase,
  CASE WHEN store_q2 > 0 THEN store_q3 / store_q2 ELSE NULL END AS store_q2_q3_increase
FROM pivoted
WHERE CASE WHEN web_q1 > 0 THEN web_q2 / web_q1 ELSE NULL END > CASE WHEN store_q1 > 0 THEN store_q2 / store_q1 ELSE NULL END
  AND CASE WHEN web_q2 > 0 THEN web_q3 / web_q2 ELSE NULL END > CASE WHEN store_q2 > 0 THEN store_q3 / store_q2 ELSE NULL END
ORDER BY web_q1_q2_increase;
```

**Changes**: Combined store and web sales into a single CTE with channel identification, used conditional aggregation to pivot quarters, and computed ratios in the main query—eliminating all six self-joins while preserving exact semantics.

**Expected speedup**: 3-4× due to single scan of each fact table instead of six CTE materializations and self-joins.