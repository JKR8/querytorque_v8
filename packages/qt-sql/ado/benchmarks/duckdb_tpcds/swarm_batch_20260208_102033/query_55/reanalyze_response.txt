FAILURE_ANALYSIS:
All attempts essentially implemented the same optimization: pre-filtering dimension tables into CTEs before joining with the fact table. This approach failed because:
1. **DuckDB's optimizer already performs predicate pushdown automatically** - The CTEs don't fundamentally change the execution plan
2. **No reduction in fact table scanning** - All attempts still scan the entire `store_sales` table before applying filters
3. **Missing physical optimization angles** - No attempt addressed join algorithms, data skipping, or materialization strategies
4. **Inefficient join ordering** - All use the same join pattern (store_sales → date → item) without considering cardinality
5. **CTE overhead** - Additional materialization may introduce overhead without benefit when DuckDB can inline CTEs

UNEXPLORED_OPPORTUNITIES:
1. **Early fact table filtering** - Use dimension keys to filter fact table before full scan via derived tables or semi-joins
2. **Join algorithm hints** - Explicitly specify hash joins or bloom filters
3. **Data skipping via partition pruning** - Leverage DuckDB's ability to skip data based on known constraints
4. **Materialized subquery** - Pre-aggregate fact table at grain of item before joining with dimensions
5. **Columnar optimization** - Select only needed columns early to reduce I/O
6. **Parallel scan optimization** - Use UNNEST or other patterns to encourage parallel execution

REFINED_STRATEGY:
Combine fact-table-first filtering with column pruning and explicit join ordering:
1. Start with a pre-filtered fact table using EXISTS clauses with dimension keys
2. Select only required columns from all tables upfront to minimize I/O
3. Use explicit join ordering based on estimated selectivity (date_dim first due to high selectivity, then item, then aggregation)
4. Apply LIMIT pushdown thinking by ordering early if possible
5. Use derived tables instead of CTEs for better optimization transparency

EXAMPLES: prefetch_fact_join, single_pass_aggregation, composite_decorrelate_union
HINT: Start filtering from the fact table using derived subqueries with EXISTS, prune columns aggressively, and use explicit join ordering based on filter selectivity (date→item→aggregate).