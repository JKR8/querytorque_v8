```sql
WITH filtered_dates AS (
    SELECT d_date_sk
    FROM date_dim
    WHERE d_date BETWEEN CAST('1998-08-05' AS DATE) AND (
        CAST('1998-08-05' AS DATE) + INTERVAL '30' DAY
    )
),
store_sales_agg AS (
    SELECT
        ss_store_sk AS store_sk,
        SUM(ss_ext_sales_price) AS sales,
        SUM(ss_net_profit) AS profit
    FROM store_sales
    JOIN filtered_dates ON ss_sold_date_sk = d_date_sk
    GROUP BY ss_store_sk
),
store_returns_agg AS (
    SELECT
        sr_store_sk AS store_sk,
        SUM(sr_return_amt) AS returns,
        SUM(sr_net_loss) AS profit_loss
    FROM store_returns
    JOIN filtered_dates ON sr_returned_date_sk = d_date_sk
    GROUP BY sr_store_sk
),
catalog_sales_agg AS (
    SELECT
        cs_call_center_sk AS call_center_sk,
        SUM(cs_ext_sales_price) AS sales,
        SUM(cs_net_profit) AS profit
    FROM catalog_sales
    JOIN filtered_dates ON cs_sold_date_sk = d_date_sk
    GROUP BY cs_call_center_sk
),
catalog_returns_agg AS (
    SELECT
        cr_call_center_sk AS call_center_sk,
        SUM(cr_return_amount) AS returns,
        SUM(cr_net_loss) AS profit_loss
    FROM catalog_returns
    JOIN filtered_dates ON cr_returned_date_sk = d_date_sk
    GROUP BY cr_call_center_sk
),
web_sales_agg AS (
    SELECT
        ws_web_page_sk AS web_page_sk,
        SUM(ws_ext_sales_price) AS sales,
        SUM(ws_net_profit) AS profit
    FROM web_sales
    JOIN filtered_dates ON ws_sold_date_sk = d_date_sk
    GROUP BY ws_web_page_sk
),
web_returns_agg AS (
    SELECT
        wr_web_page_sk AS web_page_sk,
        SUM(wr_return_amt) AS returns,
        SUM(wr_net_loss) AS profit_loss
    FROM web_returns
    JOIN filtered_dates ON wr_returned_date_sk = d_date_sk
    GROUP BY wr_web_page_sk
),
store_channel AS (
    SELECT
        'store channel' AS channel,
        s_store_sk AS id,
        COALESCE(ssa.sales, 0) AS sales,
        COALESCE(sra.returns, 0) AS returns,
        COALESCE(ssa.profit, 0) - COALESCE(sra.profit_loss, 0) AS profit
    FROM store
    LEFT JOIN store_sales_agg ssa ON s_store_sk = ssa.store_sk
    LEFT JOIN store_returns_agg sra ON s_store_sk = sra.store_sk
    WHERE ssa.sales IS NOT NULL OR sra.returns IS NOT NULL
),
catalog_channel AS (
    SELECT
        'catalog channel' AS channel,
        csa.call_center_sk AS id,
        COALESCE(csa.sales, 0) AS sales,
        COALESCE(cra.returns, 0) AS returns,
        COALESCE(csa.profit, 0) - COALESCE(cra.profit_loss, 0) AS profit
    FROM catalog_sales_agg csa
    FULL OUTER JOIN catalog_returns_agg cra
        ON csa.call_center_sk = cra.call_center_sk
    WHERE csa.sales IS NOT NULL OR cra.returns IS NOT NULL
),
web_channel AS (
    SELECT
        'web channel' AS channel,
        wp_web_page_sk AS id,
        COALESCE(wsa.sales, 0) AS sales,
        COALESCE(wra.returns, 0) AS returns,
        COALESCE(wsa.profit, 0) - COALESCE(wra.profit_loss, 0) AS profit
    FROM web_page
    LEFT JOIN web_sales_agg wsa ON wp_web_page_sk = wsa.web_page_sk
    LEFT JOIN web_returns_agg wra ON wp_web_page_sk = wra.web_page_sk
    WHERE wsa.sales IS NOT NULL OR wra.returns IS NOT NULL
),
combined AS (
    SELECT * FROM store_channel
    UNION ALL
    SELECT * FROM catalog_channel
    UNION ALL
    SELECT * FROM web_channel
)
SELECT
    channel,
    id,
    SUM(sales) AS sales,
    SUM(returns) AS returns,
    SUM(profit) AS profit
FROM combined
GROUP BY ROLLUP(channel, id)
ORDER BY channel, id
LIMIT 100
```

**Changes:** 
1. Created a shared `filtered_dates` CTE to eliminate redundant date filtering across all channels.
2. Decomposed each channel into separate pre-aggregated CTEs for sales and returns, then combined them using explicit LEFT/FULL JOINs to preserve semantics.
3. Transformed the final UNION ALL branches into three independent channel CTEs with proper NULL handling, ensuring semantic equivalence while enabling parallel execution.

**Expected speedup:** ~1.5-2x due to reduced date_dim scans, better join patterns, and elimination of redundant computations.