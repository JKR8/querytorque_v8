```sql
WITH filtered_dates AS (
    SELECT d_date_sk
    FROM date_dim
    WHERE d_dow IN (6, 0)
      AND d_year IN (1999, 2000, 2001)
), filtered_stores AS (
    SELECT s_store_sk
    FROM store
    WHERE s_city IN ('Five Points', 'Centerville', 'Oak Grove', 'Fairview', 'Liberty')
), filtered_household_demographics AS (
    SELECT hd_demo_sk
    FROM household_demographics
    WHERE hd_dep_count = 6 OR hd_vehicle_count = 0
), aggregated_sales AS (
    SELECT
        ss_ticket_number,
        ss_customer_sk,
        customer_address.ca_city AS bought_city,
        SUM(ss_coupon_amt) AS amt,
        SUM(ss_net_profit) AS profit
    FROM store_sales
    JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk
    JOIN filtered_stores ON store_sales.ss_store_sk = filtered_stores.s_store_sk
    JOIN filtered_household_demographics ON store_sales.ss_hdemo_sk = filtered_household_demographics.hd_demo_sk
    JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk
    GROUP BY
        ss_ticket_number,
        ss_customer_sk,
        ss_addr_sk,
        customer_address.ca_city
)
SELECT
    customer.c_last_name,
    customer.c_first_name,
    current_addr.ca_city,
    aggregated_sales.bought_city,
    aggregated_sales.ss_ticket_number,
    aggregated_sales.amt,
    aggregated_sales.profit
FROM aggregated_sales
JOIN customer ON aggregated_sales.ss_customer_sk = customer.c_customer_sk
JOIN customer_address AS current_addr ON customer.c_current_addr_sk = current_addr.ca_address_sk
WHERE current_addr.ca_city <> aggregated_sales.bought_city
ORDER BY
    customer.c_last_name,
    customer.c_first_name,
    current_addr.ca_city,
    aggregated_sales.bought_city,
    aggregated_sales.ss_ticket_number
LIMIT 100
```

**Changes**: Isolated filtered dimension tables (date_dim, store, household_demographics) into separate CTEs before joining with store_sales, enabling parallel filtering and predicate pushdown. Converted implicit joins to explicit JOIN syntax.

**Expected speedup**: 1.5-2x due to early dimension filtering and smaller hash tables for fact table joins.