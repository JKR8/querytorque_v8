```sql
WITH ssales_base AS (
  SELECT
    ss_customer_sk,
    ss_store_sk,
    ss_item_sk,
    ss_net_profit
  FROM store_sales
  JOIN store_returns ON ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk
  WHERE ss_store_sk IN (SELECT s_store_sk FROM store WHERE s_market_id = 8)
),
ssales AS (
  SELECT
    c.c_last_name,
    c.c_first_name,
    s.s_store_name,
    ca.ca_state,
    s.s_state,
    i.i_color,
    i.i_current_price,
    i.i_manager_id,
    i.i_units,
    i.i_size,
    SUM(base.ss_net_profit) AS netpaid
  FROM ssales_base base
  JOIN customer c ON base.ss_customer_sk = c.c_customer_sk
  JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk
  JOIN store s ON base.ss_store_sk = s.s_store_sk AND s.s_zip = ca.ca_zip
  JOIN item i ON base.ss_item_sk = i.i_item_sk
  WHERE c.c_birth_country <> UPPER(ca.ca_country)
  GROUP BY
    c.c_last_name,
    c.c_first_name,
    s.s_store_name,
    ca.ca_state,
    s.s_state,
    i.i_color,
    i.i_current_price,
    i.i_manager_id,
    i.i_units,
    i.i_size
),
overall_avg AS (
  SELECT 0.05 * AVG(netpaid) AS threshold
  FROM ssales
)
SELECT
  c_last_name,
  c_first_name,
  s_store_name,
  SUM(netpaid) AS paid
FROM ssales
CROSS JOIN overall_avg
WHERE i_color = 'beige'
GROUP BY
  c_last_name,
  c_first_name,
  s_store_name
HAVING SUM(netpaid) > threshold
ORDER BY
  c_last_name,
  c_first_name,
  s_store_name
```

**Changes**: 
1. Pushed the `s_market_id = 8` filter into a subquery to reduce store table early.
2. Converted implicit joins to explicit JOIN syntax for better optimizer control.
3. Decorrelated the HAVING subquery by computing the overall average threshold in a separate CTE and using a CROSS JOIN.
4. Extracted the core store_sales-store_returns join into a base CTE to reduce complexity in the main aggregation.

**Expected speedup**: ~2x from decorrelation and early filtering, avoiding repeated subquery execution per group.