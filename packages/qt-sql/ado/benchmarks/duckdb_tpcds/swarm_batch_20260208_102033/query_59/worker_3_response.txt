```sql
WITH filtered_dates AS (
  SELECT 
    d_date_sk,
    d_week_seq,
    d_day_name,
    CASE 
      WHEN d_month_seq BETWEEN 1196 AND 1196 + 11 THEN 1
      WHEN d_month_seq BETWEEN 1196 + 12 AND 1196 + 23 THEN 2
    END AS year_tag
  FROM date_dim
  WHERE d_month_seq BETWEEN 1196 AND 1196 + 23
),
filtered_sales AS (
  SELECT 
    ss_store_sk,
    ss_sales_price,
    d_week_seq,
    d_day_name,
    year_tag
  FROM store_sales
  JOIN filtered_dates ON ss_sold_date_sk = d_date_sk
),
aggregated AS (
  SELECT 
    ss_store_sk,
    d_week_seq,
    year_tag,
    SUM(CASE WHEN d_day_name = 'Sunday' THEN ss_sales_price END) AS sun_sales,
    SUM(CASE WHEN d_day_name = 'Monday' THEN ss_sales_price END) AS mon_sales,
    SUM(CASE WHEN d_day_name = 'Tuesday' THEN ss_sales_price END) AS tue_sales,
    SUM(CASE WHEN d_day_name = 'Wednesday' THEN ss_sales_price END) AS wed_sales,
    SUM(CASE WHEN d_day_name = 'Thursday' THEN ss_sales_price END) AS thu_sales,
    SUM(CASE WHEN d_day_name = 'Friday' THEN ss_sales_price END) AS fri_sales,
    SUM(CASE WHEN d_day_name = 'Saturday' THEN ss_sales_price END) AS sat_sales
  FROM filtered_sales
  GROUP BY ss_store_sk, d_week_seq, year_tag
),
year1 AS (
  SELECT 
    ss_store_sk,
    d_week_seq AS d_week_seq1,
    sun_sales AS sun_sales1,
    mon_sales AS mon_sales1,
    tue_sales AS tue_sales1,
    wed_sales AS wed_sales1,
    thu_sales AS thu_sales1,
    fri_sales AS fri_sales1,
    sat_sales AS sat_sales1
  FROM aggregated
  WHERE year_tag = 1
),
year2 AS (
  SELECT 
    ss_store_sk,
    d_week_seq - 52 AS d_week_seq1,
    sun_sales AS sun_sales2,
    mon_sales AS mon_sales2,
    tue_sales AS tue_sales2,
    wed_sales AS wed_sales2,
    thu_sales AS thu_sales2,
    fri_sales AS fri_sales2,
    sat_sales AS sat_sales2
  FROM aggregated
  WHERE year_tag = 2
)
SELECT 
  s.s_store_name AS s_store_name1,
  s.s_store_id AS s_store_id1,
  y1.d_week_seq1,
  y1.sun_sales1 / y2.sun_sales2,
  y1.mon_sales1 / y2.mon_sales2,
  y1.tue_sales1 / y2.tue_sales2,
  y1.wed_sales1 / y2.wed_sales2,
  y1.thu_sales1 / y2.thu_sales2,
  y1.fri_sales1 / y2.fri_sales2,
  y1.sat_sales1 / y2.sat_sales2
FROM year1 y1
JOIN year2 y2 ON y1.ss_store_sk = y2.ss_store_sk AND y1.d_week_seq1 = y2.d_week_seq1
JOIN store s ON y1.ss_store_sk = s.s_store_sk
ORDER BY s.s_store_name, s.s_store_id, y1.d_week_seq1
LIMIT 100
```

**Changes**: Consolidated the two year-range subqueries into a single-pass aggregation by pre-filtering date_dim for both ranges, tagging each row, then splitting results after aggregation. This eliminates duplicate scans of store_sales and store tables.

**Expected speedup**: ~2-3x from reduced I/O and elimination of redundant joins.