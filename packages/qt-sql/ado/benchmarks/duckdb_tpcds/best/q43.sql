WITH filtered_dates AS (SELECT d_date_sk, d_day_name FROM date_dim WHERE d_year = 2000), filtered_stores AS (SELECT s_store_sk, s_store_name, s_store_id FROM store WHERE s_gmt_offset = -5)
SELECT s.s_store_name, s.s_store_id, SUM(CASE WHEN d.d_day_name = 'Sunday' THEN ss.ss_sales_price END) AS sun_sales, SUM(CASE WHEN d.d_day_name = 'Monday' THEN ss.ss_sales_price END) AS mon_sales, SUM(CASE WHEN d.d_day_name = 'Tuesday' THEN ss.ss_sales_price END) AS tue_sales, SUM(CASE WHEN d.d_day_name = 'Wednesday' THEN ss.ss_sales_price END) AS wed_sales, SUM(CASE WHEN d.d_day_name = 'Thursday' THEN ss.ss_sales_price END) AS thu_sales, SUM(CASE WHEN d.d_day_name = 'Friday' THEN ss.ss_sales_price END) AS fri_sales, SUM(CASE WHEN d.d_day_name = 'Saturday' THEN ss.ss_sales_price END) AS sat_sales FROM filtered_dates AS d JOIN store_sales AS ss ON d.d_date_sk = ss.ss_sold_date_sk JOIN filtered_stores AS s ON s.s_store_sk = ss.ss_store_sk GROUP BY s.s_store_name, s.s_store_id ORDER BY s.s_store_name, s.s_store_id, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales LIMIT 100
