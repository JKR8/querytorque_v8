{
  "id": "TOP_N_PER_GROUP_DISTINCT_ON",
  "name": "Top N Per Group Distinct On",
  "description": "Use PostgreSQL's DISTINCT ON for \"top-1-per-group\" instead of\n      ROW_NUMBER() window function.  More concise and often faster.",
  "category": "window_functions",
  "priority": "medium",
  "verified_speedup": "unknown",
  "example": {
    "before_sql": "SELECT * FROM (\n          SELECT *, ROW_NUMBER() OVER (\n              PARTITION BY customer_id ORDER BY order_date DESC\n          ) AS rn\n          FROM orders\n      ) ranked WHERE rn = 1;",
    "after_sql": "SELECT DISTINCT ON (customer_id) *\n      FROM orders\n      ORDER BY customer_id, order_date DESC;",
    "alternative_sql": "",
    "key_insight": "Retrieving exactly one row per group based on ordering.\n      PostgreSQL-specific extension.",
    "transforms": [
      "top_n_per_group_distinct_on"
    ]
  },
  "metadata": {
    "pg_version": "All",
    "auto_applied_by_pg": "false",
    "research_source": "",
    "notes": "ORDER BY must start with DISTINCT ON columns.  For top-N (N>1),\n      use window functions with ROW_NUMBER/RANK/DENSE_RANK."
  }
}