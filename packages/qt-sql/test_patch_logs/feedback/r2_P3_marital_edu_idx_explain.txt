                                                                                                             QUERY PLAN                                                                                                              
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=103212.37..103213.62 rows=100 width=17) (actual time=754.130..758.891 rows=100 loops=1)
   Buffers: shared hit=802996 read=111925, temp read=1499 written=1854
   ->  Nested Loop  (cost=103212.37..12638372682927.75 rows=1011059751000000 width=17) (actual time=754.129..758.885 rows=100 loops=1)
         Buffers: shared hit=802996 read=111925, temp read=1499 written=1854
         ->  Nested Loop  (cost=102212.37..125748279.03 rows=10047000000 width=17) (actual time=753.671..756.120 rows=1 loops=1)
               Buffers: shared hit=802996 read=111903, temp read=1499 written=1854
               ->  Gather Merge  (cost=39588.55..97821.79 rows=500000 width=17) (actual time=331.928..332.761 rows=1 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     Buffers: shared hit=143 read=13798, temp read=1314 written=1668
                     ->  Sort  (cost=38588.52..39109.36 rows=208333 width=17) (actual time=328.114..328.216 rows=910 loops=3)
                           Sort Key: customer.c_customer_id
                           Sort Method: external merge  Disk: 4520kB
                           Buffers: shared hit=143 read=13798, temp read=1314 written=1668
                           Worker 0:  Sort Method: external merge  Disk: 4384kB
                           Worker 1:  Sort Method: external merge  Disk: 4344kB
                           ->  Parallel Seq Scan on customer  (cost=0.00..15910.33 rows=208333 width=17) (actual time=0.342..249.625 rows=166667 loops=3)
                                 Buffers: shared hit=30 read=13797
               ->  Materialize  (cost=62623.82..63007.48 rows=20094 width=0) (actual time=421.741..423.356 rows=1 loops=1)
                     Buffers: shared hit=802853 read=98105, temp read=185 written=186
                     ->  Nested Loop  (cost=62623.82..62907.01 rows=20094 width=0) (actual time=421.739..423.354 rows=1 loops=1)
                           Buffers: shared hit=802853 read=98105, temp read=185 written=186
                           ->  Finalize GroupAggregate  (cost=62623.82..62647.59 rows=197 width=44) (actual time=421.725..423.338 rows=1 loops=1)
                                 Group Key: store_returns.sr_customer_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk
                                 Buffers: shared hit=802853 read=98104, temp read=185 written=186
                                 ->  Gather Merge  (cost=62623.82..62644.39 rows=164 width=12) (actual time=421.720..423.333 rows=2 loops=1)
                                       Workers Planned: 2
                                       Workers Launched: 2
                                       Buffers: shared hit=802853 read=98104, temp read=185 written=186
                                       ->  Partial GroupAggregate  (cost=61623.80..61625.44 rows=82 width=12) (actual time=240.121..240.301 rows=1093 loops=3)
                                             Group Key: store_returns.sr_customer_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk
                                             Buffers: shared hit=802853 read=98104, temp read=185 written=186
                                             ->  Sort  (cost=61623.80..61624.00 rows=82 width=12) (actual time=240.115..240.166 rows=1094 loops=3)
                                                   Sort Key: store_returns.sr_customer_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk
                                                   Sort Method: quicksort  Memory: 1062kB
                                                   Buffers: shared hit=802853 read=98104, temp read=185 written=186
                                                   Worker 0:  Sort Method: external merge  Disk: 1480kB
                                                   Worker 1:  Sort Method: quicksort  Memory: 999kB
                                                   ->  Nested Loop  (cost=0.72..61621.19 rows=82 width=12) (actual time=0.340..232.559 rows=31974 loops=3)
                                                         Buffers: shared hit=802839 read=98104
                                                         ->  Parallel Index Only Scan using _dta_index_date_dim_6_661577395__k1_k7_k9 on date_dim  (cost=0.29..1677.88 rows=172 width=4) (actual time=0.274..0.495 rows=122 loops=3)
                                                               Index Cond: (d_year = 2002)
                                                               Heap Fetches: 0
                                                               Buffers: shared hit=4 read=280
                                                         ->  Index Scan using _dta_index_store_returns_6_1013578649__k1_3_4_10 on store_returns  (cost=0.43..348.35 rows=16 width=16) (actual time=0.010..1.891 rows=263 loops=365)
                                                               Index Cond: (sr_returned_date_sk = date_dim.d_date_sk)
                                                               Filter: (((sr_return_amt / (sr_return_quantity)::numeric) >= '108'::numeric) AND ((sr_return_amt / (sr_return_quantity)::numeric) <= '167'::numeric))
                                                               Rows Removed by Filter: 2612
                                                               Buffers: shared hit=802835 read=97824
                           ->  Materialize  (cost=0.00..6.53 rows=102 width=0) (actual time=0.012..0.013 rows=1 loops=1)
                                 Buffers: shared read=1
                                 ->  Seq Scan on store  (cost=0.00..6.02 rows=102 width=0) (actual time=0.011..0.011 rows=1 loops=1)
                                       Buffers: shared read=1
         ->  Materialize  (cost=1000.00..47400.30 rows=100633 width=0) (actual time=0.457..2.757 rows=100 loops=1)
               Buffers: shared read=22
               ->  Gather  (cost=1000.00..46897.13 rows=100633 width=0) (actual time=0.455..2.744 rows=100 loops=1)
                     Workers Planned: 2
                     Workers Launched: 2
                     Buffers: shared read=22
                     ->  Parallel Seq Scan on customer_demographics  (cost=0.00..35833.83 rows=41930 width=0) (actual time=0.188..0.452 rows=34 loops=3)
                           Filter: ((cd_marital_status = 'M'::bpchar) AND ((cd_education_status = 'Advanced Degree'::bpchar) OR (cd_education_status = 'College'::bpchar)))
                           Rows Removed by Filter: 554
                           Buffers: shared read=22
 Planning:
   Buffers: shared hit=463 read=68
 Planning Time: 0.847 ms
 Execution Time: 759.470 ms
(67 rows)

