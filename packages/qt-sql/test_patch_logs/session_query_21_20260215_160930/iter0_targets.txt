[
  {
    "target_id": "t1",
    "family": "C",
    "transform": "aggregation_pushdown",
    "relevance_score": 0.95,
    "hypothesis": "Aggregation happens after large joins, causing unnecessary processing of 5.1M rows. Grouping by join keys before joining dimensions reduces intermediate data size.",
    "target_ir": "S0 [SELECT]\n  CTE: date_filtered  (via CTE_Q_S0_date_filtered)\n    FROM: date_dim\n    WHERE [d_date_condition]: d_date BETWEEN (cast('2002-02-27' as date) - INTERVAL 30 DAY) AND (cast('2002-02-27' as date) + INTERVAL 30 DAY)\n  CTE: item_filtered  (via CTE_Q_S0_item_filtered)\n    FROM: item\n    WHERE [item_price_condition]: i_current_price between 0.99 and 1.49\n  CTE: inventory_agg  (via CTE_Q_S0_inventory_agg)\n    FROM: inventory, date_filtered\n    WHERE [inv_date_condition]: inv_date_sk = d_date_sk\n    GROUP BY: inv_warehouse_sk, inv_item_sk\n    Aggregates: \n        sum(case when (d_date < cast('2002-02-27' as date)) then inv_quantity_on_hand else 0 end) as inv_before,\n        sum(case when (d_date >= cast('2002-02-27' as date)) then inv_quantity_on_hand else 0 end) as inv_after\n  MAIN QUERY (via Q_S0)\n    FROM: inventory_agg, item_filtered, warehouse\n    WHERE [item_join]: inv_item_sk = i_item_sk\n      AND [warehouse_join]: inv_warehouse_sk = w_warehouse_sk\n    WHERE [outer_condition]: (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0\n    ORDER BY: w_warehouse_name, i_item_id\n    LIMIT: 100",
    "recommended_examples": [
      "aggregate_pushdown"
    ]
  },
  {
    "target_id": "t2",
    "family": "A",
    "transform": "dimension_prefilter",
    "relevance_score": 0.75,
    "hypothesis": "Dimension table filters (date_range, price) can be isolated in CTEs to prevent full table scans during joins.",
    "target_ir": "S0 [SELECT]\n  CTE: date_filtered  (via CTE_Q_S0_date_filtered)\n    FROM: date_dim\n    WHERE [d_date_condition]: d_date BETWEEN (cast('2002-02-27' as date) - INTERVAL 30 DAY) AND (cast('2002-02-27' as date) + INTERVAL 30 DAY)\n  CTE: item_filtered  (via CTE_Q_S0_item_filtered)\n    FROM: item\n    WHERE [item_price_condition]: i_current_price between 0.99 and 1.49\n  MAIN QUERY (via Q_S0)\n    FROM: inventory, date_filtered, item_filtered, warehouse\n    WHERE [date_join]: inv_date_sk = d_date_sk\n      AND [item_join]: inv_item_sk = i_item_sk\n      AND [warehouse_join]: inv_warehouse_sk = w_warehouse_sk\n    GROUP BY: w_warehouse_name, i_item_id\n    ORDER BY: w_warehouse_name, i_item_id\n    LIMIT: 100",
    "recommended_examples": [
      "date_cte_isolate"
    ]
  }
]