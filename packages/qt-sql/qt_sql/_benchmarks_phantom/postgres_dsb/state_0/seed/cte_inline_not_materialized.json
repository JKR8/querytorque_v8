{
  "id": "CTE_INLINE_NOT_MATERIALIZED",
  "name": "Cte Inline Not Materialized",
  "description": "Force CTE inlining with NOT MATERIALIZED to enable predicate pushdown\n      when CTE is referenced multiple times but benefits from different\n      filters in each reference.",
  "category": "cte_materialization",
  "priority": "medium",
  "verified_speedup": "unknown",
  "example": {
    "before_sql": "WITH data AS (\n          SELECT * FROM very_large_table\n      )\n      SELECT * FROM data WHERE category = 'A'\n      UNION ALL\n      SELECT * FROM data WHERE category = 'B';\n      -- Scans entire table, then filters twice",
    "after_sql": "WITH data AS NOT MATERIALIZED (\n          SELECT * FROM very_large_table\n      )\n      SELECT * FROM data WHERE category = 'A'\n      UNION ALL\n      SELECT * FROM data WHERE category = 'B';\n      -- Predicates pushed down: two filtered scans",
    "alternative_sql": "",
    "key_insight": "When CTE is referenced multiple times and each reference has different\n      WHERE conditions that could be pushed down.",
    "transforms": [
      "cte_inline_not_materialized"
    ]
  },
  "metadata": {
    "pg_version": "12+",
    "auto_applied_by_pg": "Only for single-reference CTEs",
    "research_source": "",
    "notes": ""
  }
}