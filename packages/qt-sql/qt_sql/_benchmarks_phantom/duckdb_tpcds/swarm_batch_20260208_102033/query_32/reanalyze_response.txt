FAILURE_ANALYSIS:
All attempts fell short because they focused on CTE-based decorrelation without addressing the fundamental bottleneck: the query performs a self-join on catalog_sales with different filtering conditions. Worker 1-3 achieved only 0.44-0.67x because they still compute item averages for ALL items, then join back, performing redundant work. Workers 4-5 failed with syntax errors due to ambiguous column references when joining catalog_sales with item_avg_discount without proper table aliasing. The core issue is that item_avg_discount computes averages for ALL items, but the outer query only needs items with i_manufact_id=29. This creates unnecessary computation across the entire item space.

UNEXPLORED_OPPORTUNITIES:
1. **Push manufacturer filter into average computation**: Compute averages ONLY for items with i_manufact_id=29 instead of all items.
2. **Merge filtering and aggregation**: Use a single CTE that computes both the filtered sales and their averages in one pass.
3. **Window function approach**: Calculate per-item averages using window functions on pre-filtered data.
4. **Explicit column qualification**: Avoid ambiguous references by using explicit table aliases.
5. **Early fact table reduction**: Filter catalog_sales by date FIRST, then join with filtered items.

REFINED_STRATEGY:
Compute item averages ONLY for manufacturer 29 items within the filtered sales. Use a single CTE that: (1) filters catalog_sales by date, (2) joins with items filtered by manufacturer, (3) computes per-item average via window function, (4) filters rows where discount exceeds threshold, and (5) aggregates. This eliminates the separate average computation CTE that processes all items.

EXAMPLES: single_pass_aggregation, early_filter, window_functions (implied by single_pass), pushdown
HINT: Filter catalog_sales by date range first, then join with items filtered by manufacturer. Use a window function to compute 1.3*AVG(cs_ext_discount_amt) OVER (PARTITION BY cs_item_sk) on this pre-filtered dataset. Finally, filter rows where cs_ext_discount_amt > computed_threshold and aggregate.