```sql
WITH filtered_dates AS (
  SELECT d_date_sk
  FROM date_dim
  WHERE d_month_seq BETWEEN 1221 AND 1221 + 11
),
filtered_sales AS (
  SELECT
    ss_store_sk,
    ss_item_sk,
    SUM(ss_sales_price) AS revenue
  FROM store_sales
  JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk
  GROUP BY
    ss_store_sk,
    ss_item_sk
),
store_averages AS (
  SELECT
    ss_store_sk,
    AVG(revenue) AS ave
  FROM filtered_sales
  GROUP BY ss_store_sk
)
SELECT
  s_store_name,
  i_item_desc,
  fs.revenue,
  i_current_price,
  i_wholesale_cost,
  i_brand
FROM filtered_sales fs
JOIN store_averages sa ON fs.ss_store_sk = sa.ss_store_sk
JOIN store ON fs.ss_store_sk = store.s_store_sk
JOIN item ON fs.ss_item_sk = item.i_item_sk
WHERE fs.revenue <= 0.1 * sa.ave
ORDER BY
  s_store_name,
  i_item_desc
LIMIT 100
```

```
Changes: Isolated date filtering into a CTE, computed store-item revenue once in a CTE, then derived store averages from that CTE, eliminating duplicate fact table scans and enabling better filter propagation.
Expected speedup: 2.0-3.0x due to single pass over fact data and reduced join cardinality from early dimension isolation.
```