```sql
WITH filtered_reason AS (
    SELECT r_reason_sk
    FROM reason
    WHERE r_reason_desc = 'duplicate purchase'
),
filtered_returns AS (
    SELECT 
        sr_item_sk,
        sr_ticket_number,
        sr_return_quantity
    FROM store_returns
    WHERE EXISTS (
        SELECT 1 
        FROM filtered_reason 
        WHERE sr_reason_sk = r_reason_sk
    )
)
SELECT
    ss_customer_sk,
    SUM(
        CASE
            WHEN NOT sr_return_quantity IS NULL
            THEN (ss_quantity - sr_return_quantity) * ss_sales_price
            ELSE (ss_quantity * ss_sales_price)
        END
    ) AS sumsales
FROM store_sales
LEFT OUTER JOIN filtered_returns
    ON sr_item_sk = ss_item_sk 
    AND sr_ticket_number = ss_ticket_number
GROUP BY ss_customer_sk
ORDER BY sumsales, ss_customer_sk
LIMIT 100
```

Changes: Pre-filtered reason table to only 'duplicate purchase' rows, then created a CTE containing only store_returns with matching reasons before joining to store_sales. This eliminates the cross join between store_sales and reason, reducing the join graph complexity and allowing early reduction of store_returns.

Expected speedup: 2-3x by eliminating the inefficient cross join and reducing the store_returns scan to only relevant rows before joining to the large store_sales table.