```sql
WITH filtered_dates AS (
    SELECT d_date_sk, d_date
    FROM date_dim
    WHERE d_date BETWEEN (
        CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY
    ) AND (
        CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY
    )
),
filtered_items AS (
    SELECT i_item_sk, i_item_id
    FROM item
    WHERE i_current_price BETWEEN 0.99 AND 1.49
),
filtered_inventory AS (
    SELECT 
        inv.inv_warehouse_sk,
        inv.inv_item_sk,
        d.d_date,
        inv.inv_quantity_on_hand
    FROM inventory inv
    JOIN filtered_dates d ON inv.inv_date_sk = d.d_date_sk
    JOIN filtered_items i ON inv.inv_item_sk = i.i_item_sk
),
aggregated_inventory AS (
    SELECT
        inv_warehouse_sk,
        inv_item_sk,
        SUM(CASE WHEN d_date < CAST('2002-02-27' AS DATE) 
                THEN inv_quantity_on_hand ELSE 0 END) AS inv_before,
        SUM(CASE WHEN d_date >= CAST('2002-02-27' AS DATE) 
                THEN inv_quantity_on_hand ELSE 0 END) AS inv_after
    FROM filtered_inventory
    GROUP BY inv_warehouse_sk, inv_item_sk
    HAVING 
        (CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END)
        BETWEEN 2.0 / 3.0 AND 3.0 / 2.0
)
SELECT
    w.w_warehouse_name,
    i.i_item_id,
    agg.inv_before,
    agg.inv_after
FROM aggregated_inventory agg
JOIN warehouse w ON agg.inv_warehouse_sk = w.w_warehouse_sk
JOIN item i ON agg.inv_item_sk = i.i_item_sk
ORDER BY
    w.w_warehouse_name,
    i.i_item_id
LIMIT 100;
```

**Changes**: 
1. Created CTEs for filtered date_dim and item tables to reduce dimension table sizes early.
2. Created filtered_inventory CTE that joins inventory only with the filtered dimensions via semi-joins.
3. Aggregated at warehouse-item grain with early ratio filtering in HAVING clause.
4. Joined aggregated results with warehouse and item tables only at the end.
5. Maintained exact same CASE logic and date literals.

**Expected speedup**: 2-3x due to reduced join sizes from early dimension filtering and elimination of groups via HAVING clause before final dimension joins.