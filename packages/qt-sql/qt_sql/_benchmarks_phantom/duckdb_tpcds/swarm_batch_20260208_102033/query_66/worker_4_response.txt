```sql
WITH filtered_date AS (
  SELECT d_date_sk, d_year, d_moy
  FROM date_dim
  WHERE d_year = 1998
),
filtered_time AS (
  SELECT t_time_sk
  FROM time_dim
  WHERE t_time BETWEEN 48821 AND 48821 + 28800
),
filtered_ship_mode AS (
  SELECT sm_ship_mode_sk
  FROM ship_mode
  WHERE sm_carrier IN ('GREAT EASTERN', 'LATVIAN')
),
web_sales_agg AS (
  SELECT
    w.w_warehouse_name,
    w.w_warehouse_sq_ft,
    w.w_city,
    w.w_county,
    w.w_state,
    w.w_country,
    d.d_year AS year,
    SUM(CASE WHEN d.d_moy = 1 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS jan_sales,
    SUM(CASE WHEN d.d_moy = 2 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS feb_sales,
    SUM(CASE WHEN d.d_moy = 3 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS mar_sales,
    SUM(CASE WHEN d.d_moy = 4 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS apr_sales,
    SUM(CASE WHEN d.d_moy = 5 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS may_sales,
    SUM(CASE WHEN d.d_moy = 6 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS jun_sales,
    SUM(CASE WHEN d.d_moy = 7 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS jul_sales,
    SUM(CASE WHEN d.d_moy = 8 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS aug_sales,
    SUM(CASE WHEN d.d_moy = 9 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS sep_sales,
    SUM(CASE WHEN d.d_moy = 10 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS oct_sales,
    SUM(CASE WHEN d.d_moy = 11 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS nov_sales,
    SUM(CASE WHEN d.d_moy = 12 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS dec_sales,
    SUM(CASE WHEN d.d_moy = 1 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS jan_net,
    SUM(CASE WHEN d.d_moy = 2 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS feb_net,
    SUM(CASE WHEN d.d_moy = 3 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS mar_net,
    SUM(CASE WHEN d.d_moy = 4 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS apr_net,
    SUM(CASE WHEN d.d_moy = 5 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS may_net,
    SUM(CASE WHEN d.d_moy = 6 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS jun_net,
    SUM(CASE WHEN d.d_moy = 7 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS jul_net,
    SUM(CASE WHEN d.d_moy = 8 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS aug_net,
    SUM(CASE WHEN d.d_moy = 9 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS sep_net,
    SUM(CASE WHEN d.d_moy = 10 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS oct_net,
    SUM(CASE WHEN d.d_moy = 11 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS nov_net,
    SUM(CASE WHEN d.d_moy = 12 THEN ws.ws_net_paid_inc_ship_tax * ws.ws_quantity ELSE 0 END) AS dec_net
  FROM web_sales ws
  JOIN warehouse w ON ws.ws_warehouse_sk = w.w_warehouse_sk
  JOIN filtered_date d ON ws.ws_sold_date_sk = d.d_date_sk
  JOIN filtered_time t ON ws.ws_sold_time_sk = t.t_time_sk
  JOIN filtered_ship_mode sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk
  GROUP BY
    w.w_warehouse_name,
    w.w_warehouse_sq_ft,
    w.w_city,
    w.w_county,
    w.w_state,
    w.w_country,
    d.d_year
),
catalog_sales_agg AS (
  SELECT
    w.w_warehouse_name,
    w.w_warehouse_sq_ft,
    w.w_city,
    w.w_county,
    w.w_state,
    w.w_country,
    d.d_year AS year,
    SUM(CASE WHEN d.d_moy = 1 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS jan_sales,
    SUM(CASE WHEN d.d_moy = 2 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS feb_sales,
    SUM(CASE WHEN d.d_moy = 3 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS mar_sales,
    SUM(CASE WHEN d.d_moy = 4 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS apr_sales,
    SUM(CASE WHEN d.d_moy = 5 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS may_sales,
    SUM(CASE WHEN d.d_moy = 6 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS jun_sales,
    SUM(CASE WHEN d.d_moy = 7 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS jul_sales,
    SUM(CASE WHEN d.d_moy = 8 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS aug_sales,
    SUM(CASE WHEN d.d_moy = 9 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS sep_sales,
    SUM(CASE WHEN d.d_moy = 10 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS oct_sales,
    SUM(CASE WHEN d.d_moy = 11 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS nov_sales,
    SUM(CASE WHEN d.d_moy = 12 THEN cs.cs_ext_list_price * cs.cs_quantity ELSE 0 END) AS dec_sales,
    SUM(CASE WHEN d.d_moy = 1 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS jan_net,
    SUM(CASE WHEN d.d_moy = 2 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS feb_net,
    SUM(CASE WHEN d.d_moy = 3 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS mar_net,
    SUM(CASE WHEN d.d_moy = 4 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS apr_net,
    SUM(CASE WHEN d.d_moy = 5 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS may_net,
    SUM(CASE WHEN d.d_moy = 6 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS jun_net,
    SUM(CASE WHEN d.d_moy = 7 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS jul_net,
    SUM(CASE WHEN d.d_moy = 8 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS aug_net,
    SUM(CASE WHEN d.d_moy = 9 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS sep_net,
    SUM(CASE WHEN d.d_moy = 10 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS oct_net,
    SUM(CASE WHEN d.d_moy = 11 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS nov_net,
    SUM(CASE WHEN d.d_moy = 12 THEN cs.cs_net_paid_inc_ship_tax * cs.cs_quantity ELSE 0 END) AS dec_net
  FROM catalog_sales cs
  JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk
  JOIN filtered_date d ON cs.cs_sold_date_sk = d.d_date_sk
  JOIN filtered_time t ON cs.cs_sold_time_sk = t.t_time_sk
  JOIN filtered_ship_mode sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk
  GROUP BY
    w.w_warehouse_name,
    w.w_warehouse_sq_ft,
    w.w_city,
    w.w_county,
    w.w_state,
    w.w_country,
    d.d_year
),
combined_sales AS (
  SELECT 
    w_warehouse_name,
    w_warehouse_sq_ft,
    w_city,
    w_county,
    w_state,
    w_country,
    'GREAT EASTERN' || ',' || 'LATVIAN' AS ship_carriers,
    year,
    jan_sales, feb_sales, mar_sales, apr_sales, may_sales, jun_sales,
    jul_sales, aug_sales, sep_sales, oct_sales, nov_sales, dec_sales,
    jan_net, feb_net, mar_net, apr_net, may_net, jun_net,
    jul_net, aug_net, sep_net, oct_net, nov_net, dec_net
  FROM web_sales_agg
  UNION ALL
  SELECT 
    w_warehouse_name,
    w_warehouse_sq_ft,
    w_city,
    w_county,
    w_state,
    w_country,
    'GREAT EASTERN' || ',' || 'LATVIAN' AS ship_carriers,
    year,
    jan_sales, feb_sales, mar_sales, apr_sales, may_sales, jun_sales,
    jul_sales, aug_sales, sep_sales, oct_sales, nov_sales, dec_sales,
    jan_net, feb_net, mar_net, apr_net, may_net, jun_net,
    jul_net, aug_net, sep_net, oct_net, nov_net, dec_net
  FROM catalog_sales_agg
)
SELECT
  w_warehouse_name,
  w_warehouse_sq_ft,
  w_city,
  w_county,
  w_state,
  w_country,
  ship_carriers,
  year,
  SUM(jan_sales) AS jan_sales,
  SUM(feb_sales) AS feb_sales,
  SUM(mar_sales) AS mar_sales,
  SUM(apr_sales) AS apr_sales,
  SUM(may_sales) AS may_sales,
  SUM(jun_sales) AS jun_sales,
  SUM(jul_sales) AS jul_sales,
  SUM(aug_sales) AS aug_sales,
  SUM(sep_sales) AS sep_sales,
  SUM(oct_sales) AS oct_sales,
  SUM(nov_sales) AS nov_sales,
  SUM(dec_sales) AS dec_sales,
  SUM(jan_sales / w_warehouse_sq_ft) AS jan_sales_per_sq_foot,
  SUM(feb_sales / w_warehouse_sq_ft) AS feb_sales_per_sq_foot,
  SUM(mar_sales / w_warehouse_sq_ft) AS mar_sales_per_sq_foot,
  SUM(apr_sales / w_warehouse_sq_ft) AS apr_sales_per_sq_foot,
  SUM(may_sales / w_warehouse_sq_ft) AS may_sales_per_sq_foot,
  SUM(jun_sales / w_warehouse_sq_ft) AS jun_sales_per_sq_foot,
  SUM(jul_sales / w_warehouse_sq_ft) AS jul_sales_per_sq_foot,
  SUM(aug_sales / w_warehouse_sq_ft) AS aug_sales_per_sq_foot,
  SUM(sep_sales / w_warehouse_sq_ft) AS sep_sales_per_sq_foot,
  SUM(oct_sales / w_warehouse_sq_ft) AS oct_sales_per_sq_foot,
  SUM(nov_sales / w_warehouse_sq_ft) AS nov_sales_per_sq_foot,
  SUM(dec_sales / w_warehouse_sq_ft) AS dec_sales_per_sq_foot,
  SUM(jan_net) AS jan_net,
  SUM(feb_net) AS feb_net,
  SUM(mar_net) AS mar_net,
  SUM(apr_net) AS apr_net,
  SUM(may_net) AS may_net,
  SUM(jun_net) AS jun_net,
  SUM(jul_net) AS jul_net,
  SUM(aug_net) AS aug_net,
  SUM(sep_net) AS sep_net,
  SUM(oct_net) AS oct_net,
  SUM(nov_net) AS nov_net,
  SUM(dec_net) AS dec_net
FROM combined_sales
GROUP BY
  w_warehouse_name,
  w_warehouse_sq_ft,
  w_city,
  w_county,
  w_state,
  w_country,
  ship_carriers,
  year
ORDER BY
  w_warehouse_name
LIMIT 100
```

Changes: Applied structural decomposition by extracting filtered dimension tables into separate CTEs, enabling parallel dimension filtering before joining with large fact tables. Separated web_sales and catalog_sales aggregations into independent CTEs for better join planning, then combined via UNION ALL.

Expected speedup: 1.5-2x from reduced join complexity and better parallelization of dimension filters.