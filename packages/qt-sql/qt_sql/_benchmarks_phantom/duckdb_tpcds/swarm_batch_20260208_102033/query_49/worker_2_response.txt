```sql
WITH filtered_dates AS (
    SELECT d_date_sk
    FROM date_dim
    WHERE d_year = 1999
      AND d_moy = 12
),
web_agg AS (
    SELECT
        ws.ws_item_sk AS item,
        CAST(SUM(COALESCE(wr.wr_return_quantity, 0)) AS DECIMAL(15, 4)) AS return_qty_sum,
        CAST(SUM(COALESCE(ws.ws_quantity, 0)) AS DECIMAL(15, 4)) AS sales_qty_sum,
        CAST(SUM(COALESCE(wr.wr_return_amt, 0)) AS DECIMAL(15, 4)) AS return_amt_sum,
        CAST(SUM(COALESCE(ws.ws_net_paid, 0)) AS DECIMAL(15, 4)) AS sales_amt_sum
    FROM web_sales ws
    LEFT OUTER JOIN web_returns wr
        ON ws.ws_order_number = wr.wr_order_number
        AND ws.ws_item_sk = wr.wr_item_sk
    JOIN filtered_dates fd
        ON ws.ws_sold_date_sk = fd.d_date_sk
    WHERE wr.wr_return_amt > 10000
        AND ws.ws_net_profit > 1
        AND ws.ws_net_paid > 0
        AND ws.ws_quantity > 0
    GROUP BY ws.ws_item_sk
),
web_ranked AS (
    SELECT
        item,
        return_qty_sum / sales_qty_sum AS return_ratio,
        return_amt_sum / sales_amt_sum AS currency_ratio,
        RANK() OVER (ORDER BY return_qty_sum / sales_qty_sum) AS return_rank,
        RANK() OVER (ORDER BY return_amt_sum / sales_amt_sum) AS currency_rank
    FROM web_agg
),
catalog_agg AS (
    SELECT
        cs.cs_item_sk AS item,
        CAST(SUM(COALESCE(cr.cr_return_quantity, 0)) AS DECIMAL(15, 4)) AS return_qty_sum,
        CAST(SUM(COALESCE(cs.cs_quantity, 0)) AS DECIMAL(15, 4)) AS sales_qty_sum,
        CAST(SUM(COALESCE(cr.cr_return_amount, 0)) AS DECIMAL(15, 4)) AS return_amt_sum,
        CAST(SUM(COALESCE(cs.cs_net_paid, 0)) AS DECIMAL(15, 4)) AS sales_amt_sum
    FROM catalog_sales cs
    LEFT OUTER JOIN catalog_returns cr
        ON cs.cs_order_number = cr.cr_order_number
        AND cs.cs_item_sk = cr.cr_item_sk
    JOIN filtered_dates fd
        ON cs.cs_sold_date_sk = fd.d_date_sk
    WHERE cr.cr_return_amount > 10000
        AND cs.cs_net_profit > 1
        AND cs.cs_net_paid > 0
        AND cs.cs_quantity > 0
    GROUP BY cs.cs_item_sk
),
catalog_ranked AS (
    SELECT
        item,
        return_qty_sum / sales_qty_sum AS return_ratio,
        return_amt_sum / sales_amt_sum AS currency_ratio,
        RANK() OVER (ORDER BY return_qty_sum / sales_qty_sum) AS return_rank,
        RANK() OVER (ORDER BY return_amt_sum / sales_amt_sum) AS currency_rank
    FROM catalog_agg
),
store_agg AS (
    SELECT
        sts.ss_item_sk AS item,
        CAST(SUM(COALESCE(sr.sr_return_quantity, 0)) AS DECIMAL(15, 4)) AS return_qty_sum,
        CAST(SUM(COALESCE(sts.ss_quantity, 0)) AS DECIMAL(15, 4)) AS sales_qty_sum,
        CAST(SUM(COALESCE(sr.sr_return_amt, 0)) AS DECIMAL(15, 4)) AS return_amt_sum,
        CAST(SUM(COALESCE(sts.ss_net_paid, 0)) AS DECIMAL(15, 4)) AS sales_amt_sum
    FROM store_sales sts
    LEFT OUTER JOIN store_returns sr
        ON sts.ss_ticket_number = sr.sr_ticket_number
        AND sts.ss_item_sk = sr.sr_item_sk
    JOIN filtered_dates fd
        ON sts.ss_sold_date_sk = fd.d_date_sk
    WHERE sr.sr_return_amt > 10000
        AND sts.ss_net_profit > 1
        AND sts.ss_net_paid > 0
        AND sts.ss_quantity > 0
    GROUP BY sts.ss_item_sk
),
store_ranked AS (
    SELECT
        item,
        return_qty_sum / sales_qty_sum AS return_ratio,
        return_amt_sum / sales_amt_sum AS currency_ratio,
        RANK() OVER (ORDER BY return_qty_sum / sales_qty_sum) AS return_rank,
        RANK() OVER (ORDER BY return_amt_sum / sales_amt_sum) AS currency_rank
    FROM store_agg
)
SELECT 'web' AS channel,
       item,
       return_ratio,
       return_rank,
       currency_rank
FROM web_ranked
WHERE return_rank <= 10 OR currency_rank <= 10
UNION
SELECT 'catalog' AS channel,
       item,
       return_ratio,
       return_rank,
       currency_rank
FROM catalog_ranked
WHERE return_rank <= 10 OR currency_rank <= 10
UNION
SELECT 'store' AS channel,
       item,
       return_ratio,
       return_rank,
       currency_rank
FROM store_ranked
WHERE return_rank <= 10 OR currency_rank <= 10
ORDER BY 1, 4, 5, 2
LIMIT 100
```

**Changes**: Isolated the shared `date_dim` filter into a reusable CTE (`filtered_dates`) and converted implicit joins to explicit JOIN syntax. This enables predicate pushdown and allows the small date dimension subset to be reused across all three channels without redundant scans.

**Expected speedup**: 1.2-1.5x due to reduced dimension table scanning and better join optimization opportunities.