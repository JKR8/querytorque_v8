```sql
WITH filtered_date AS (
    SELECT d_date_sk, d_date
    FROM date_dim
    WHERE d_date BETWEEN (CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY)
                     AND (CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY)
),
filtered_item AS (
    SELECT i_item_sk, i_item_id
    FROM item
    WHERE i_current_price BETWEEN 0.99 AND 1.49
)
SELECT
    w_state,
    i_item_id,
    SUM(
        CASE
            WHEN (CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE))
            THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)
            ELSE 0
        END
    ) AS sales_before,
    SUM(
        CASE
            WHEN (CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE))
            THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)
            ELSE 0
        END
    ) AS sales_after
FROM catalog_sales
LEFT OUTER JOIN catalog_returns
    ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk)
JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk
JOIN filtered_item ON i_item_sk = cs_item_sk
JOIN filtered_date ON cs_sold_date_sk = d_date_sk
GROUP BY
    w_state,
    i_item_id
ORDER BY
    w_state,
    i_item_id
LIMIT 100
```

**Changes**: Created filtered CTEs for date_dim and item to apply dimension constraints early, reducing rows before the large join with catalog_sales. Converted implicit joins to explicit JOIN syntax for clarity and better optimization.

**Expected speedup**: ~2-3x by filtering small dimension tables first and reducing the catalog_sales join to only matching rows.