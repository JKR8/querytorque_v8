```sql
WITH year_total_store AS (
  SELECT
    c_customer_id AS customer_id,
    c_first_name AS customer_first_name,
    c_last_name AS customer_last_name,
    c_preferred_cust_flag AS customer_preferred_cust_flag,
    c_birth_country AS customer_birth_country,
    c_login AS customer_login,
    c_email_address AS customer_email_address,
    d_year AS dyear,
    SUM(ss_ext_list_price - ss_ext_discount_amt) AS year_total
  FROM customer
  JOIN store_sales ON c_customer_sk = ss_customer_sk
  JOIN date_dim ON ss_sold_date_sk = d_date_sk
  GROUP BY
    c_customer_id,
    c_first_name,
    c_last_name,
    c_preferred_cust_flag,
    c_birth_country,
    c_login,
    c_email_address,
    d_year
),
year_total_web AS (
  SELECT
    c_customer_id AS customer_id,
    c_first_name AS customer_first_name,
    c_last_name AS customer_last_name,
    c_preferred_cust_flag AS customer_preferred_cust_flag,
    c_birth_country AS customer_birth_country,
    c_login AS customer_login,
    c_email_address AS customer_email_address,
    d_year AS dyear,
    SUM(ws_ext_list_price - ws_ext_discount_amt) AS year_total
  FROM customer
  JOIN web_sales ON c_customer_sk = ws_bill_customer_sk
  JOIN date_dim ON ws_sold_date_sk = d_date_sk
  GROUP BY
    c_customer_id,
    c_first_name,
    c_last_name,
    c_preferred_cust_flag,
    c_birth_country,
    c_login,
    c_email_address,
    d_year
)
SELECT
  s2.customer_id,
  s2.customer_first_name,
  s2.customer_last_name,
  s2.customer_birth_country
FROM year_total_store s1
JOIN year_total_store s2
  ON s1.customer_id = s2.customer_id
JOIN year_total_web w1
  ON s1.customer_id = w1.customer_id
JOIN year_total_web w2
  ON s1.customer_id = w2.customer_id
WHERE s1.dyear = 2001
  AND s2.dyear = 2001 + 1
  AND w1.dyear = 2001
  AND w2.dyear = 2001 + 1
  AND s1.year_total > 0
  AND w1.year_total > 0
  AND (
    CASE
      WHEN w1.year_total > 0 THEN w2.year_total / w1.year_total
      ELSE 0.0
    END
  ) > (
    CASE
      WHEN s1.year_total > 0 THEN s2.year_total / s1.year_total
      ELSE 0.0
    END
  )
ORDER BY
  s2.customer_id,
  s2.customer_first_name,
  s2.customer_last_name,
  s2.customer_birth_country
LIMIT 100
```

**Changes**: Split the UNION ALL CTE into separate store and web CTEs, converted implicit joins to explicit JOIN syntax, and eliminated redundant `sale_type` filters by channel separation.

**Expected speedup**: 1.5-2.0x due to reduced CTE complexity, better join planning, and elimination of redundant union processing.