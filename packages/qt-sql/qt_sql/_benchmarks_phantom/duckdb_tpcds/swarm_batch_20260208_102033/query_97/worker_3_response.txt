```sql
WITH filtered_dates AS (
  SELECT d_date_sk
  FROM date_dim
  WHERE d_month_seq BETWEEN 1214 AND 1214 + 11
),
store_agg AS (
  SELECT
    ss_customer_sk AS customer_sk,
    ss_item_sk AS item_sk
  FROM store_sales
  JOIN filtered_dates ON ss_sold_date_sk = d_date_sk
  GROUP BY ss_customer_sk, ss_item_sk
),
catalog_agg AS (
  SELECT
    cs_bill_customer_sk AS customer_sk,
    cs_item_sk AS item_sk
  FROM catalog_sales
  JOIN filtered_dates ON cs_sold_date_sk = d_date_sk
  GROUP BY cs_bill_customer_sk, cs_item_sk
)
SELECT
  SUM(CASE WHEN s.customer_sk IS NOT NULL AND c.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_only,
  SUM(CASE WHEN s.customer_sk IS NULL AND c.customer_sk IS NOT NULL THEN 1 ELSE 0 END) AS catalog_only,
  SUM(CASE WHEN s.customer_sk IS NOT NULL AND c.customer_sk IS NOT NULL THEN 1 ELSE 0 END) AS store_and_catalog
FROM store_agg s
FULL OUTER JOIN catalog_agg c
  ON s.customer_sk = c.customer_sk AND s.item_sk = c.item_sk
LIMIT 100
```

```
Changes: Created a shared CTE for filtered date_dim keys to eliminate duplicate scans, then performed separate aggregations for each sales channel using explicit JOINs.
Expected speedup: 1.5-2x by reducing dimension table scans from two to one and using more efficient join syntax.
```