{
  "benchmark": "duckdb_tpcds",
  "engine": "duckdb",
  "query_range": "q1-q99",
  "generated_at": "2026-02-07T13:15:15.133Z",
  "query_count": 99,
  "queries": [
    {
      "query_id": "q1",
      "query_intent": "Find South Dakota customers whose total 2000 store-return fees at a given store are more than 120% of that store's average customer return total, and list the matching customer IDs in sorted order.",
      "dag_nodes": [
        {
          "node_id": "customer_total_return",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate 2000 store returns to one row per (customer, store), summing return fees as each customer's total return amount at that store."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Compare each customer-store return total against 1.2x the same store's average return total, keep only South Dakota stores, join to customer, and output ordered customer IDs."
        }
      ]
    },
    {
      "query_id": "q2",
      "query_intent": "Compare day-of-week sales between 1998 and 1999 by week sequence using combined web and catalog sales, returning per-day sales ratios for week pairs exactly 53 weeks apart.",
      "dag_nodes": [
        {
          "node_id": "wscs",
          "node_type": "cte",
          "depth": 0,
          "intent": "Combine web and catalog sales into a shared stream of (sold_date_sk, sales_price) rows so both channels are analyzed together."
        },
        {
          "node_id": "wswscs",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate the combined sales stream to weekly totals split into Sunday-through-Saturday sales buckets."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Build 1998 and 1999 weekly views from the weekly bucketed totals, align weeks separated by 53, and compute day-by-day sales ratios with two-decimal rounding."
        }
      ]
    },
    {
      "query_id": "q3",
      "query_intent": "For items from manufacturer 816 sold in November, compute yearly total store-sales revenue by brand and rank results by year, descending revenue, then brand id.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join date, store sales, and item; filter to November and manufacturer 816; aggregate revenue by year and brand; then return the ordered top rows."
        }
      ]
    },
    {
      "query_id": "q4",
      "query_intent": "Find customers whose year-over-year growth from 1999 to 2000 is strongest in catalog sales by requiring catalog growth ratio to exceed both store and web growth ratios, then return customer identity fields.",
      "dag_nodes": [
        {
          "node_id": "year_total",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build per-customer, per-year totals for store, catalog, and web channels using the query's channel-specific profitability formula and label each row with its sale type."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Self-join channel/year totals for 1999 and 2000 by customer, enforce positive 1999 baselines, compare growth ratios across channels, and keep customers where catalog growth beats both store and web."
        }
      ]
    },
    {
      "query_id": "q5",
      "query_intent": "Summarize a 14-day window starting 2000-08-19 by channel and channel entity (store, catalog page, web site), reporting sales, returns, and net profit after losses, with rollup subtotals.",
      "dag_nodes": [
        {
          "node_id": "ssr",
          "node_type": "cte",
          "depth": 0,
          "intent": "Combine store sales and store returns into a single stream, align to the date window, and aggregate sales, returns, profit, and net-loss amounts per store id."
        },
        {
          "node_id": "csr",
          "node_type": "cte",
          "depth": 1,
          "intent": "Combine catalog sales and catalog returns into a single stream, align to the date window, and aggregate sales, returns, profit, and net-loss amounts per catalog page id."
        },
        {
          "node_id": "wsr",
          "node_type": "cte",
          "depth": 2,
          "intent": "Combine web sales with matching web returns, align to the date window, and aggregate sales, returns, profit, and net-loss amounts per web site id."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Union channel-level aggregates, derive net profit as profit minus loss, and produce grouped totals with rollup across channel and channel-specific id."
        }
      ]
    },
    {
      "query_id": "q6",
      "query_intent": "Count March 2002 store-sales activity by customer state, but only for transactions where item price is more than 120% of the average price within that item's category; keep states with at least 10 qualifying rows.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join customer address, customer, store sales, date, and item; pin to the target month sequence for March 2002; apply a correlated category-average price test; group by state and filter with HAVING."
        }
      ]
    },
    {
      "query_id": "q7",
      "query_intent": "For 2001 store sales to female, widowed, college-educated customers under promotions with email or event channel disabled, compute per-item averages for quantity, list price, coupon amount, and sales price.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Filter store sales by customer demographics, promotion-channel flags, and year; then aggregate item-level average purchase metrics and return items in id order."
        }
      ]
    },
    {
      "query_id": "q8",
      "query_intent": "Compute Q2 1998 net profit by store for stores whose ZIP prefix matches a targeted ZIP set built from a fixed ZIP list intersected with ZIPs having more than 10 preferred customers.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Derive eligible ZIP prefixes from an intersection subquery, join store sales/date/store, constrain to Q2 1998, match store ZIP prefixes to eligible customer ZIP prefixes, and sum net profit per store name."
        }
      ]
    },
    {
      "query_id": "q9",
      "query_intent": "Return five quantity-bucket metrics where each bucket chooses average extended sales price when bucket volume exceeds a threshold, otherwise average net profit, for store sales tied to reason key 1.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "For each quantity range (1-20, 21-40, 41-60, 61-80, 81-100), compute count and conditional average selection via CASE expressions, producing one output row with bucket1 through bucket5."
        }
      ]
    },
    {
      "query_id": "q10",
      "query_intent": "Profile customer demographics for selected counties by counting customers who bought in stores during Jan-Apr 2001 and also bought through either web or catalog in the same period.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join customer, address, and demographics; filter to the county list; enforce time-window purchase existence in store sales plus (web OR catalog) via EXISTS subqueries; then group and count by demographic dimensions."
        }
      ]
    },
    {
      "query_id": "q11",
      "query_intent": "Find customers whose web sales growth from 2001 to 2002 exceeds their store sales growth over the same years, requiring positive 2001 totals in both channels.",
      "dag_nodes": [
        {
          "node_id": "year_total",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build per-customer yearly totals for store and web channels from extended list price minus discount amount, tagging each row with channel sale type."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Self-join 2001 and 2002 totals for both channels by customer, require positive baseline totals, compare web vs store growth ratios, and return matching customer identity fields."
        }
      ]
    },
    {
      "query_id": "q12",
      "query_intent": "Within a 30-day window starting 1998-04-06, compute web-sales revenue by item for Books, Sports, and Men categories, then calculate each item's percentage contribution within its item class.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join web sales to item and date, filter to the date window and target categories, aggregate revenue per item attributes, and compute class-level revenue share using a window partition on i_class."
        }
      ]
    },
    {
      "query_id": "q13",
      "query_intent": "Compute average quantity, average sales metrics, and total wholesale cost for 2001 store sales that match specific demographic-and-price bands and specific address-state-and-profit bands.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Filter store-sales rows by three OR-connected household/demographic/price scenarios and three OR-connected U.S. state/net-profit scenarios, then return overall aggregate statistics across all qualifying rows."
        }
      ]
    },
    {
      "query_id": "q14",
      "query_intent": "Identify item brand/class/category combinations sold across store, catalog, and web channels during 2000-2002, then report channel-level sales and transaction counts for November 2002 where channel totals exceed the multi-year average sales baseline.",
      "dag_nodes": [
        {
          "node_id": "cross_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build the shared item set by intersecting brand/class/category combinations that appear in store, catalog, and web sales during 2000-2002, then map those combinations back to item keys."
        },
        {
          "node_id": "avg_sales",
          "node_type": "cte",
          "depth": 1,
          "intent": "Compute a cross-channel average of quantity*list_price over store, catalog, and web sales for 2000-2002 to serve as the sales threshold."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Aggregate November 2002 sales for each channel over the cross-channel item set, keep groups above the computed average-sales threshold, union channels, and output rollup subtotals by channel and product hierarchy."
        }
      ]
    },
    {
      "query_id": "q15",
      "query_intent": "Sum Q1 2001 catalog sales by billing ZIP for customers selected by either a target ZIP list, a target state list, or high transaction amount (>500).",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join catalog sales with customer, address, and date; apply the OR-based geographic/high-value customer filter; aggregate sales by ZIP; and return ZIP-sorted totals."
        }
      ]
    },
    {
      "query_id": "q16",
      "query_intent": "For catalog shipments from 2002-04-01 through 60 days later, measure distinct order count, shipping cost, and net profit for WV shipments handled by selected call-center counties, limited to multi-warehouse orders with no returns.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Filter catalog sales by ship date range, destination state, and call-center county; require same order number to appear with a different warehouse; exclude orders that appear in catalog_returns; then aggregate the requested order and profitability metrics."
        }
      ]
    },
    {
      "query_id": "q17",
      "query_intent": "For store-sales items sold in 2001Q1 that were returned and then purchased via catalog within 2001Q1-Q3, compute count, average, standard deviation, and coefficient-of-variation statistics across store sales, returns, and catalog sales by item and store state.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Link store sales to matching returns and catalog sales through customer/item relationships and quarter filters, then aggregate multi-channel quantity distribution statistics per item and state."
        }
      ]
    },
    {
      "query_id": "q18",
      "query_intent": "For 1998 catalog sales to female customers with advanced degrees and selected birth months in selected states, compute grouped averages of sales/customer metrics with rollups over item and geography.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join catalog sales to item, date, customer, two demographic roles, and address; enforce demographic, birth-month, year, and state filters; then compute average metric columns and output ROLLUP totals across item/country/state/county."
        }
      ]
    },
    {
      "query_id": "q19",
      "query_intent": "Rank December 1999 store-sales revenue by brand/manufacturer for manager_id=2 items purchased by customers whose current ZIP differs from the selling store ZIP prefix.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales with date, item, customer, address, and store; filter by month/year, manager id, and ZIP-prefix mismatch; aggregate extended sales price by brand/manufacturer attributes; and order by descending revenue."
        }
      ]
    },
    {
      "query_id": "q20",
      "query_intent": "Within a 30-day window starting 2002-01-26, compute catalog-sales revenue by item for Shoes, Books, and Women categories, then calculate each item's percentage contribution within its item class.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join catalog sales to item and date, filter to the date window and target categories, aggregate revenue per item attributes, and compute class-level revenue share using a window partition on i_class."
        }
      ]
    },
    {
      "query_id": "q21",
      "query_intent": "Compare inventory levels before and after 2002-02-27 for low-priced items (0.99-1.49) by warehouse and item, keeping only cases where post-period inventory is roughly balanced to pre-period inventory (ratio between 2/3 and 3/2).",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate on-hand inventory in two 30-day windows around 2002-02-27 using CASE splits, then filter warehouse-item groups by the before/after ratio band and return ordered identifiers."
        }
      ]
    },
    {
      "query_id": "q22",
      "query_intent": "Compute average inventory on hand across month sequence 1188-1199 and report rollup totals from product name down to category, ordered by lowest average quantity.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join inventory with date and item, restrict to the 12-month window, aggregate average on-hand quantity under a product hierarchy ROLLUP, and sort by qoh plus product attributes."
        }
      ]
    },
    {
      "query_id": "q23",
      "query_intent": "Estimate May 2000 cross-channel demand from high-value store customers by summing catalog and web sales for items that were frequently sold in stores during 2000-2003.",
      "dag_nodes": [
        {
          "node_id": "frequent_ss_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Identify store items that sell more than four times per day/description slice during 2000-2003 to define the frequent-item set."
        },
        {
          "node_id": "max_store_sales",
          "node_type": "cte",
          "depth": 1,
          "intent": "Compute the maximum customer store-sales amount over 2000-2003 as the benchmark for top-customer selection."
        },
        {
          "node_id": "best_ss_customer",
          "node_type": "cte",
          "depth": 2,
          "intent": "Select customers whose cumulative store sales exceed 95% of the maximum customer store-sales benchmark."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Union May 2000 catalog and web sales for frequent items purchased by top store customers, then sum the combined sales amount."
        }
      ]
    },
    {
      "query_id": "q24",
      "query_intent": "Summarize net paid profit by customer and store for market 8 where purchases were returned, customer ZIP matches store ZIP, and customer birth country differs from address country; then keep only selected item-color groups above a relative profit threshold.",
      "dag_nodes": [
        {
          "node_id": "ssales",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build customer-store-item aggregates of ss_net_profit for transactions with matching returns under the market/ZIP/country constraints."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Filter the intermediate set by target item color (template variant), aggregate paid profit per customer/store, and keep groups above 5% of the overall average netpaid."
        }
      ]
    },
    {
      "query_id": "q25",
      "query_intent": "For April-October 2000 linked customer-item flows, report per-item and per-store profitability by combining April store sales, subsequent store returns, and subsequent catalog sales.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join April 2000 store sales to matching returns (Apr-Oct 2000) and to catalog sales on the same customer/item (Apr-Oct 2000), then aggregate store sales profit, return loss, and catalog sales profit by item/store."
        }
      ]
    },
    {
      "query_id": "q26",
      "query_intent": "For 2001 catalog sales to male, single customers with unknown education under promotions where email or event channel is disabled, compute per-item average quantity and price/discount metrics.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join catalog sales with customer demographics, date, item, and promotion; apply demographic and promotion filters; then aggregate item-level averages and return ordered item ids."
        }
      ]
    },
    {
      "query_id": "q27",
      "query_intent": "For 1999 store sales to female, divorced, secondary-educated customers in selected states, compute item-level average quantity and pricing metrics with rollup subtotals by state.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales with demographics, date, store, and item; apply year/state/demographic filters; aggregate averages under ROLLUP(i_item_id, s_state); and return ordered rows including grouping-state flags."
        }
      ]
    },
    {
      "query_id": "q28",
      "query_intent": "Return six side-by-side quantity-bucket profiles of store sales, each with average list price, row count, and distinct list-price count under bucket-specific price/coupon/wholesale filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Evaluate six independent bucket subqueries (quantity ranges 0-5 through 26-30) and cross-join their aggregate outputs into one comparison row."
        }
      ]
    },
    {
      "query_id": "q29",
      "query_intent": "Compare average quantities across store sales, store returns, and catalog sales for matched customer-item flows anchored on April 1999 store sales, grouped by item and store.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join April 1999 store sales to related returns in the following 4-month window and to catalog sales for the same customer/item across 1999-2001, then compute channel-specific average quantities by item/store."
        }
      ]
    },
    {
      "query_id": "q30",
      "query_intent": "Find Indiana customers whose 2002 web-return amount is more than 120% of the average return amount for their return state, and return detailed customer profile fields with total return.",
      "dag_nodes": [
        {
          "node_id": "customer_total_return",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate 2002 web return amounts by returning customer and return-address state."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Compare each customer-state return total to 1.2x the state average, join to customer and current address, restrict output to customers currently in Indiana, and return sorted profile records."
        }
      ]
    },
    {
      "query_id": "q31",
      "query_intent": "Compare county-level quarter-over-quarter growth in 2000 web sales versus store sales, returning counties where web growth beats store growth from Q1->Q2 and again from Q2->Q3.",
      "dag_nodes": [
        {
          "node_id": "ss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store extended sales by county, quarter, and year from store_sales with customer address geography."
        },
        {
          "node_id": "ws",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate web extended sales by county, quarter, and year from web_sales with billing address geography."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Self-join county-quarter aggregates for Q1/Q2/Q3 in 2000, compute growth ratios for both channels, and keep counties where web ratios exceed store ratios in both transitions."
        }
      ]
    },
    {
      "query_id": "q32",
      "query_intent": "Sum catalog discount amounts for manufacturer 29 items sold in a 90-day window from 1999-01-07 where each row's discount is greater than 130% of that item's average discount in the same window.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join catalog sales with item and date, apply manufacturer and date-window filters, and use a correlated subquery to compare each row's discount against 1.3x the item-specific average discount."
        }
      ]
    },
    {
      "query_id": "q33",
      "query_intent": "Compute January 2002 sales for Home-category manufacturers at GMT offset -5 across store, catalog, and web channels, then combine channels to rank manufacturers by total sales.",
      "dag_nodes": [
        {
          "node_id": "ss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate January 2002 store sales by manufacturer for Home-category items sold to addresses at GMT offset -5."
        },
        {
          "node_id": "cs",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate January 2002 catalog sales by manufacturer for Home-category items billed to addresses at GMT offset -5."
        },
        {
          "node_id": "ws",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate January 2002 web sales by manufacturer for Home-category items billed to addresses at GMT offset -5."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Union manufacturer totals from all three channels and sum to a cross-channel total sales figure per manufacturer."
        }
      ]
    },
    {
      "query_id": "q34",
      "query_intent": "Find customer tickets with medium-high line counts (15-20) under specific day-of-month, county, and household buy-potential/vehicle/dependent conditions over 1998-2000, then return customer identity details.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count line items per ticket and customer for filtered store-sales rows, retain ticket groups with counts between 15 and 20, join to customer, and output ordered identity and ticket fields."
        }
      ]
    },
    {
      "query_id": "q35",
      "query_intent": "Profile household dependent metrics by state and customer demographics for customers who purchased in store during 2001 Q1-Q3 and also purchased via web or catalog in the same period.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join customer/address/demographics, enforce multi-channel purchase existence constraints for 2001 quarters 1-3, then group by geography and demographic dependent-count attributes to compute counts/sums/max statistics."
        }
      ]
    },
    {
      "query_id": "q36",
      "query_intent": "Compute gross margin (net profit / extended sales) for 2002 store sales in selected states at category/class hierarchy levels, and rank classes within each hierarchy parent by ascending margin.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales with date, item, and store; filter by year and state list; aggregate gross margin under ROLLUP(i_category, i_class); then apply window ranking within hierarchy levels."
        }
      ]
    },
    {
      "query_id": "q37",
      "query_intent": "Return items in a target price band and manufacturer set that had inventory between 100 and 500 units during a 60-day window from 1999-02-21 and also appear in catalog sales.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join item, inventory, date, and catalog sales; apply price, manufacturer, inventory-level, and date-window filters; then return grouped item identity and current price rows."
        }
      ]
    },
    {
      "query_id": "q38",
      "query_intent": "Count distinct customer-name/date combinations that occur in all three channels (store, catalog, and web) within month sequence 1183-1194.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Build distinct customer/date sets per channel over the 12-month sequence, intersect the three sets, and return the final count of shared customer shopping dates."
        }
      ]
    },
    {
      "query_id": "q39",
      "query_intent": "For 1998 inventory, identify warehouse-item combinations with high monthly variability (coefficient of variation > 1), then compare January and February mean/cov values for the same warehouse-item pairs.",
      "dag_nodes": [
        {
          "node_id": "inv",
          "node_type": "cte",
          "depth": 0,
          "intent": "Compute monthly mean and standard deviation of on-hand inventory by warehouse and item, derive coefficient of variation, and keep high-variability groups."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Self-join the variability-filtered inventory summary for month 1 and month 2 on the same warehouse-item keys and return side-by-side monthly statistics."
        }
      ]
    },
    {
      "query_id": "q40",
      "query_intent": "For low-priced items (0.99-1.49), compare net catalog sales before and after 2001-04-02 by warehouse state and item over a +/-30-day window, netting out refunded cash.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join catalog sales with optional returns, warehouse, item, and date; split net sales into before/after buckets with CASE expressions; then aggregate by warehouse state and item id."
        }
      ]
    },
    {
      "query_id": "q41",
      "query_intent": "Return product names from manufacturers 748-788 where at least one item from the same manufacturer matches either of two large OR-pattern attribute bundles across category, color, units, and size.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "For each candidate item, run a correlated count over same-manufacturer items that satisfy the complex attribute bundles, keep manufacturers with count>0, and output distinct product names ordered alphabetically."
        }
      ]
    },
    {
      "query_id": "q42",
      "query_intent": "For manager_id=1 items sold in November 2002, summarize store extended sales by item category and rank categories by descending sales.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales with date and item, filter to d_year=2002/d_moy=11 and i_manager_id=1, aggregate sales by category id/name, and sort by total sales then category attributes."
        }
      ]
    },
    {
      "query_id": "q43",
      "query_intent": "Compute 2000 weekday sales profiles for each store in GMT offset -5, returning Sunday-through-Saturday sales totals per store.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales with date and store, filter to year 2000 and target time-zone offset, then pivot day-of-week sales into separate SUM(CASE) columns per store."
        }
      ]
    },
    {
      "query_id": "q44",
      "query_intent": "For store 146, pair top-10 and bottom-10 items by average net profit (subject to a baseline threshold) at matching rank positions, showing best and worst product names side-by-side.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Build ascending and descending item rankings from store-level average net profit, filter both to top 10 ranks, join on rank number, and map item keys to product names."
        }
      ]
    },
    {
      "query_id": "q45",
      "query_intent": "Sum Q2 2000 web sales by customer ZIP and city for customers selected by either a target ZIP prefix list or purchases of items in a designated key-item set.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join web sales with customer/address/date/item, apply the OR-based geography-or-item filter, restrict to 2000 Q2, and aggregate sales by ZIP and city."
        }
      ]
    },
    {
      "query_id": "q46",
      "query_intent": "Return weekend ticket-level coupon and profit totals for selected store cities during 1999-2001 where household demographic conditions hold, then keep customers whose current city differs from the purchase city.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate ticket metrics by customer and bought-city under the date/store/household filters, join to customer and current address, filter city mismatch, and output ordered customer and ticket fields."
        }
      ]
    },
    {
      "query_id": "q47",
      "query_intent": "Detect 2001 monthly store-sales outliers by brand/category/store where a month's sales deviate by more than 10% from that year's average monthly sales, using adjacent-month context.",
      "dag_nodes": [
        {
          "node_id": "v1",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate monthly store sales by category/brand/store/company for Dec-2000 through Jan-2002, and compute yearly average monthly sales plus sequential month rank."
        },
        {
          "node_id": "v2",
          "node_type": "cte",
          "depth": 1,
          "intent": "Self-join monthly rows to prior and next month within the same category/brand/store/company to expose neighboring sales context."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Keep 2001 rows with nonzero average monthly sales and >10% relative deviation from that average, then order by deviation and next-month sales."
        }
      ]
    },
    {
      "query_id": "q48",
      "query_intent": "Sum 1999 store-sales quantity for transactions matching specific demographic-and-price combinations and specific U.S. state/net-profit bands.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales with store, demographics, address, and date; apply the OR-combined demographic/price clauses and OR-combined location/profit clauses; then return the total quantity sum."
        }
      ]
    },
    {
      "query_id": "q49",
      "query_intent": "Across web, catalog, and store channels for Dec-1999, rank items by return-quantity ratio and return-currency ratio, and return rows that are top-10 on either ranking within each channel.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "For each channel, left-join sales to returns, compute item-level quantity and value return ratios under profitability/volume constraints, rank items by both ratios, keep top-10 by either metric, and union channel outputs."
        }
      ]
    },
    {
      "query_id": "q50",
      "query_intent": "For returns processed in August 2001, bucket store return latency (days between sale and return) into five ranges and report counts per store identity/address.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales, returns, store, and date dimensions; filter return month/year; compute day-difference buckets with CASE expressions; then aggregate bucket counts by detailed store attributes."
        }
      ]
    },
    {
      "query_id": "q51",
      "query_intent": "Compare item-level cumulative daily sales between web and store channels over month sequence 1216-1227, returning dates where web cumulative sales exceed store cumulative sales.",
      "dag_nodes": [
        {
          "node_id": "web_v1",
          "node_type": "cte",
          "depth": 0,
          "intent": "Compute cumulative web sales per item by date within the 12-month sequence using windowed running sums."
        },
        {
          "node_id": "store_v1",
          "node_type": "cte",
          "depth": 1,
          "intent": "Compute cumulative store sales per item by date within the same sequence using windowed running sums."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Full-outer-join web and store daily cumulative series by item/date, carry forward cumulative maxima, and keep rows where web cumulative exceeds store cumulative."
        }
      ]
    },
    {
      "query_id": "q52",
      "query_intent": "For manager_id=1 items sold in December 2002, summarize store extended sales by brand and return brands ranked by descending revenue.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales with date and item, filter to d_year=2002/d_moy=12 and manager 1, aggregate by brand id/name, and order by highest ext_price."
        }
      ]
    },
    {
      "query_id": "q53",
      "query_intent": "Identify manufacturers with quarterly sales volatility in month sequence 1200-1211 for selected category/class/brand bundles by flagging quarter totals that deviate more than 10% from manufacturer average quarterly sales.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate store sales by manufacturer and quarter under the item-attribute filters, compute manufacturer average quarterly sales via window function, and keep rows with relative deviation above 10%."
        }
      ]
    },
    {
      "query_id": "q54",
      "query_intent": "Segment customers by follow-on store revenue after they bought Women/maternity items via catalog or web in May 1998, using revenue bands of size 50.",
      "dag_nodes": [
        {
          "node_id": "my_customers",
          "node_type": "cte",
          "depth": 0,
          "intent": "Collect distinct customers who purchased Women/maternity items via catalog or web in May 1998 and carry their current address keys."
        },
        {
          "node_id": "my_revenue",
          "node_type": "cte",
          "depth": 1,
          "intent": "For those customers, sum store-sales extended price in the next three month sequences where customer county/state matches store county/state."
        },
        {
          "node_id": "segments",
          "node_type": "cte",
          "depth": 2,
          "intent": "Convert each customer revenue into an integer segment bucket by dividing by 50."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Count customers per revenue segment and report segment id with segment base amount."
        }
      ]
    },
    {
      "query_id": "q55",
      "query_intent": "For manager_id=100 items sold in December 2000, compute store extended sales by brand and order brands by descending revenue.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales with date and item, filter to d_year=2000/d_moy=12 and manager 100, aggregate extended sales by brand, and return top revenue brands."
        }
      ]
    },
    {
      "query_id": "q56",
      "query_intent": "Compute February 2000 total sales per item (colors powder/green/cyan) across store, catalog, and web channels for addresses at GMT offset -6.",
      "dag_nodes": [
        {
          "node_id": "ss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate February 2000 store sales by item id for selected item colors and GMT offset -6 addresses."
        },
        {
          "node_id": "cs",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate February 2000 catalog sales by item id for selected item colors and GMT offset -6 billing addresses."
        },
        {
          "node_id": "ws",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate February 2000 web sales by item id for selected item colors and GMT offset -6 billing addresses."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Union channel totals and sum to a cross-channel total_sales per item id."
        }
      ]
    },
    {
      "query_id": "q57",
      "query_intent": "Detect 1999 monthly catalog-sales outliers by brand/category/call-center where monthly sales deviate more than 10% from that year's average monthly sales, using adjacent-month context.",
      "dag_nodes": [
        {
          "node_id": "v1",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate monthly catalog sales by category/brand/call-center for Dec-1998 through Jan-2000, and compute yearly average monthly sales plus sequence rank."
        },
        {
          "node_id": "v2",
          "node_type": "cte",
          "depth": 1,
          "intent": "Self-join monthly rows with prior and next month within the same category/brand/call-center series."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Keep 1999 rows with nonzero average monthly sales and >10% relative deviation, then order by deviation and next-month sales."
        }
      ]
    },
    {
      "query_id": "q58",
      "query_intent": "Compare weekly item revenue consistency across store, catalog, and web channels for the week containing 2001-03-24, returning items whose channel revenues are all within +/-10% of each other.",
      "dag_nodes": [
        {
          "node_id": "ss_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store revenue per item for the target week."
        },
        {
          "node_id": "cs_items",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate catalog revenue per item for the target week."
        },
        {
          "node_id": "ws_items",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate web revenue per item for the target week."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Join per-channel item revenues, enforce pairwise +/-10% consistency across all channels, and report each item with channel deviations from the cross-channel average."
        }
      ]
    },
    {
      "query_id": "q59",
      "query_intent": "For each store, compare day-of-week sales ratios between two consecutive 12-month periods starting at month sequence 1196 by aligning weeks exactly 52 apart.",
      "dag_nodes": [
        {
          "node_id": "wss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store sales by week and store into Sunday-through-Saturday sales buckets."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Build year1 and year2 weekly views from the bucketed data, match same store and week offset by 52, and compute day-level ratio comparisons."
        }
      ]
    },
    {
      "query_id": "q60",
      "query_intent": "Compute August 2000 total sales per Children-category item across store, catalog, and web channels for addresses at GMT offset -7.",
      "dag_nodes": [
        {
          "node_id": "ss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate August 2000 store sales by item id for Children-category items and GMT offset -7 addresses."
        },
        {
          "node_id": "cs",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate August 2000 catalog sales by item id for Children-category items and GMT offset -7 billing addresses."
        },
        {
          "node_id": "ws",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate August 2000 web sales by item id for Children-category items and GMT offset -7 billing addresses."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Union channel totals and sum to a cross-channel total_sales per item id."
        }
      ]
    },
    {
      "query_id": "q61",
      "query_intent": "Calculate November 1999 promotional-store-sales share for Jewelry in GMT offset -7 by dividing promotion-qualified sales by total sales under the same geography/category constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compute promotional sales and all sales in parallel aggregate subqueries, then output promotions, total, and promotions/total percentage."
        }
      ]
    },
    {
      "query_id": "q62",
      "query_intent": "Classify web order shipment latency over a 12-month window from month sequence 1194, grouped by warehouse, ship mode, and web site.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join web sales with warehouse, ship mode, web site, and ship date; bucket ship-date minus sold-date into five ranges via CASE sums; and aggregate counts by shipping context."
        }
      ]
    },
    {
      "query_id": "q63",
      "query_intent": "Find item managers with monthly sales volatility over month sequence 1181-1192 for selected item attribute bundles by flagging months that differ more than 10% from the manager's average monthly sales.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate store sales by manager and month under the category/class/brand filters, compute manager-level average monthly sales with a window function, and keep rows with >10% relative deviation."
        }
      ]
    },
    {
      "query_id": "q64",
      "query_intent": "Compare year-over-year store-sales behavior (2001 vs 2002) for high net-sales catalog-return items under a broad demographic/address/item constraint set, matching same item and store between years.",
      "dag_nodes": [
        {
          "node_id": "cs_ui",
          "node_type": "cte",
          "depth": 0,
          "intent": "Identify catalog items whose gross list-price sales exceed twice their refunded/reversed/store-credit return amounts."
        },
        {
          "node_id": "cross_sales",
          "node_type": "cte",
          "depth": 1,
          "intent": "Build detailed store-sales aggregates for transactions tied to returned tickets and qualifying catalog items, carrying item/store/address/year attributes plus count and cost/list/coupon sums."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Self-join cross_sales for 2001 and 2002 on item and store, keep pairs where next-year count is not higher, and return side-by-side yearly sales feature columns."
        }
      ]
    },
    {
      "query_id": "q65",
      "query_intent": "For month sequence 1221-1232, list low-performing store-item pairs whose revenue is at most 10% of that store's average item revenue, including item/store descriptive fields.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compute per-store average item revenue and per-store-item revenue over the same 12-month window, filter low-revenue pairs by the 10% threshold, and join store/item dimensions for output."
        }
      ]
    },
    {
      "query_id": "q66",
      "query_intent": "Summarize 1998 warehouse monthly sales and net paid amounts (plus per-square-foot metrics) for shipments handled by carriers GREAT EASTERN or LATVIAN during a target time-of-day window, combining web and catalog channels.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate monthly channel metrics from web_sales and catalog_sales under shared warehouse/time/ship-mode filters, union channels, then roll up to warehouse/year/carrier totals including per-sq-ft calculations."
        }
      ]
    },
    {
      "query_id": "q67",
      "query_intent": "Rank high-selling product hierarchy rows within each category over month sequence 1206-1217, using rollup aggregates across category/class/brand/product/time/store dimensions and keeping top 100 per category.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate store sales quantity*price under a multi-level ROLLUP, compute rank by descending sumsales within each category, and retain rows with rank <= 100."
        }
      ]
    },
    {
      "query_id": "q68",
      "query_intent": "Return ticket-level extended sales/tax/list totals for selected stores and household conditions over 1998-2000 where the customer's current city differs from the purchase city.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate ticket measures by customer and bought city under day/month/year/store/household filters, join to customer current address, filter city mismatch, and output customer/ticket details."
        }
      ]
    },
    {
      "query_id": "q69",
      "query_intent": "Profile demographics for customers in TX/VA/MI who bought in stores during Jan-Mar 2000 but had no web or catalog purchases in that same period.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join customer/address/demographics, enforce store-sales EXISTS and web/catalog NOT EXISTS constraints over the Jan-Mar 2000 window, then group and count by demographic dimensions."
        }
      ]
    },
    {
      "query_id": "q70",
      "query_intent": "Rank state and county net profit over month sequence 1213-1224 for top-performing states, using hierarchy-aware rollups and within-parent ranking.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate store net profit by ROLLUP(s_state, s_county) for the target months, restrict states to a top-ranked set from a subquery, and compute hierarchy-level ranks with window functions."
        }
      ]
    },
    {
      "query_id": "q71",
      "query_intent": "For manager_id=1 items sold in Dec-1998, combine web/catalog/store sales and report brand-level revenue by clock time (hour/minute) for breakfast and dinner periods.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Union channel sales into a common stream with sold time keys, join item and time dimensions, filter to meal times breakfast/dinner, and aggregate ext_price by brand and minute-level time."
        }
      ]
    },
    {
      "query_id": "q72",
      "query_intent": "For 2002 widow customers with buy-potential 501-1000, summarize catalog order counts by item/warehouse/week and split totals into promo vs non-promo where inventory was below sold quantity and ship date lag exceeded 5 days.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join catalog sales with inventory, warehouse, item, demographics, date dimensions, optional promotion, and optional returns; apply stockout and ship-lag conditions; then count promo/non-promo rows per item/warehouse/week."
        }
      ]
    },
    {
      "query_id": "q73",
      "query_intent": "Find customer tickets with low line counts (1-5) under selected household buy-potential and county filters for day-of-month 1-2 during 2000-2002.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count rows per ticket and customer for filtered store-sales transactions, keep counts between 1 and 5, join to customer, and return customer identity with ticket count ordered by highest count."
        }
      ]
    },
    {
      "query_id": "q74",
      "query_intent": "Find customers whose year-over-year change in web-payment variability (stddev of net paid) from 1999 to 2000 exceeds the corresponding change in store-payment variability.",
      "dag_nodes": [
        {
          "node_id": "year_total",
          "node_type": "cte",
          "depth": 0,
          "intent": "Compute per-customer yearly standard deviation of net paid for store and web channels in 1999 and 2000."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Self-join customer/channel/year variability rows, require positive 1999 variability baselines, compare web versus store year-over-year ratios, and return matching customer names."
        }
      ]
    },
    {
      "query_id": "q75",
      "query_intent": "Compare 1999 versus 1998 net unit and sales amount performance for Home-category brand/class/manufacturer combinations across all channels after subtracting returns, and keep combinations with at least 10% unit decline.",
      "dag_nodes": [
        {
          "node_id": "all_sales",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build channel-neutral yearly sales count and sales amount metrics by brand/class/category/manufacturer using sales minus returns from catalog, store, and web."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Join 1999 metrics to 1998 metrics on product keys, compute year-over-year differences, filter to curr/prev sales_cnt ratio below 0.9, and order by declines."
        }
      ]
    },
    {
      "query_id": "q76",
      "query_intent": "Count and sum sales for rows with specific NULL foreign-key anomalies across store/web/catalog channels, grouped by channel, affected column name, year, quarter, and item category.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Union three channel-specific NULL-condition extracts (ss_hdemo_sk, ws_bill_addr_sk, cs_warehouse_sk), then aggregate anomaly counts and sales amounts by channel/time/category dimensions."
        }
      ]
    },
    {
      "query_id": "q77",
      "query_intent": "Summarize 30-day performance from 1998-08-05 across store, catalog, and web channels by combining sales, returns, and net profit at channel entity level with rollup subtotals.",
      "dag_nodes": [
        {
          "node_id": "ss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store sales and profit by store for the 30-day window."
        },
        {
          "node_id": "sr",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate store return amount and net loss by store for the same window."
        },
        {
          "node_id": "cs",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate catalog sales and profit by call center for the window."
        },
        {
          "node_id": "cr",
          "node_type": "cte",
          "depth": 3,
          "intent": "Aggregate catalog returns and net loss by call center for the window."
        },
        {
          "node_id": "ws",
          "node_type": "cte",
          "depth": 4,
          "intent": "Aggregate web sales and profit by web page for the window."
        },
        {
          "node_id": "wr",
          "node_type": "cte",
          "depth": 5,
          "intent": "Aggregate web returns and net loss by web page for the window."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 6,
          "intent": "Combine channel aggregates, net profits against losses, and produce rollup totals by channel and channel-specific id."
        }
      ]
    },
    {
      "query_id": "q78",
      "query_intent": "For 2000 non-returned transactions, compare store quantity and value against combined web+catalog quantity and value for the same customer-item-year records.",
      "dag_nodes": [
        {
          "node_id": "ws",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate yearly non-returned web quantities, wholesale cost, and sales price by item and billing customer."
        },
        {
          "node_id": "cs",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate yearly non-returned catalog quantities, wholesale cost, and sales price by item and billing customer."
        },
        {
          "node_id": "ss",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate yearly non-returned store quantities, wholesale cost, and sales price by item and customer."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Left-join store aggregates to web and catalog aggregates on year/item/customer, keep rows with other-channel activity, and report store-to-other-channel quantity ratio and value comparisons."
        }
      ]
    },
    {
      "query_id": "q79",
      "query_intent": "Return Monday ticket-level coupon/profit summaries for 1998-2000 store transactions in medium-sized stores with specific household dependent/vehicle conditions, along with customer names and store city.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate ticket metrics by customer and store city under date/store/household filters, join to customer names, and order results by customer and profitability."
        }
      ]
    },
    {
      "query_id": "q80",
      "query_intent": "For a 30-day window from 1998-08-28 with non-TV promotions and items priced above 50, summarize sales, returns, and profit by store, catalog page, and web site with rollup subtotals.",
      "dag_nodes": [
        {
          "node_id": "ssr",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store-channel sales/returns/profit by store id from store sales left-joined to store returns under the date, item-price, and promotion filters."
        },
        {
          "node_id": "csr",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate catalog-channel sales/returns/profit by catalog page id from catalog sales left-joined to catalog returns under the same filters."
        },
        {
          "node_id": "wsr",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate web-channel sales/returns/profit by web site id from web sales left-joined to web returns under the same filters."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Union channel aggregates, label channel/entity ids, and produce rollup totals of sales, returns, and profit by channel and id."
        }
      ]
    },
    {
      "query_id": "q81",
      "query_intent": "Find California customers whose 2002 catalog return amount (including tax) is more than 120% of the average return amount for their return state, and output detailed address/profile fields.",
      "dag_nodes": [
        {
          "node_id": "customer_total_return",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate 2002 catalog return amounts with tax by returning customer and return-address state."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Compare each customer-state return total to 1.2x the state average, join to current customer address, restrict to CA current state, and return sorted customer/address details."
        }
      ]
    },
    {
      "query_id": "q82",
      "query_intent": "Return items in a target price band and manufacturer set that had inventory between 100 and 500 units during a 60-day window from 1999-07-09 and also appear in store sales.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join item, inventory, date, and store sales; apply price/manufacturer/inventory/date filters; group by item identity; and output qualifying item records."
        }
      ]
    },
    {
      "query_id": "q83",
      "query_intent": "Compare item return quantities across store, catalog, and web channels for weeks containing three reference dates in 2001, and report each channel's deviation from the cross-channel average.",
      "dag_nodes": [
        {
          "node_id": "sr_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store return quantity by item for weeks containing 2001-06-06, 2001-09-02, and 2001-11-11."
        },
        {
          "node_id": "cr_items",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate catalog return quantity by item for the same selected weeks."
        },
        {
          "node_id": "wr_items",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate web return quantity by item for the same selected weeks."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Join channel return aggregates by item and compute per-channel percentage deviation from the average of the three channel quantities."
        }
      ]
    },
    {
      "query_id": "q84",
      "query_intent": "List customers in Oakwood with current household income band around lower bound 5806-55806 who have matching customer demographics in store returns.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join customer, current address, demographics, household demographics, income band, and store returns on demographic keys; apply city and income-band bounds; and output ordered customer name/id fields."
        }
      ]
    },
    {
      "query_id": "q85",
      "query_intent": "For 2000 web sales with matching returns, compute reason-level averages of quantity, refunded cash, and return fee under matched refunded/returning demographic profiles and state/net-profit/price filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join web sales, web returns, web page, two demographic roles, address, date, and reason; enforce OR-based marital/education/price clauses plus OR-based state/profit clauses; then aggregate reason-level averages."
        }
      ]
    },
    {
      "query_id": "q86",
      "query_intent": "Rank web net paid totals over month sequence 1224-1235 by item category/class hierarchy, producing rollup-level totals and within-parent rank.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join web sales with date and item, aggregate ws_net_paid under ROLLUP(i_category, i_class), and apply hierarchy-aware ranking by descending total_sum."
        }
      ]
    },
    {
      "query_id": "q87",
      "query_intent": "Count customer-name/date combinations that appear in store sales during month sequence 1184-1195 but do not appear in catalog or web sales for the same period.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Build distinct customer/date sets for store, catalog, and web channels over the 12-month window, subtract catalog and web sets from store set via EXCEPT, and return the count."
        }
      ]
    },
    {
      "query_id": "q88",
      "query_intent": "Count store sales by consecutive half-hour windows from 8:30 to 12:30 at store \"ese\" for households matching specific dependent/vehicle constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compute eight independent time-slice counts under identical household/store filters and return them in one cross-joined row for side-by-side comparison."
        }
      ]
    },
    {
      "query_id": "q89",
      "query_intent": "Identify 1999 monthly store-sales outliers by category/class/brand/store/company for selected item-category/class groups where monthly sales deviate more than 10% from the group's average monthly sales.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate monthly sales by product/store dimensions, compute average monthly sales with a window function, filter rows with >10% relative deviation, and order by deviation and store."
        }
      ]
    },
    {
      "query_id": "q90",
      "query_intent": "Compute the ratio of AM to PM web order counts for households with two dependents viewing medium-length pages, comparing 10:00-11:59 versus 16:00-17:59 time windows.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Calculate qualifying web-sales counts for the AM and PM windows in two aggregate subqueries and divide AM count by PM count to produce am_pm_ratio."
        }
      ]
    },
    {
      "query_id": "q91",
      "query_intent": "For November 2001 catalog returns, aggregate net loss by call center for customers in GMT offset -6 with specific marital/education and household buy-potential profiles.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join catalog returns to call center, date, and customer demographic/address dimensions; apply month/year and profile filters; group by call center attributes (and demographic grouping columns); and order by highest return loss."
        }
      ]
    },
    {
      "query_id": "q92",
      "query_intent": "Sum web discount amounts for manufacturer 320 items sold in a 90-day window from 2002-02-26 where each row's discount exceeds 130% of that item's average discount in the same window.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join web sales with item and date, filter by manufacturer and date range, compare each row discount to a correlated 1.3x item-average discount threshold, and aggregate qualifying excess discount amount."
        }
      ]
    },
    {
      "query_id": "q93",
      "query_intent": "Compute customer-level effective store sales after adjusting sold quantity for returned quantity when the return reason is \"duplicate purchase\".",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Left-join store sales to returns, compute adjusted sales amount per line using return quantity when present, filter by duplicate-purchase reason, and sum adjusted sales by customer."
        }
      ]
    },
    {
      "query_id": "q94",
      "query_intent": "For web shipments to Oklahoma during a 60-day window from 2000-02-01 on company \"pri\" sites, report order count, shipping cost, and net profit for multi-warehouse orders with no returns.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Filter web sales by ship date range, destination state, and web company; require existence of same order across different warehouses; exclude orders present in web_returns; then aggregate order/profitability metrics."
        }
      ]
    },
    {
      "query_id": "q95",
      "query_intent": "For North Carolina shipments during a 60-day window from 1999-02-01 on company \"pri\" sites, report order count, shipping cost, and net profit for orders spanning multiple warehouses that also had returns.",
      "dag_nodes": [
        {
          "node_id": "ws_wh",
          "node_type": "cte",
          "depth": 0,
          "intent": "Identify web order numbers that involve at least two different warehouses."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Filter web sales by ship date range, state, and company; keep orders in the multi-warehouse set and in returned-order set; then aggregate distinct order count, shipping cost, and net profit."
        }
      ]
    },
    {
      "query_id": "q96",
      "query_intent": "Count store sales occurring at 8:30+ for households with dependent count 3 in store \"ese\".",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales with household demographics, time, and store; apply hour/minute, dependent-count, and store-name filters; and return total qualifying row count."
        }
      ]
    },
    {
      "query_id": "q97",
      "query_intent": "Compare customer-item coverage between store and catalog channels over month sequence 1214-1225 by counting store-only, catalog-only, and overlapping customer-item pairs.",
      "dag_nodes": [
        {
          "node_id": "ssci",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build distinct customer-item pairs from store sales in the 12-month window."
        },
        {
          "node_id": "csci",
          "node_type": "cte",
          "depth": 1,
          "intent": "Build distinct customer-item pairs from catalog sales in the same window."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Full-outer-join store and catalog pair sets on customer-item and count membership in each exclusive/overlap bucket."
        }
      ]
    },
    {
      "query_id": "q98",
      "query_intent": "Within a 30-day window starting 2002-05-20, compute store-sales revenue by item for Sports, Music, and Shoes categories, then calculate each item's percentage contribution within its item class.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join store sales to item and date, filter to the date window and target categories, aggregate revenue per item attributes, and compute class-level revenue share with a window partition on i_class."
        }
      ]
    },
    {
      "query_id": "q99",
      "query_intent": "Classify catalog shipment latency over month sequence 1224-1235 into five day-range buckets, grouped by warehouse, ship mode, and call center.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Join catalog sales with warehouse, ship mode, call center, and ship date; bucket cs_ship_date_sk-cs_sold_date_sk into CASE-based ranges; and aggregate counts by shipping context dimensions."
        }
      ]
    }
  ]
}
