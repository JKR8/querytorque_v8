{
  "benchmark": "postgres_dsb_76",
  "engine": "postgresql",
  "query_count": 76,
  "queries": [
    {
      "query_id": "query001_multi_i1",
      "query_intent": "Identify customers whose 2000 refunded-cash store-return totals (for selected reasons) exceed 120% of their store average, under targeted state and customer-demographic filters.",
      "dag_nodes": [
        {
          "node_id": "customer_total_return",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate return dollars by customer and geographic/state context so the main query can compare each customer against a location-level return baseline."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Identify customers whose 2000 refunded-cash store-return totals (for selected reasons) exceed 120% of their store average, under targeted state and customer-demographic filters."
        }
      ]
    },
    {
      "query_id": "query001_multi_i2",
      "query_intent": "Identify customers whose 2000 refunded-cash store-return totals (for selected reasons) exceed 120% of their store average, under targeted state and customer-demographic filters.",
      "dag_nodes": [
        {
          "node_id": "customer_total_return",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate return dollars by customer and geographic/state context so the main query can compare each customer against a location-level return baseline."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Identify customers whose 2000 refunded-cash store-return totals (for selected reasons) exceed 120% of their store average, under targeted state and customer-demographic filters."
        }
      ]
    },
    {
      "query_id": "query010_multi_i1",
      "query_intent": "Profile customer demographics for selected counties where customers bought qualifying store items in Apr-Jul 1998 and also bought through web or catalog under the same item/price constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Profile customer demographics for selected counties where customers bought qualifying store items in Apr-Jul 1998 and also bought through web or catalog under the same item/price constraints."
        }
      ]
    },
    {
      "query_id": "query010_multi_i2",
      "query_intent": "Profile customer demographics for selected counties where customers bought qualifying store items in Apr-Jul 1998 and also bought through web or catalog under the same item/price constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Profile customer demographics for selected counties where customers bought qualifying store items in Apr-Jul 1998 and also bought through web or catalog under the same item/price constraints."
        }
      ]
    },
    {
      "query_id": "query014_multi_i1",
      "query_intent": "Find product hierarchies sold across all three channels under shared category/manager/cost filters, then compare store sales and counts between matched December weeks in 2000 and 2001.",
      "dag_nodes": [
        {
          "node_id": "cross_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build the shared item key set that satisfies cross-channel product constraints before downstream year-over-year comparisons."
        },
        {
          "node_id": "avg_sales",
          "node_type": "cte",
          "depth": 1,
          "intent": "Compute a multi-channel average sales baseline used as a threshold for qualifying grouped results."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Find product hierarchies sold across all three channels under shared category/manager/cost filters, then compare store sales and counts between matched December weeks in 2000 and 2001."
        }
      ]
    },
    {
      "query_id": "query014_multi_i2",
      "query_intent": "Find product hierarchies sold across all three channels under shared category/manager/cost filters, then compare store sales and counts between matched December weeks in 2000 and 2001.",
      "dag_nodes": [
        {
          "node_id": "cross_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build the shared item key set that satisfies cross-channel product constraints before downstream year-over-year comparisons."
        },
        {
          "node_id": "avg_sales",
          "node_type": "cte",
          "depth": 1,
          "intent": "Compute a multi-channel average sales baseline used as a threshold for qualifying grouped results."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Find product hierarchies sold across all three channels under shared category/manager/cost filters, then compare store sales and counts between matched December weeks in 2000 and 2001."
        }
      ]
    },
    {
      "query_id": "query023_multi_i1",
      "query_intent": "Estimate March 1998 cross-channel demand by summing catalog and web sales for frequently sold store items bought by top store-spending customers under category/manager/cost constraints.",
      "dag_nodes": [
        {
          "node_id": "frequent_ss_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Identify items with frequently recurring store-sales activity under the query's date/category constraints."
        },
        {
          "node_id": "max_store_sales",
          "node_type": "cte",
          "depth": 1,
          "intent": "Compute the maximum customer-level store-sales amount used to define high-value customers."
        },
        {
          "node_id": "best_ss_customer",
          "node_type": "cte",
          "depth": 2,
          "intent": "Select customers whose store sales clear the high-value threshold derived from max_store_sales."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Estimate March 1998 cross-channel demand by summing catalog and web sales for frequently sold store items bought by top store-spending customers under category/manager/cost constraints."
        }
      ]
    },
    {
      "query_id": "query023_multi_i2",
      "query_intent": "Estimate March 1998 cross-channel demand by summing catalog and web sales for frequently sold store items bought by top store-spending customers under category/manager/cost constraints.",
      "dag_nodes": [
        {
          "node_id": "frequent_ss_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Identify items with frequently recurring store-sales activity under the query's date/category constraints."
        },
        {
          "node_id": "max_store_sales",
          "node_type": "cte",
          "depth": 1,
          "intent": "Compute the maximum customer-level store-sales amount used to define high-value customers."
        },
        {
          "node_id": "best_ss_customer",
          "node_type": "cte",
          "depth": 2,
          "intent": "Select customers whose store sales clear the high-value threshold derived from max_store_sales."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Estimate March 1998 cross-channel demand by summing catalog and web sales for frequently sold store items bought by top store-spending customers under category/manager/cost constraints."
        }
      ]
    },
    {
      "query_id": "query030_multi_i1",
      "query_intent": "Find customers in selected states whose 1998 web-return totals (for selected reasons) exceed 120% of their return-state average, with additional item/amount and birth-year filters.",
      "dag_nodes": [
        {
          "node_id": "customer_total_return",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate return dollars by customer and geographic/state context so the main query can compare each customer against a location-level return baseline."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Find customers in selected states whose 1998 web-return totals (for selected reasons) exceed 120% of their return-state average, with additional item/amount and birth-year filters."
        }
      ]
    },
    {
      "query_id": "query030_multi_i2",
      "query_intent": "Find customers in selected states whose 1998 web-return totals (for selected reasons) exceed 120% of their return-state average, with additional item/amount and birth-year filters.",
      "dag_nodes": [
        {
          "node_id": "customer_total_return",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate return dollars by customer and geographic/state context so the main query can compare each customer against a location-level return baseline."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Find customers in selected states whose 1998 web-return totals (for selected reasons) exceed 120% of their return-state average, with additional item/amount and birth-year filters."
        }
      ]
    },
    {
      "query_id": "query031_multi_i1",
      "query_intent": "Compare county-level web versus store growth from Q1 to Q3 of 1998 for selected item color/manager/price and state constraints, keeping counties where web growth outpaces store growth in both transitions.",
      "dag_nodes": [
        {
          "node_id": "ss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build store-channel aggregates needed for channel comparison and year/period alignment."
        },
        {
          "node_id": "ws",
          "node_type": "cte",
          "depth": 1,
          "intent": "Build web-channel aggregates needed for channel comparison and year/period alignment."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Compare county-level web versus store growth from Q1 to Q3 of 1998 for selected item color/manager/price and state constraints, keeping counties where web growth outpaces store growth in both transitions."
        }
      ]
    },
    {
      "query_id": "query031_multi_i2",
      "query_intent": "Compare county-level web versus store growth from Q1 to Q3 of 1998 for selected item color/manager/price and state constraints, keeping counties where web growth outpaces store growth in both transitions.",
      "dag_nodes": [
        {
          "node_id": "ss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Build store-channel aggregates needed for channel comparison and year/period alignment."
        },
        {
          "node_id": "ws",
          "node_type": "cte",
          "depth": 1,
          "intent": "Build web-channel aggregates needed for channel comparison and year/period alignment."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Compare county-level web versus store growth from Q1 to Q3 of 1998 for selected item color/manager/price and state constraints, keeping counties where web growth outpaces store growth in both transitions."
        }
      ]
    },
    {
      "query_id": "query032_multi_i1",
      "query_intent": "Sum catalog discounts in a 90-day 1999 window for targeted manufacturers/managers where each row discount exceeds 130% of its item-specific baseline discount.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Sum catalog discounts in a 90-day 1999 window for targeted manufacturers/managers where each row discount exceeds 130% of its item-specific baseline discount."
        }
      ]
    },
    {
      "query_id": "query032_multi_i2",
      "query_intent": "Sum catalog discounts in a 90-day 1999 window for targeted manufacturers/managers where each row discount exceeds 130% of its item-specific baseline discount.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Sum catalog discounts in a 90-day 1999 window for targeted manufacturers/managers where each row discount exceeds 130% of its item-specific baseline discount."
        }
      ]
    },
    {
      "query_id": "query038_multi_i1",
      "query_intent": "Count customer/date combinations present in store, catalog, and web channels over the same 12-month window, with shared birth-month and price/cost constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count customer/date combinations present in store, catalog, and web channels over the same 12-month window, with shared birth-month and price/cost constraints."
        }
      ]
    },
    {
      "query_id": "query038_multi_i2",
      "query_intent": "Count customer/date combinations present in store, catalog, and web channels over the same 12-month window, with shared birth-month and price/cost constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count customer/date combinations present in store, catalog, and web channels over the same 12-month window, with shared birth-month and price/cost constraints."
        }
      ]
    },
    {
      "query_id": "query039_multi_i1",
      "query_intent": "Detect high-variability inventory warehouse-item pairs in 2002 and compare month-10 to month-11 mean/cov statistics for the same pairs.",
      "dag_nodes": [
        {
          "node_id": "inv",
          "node_type": "cte",
          "depth": 0,
          "intent": "Compute monthly inventory mean/stdev/cov by warehouse and item, keeping only high-variability groups."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Detect high-variability inventory warehouse-item pairs in 2002 and compare month-10 to month-11 mean/cov statistics for the same pairs."
        }
      ]
    },
    {
      "query_id": "query039_multi_i2",
      "query_intent": "Detect high-variability inventory warehouse-item pairs in 2002 and compare month-10 to month-11 mean/cov statistics for the same pairs.",
      "dag_nodes": [
        {
          "node_id": "inv",
          "node_type": "cte",
          "depth": 0,
          "intent": "Compute monthly inventory mean/stdev/cov by warehouse and item, keeping only high-variability groups."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Detect high-variability inventory warehouse-item pairs in 2002 and compare month-10 to month-11 mean/cov statistics for the same pairs."
        }
      ]
    },
    {
      "query_id": "query054_multi_i1",
      "query_intent": "Segment customers by follow-on store revenue after Nov-1998 catalog/web purchases of Books-fiction items, using revenue buckets of size 50.",
      "dag_nodes": [
        {
          "node_id": "my_customers",
          "node_type": "cte",
          "depth": 0,
          "intent": "Materialize the qualifying customer cohort from upstream channel purchases and item/date filters."
        },
        {
          "node_id": "my_revenue",
          "node_type": "cte",
          "depth": 1,
          "intent": "Compute each cohort customer's downstream store revenue in the follow-on month window."
        },
        {
          "node_id": "segments",
          "node_type": "cte",
          "depth": 2,
          "intent": "Convert customer revenue into fixed-width segment buckets for distribution reporting."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Segment customers by follow-on store revenue after Nov-1998 catalog/web purchases of Books-fiction items, using revenue buckets of size 50."
        }
      ]
    },
    {
      "query_id": "query054_multi_i2",
      "query_intent": "Segment customers by follow-on store revenue after Nov-1998 catalog/web purchases of Books-fiction items, using revenue buckets of size 50.",
      "dag_nodes": [
        {
          "node_id": "my_customers",
          "node_type": "cte",
          "depth": 0,
          "intent": "Materialize the qualifying customer cohort from upstream channel purchases and item/date filters."
        },
        {
          "node_id": "my_revenue",
          "node_type": "cte",
          "depth": 1,
          "intent": "Compute each cohort customer's downstream store revenue in the follow-on month window."
        },
        {
          "node_id": "segments",
          "node_type": "cte",
          "depth": 2,
          "intent": "Convert customer revenue into fixed-width segment buckets for distribution reporting."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Segment customers by follow-on store revenue after Nov-1998 catalog/web purchases of Books-fiction items, using revenue buckets of size 50."
        }
      ]
    },
    {
      "query_id": "query058_multi_i1",
      "query_intent": "Compare per-item revenue consistency across store, catalog, and web channels for a target month and birth-year cohort, keeping items where all channel revenues are within \u00b110% of each other.",
      "dag_nodes": [
        {
          "node_id": "ss_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store-channel per-item revenue/quantity metrics for the target time slice."
        },
        {
          "node_id": "cs_items",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate catalog-channel per-item revenue/quantity metrics for the target time slice."
        },
        {
          "node_id": "ws_items",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate web-channel per-item revenue/quantity metrics for the target time slice."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Compare per-item revenue consistency across store, catalog, and web channels for a target month and birth-year cohort, keeping items where all channel revenues are within \u00b110% of each other."
        }
      ]
    },
    {
      "query_id": "query058_multi_i2",
      "query_intent": "Compare per-item revenue consistency across store, catalog, and web channels for a target month and birth-year cohort, keeping items where all channel revenues are within \u00b110% of each other.",
      "dag_nodes": [
        {
          "node_id": "ss_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store-channel per-item revenue/quantity metrics for the target time slice."
        },
        {
          "node_id": "cs_items",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate catalog-channel per-item revenue/quantity metrics for the target time slice."
        },
        {
          "node_id": "ws_items",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate web-channel per-item revenue/quantity metrics for the target time slice."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Compare per-item revenue consistency across store, catalog, and web channels for a target month and birth-year cohort, keeping items where all channel revenues are within \u00b110% of each other."
        }
      ]
    },
    {
      "query_id": "query059_multi_i1",
      "query_intent": "Compare day-of-week store sales ratios across two consecutive 12-month periods by aligning same stores and weeks 52 apart under state and discount-ratio filters.",
      "dag_nodes": [
        {
          "node_id": "wss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store sales into week and day-of-week buckets for year-over-year ratio comparisons."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Compare day-of-week store sales ratios across two consecutive 12-month periods by aligning same stores and weeks 52 apart under state and discount-ratio filters."
        }
      ]
    },
    {
      "query_id": "query059_multi_i2",
      "query_intent": "Compare day-of-week store sales ratios across two consecutive 12-month periods by aligning same stores and weeks 52 apart under state and discount-ratio filters.",
      "dag_nodes": [
        {
          "node_id": "wss",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store sales into week and day-of-week buckets for year-over-year ratio comparisons."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Compare day-of-week store sales ratios across two consecutive 12-month periods by aligning same stores and weeks 52 apart under state and discount-ratio filters."
        }
      ]
    },
    {
      "query_id": "query064_multi_i1",
      "query_intent": "Perform year-over-year comparison of store-sales behavior for catalog-return-heavy items under promotion, demographic, and geography constraints, matching same item/store between 1998 and 1999.",
      "dag_nodes": [
        {
          "node_id": "cs_ui",
          "node_type": "cte",
          "depth": 0,
          "intent": "Select catalog items whose gross sales materially exceed return/refund exposure."
        },
        {
          "node_id": "cross_sales",
          "node_type": "cte",
          "depth": 1,
          "intent": "Assemble detailed cross-domain customer/item/store sales features for year-over-year self-join comparison."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Perform year-over-year comparison of store-sales behavior for catalog-return-heavy items under promotion, demographic, and geography constraints, matching same item/store between 1998 and 1999."
        }
      ]
    },
    {
      "query_id": "query064_multi_i2",
      "query_intent": "Perform year-over-year comparison of store-sales behavior for catalog-return-heavy items under promotion, demographic, and geography constraints, matching same item/store between 1998 and 1999.",
      "dag_nodes": [
        {
          "node_id": "cs_ui",
          "node_type": "cte",
          "depth": 0,
          "intent": "Select catalog items whose gross sales materially exceed return/refund exposure."
        },
        {
          "node_id": "cross_sales",
          "node_type": "cte",
          "depth": 1,
          "intent": "Assemble detailed cross-domain customer/item/store sales features for year-over-year self-join comparison."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 2,
          "intent": "Perform year-over-year comparison of store-sales behavior for catalog-return-heavy items under promotion, demographic, and geography constraints, matching same item/store between 1998 and 1999."
        }
      ]
    },
    {
      "query_id": "query065_multi_i1",
      "query_intent": "List low-performing store-item pairs whose revenue is at most 10% of that store's average item revenue over a 12-month period, under discount-ratio, manager, and state filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "List low-performing store-item pairs whose revenue is at most 10% of that store's average item revenue over a 12-month period, under discount-ratio, manager, and state filters."
        }
      ]
    },
    {
      "query_id": "query065_multi_i2",
      "query_intent": "List low-performing store-item pairs whose revenue is at most 10% of that store's average item revenue over a 12-month period, under discount-ratio, manager, and state filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "List low-performing store-item pairs whose revenue is at most 10% of that store's average item revenue over a 12-month period, under discount-ratio, manager, and state filters."
        }
      ]
    },
    {
      "query_id": "query069_multi_i1",
      "query_intent": "Profile demographics for IA/MO/TX customers who bought in store during Mar-May 2002 but had no web or catalog purchases in that period, with list-price constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Profile demographics for IA/MO/TX customers who bought in store during Mar-May 2002 but had no web or catalog purchases in that period, with list-price constraints."
        }
      ]
    },
    {
      "query_id": "query069_multi_i2",
      "query_intent": "Profile demographics for IA/MO/TX customers who bought in store during Mar-May 2002 but had no web or catalog purchases in that period, with list-price constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Profile demographics for IA/MO/TX customers who bought in store during Mar-May 2002 but had no web or catalog purchases in that period, with list-price constraints."
        }
      ]
    },
    {
      "query_id": "query075_multi_i1",
      "query_intent": "Compare 2002 versus 2001 net sales counts and amounts for Music-category brand/class/manufacturer combinations across all channels after subtracting returns.",
      "dag_nodes": [
        {
          "node_id": "all_sales",
          "node_type": "cte",
          "depth": 0,
          "intent": "Unify net sales-count and sales-amount metrics across channels and years at the shared product hierarchy grain."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Compare 2002 versus 2001 net sales counts and amounts for Music-category brand/class/manufacturer combinations across all channels after subtracting returns."
        }
      ]
    },
    {
      "query_id": "query075_multi_i2",
      "query_intent": "Compare 2002 versus 2001 net sales counts and amounts for Music-category brand/class/manufacturer combinations across all channels after subtracting returns.",
      "dag_nodes": [
        {
          "node_id": "all_sales",
          "node_type": "cte",
          "depth": 0,
          "intent": "Unify net sales-count and sales-amount metrics across channels and years at the shared product hierarchy grain."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Compare 2002 versus 2001 net sales counts and amounts for Music-category brand/class/manufacturer combinations across all channels after subtracting returns."
        }
      ]
    },
    {
      "query_id": "query080_multi_i1",
      "query_intent": "Summarize sales, returns, and net profit over a 30-day 1998 window by store/catalog/web entities for Jewelry and Music items under multi-channel promotion filters.",
      "dag_nodes": [
        {
          "node_id": "ssr",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store-channel sales/returns/profit for the filtered date, product, and promotion window."
        },
        {
          "node_id": "csr",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate catalog-channel sales/returns/profit for the filtered date, product, and promotion window."
        },
        {
          "node_id": "wsr",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate web-channel sales/returns/profit for the filtered date, product, and promotion window."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Summarize sales, returns, and net profit over a 30-day 1998 window by store/catalog/web entities for Jewelry and Music items under multi-channel promotion filters."
        }
      ]
    },
    {
      "query_id": "query080_multi_i2",
      "query_intent": "Summarize sales, returns, and net profit over a 30-day 1998 window by store/catalog/web entities for Jewelry and Music items under multi-channel promotion filters.",
      "dag_nodes": [
        {
          "node_id": "ssr",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store-channel sales/returns/profit for the filtered date, product, and promotion window."
        },
        {
          "node_id": "csr",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate catalog-channel sales/returns/profit for the filtered date, product, and promotion window."
        },
        {
          "node_id": "wsr",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate web-channel sales/returns/profit for the filtered date, product, and promotion window."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Summarize sales, returns, and net profit over a 30-day 1998 window by store/catalog/web entities for Jewelry and Music items under multi-channel promotion filters."
        }
      ]
    },
    {
      "query_id": "query081_multi_i1",
      "query_intent": "Find Virginia customers whose 1998 catalog return totals exceed 120% of their return-state average and return detailed customer-address fields.",
      "dag_nodes": [
        {
          "node_id": "customer_total_return",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate return dollars by customer and geographic/state context so the main query can compare each customer against a location-level return baseline."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Find Virginia customers whose 1998 catalog return totals exceed 120% of their return-state average and return detailed customer-address fields."
        }
      ]
    },
    {
      "query_id": "query081_multi_i2",
      "query_intent": "Find Virginia customers whose 1998 catalog return totals exceed 120% of their return-state average and return detailed customer-address fields.",
      "dag_nodes": [
        {
          "node_id": "customer_total_return",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate return dollars by customer and geographic/state context so the main query can compare each customer against a location-level return baseline."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 1,
          "intent": "Find Virginia customers whose 1998 catalog return totals exceed 120% of their return-state average and return detailed customer-address fields."
        }
      ]
    },
    {
      "query_id": "query083_multi_i1",
      "query_intent": "Compare item return quantities across store, catalog, and web channels for selected 2002 months under category/manager/amount/reason filters, and report channel deviations from average.",
      "dag_nodes": [
        {
          "node_id": "sr_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store-return quantities per item for the target calendar slices."
        },
        {
          "node_id": "cr_items",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate catalog-return quantities per item for the target calendar slices."
        },
        {
          "node_id": "wr_items",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate web-return quantities per item for the target calendar slices."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Compare item return quantities across store, catalog, and web channels for selected 2002 months under category/manager/amount/reason filters, and report channel deviations from average."
        }
      ]
    },
    {
      "query_id": "query083_multi_i2",
      "query_intent": "Compare item return quantities across store, catalog, and web channels for selected 2002 months under category/manager/amount/reason filters, and report channel deviations from average.",
      "dag_nodes": [
        {
          "node_id": "sr_items",
          "node_type": "cte",
          "depth": 0,
          "intent": "Aggregate store-return quantities per item for the target calendar slices."
        },
        {
          "node_id": "cr_items",
          "node_type": "cte",
          "depth": 1,
          "intent": "Aggregate catalog-return quantities per item for the target calendar slices."
        },
        {
          "node_id": "wr_items",
          "node_type": "cte",
          "depth": 2,
          "intent": "Aggregate web-return quantities per item for the target calendar slices."
        },
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 3,
          "intent": "Compare item return quantities across store, catalog, and web channels for selected 2002 months under category/manager/amount/reason filters, and report channel deviations from average."
        }
      ]
    },
    {
      "query_id": "query087_multi_i1",
      "query_intent": "Count customer/date combinations that appear in store sales but not in catalog or web sales over the same 12-month window (set-difference pattern).",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count customer/date combinations that appear in store sales but not in catalog or web sales over the same 12-month window (set-difference pattern)."
        }
      ]
    },
    {
      "query_id": "query087_multi_i2",
      "query_intent": "Count customer/date combinations that appear in store sales but not in catalog or web sales over the same 12-month window (set-difference pattern).",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count customer/date combinations that appear in store sales but not in catalog or web sales over the same 12-month window (set-difference pattern)."
        }
      ]
    },
    {
      "query_id": "query092_multi_i1",
      "query_intent": "Sum web discounts over a 90-day 1998 window for targeted manufacturer/category conditions where discount exceeds an item-specific 1.3x baseline under cost/price-ratio filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Sum web discounts over a 90-day 1998 window for targeted manufacturer/category conditions where discount exceeds an item-specific 1.3x baseline under cost/price-ratio filters."
        }
      ]
    },
    {
      "query_id": "query092_multi_i2",
      "query_intent": "Sum web discounts over a 90-day 1998 window for targeted manufacturer/category conditions where discount exceeds an item-specific 1.3x baseline under cost/price-ratio filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Sum web discounts over a 90-day 1998 window for targeted manufacturer/category conditions where discount exceeds an item-specific 1.3x baseline under cost/price-ratio filters."
        }
      ]
    },
    {
      "query_id": "query094_multi_i1",
      "query_intent": "Measure web shipment order count, shipping cost, and net profit for a 60-day 2002 window in selected states, requiring multi-warehouse orders and excluding returns with specified reasons.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Measure web shipment order count, shipping cost, and net profit for a 60-day 2002 window in selected states, requiring multi-warehouse orders and excluding returns with specified reasons."
        }
      ]
    },
    {
      "query_id": "query094_multi_i2",
      "query_intent": "Measure web shipment order count, shipping cost, and net profit for a 60-day 2002 window in selected states, requiring multi-warehouse orders and excluding returns with specified reasons.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Measure web shipment order count, shipping cost, and net profit for a 60-day 2002 window in selected states, requiring multi-warehouse orders and excluding returns with specified reasons."
        }
      ]
    },
    {
      "query_id": "query013_agg_i1",
      "query_intent": "Aggregate 2001 store-sales quantity and price/cost metrics for rows that satisfy one of three demographic-and-price scenarios plus one of three U.S. state-and-profit scenarios.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate 2001 store-sales quantity and price/cost metrics for rows that satisfy one of three demographic-and-price scenarios plus one of three U.S. state-and-profit scenarios."
        }
      ]
    },
    {
      "query_id": "query013_agg_i2",
      "query_intent": "Aggregate 2001 store-sales quantity and price/cost metrics for rows that satisfy one of three demographic-and-price scenarios plus one of three U.S. state-and-profit scenarios.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate 2001 store-sales quantity and price/cost metrics for rows that satisfy one of three demographic-and-price scenarios plus one of three U.S. state-and-profit scenarios."
        }
      ]
    },
    {
      "query_id": "query018_agg_i1",
      "query_intent": "Compute rolled-up averages of catalog quantity, price, coupon, profit, and customer-birth metrics for 1998 Jewelry sales to college-educated female customers in selected states.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compute rolled-up averages of catalog quantity, price, coupon, profit, and customer-birth metrics for 1998 Jewelry sales to college-educated female customers in selected states."
        }
      ]
    },
    {
      "query_id": "query018_agg_i2",
      "query_intent": "Compute rolled-up averages of catalog quantity, price, coupon, profit, and customer-birth metrics for 1998 Jewelry sales to college-educated female customers in selected states.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compute rolled-up averages of catalog quantity, price, coupon, profit, and customer-birth metrics for 1998 Jewelry sales to college-educated female customers in selected states."
        }
      ]
    },
    {
      "query_id": "query019_agg_i1",
      "query_intent": "Rank December 2002 Home-category store-sales revenue by brand/manufacturer for Texas customers whose ZIP prefix differs from the selling store ZIP.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Rank December 2002 Home-category store-sales revenue by brand/manufacturer for Texas customers whose ZIP prefix differs from the selling store ZIP."
        }
      ]
    },
    {
      "query_id": "query019_agg_i2",
      "query_intent": "Rank December 2002 Home-category store-sales revenue by brand/manufacturer for Texas customers whose ZIP prefix differs from the selling store ZIP.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Rank December 2002 Home-category store-sales revenue by brand/manufacturer for Texas customers whose ZIP prefix differs from the selling store ZIP."
        }
      ]
    },
    {
      "query_id": "query025_agg_i1",
      "query_intent": "For May-Jul 1999 linked customer-item flows, aggregate store sales profit, store return loss, and catalog sales profit by item and store.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "For May-Jul 1999 linked customer-item flows, aggregate store sales profit, store return loss, and catalog sales profit by item and store."
        }
      ]
    },
    {
      "query_id": "query025_agg_i2",
      "query_intent": "For May-Jul 1999 linked customer-item flows, aggregate store sales profit, store return loss, and catalog sales profit by item and store.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "For May-Jul 1999 linked customer-item flows, aggregate store sales profit, store return loss, and catalog sales profit by item and store."
        }
      ]
    },
    {
      "query_id": "query027_agg_i1",
      "query_intent": "Compute rollup averages of store quantity/list/coupon/sales price by item and state for 2002 Jewelry store sales to male, single, advanced-degree customers in Virginia.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compute rollup averages of store quantity/list/coupon/sales price by item and state for 2002 Jewelry store sales to male, single, advanced-degree customers in Virginia."
        }
      ]
    },
    {
      "query_id": "query027_agg_i2",
      "query_intent": "Compute rollup averages of store quantity/list/coupon/sales price by item and state for 2002 Jewelry store sales to male, single, advanced-degree customers in Virginia.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compute rollup averages of store quantity/list/coupon/sales price by item and state for 2002 Jewelry store sales to male, single, advanced-degree customers in Virginia."
        }
      ]
    },
    {
      "query_id": "query040_agg_i1",
      "query_intent": "Compare pre/post net catalog sales around 1999-04-19 by warehouse state and item for Home products under manager/cost/reason filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compare pre/post net catalog sales around 1999-04-19 by warehouse state and item for Home products under manager/cost/reason filters."
        }
      ]
    },
    {
      "query_id": "query040_agg_i2",
      "query_intent": "Compare pre/post net catalog sales around 1999-04-19 by warehouse state and item for Home products under manager/cost/reason filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compare pre/post net catalog sales around 1999-04-19 by warehouse state and item for Home products under manager/cost/reason filters."
        }
      ]
    },
    {
      "query_id": "query050_agg_i1",
      "query_intent": "Bucket store return latency in August 2002 into five day ranges by store identity/address, with sales constrained to the prior 120-day window.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Bucket store return latency in August 2002 into five day ranges by store identity/address, with sales constrained to the prior 120-day window."
        }
      ]
    },
    {
      "query_id": "query050_agg_i2",
      "query_intent": "Bucket store return latency in August 2002 into five day ranges by store identity/address, with sales constrained to the prior 120-day window.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Bucket store return latency in August 2002 into five day ranges by store identity/address, with sales constrained to the prior 120-day window."
        }
      ]
    },
    {
      "query_id": "query072_agg_i1",
      "query_intent": "Aggregate promo-versus-nonpromo catalog order counts by item/warehouse/week when inventory is short, shipping lags sales, and customer/item filters match the target profile.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate promo-versus-nonpromo catalog order counts by item/warehouse/week when inventory is short, shipping lags sales, and customer/item filters match the target profile."
        }
      ]
    },
    {
      "query_id": "query072_agg_i2",
      "query_intent": "Aggregate promo-versus-nonpromo catalog order counts by item/warehouse/week when inventory is short, shipping lags sales, and customer/item filters match the target profile.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate promo-versus-nonpromo catalog order counts by item/warehouse/week when inventory is short, shipping lags sales, and customer/item filters match the target profile."
        }
      ]
    },
    {
      "query_id": "query084_agg_i1",
      "query_intent": "Return customers in Lakeview whose current demographic/household/income-band profile matches store-return demographics within the target income range.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Return customers in Lakeview whose current demographic/household/income-band profile matches store-return demographics within the target income range."
        }
      ]
    },
    {
      "query_id": "query084_agg_i2",
      "query_intent": "Return customers in Lakeview whose current demographic/household/income-band profile matches store-return demographics within the target income range.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Return customers in Lakeview whose current demographic/household/income-band profile matches store-return demographics within the target income range."
        }
      ]
    },
    {
      "query_id": "query085_agg_i1",
      "query_intent": "Compute reason-level averages of web quantity, refunded cash, and fees for 1998 returned web orders under matched demographic scenarios and state/profit bands.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compute reason-level averages of web quantity, refunded cash, and fees for 1998 returned web orders under matched demographic scenarios and state/profit bands."
        }
      ]
    },
    {
      "query_id": "query085_agg_i2",
      "query_intent": "Compute reason-level averages of web quantity, refunded cash, and fees for 1998 returned web orders under matched demographic scenarios and state/profit bands.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Compute reason-level averages of web quantity, refunded cash, and fees for 1998 returned web orders under matched demographic scenarios and state/profit bands."
        }
      ]
    },
    {
      "query_id": "query091_agg_i1",
      "query_intent": "Aggregate catalog return net-loss by call center for Jan-1999 customers in a target GMT offset and demographic/household profile.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate catalog return net-loss by call center for Jan-1999 customers in a target GMT offset and demographic/household profile."
        }
      ]
    },
    {
      "query_id": "query091_agg_i2",
      "query_intent": "Aggregate catalog return net-loss by call center for Jan-1999 customers in a target GMT offset and demographic/household profile.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Aggregate catalog return net-loss by call center for Jan-1999 customers in a target GMT offset and demographic/household profile."
        }
      ]
    },
    {
      "query_id": "query099_agg_i1",
      "query_intent": "Bucket catalog shipment latency over a 24-month sequence by warehouse, ship mode, and call center under price/class/offset filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Bucket catalog shipment latency over a 24-month sequence by warehouse, ship mode, and call center under price/class/offset filters."
        }
      ]
    },
    {
      "query_id": "query099_agg_i2",
      "query_intent": "Bucket catalog shipment latency over a 24-month sequence by warehouse, ship mode, and call center under price/class/offset filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Bucket catalog shipment latency over a 24-month sequence by warehouse, ship mode, and call center under price/class/offset filters."
        }
      ]
    },
    {
      "query_id": "query100_agg_i1",
      "query_intent": "Count co-purchased item pairs on the same ticket for selected categories/managers and customer profile constraints in 2000-2001.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count co-purchased item pairs on the same ticket for selected categories/managers and customer profile constraints in 2000-2001."
        }
      ]
    },
    {
      "query_id": "query100_agg_i2",
      "query_intent": "Count co-purchased item pairs on the same ticket for selected categories/managers and customer profile constraints in 2000-2001.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count co-purchased item pairs on the same ticket for selected categories/managers and customer profile constraints in 2000-2001."
        }
      ]
    },
    {
      "query_id": "query101_agg_i1",
      "query_intent": "Count customers participating in linked store-return-web item flows where web sale occurs within 90 days after return, under category/state/income/discount filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count customers participating in linked store-return-web item flows where web sale occurs within 90 days after return, under category/state/income/discount filters."
        }
      ]
    },
    {
      "query_id": "query101_agg_i2",
      "query_intent": "Count customers participating in linked store-return-web item flows where web sale occurs within 90 days after return, under category/state/income/discount filters.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count customers participating in linked store-return-web item flows where web sale occurs within 90 days after return, under category/state/income/discount filters."
        }
      ]
    },
    {
      "query_id": "query102_agg_i1",
      "query_intent": "Count customer demographic groups participating in linked store/web/inventory item flows in 2002 under category/manager/state/wholesale-cost constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count customer demographic groups participating in linked store/web/inventory item flows in 2002 under category/manager/state/wholesale-cost constraints."
        }
      ]
    },
    {
      "query_id": "query102_agg_i2",
      "query_intent": "Count customer demographic groups participating in linked store/web/inventory item flows in 2002 under category/manager/state/wholesale-cost constraints.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Count customer demographic groups participating in linked store/web/inventory item flows in 2002 under category/manager/state/wholesale-cost constraints."
        }
      ]
    },
    {
      "query_id": "query013_spj_i1",
      "query_intent": "Apply the same query013 business filters and joins, but return minimum representative values/keys to validate join-path coverage.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Apply the same query013 business filters and joins, but return minimum representative values/keys to validate join-path coverage."
        }
      ]
    },
    {
      "query_id": "query013_spj_i2",
      "query_intent": "Apply the same query013 business filters and joins, but return minimum representative values/keys to validate join-path coverage.",
      "dag_nodes": [
        {
          "node_id": "main_query",
          "node_type": "main",
          "depth": 0,
          "intent": "Apply the same query013 business filters and joins, but return minimum representative values/keys to validate join-path coverage."
        }
      ]
    }
  ]
}
