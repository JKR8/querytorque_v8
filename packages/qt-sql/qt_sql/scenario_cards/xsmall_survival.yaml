# Scenario Card: X-Small Survival
# Minimal compute. Any spill to remote storage is fatal (causes timeout).
# Queries must fit entirely in memory or use offload services.

name: xsmall_survival
description: |
  Minimal compute. Any spill to remote storage is fatal (causes timeout).
  Queries must fit entirely in memory or use offload services.

resource_envelope:
  memory: "~8GB (warehouse-managed, not configurable)"
  compute: "1 node, X-Small class"
  storage_io: "Micro-partition reads; remote spill = disk I/O death"

failure_definitions:
  - metric: query_duration
    threshold: ">300s"
    severity: fatal
  - metric: bytes_spilled_remote
    threshold: ">0"
    severity: fatal
  - metric: bytes_spilled_local
    threshold: ">1GB"
    severity: warning

strategy_priorities:
  - "Eliminate remote spill (reduce intermediate sizes below memory)"
  - "Maximize partition pruning (reduce scan volume)"
  - "Offload scan to QAS where eligible"
  - "Avoid physical materialization of large intermediates"
  - "Pre-aggregate before joins to reduce build side"

strategy_avoid:
  - "Large CTE materialization (fatal on X-Small)"
  - "Strategies that increase intermediate row count"
  - "Broad scans without pruning (10TB will not fit through X-Small)"
