================================================================================
PG DSB-76 BEAM SWEEP — FULL REPORT
================================================================================

Run ID:           beam_sweep_20260216
Started:          2026-02-16T14:06:04
Finished:         2026-02-16T16:40:46.868847
Engine:           postgresql
Benchmark:        dsb
Scale Factor:     SF10
Analyst Model:    deepseek/deepseek-r1
Worker Model:     qwen/qwen3-coder
Max Iterations:   3 (1 analyst + 2 snipe rounds)
Target Speedup:   100.0x (never early-stop)
Validation:       3x (warmup + avg last 2) + row_count + MD5 checksum
Semantic Pre:     Tier-1 (AST structural) + Tier-2 (2% TABLESAMPLE)

--------------------------------------------------------------------------------
SUMMARY
--------------------------------------------------------------------------------
  Total queries:    76
  WIN (>=1.05x):     36  (47.4%)
  IMPROVED (1.01x):  11  (14.5%)
  NEUTRAL:            5  (6.6%)
  NO_WINNER:         14  (18.4%)
  REGRESSION:        10  (13.2%)

  Success (WIN+IMP): 47/76 = 61.8%

--------------------------------------------------------------------------------
WINS — SORTED BY SPEEDUP
--------------------------------------------------------------------------------
Query                           Speedup    Orig ms     Opt ms Transform                      Fam Iter
--------------------------------------------------------------------------------
query065_multi_i1               152.12x     1629.9       10.7 pushdown_fix_projection          A    1
query001_multi_i2                61.86x    29213.7      472.3 explicit_join                    F    0
query001_multi_i1                14.51x     6550.7      451.5 materialize_cte                  E    0
query023_multi_i2                 8.97x     1098.2      122.5 materialization_prefetch         E    0
query072_agg_i1                   7.77x      449.9       57.9 multi_dimension_prefetch         E    0
query072_agg_i2                   3.63x      567.5      156.4 date_prefetch+join_restructure E+F    0
query031_multi_i2                 2.43x      848.0      349.6 early_filtering                  A    0
query101_agg_i1                   2.30x     3072.4     1337.7 early_filter_then_date_materialization_fixed A+E    2
query059_multi_i1                 2.12x     5113.1     2414.4 early_filtering                  A    0
query087_multi_i1                 2.08x      778.0      374.5 distinct_pushdown_then_except_to_exists C+D    1
query039_multi_i1                 1.82x     4028.8     2215.6 decorrelate                      B    0
query030_multi_i1                 1.77x       81.9       46.4 predicate_pushback               A    0
query075_multi_i2                 1.62x     1444.0      889.4 self_join_to_window              F    1
query075_multi_i1                 1.45x     1060.3      729.3 preagg_returns_early_filter    A+C    1
query025_agg_i2                   1.34x      391.3      292.5 date_dim_prefetch                E    0
query058_multi_i1                 1.26x      143.9      113.9 date_prefetch                    E    0
query083_multi_i2                 1.26x      605.5      479.8 dimension_prefilter              A    0
query014_multi_i2                 1.20x    10206.3     8522.4 cte_materialize_avg_sales        E    1
query054_multi_i1                 1.18x       58.8       49.7 date_dim_prefetch                E    0
query054_multi_i2                 1.18x       64.2       54.6 materialize_date_dim_subqueries+restructure_my_customers_joins E+F    2
query018_agg_i2                   1.16x      406.5      350.5 decorrelate_fact_scan            B    2
query102_agg_i1                   1.16x      952.2      818.2 early_filter_then_join_restructure A+F    1
query050_agg_i2                   1.14x      518.3      454.1 early_filtering                  A    0
query080_multi_i2                 1.14x      110.8       96.9 returns_preagg_with_dim_prefetch C+E    1
query085_agg_i2                   1.12x      393.9      352.9 explicit_join_reorder            F    0
query019_agg_i1                   1.11x      160.1      143.8 early_filter_geo_materialize   A+E    1
query058_multi_i2                 1.11x      533.8      479.4 push_sales_filters_into_ctes     A    2
query091_agg_i2                   1.09x      199.4      183.4 early_filtering                  A    0
query094_multi_i2                 1.09x      744.5      683.6 not_exists_to_anti_join+early_dimension_filters D+A    2
query099_agg_i2                   1.09x     5219.7     4806.8 preagg_with_date_math            C    2
query069_multi_i1                 1.08x    14517.7    13456.3 demographics_filter_push         A    0
query100_agg_i1                   1.08x     1832.1     1690.6 predicate_pushdown_items         A    0
query040_agg_i1                   1.06x      149.1      141.0 explicit_inner_join_with_early_filters   F    0
query018_agg_i1                   1.05x      241.2      230.5 prefetch_customer_address      A+E    1
query023_multi_i1                 1.05x     1418.6     1355.0 cte_materialization              E    0
query084_agg_i1                   1.05x       31.9       30.3 early_filter_explicit_join     A+F    2

--------------------------------------------------------------------------------
IMPROVED (1.01-1.05x)
--------------------------------------------------------------------------------
query038_multi_i2                 1.04x     1625.4     1562.7 predicate_pushback               A
query085_agg_i1                   1.04x      577.2      555.3 explicit_join_restructure        F
query014_multi_i1                 1.03x    10558.5    10235.3 cte_materialization              E
query019_agg_i2                   1.03x      335.0      323.8 early_filtering                  A
query027_agg_i2                   1.03x       94.8       92.1 prefilter_dimensions_materialize_corrected A+E
query030_multi_i2                 1.03x      115.6      112.6 decorrelate_state_thresholds     B
query013_agg_i1                   1.02x      499.2      487.8 predicate_pushback               A
query039_multi_i2                 1.02x     4504.3     4407.9 prefilter_aggregate_materialize A+E
query080_multi_i1                 1.02x       83.5       81.9 preagg_fact_early_filter       C+A
query094_multi_i1                 1.02x      283.2      277.6 prefiltered_returns_cte          A
query099_agg_i1                   1.02x       64.0       62.9 explicit_join_rescue_fixed       F

--------------------------------------------------------------------------------
NO WINNER (14 queries — all patches failed validation)
--------------------------------------------------------------------------------
  query013_spj_i1                 iters=0  tried=0  sem_pass=0
  query013_spj_i2                 iters=0  tried=0  sem_pass=0
  query032_multi_i1               iters=0  tried=0  sem_pass=0
  query032_multi_i2               iters=0  tried=0  sem_pass=0
  query059_multi_i2               iters=0  tried=0  sem_pass=0
  query064_multi_i1               iters=0  tried=0  sem_pass=0
  query064_multi_i2               iters=0  tried=0  sem_pass=0
  query065_multi_i2               iters=0  tried=0  sem_pass=0
  query081_multi_i1               iters=1  tried=4  sem_pass=3
  query081_multi_i2               iters=0  tried=0  sem_pass=0
  query084_agg_i2                 iters=0  tried=0  sem_pass=0
  query091_agg_i1                 iters=0  tried=0  sem_pass=0
  query092_multi_i1               iters=1  tried=4  sem_pass=1
  query092_multi_i2               iters=1  tried=3  sem_pass=2

--------------------------------------------------------------------------------
REGRESSION (10 queries)
--------------------------------------------------------------------------------
  query025_agg_i1                    0.10x  orig=359.3  opt=3422.8  prefetch_literal_fix
  query102_agg_i2                    0.42x  orig=710.9  opt=1688.1  rescue_filtered_dimensions
  query100_agg_i2                    0.62x  orig=2938.7  opt=4773.1  explicit_join_restructure
  query087_multi_i2                  0.70x  orig=1022.2  opt=1453.9  prefetch_dimensions_and_aggregate_sales+prefetch_dimensions_only
  query101_agg_i2                    0.73x  orig=1898.3  opt=2586.1  explicit_join_literal_preserve
  query050_agg_i1                    0.74x  orig=485.7  opt=657.3  explicit_join_materialized
  query069_multi_i2                  0.75x  orig=339.7  opt=455.0  date_materialization_rescue+explicit_join_optimize
  query083_multi_i1                  0.86x  orig=372.5  opt=433.9  prefilter_date_rescue
  query027_agg_i1                    0.87x  orig=7.4  opt=8.5  multi_dimension_prefetch
  query038_multi_i1                  0.94x  orig=837.0  opt=888.8  intersect_to_exists_with_prefetch

--------------------------------------------------------------------------------
NEUTRAL (5 queries)
--------------------------------------------------------------------------------
  query010_multi_i1                  0.99x  orig=1123.5  opt=1138.1
  query010_multi_i2                  0.99x  orig=875.6  opt=881.2
  query013_agg_i2                    0.97x  orig=516.7  opt=531.7
  query031_multi_i1                  1.00x  orig=66.9  opt=67.0
  query040_agg_i2                    0.96x  orig=106.5  opt=111.1

--------------------------------------------------------------------------------
ZERO-ROW ALERT — CHECKSUM CANNOT VERIFY THESE
--------------------------------------------------------------------------------
(Queries where original returns 0 rows → checksum=None, only row count verified)
NOTE: Zero-row detection requires row counts in result files.
Known from logs: query101_agg_i1 (0 rows), query102_agg_i1 (0 rows)
These wins should be manually verified or re-validated.

--------------------------------------------------------------------------------
TRANSFORM EFFECTIVENESS
--------------------------------------------------------------------------------
Transform                                 Used  Won   Rate  Avg Speedup
----------------------------------------------------------------------
decorrelate                                 30    5    17%       17.44x
early_filter                                15    4    27%       16.78x
early_filtering                              8    3    38%        1.90x
push_returns_filter_and_precompute_items     3    3   100%        1.56x
materialize_cte                              8    2    25%       11.62x
early_filter_geo_materialize                 2    2   100%        1.11x
date_dim_prefetch                            2    2   100%        1.26x
decorrelate_subquery                         1    1   100%       14.04x
shared_scan_decorrelate                      5    1    20%       61.44x
explicit_join                                2    1    50%       61.86x
multi_dimension_prefetch                     9    1    11%        7.77x
predicate_pushback                           6    1    17%        1.77x
cte_materialize_avg_sales                    1    1   100%        1.20x
decorrelate_fact_scan                        1    1   100%        1.16x
explicit_join_reorder                        2    1    50%        1.12x
materialization_prefetch                     1    1   100%        8.97x
materialize_date_dim_subqueries+restructure_my_customers_joins     1    1   100%        1.18x
date_prefetch                                1    1   100%        1.26x
decorrelate_date_as_join                     1    1   100%        1.20x
push_sales_filters_into_ctes                 1    1   100%        1.11x
base_sales_rescue                            1    1   100%        1.58x
pushdown_fix_projection                      1    1   100%      152.12x
dimension_prefilter                          3    1    33%        1.26x
prefetch_dates_and_filter_demographics       1    1   100%        7.76x
date_self_join_elimination_fixed             1    1   100%        7.75x
date_prefetch+join_restructure               1    1   100%        3.63x
preagg_returns_early_filter                  1    1   100%        1.45x
preagg_returns_with_item_prefetch            1    1   100%        1.12x
self_join_to_window                          2    1    50%        1.62x
comma_to_inner_join                          1    1   100%        1.11x
returns_preaggregation                       1    1   100%        1.11x
returns_preagg_with_dim_prefetch             1    1   100%        1.14x
distinct_pushdown_then_except_to_exists      1    1   100%        2.08x
prefilter_dimensions_then_except_to_exists     1    1   100%        1.20x
early_filter_then_date_materialization_fixed     1    1   100%        2.30x
early_filter_then_join_restructure           1    1   100%        1.16x

--------------------------------------------------------------------------------
FAMILY EFFECTIVENESS
--------------------------------------------------------------------------------
Family      Used  Won   Rate  Avg Speedup Description
----------------------------------------------------------------------
A             63   11    17%       20.82x Early Filtering
B             46    9    20%       18.34x Decorrelation
E             42    9    21%        5.17x Materialization
A+E           32    7    22%        2.42x Unknown
F             35    5    14%       14.69x Join Transform
E+F           13    2    15%        2.40x Unknown
A+F           10    1    10%        1.16x Unknown
C             35    1     3%        1.11x Aggregation
C+D            2    1    50%        2.08x Unknown
D+E            3    1    33%        1.20x Unknown
A+C            5    1    20%        1.45x Unknown
C+E            2    1    50%        1.14x Unknown
A+C+E          2    1    50%        1.12x Unknown
B+A            4    0     0%          N/A Unknown
B+A+F          1    0     0%          N/A Unknown
B+E+F          1    0     0%          N/A Unknown
B+E            8    0     0%          N/A Unknown
C+B            1    0     0%          N/A Unknown
A+F+D          1    0     0%          N/A Unknown
D              6    0     0%          N/A Set Ops
A+D            2    0     0%          N/A Unknown
D+F            1    0     0%          N/A Unknown
D+A            3    0     0%          N/A Unknown
F+B            1    0     0%          N/A Unknown
F+E            6    0     0%          N/A Unknown
E+C            3    0     0%          N/A Unknown
A+B            4    0     0%          N/A Unknown
E+B+F+A        1    0     0%          N/A Unknown
D+C            1    0     0%          N/A Unknown
E+A            2    0     0%          N/A Unknown
E+C+F          1    0     0%          N/A Unknown
E+A+F          3    0     0%          N/A Unknown
E+B            1    0     0%          N/A Unknown
E+F+C          1    0     0%          N/A Unknown
E+F+A          1    0     0%          N/A Unknown
C+A            1    0     0%          N/A Unknown
D+A+E          1    0     0%          N/A Unknown
E+D            1    0     0%          N/A Unknown
A+B+F          1    0     0%          N/A Unknown
A+F+C          1    0     0%          N/A Unknown
A+E+B          1    0     0%          N/A Unknown
C+A+B          1    0     0%          N/A Unknown

--------------------------------------------------------------------------------
GOLD EXAMPLE CANDIDATES (>=2x speedup, verified)
--------------------------------------------------------------------------------
  query065_multi_i1: 152.12x via pushdown_fix_projection (family A)
  query001_multi_i2: 61.86x via explicit_join (family F)
  query001_multi_i1: 14.51x via materialize_cte (family E)
  query023_multi_i2: 8.97x via materialization_prefetch (family E)
  query072_agg_i1: 7.77x via multi_dimension_prefetch (family E)
  query072_agg_i2: 3.63x via date_prefetch+join_restructure (family E+F)
  query031_multi_i2: 2.43x via early_filtering (family A)
  query101_agg_i1: 2.30x via early_filter_then_date_materialization_fixed (family A+E)
  query059_multi_i1: 2.12x via early_filtering (family A)
  query087_multi_i1: 2.08x via distinct_pushdown_then_except_to_exists (family C+D)