[
  {
    "target_id": "t1",
    "family": "A+C",
    "transform": "preagg_returns_early_filter",
    "relevance_score": 0.98,
    "hypothesis": "Pre-aggregate returns tables by (order_number, item_sk) with early reason_sk filtering to reduce nested loop input rows. Targets Seq Scans on returns tables (517K+ rows, 635ms).",
    "target_ir": "S0: Replace LEFT JOINs in UNION branches with LEFT JOINs to preaggregated CTEs: (SELECT order, item_sk, SUM(return_qty), SUM(return_amt) FROM returns WHERE reason_sk IN (...) GROUP BY order, item_sk)",
    "recommended_examples": [
      "pg_materialized_dimension_fact_prefilter",
      "pg_date_cte_explicit_join"
    ]
  },
  {
    "target_id": "t2",
    "family": "A",
    "transform": "push_reason_filter",
    "relevance_score": 0.9,
    "hypothesis": "Isolate reason_sk filter directly on returns tables before joins. Targets Seq Scan on store_returns (517K rows, 635ms) by reducing input rows.",
    "target_ir": "S0: Anchor [WHERE clause] \u2192 Move cr/sr/wr_reason_sk filters into dedicated returns-table subqueries.",
    "recommended_examples": [
      "pg_date_cte_explicit_join"
    ]
  },
  {
    "target_id": "t3",
    "family": "F",
    "transform": "self_join_to_conditional",
    "relevance_score": 0.85,
    "hypothesis": "Fix t2\u2019s self-join rewrite: Compute curr_yr/prev_yr via conditional aggregation in one CTE scan. Avoids nested loop (50 rows, 1360ms) and CTE re-scans.",
    "target_ir": "S0: Replace FROM all_sales curr_yr, prev_yr \u2192 FROM (SELECT ..., SUM(CASE WHEN d_year=1999 THEN sales_cnt END) AS curr_yr_cnt, ... FROM all_sales GROUP BY brand, class, ...)",
    "recommended_examples": [
      "pg_explicit_join_materialized"
    ]
  },
  {
    "target_id": "t4",
    "family": "E",
    "transform": "prefetch_home_items",
    "relevance_score": 0.8,
    "hypothesis": "Materialize filtered items (i_category='Home') to avoid 3 repeated scans (Seq Scan: 8638 rows, 20ms; Index Scans: 2x).",
    "target_ir": "S0: Insert CTE home_items AS (SELECT ... FROM item WHERE i_category='Home') \u2192 Replace all item joins with home_items.",
    "recommended_examples": [
      "multi_dimension_prefetch"
    ]
  }
]