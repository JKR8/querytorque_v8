[
  {
    "target_id": "t1",
    "family": "B",
    "transform": "shared_scan_decorrelate",
    "relevance_score": 0.95,
    "hypothesis": "Correlated subquery re-scans CTE per row. Precompute store averages in a standalone CTE and join to eliminate per-row execution.",
    "target_ir": "S0 [SELECT]\n  CTE: customer_total_return  (via CTE_Q_S0_customer_total_return)\n    FROM: store_returns, date_dim\n    WHERE [ddc05012d854ff26]: sr_returned_date_sk = d_date_sk AND d_year = 2002 AND sr_return_amt / sr_return_quantity BETWEEN 108 AND 167\n    GROUP BY: sr_customer_sk, sr_store_sk, sr_reason_sk\n  CTE: store_avg_return  (new)\n    FROM: customer_total_return\n    GROUP BY: ctr_store_sk\n  MAIN QUERY (via Q_S0)\n    FROM: customer_total_return ctr1, store_avg_return sar, store, customer, customer_demographics\n    WHERE: ctr1.ctr_store_sk = sar.ctr_store_sk AND ctr1.ctr_total_return > sar.avg_return * 1.2\n      AND ctr1.ctr_reason_sk BETWEEN 43 AND 46\n      AND s_store_sk = ctr1.ctr_store_sk\n      AND s_state IN ('IL', 'KY', 'TX')\n      AND ctr1.ctr_customer_sk = c_customer_sk\n      AND c_current_cdemo_sk = cd_demo_sk\n      AND cd_marital_status IN ('M', 'M')\n      AND cd_education_status IN ('Advanced Degree', 'College')\n      AND cd_gender = 'F'\n      AND c_birth_month = 2\n      AND c_birth_year BETWEEN 1965 AND 1971\n    ORDER BY: c_customer_id",
    "recommended_examples": [
      "pg_shared_scan_decorrelate"
    ]
  }
]