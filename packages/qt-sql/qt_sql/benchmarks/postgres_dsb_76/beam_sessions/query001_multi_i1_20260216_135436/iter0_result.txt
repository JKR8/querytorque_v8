{
  "iteration": 0,
  "n_api_calls": 5,
  "best_speedup": 15.06,
  "best_patch_id": "syn_w1",
  "best_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2002 AND sr_return_amt / sr_return_quantity BETWEEN 108 AND 167 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), store_avg_return AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_return FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return AS ctr1 JOIN store_avg_return AS sar ON ctr1.ctr_store_sk = sar.ctr_store_sk, store, customer, customer_demographics WHERE ctr1.ctr_total_return > sar.avg_return AND ctr1.ctr_reason_sk BETWEEN 43 AND 46 AND s_store_sk = ctr1.ctr_store_sk AND s_state IN ('IL', 'KY', 'TX') AND ctr1.ctr_customer_sk = c_customer_sk AND c_current_cdemo_sk = cd_demo_sk AND cd_marital_status IN ('M', 'M') AND cd_education_status IN ('Advanced Degree', 'College') AND cd_gender = 'F' AND c_birth_month = 2 AND c_birth_year BETWEEN 1965 AND 1971 ORDER BY c_customer_id LIMIT 100;",
  "patches": [
    {
      "patch_id": "t1",
      "family": "B",
      "transform": "shared_scan_decorrelate",
      "relevance_score": 0.95,
      "status": "WIN",
      "speedup": 14.77,
      "semantic_passed": true,
      "error": null,
      "original_ms": 6954.4,
      "patch_ms": 470.8,
      "output_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2002 AND sr_return_amt / sr_return_quantity BETWEEN 108 AND 167 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), store_avg_return AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_return FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return AS ctr1, store_avg_return AS sar, store, customer, customer_demographics WHERE ctr1.ctr_store_sk = sar.ctr_store_sk AND ctr1.ctr_total_return > sar.avg_return AND ctr1.ctr_reason_sk BETWEEN 43 AND 46 AND s_store_sk = ctr1.ctr_store_sk AND s_state IN ('IL', 'KY', 'TX') AND ctr1.ctr_customer_sk = c_customer_sk AND c_current_cdemo_sk = cd_demo_sk AND cd_marital_status IN ('M', 'M') AND cd_education_status IN ('Advanced Degree', 'College') AND cd_gender = 'F' AND c_birth_month = 2 AND c_birth_year BETWEEN 1965 AND 1971 ORDER BY c_customer_id LIMIT 100;",
      "has_explain": true
    },
    {
      "patch_id": "syn_w1",
      "family": "A",
      "transform": "early_filter",
      "relevance_score": 0.3,
      "status": "WIN",
      "speedup": 15.06,
      "semantic_passed": true,
      "error": null,
      "original_ms": 6954.4,
      "patch_ms": 461.9,
      "output_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2002 AND sr_return_amt / sr_return_quantity BETWEEN 108 AND 167 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), store_avg_return AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_return FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return AS ctr1 JOIN store_avg_return AS sar ON ctr1.ctr_store_sk = sar.ctr_store_sk, store, customer, customer_demographics WHERE ctr1.ctr_total_return > sar.avg_return AND ctr1.ctr_reason_sk BETWEEN 43 AND 46 AND s_store_sk = ctr1.ctr_store_sk AND s_state IN ('IL', 'KY', 'TX') AND ctr1.ctr_customer_sk = c_customer_sk AND c_current_cdemo_sk = cd_demo_sk AND cd_marital_status IN ('M', 'M') AND cd_education_status IN ('Advanced Degree', 'College') AND cd_gender = 'F' AND c_birth_month = 2 AND c_birth_year BETWEEN 1965 AND 1971 ORDER BY c_customer_id LIMIT 100;",
      "has_explain": true
    },
    {
      "patch_id": "syn_w2",
      "family": "B",
      "transform": "decorrelate",
      "relevance_score": 0.3,
      "status": "WIN",
      "speedup": 14.69,
      "semantic_passed": true,
      "error": null,
      "original_ms": 6954.4,
      "patch_ms": 473.3,
      "output_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2002 AND sr_return_amt / sr_return_quantity BETWEEN 108 AND 167 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), store_avg_return AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_return FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return AS ctr1, store_avg_return AS sar, store, customer, customer_demographics WHERE ctr1.ctr_store_sk = sar.ctr_store_sk AND ctr1.ctr_total_return > sar.avg_return AND ctr1.ctr_reason_sk BETWEEN 43 AND 46 AND s_store_sk = ctr1.ctr_store_sk AND s_state IN ('IL', 'KY', 'TX') AND ctr1.ctr_customer_sk = c_customer_sk AND c_current_cdemo_sk = cd_demo_sk AND cd_marital_status IN ('M', 'M') AND cd_education_status IN ('Advanced Degree', 'College') AND cd_gender = 'F' AND c_birth_month = 2 AND c_birth_year BETWEEN 1965 AND 1971 ORDER BY c_customer_id LIMIT 100;",
      "has_explain": true
    },
    {
      "patch_id": "syn_w3",
      "family": "E",
      "transform": "materialize_cte",
      "relevance_score": 0.3,
      "status": "WIN",
      "speedup": 13.94,
      "semantic_passed": true,
      "error": null,
      "original_ms": 6954.4,
      "patch_ms": 499.0,
      "output_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2002 AND sr_return_amt / sr_return_quantity BETWEEN 108 AND 167 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), store_avg_return AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_return FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return AS ctr1, store_avg_return AS sar, store, customer, customer_demographics WHERE ctr1.ctr_store_sk = sar.ctr_store_sk AND ctr1.ctr_total_return > sar.avg_return AND ctr1.ctr_reason_sk BETWEEN 43 AND 46 AND s_store_sk = ctr1.ctr_store_sk AND s_state IN ('IL', 'KY', 'TX') AND ctr1.ctr_customer_sk = c_customer_sk AND c_current_cdemo_sk = cd_demo_sk AND cd_marital_status IN ('M', 'M') AND cd_education_status IN ('Advanced Degree', 'College') AND cd_gender = 'F' AND c_birth_month = 2 AND c_birth_year BETWEEN 1965 AND 1971 ORDER BY c_customer_id LIMIT 100;",
      "has_explain": true
    }
  ],
  "explains": {
    "t1": "Limit  (rows=0, time=574.899)\n  Aggregate  (rows=95599, time=545.179)\n    Gather Merge  (rows=95661, time=513.272)\n      Aggregate  (rows=31887, time=286.314)\n        Sort  (rows=31974, time=276.079)\n          Nested Loop  (rows=31974, time=265.43)\n            Index Only Scan on date_dim  (rows=122, time=0.545)\n            Index Scan on store_returns  (rows=263, time=2.158)\n  Sort  (rows=0, time=574.84)\n    Nested Loop  (rows=0, time=574.829)\n      Nested Loop  (rows=0, time=574.828)\n        Nes",
    "syn_w1": "Limit  (rows=0, time=544.46)\n  Aggregate  (rows=95599, time=517.737)\n    Gather Merge  (rows=95661, time=488.428)\n      Aggregate  (rows=31887, time=284.404)\n        Sort  (rows=31974, time=274.609)\n          Nested Loop  (rows=31974, time=264.723)\n            Index Only Scan on date_dim  (rows=122, time=0.51)\n            Index Scan on store_returns  (rows=263, time=2.153)\n  Sort  (rows=0, time=544.424)\n    Nested Loop  (rows=0, time=544.412)\n      Nested Loop  (rows=0, time=544.411)\n        Nes",
    "syn_w2": "Limit  (rows=0, time=479.298)\n  Aggregate  (rows=95599, time=452.361)\n    Gather Merge  (rows=95661, time=422.902)\n      Aggregate  (rows=31887, time=240.173)\n        Sort  (rows=31974, time=230.188)\n          Nested Loop  (rows=31974, time=220.827)\n            Index Only Scan on date_dim  (rows=122, time=0.413)\n            Index Scan on store_returns  (rows=263, time=1.794)\n  Sort  (rows=0, time=479.248)\n    Nested Loop  (rows=0, time=479.239)\n      Nested Loop  (rows=0, time=479.238)\n        N",
    "syn_w3": "Limit  (rows=0, time=489.958)\n  Aggregate  (rows=95599, time=463.028)\n    Gather Merge  (rows=95661, time=433.337)\n      Aggregate  (rows=31887, time=246.573)\n        Sort  (rows=31974, time=236.742)\n          Nested Loop  (rows=31974, time=227.326)\n            Index Only Scan on date_dim  (rows=122, time=0.454)\n            Index Scan on store_returns  (rows=263, time=1.848)\n  Sort  (rows=0, time=489.915)\n    Nested Loop  (rows=0, time=489.905)\n      Nested Loop  (rows=0, time=489.904)\n        N"
  }
}