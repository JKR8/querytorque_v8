{
  "iteration": 1,
  "n_api_calls": 5,
  "best_speedup": 0.0,
  "best_patch_id": null,
  "best_sql": null,
  "patches": [
    {
      "patch_id": "t1",
      "family": "A+E",
      "transform": "early_date_store_prefetch",
      "relevance_score": 0.95,
      "status": "NEUTRAL",
      "speedup": 0.97,
      "semantic_passed": true,
      "error": null,
      "original_ms": 516.7,
      "patch_ms": 531.7,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON hd_demo_sk = ss_hdemo_sk JOIN customer_address ON ca_address_sk = ss_addr_sk WHERE ((cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (cd_marital_status = 'S' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (cd_marital_status = 'W' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD') AND ss_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'IN', 'VA') AND ss_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'SD') AND ss_net_profit BETWEEN 50 AND 250));",
      "has_explain": true
    },
    {
      "patch_id": "t3",
      "family": "A+F+D",
      "transform": "prefetch_explicit_join_reorder+or_to_union_all",
      "relevance_score": 0.9,
      "status": "REGRESSION",
      "speedup": 0.04,
      "semantic_passed": true,
      "error": null,
      "original_ms": 516.7,
      "patch_ms": 13430.4,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), sales_branches AS (SELECT ss_store_sk, ss_hdemo_sk, ss_cdemo_sk, ss_addr_sk, ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_net_profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk WHERE ((NOT ss_hdemo_sk IS NULL AND NOT ss_cdemo_sk IS NULL AND EXISTS(SELECT 1 FROM household_demographics, customer_demographics WHERE hd_demo_sk = ss_hdemo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND hd_dep_count = 3) AND ss_sales_price BETWEEN 100.00 AND 150.00) OR (NOT ss_hdemo_sk IS NULL AND NOT ss_cdemo_sk IS NULL AND EXISTS(SELECT 1 FROM household_demographics, customer_demographics WHERE hd_demo_sk = ss_hdemo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'Primary' AND hd_dep_count = 1) AND ss_sales_price BETWEEN 50.00 AND 100.00) OR (NOT ss_hdemo_sk IS NULL AND NOT ss_cdemo_sk IS NULL AND EXISTS(SELECT 1 FROM household_demographics, customer_demographics WHERE hd_demo_sk = ss_hdemo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'W' AND cd_education_status = 'Primary' AND hd_dep_count = 1) AND ss_sales_price BETWEEN 150.00 AND 200.00)) AND ((NOT ss_addr_sk IS NULL AND EXISTS(SELECT 1 FROM customer_address WHERE ca_address_sk = ss_addr_sk AND ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD')) AND ss_net_profit BETWEEN 100 AND 200) OR (NOT ss_addr_sk IS NULL AND EXISTS(SELECT 1 FROM customer_address WHERE ca_address_sk = ss_addr_sk AND ca_country = 'United States' AND ca_state IN ('AR', 'IN', 'VA')) AND ss_net_profit BETWEEN 150 AND 300) OR (NOT ss_addr_sk IS NULL AND EXISTS(SELECT 1 FROM customer_address WHERE ca_address_sk = ss_addr_sk AND ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'SD')) AND ss_net_profit BETWEEN 50 AND 250))) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM sales_branches JOIN store ON ss_store_sk = s_store_sk WHERE TRUE;",
      "has_explain": true
    },
    {
      "patch_id": "t4",
      "family": "E",
      "transform": "fact_table_materialize",
      "relevance_score": 0.8,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Equivalence execution error: column fs.ss_sales_price does not exist\nLINE 1: ...M' AND cd.cd_education_status = '2 yr Degree' AND fs.ss_sale...\n                                                             ^\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), filtered_sales AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_hdemo_sk, ss_cdemo_sk, ss_addr_sk, ss_store_sk, ss_net_profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM filtered_sales AS fs JOIN store AS s ON fs.ss_store_sk = s.s_store_sk JOIN customer_demographics AS cd ON fs.ss_cdemo_sk = cd.cd_demo_sk JOIN household_demographics AS hd ON fs.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON fs.ss_addr_sk = ca.ca_address_sk WHERE ((hd.hd_demo_sk = fs.ss_hdemo_sk AND cd.cd_demo_sk = fs.ss_cdemo_sk AND cd.cd_marital_status = 'M' AND cd.cd_education_status = '2 yr Degree' AND fs.ss_sales_price BETWEEN 100.00 AND 150.00 AND hd.hd_dep_count = 3) OR (hd.hd_demo_sk = fs.ss_hdemo_sk AND cd.cd_demo_sk = fs.ss_cdemo_sk AND cd.cd_marital_status = 'S' AND cd.cd_education_status = 'Primary' AND fs.ss_sales_price BETWEEN 50.00 AND 100.00 AND hd.hd_dep_count = 1) OR (hd.hd_demo_sk = fs.ss_hdemo_sk AND cd.cd_demo_sk = fs.ss_cdemo_sk AND cd.cd_marital_status = 'W' AND cd.cd_education_status = 'Primary' AND fs.ss_sales_price BETWEEN 150.00 AND 200.00 AND hd.hd_dep_count = 1)) AND ((ca.ca_address_sk = fs.ss_addr_sk AND ca.ca_country = 'United States' AND ca.ca_state IN ('GA', 'KY', 'SD') AND fs.ss_net_profit BETWEEN 100 AND 200) OR (ca.ca_address_sk = fs.ss_addr_sk AND ca.ca_country = 'United States' AND ca.ca_state IN ('AR', 'IN', 'VA') AND fs.ss_net_profit BETWEEN 150 AND 300) OR (ca.ca_address_sk = fs.ss_addr_sk AND ca.ca_country = 'United States' AND ca.ca_state IN ('KS', 'OH', 'SD') AND fs.ss_net_profit BETWEEN 50 AND 250));",
      "has_explain": false
    }
  ],
  "explains": {
    "t1": "Aggregate  (rows=1, time=625.36)\n  Gather  (rows=3, time=625.349)\n    Aggregate  (rows=1, time=408.601)\n      Nested Loop  (rows=22, time=408.514)\n        Nested Loop  (rows=980, time=399.325)\n          Hash Join  (rows=6247, time=360.034)\n            Hash Join  (rows=6265, time=358.827)\n              Nested Loop  (rows=56045, time=350.942)\n                Index Only Scan on date_dim  (rows=122, time=0.547)\n                Index Only Scan on store_sales  (rows=461, time=2.854)\n              Hash",
    "t3": "Aggregate  (rows=1, time=17132.835)\n  Nested Loop  (rows=65, time=17132.624)\n    Nested Loop  (rows=65, time=17132.045)\n      Index Only Scan on date_dim  (rows=365, time=0.493)\n      Index Only Scan on store_sales  (rows=0, time=46.932)\n        Index Scan on customer_address  (rows=0, time=0.002)\n        Index Scan on customer_address (customer_address_1)  (rows=0, time=0.001)\n        Index Scan on customer_address (customer_address_2)  (rows=0, time=0.001)\n        Nested Loop  (rows=0, time=0."
  }
}