{
  "iteration": 0,
  "n_api_calls": 10,
  "beam_cost_usd": 0.04069235,
  "beam_cost_priced_calls": 10,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 130387,
    "completion_tokens": 36027,
    "total_tokens": 166414,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 49984,
    "reasoning_tokens": 19033
  },
  "best_speedup": 0.0,
  "best_patch_id": null,
  "best_sql": null,
  "patches": [
    {
      "patch_id": "p03",
      "family": "B",
      "transform": "early_filter_decorrelate",
      "relevance_score": 0.62,
      "status": "REGRESSION",
      "speedup": 0.89,
      "semantic_passed": true,
      "error": null,
      "original_ms": 761.3,
      "patch_ms": 851.5,
      "output_sql": "select  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason\n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Unknown'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'M'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NC', 'PA', 'TX')\n     and ws_net_profit between 100 and 200\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('AR', 'CO', 'NY')\n     and ws_net_profit between 150 and 300\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'IL', 'TX')\n     and ws_net_profit between 50 and 250\n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Extract customer_demographics OR conditions into a CTE that pre-computes distinct cd_demo_sk values meeting the marital/education criteria, then join with web_returns and web_sales."
    },
    {
      "patch_id": "p02",
      "family": "C",
      "transform": "pg_materialized_dimension_fact_prefilter",
      "relevance_score": 0.82,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Retry failed: Unchanged node `date_dim` must omit sql",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": null,
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Create a MATERIALIZED CTE that pre-joins filtered date_dim with web_sales on date key, then join with pre-filtered customer_demographics and customer_address CTEs before aggregating."
    },
    {
      "patch_id": "p01",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.78,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Retry failed: Missing SQL for tree node `date_dim`",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": null,
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Pre-filter selective dimensions (date_dim, customer_demographics cd1, customer_address) into MATERIALIZED CTEs with explicit JOIN syntax, creating tiny hash tables before joining with fact tables."
    },
    {
      "patch_id": "p04",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.55,
      "status": "REGRESSION",
      "speedup": 0.84,
      "semantic_passed": true,
      "error": null,
      "original_ms": 761.3,
      "patch_ms": 908.4,
      "output_sql": "WITH cd_refunded AS (SELECT cd_demo_sk, cd_marital_status, cd_education_status FROM customer_demographics WHERE (cd_marital_status = 'S' AND cd_education_status = 'College') OR (cd_marital_status = 'W' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'M' AND cd_education_status = 'Secondary')), cd_returning AS (SELECT cd_demo_sk, cd_marital_status, cd_education_status FROM customer_demographics WHERE (cd_marital_status = 'S' AND cd_education_status = 'College') OR (cd_marital_status = 'W' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'M' AND cd_education_status = 'Secondary')) SELECT SUBSTRING(r_reason_desc, 1, 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) FROM web_sales, web_returns, web_page, cd_refunded, cd_returning, customer_address, date_dim, reason WHERE ws_web_page_sk = wp_web_page_sk AND ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number AND ws_sold_date_sk = d_date_sk AND d_year = 2000 AND cd_refunded.cd_demo_sk = wr_refunded_cdemo_sk AND cd_returning.cd_demo_sk = wr_returning_cdemo_sk AND ca_address_sk = wr_refunded_addr_sk AND r_reason_sk = wr_reason_sk AND ((cd_refunded.cd_marital_status = 'S' AND cd_returning.cd_marital_status = 'S' AND cd_refunded.cd_education_status = 'College' AND cd_returning.cd_education_status = 'College' AND ws_sales_price BETWEEN 100.00 AND 150.00) OR (cd_refunded.cd_marital_status = 'W' AND cd_returning.cd_marital_status = 'W' AND cd_refunded.cd_education_status = 'Unknown' AND cd_returning.cd_education_status = 'Unknown' AND ws_sales_price BETWEEN 50.00 AND 100.00) OR (cd_refunded.cd_marital_status = 'M' AND cd_returning.cd_marital_status = 'M' AND cd_refunded.cd_education_status = 'Secondary' AND cd_returning.cd_education_status = 'Secondary' AND ws_sales_price BETWEEN 150.00 AND 200.00)) AND (((ca_country = 'United States' AND ca_state IN ('NC', 'PA', 'TX') AND ws_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'CO', 'NY') AND ws_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('IA', 'IL', 'TX') AND ws_net_profit BETWEEN 50 AND 250))) GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc, 1, 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Decompose the self-join pattern on customer_demographics (cd1 and cd2) by creating separate CTEs for refunded and returning demographics with their respective filters, then join with fact tables."
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Row count: orig=19, patch=22",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH cd_filtered AS (\n  SELECT cd_demo_sk, cd_marital_status, cd_education_status\n  FROM customer_demographics\n  WHERE (cd_marital_status = 'S' AND cd_education_status = 'College')\n     OR (cd_marital_status = 'W' AND cd_education_status = 'Unknown')\n     OR (cd_marital_status = 'M' AND cd_education_status = 'Secondary')\n),\nca_filtered AS (\n  SELECT ca_address_sk\n  FROM customer_address\n  WHERE ca_country = 'United States'\n    AND (ca_state IN ('NC', 'PA', 'TX')\n         OR ca_state IN ('AR', 'CO', 'NY')\n         OR ca_state IN ('IA', 'IL', 'TX'))\n),\ndate_dim_filtered AS (\n  SELECT d_date_sk\n  FROM date_dim\n  WHERE d_year = 2000\n)\nSELECT substring(r_reason_desc,1,20),\n       avg(ws_quantity),\n       avg(wr_refunded_cash),\n       avg(wr_fee)\nFROM web_sales\nJOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number\nJOIN web_page ON ws_web_page_sk = wp_web_page_sk\nJOIN cd_filtered cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk\nJOIN cd_filtered cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk\nJOIN ca_filtered ON ca_filtered.ca_address_sk = wr_refunded_addr_sk\nJOIN date_dim_filtered d ON ws_sold_date_sk = d.d_date_sk\nJOIN reason ON r_reason_sk = wr_reason_sk\nWHERE (\n      (cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'College' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 100.00 AND 150.00)\n   OR (cd1.cd_marital_status = 'W' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Unknown' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 50.00 AND 100.00)\n   OR (cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Secondary' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 150.00 AND 200.00)\n      )\n  AND (\n      (ca_filtered.ca_address_sk IS NOT NULL AND ws_net_profit BETWEEN 100 AND 200)\n   OR (ca_filtered.ca_address_sk IS NOT NULL AND ws_net_profit BETWEEN 150 AND 300)\n   OR (ca_filtered.ca_address_sk IS NOT NULL AND ws_net_profit BETWEEN 50 AND 250)\n      )\nGROUP BY r_reason_desc\nORDER BY substring(r_reason_desc,1,20),\n         avg(ws_quantity),\n         avg(wr_refunded_cash),\n         avg(wr_fee)\nLIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "compile_p2",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "REGRESSION",
      "speedup": 0.21,
      "semantic_passed": true,
      "error": null,
      "original_ms": 641.2,
      "patch_ms": 3101.6,
      "output_sql": "SELECT substring(r_reason_desc,1,20),\n       avg(ws_quantity),\n       avg(wr_refunded_cash),\n       avg(wr_fee)\nFROM (\n  -- Branch 1: cd_marital_status = 'S', cd_education_status = 'College', ws_sales_price 100-150\n  SELECT r_reason_desc, ws_quantity, wr_refunded_cash, wr_fee\n  FROM web_sales\n  JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number\n  JOIN web_page ON ws_web_page_sk = wp_web_page_sk\n  JOIN customer_demographics cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk\n  JOIN customer_demographics cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk\n  JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk\n  JOIN date_dim ON ws_sold_date_sk = d_date_sk AND d_year = 2000\n  JOIN reason ON r_reason_sk = wr_reason_sk\n  WHERE cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status\n    AND cd1.cd_education_status = 'College' AND cd1.cd_education_status = cd2.cd_education_status\n    AND ws_sales_price BETWEEN 100.00 AND 150.00\n    AND ca_country = 'United States'\n    AND ( (ca_state IN ('NC', 'PA', 'TX') AND ws_net_profit BETWEEN 100 AND 200)\n       OR (ca_state IN ('AR', 'CO', 'NY') AND ws_net_profit BETWEEN 150 AND 300)\n       OR (ca_state IN ('IA', 'IL', 'TX') AND ws_net_profit BETWEEN 50 AND 250) )\n  UNION ALL\n  -- Branch 2: cd_marital_status = 'W', cd_education_status = 'Unknown', ws_sales_price 50-100\n  SELECT r_reason_desc, ws_quantity, wr_refunded_cash, wr_fee\n  FROM web_sales\n  JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number\n  JOIN web_page ON ws_web_page_sk = wp_web_page_sk\n  JOIN customer_demographics cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk\n  JOIN customer_demographics cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk\n  JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk\n  JOIN date_dim ON ws_sold_date_sk = d_date_sk AND d_year = 2000\n  JOIN reason ON r_reason_sk = wr_reason_sk\n  WHERE cd1.cd_marital_status = 'W' AND cd1.cd_marital_status = cd2.cd_marital_status\n    AND cd1.cd_education_status = 'Unknown' AND cd1.cd_education_status = cd2.cd_education_status\n    AND ws_sales_price BETWEEN 50.00 AND 100.00\n    AND ca_country = 'United States'\n    AND ( (ca_state IN ('NC', 'PA', 'TX') AND ws_net_profit BETWEEN 100 AND 200)\n       OR (ca_state IN ('AR', 'CO', 'NY') AND ws_net_profit BETWEEN 150 AND 300)\n       OR (ca_state IN ('IA', 'IL', 'TX') AND ws_net_profit BETWEEN 50 AND 250) )\n  UNION ALL\n  -- Branch 3: cd_marital_status = 'M', cd_education_status = 'Secondary', ws_sales_price 150-200\n  SELECT r_reason_desc, ws_quantity, wr_refunded_cash, wr_fee\n  FROM web_sales\n  JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number\n  JOIN web_page ON ws_web_page_sk = wp_web_page_sk\n  JOIN customer_demographics cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk\n  JOIN customer_demographics cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk\n  JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk\n  JOIN date_dim ON ws_sold_date_sk = d_date_sk AND d_year = 2000\n  JOIN reason ON r_reason_sk = wr_reason_sk\n  WHERE cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status\n    AND cd1.cd_education_status = 'Secondary' AND cd1.cd_education_status = cd2.cd_education_status\n    AND ws_sales_price BETWEEN 150.00 AND 200.00\n    AND ca_country = 'United States'\n    AND ( (ca_state IN ('NC', 'PA', 'TX') AND ws_net_profit BETWEEN 100 AND 200)\n       OR (ca_state IN ('AR', 'CO', 'NY') AND ws_net_profit BETWEEN 150 AND 300)\n       OR (ca_state IN ('IA', 'IL', 'TX') AND ws_net_profit BETWEEN 50 AND 250) )\n) AS all_branches\nGROUP BY r_reason_desc\nORDER BY substring(r_reason_desc,1,20),\n         avg(ws_quantity),\n         avg(wr_refunded_cash),\n         avg(wr_fee)\nLIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "REGRESSION",
      "speedup": 0.5,
      "semantic_passed": true,
      "error": null,
      "original_ms": 641.2,
      "patch_ms": 1280.4,
      "output_sql": "SELECT substring(r_reason_desc,1,20), avg(ws_quantity), avg(wr_refunded_cash), avg(wr_fee) FROM web_sales JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number JOIN web_page ON ws_web_page_sk = wp_web_page_sk JOIN customer_demographics cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk JOIN customer_demographics cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN reason ON r_reason_sk = wr_reason_sk WHERE d_year = 2000 AND ( ( cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'College' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 100.00 AND 150.00 ) OR ( cd1.cd_marital_status = 'W' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Unknown' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 50.00 AND 100.00 ) OR ( cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Secondary' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 150.00 AND 200.00 ) ) AND ( ( ca_country = 'United States' AND ca_state IN ('NC', 'PA', 'TX') AND ws_net_profit BETWEEN 100 AND 200 ) OR ( ca_country = 'United States' AND ca_state IN ('AR', 'CO', 'NY') AND ws_net_profit BETWEEN 150 AND 300 ) OR ( ca_country = 'United States' AND ca_state IN ('IA', 'IL', 'TX') AND ws_net_profit BETWEEN 50 AND 250 ) ) GROUP BY r_reason_desc ORDER BY substring(r_reason_desc,1,20), avg(ws_quantity), avg(wr_refunded_cash), avg(wr_fee) LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p2",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: column \"ca_state\" does not exist\nLINE 1: ...sales_price BETWEEN 150.00 AND 200.00 ) ) AND ( ( ca_state I...\n                                                             ^\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH cd_filtered AS ( SELECT cd_demo_sk, cd_marital_status, cd_education_status FROM customer_demographics WHERE (cd_marital_status = 'S' AND cd_education_status = 'College') OR (cd_marital_status = 'W' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'M' AND cd_education_status = 'Secondary') ), ca_filtered AS ( SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('NC', 'PA', 'TX', 'AR', 'CO', 'NY', 'IA', 'IL') ) SELECT substring(r_reason_desc,1,20), avg(ws_quantity), avg(wr_refunded_cash), avg(wr_fee) FROM web_sales JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number JOIN web_page ON ws_web_page_sk = wp_web_page_sk JOIN cd_filtered cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk JOIN cd_filtered cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = cd2.cd_education_status JOIN ca_filtered ON ca_filtered.ca_address_sk = wr_refunded_addr_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN reason ON r_reason_sk = wr_reason_sk WHERE d_year = 2000 AND ( ( cd1.cd_marital_status = 'S' AND cd1.cd_education_status = 'College' AND ws_sales_price BETWEEN 100.00 AND 150.00 ) OR ( cd1.cd_marital_status = 'W' AND cd1.cd_education_status = 'Unknown' AND ws_sales_price BETWEEN 50.00 AND 100.00 ) OR ( cd1.cd_marital_status = 'M' AND cd1.cd_education_status = 'Secondary' AND ws_sales_price BETWEEN 150.00 AND 200.00 ) ) AND ( ( ca_state IN ('NC', 'PA', 'TX') AND ws_net_profit BETWEEN 100 AND 200 ) OR ( ca_state IN ('AR', 'CO', 'NY') AND ws_net_profit BETWEEN 150 AND 300 ) OR ( ca_state IN ('IA', 'IL', 'TX') AND ws_net_profit BETWEEN 50 AND 250 ) ) GROUP BY r_reason_desc ORDER BY substring(r_reason_desc,1,20), avg(ws_quantity), avg(wr_refunded_cash), avg(wr_fee) LIMIT 100;",
      "has_explain": false,
      "description": null
    }
  ],
  "explains": {
    "p03": "Limit  (rows=19, time=822.268)\n  Sort  (rows=19, time=822.263)\n    Aggregate  (rows=19, time=822.22)\n      Gather Merge  (rows=21, time=822.155)\n        Aggregate  (rows=7, time=355.008)\n          Sort  (rows=9, time=354.966)\n            Nested Loop  (rows=9, time=354.856)\n              Nested Loop  (rows=9, time=354.713)\n                Nested Loop  (rows=9, time=354.643)\n                  Nested Loop  (rows=9, time=354.453)\n                    Nested Loop  (rows=460, time=345.986)\n            ",
    "p04": "Limit  (rows=19, time=812.988)\n  Sort  (rows=19, time=812.982)\n    Aggregate  (rows=19, time=812.943)\n      Gather Merge  (rows=21, time=812.838)\n        Aggregate  (rows=10, time=520.392)\n          Sort  (rows=14, time=520.331)\n            Nested Loop  (rows=14, time=520.218)\n              Nested Loop  (rows=14, time=520.036)\n                Nested Loop  (rows=76, time=517.842)\n                  Nested Loop  (rows=228, time=516.257)\n                    Nested Loop  (rows=228, time=514.727)\n    ",
    "compile_p2": "Limit  (rows=19, time=1486.533)\n  Sort  (rows=19, time=1486.53)\n    Aggregate  (rows=19, time=1486.464)\n      Sort  (rows=28, time=1486.392)\n        Gather  (rows=28, time=1486.309)\n          Append  (rows=9, time=1473.814)\n            Nested Loop  (rows=4, time=590.854)\n              Nested Loop  (rows=25, time=590.615)\n                Nested Loop  (rows=25, time=590.323)\n                  Nested Loop  (rows=3567, time=545.661)\n                    Nested Loop  (rows=14073, time=437.803)\n       ",
    "compile_p1": "Limit  (rows=19, time=697.221)\n  Sort  (rows=19, time=697.217)\n    Aggregate  (rows=19, time=697.193)\n      Gather Merge  (rows=21, time=697.143)\n        Aggregate  (rows=7, time=299.398)\n          Sort  (rows=9, time=299.374)\n            Nested Loop  (rows=9, time=299.313)\n              Nested Loop  (rows=9, time=299.205)\n                Nested Loop  (rows=9, time=299.148)\n                  Nested Loop  (rows=9, time=299.002)\n                    Nested Loop  (rows=460, time=293.222)\n           "
  }
}