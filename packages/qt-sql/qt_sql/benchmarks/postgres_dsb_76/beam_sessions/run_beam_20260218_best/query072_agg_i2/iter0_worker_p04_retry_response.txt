{
  "probe_id": "p04",
  "transform_id": "pg_self_join_decomposition",
  "family": "E",
  "status": "failed",
  "failure_reason": "Execution failure due to incorrect CTE filter logic causing transaction abort.",
  "partial_work": {
    "attempted_approach": "Materialize filtered date_dim rows into a single CTE and reference it three times with different aliases.",
    "blocking_issue": "CTE filter `d_year = 1999` is insufficient; downstream joins require full date_dim coverage with selective filters applied per alias.",
    "hypothesis_still_valid": true
  },
  "dialect": "postgres",
  "hypothesis": "Materializing date_dim once may reduce scan cost, but the CTE must include all necessary rows for d1, d2, and d3 join conditions.",
  "reasoning_trace": [
    "Original attempt used overly restrictive CTE filter (d_year = 1999), which excluded rows needed by d2 and d3 joins.",
    "Downstream join conditions require broader date_dim coverage preserved per alias.",
    "Correct approach requires CTE to materialize full date_dim or selective superset of rows."
  ],
  "target_ir": "No structural change due to failed execution.",
  "verification": {
    "executable": false,
    "no_missing_tables": true,
    "alias_consistent": true,
    "no_orphan_scans": true,
    "semantics_preserved": true,
    "null_semantics_safe": true,
    "ctes_selective_or_na": true
  },
  "tree": {
    "root_node_id": "final_select",
    "nodes": [
      {
        "node_id": "final_select",
        "parent_node_id": null,
        "sources": [],
        "outputs": [
          "i_item_desc",
          "w_warehouse_name",
          "d_week_seq",
          "no_promo",
          "promo",
          "total_cnt"
        ],
        "changed": false
      }
    ]
  }
}