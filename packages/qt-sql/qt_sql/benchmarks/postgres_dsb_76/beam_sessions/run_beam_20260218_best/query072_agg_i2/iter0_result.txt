{
  "iteration": 0,
  "n_api_calls": 11,
  "beam_cost_usd": 0.04218288,
  "beam_cost_priced_calls": 11,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 150286,
    "completion_tokens": 36315,
    "total_tokens": 186601,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 60672,
    "reasoning_tokens": 20418
  },
  "best_speedup": 4.46,
  "best_patch_id": "p01",
  "best_sql": "WITH filtered_d1 AS (WITH filtered_d1 AS MATERIALIZED (SELECT d_date_sk, d_week_seq, d_year FROM date_dim WHERE d_year = 1999) SELECT * FROM filtered_d1), filtered_household_demographics AS (WITH filtered_household_demographics AS MATERIALIZED (SELECT hd_demo_sk, hd_buy_potential FROM household_demographics WHERE hd_buy_potential = '>10000') SELECT * FROM filtered_household_demographics), filtered_customer_demographics AS (WITH filtered_customer_demographics AS MATERIALIZED (SELECT cd_demo_sk, cd_marital_status, cd_dep_count FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_dep_count BETWEEN 9 AND 11) SELECT * FROM filtered_customer_demographics), filtered_item AS (WITH filtered_item AS MATERIALIZED (SELECT i_item_sk, i_item_desc, i_category FROM item WHERE i_category IN ('Men', 'Shoes', 'Sports')) SELECT * FROM filtered_item), filtered_catalog_sales AS (WITH filtered_catalog_sales AS MATERIALIZED (SELECT cs_item_sk, cs_order_number, cs_wholesale_cost, cs_bill_cdemo_sk, cs_bill_hdemo_sk, cs_sold_date_sk, cs_ship_date_sk, cs_promo_sk, cs_quantity FROM catalog_sales WHERE cs_wholesale_cost BETWEEN 76 AND 96) SELECT * FROM filtered_catalog_sales), filtered_inventory AS (WITH filtered_inventory AS MATERIALIZED (SELECT inv_item_sk, inv_warehouse_sk, inv_date_sk, inv_quantity_on_hand FROM inventory) SELECT * FROM filtered_inventory) SELECT i.i_item_desc ,w.w_warehouse_name ,d1.d_week_seq ,SUM(CASE WHEN p.p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo ,SUM(CASE WHEN p.p_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo ,COUNT(*) AS total_cnt FROM filtered_catalog_sales cs JOIN filtered_inventory inv ON (cs.cs_item_sk = inv.inv_item_sk) JOIN warehouse w ON (w.w_warehouse_sk=inv.inv_warehouse_sk) JOIN filtered_item i ON (i.i_item_sk = cs.cs_item_sk) JOIN filtered_customer_demographics cd ON (cs.cs_bill_cdemo_sk = cd.cd_demo_sk) JOIN filtered_household_demographics hd ON (cs.cs_bill_hdemo_sk = hd.hd_demo_sk) JOIN filtered_d1 d1 ON (cs.cs_sold_date_sk = d1.d_date_sk) JOIN date_dim d2 ON (inv.inv_date_sk = d2.d_date_sk) JOIN date_dim d3 ON (cs.cs_ship_date_sk = d3.d_date_sk) LEFT OUTER JOIN promotion p ON (cs.cs_promo_sk=p.p_promo_sk) LEFT OUTER JOIN catalog_returns cr ON (cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number) WHERE d1.d_week_seq = d2.d_week_seq AND inv.inv_quantity_on_hand < cs.cs_quantity AND d3.d_date > (SELECT d_date FROM date_dim WHERE d_date_sk = d1.d_date_sk) + interval '3 day' GROUP BY i.i_item_desc,w.w_warehouse_name,d1.d_week_seq ORDER BY total_cnt DESC, i.i_item_desc, w.w_warehouse_name, d1.d_week_seq LIMIT 100;",
  "patches": [
    {
      "patch_id": "p02",
      "family": "F",
      "transform": "date_cte_explicit_join",
      "relevance_score": 0.75,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Retry failed: Node `d1_filtered` missing parent_node_id",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": null,
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Materialize filtered date_dim rows for d1, d2, d3 into separate CTEs with explicit JOIN syntax, ensuring each date CTE is tiny and joined early to reduce fact\u2011table scans."
    },
    {
      "patch_id": "p01",
      "family": "F",
      "transform": "materialized_dimension_fact_prefilter",
      "relevance_score": 0.82,
      "status": "WIN",
      "speedup": 4.46,
      "semantic_passed": true,
      "error": null,
      "original_ms": 457.7,
      "patch_ms": 102.7,
      "output_sql": "WITH filtered_d1 AS (WITH filtered_d1 AS MATERIALIZED (SELECT d_date_sk, d_week_seq, d_year FROM date_dim WHERE d_year = 1999) SELECT * FROM filtered_d1), filtered_household_demographics AS (WITH filtered_household_demographics AS MATERIALIZED (SELECT hd_demo_sk, hd_buy_potential FROM household_demographics WHERE hd_buy_potential = '>10000') SELECT * FROM filtered_household_demographics), filtered_customer_demographics AS (WITH filtered_customer_demographics AS MATERIALIZED (SELECT cd_demo_sk, cd_marital_status, cd_dep_count FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_dep_count BETWEEN 9 AND 11) SELECT * FROM filtered_customer_demographics), filtered_item AS (WITH filtered_item AS MATERIALIZED (SELECT i_item_sk, i_item_desc, i_category FROM item WHERE i_category IN ('Men', 'Shoes', 'Sports')) SELECT * FROM filtered_item), filtered_catalog_sales AS (WITH filtered_catalog_sales AS MATERIALIZED (SELECT cs_item_sk, cs_order_number, cs_wholesale_cost, cs_bill_cdemo_sk, cs_bill_hdemo_sk, cs_sold_date_sk, cs_ship_date_sk, cs_promo_sk, cs_quantity FROM catalog_sales WHERE cs_wholesale_cost BETWEEN 76 AND 96) SELECT * FROM filtered_catalog_sales), filtered_inventory AS (WITH filtered_inventory AS MATERIALIZED (SELECT inv_item_sk, inv_warehouse_sk, inv_date_sk, inv_quantity_on_hand FROM inventory) SELECT * FROM filtered_inventory) SELECT i.i_item_desc ,w.w_warehouse_name ,d1.d_week_seq ,SUM(CASE WHEN p.p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo ,SUM(CASE WHEN p.p_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo ,COUNT(*) AS total_cnt FROM filtered_catalog_sales cs JOIN filtered_inventory inv ON (cs.cs_item_sk = inv.inv_item_sk) JOIN warehouse w ON (w.w_warehouse_sk=inv.inv_warehouse_sk) JOIN filtered_item i ON (i.i_item_sk = cs.cs_item_sk) JOIN filtered_customer_demographics cd ON (cs.cs_bill_cdemo_sk = cd.cd_demo_sk) JOIN filtered_household_demographics hd ON (cs.cs_bill_hdemo_sk = hd.hd_demo_sk) JOIN filtered_d1 d1 ON (cs.cs_sold_date_sk = d1.d_date_sk) JOIN date_dim d2 ON (inv.inv_date_sk = d2.d_date_sk) JOIN date_dim d3 ON (cs.cs_ship_date_sk = d3.d_date_sk) LEFT OUTER JOIN promotion p ON (cs.cs_promo_sk=p.p_promo_sk) LEFT OUTER JOIN catalog_returns cr ON (cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number) WHERE d1.d_week_seq = d2.d_week_seq AND inv.inv_quantity_on_hand < cs.cs_quantity AND d3.d_date > (SELECT d_date FROM date_dim WHERE d_date_sk = d1.d_date_sk) + interval '3 day' GROUP BY i.i_item_desc,w.w_warehouse_name,d1.d_week_seq ORDER BY total_cnt DESC, i.i_item_desc, w.w_warehouse_name, d1.d_week_seq LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Pre\u2011filter date_dim d1, household_demographics, customer_demographics, and item into separate MATERIALIZED CTEs with their selective WHERE clauses, then join them with catalog_sales and inventory in a staged pipeline, ensuring the non\u2011equi condition inv_quantity_on_hand < cs_quantity is applied after both sides are reduced."
    },
    {
      "patch_id": "p04",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.55,
      "status": "NEUTRAL",
      "speedup": 1.0,
      "semantic_passed": true,
      "error": null,
      "original_ms": 457.7,
      "patch_ms": 456.6,
      "output_sql": "select  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity\n  and d3.d_date > d1.d_date + interval '3 day'\n  and hd_buy_potential = '>10000'\n  and d1.d_year = 1999\n  and cd_marital_status = 'S'\n  and cd_dep_count between 9 and 11\n  and i_category IN ('Men', 'Shoes', 'Sports')\n  and cs_wholesale_cost BETWEEN 76 AND 96\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Materialize the filtered date_dim rows for d1, d2, d3 into a single CTE that returns all needed columns (d_date_sk, d_week_seq, d_date, d_year) and then reference that CTE three times with different aliases, preserving the original join conditions."
    },
    {
      "patch_id": "p03",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.7,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: missing FROM-clause entry for table \"cr\"\nLINE 29:   cr.cr_item_sk,\n           ^\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH prefetch_joins AS (WITH filtered_date_dim_d1 AS (\n  SELECT *\n  FROM date_dim\n  WHERE d_year = 1999\n),\nhousehold_demographics AS (\n  SELECT *\n  FROM household_demographics\n  WHERE hd_buy_potential = '>10000'\n),\ncustomer_demographics AS (\n  SELECT *\n  FROM customer_demographics\n  WHERE cd_marital_status = 'S'\n    AND cd_dep_count between 9 and 11\n),\nitem AS (\n  SELECT *\n  FROM item\n  WHERE i_category IN ('Men', 'Shoes', 'Sports')\n)\nSELECT\n  i.i_item_desc,\n  w.w_warehouse_name,\n  d1.d_week_seq,\n  cs.cs_promo_sk,\n  cs.cs_item_sk,\n  cs.cs_order_number,\n  cr.cr_item_sk,\n  cr.cr_order_number\nFROM catalog_sales cs\nJOIN inventory inv ON (cs.cs_item_sk = inv.inv_item_sk)\nJOIN warehouse w ON (w.w_warehouse_sk=inv.inv_warehouse_sk)\nJOIN item i ON (i.i_item_sk = cs.cs_item_sk)\nJOIN customer_demographics cd ON (cs.cs_bill_cdemo_sk = cd.cd_demo_sk)\nJOIN household_demographics hd ON (cs.cs_bill_hdemo_sk = hd.hd_demo_sk)\nJOIN filtered_date_dim_d1 d1 ON (cs.cs_sold_date_sk = d1.d_date_sk)\nJOIN date_dim d2 ON (inv.inv_date_sk = d2.d_date_sk)\nJOIN date_dim d3 ON (cs.cs_ship_date_sk = d3.d_date_sk)\nWHERE d1.d_week_seq = d2.d_week_seq\n  AND inv_quantity_on_hand < cs_quantity\n  AND d3.d_date > d1.d_date + interval '3 day'\n  AND cs_wholesale_cost BETWEEN 76 AND 96) select  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom prefetch_joins\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Create MATERIALIZED CTEs for all selective dimensions (date_dim d1, household_demographics, customer_demographics, item) with their filters, then join them together before joining with catalog_sales and inventory."
    },
    {
      "patch_id": "compile_p01_corrected",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "IMPROVED",
      "speedup": 1.06,
      "semantic_passed": true,
      "error": null,
      "original_ms": 1613.1,
      "patch_ms": 1519.2,
      "output_sql": "WITH filtered_d1 AS (SELECT d_date_sk, d_week_seq, d_date, d_year FROM date_dim WHERE d_year = 1999), filtered_household_demographics AS (SELECT hd_demo_sk, hd_buy_potential FROM household_demographics WHERE hd_buy_potential = '>10000'), filtered_customer_demographics AS (SELECT cd_demo_sk, cd_marital_status, cd_dep_count FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_dep_count BETWEEN 9 AND 11), filtered_item AS (SELECT i_item_sk, i_item_desc, i_category FROM item WHERE i_category IN ('Men', 'Shoes', 'Sports')), filtered_catalog_sales AS (SELECT cs_item_sk, cs_order_number, cs_wholesale_cost, cs_bill_cdemo_sk, cs_bill_hdemo_sk, cs_sold_date_sk, cs_ship_date_sk, cs_promo_sk, cs_quantity FROM catalog_sales WHERE cs_wholesale_cost BETWEEN 76 AND 96), filtered_inventory AS (SELECT inv_item_sk, inv_warehouse_sk, inv_date_sk, inv_quantity_on_hand FROM inventory) SELECT i.i_item_desc, w.w_warehouse_name, d1.d_week_seq, SUM(CASE WHEN p.p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo, SUM(CASE WHEN p.p_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo, COUNT(*) AS total_cnt FROM filtered_catalog_sales cs JOIN filtered_inventory inv ON cs.cs_item_sk = inv.inv_item_sk JOIN warehouse w ON w.w_warehouse_sk = inv.inv_warehouse_sk JOIN filtered_item i ON i.i_item_sk = cs.cs_item_sk JOIN filtered_customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN filtered_household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN filtered_d1 d1 ON cs.cs_sold_date_sk = d1.d_date_sk JOIN date_dim d2 ON inv.inv_date_sk = d2.d_date_sk JOIN date_dim d3 ON cs.cs_ship_date_sk = d3.d_date_sk LEFT OUTER JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT OUTER JOIN catalog_returns cr ON cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number WHERE d1.d_week_seq = d2.d_week_seq AND inv.inv_quantity_on_hand < cs.cs_quantity AND d3.d_date > d1.d_date + interval '3 day' GROUP BY i.i_item_desc, w.w_warehouse_name, d1.d_week_seq ORDER BY total_cnt DESC, i.i_item_desc, w.w_warehouse_name, d1.d_week_seq LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_date_dim_cte",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "IMPROVED",
      "speedup": 1.06,
      "semantic_passed": true,
      "error": null,
      "original_ms": 1613.1,
      "patch_ms": 1519.6,
      "output_sql": "WITH filtered_d1 AS (SELECT d_date_sk, d_week_seq, d_date, d_year FROM date_dim WHERE d_year = 1999), filtered_household_demographics AS (SELECT hd_demo_sk, hd_buy_potential FROM household_demographics WHERE hd_buy_potential = '>10000'), filtered_customer_demographics AS (SELECT cd_demo_sk, cd_marital_status, cd_dep_count FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_dep_count BETWEEN 9 AND 11), filtered_item AS (SELECT i_item_sk, i_item_desc, i_category FROM item WHERE i_category IN ('Men', 'Shoes', 'Sports')), filtered_catalog_sales AS (SELECT cs_item_sk, cs_order_number, cs_wholesale_cost, cs_bill_cdemo_sk, cs_bill_hdemo_sk, cs_sold_date_sk, cs_ship_date_sk, cs_promo_sk, cs_quantity FROM catalog_sales WHERE cs_wholesale_cost BETWEEN 76 AND 96), filtered_inventory AS (SELECT inv_item_sk, inv_warehouse_sk, inv_date_sk, inv_quantity_on_hand FROM inventory), date_dim_all AS (SELECT d_date_sk, d_week_seq, d_date, d_year FROM date_dim) SELECT i.i_item_desc, w.w_warehouse_name, d1.d_week_seq, SUM(CASE WHEN p.p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo, SUM(CASE WHEN p.p_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo, COUNT(*) AS total_cnt FROM filtered_catalog_sales cs JOIN filtered_inventory inv ON cs.cs_item_sk = inv.inv_item_sk JOIN warehouse w ON w.w_warehouse_sk = inv.inv_warehouse_sk JOIN filtered_item i ON i.i_item_sk = cs.cs_item_sk JOIN filtered_customer_demographics cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN filtered_household_demographics hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk JOIN filtered_d1 d1 ON cs.cs_sold_date_sk = d1.d_date_sk JOIN date_dim_all d2 ON inv.inv_date_sk = d2.d_date_sk JOIN date_dim_all d3 ON cs.cs_ship_date_sk = d3.d_date_sk LEFT OUTER JOIN promotion p ON cs.cs_promo_sk = p.p_promo_sk LEFT OUTER JOIN catalog_returns cr ON cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number WHERE d1.d_week_seq = d2.d_week_seq AND inv.inv_quantity_on_hand < cs.cs_quantity AND d3.d_date > d1.d_date + interval '3 day' GROUP BY i.i_item_desc, w.w_warehouse_name, d1.d_week_seq ORDER BY total_cnt DESC, i.i_item_desc, w.w_warehouse_name, d1.d_week_seq LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "WIN",
      "speedup": 3.93,
      "semantic_passed": true,
      "error": null,
      "original_ms": 1613.1,
      "patch_ms": 410.8,
      "output_sql": "WITH filtered_d1 AS MATERIALIZED (SELECT d_date_sk, d_week_seq, d_date FROM date_dim WHERE d_year = 1999), filtered_household_demographics AS MATERIALIZED (SELECT hd_demo_sk, hd_buy_potential FROM household_demographics WHERE hd_buy_potential = '>10000'), filtered_customer_demographics AS MATERIALIZED (SELECT cd_demo_sk, cd_marital_status, cd_dep_count FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_dep_count BETWEEN 9 AND 11), filtered_item AS MATERIALIZED (SELECT i_item_sk, i_item_desc, i_category FROM item WHERE i_category IN ('Men', 'Shoes', 'Sports')), filtered_catalog_sales AS MATERIALIZED (SELECT cs_item_sk, cs_order_number, cs_wholesale_cost, cs_bill_cdemo_sk, cs_bill_hdemo_sk, cs_sold_date_sk, cs_ship_date_sk, cs_promo_sk, cs_quantity FROM catalog_sales WHERE cs_wholesale_cost BETWEEN 76 AND 96) SELECT i.i_item_desc, w.w_warehouse_name, d1.d_week_seq, SUM(CASE WHEN p.p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo, SUM(CASE WHEN p.p_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo, COUNT(*) AS total_cnt FROM filtered_catalog_sales cs JOIN inventory inv ON (cs.cs_item_sk = inv.inv_item_sk) JOIN warehouse w ON (w.w_warehouse_sk = inv.inv_warehouse_sk) JOIN filtered_item i ON (i.i_item_sk = cs.cs_item_sk) JOIN filtered_customer_demographics cd ON (cs.cs_bill_cdemo_sk = cd.cd_demo_sk) JOIN filtered_household_demographics hd ON (cs.cs_bill_hdemo_sk = hd.hd_demo_sk) JOIN filtered_d1 d1 ON (cs.cs_sold_date_sk = d1.d_date_sk) JOIN date_dim d2 ON (inv.inv_date_sk = d2.d_date_sk) JOIN date_dim d3 ON (cs.cs_ship_date_sk = d3.d_date_sk) LEFT OUTER JOIN promotion p ON (cs.cs_promo_sk = p.p_promo_sk) LEFT OUTER JOIN catalog_returns cr ON (cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number) WHERE d1.d_week_seq = d2.d_week_seq AND inv.inv_quantity_on_hand < cs.cs_quantity AND d3.d_date > d1.d_date + interval '3 day' GROUP BY i.i_item_desc, w.w_warehouse_name, d1.d_week_seq ORDER BY total_cnt DESC, i.i_item_desc, w.w_warehouse_name, d1.d_week_seq LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p2",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: column d1.d_year does not exist\nLINE 1: ...al '3 day' AND hd.hd_buy_potential = '>10000' AND d1.d_year ...\n                                                             ^\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH d1_filtered AS MATERIALIZED (SELECT d_date_sk, d_week_seq, d_date FROM date_dim WHERE d_year = 1999), d2_filtered AS MATERIALIZED (SELECT d_date_sk, d_week_seq FROM date_dim), d3_filtered AS MATERIALIZED (SELECT d_date_sk, d_date FROM date_dim) SELECT i.i_item_desc, w.w_warehouse_name, d1.d_week_seq, SUM(CASE WHEN p.p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo, SUM(CASE WHEN p.p_promo_sk IS NOT NULL THEN 1 ELSE 0 END) AS promo, COUNT(*) AS total_cnt FROM catalog_sales cs JOIN inventory inv ON (cs.cs_item_sk = inv.inv_item_sk) JOIN warehouse w ON (w.w_warehouse_sk = inv.inv_warehouse_sk) JOIN item i ON (i.i_item_sk = cs.cs_item_sk) JOIN customer_demographics cd ON (cs.cs_bill_cdemo_sk = cd.cd_demo_sk) JOIN household_demographics hd ON (cs.cs_bill_hdemo_sk = hd.hd_demo_sk) JOIN d1_filtered d1 ON (cs.cs_sold_date_sk = d1.d_date_sk) JOIN d2_filtered d2 ON (inv.inv_date_sk = d2.d_date_sk) JOIN d3_filtered d3 ON (cs.cs_ship_date_sk = d3.d_date_sk) LEFT OUTER JOIN promotion p ON (cs.cs_promo_sk = p.p_promo_sk) LEFT OUTER JOIN catalog_returns cr ON (cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number) WHERE d1.d_week_seq = d2.d_week_seq AND inv.inv_quantity_on_hand < cs.cs_quantity AND d3.d_date > d1.d_date + interval '3 day' AND hd.hd_buy_potential = '>10000' AND d1.d_year = 1999 AND cd.cd_marital_status = 'S' AND cd.cd_dep_count BETWEEN 9 AND 11 AND i.i_category IN ('Men', 'Shoes', 'Sports') AND cs.cs_wholesale_cost BETWEEN 76 AND 96 GROUP BY i.i_item_desc, w.w_warehouse_name, d1.d_week_seq ORDER BY total_cnt DESC, i.i_item_desc, w.w_warehouse_name, d1.d_week_seq LIMIT 100;",
      "has_explain": false,
      "description": null
    }
  ],
  "explains": {
    "p01": "Limit  (rows=0, time=106.652)\n  Sort  (rows=0, time=106.651)\n    Aggregate  (rows=0, time=106.633)\n      Hash Join  (rows=0, time=106.613)\n        Hash Join  (rows=0, time=106.611)\n          Merge Join  (rows=0, time=90.332)\n            Sort  (rows=1, time=48.108)\n              Subquery Scan (i)  (rows=34665, time=37.989)\n                CTE Scan (filtered_item)  (rows=34665, time=36.516)\n                  Seq Scan on item  (rows=34665, time=26.149)\n            Materialize  (rows=0, time=42.217)",
    "p04": "Limit  (rows=0, time=469.52)\n  Sort  (rows=0, time=469.518)\n    Aggregate  (rows=0, time=469.5)\n      Nested Loop  (rows=0, time=469.498)\n        Gather Merge  (rows=0, time=469.496)\n          Sort  (rows=0, time=461.739)\n            Nested Loop  (rows=0, time=461.712)\n              Nested Loop  (rows=0, time=461.711)\n                Nested Loop  (rows=0, time=461.71)\n                  Nested Loop  (rows=0, time=461.709)\n                    Hash Join  (rows=0, time=461.707)\n                     ",
    "compile_p01_corrected": "Limit  (rows=0, time=1033.471)\n  Sort  (rows=0, time=1033.467)\n    Aggregate  (rows=0, time=1033.433)\n      Nested Loop  (rows=0, time=1033.428)\n        Gather Merge  (rows=0, time=1033.424)\n          Sort  (rows=0, time=1032.324)\n            Nested Loop  (rows=0, time=1032.306)\n              Nested Loop  (rows=0, time=1032.303)\n                Nested Loop  (rows=0, time=1032.301)\n                  Nested Loop  (rows=0, time=1032.297)\n                    Hash Join  (rows=0, time=1032.293)\n      ",
    "compile_date_dim_cte": "Limit  (rows=0, time=1651.27)\n  Seq Scan on date_dim (date_dim_1)  (rows=0, time=0.0)\n  Sort  (rows=0, time=1651.263)\n    Aggregate  (rows=0, time=1651.239)\n      Incremental Sort  (rows=0, time=1651.235)\n        Nested Loop  (rows=0, time=1651.225)\n          Nested Loop  (rows=0, time=1651.223)\n            Nested Loop  (rows=0, time=1651.222)\n              Nested Loop  (rows=0, time=1651.219)\n                Nested Loop  (rows=0, time=1651.217)\n                  Gather Merge  (rows=0, time=1651",
    "compile_p1": "Limit  (rows=0, time=427.219)\n  Index Scan on date_dim  (rows=0, time=0.0)\n  Seq Scan on household_demographics  (rows=1200, time=0.995)\n  Gather  (rows=0, time=260.876)\n    Seq Scan on customer_demographics  (rows=0, time=259.829)\n  Seq Scan on item  (rows=34665, time=71.547)\n  Seq Scan on catalog_sales  (rows=1, time=0.068)\n  Sort  (rows=0, time=427.082)\n    Aggregate  (rows=0, time=427.022)\n      Sort  (rows=0, time=427.018)\n        Hash Join  (rows=0, time=427.007)\n          Hash Join  (rows"
  }
}