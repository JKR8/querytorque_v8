{
  "iteration": 1,
  "n_api_calls": 5,
  "best_speedup": 1.03,
  "best_patch_id": "novel_1",
  "best_sql": "WITH cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item JOIN (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales JOIN item AS iss ON ss_item_sk = iss.i_item_sk JOIN date_dim AS d1 ON ss_sold_date_sk = d1.d_date_sk WHERE d1.d_year BETWEEN 1999 AND 1999 + 2 AND iss.i_category IN ('Electronics', 'Jewelry', 'Men') AND iss.i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales JOIN item AS ics ON cs_item_sk = ics.i_item_sk JOIN date_dim AS d2 ON cs_sold_date_sk = d2.d_date_sk WHERE d2.d_year BETWEEN 1999 AND 1999 + 2 AND ics.i_category IN ('Electronics', 'Jewelry', 'Men') AND ics.i_manager_id BETWEEN 91 AND 100 AND cs_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales JOIN item AS iws ON ws_item_sk = iws.i_item_sk JOIN date_dim AS d3 ON ws_sold_date_sk = d3.d_date_sk WHERE d3.d_year BETWEEN 1999 AND 1999 + 2 AND iws.i_category IN ('Electronics', 'Jewelry', 'Men') AND iws.i_manager_id BETWEEN 91 AND 100 AND ws_wholesale_cost BETWEEN 35 AND 55) AS x ON i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id WHERE i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND ss_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT cs_quantity, cs_list_price FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND cs_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT ws_quantity, ws_list_price FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND ws_wholesale_cost BETWEEN 35 AND 55) AS x) SELECT this_year.channel AS ty_channel, this_year.i_brand_id AS ty_brand, this_year.i_class_id AS ty_class, this_year.i_category_id AS ty_category, this_year.sales AS ty_sales, this_year.number_sales AS ty_number_sales, last_year.channel AS ly_channel, last_year.i_brand_id AS ly_brand, last_year.i_class_id AS ly_class, last_year.i_category_id AS ly_category, last_year.sales AS ly_sales, last_year.number_sales AS ly_number_sales FROM (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 20) AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS this_year, (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 20) AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS last_year WHERE this_year.i_brand_id = last_year.i_brand_id AND this_year.i_class_id = last_year.i_class_id AND this_year.i_category_id = last_year.i_category_id ORDER BY this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id LIMIT 100;",
  "patches": [
    {
      "patch_id": "combo_1",
      "family": "C+D",
      "transform": "aggregation_pushdown_then_setop_rewrite",
      "relevance_score": 0.97,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1 structural: COLUMN REF MISMATCH: Original columns missing from rewrite \u2014 ['brand_id', 'category_id', 'class_id']. The rewrite references different table columns.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss.ss_quantity AS quantity, ss.ss_list_price AS list_price FROM store_sales AS ss JOIN date_dim AS d1 ON ss.ss_sold_date_sk = d1.d_date_sk WHERE d1.d_year BETWEEN 1999 AND 1999 + 2 AND ss.ss_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT cs.cs_quantity AS quantity, cs.cs_list_price AS list_price FROM catalog_sales AS cs JOIN date_dim AS d2 ON cs.cs_sold_date_sk = d2.d_date_sk WHERE d2.d_year BETWEEN 1999 AND 1999 + 2 AND cs.cs_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT ws.ws_quantity AS quantity, ws.ws_list_price AS list_price FROM web_sales AS ws JOIN date_dim AS d3 ON ws.ws_sold_date_sk = d3.d_date_sk WHERE d3.d_year BETWEEN 1999 AND 1999 + 2 AND ws.ws_wholesale_cost BETWEEN 35 AND 55) AS x), store_sales_agg AS (SELECT iss.i_brand_id, iss.i_class_id, iss.i_category_id FROM store_sales AS ss JOIN item AS iss ON ss.ss_item_sk = iss.i_item_sk JOIN date_dim AS d1 ON ss.ss_sold_date_sk = d1.d_date_sk WHERE d1.d_year BETWEEN 1999 AND 1999 + 2 AND iss.i_category IN ('Electronics', 'Jewelry', 'Men') AND iss.i_manager_id BETWEEN 91 AND 100 AND ss.ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY iss.i_brand_id, iss.i_class_id, iss.i_category_id), catalog_sales_agg AS (SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales AS cs JOIN item AS ics ON cs.cs_item_sk = ics.i_item_sk JOIN date_dim AS d2 ON cs.cs_sold_date_sk = d2.d_date_sk WHERE d2.d_year BETWEEN 1999 AND 1999 + 2 AND ics.i_category IN ('Electronics', 'Jewelry', 'Men') AND ics.i_manager_id BETWEEN 91 AND 100 AND cs.cs_wholesale_cost BETWEEN 35 AND 55 GROUP BY ics.i_brand_id, ics.i_class_id, ics.i_category_id), web_sales_agg AS (SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales AS ws JOIN item AS iws ON ws.ws_item_sk = iws.i_item_sk JOIN date_dim AS d3 ON ws.ws_sold_date_sk = d3.d_date_sk WHERE d3.d_year BETWEEN 1999 AND 1999 + 2 AND iws.i_category IN ('Electronics', 'Jewelry', 'Men') AND iws.i_manager_id BETWEEN 91 AND 100 AND ws.ws_wholesale_cost BETWEEN 35 AND 55 GROUP BY iws.i_brand_id, iws.i_class_id, iws.i_category_id), cross_items AS (SELECT i.i_item_sk AS ss_item_sk FROM item AS i WHERE i.i_category IN ('Electronics', 'Jewelry', 'Men') AND i.i_manager_id BETWEEN 91 AND 100 AND EXISTS(SELECT 1 FROM store_sales_agg AS ssa WHERE ssa.i_brand_id = i.i_brand_id AND ssa.i_class_id = i.i_class_id AND ssa.i_category_id = i.i_category_id) AND EXISTS(SELECT 1 FROM catalog_sales_agg AS csa WHERE csa.i_brand_id = i.i_brand_id AND csa.i_class_id = i.i_class_id AND csa.i_category_id = i.i_category_id) AND EXISTS(SELECT 1 FROM web_sales_agg AS wsa WHERE wsa.i_brand_id = i.i_brand_id AND wsa.i_class_id = i.i_class_id AND wsa.i_category_id = i.i_category_id)) SELECT this_year.channel AS ty_channel, this_year.i_brand_id AS ty_brand, this_year.i_class_id AS ty_class, this_year.i_category_id AS ty_category, this_year.sales AS ty_sales, this_year.number_sales AS ty_number_sales, last_year.channel AS ly_channel, last_year.i_brand_id AS ly_brand, last_year.i_class_id AS ly_class, last_year.i_category_id AS ly_category, last_year.sales AS ly_sales, last_year.number_sales AS ly_number_sales FROM (SELECT 'store' AS channel, i.i_brand_id, i.i_class_id, i.i_category_id, SUM(ss.ss_quantity * ss.ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales AS ss JOIN item AS i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d.d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 20) AND i.i_category IN ('Electronics', 'Jewelry', 'Men') AND i.i_manager_id BETWEEN 91 AND 100 AND ss.ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i.i_brand_id, i.i_class_id, i.i_category_id HAVING SUM(ss.ss_quantity * ss.ss_list_price) > (SELECT average_sales FROM avg_sales)) AS this_year, (SELECT 'store' AS channel, i.i_brand_id, i.i_class_id, i.i_category_id, SUM(ss.ss_quantity * ss.ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales AS ss JOIN item AS i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d.d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 20) AND i.i_category IN ('Electronics', 'Jewelry', 'Men') AND i.i_manager_id BETWEEN 91 AND 100 AND ss.ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i.i_brand_id, i.i_class_id, i.i_category_id HAVING SUM(ss.ss_quantity * ss.ss_list_price) > (SELECT average_sales FROM avg_sales)) AS last_year WHERE this_year.i_brand_id = last_year.i_brand_id AND this_year.i_class_id = last_year.i_class_id AND this_year.i_category_id = last_year.i_category_id ORDER BY this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id LIMIT 100;",
      "has_explain": false
    },
    {
      "patch_id": "refine_1",
      "family": "A+D",
      "transform": "push_week_filter_into_cte+fixed_setop_to_exists",
      "relevance_score": 0.92,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1 structural: LITERAL MISMATCH: Original literals missing from rewrite \u2014 strings: ['store']. The rewrite changed filter values instead of preserving them.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item, (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales, item AS iss, date_dim AS d1 WHERE ss_item_sk = iss.i_item_sk AND ss_sold_date_sk = d1.d_date_sk AND d1.d_year BETWEEN 1999 AND 1999 + 2 AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales, item AS ics, date_dim AS d2 WHERE cs_item_sk = ics.i_item_sk AND cs_sold_date_sk = d2.d_date_sk AND d2.d_year BETWEEN 1999 AND 1999 + 2 AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND cs_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales, item AS iws, date_dim AS d3 WHERE ws_item_sk = iws.i_item_sk AND ws_sold_date_sk = d3.d_date_sk AND ws_wholesale_cost BETWEEN 35 AND 55 AND d3.d_year BETWEEN 1999 AND 1999 + 2) AS x WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 AND ss_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 AND cs_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales, date_dim WHERE ws_sold_date_sk = d_date_sk AND ws_wholesale_cost BETWEEN 35 AND 55 AND d_year BETWEEN 1999 AND 1999 + 2) AS x), filtered_week AS (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 20), store_sales_filtered AS (SELECT iss.i_item_sk, iss.i_brand_id, iss.i_class_id, iss.i_category_id FROM store_sales JOIN item AS iss ON ss_item_sk = iss.i_item_sk JOIN date_dim AS d1 ON ss_sold_date_sk = d1.d_date_sk WHERE d1.d_year BETWEEN 1999 AND 1999 + 2 AND iss.i_category IN ('Electronics', 'Jewelry', 'Men') AND iss.i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55), catalog_sales_filtered AS (SELECT ics.i_item_sk, ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales JOIN item AS ics ON cs_item_sk = ics.i_item_sk JOIN date_dim AS d2 ON cs_sold_date_sk = d2.d_date_sk WHERE d2.d_year BETWEEN 1999 AND 1999 + 2 AND ics.i_category IN ('Electronics', 'Jewelry', 'Men') AND ics.i_manager_id BETWEEN 91 AND 100 AND cs_wholesale_cost BETWEEN 35 AND 55) SELECT i.i_item_sk AS ss_item_sk FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 20) AS lw ON d_week_seq = lw.d_week_seq WHERE i.i_category IN ('Electronics', 'Jewelry', 'Men') AND i.i_manager_id BETWEEN 91 AND 100 AND EXISTS(SELECT 1 FROM store_sales_filtered AS ssf WHERE ssf.i_brand_id = i.i_brand_id AND ssf.i_class_id = i.i_class_id AND ssf.i_category_id = i.i_category_id) AND EXISTS(SELECT 1 FROM catalog_sales_filtered AS csf WHERE csf.i_brand_id = i.i_brand_id AND csf.i_class_id = i.i_class_id AND csf.i_category_id = i.i_category_id) AND EXISTS(SELECT 1 FROM web_sales JOIN item AS iws ON ws_item_sk = iws.i_item_sk JOIN date_dim AS d3 ON ws_sold_date_sk = d3.d_date_sk WHERE d3.d_year BETWEEN 1999 AND 1999 + 2 AND iws.i_category = i.i_category AND iws.i_manager_id BETWEEN 91 AND 100 AND ws_wholesale_cost BETWEEN 35 AND 55 AND iws.i_brand_id = i.i_brand_id AND iws.i_class_id = i.i_class_id AND iws.i_category_id = i.i_category_id);",
      "has_explain": false
    },
    {
      "patch_id": "novel_1",
      "family": "E",
      "transform": "cte_materialization",
      "relevance_score": 0.85,
      "status": "NEUTRAL",
      "speedup": 1.03,
      "semantic_passed": true,
      "error": null,
      "original_ms": 10558.5,
      "patch_ms": 10235.3,
      "output_sql": "WITH cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item JOIN (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales JOIN item AS iss ON ss_item_sk = iss.i_item_sk JOIN date_dim AS d1 ON ss_sold_date_sk = d1.d_date_sk WHERE d1.d_year BETWEEN 1999 AND 1999 + 2 AND iss.i_category IN ('Electronics', 'Jewelry', 'Men') AND iss.i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales JOIN item AS ics ON cs_item_sk = ics.i_item_sk JOIN date_dim AS d2 ON cs_sold_date_sk = d2.d_date_sk WHERE d2.d_year BETWEEN 1999 AND 1999 + 2 AND ics.i_category IN ('Electronics', 'Jewelry', 'Men') AND ics.i_manager_id BETWEEN 91 AND 100 AND cs_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales JOIN item AS iws ON ws_item_sk = iws.i_item_sk JOIN date_dim AS d3 ON ws_sold_date_sk = d3.d_date_sk WHERE d3.d_year BETWEEN 1999 AND 1999 + 2 AND iws.i_category IN ('Electronics', 'Jewelry', 'Men') AND iws.i_manager_id BETWEEN 91 AND 100 AND ws_wholesale_cost BETWEEN 35 AND 55) AS x ON i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id WHERE i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND ss_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT cs_quantity, cs_list_price FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND cs_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT ws_quantity, ws_list_price FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND ws_wholesale_cost BETWEEN 35 AND 55) AS x) SELECT this_year.channel AS ty_channel, this_year.i_brand_id AS ty_brand, this_year.i_class_id AS ty_class, this_year.i_category_id AS ty_category, this_year.sales AS ty_sales, this_year.number_sales AS ty_number_sales, last_year.channel AS ly_channel, last_year.i_brand_id AS ly_brand, last_year.i_class_id AS ly_class, last_year.i_category_id AS ly_category, last_year.sales AS ly_sales, last_year.number_sales AS ly_number_sales FROM (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 20) AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS this_year, (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 20) AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS last_year WHERE this_year.i_brand_id = last_year.i_brand_id AND this_year.i_class_id = last_year.i_class_id AND this_year.i_category_id = last_year.i_category_id ORDER BY this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id LIMIT 100;",
      "has_explain": true
    }
  ],
  "explains": {
    "novel_1": "Limit  (rows=47, time=11852.818)\n  Hash Join  (rows=2637, time=3859.645)\n    Subquery Scan (x)  (rows=371, time=3834.098)\n      SetOp  (rows=371, time=3834.075)\n        Append  (rows=5490, time=3831.295)\n          Subquery Scan (*SELECT* 3)  (rows=5107, time=657.504)\n            Gather  (rows=5107, time=656.637)\n              Nested Loop  (rows=1702, time=543.169)\n                Nested Loop  (rows=127903, time=306.108)\n                  Index Only Scan on date_dim (d3)  (rows=365, time=0.726)\n "
  }
}