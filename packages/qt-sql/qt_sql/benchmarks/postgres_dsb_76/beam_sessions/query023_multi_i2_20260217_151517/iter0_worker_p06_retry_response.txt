{
  "probe_id": "p06",
  "transform_id": "inner_join_conversion",
  "family": "F",
  "dialect": "postgres",
  "hypothesis": "Convert comma-join syntax to explicit INNER JOIN in max_store_sales subquery to improve PostgreSQL's join order planning and cardinality estimates.",
  "reasoning_trace": [
    "Target is the max_store_sales CTE which uses comma-join syntax: FROM store_sales, customer, date_dim",
    "PostgreSQL exhibits COMMA_JOIN_WEAKNESS with poor row estimates on such joins",
    "Replacing with explicit JOIN syntax will allow better optimization and early filtering"
  ],
  "target_ir": "Explicit INNER JOIN syntax in max_store_sales CTE with equivalent join conditions preserved",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_from",
      "target": {"by_node_id": "S0"},
      "payload": {
        "from_sql": "(select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ss inner join customer c on ss.ss_customer_sk = c.c_customer_sk inner join date_dim d on ss.ss_sold_date_sk = d.d_date_sk where d.d_year = 1999 and ss.ss_wholesale_cost BETWEEN 26 AND 36 group by c_customer_sk) tmp1)"
      }
    }
  ]
}