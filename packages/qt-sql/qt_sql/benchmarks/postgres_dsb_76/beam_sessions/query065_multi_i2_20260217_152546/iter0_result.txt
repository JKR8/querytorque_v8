{
  "iteration": 0,
  "n_api_calls": 20,
  "beam_cost_usd": 0.09096662,
  "beam_cost_priced_calls": 20,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 95568,
    "completion_tokens": 31679,
    "total_tokens": 127247,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 38720
  },
  "best_speedup": 0.0,
  "best_patch_id": null,
  "best_sql": null,
  "patches": [
    {
      "patch_id": "p10",
      "family": "E",
      "transform": "materialize_cte",
      "relevance_score": 0.83,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_revenue_base AS (SELECT ss_store_sk, ss_item_sk, ss_sales_price, ss_list_price FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, (SELECT ss_store_sk, AVG(revenue) AS ave FROM (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sa GROUP BY ss_store_sk) AS sb, (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sc WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Materialize base revenue CTE for reuse in sb/sc"
    },
    {
      "patch_id": "p02",
      "family": "F",
      "transform": "date_cte_explicit_join",
      "relevance_score": 0.88,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1215 AND 1215 + 11) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, (SELECT ss_store_sk, AVG(revenue) AS ave FROM (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sa GROUP BY ss_store_sk) AS sb, (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sc WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Convert comma joins to explicit INNER JOINs after pre-filtering date_dim in CTE"
    },
    {
      "patch_id": "p01",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.92,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH base_revenue_data AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, (SELECT ss_store_sk, AVG(revenue) AS ave FROM base_revenue_data GROUP BY ss_store_sk) AS sb, (SELECT ss_store_sk, ss_item_sk, revenue FROM base_revenue_data) AS sc WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Consolidate sa/sc subqueries into single MATERIALIZED base_cte: (ss_store_sk, ss_item_sk, revenue) with filters, reuse in sb/sc"
    },
    {
      "patch_id": "p08",
      "family": "A",
      "transform": "prefetch_fact_join",
      "relevance_score": 0.82,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH valid_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1215 AND 1215 + 11), filtered_sales AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales JOIN valid_dates AS vd ON vd.d_date_sk = ss_sold_date_sk WHERE ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, (SELECT ss_store_sk, AVG(revenue) AS ave FROM filtered_sales GROUP BY ss_store_sk) AS sb, filtered_sales AS sc WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Chain CTEs: date_filter \u2192 store_sales JOIN \u2192 pre-aggregation"
    },
    {
      "patch_id": "p04",
      "family": "B",
      "transform": "early_filter_decorrelate",
      "relevance_score": 0.9,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_thresholds AS (SELECT ss_store_sk, AVG(revenue) AS ave FROM (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sa GROUP BY ss_store_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, store_thresholds AS sb, (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sc WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Precompute sb.ave threshold in CTE before main query, join via sc.revenue <= 0.1 * sb_threshold.ave"
    },
    {
      "patch_id": "p09",
      "family": "B",
      "transform": "inline_decorrelate_materialized",
      "relevance_score": 0.87,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH sb AS (SELECT ss_store_sk, AVG(revenue) AS ave FROM (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sa GROUP BY ss_store_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, sb, (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sc WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Materialize threshold CTE with GROUP BY ss_store_sk, use in main query JOIN"
    },
    {
      "patch_id": "p11",
      "family": "A",
      "transform": "early_filter",
      "relevance_score": 0.85,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_state IN ('KS', 'OH', 'SD')), filtered_item AS (SELECT i_item_sk FROM item WHERE i_manager_id BETWEEN 10 AND 14) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM filtered_store AS fs, filtered_item AS fi, (SELECT ss_store_sk, AVG(revenue) AS ave FROM (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sa GROUP BY ss_store_sk) AS sb, (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sc WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND fs.s_store_sk = sc.ss_store_sk AND fi.i_item_sk = sc.ss_item_sk ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Push store.s_state and item.i_manager_id filters into CTE definitions"
    },
    {
      "patch_id": "p03",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.85,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_state IN ('KS', 'OH', 'SD')), filtered_item AS (SELECT i_item_sk FROM item WHERE i_manager_id BETWEEN 10 AND 14), sales_summary AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM filtered_store AS fs JOIN filtered_item AS fi ON TRUE JOIN sales_summary AS sc ON fs.s_store_sk = sc.ss_store_sk AND fi.i_item_sk = sc.ss_item_sk JOIN (SELECT ss_store_sk, AVG(revenue) AS ave FROM sales_summary GROUP BY ss_store_sk) AS sb ON sb.ss_store_sk = sc.ss_store_sk WHERE sc.revenue <= 0.1 * sb.ave ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Pre-filter store/item in CTEs: store_cte (s_store_sk) WHERE s_state IN, item_cte (i_item_sk) WHERE i_manager_id BETWEEN"
    },
    {
      "patch_id": "p12",
      "family": "C",
      "transform": "aggregate_pushdown",
      "relevance_score": 0.78,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_store_sales AS (SELECT ss_store_sk, ss_item_sk, ss_sales_price FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01), preagg_revenue AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM filtered_store_sales GROUP BY ss_store_sk, ss_item_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, preagg_revenue AS sc, (SELECT ss_store_sk, AVG(revenue) AS ave FROM preagg_revenue GROUP BY ss_store_sk) AS sb WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Pre-aggregate store_sales before joining date_dim (ss_store_sk, ss_item_sk, revenue)"
    },
    {
      "patch_id": "p07",
      "family": "A",
      "transform": "shared_dimension_multi_channel",
      "relevance_score": 0.8,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH date_sk_filter AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1215 AND 1226) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, (SELECT ss_store_sk, AVG(revenue) AS ave FROM (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sa GROUP BY ss_store_sk) AS sb, (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sc WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Create date_cte MATERIALIZED for d_month_seq filter, reference in both sa/sc subqueries"
    },
    {
      "patch_id": "p05",
      "family": "C",
      "transform": "single_pass_aggregation",
      "relevance_score": 0.75,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_revenue_stats AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue, AVG(SUM(ss_sales_price)) OVER (PARTITION BY ss_store_sk) AS ave FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, store_revenue_stats AS sc WHERE sc.revenue <= 0.1 * sc.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Consolidate sa/sc aggregates: single CTE computing revenue (ss_store_sk, ss_item_sk) and AVG(revenue) per store"
    },
    {
      "patch_id": "p06",
      "family": "C",
      "transform": "channel_bitmap_aggregation",
      "relevance_score": 0.7,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH revenue_by_store_item AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk), store_avg_revenue AS (SELECT ss_store_sk, AVG(revenue) AS ave FROM revenue_by_store_item GROUP BY ss_store_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, revenue_by_store_item AS sc, store_avg_revenue AS sb WHERE sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": "Combine sa/sc scans: single CASE-based aggregation for revenue per (store,item) and store-level AVG"
    },
    {
      "patch_id": "snipe_p1",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH base_revenue_data AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk), filtered_store AS (SELECT s_store_sk, s_store_name FROM store WHERE s_state IN ('KS', 'OH', 'SD')), filtered_item AS (SELECT i_item_sk, i_item_desc, i_current_price, i_wholesale_cost, i_brand FROM item WHERE i_manager_id BETWEEN 10 AND 14), sb AS (SELECT ss_store_sk, AVG(revenue) AS ave FROM base_revenue_data GROUP BY ss_store_sk) SELECT s.s_store_name, i.i_item_desc, sc.revenue, i.i_current_price, i.i_wholesale_cost, i.i_brand FROM filtered_store AS s JOIN base_revenue_data AS sc ON s.s_store_sk = sc.ss_store_sk JOIN filtered_item AS i ON i.i_item_sk = sc.ss_item_sk JOIN sb ON sc.ss_store_sk = sb.ss_store_sk WHERE sc.revenue <= 0.1 * sb.ave ORDER BY s.s_store_name, i.i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p2",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH base_revenue_data AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk), sb AS (SELECT ss_store_sk, AVG(revenue) AS ave FROM base_revenue_data GROUP BY ss_store_sk) SELECT s.s_store_name, i.i_item_desc, sc.revenue, i.i_current_price, i.i_wholesale_cost, i.i_brand FROM store AS s, item AS i, sb, base_revenue_data AS sc WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s.s_store_sk = sc.ss_store_sk AND i.i_item_sk = sc.ss_item_sk AND i.i_manager_id BETWEEN 10 AND 14 AND s.s_state IN ('KS', 'OH', 'SD') ORDER BY s.s_store_name, i.i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p1",
      "family": "E",
      "transform": "base_revenue_cte_plus_dimension_prefilter",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH base_revenue AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_month_seq BETWEEN 1215 AND 1215 + 11 AND ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk), filtered_store AS (SELECT s_store_sk, s_store_name FROM store WHERE s_state IN ('KS', 'OH', 'SD')), filtered_item AS (SELECT i_item_sk, i_item_desc, i_current_price, i_wholesale_cost, i_brand FROM item WHERE i_manager_id BETWEEN 10 AND 14), sb AS (SELECT ss_store_sk, AVG(revenue) AS ave FROM base_revenue GROUP BY ss_store_sk), sc AS (SELECT ss_store_sk, ss_item_sk, revenue FROM base_revenue) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM filtered_store JOIN sc ON filtered_store.s_store_sk = sc.ss_store_sk JOIN filtered_item ON filtered_item.i_item_sk = sc.ss_item_sk JOIN sb ON sc.ss_store_sk = sb.ss_store_sk WHERE sc.revenue <= 0.1 * sb.ave ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p2",
      "family": "F",
      "transform": "explicit_join_plus_date_cte",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1215 AND 1215 + 11), base_revenue AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price / ss_list_price BETWEEN 79 * 0.01 AND 89 * 0.01 GROUP BY ss_store_sk, ss_item_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store JOIN item ON TRUE JOIN (SELECT ss_store_sk, AVG(revenue) AS ave FROM base_revenue GROUP BY ss_store_sk) AS sb ON TRUE JOIN (SELECT ss_store_sk, ss_item_sk, revenue FROM base_revenue) AS sc ON sb.ss_store_sk = sc.ss_store_sk WHERE sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 10 AND 14 AND s_state IN ('KS', 'OH', 'SD') ORDER BY s_store_name, i_item_desc LIMIT 100;",
      "has_explain": false,
      "description": null
    }
  ],
  "explains": {}
}