{
  "iteration": 2,
  "n_api_calls": 5,
  "best_speedup": 0.0,
  "best_patch_id": null,
  "best_sql": null,
  "patches": [
    {
      "patch_id": "t1",
      "family": "A+C",
      "transform": "early_filter_and_agg_pushdown",
      "relevance_score": 0.95,
      "status": "REGRESSION",
      "speedup": 0.94,
      "semantic_passed": true,
      "error": null,
      "original_ms": 197.9,
      "patch_ms": 209.9,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), filtered_call_center AS (SELECT cc_call_center_sk, cc_call_center_id, cc_name, cc_manager FROM call_center) SELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN filtered_call_center ON cr_call_center_sk = cc_call_center_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk JOIN customer_address ON ca_address_sk = c_current_addr_sk WHERE ((cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')) AND hd_buy_potential LIKE '>10000%' AND ca_gmt_offset = -6 GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC;",
      "has_explain": true
    },
    {
      "patch_id": "t4",
      "family": "C",
      "transform": "agg_pushdown_after_fact_joins",
      "relevance_score": 0.75,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Equivalence execution error: column \"cr_net_loss\" does not exist\nLINE 1: ...e AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_los...\n                                                             ^\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), preagg_returns AS (SELECT cr_call_center_sk, cr_returning_customer_sk, SUM(cr_net_loss) AS total_loss FROM catalog_returns JOIN filtered_date ON cr_returned_date_sk = d_date_sk GROUP BY cr_call_center_sk, cr_returning_customer_sk) SELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM call_center JOIN preagg_returns ON cc_call_center_sk = cr_call_center_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_address ON ca_address_sk = c_current_addr_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk WHERE ((cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')) AND hd_buy_potential LIKE '>10000%' AND ca_gmt_offset = -6 GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC;",
      "has_explain": false
    },
    {
      "patch_id": "t2",
      "family": "E+F",
      "transform": "prefetch_dims_with_propagated_columns+explicit_join_reordering",
      "relevance_score": 0.85,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1 structural: Column mismatch: 0 missing, 2 extra",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), filtered_call_centers AS (SELECT cc_call_center_sk, cc_call_center_id, cc_name, cc_manager FROM call_center), filtered_customers AS (SELECT c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk FROM customer), filtered_customer_demographics AS (SELECT cd_demo_sk, cd_marital_status, cd_education_status FROM customer_demographics WHERE (cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')), filtered_household_demographics AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential LIKE '>10000%'), filtered_customer_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -6), prefetched_returns AS (SELECT cr_call_center_sk, cr_returning_customer_sk, cr_net_loss, cd_marital_status, cd_education_status FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN filtered_call_centers ON cr_call_center_sk = cc_call_center_sk JOIN filtered_customers ON cr_returning_customer_sk = c_customer_sk JOIN filtered_customer_demographics ON c_current_cdemo_sk = cd_demo_sk JOIN filtered_household_demographics ON c_current_hdemo_sk = hd_demo_sk JOIN filtered_customer_addresses ON c_current_addr_sk = ca_address_sk) SELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, cd_marital_status, cd_education_status, SUM(cr_net_loss) AS Returns_Loss FROM prefetched_returns GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC;",
      "has_explain": false
    }
  ],
  "explains": {
    "t1": "Sort  (rows=8, time=750.674)\n  Aggregate  (rows=8, time=750.651)\n    Gather Merge  (rows=8, time=750.631)\n      Aggregate  (rows=8, time=750.15)\n        Sort  (rows=470, time=750.055)\n          Nested Loop  (rows=470, time=749.045)\n            Nested Loop  (rows=869, time=736.17)\n              Nested Loop  (rows=5564, time=666.811)\n                Nested Loop  (rows=31226, time=599.61)\n                  Hash Join  (rows=31526, time=310.889)\n                    Hash Join  (rows=32159, time=305.12"
  }
}