[
  {
    "target_id": "t1",
    "family": "A",
    "transform": "early_filtering",
    "relevance_score": 0.95,
    "hypothesis": "Dimension table filters (date_dim, customer_demographics, etc.) are applied late after large joins. Pushing filters into CTEs reduces fact table join cardinality.",
    "target_ir": "S0 [SELECT]\n  CTE: filtered_date  (via Q1)\n    FROM: date_dim\n    WHERE: d_year = 2001 AND d_moy = 12\n  CTE: filtered_cd  (via Q2)\n    FROM: customer_demographics\n    WHERE: (cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')\n  CTE: filtered_hd  (via Q3)\n    FROM: household_demographics\n    WHERE: hd_buy_potential LIKE '>10000%'\n  CTE: filtered_ca  (via Q4)\n    FROM: customer_address\n    WHERE: ca_gmt_offset = -6\n  MAIN QUERY (via Q0)\n    FROM: catalog_returns\n    JOIN filtered_date ON cr_returned_date_sk = d_date_sk\n    JOIN call_center ON cr_call_center_sk = cc_call_center_sk\n    JOIN customer ON cr_returning_customer_sk = c_customer_sk\n    JOIN filtered_cd ON cd_demo_sk = c_current_cdemo_sk\n    JOIN filtered_hd ON hd_demo_sk = c_current_hdemo_sk\n    JOIN filtered_ca ON ca_address_sk = c_current_addr_sk\n    GROUP BY: cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status\n    ORDER BY: SUM(cr_net_loss) DESC",
    "recommended_examples": [
      "pg_date_cte_explicit_join"
    ]
  },
  {
    "target_id": "t2",
    "family": "E",
    "transform": "multi_dimension_prefetch",
    "relevance_score": 0.85,
    "hypothesis": "Repeated dimension table scans (customer_demographics, household_demographics) with identical filters. Prefetching filtered dimensions reduces redundant work.",
    "target_ir": "S0 [SELECT]\n  CTE: prefetched_dims  (via Q1)\n    FROM: \n      customer_demographics,\n      household_demographics,\n      customer_address\n    WHERE: \n      (cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')\n      AND hd_buy_potential LIKE '>10000%'\n      AND ca_gmt_offset = -6\n  MAIN QUERY (via Q0)\n    FROM: catalog_returns\n    JOIN date_dim ON cr_returned_date_sk = d_date_sk\n    JOIN call_center ON cr_call_center_sk = cc_call_center_sk\n    JOIN customer ON cr_returning_customer_sk = c_customer_sk\n    JOIN prefetched_dims ON \n      cd_demo_sk = c_current_cdemo_sk AND\n      hd_demo_sk = c_current_hdemo_sk AND\n      ca_address_sk = c_current_addr_sk\n    WHERE: d_year = 2001 AND d_moy = 12\n    GROUP BY: cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status\n    ORDER BY: SUM(cr_net_loss) DESC",
    "recommended_examples": [
      "multi_dimension_prefetch"
    ]
  },
  {
    "target_id": "t3",
    "family": "F",
    "transform": "explicit_join_ordering",
    "relevance_score": 0.75,
    "hypothesis": "Implicit comma joins prevent optimal join ordering. Explicit joins with filtered dimensions first improve predicate pushdown.",
    "target_ir": "S0 [SELECT]\n  MAIN QUERY (via Q0)\n    FROM: date_dim\n    JOIN catalog_returns ON d_date_sk = cr_returned_date_sk\n    JOIN call_center ON cc_call_center_sk = cr_call_center_sk\n    JOIN customer ON c_customer_sk = cr_returning_customer_sk\n    JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk\n    JOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk\n    JOIN customer_address ON ca_address_sk = c_current_addr_sk\n    WHERE: \n      d_year = 2001 AND d_moy = 12\n      AND ((cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree'))\n      AND hd_buy_potential LIKE '>10000%'\n      AND ca_gmt_offset = -6\n    GROUP BY: cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status\n    ORDER BY: SUM(cr_net_loss) DESC",
    "recommended_examples": [
      "pg_explicit_join_materialized"
    ]
  }
]