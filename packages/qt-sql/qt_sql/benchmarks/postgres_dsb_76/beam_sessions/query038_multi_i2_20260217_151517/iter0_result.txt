{
  "iteration": 0,
  "n_api_calls": 20,
  "beam_cost_usd": 0.10100088,
  "beam_cost_priced_calls": 20,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 104160,
    "completion_tokens": 35096,
    "total_tokens": 139256,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 40128
  },
  "best_speedup": 0.0,
  "best_patch_id": null,
  "best_sql": null,
  "patches": [
    {
      "patch_id": "p03",
      "family": "A",
      "transform": "dimension_cte_isolate",
      "relevance_score": 0.75,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_month IN (2, 3, 4, 10)) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": "Create CTE: filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_month IN (2,3,4,10)). Replace all customer references."
    },
    {
      "patch_id": "p05",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.8,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11), filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_month IN (2, 3, 4, 10)) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_customers ON store_sales.ss_customer_sk = filtered_customers.c_customer_sk WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN filtered_dates ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_customers ON catalog_sales.cs_bill_customer_sk = filtered_customers.c_customer_sk WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN filtered_dates ON web_sales.ws_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_customers ON web_sales.ws_bill_customer_sk = filtered_customers.c_customer_sk WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": "Combine p02+p03+p04: Prefilter dimensions into CTEs, use explicit JOINs in all branches"
    },
    {
      "patch_id": "p10",
      "family": "F",
      "transform": "materialized_dimension_fact_prefilter",
      "relevance_score": 0.75,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_sales_f AS (SELECT * FROM store_sales WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_sales_f AS (SELECT * FROM catalog_sales WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_sales_f AS (SELECT * FROM web_sales WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": "Add fact prefilter CTEs: WITH store_sales_f AS (SELECT * FROM store_sales WHERE ss_list_price... AND ss_wholesale_cost...) then join to dimensions"
    },
    {
      "patch_id": "p09",
      "family": "A",
      "transform": "multi_dimension_prefetch",
      "relevance_score": 0.65,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Failed to parse/apply PatchPlan",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": null,
      "has_explain": false,
      "description": "Stage CTEs: 1) filtered_dates 2) filtered_customers 3) prejoined_facts (JOIN facts to CTEs)"
    },
    {
      "patch_id": "p04",
      "family": "F",
      "transform": "date_cte_explicit_join",
      "relevance_score": 0.85,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk WHERE c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN filtered_dates ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk JOIN customer ON catalog_sales.cs_bill_customer_sk = customer.c_customer_sk WHERE c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN filtered_dates ON web_sales.ws_sold_date_sk = filtered_dates.d_date_sk JOIN customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk WHERE c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": "Convert comma joins to explicit INNER JOIN. Example: FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_customers ON ss_customer_sk = c_customer_sk"
    },
    {
      "patch_id": "p02",
      "family": "A",
      "transform": "date_cte_isolate",
      "relevance_score": 0.7,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, customer, filtered_dates WHERE store_sales.ss_sold_date_sk = filtered_dates.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, customer, filtered_dates WHERE catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, customer, filtered_dates WHERE web_sales.ws_sold_date_sk = filtered_dates.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": "Create CTE: filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1218). Replace all date_dim references with this CTE."
    },
    {
      "patch_id": "p01",
      "family": "D",
      "transform": "intersect_to_exists",
      "relevance_score": 0.65,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1: Column mismatch: 1 missing, 3 extra",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_sales_filtered AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_sales_filtered AS (SELECT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_sales_filtered AS (SELECT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM customer AS c JOIN date_dim AS d ON c.c_customer_sk = ssf.ss_customer_sk AND d.d_date_sk = ssf.ss_sold_date_sk JOIN store_sales_filtered AS ssf ON TRUE WHERE d.d_month_seq BETWEEN 1207 AND 1207 + 11 AND c.c_birth_month IN (2, 3, 4, 10) AND EXISTS(SELECT 1 FROM catalog_sales_filtered AS csf WHERE csf.cs_bill_customer_sk = c.c_customer_sk AND csf.cs_sold_date_sk = d.d_date_sk) AND EXISTS(SELECT 1 FROM web_sales_filtered AS wsf WHERE wsf.ws_bill_customer_sk = c.c_customer_sk AND wsf.ws_sold_date_sk = d.d_date_sk) LIMIT 100;",
      "has_explain": false,
      "description": "Replace INTERSECT with EXISTS subqueries. Rewrite main query as: SELECT DISTINCT c_last_name, c_first_name, d_date FROM customer c JOIN date_dim d ON ... WHERE EXISTS (store_sales) AND EXISTS (catalog_sales) AND EXISTS (web_sales)"
    },
    {
      "patch_id": "p07",
      "family": "B",
      "transform": "early_filter_decorrelate",
      "relevance_score": 0.8,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11), filtered_customers AS (SELECT c_customer_sk FROM customer WHERE c_birth_month IN (2, 3, 4, 10)) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, filtered_dates AS fd, filtered_customers AS fc WHERE store_sales.ss_sold_date_sk = fd.d_date_sk AND store_sales.ss_customer_sk = fc.c_customer_sk AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, filtered_dates AS fd, filtered_customers AS fc WHERE catalog_sales.cs_sold_date_sk = fd.d_date_sk AND catalog_sales.cs_bill_customer_sk = fc.c_customer_sk AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, filtered_dates AS fd, filtered_customers AS fc WHERE web_sales.ws_sold_date_sk = fd.d_date_sk AND web_sales.ws_bill_customer_sk = fc.c_customer_sk AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": "Apply after p01: Convert EXISTS subqueries to pre-materialized key joins using WITH"
    },
    {
      "patch_id": "p08",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.55,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11), filtered_customers AS (SELECT c_customer_sk, c_first_name, c_last_name, c_birth_month FROM customer WHERE c_birth_month IN (2, 3, 4, 10)) SELECT COUNT(*) FROM (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN filtered_customers AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 241 AND 300 AND ss.ss_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM catalog_sales AS cs JOIN filtered_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk JOIN filtered_customers AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 241 AND 300 AND cs.cs_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM web_sales AS ws JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN filtered_customers AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 241 AND 300 AND ws.ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": "Materialize sales pattern: WITH sales_pattern AS (SELECT ... FROM filtered_dates JOIN filtered_customers) then derive store/catalog/web from pattern"
    },
    {
      "patch_id": "p06",
      "family": "A",
      "transform": "shared_dimension_multi_channel",
      "relevance_score": 0.6,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11), filtered_customers AS (SELECT c_customer_sk FROM customer WHERE c_birth_month IN (2, 3, 4, 10)) SELECT COUNT(*) FROM (SELECT 'store' AS channel, c_last_name, c_first_name, d_date FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_customers AS fc ON ss.ss_customer_sk = fc.c_customer_sk WHERE ss.ss_list_price BETWEEN 241 AND 300 AND ss.ss_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT 'catalog' AS channel, c_last_name, c_first_name, d_date FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_customers AS fc ON cs.cs_bill_customer_sk = fc.c_customer_sk WHERE cs.cs_list_price BETWEEN 241 AND 300 AND cs.cs_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT 'web' AS channel, c_last_name, c_first_name, d_date FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_customers AS fc ON ws.ws_bill_customer_sk = fc.c_customer_sk WHERE ws.ws_list_price BETWEEN 241 AND 300 AND ws.ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": "Create shared CTEs for filtered_dates/filtered_customers. Reference in all 3 sales channels"
    },
    {
      "patch_id": "p11",
      "family": "A",
      "transform": "sf_sk_pushdown_multi_fact",
      "relevance_score": 0.5,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_store_sales AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), filtered_catalog_sales AS (SELECT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), filtered_web_sales AS (SELECT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": "Add d_date_sk BETWEEN to fact table CTEs: WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM filtered_dates)"
    },
    {
      "patch_id": "p12",
      "family": "D",
      "transform": "multi_intersect_exists_cte",
      "relevance_score": 0.6,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1: COLUMN REF MISMATCH: Original columns missing from rewrite \u2014 ['c_first_name', 'c_last_name']. The rewrite references different table columns.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_customers AS (SELECT DISTINCT ss_customer_sk, d_date FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_month_seq BETWEEN 1207 AND 1207 + 11 AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_customers AS (SELECT DISTINCT cs_bill_customer_sk, d_date FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_month_seq BETWEEN 1207 AND 1207 + 11 AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_customers AS (SELECT DISTINCT ws_bill_customer_sk, d_date FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_month_seq BETWEEN 1207 AND 1207 + 11 AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM customer AS c, date_dim AS d WHERE c.c_birth_month IN (2, 3, 4, 10) AND d.d_month_seq BETWEEN 1207 AND 1207 + 11 AND EXISTS(SELECT 1 FROM store_customers AS sc WHERE sc.ss_customer_sk = c.c_customer_sk AND sc.d_date = d.d_date) AND EXISTS(SELECT 1 FROM catalog_customers AS cc WHERE cc.cs_bill_customer_sk = c.c_customer_sk AND cc.d_date = d.d_date) AND EXISTS(SELECT 1 FROM web_customers AS wc WHERE wc.ws_bill_customer_sk = c.c_customer_sk AND wc.d_date = d.d_date) LIMIT 100;",
      "has_explain": false,
      "description": "Hybrid approach: WITH store AS (SELECT DISTINCT c_customer_sk, d_date FROM ...), catalog AS (...), web AS (...) SELECT ... FROM customer JOIN date_dim ON ... WHERE EXISTS (store) AND ..."
    },
    {
      "patch_id": "snipe_p1",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Step s3 failed: replace_from requires from_sql",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": null,
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p2",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1: LITERAL MISMATCH: Original literals missing from rewrite \u2014 numbers: ['11.0']. The rewrite changed filter values instead of preserving them.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store AS (SELECT DISTINCT ss_customer_sk, ss_sold_date_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk WHERE d_month_seq BETWEEN 1207 AND 1218 AND c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog AS (SELECT DISTINCT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk WHERE d_month_seq BETWEEN 1207 AND 1218 AND c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web AS (SELECT DISTINCT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk WHERE d_month_seq BETWEEN 1207 AND 1218 AND c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96), common AS (SELECT s.ss_customer_sk AS cust_sk, s.ss_sold_date_sk AS date_sk FROM store AS s JOIN catalog AS c ON s.ss_customer_sk = c.cs_bill_customer_sk AND s.ss_sold_date_sk = c.cs_sold_date_sk JOIN web AS w ON s.ss_customer_sk = w.ws_bill_customer_sk AND s.ss_sold_date_sk = w.ws_sold_date_sk) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM common JOIN customer ON cust_sk = c_customer_sk JOIN date_dim ON date_sk = d_date_sk) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p1",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11), filtered_customers AS (SELECT c_customer_sk, c_first_name, c_last_name FROM customer WHERE c_birth_month IN (2, 3, 4, 10)), store_sales_f AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_sales_f AS (SELECT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_sales_f AS (SELECT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM ((SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales_f AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN filtered_customers AS c ON ss.ss_customer_sk = c.c_customer_sk) INTERSECT (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM catalog_sales_f AS cs JOIN filtered_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk JOIN filtered_customers AS c ON cs.cs_bill_customer_sk = c.c_customer_sk) INTERSECT (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM web_sales_f AS ws JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN filtered_customers AS c ON ws.ws_bill_customer_sk = c.c_customer_sk)) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p2",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11), filtered_customers AS (SELECT c_customer_sk, c_first_name, c_last_name FROM customer WHERE c_birth_month IN (2, 3, 4, 10)), store_sales_f AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_sales_f AS (SELECT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_sales_f AS (SELECT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM filtered_customers AS c JOIN filtered_dates AS d ON 1 = 1 WHERE EXISTS(SELECT 1 FROM store_sales_f AS ss WHERE ss.ss_customer_sk = c.c_customer_sk AND ss.ss_sold_date_sk = d.d_date_sk) AND EXISTS(SELECT 1 FROM catalog_sales_f AS cs WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND cs.cs_sold_date_sk = d.d_date_sk) AND EXISTS(SELECT 1 FROM web_sales_f AS ws WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND ws.ws_sold_date_sk = d.d_date_sk)) AS hot_cust LIMIT 100;",
      "has_explain": false,
      "description": null
    }
  ],
  "explains": {}
}