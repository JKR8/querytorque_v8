Worker Role: W1
Family: D+A
Transform: intersect_to_exists+predicate_push_into_cte
Status: OK

--- OUTPUT SQL ---
WITH store_sales_pre AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 168 AND 197 AND ss_wholesale_cost BETWEEN 76 AND 86), catalog_sales_pre AS (SELECT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 168 AND 197 AND cs_wholesale_cost BETWEEN 76 AND 86), web_sales_pre AS (SELECT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_list_price BETWEEN 168 AND 197 AND ws_wholesale_cost BETWEEN 76 AND 86) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales_pre AS ss INNER JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1213 AND 1224 AND c.c_birth_year BETWEEN 1968 AND 1974) AS br WHERE NOT EXISTS(SELECT 1 FROM catalog_sales_pre AS cs INNER JOIN date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1213 AND 1224 AND c.c_birth_year BETWEEN 1968 AND 1974 AND br.c_last_name = c.c_last_name AND br.c_first_name = c.c_first_name AND br.d_date = d.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales_pre AS ws INNER JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1213 AND 1224 AND c.c_birth_year BETWEEN 1968 AND 1974 AND br.c_last_name = c.c_last_name AND br.c_first_name = c.c_first_name AND br.d_date = d.d_date);