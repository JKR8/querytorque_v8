{
  "probe_id": "p01",
  "transform_id": "or_to_union",
  "family": "D",
  "dialect": "postgres",
  "hypothesis": "Splitting the OR condition on item attributes into UNION ALL branches may enable index scans on each branch instead of a seq scan caused by cross-column OR.",
  "reasoning_trace": [
    "OR condition spans i_manufact_id and i_category, blocking efficient index usage",
    "Bitmap OR scan may still underperform vs separate index scans per focused branch",
    "UNION ALL preserves aggregation semantics while enabling per-branch optimization"
  ],
  "target_ir": "Two UNION ALL branches: one filtering i_manufact_id, one filtering i_category; shared joins preserved",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_body",
      "target": {"by_node_id": "S0"},
      "payload": {
        "sql_fragment": "(SELECT sum(ws_ext_discount_amt) as \"Excess Discount Amount\" FROM web_sales, item, date_dim WHERE i_manufact_id BETWEEN 566 and 765 AND i_item_sk = ws_item_sk AND d_date between '2002-03-06' and cast('2002-03-06' as date) + interval '90 day' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_ext_discount_amt > (SELECT 1.3 * avg(ws_ext_discount_amt) FROM web_sales, date_dim WHERE ws_item_sk = i_item_sk AND d_date between '2002-03-06' and cast('2002-03-06' as date) + interval '90 day' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01)) UNION ALL (SELECT sum(ws_ext_discount_amt) as \"Excess Discount Amount\" FROM web_sales, item, date_dim WHERE i_category IN ('Children', 'Jewelry', 'Men') AND i_item_sk = ws_item_sk AND d_date between '2002-03-06' and cast('2002-03-06' as date) + interval '90 day' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_ext_discount_amt > (SELECT 1.3 * avg(ws_ext_discount_amt) FROM web_sales, date_dim WHERE ws_item_sk = i_item_sk AND d_date between '2002-03-06' and cast('2002-03-06' as date) + interval '90 day' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01))"
      }
    }
  ]
}