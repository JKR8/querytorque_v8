{
  "iteration": 0,
  "n_api_calls": 19,
  "beam_cost_usd": 0.08808424,
  "beam_cost_priced_calls": 19,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 86138,
    "completion_tokens": 32093,
    "total_tokens": 118231,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 37440
  },
  "best_speedup": 0.0,
  "best_patch_id": null,
  "best_sql": null,
  "patches": [
    {
      "patch_id": "p05",
      "family": "A",
      "transform": "date_cte_isolate",
      "relevance_score": 0.7,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY') SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales JOIN filtered_dates AS fd ON fd.d_date_sk = ws_sold_date_sk, item WHERE (i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')) AND i_item_sk = ws_item_sk AND d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM web_sales, date_dim WHERE ws_item_sk = i_item_sk AND d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01) ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": "Materialize filtered date_dim range into CTE before joining with web_sales."
    },
    {
      "patch_id": "p08",
      "family": "E",
      "transform": "materialize_cte",
      "relevance_score": 0.75,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH ws_base_cte AS (SELECT ws_item_sk, ws_sold_date_sk, ws_ext_discount_amt FROM web_sales, date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM ws_base_cte AS w1, item WHERE (i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')) AND i_item_sk = w1.ws_item_sk AND w1.ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM ws_base_cte AS w2 WHERE w2.ws_item_sk = i_item_sk AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01) ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": "Materialize base web_sales with date/wholesale filters into CTE for reuse in main/subquery."
    },
    {
      "patch_id": "p06",
      "family": "A",
      "transform": "dimension_cte_isolate",
      "relevance_score": 0.65,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH item_cte AS (SELECT i_item_sk FROM item WHERE i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')), date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY') SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales JOIN item_cte ON i_item_sk = ws_item_sk JOIN date_cte ON d_date_sk = ws_sold_date_sk WHERE (i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')) AND i_item_sk = ws_item_sk AND d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM web_sales, date_dim WHERE ws_item_sk = i_item_sk AND d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01) ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": "Create CTEs for both filtered item and date_dim before joining with web_sales."
    },
    {
      "patch_id": "p09",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.68,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_ws_date AS (SELECT ws_item_sk, ws_ext_discount_amt FROM web_sales JOIN date_dim ON d_date_sk = ws_sold_date_sk WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND ws_wholesale_cost BETWEEN 16 AND 36) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM filtered_ws_date AS fw JOIN item ON i_item_sk = fw.ws_item_sk WHERE (i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')) AND fw.ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM filtered_ws_date AS fw2 WHERE fw2.ws_item_sk = fw.ws_item_sk AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01) ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": "Materialize filtered web_sales+date_dim join for threshold calculation reuse."
    },
    {
      "patch_id": "p10",
      "family": "C",
      "transform": "aggregate_pushdown",
      "relevance_score": 0.8,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH ws_agg_cte AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM web_sales, date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY ws_item_sk) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales, item, date_dim, ws_agg_cte WHERE (i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')) AND i_item_sk = ws_item_sk AND d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_ext_discount_amt > ws_agg_cte.threshold ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": "Pre-aggregate web_sales thresholds per item before joining with dimensions."
    },
    {
      "patch_id": "p01",
      "family": "B",
      "transform": "inline_decorrelate_materialized",
      "relevance_score": 0.9,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY'), item_thresholds AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold_value FROM web_sales AS ws JOIN filtered_date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk WHERE ws.ws_wholesale_cost BETWEEN 16 AND 36 AND ws.ws_sales_price / ws.ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY ws_item_sk) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales AS ws JOIN item AS i ON ws.ws_item_sk = i.i_item_sk JOIN filtered_date_dim AS dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN item_thresholds AS it ON ws.ws_item_sk = it.ws_item_sk WHERE (i.i_manufact_id BETWEEN 566 AND 765 OR i.i_category IN ('Children', 'Jewelry', 'Men')) AND ws.ws_wholesale_cost BETWEEN 16 AND 36 AND ws.ws_ext_discount_amt > it.threshold_value ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": "Replace correlated subquery with 3 MATERIALIZED CTEs: (1) filtered date_dim, (2) precomputed item thresholds, (3) main fact data. Join threshold CTE in main WHERE clause."
    },
    {
      "patch_id": "p02",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.85,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY'), web_sales_agg AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM web_sales JOIN filtered_dates AS fd ON fd.d_date_sk = ws_sold_date_sk WHERE ws_wholesale_cost BETWEEN 16 AND 36 AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY ws_item_sk) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales AS ws JOIN filtered_items AS fi ON fi.i_item_sk = ws.ws_item_sk JOIN filtered_dates AS fd ON fd.d_date_sk = ws.ws_sold_date_sk JOIN web_sales_agg AS wsa ON wsa.ws_item_sk = ws.ws_item_sk WHERE ws.ws_wholesale_cost BETWEEN 16 AND 36 AND ws.ws_ext_discount_amt > wsa.threshold ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": "Convert comma-joins to explicit INNER JOINs. Pre-filter item/date_dim into CTEs before joining with web_sales."
    },
    {
      "patch_id": "p03",
      "family": "B",
      "transform": "early_filter_decorrelate",
      "relevance_score": 0.88,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH prefiltered_item_cte AS (SELECT i_item_sk FROM item WHERE i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')), prefiltered_date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY'), item_thresholds AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold_value FROM web_sales JOIN prefiltered_date_cte AS dd ON dd.d_date_sk = ws_sold_date_sk WHERE ws_wholesale_cost BETWEEN 16 AND 36 AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY ws_item_sk) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales AS ws JOIN prefiltered_item_cte AS pi ON pi.i_item_sk = ws.ws_item_sk JOIN prefiltered_date_cte AS pd ON pd.d_date_sk = ws.ws_sold_date_sk JOIN item_thresholds AS it ON it.ws_item_sk = ws.ws_item_sk WHERE ws.ws_wholesale_cost BETWEEN 16 AND 36 AND ws.ws_ext_discount_amt > it.threshold_value ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": "Combine dimension pre-filtering and decorrelation: create CTEs for filtered dimensions + precomputed thresholds before main join."
    },
    {
      "patch_id": "p04",
      "family": "D",
      "transform": "or_to_union",
      "relevance_score": 0.6,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Failed to parse/apply PatchPlan",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": null,
      "has_explain": false,
      "description": "Split item OR condition into UNION ALL: Branch1 (i_manufact_id) and Branch2 (i_category). Preserve original join conditions."
    },
    {
      "patch_id": "p07",
      "family": "B",
      "transform": "sf_shared_scan_decorrelate",
      "relevance_score": 0.55,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH shared_ws_cte AS (SELECT ws_item_sk, ws_ext_discount_amt, ws_wholesale_cost, ws_sales_price, ws_list_price, d_date FROM web_sales JOIN date_dim ON d_date_sk = ws_sold_date_sk WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND ws_wholesale_cost BETWEEN 16 AND 36), item_thresholds AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM shared_ws_cte WHERE ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY ws_item_sk) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM shared_ws_cte AS ws JOIN item AS i ON i.i_item_sk = ws.ws_item_sk JOIN item_thresholds AS it ON ws.ws_item_sk = it.ws_item_sk WHERE (i.i_manufact_id BETWEEN 566 AND 765 OR i.i_category IN ('Children', 'Jewelry', 'Men')) AND ws.ws_ext_discount_amt > it.threshold ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": "Shared web_sales CTE with base filters, compute thresholds from filtered subset. Join back in main query."
    },
    {
      "patch_id": "snipe_p1",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY'), filtered_items AS (SELECT i_item_sk FROM item WHERE (i_manufact_id BETWEEN 566 AND 765) OR (i_category IN ('Children', 'Jewelry', 'Men'))), base_web_sales AS (SELECT ws.ws_item_sk, ws.ws_ext_discount_amt, ws.ws_sales_price, ws.ws_list_price FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk WHERE ws.ws_wholesale_cost BETWEEN 16 AND 36), item_thresholds AS (SELECT bws.ws_item_sk, 1.3 * AVG(bws.ws_ext_discount_amt) AS threshold FROM base_web_sales AS bws JOIN filtered_items AS fi ON bws.ws_item_sk = fi.i_item_sk WHERE bws.ws_sales_price / bws.ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY bws.ws_item_sk) SELECT SUM(bws.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM base_web_sales AS bws JOIN filtered_items AS fi ON bws.ws_item_sk = fi.i_item_sk JOIN item_thresholds AS it ON bws.ws_item_sk = it.ws_item_sk WHERE bws.ws_ext_discount_amt > it.threshold ORDER BY SUM(bws.ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p2",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_items AS (SELECT i_item_sk FROM item WHERE (i_manufact_id BETWEEN 566 AND 765) OR (i_category IN ('Children', 'Jewelry', 'Men'))), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY'), item_thresholds AS (SELECT ws.ws_item_sk, 1.3 * AVG(ws.ws_ext_discount_amt) AS threshold FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_items AS fi ON ws.ws_item_sk = fi.i_item_sk WHERE ws.ws_wholesale_cost BETWEEN 16 AND 36 AND ws.ws_sales_price / ws.ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY ws.ws_item_sk) SELECT SUM(ws.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales AS ws JOIN filtered_items AS fi ON ws.ws_item_sk = fi.i_item_sk JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN item_thresholds AS it ON ws.ws_item_sk = it.ws_item_sk WHERE ws.ws_wholesale_cost BETWEEN 16 AND 36 AND ws.ws_ext_discount_amt > it.threshold ORDER BY SUM(ws.ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p1",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH item_thresholds AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM web_sales JOIN date_dim ON d_date_sk = ws_sold_date_sk WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY ws_item_sk) SELECT SUM(ws.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales AS ws JOIN item AS i ON i.i_item_sk = ws.ws_item_sk JOIN date_dim AS dd ON dd.d_date_sk = ws.ws_sold_date_sk JOIN item_thresholds AS it ON ws.ws_item_sk = it.ws_item_sk WHERE (i.i_manufact_id BETWEEN 566 AND 765 OR i.i_category IN ('Children', 'Jewelry', 'Men')) AND dd.d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND ws.ws_wholesale_cost BETWEEN 16 AND 36 AND ws.ws_ext_discount_amt > it.threshold ORDER BY SUM(ws.ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p2",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY') SELECT SUM(ws.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales AS ws JOIN filtered_items AS fi ON fi.i_item_sk = ws.ws_item_sk JOIN filtered_dates AS fd ON fd.d_date_sk = ws.ws_sold_date_sk WHERE ws.ws_wholesale_cost BETWEEN 16 AND 36 AND ws.ws_ext_discount_amt > (SELECT 1.3 * AVG(ws2.ws_ext_discount_amt) FROM web_sales AS ws2 JOIN filtered_dates AS fd2 ON fd2.d_date_sk = ws2.ws_sold_date_sk WHERE ws2.ws_item_sk = fi.i_item_sk AND ws2.ws_wholesale_cost BETWEEN 16 AND 36 AND ws2.ws_sales_price / ws2.ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01) ORDER BY SUM(ws.ws_ext_discount_amt) LIMIT 100;",
      "has_explain": false,
      "description": null
    }
  ],
  "explains": {}
}