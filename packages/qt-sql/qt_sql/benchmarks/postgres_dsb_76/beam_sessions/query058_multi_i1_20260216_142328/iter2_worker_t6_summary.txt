Worker Role: W4
Family: E+A
Transform: prefetch_dimensions_and_early_filter
Status: OK

--- OUTPUT SQL ---
WITH ss_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales, item, date_dim, customer WHERE ss_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ss_sold_date_sk = d_date_sk AND ss_list_price BETWEEN 242 AND 271 AND i_manager_id BETWEEN 71 AND 100 AND ss_customer_sk = c_customer_sk AND c_birth_year BETWEEN 1945 AND 1951 GROUP BY i_item_id, c_birth_year), cs_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales, item, date_dim, customer WHERE cs_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND cs_sold_date_sk = d_date_sk AND cs_list_price BETWEEN 242 AND 271 AND i_manager_id BETWEEN 71 AND 100 AND cs_bill_customer_sk = c_customer_sk AND c_birth_year BETWEEN 1945 AND 1951 GROUP BY i_item_id, c_birth_year), ws_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales, item, date_dim, customer WHERE ws_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ws_sold_date_sk = d_date_sk AND ws_list_price BETWEEN 242 AND 271 AND i_manager_id BETWEEN 71 AND 100 AND ws_bill_customer_sk = c_customer_sk AND c_birth_year BETWEEN 1945 AND 1951 GROUP BY i_item_id, c_birth_year), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_manager_id BETWEEN 71 AND 100), filtered_customers AS (SELECT c_customer_sk, c_birth_year FROM customer WHERE c_birth_year BETWEEN 1945 AND 1951), filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales JOIN filtered_items ON ws_item_sk = i_item_sk JOIN filtered_customers ON ws_bill_customer_sk = c_customer_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk WHERE ws_list_price BETWEEN 242 AND 271 GROUP BY i_item_id, c_birth_year;