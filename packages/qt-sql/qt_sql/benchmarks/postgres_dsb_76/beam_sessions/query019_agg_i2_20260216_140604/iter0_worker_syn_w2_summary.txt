Worker Role: W2
Family: B
Transform: decorrelate
Status: OK

--- OUTPUT SQL ---
WITH pre_item AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_category = 'Shoes'), pre_customer AS (SELECT c_customer_sk, c_current_addr_sk, c_birth_month FROM customer WHERE c_birth_month = 2), pre_ca AS (SELECT ca_address_sk, ca_zip, ca_state FROM customer_address WHERE ca_state = 'KS') SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM store_sales INNER JOIN date_dim ON d_date_sk = ss_sold_date_sk INNER JOIN pre_item ON ss_item_sk = i_item_sk INNER JOIN pre_customer ON ss_customer_sk = c_customer_sk INNER JOIN pre_ca ON c_current_addr_sk = ca_address_sk INNER JOIN store ON ss_store_sk = s_store_sk WHERE d_year = 1999 AND d_moy = 2 AND ss_wholesale_cost BETWEEN 76 AND 96 AND SUBSTRING(ca_zip FROM 1 FOR 5) <> SUBSTRING(s_zip FROM 1 FOR 5) GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100;