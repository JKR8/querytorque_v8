[
  {
    "target_id": "t1",
    "family": "C+A",
    "transform": "aggregate_before_join_with_dimension_keys",
    "relevance_score": 0.93,
    "hypothesis": "Pre-aggregate store_sales/web_sales by join keys (ss_item_sk, ss_addr_sk, ss_sold_date_sk) before joining dimensions. This reduces input to the expensive Aggregate operator from 415k rows to ~4k rows.",
    "target_ir": "CTE_Q_S0_ss (f55d9959a55a5f8c): replace_from",
    "recommended_examples": [
      "pg_materialized_dimension_fact_prefilter",
      "pg_date_cte_explicit_join"
    ]
  },
  {
    "target_id": "t2",
    "family": "E",
    "transform": "reuse_filtered_dimensions",
    "relevance_score": 0.85,
    "hypothesis": "Prefetch filtered dimension tables (item, customer_address) as CTEs and reuse them in both ss and ws CTEs. Avoids redundant Bitmap Heap Scan (39 ms) and Index Scans (0.028 ms/row).",
    "target_ir": "S0: insert_cte",
    "recommended_examples": [
      "multi_dimension_prefetch"
    ]
  },
  {
    "target_id": "t3",
    "family": "F",
    "transform": "explicit_join_order",
    "relevance_score": 0.8,
    "hypothesis": "Restructure CTE joins as explicit INNER JOINs with optimal order: item \u2192 store_sales \u2192 customer_address \u2192 date_dim. Leverages selectivity of item (815 rows) to minimize hash sizes early.",
    "target_ir": "CTE_Q_S0_ss (f55d9959a55a5f8c): replace_from",
    "recommended_examples": [
      "pg_explicit_join_materialized"
    ]
  },
  {
    "target_id": "t4",
    "family": "F",
    "transform": "pivot_quarters_eliminate_self_join",
    "relevance_score": 0.75,
    "hypothesis": "Replace 6-way self-join with pivoted CTE (quarters as columns). Eliminates Nested Loop over CTE scans (4828 ms) by computing ratios via conditional aggregation in one pass.",
    "target_ir": "Q_S0 (e3d013ee216110fe): replace_from + replace_expr_subtree",
    "recommended_examples": [
      "pg_explicit_join_materialized"
    ]
  }
]