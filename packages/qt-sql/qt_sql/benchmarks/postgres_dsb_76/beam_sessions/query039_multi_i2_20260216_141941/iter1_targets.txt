[
  {
    "target_id": "t1",
    "family": "A+F",
    "transform": "early_month_filter_with_window",
    "relevance_score": 0.98,
    "hypothesis": "Pushing d_moy filter into CTE reduces aggregation workload by 10x (est. 12\u21922 months). Replacing self-join with window avoids duplicate CTE scans and sort-merge join.",
    "target_ir": "S0: Replace WHERE [ceb681f4fee117f7] with 'd_moy IN (5,6) AND ...'. Replace Q_S0 FROM with window CTE using LEAD(). S1: Analogous with cov filter.",
    "recommended_examples": [
      "pg_date_cte_explicit_join",
      "pg_explicit_join_materialized"
    ]
  },
  {
    "target_id": "t2",
    "family": "B+E",
    "transform": "decorrelate_month_prefetch",
    "relevance_score": 0.9,
    "hypothesis": "Prefiltering months 5-6 in CTE enables single-pass computation. Materialized CTE prevents re-execution for inv1/inv2.",
    "target_ir": "S0/S1: Insert CTE_Q_S0_inv WHERE [ceb681f4fee117f7] with 'd_moy IN (5,6) AND ...'. Add MATERIALIZED hint to CTE.",
    "recommended_examples": [
      "pg_shared_scan_decorrelate",
      "multi_dimension_prefetch"
    ]
  },
  {
    "target_id": "t3",
    "family": "C",
    "transform": "aggregate_before_joins",
    "relevance_score": 0.8,
    "hypothesis": "Aggregating inventory before dimension joins reduces input rows to fact-dimension joins.",
    "target_ir": "S0/S1: Replace CTE_Q_S0_inv FROM with: (AGG(inventory) \u2192 JOIN item/warehouse/date_dim)",
    "recommended_examples": [
      "pg_materialized_dimension_fact_prefilter"
    ]
  }
]