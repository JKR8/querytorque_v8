[
  {
    "target_id": "t1_refined",
    "family": "A+F",
    "transform": "early_month_filter_with_window_refined",
    "relevance_score": 0.98,
    "hypothesis": "Original CTE processes 12 months when only months 5-6 are needed. Push d_moy filter into CTE to reduce aggregation rows by 6x. Replace self-join with window function to avoid duplicate CTE scans.",
    "target_ir": "S0: Replace CTE_Q_S0_inv WHERE clause with d_moy IN (5,6). Replace Q_S0 FROM with windowed LEAD().",
    "recommended_examples": [
      "pg_explicit_join_materialized",
      "pg_date_cte_explicit_join"
    ]
  },
  {
    "target_id": "t2_refined",
    "family": "A+E",
    "transform": "prefilter_aggregate_materialize",
    "relevance_score": 0.92,
    "hypothesis": "Prefilter inventory to months 5-6 before aggregation and joins. Materialize reduced dataset to avoid repeated dimension table scans.",
    "target_ir": "S0: Insert new CTE before CTE_Q_S0_inv filtering d_moy IN (5,6). Modify CTE_Q_S0_inv to use prefiltered data.",
    "recommended_examples": [
      "multi_dimension_prefetch",
      "pg_materialized_dimension_fact_prefilter"
    ]
  }
]