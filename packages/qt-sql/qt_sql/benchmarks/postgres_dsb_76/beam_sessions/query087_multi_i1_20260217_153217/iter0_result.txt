{
  "iteration": 0,
  "n_api_calls": 22,
  "beam_cost_usd": 0.09214819,
  "beam_cost_priced_calls": 22,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 110211,
    "completion_tokens": 31860,
    "total_tokens": 142071,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 48256
  },
  "best_speedup": 0.0,
  "best_patch_id": null,
  "best_sql": null,
  "patches": [
    {
      "patch_id": "p01",
      "family": "A",
      "transform": "shared_dimension_multi_channel",
      "relevance_score": 0.75,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH date_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1225) SELECT COUNT(*) FROM ((SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ss_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ss_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND cs_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND cs_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ws_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ws_wholesale_cost BETWEEN 35 AND 45)) AS cool_cust;",
      "has_explain": false,
      "description": "Create CTE for filtered date_dim: WITH date_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1225). Replace all date_dim references in subqueries with date_cte."
    },
    {
      "patch_id": "p02",
      "family": "A",
      "transform": "shared_dimension_multi_channel",
      "relevance_score": 0.8,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH cust_cte AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961) SELECT COUNT(*) FROM ((SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ss_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ss_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND cs_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND cs_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ws_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ws_wholesale_cost BETWEEN 35 AND 45)) AS cool_cust;",
      "has_explain": false,
      "description": "Create CTE for filtered customer: WITH cust_cte AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961). Replace all customer references with cust_cte."
    },
    {
      "patch_id": "p08",
      "family": "E",
      "transform": "materialize_cte",
      "relevance_score": 0.85,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11) SELECT COUNT(*) FROM ((SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ss_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ss_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND cs_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND cs_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ws_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ws_wholesale_cost BETWEEN 35 AND 45)) AS cool_cust;",
      "has_explain": false,
      "description": "Materialize only date_dim filter: WITH d AS (SELECT ... FROM date_dim WHERE d_month_seq BETWEEN...)"
    },
    {
      "patch_id": "p11",
      "family": "A",
      "transform": "early_filter",
      "relevance_score": 0.8,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1: COLUMN REF MISMATCH: Original columns missing from rewrite \u2014 ['c_first_name', 'c_last_name', 'cs_bill_customer_sk', 'cs_list_price', 'cs_sold_date_sk']. The rewrite references different table columns.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_store_sales AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 242 AND 271 AND ss_wholesale_cost BETWEEN 35 AND 45) SELECT COUNT(*) FROM filtered_store_sales AS ss, date_dim, customer WHERE ss.ss_sold_date_sk = date_dim.d_date_sk AND ss.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND c_birth_year BETWEEN 1955 AND 1961;",
      "has_explain": false,
      "description": "Push fact filters earlier: Move ss_list_price/ss_wholesale_cost filters before joins in store_sales subquery."
    },
    {
      "patch_id": "p06",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.8,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_store_data AS (SELECT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1214 AND 1214 + 11 AND ss.ss_list_price BETWEEN 242 AND 271 AND c.c_birth_year BETWEEN 1955 AND 1961 AND ss.ss_wholesale_cost BETWEEN 35 AND 45) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM filtered_store_data EXCEPT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND cs_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND cs_wholesale_cost BETWEEN 35 AND 45 EXCEPT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ws_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ws_wholesale_cost BETWEEN 35 AND 45) AS cool_cust;",
      "has_explain": false,
      "description": "Materialize entire store_sales path: WITH store AS (SELECT ... FROM store_sales+date_dim+customer). Reuse in main query."
    },
    {
      "patch_id": "p09",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.9,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1: LITERAL MISMATCH: Original literals missing from rewrite \u2014 numbers: ['11.0', '1955.0', '1961.0', '242.0', '271.0']. The rewrite changed filter values instead of preserving them.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_date_dim AS (SELECT * FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1225) SELECT COUNT(*);",
      "has_explain": false,
      "description": "Materialize date_dim scan only: WITH d AS (SELECT * FROM date_dim WHERE ...)"
    },
    {
      "patch_id": "p03",
      "family": "F",
      "transform": "date_cte_explicit_join",
      "relevance_score": 0.9,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH date_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11) SELECT COUNT(*) FROM ((SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ss_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ss_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND cs_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND cs_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ws_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ws_wholesale_cost BETWEEN 35 AND 45)) AS cool_cust;",
      "has_explain": false,
      "description": "Convert comma joins to explicit INNER JOINs in all subqueries. Example: FROM store_sales INNER JOIN date_cte ON ss_sold_date_sk = d_date_sk INNER JOIN cust_cte ON ss_customer_sk = c_customer_sk"
    },
    {
      "patch_id": "p04",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.85,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1: LITERAL MISMATCH: Original literals missing from rewrite \u2014 numbers: ['242.0', '271.0', '35.0', '45.0']. The rewrite changed filter values instead of preserving them.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11), cust_cte AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961) SELECT COUNT(*);",
      "has_explain": false,
      "description": "Combine p01-p03: WITH date_cte(...), cust_cte(...). Rewrite all subqueries with explicit JOINs on CTEs."
    },
    {
      "patch_id": "p05",
      "family": "D",
      "transform": "except_to_not_exists",
      "relevance_score": 0.7,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 AND ss_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ss_wholesale_cost BETWEEN 35 AND 45) SELECT COUNT(*) FROM store_customers AS sc WHERE NOT EXISTS(SELECT 1 FROM catalog_sales AS cs, date_dim AS dd, customer AS cc WHERE cs.cs_sold_date_sk = dd.d_date_sk AND cs.cs_bill_customer_sk = cc.c_customer_sk AND dd.d_month_seq BETWEEN 1214 AND 1214 + 11 AND cs_list_price BETWEEN 242 AND 271 AND cc.c_birth_year BETWEEN 1955 AND 1961 AND cs.cs_wholesale_cost BETWEEN 35 AND 45 AND cc.c_last_name = sc.c_last_name AND cc.c_first_name = sc.c_first_name AND dd.d_date = sc.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales AS ws, date_dim AS ddd, customer AS ccc WHERE ws.ws_sold_date_sk = ddd.d_date_sk AND ws.ws_bill_customer_sk = ccc.c_customer_sk AND ddd.d_month_seq BETWEEN 1214 AND 1214 + 11 AND ws_list_price BETWEEN 242 AND 271 AND ccc.c_birth_year BETWEEN 1955 AND 1961 AND ws.ws_wholesale_cost BETWEEN 35 AND 45 AND ccc.c_last_name = sc.c_last_name AND ccc.c_first_name = sc.c_first_name AND ddd.d_date = sc.d_date);",
      "has_explain": false,
      "description": "Rewrite EXCEPT as NOT EXISTS: Store results in CTE, then filter via WHERE NOT EXISTS (catalog) AND NOT EXISTS (web). Preserve (c_customer_sk, d_date) as correlation key."
    },
    {
      "patch_id": "p10",
      "family": "A",
      "transform": "dimension_cte_isolate",
      "relevance_score": 0.7,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1: LITERAL MISMATCH: Original literals missing from rewrite \u2014 numbers: ['11.0', '1955.0', '1961.0', '242.0', '271.0']. The rewrite changed filter values instead of preserving them.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1225) SELECT COUNT(*);",
      "has_explain": false,
      "description": "Pre-join dimensions: WITH dims AS (SELECT d_date_sk, c_customer_sk FROM date_dim, customer WHERE ...)"
    },
    {
      "patch_id": "p12",
      "family": "B",
      "transform": "decorrelate",
      "relevance_score": 0.6,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "SELECT COUNT(*) FROM (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1214 AND 1214 + 11 AND ss.ss_list_price BETWEEN 242 AND 271 AND c.c_birth_year BETWEEN 1955 AND 1961 AND ss.ss_wholesale_cost BETWEEN 35 AND 45) AS store_customers WHERE NOT EXISTS(SELECT 1 FROM catalog_sales AS cs JOIN date_dim AS d2 ON cs.cs_sold_date_sk = d2.d_date_sk JOIN customer AS c2 ON cs.cs_bill_customer_sk = c2.c_customer_sk WHERE d2.d_month_seq BETWEEN 1214 AND 1214 + 11 AND cs.cs_list_price BETWEEN 242 AND 271 AND c2.c_birth_year BETWEEN 1955 AND 1961 AND cs.cs_wholesale_cost BETWEEN 35 AND 45 AND c2.c_last_name = store_customers.c_last_name AND c2.c_first_name = store_customers.c_first_name AND d2.d_date = store_customers.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales AS ws JOIN date_dim AS d3 ON ws.ws_sold_date_sk = d3.d_date_sk JOIN customer AS c3 ON ws.ws_bill_customer_sk = c3.c_customer_sk WHERE d3.d_month_seq BETWEEN 1214 AND 1214 + 11 AND ws.ws_list_price BETWEEN 242 AND 271 AND c3.c_birth_year BETWEEN 1955 AND 1961 AND ws.ws_wholesale_cost BETWEEN 35 AND 45 AND c3.c_last_name = store_customers.c_last_name AND c3.c_first_name = store_customers.c_first_name AND d3.d_date = store_customers.d_date);",
      "has_explain": false,
      "description": "Convert EXCEPT to NOT EXISTS via keys: WHERE NOT EXISTS (SELECT 1 FROM catalog_sales WHERE cs_bill_customer_sk = c_customer_sk AND ...)"
    },
    {
      "patch_id": "p07",
      "family": "A",
      "transform": "multi_dimension_prefetch",
      "relevance_score": 0.65,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1: LITERAL MISMATCH: Original literals missing from rewrite \u2014 numbers: ['242.0', '271.0', '35.0', '45.0']. The rewrite changed filter values instead of preserving them.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_date AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11), filtered_customer AS (SELECT c_customer_sk, c_first_name, c_last_name, c_birth_year FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961) SELECT COUNT(*);",
      "has_explain": false,
      "description": "Pre-filter all dimensions per channel: WITH store_path AS (SELECT ... FROM store_sales JOIN filtered_date JOIN filtered_customer)"
    },
    {
      "patch_id": "snipe_p1",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH date_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11), cust_cte AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961) SELECT COUNT(*) FROM ((SELECT DISTINCT cust_cte.c_last_name, cust_cte.c_first_name, date_cte.d_date FROM store_sales INNER JOIN date_cte ON store_sales.ss_sold_date_sk = date_cte.d_date_sk INNER JOIN cust_cte ON store_sales.ss_customer_sk = cust_cte.c_customer_sk WHERE store_sales.ss_list_price BETWEEN 242 AND 271 AND store_sales.ss_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT cust_cte.c_last_name, cust_cte.c_first_name, date_cte.d_date FROM catalog_sales INNER JOIN date_cte ON catalog_sales.cs_sold_date_sk = date_cte.d_date_sk INNER JOIN cust_cte ON catalog_sales.cs_bill_customer_sk = cust_cte.c_customer_sk WHERE catalog_sales.cs_list_price BETWEEN 242 AND 271 AND catalog_sales.cs_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT cust_cte.c_last_name, cust_cte.c_first_name, date_cte.d_date FROM web_sales INNER JOIN date_cte ON web_sales.ws_sold_date_sk = date_cte.d_date_sk INNER JOIN cust_cte ON web_sales.ws_bill_customer_sk = cust_cte.c_customer_sk WHERE web_sales.ws_list_price BETWEEN 242 AND 271 AND web_sales.ws_wholesale_cost BETWEEN 35 AND 45)) AS cool_cust;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p2",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales INNER JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk INNER JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk WHERE date_dim.d_month_seq BETWEEN 1214 AND 1214 + 11 AND store_sales.ss_list_price BETWEEN 242 AND 271 AND customer.c_birth_year BETWEEN 1955 AND 1961 AND store_sales.ss_wholesale_cost BETWEEN 35 AND 45) SELECT COUNT(*) FROM store_customers AS sc WHERE NOT EXISTS(SELECT 1 FROM catalog_sales INNER JOIN date_dim AS d2 ON catalog_sales.cs_sold_date_sk = d2.d_date_sk INNER JOIN customer AS c2 ON catalog_sales.cs_bill_customer_sk = c2.c_customer_sk WHERE d2.d_month_seq BETWEEN 1214 AND 1214 + 11 AND catalog_sales.cs_list_price BETWEEN 242 AND 271 AND c2.c_birth_year BETWEEN 1955 AND 1961 AND catalog_sales.cs_wholesale_cost BETWEEN 35 AND 45 AND c2.c_last_name = sc.c_last_name AND c2.c_first_name = sc.c_first_name AND d2.d_date = sc.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales INNER JOIN date_dim AS d3 ON web_sales.ws_sold_date_sk = d3.d_date_sk INNER JOIN customer AS c3 ON web_sales.ws_bill_customer_sk = c3.c_customer_sk WHERE d3.d_month_seq BETWEEN 1214 AND 1214 + 11 AND web_sales.ws_list_price BETWEEN 242 AND 271 AND c3.c_birth_year BETWEEN 1955 AND 1961 AND web_sales.ws_wholesale_cost BETWEEN 35 AND 45 AND c3.c_last_name = sc.c_last_name AND c3.c_first_name = sc.c_first_name AND d3.d_date = sc.d_date);",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p1",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_date AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11), filtered_customer AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961) SELECT COUNT(*) FROM ((SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales INNER JOIN filtered_date ON store_sales.ss_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_customer ON store_sales.ss_customer_sk = filtered_customer.c_customer_sk WHERE ss_list_price BETWEEN 242 AND 271 AND ss_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales INNER JOIN filtered_date ON catalog_sales.cs_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_customer ON catalog_sales.cs_bill_customer_sk = filtered_customer.c_customer_sk WHERE cs_list_price BETWEEN 242 AND 271 AND cs_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales INNER JOIN filtered_date ON web_sales.ws_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_customer ON web_sales.ws_bill_customer_sk = filtered_customer.c_customer_sk WHERE ws_list_price BETWEEN 242 AND 271 AND ws_wholesale_cost BETWEEN 35 AND 45)) AS cool_cust;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "snipe_p2",
      "family": "?",
      "transform": "unknown",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Synthetic semantic check failed: SyntheticDataGenerator._generate_value() got an unexpected keyword argument 'row_context'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales INNER JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk INNER JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk WHERE d_month_seq BETWEEN 1214 AND 1214 + 11 AND ss_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ss_wholesale_cost BETWEEN 35 AND 45) SELECT COUNT(*) FROM store_customers AS sc WHERE NOT EXISTS(SELECT 1 FROM catalog_sales INNER JOIN date_dim ON catalog_sales.cs_sold_date_sk = date_dim.d_date_sk INNER JOIN customer ON catalog_sales.cs_bill_customer_sk = customer.c_customer_sk WHERE d_month_seq BETWEEN 1214 AND 1214 + 11 AND cs_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND cs_wholesale_cost BETWEEN 35 AND 45 AND customer.c_last_name = sc.c_last_name AND customer.c_first_name = sc.c_first_name AND date_dim.d_date = sc.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales INNER JOIN date_dim ON web_sales.ws_sold_date_sk = date_dim.d_date_sk INNER JOIN customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk WHERE d_month_seq BETWEEN 1214 AND 1214 + 11 AND ws_list_price BETWEEN 242 AND 271 AND c_birth_year BETWEEN 1955 AND 1961 AND ws_wholesale_cost BETWEEN 35 AND 45 AND customer.c_last_name = sc.c_last_name AND customer.c_first_name = sc.c_first_name AND date_dim.d_date = sc.d_date);",
      "has_explain": false,
      "description": null
    }
  ],
  "explains": {}
}