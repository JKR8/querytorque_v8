{
  "query_id": "query069_multi_i1",
  "session_dir": "packages/qt-sql/qt_sql/benchmarks/postgres_dsb_76/beam_sessions/query069_multi_i1_20260217_122757",
  "ran_at": "2026-02-17T14:02:49.004539",
  "db_path": "postgres://jakc9:jakc9@127.0.0.1:5433/dsb_sf10",
  "n_workers": 14,
  "parseable": 14,
  "baseline": {
    "original_ms": 62025.302599000046,
    "original_rows": 80,
    "original_checksum": "0d19ebc5644296b3e6d05f5c53080f51",
    "times_ms": [
      67307.52644999984,
      56743.07874800025
    ]
  },
  "elapsed_seconds": 1560.8339989185333,
  "results": [
    {
      "patch_id": "p01",
      "family": "B",
      "transform": "early_filter_decorrelate",
      "relevance_score": 0.0,
      "source": "iter0_worker_p01_retry_response.txt",
      "output_sql": "WITH ss_customers AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk JOIN ss_customers AS sc ON c.c_customer_sk = sc.ss_customer_sk WHERE ca_state IN ('CO', 'NC', 'TX') AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "FAIL",
      "semantic_passed": false,
      "speedup": null,
      "original_ms": 62025.302599000046,
      "patch_ms": 3068.2513819999713,
      "error": "Checksum mismatch: original=0d19ebc5644296b3e6d05f5c53080f51, patch=a04b09dec385e772c13595d6eb949397"
    },
    {
      "patch_id": "p02",
      "family": "B",
      "transform": "early_filter_decorrelate",
      "relevance_score": 0.0,
      "source": "iter0_worker_p02_retry_response.txt",
      "output_sql": "WITH ws_customers AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND (NOT EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "FAIL",
      "semantic_passed": false,
      "speedup": null,
      "original_ms": 62025.302599000046,
      "patch_ms": 60007.74769600002,
      "error": "Checksum mismatch: original=0d19ebc5644296b3e6d05f5c53080f51, patch=2b209395183d06ed9253cd32ca4ed7e4"
    },
    {
      "patch_id": "p03",
      "family": "B",
      "transform": "early_filter_decorrelate",
      "relevance_score": 0.0,
      "source": "iter0_worker_p03_retry_response.txt",
      "output_sql": "WITH cs_customers AS (SELECT DISTINCT cs_ship_customer_sk AS customer_sk FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT 1 FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT 1 FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "FAIL",
      "semantic_passed": false,
      "speedup": null,
      "original_ms": 62025.302599000046,
      "patch_ms": 4798.324151000088,
      "error": "Checksum mismatch: original=0d19ebc5644296b3e6d05f5c53080f51, patch=202d370f4c8bc38d5d6a03a675bcd6d5"
    },
    {
      "patch_id": "p04",
      "family": "A",
      "transform": "dimension_cte_isolate",
      "relevance_score": 0.0,
      "source": "iter0_worker_p04_retry_response.txt",
      "output_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk JOIN filtered_date AS fd ON TRUE WHERE ca_state IN ('CO', 'NC', 'TX') AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT 1 FROM store_sales WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = fd.d_date_sk AND ss_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT 1 FROM web_sales WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = fd.d_date_sk AND ws_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT 1 FROM catalog_sales WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = fd.d_date_sk AND cs_list_price BETWEEN 80 AND 169) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "FAIL",
      "semantic_passed": false,
      "speedup": null,
      "original_ms": 62025.302599000046,
      "patch_ms": 16539.784246500174,
      "error": "Checksum mismatch: original=0d19ebc5644296b3e6d05f5c53080f51, patch=c0ead49e58f83e4eb954f2573c3edd03"
    },
    {
      "patch_id": "p05",
      "family": "A",
      "transform": "dimension_cte_isolate",
      "relevance_score": 0.0,
      "source": "iter0_worker_p05_response.txt",
      "output_sql": "WITH ca_filtered AS (SELECT ca_address_sk FROM customer_address WHERE ca_state IN ('CO', 'NC', 'TX')) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, ca_filtered AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND (NOT EXISTS(SELECT * FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "ERROR",
      "semantic_passed": false,
      "speedup": null,
      "original_ms": null,
      "patch_ms": null,
      "error": "column \"ca_state\" does not exist\nLINE 1: ... WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state I...\n                                                             ^\n"
    },
    {
      "patch_id": "p06",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.0,
      "source": "iter0_worker_p06_response.txt",
      "output_sql": "SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND (NOT EXISTS(SELECT * FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "WIN",
      "semantic_passed": true,
      "speedup": 1.1266986826304346,
      "original_ms": 62025.302599000046,
      "patch_ms": 55050.47938300004,
      "error": null,
      "times": [
        54441.85938100009,
        55659.099384999994
      ]
    },
    {
      "patch_id": "p07",
      "family": "E",
      "transform": "materialize_cte",
      "relevance_score": 0.0,
      "source": "iter0_worker_p07_response.txt",
      "output_sql": "WITH ss_filtered AS (SELECT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND ss_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND (NOT EXISTS(SELECT * FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "WIN",
      "semantic_passed": true,
      "speedup": 1.1339599286396433,
      "original_ms": 62025.302599000046,
      "patch_ms": 54697.96686149994,
      "error": null,
      "times": [
        54594.616807999955,
        54801.316914999916
      ]
    },
    {
      "patch_id": "p08",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.0,
      "source": "iter0_worker_p08_retry_response.txt",
      "output_sql": "WITH sales_customers AS (SELECT DISTINCT ss_customer_sk AS customer_sk, 'store' AS channel FROM store_sales AS ss JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2002 AND d.d_moy BETWEEN 10 AND 10 + 2 AND ss.ss_list_price BETWEEN 80 AND 169 UNION ALL SELECT DISTINCT ws_bill_customer_sk AS customer_sk, 'web' AS channel FROM web_sales AS ws JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_year = 2002 AND d.d_moy BETWEEN 10 AND 10 + 2 AND ws.ws_list_price BETWEEN 80 AND 169 UNION ALL SELECT DISTINCT cs_ship_customer_sk AS customer_sk, 'catalog' AS channel FROM catalog_sales AS cs JOIN date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_year = 2002 AND d.d_moy BETWEEN 10 AND 10 + 2 AND cs.cs_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT 1 FROM sales_customers AS sc WHERE sc.customer_sk = c.c_customer_sk AND sc.channel = 'store') AND NOT EXISTS(SELECT 1 FROM sales_customers AS sc WHERE sc.customer_sk = c.c_customer_sk AND sc.channel = 'web') AND NOT EXISTS(SELECT 1 FROM sales_customers AS sc WHERE sc.customer_sk = c.c_customer_sk AND sc.channel = 'catalog') GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "REGRESSION",
      "semantic_passed": true,
      "speedup": 0.6562648487551377,
      "original_ms": 62025.302599000046,
      "patch_ms": 94512.60831149989,
      "error": null,
      "times": [
        95109.60513800001,
        93915.61148499977
      ]
    },
    {
      "patch_id": "p09",
      "family": "A",
      "transform": "shared_dimension_multi_channel",
      "relevance_score": 0.0,
      "source": "iter0_worker_p09_retry_response.txt",
      "output_sql": "WITH shared_filters AS (SELECT c.c_customer_sk FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE ca_state IN ('CO', 'NC', 'TX')) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_customer_sk IN (SELECT c_customer_sk FROM shared_filters) AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND (NOT EXISTS(SELECT * FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "ERROR",
      "semantic_passed": false,
      "speedup": null,
      "original_ms": null,
      "patch_ms": null,
      "error": "canceling statement due to statement timeout\n"
    },
    {
      "patch_id": "p10",
      "family": "B",
      "transform": "decorrelate",
      "relevance_score": 0.0,
      "source": "iter0_worker_p10_retry_response.txt",
      "output_sql": "WITH ws_filtered AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales, date_dim WHERE ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169), cs_filtered AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND NOT c.c_customer_sk IN (SELECT ws_bill_customer_sk FROM ws_filtered) AND NOT c.c_customer_sk IN (SELECT cs_ship_customer_sk FROM cs_filtered) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "FAIL",
      "semantic_passed": false,
      "speedup": null,
      "original_ms": 62025.302599000046,
      "patch_ms": 2500.506134499801,
      "error": "Row count mismatch: original=80, patch=0"
    },
    {
      "patch_id": "p11",
      "family": "F",
      "transform": "date_cte_explicit_join",
      "relevance_score": 0.0,
      "source": "iter0_worker_p11_response.txt",
      "output_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND (NOT EXISTS(SELECT * FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "WIN",
      "semantic_passed": true,
      "speedup": 1.1231351977446111,
      "original_ms": 62025.302599000046,
      "patch_ms": 55225.14361899994,
      "error": null,
      "times": [
        53872.347729000016,
        56577.93950899986
      ]
    },
    {
      "patch_id": "p12",
      "family": "F",
      "transform": "materialized_dimension_fact_prefilter",
      "relevance_score": 0.0,
      "source": "iter0_worker_p12_retry_response.txt",
      "output_sql": "WITH stage1 AS (SELECT c.c_customer_sk, c.c_current_cdemo_sk FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE ca_state IN ('CO', 'NC', 'TX')), stage2 AS (SELECT s1.c_customer_sk FROM stage1 AS s1 JOIN customer_demographics AS cd ON s1.c_current_cdemo_sk = cd.cd_demo_sk WHERE cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College')), store_sales_filtered AS (SELECT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM stage2 AS s2 JOIN store_sales_filtered AS ssf ON s2.c_customer_sk = ssf.ss_customer_sk GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "ERROR",
      "semantic_passed": false,
      "speedup": null,
      "original_ms": null,
      "patch_ms": null,
      "error": "column \"cd_gender\" does not exist\nLINE 1: ... + 2 AND ss_list_price BETWEEN 80 AND 169) SELECT cd_gender,...\n                                                             ^\n"
    },
    {
      "patch_id": "p13",
      "family": "B",
      "transform": "inline_decorrelate_materialized",
      "relevance_score": 0.0,
      "source": "iter0_worker_p13_retry_response.txt",
      "output_sql": "WITH filtered_store_sales AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169), filtered_web_sales AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169), filtered_catalog_sales AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk JOIN filtered_store_sales AS fss ON c.c_customer_sk = fss.ss_customer_sk LEFT JOIN filtered_web_sales AS fws ON c.c_customer_sk = fws.ws_bill_customer_sk LEFT JOIN filtered_catalog_sales AS fcs ON c.c_customer_sk = fcs.cs_ship_customer_sk WHERE ca_state IN ('CO', 'NC', 'TX') AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND fws.ws_bill_customer_sk IS NULL AND fcs.cs_ship_customer_sk IS NULL GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "WIN",
      "semantic_passed": true,
      "speedup": 12.106507794267335,
      "original_ms": 62025.302599000046,
      "patch_ms": 5123.302578499988,
      "error": null,
      "times": [
        5219.37305099982,
        5027.232106000156
      ]
    },
    {
      "patch_id": "p14",
      "family": "A",
      "transform": "sf_sk_pushdown_multi_fact",
      "relevance_score": 0.0,
      "source": "iter0_worker_p14_retry_response.txt",
      "output_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "FAIL",
      "semantic_passed": false,
      "speedup": null,
      "original_ms": 62025.302599000046,
      "patch_ms": 1834.4716889998836,
      "error": "Checksum mismatch: original=0d19ebc5644296b3e6d05f5c53080f51, patch=4246ad83739e1d566f787fee409b9879"
    }
  ],
  "ranked_by_speedup": [
    {
      "patch_id": "p13",
      "family": "B",
      "transform": "inline_decorrelate_materialized",
      "relevance_score": 0.0,
      "source": "iter0_worker_p13_retry_response.txt",
      "output_sql": "WITH filtered_store_sales AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169), filtered_web_sales AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169), filtered_catalog_sales AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk JOIN filtered_store_sales AS fss ON c.c_customer_sk = fss.ss_customer_sk LEFT JOIN filtered_web_sales AS fws ON c.c_customer_sk = fws.ws_bill_customer_sk LEFT JOIN filtered_catalog_sales AS fcs ON c.c_customer_sk = fcs.cs_ship_customer_sk WHERE ca_state IN ('CO', 'NC', 'TX') AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND fws.ws_bill_customer_sk IS NULL AND fcs.cs_ship_customer_sk IS NULL GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "WIN",
      "semantic_passed": true,
      "speedup": 12.106507794267335,
      "original_ms": 62025.302599000046,
      "patch_ms": 5123.302578499988,
      "error": null,
      "times": [
        5219.37305099982,
        5027.232106000156
      ]
    },
    {
      "patch_id": "p07",
      "family": "E",
      "transform": "materialize_cte",
      "relevance_score": 0.0,
      "source": "iter0_worker_p07_response.txt",
      "output_sql": "WITH ss_filtered AS (SELECT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND ss_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND (NOT EXISTS(SELECT * FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "WIN",
      "semantic_passed": true,
      "speedup": 1.1339599286396433,
      "original_ms": 62025.302599000046,
      "patch_ms": 54697.96686149994,
      "error": null,
      "times": [
        54594.616807999955,
        54801.316914999916
      ]
    },
    {
      "patch_id": "p06",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.0,
      "source": "iter0_worker_p06_response.txt",
      "output_sql": "SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND (NOT EXISTS(SELECT * FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "WIN",
      "semantic_passed": true,
      "speedup": 1.1266986826304346,
      "original_ms": 62025.302599000046,
      "patch_ms": 55050.47938300004,
      "error": null,
      "times": [
        54441.85938100009,
        55659.099384999994
      ]
    },
    {
      "patch_id": "p11",
      "family": "F",
      "transform": "date_cte_explicit_join",
      "relevance_score": 0.0,
      "source": "iter0_worker_p11_response.txt",
      "output_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169) AND (NOT EXISTS(SELECT * FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169) AND NOT EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "WIN",
      "semantic_passed": true,
      "speedup": 1.1231351977446111,
      "original_ms": 62025.302599000046,
      "patch_ms": 55225.14361899994,
      "error": null,
      "times": [
        53872.347729000016,
        56577.93950899986
      ]
    },
    {
      "patch_id": "p08",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.0,
      "source": "iter0_worker_p08_retry_response.txt",
      "output_sql": "WITH sales_customers AS (SELECT DISTINCT ss_customer_sk AS customer_sk, 'store' AS channel FROM store_sales AS ss JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 2002 AND d.d_moy BETWEEN 10 AND 10 + 2 AND ss.ss_list_price BETWEEN 80 AND 169 UNION ALL SELECT DISTINCT ws_bill_customer_sk AS customer_sk, 'web' AS channel FROM web_sales AS ws JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_year = 2002 AND d.d_moy BETWEEN 10 AND 10 + 2 AND ws.ws_list_price BETWEEN 80 AND 169 UNION ALL SELECT DISTINCT cs_ship_customer_sk AS customer_sk, 'catalog' AS channel FROM catalog_sales AS cs JOIN date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk WHERE d.d_year = 2002 AND d.d_moy BETWEEN 10 AND 10 + 2 AND cs.cs_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_state IN ('CO', 'NC', 'TX') AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT 1 FROM sales_customers AS sc WHERE sc.customer_sk = c.c_customer_sk AND sc.channel = 'store') AND NOT EXISTS(SELECT 1 FROM sales_customers AS sc WHERE sc.customer_sk = c.c_customer_sk AND sc.channel = 'web') AND NOT EXISTS(SELECT 1 FROM sales_customers AS sc WHERE sc.customer_sk = c.c_customer_sk AND sc.channel = 'catalog') GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
      "status": "REGRESSION",
      "semantic_passed": true,
      "speedup": 0.6562648487551377,
      "original_ms": 62025.302599000046,
      "patch_ms": 94512.60831149989,
      "error": null,
      "times": [
        95109.60513800001,
        93915.61148499977
      ]
    }
  ],
  "best": {
    "patch_id": "p13",
    "family": "B",
    "transform": "inline_decorrelate_materialized",
    "relevance_score": 0.0,
    "source": "iter0_worker_p13_retry_response.txt",
    "output_sql": "WITH filtered_store_sales AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ss_list_price BETWEEN 80 AND 169), filtered_web_sales AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND ws_list_price BETWEEN 80 AND 169), filtered_catalog_sales AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 10 + 2 AND cs_list_price BETWEEN 80 AND 169) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk JOIN filtered_store_sales AS fss ON c.c_customer_sk = fss.ss_customer_sk LEFT JOIN filtered_web_sales AS fws ON c.c_customer_sk = fws.ws_bill_customer_sk LEFT JOIN filtered_catalog_sales AS fcs ON c.c_customer_sk = fcs.cs_ship_customer_sk WHERE ca_state IN ('CO', 'NC', 'TX') AND cd_marital_status IN ('S', 'M', 'U') AND cd_education_status IN ('Primary', 'College') AND fws.ws_bill_customer_sk IS NULL AND fcs.cs_ship_customer_sk IS NULL GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
    "status": "WIN",
    "semantic_passed": true,
    "speedup": 12.106507794267335,
    "original_ms": 62025.302599000046,
    "patch_ms": 5123.302578499988,
    "error": null,
    "times": [
      5219.37305099982,
      5027.232106000156
    ]
  }
}