{
  "iteration": 0,
  "n_api_calls": 3,
  "beam_cost_usd": 0.0,
  "beam_cost_priced_calls": 0,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 0,
    "completion_tokens": 0,
    "total_tokens": 0,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 0,
    "reasoning_tokens": 0
  },
  "best_speedup": 1.09,
  "best_patch_id": "compile_p2",
  "best_sql": "WITH ss_filtered AS (SELECT i.i_item_id, c.c_birth_year, ss.ss_ext_sales_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ss.ss_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), cs_filtered AS (SELECT i.i_item_id, c.c_birth_year, cs.cs_ext_sales_price FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND cs.cs_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), ws_filtered AS (SELECT i.i_item_id, c.c_birth_year, ws.ws_ext_sales_price FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ws.ws_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ss_ext_sales_price) AS ss_item_rev FROM ss_filtered GROUP BY i_item_id, c_birth_year), cs_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(cs_ext_sales_price) AS cs_item_rev FROM cs_filtered GROUP BY i_item_id, c_birth_year), ws_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ws_ext_sales_price) AS ws_item_rev FROM ws_filtered GROUP BY i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
  "patches": [
    {
      "patch_id": "p03",
      "family": "A",
      "transform": "multi_dimension_prefetch",
      "relevance_score": 0.6,
      "status": "ERROR",
      "speedup": 0.0,
      "semantic_passed": true,
      "correctness_verified": false,
      "error": "canceling statement due to statement timeout\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH dimension_prefetch AS (WITH date_range AS (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) SELECT i.i_item_sk, c.c_customer_sk, d.d_date_sk, i.i_item_id, c.c_birth_year FROM item i JOIN customer c ON TRUE JOIN date_range dr ON TRUE JOIN date_dim d ON d.d_date = dr.d_date WHERE i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales JOIN dimension_prefetch AS dp ON ss_item_sk = dp.i_item_sk AND ss_customer_sk = dp.c_customer_sk AND ss_sold_date_sk = dp.d_date_sk GROUP BY i_item_id, c_birth_year), cs_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales JOIN dimension_prefetch AS dp ON cs_item_sk = dp.i_item_sk AND cs_bill_customer_sk = dp.c_customer_sk AND cs_sold_date_sk = dp.d_date_sk GROUP BY i_item_id, c_birth_year), ws_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales JOIN dimension_prefetch AS dp ON ws_item_sk = dp.i_item_sk AND ws_bill_customer_sk = dp.c_customer_sk AND ws_sold_date_sk = dp.d_date_sk GROUP BY i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Create a single CTE that joins filtered item, customer, and date_range, then join this consolidated dimension set with each fact table separately."
    },
    {
      "patch_id": "p02",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.8,
      "status": "REGRESSION",
      "speedup": 0.58,
      "semantic_passed": true,
      "correctness_verified": true,
      "error": null,
      "original_ms": 124.4,
      "patch_ms": 215.6,
      "output_sql": "WITH item_filtered AS (SELECT i_item_sk, i_item_id AS item_id FROM item WHERE i_manager_id BETWEEN 71 AND 100), customer_filtered AS (SELECT c_customer_sk, c_birth_year AS birth_year FROM customer WHERE c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT i.item_id, c.birth_year, SUM(ss.ss_ext_sales_price) ss_item_rev FROM store_sales ss JOIN item_filtered i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk AND d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) JOIN customer_filtered c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 242 AND 271 GROUP BY i.item_id, c.birth_year), cs_items AS (SELECT i.item_id, c.birth_year, SUM(cs.cs_ext_sales_price) cs_item_rev FROM catalog_sales cs JOIN item_filtered i ON cs.cs_item_sk = i.i_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk AND d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) JOIN customer_filtered c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 242 AND 271 GROUP BY i.item_id, c.birth_year), ws_items AS (SELECT i.item_id, c.birth_year, SUM(ws.ws_ext_sales_price) ws_item_rev FROM web_sales ws JOIN item_filtered i ON ws.ws_item_sk = i.i_item_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk AND d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) JOIN customer_filtered c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 242 AND 271 GROUP BY i.item_id, c.birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev, cs_item_rev, cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev, ws_item_rev, ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev, (ss_item_rev+cs_item_rev+ws_item_rev)/3 average FROM ss_items JOIN cs_items ON ss_items.item_id = cs_items.item_id AND ss_items.birth_year = cs_items.birth_year JOIN ws_items ON ss_items.item_id = ws_items.item_id AND ss_items.birth_year = ws_items.birth_year WHERE ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Pre-filter item and customer tables into CTEs, then join filtered dimensions with fact tables using explicit JOIN syntax."
    },
    {
      "patch_id": "p01",
      "family": "F",
      "transform": "date_cte_explicit_join",
      "relevance_score": 0.85,
      "status": "REGRESSION",
      "speedup": 0.5,
      "semantic_passed": true,
      "correctness_verified": true,
      "error": null,
      "original_ms": 124.4,
      "patch_ms": 249.2,
      "output_sql": "WITH date_sk_filter AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')), ss_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(ss.ss_ext_sales_price) AS ss_item_rev FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN date_sk_filter ddf ON ss.ss_sold_date_sk = ddf.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951 GROUP BY i.i_item_id, c.c_birth_year), cs_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(cs.cs_ext_sales_price) AS cs_item_rev FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN date_sk_filter ddf ON cs.cs_sold_date_sk = ddf.d_date_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951 GROUP BY i.i_item_id, c.c_birth_year), ws_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(ws.ws_ext_sales_price) AS ws_item_rev FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN date_sk_filter ddf ON ws.ws_sold_date_sk = ddf.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951 GROUP BY i.i_item_id, c.c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Extract date_dim subquery into a CTE returning d_date_sk for the target month_seq, convert comma joins to explicit JOIN syntax in all three channel CTEs."
    },
    {
      "patch_id": "p04",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.55,
      "status": "REGRESSION",
      "speedup": 0.49,
      "semantic_passed": true,
      "correctness_verified": true,
      "error": null,
      "original_ms": 124.4,
      "patch_ms": 255.9,
      "output_sql": "WITH ss_filtered AS (SELECT i.i_item_id, c.c_birth_year, ss.ss_ext_sales_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ss.ss_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), cs_filtered AS (SELECT i.i_item_id, c.c_birth_year, cs.cs_ext_sales_price FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND cs.cs_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), ws_filtered AS (SELECT i.i_item_id, c.c_birth_year, ws.ws_ext_sales_price FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ws.ws_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ss_ext_sales_price) AS ss_item_rev FROM ss_filtered GROUP BY i_item_id, c_birth_year), cs_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(cs_ext_sales_price) AS cs_item_rev FROM cs_filtered GROUP BY i_item_id, c_birth_year), ws_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ws_ext_sales_price) AS ws_item_rev FROM ws_filtered GROUP BY i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Materialize the filtered fact-dimension join for each channel into separate CTEs to avoid recomputation of common subplans."
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "REGRESSION",
      "speedup": 0.9,
      "semantic_passed": true,
      "correctness_verified": true,
      "error": null,
      "original_ms": 127.6,
      "patch_ms": 141.0,
      "output_sql": "WITH date_sk_filter AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')), ss_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(ss.ss_ext_sales_price) AS ss_item_rev FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN date_sk_filter d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951 GROUP BY i.i_item_id, c.c_birth_year), cs_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(cs.cs_ext_sales_price) AS cs_item_rev FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN date_sk_filter d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951 GROUP BY i.i_item_id, c.c_birth_year), ws_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(ws.ws_ext_sales_price) AS ws_item_rev FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN date_sk_filter d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951 GROUP BY i.i_item_id, c.c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items JOIN cs_items ON ss_items.item_id = cs_items.item_id AND ss_items.birth_year = cs_items.birth_year JOIN ws_items ON ss_items.item_id = ws_items.item_id AND ss_items.birth_year = ws_items.birth_year WHERE ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p2",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "REGRESSION",
      "speedup": 0.75,
      "semantic_passed": true,
      "correctness_verified": true,
      "error": null,
      "original_ms": 127.6,
      "patch_ms": 171.1,
      "output_sql": "WITH item_filtered AS (SELECT i_item_sk, i_item_id FROM item WHERE i_manager_id BETWEEN 71 AND 100), customer_filtered AS (SELECT c_customer_sk, c_birth_year FROM customer WHERE c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(ss.ss_ext_sales_price) AS ss_item_rev FROM store_sales ss JOIN item_filtered i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_filtered c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 242 AND 271 AND d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) GROUP BY i.i_item_id, c.c_birth_year), cs_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(cs.cs_ext_sales_price) AS cs_item_rev FROM catalog_sales cs JOIN item_filtered i ON cs.cs_item_sk = i.i_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer_filtered c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 242 AND 271 AND d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) GROUP BY i.i_item_id, c.c_birth_year), ws_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(ws.ws_ext_sales_price) AS ws_item_rev FROM web_sales ws JOIN item_filtered i ON ws.ws_item_sk = i.i_item_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer_filtered c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 242 AND 271 AND d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) GROUP BY i.i_item_id, c.c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items JOIN cs_items ON ss_items.item_id = cs_items.item_id AND ss_items.birth_year = cs_items.birth_year JOIN ws_items ON ss_items.item_id = ws_items.item_id AND ss_items.birth_year = ws_items.birth_year WHERE ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "REGRESSION",
      "speedup": 0.62,
      "semantic_passed": true,
      "correctness_verified": true,
      "error": null,
      "original_ms": 127.6,
      "patch_ms": 204.4,
      "output_sql": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')), item_filtered AS (SELECT i_item_sk, i_item_id FROM item WHERE i_manager_id BETWEEN 71 AND 100), customer_filtered AS (SELECT c_customer_sk, c_birth_year FROM customer WHERE c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(ss.ss_ext_sales_price) AS ss_item_rev FROM store_sales ss JOIN item_filtered i ON ss.ss_item_sk = i.i_item_sk JOIN date_range dr ON ss.ss_sold_date_sk = dr.d_date_sk JOIN customer_filtered c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 242 AND 271 GROUP BY i.i_item_id, c.c_birth_year), cs_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(cs.cs_ext_sales_price) AS cs_item_rev FROM catalog_sales cs JOIN item_filtered i ON cs.cs_item_sk = i.i_item_sk JOIN date_range dr ON cs.cs_sold_date_sk = dr.d_date_sk JOIN customer_filtered c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 242 AND 271 GROUP BY i.i_item_id, c.c_birth_year), ws_items AS (SELECT i.i_item_id AS item_id, c.c_birth_year AS birth_year, SUM(ws.ws_ext_sales_price) AS ws_item_rev FROM web_sales ws JOIN item_filtered i ON ws.ws_item_sk = i.i_item_sk JOIN date_range dr ON ws.ws_sold_date_sk = dr.d_date_sk JOIN customer_filtered c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 242 AND 271 GROUP BY i.i_item_id, c.c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p2",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "IMPROVED",
      "speedup": 1.09,
      "semantic_passed": true,
      "correctness_verified": true,
      "error": null,
      "original_ms": 127.6,
      "patch_ms": 117.4,
      "output_sql": "WITH ss_filtered AS (SELECT i.i_item_id, c.c_birth_year, ss.ss_ext_sales_price FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ss.ss_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), cs_filtered AS (SELECT i.i_item_id, c.c_birth_year, cs.cs_ext_sales_price FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND cs.cs_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), ws_filtered AS (SELECT i.i_item_id, c.c_birth_year, ws.ws_ext_sales_price FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ws.ws_list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ss_ext_sales_price) AS ss_item_rev FROM ss_filtered GROUP BY i_item_id, c_birth_year), cs_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(cs_ext_sales_price) AS cs_item_rev FROM cs_filtered GROUP BY i_item_id, c_birth_year), ws_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ws_ext_sales_price) AS ws_item_rev FROM ws_filtered GROUP BY i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": null
    }
  ],
  "explains": {
    "p02": "Limit  (cost=66376.01..66376.01 rows=1 width=296) (actual time=250.877..251.278 rows=0 loops=1)\n  CTE item_filtered\n    ->  Seq Scan on item  (cost=0.00..8500.00 rows=30807 width=21) (actual time=0.011..29.786 rows=30495 loops=1)\n          Filter: ((i_manager_id >= 71) AND (i_manager_id <= 100))\n          Rows Removed by Filter: 71505\n  CTE customer_filtered\n    ->  Seq Scan on customer  (cost=0.00..21327.00 rows=46000 width=8) (actual time=0.017..62.140 rows=46065 loops=1)\n          Filter: ((c",
    "p01": "Limit  (cost=69923.77..69923.78 rows=1 width=245) (actual time=244.502..244.519 rows=0 loops=1)\n  CTE date_sk_filter\n    ->  Index Only Scan using _dta_index_date_dim_6_661577395__k4_1 on date_dim date_dim_1  (cost=1356.46..1360.99 rows=30 width=4) (actual time=1.092..1.120 rows=31 loops=1)\n          Index Cond: (d_month_seq = $0)\n          Heap Fetches: 0\n          InitPlan 1 (returns $0)\n            ->  Index Only Scan using _dta_index_date_dim_6_661577395__k4_k3 on date_dim  (cost=0.29..1356.",
    "p04": "Limit  (cost=28837.24..28837.24 rows=1 width=245) (actual time=191.818..192.253 rows=0 loops=1)\n  ->  Sort  (cost=28837.24..28837.24 rows=1 width=245) (actual time=191.816..192.250 rows=0 loops=1)\n        Sort Key: i_1.i_item_id, c_1.c_birth_year, (sum(ss.ss_ext_sales_price))\n        Sort Method: quicksort  Memory: 25kB\n        ->  Merge Join  (cost=28835.34..28837.23 rows=1 width=245) (actual time=191.808..192.242 rows=0 loops=1)\n              Merge Cond: ((i.i_item_id = i_1.i_item_id) AND (c.c",
    "compile_p1": "Limit  (cost=112300.20..112300.20 rows=1 width=296) (actual time=205.706..205.722 rows=0 loops=1)\n  CTE date_range\n    ->  Index Only Scan using _dta_index_date_dim_6_661577395__k4_1 on date_dim date_dim_1  (cost=1356.46..1360.99 rows=30 width=4) (actual time=0.437..0.443 rows=31 loops=1)\n          Index Cond: (d_month_seq = $0)\n          Heap Fetches: 0\n          InitPlan 1 (returns $0)\n            ->  Index Only Scan using _dta_index_date_dim_6_661577395__k4_k3 on date_dim  (cost=0.29..1356.17",
    "compile_p2": "Limit  (cost=28837.24..28837.24 rows=1 width=245) (actual time=118.138..118.333 rows=0 loops=1)\n  ->  Sort  (cost=28837.24..28837.24 rows=1 width=245) (actual time=118.137..118.332 rows=0 loops=1)\n        Sort Key: i_1.i_item_id, c_1.c_birth_year, (sum(ss.ss_ext_sales_price))\n        Sort Method: quicksort  Memory: 25kB\n        ->  Merge Join  (cost=28835.34..28837.23 rows=1 width=245) (actual time=118.131..118.326 rows=0 loops=1)\n              Merge Cond: ((i.i_item_id = i_1.i_item_id) AND (c.c"
  }
}