[
  {
    "target_id": "t1",
    "family": "A+C",
    "transform": "early_filter_then_agg_pushdown",
    "relevance_score": 0.95,
    "hypothesis": "Pre-aggregate catalog_returns after filtering dimension tables to reduce its 719k-row scan. Pushdown aggregates to shrink intermediate data before joins.",
    "target_ir": "S0: replace_from (MAIN QUERY) to use CTEs; insert_cte for filtered dimensions and pre-aggregated catalog_returns",
    "recommended_examples": [
      "pg_date_cte_explicit_join",
      "pg_materialized_dimension_fact_prefilter"
    ]
  },
  {
    "target_id": "t2",
    "family": "A+F",
    "transform": "prejoin_dimensions_early_filter",
    "relevance_score": 0.85,
    "hypothesis": "Pre-join customer with filtered dimensions to reduce nested loop rows (300+ in original). Explicit joins avoid redundant scans.",
    "target_ir": "S0: replace_from (MAIN QUERY) with explicit JOINs; insert_cte for prejoined customer-demos CTE",
    "recommended_examples": [
      "pg_explicit_join_materialized",
      "pg_date_cte_explicit_join"
    ]
  },
  {
    "target_id": "t3",
    "family": "A",
    "transform": "early_filtering_rescue_fixed",
    "relevance_score": 0.8,
    "hypothesis": "Fix missing columns in customer_demographics CTE to enable early filtering without breaking GROUP BY. Isolate dimension filters to cut join inputs.",
    "target_ir": "S0: insert_cte for filtered_customer_demographics (include cd_marital_status/education_status); replace_where_predicate [ac46b9a793b959c6] to reference CTEs",
    "recommended_examples": [
      "pg_date_cte_explicit_join"
    ]
  },
  {
    "target_id": "t4",
    "family": "C",
    "transform": "agg_pushdown_aligned_keys",
    "relevance_score": 0.75,
    "hypothesis": "Pre-aggregate catalog_returns on join keys (cr_call_center_sk, cr_returned_date_sk, cr_returning_customer_sk) to shrink 719k-row scan early.",
    "target_ir": "S0: insert_cte for agg_catalog_returns; replace_from to use aggregated CTE",
    "recommended_examples": [
      "pg_materialized_dimension_fact_prefilter"
    ]
  }
]