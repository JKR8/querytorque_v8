{
  "probe_id": "p01",
  "transform_id": "dimension_prefetch_star",
  "family": "F",
  "dialect": "postgres",
  "hypothesis": "Convert comma joins to explicit INNER JOINs in frequent_ss_items CTE to enable better join planning and reduce row amplification from unordered scans.",
  "reasoning_trace": [
    "frequent_ss_items CTE uses comma joins preventing PostgreSQL from reordering or choosing optimal join methods.",
    "All join predicates are present but not expressed in JOIN ... ON syntax, causing nested loop fallback."
  ],
  "target_ir": "Explicit INNER JOINs in frequent_ss_items CTE with same filters and group-by projection preserved.",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_from",
      "target": {"by_node_id": "CTE_Q_S0_frequent_ss_items"},
      "payload": {
        "from_sql": "store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk"
      }
    },
    {
      "step_id": "s2",
      "op": "replace_where_predicate",
      "target": {"by_node_id": "CTE_Q_S0_frequent_ss_items", "by_anchor_hash": "89fc2fb260a938e8"},
      "payload": {
        "expr_sql": "d_year = 1998 AND i_manager_id BETWEEN 81 AND 100 AND i_category IN ('Children', 'Men', 'Sports')"
      }
    }
  ]
}