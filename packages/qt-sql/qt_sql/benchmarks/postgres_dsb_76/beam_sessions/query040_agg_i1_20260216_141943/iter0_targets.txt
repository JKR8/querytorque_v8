[
  {
    "target_id": "t1",
    "family": "F",
    "transform": "explicit_inner_join_with_early_filters",
    "relevance_score": 0.95,
    "hypothesis": "Implicit cross joins and LEFT JOIN converted to INNER due to WHERE filter on catalog_returns. Restructuring to explicit INNER JOINs with proper conditions and join order allows early filtering and reduces intermediate rows.",
    "target_ir": "S0 [SELECT]\n  MAIN QUERY (via Q_S0)\n    FROM: catalog_sales\n      INNER JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk AND cr_reason_sk = 33)\n      INNER JOIN date_dim ON cs_sold_date_sk = d_date_sk\n      INNER JOIN item ON i_item_sk = cs_item_sk\n      INNER JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk\n    WHERE: d_date BETWEEN ... AND i_category = 'Jewelry' AND i_manager_id BETWEEN 61 AND 100 AND cs_wholesale_cost BETWEEN 42 AND 61\n    GROUP BY: w_state, i_item_id\n    ORDER BY: w_state, i_item_id",
    "recommended_examples": [
      "pg_explicit_join_materialized"
    ]
  },
  {
    "target_id": "t2",
    "family": "A",
    "transform": "early_filtering_with_ctes",
    "relevance_score": 0.9,
    "hypothesis": "Pushing filters on item (category, manager_id) and date_dim (date range) into CTEs reduces rows early before joining with catalog_sales, minimizing data processed in subsequent joins.",
    "target_ir": "S0 [SELECT]\n  CTE: filtered_date (via Q1)\n    FROM: date_dim\n    WHERE: d_date BETWEEN (cast('2002-02-19' as date) - interval '30 day') AND (cast('2002-02-19' as date) + interval '30 day')\n  CTE: filtered_item (via Q2)\n    FROM: item\n    WHERE: i_category = 'Jewelry' AND i_manager_id BETWEEN 61 AND 100\n  MAIN QUERY (via Q_S0)\n    FROM: catalog_sales\n      LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk)\n      INNER JOIN filtered_item ON cs_item_sk = i_item_sk\n      INNER JOIN filtered_date ON cs_sold_date_sk = d_date_sk\n      INNER JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk\n    WHERE: cs_wholesale_cost BETWEEN 42 AND 61 AND cr_reason_sk = 33\n    GROUP BY: w_state, i_item_id\n    ORDER BY: w_state, i_item_id",
    "recommended_examples": [
      "pg_date_cte_explicit_join"
    ]
  }
]