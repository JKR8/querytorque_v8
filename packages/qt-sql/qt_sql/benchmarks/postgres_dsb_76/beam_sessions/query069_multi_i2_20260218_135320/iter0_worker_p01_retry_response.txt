{
  "probe_id": "p01",
  "transform_id": "early_filter_decorrelate",
  "family": "B",
  "status": "failed",
  "failure_reason": "Execution failure due to nested CTE structure causing transaction abort.",
  "partial_work": {
    "attempted_approach": "Introduce filtered_customers CTE with nested subquery-based filters for store, web, and catalog sales.",
    "blocking_issue": "Nested CTEs with correlated subqueries caused execution to fail with 'current transaction is aborted' error.",
    "hypothesis_still_valid": true
  },
  "dialect": "postgresql",
  "hypothesis": "Pre-filtering customer demographics and address into a CTE reduces correlated subquery input size. Correlated EXISTS/NOT EXISTS are converted to semi/anti-joins with precomputed date ranges and customer keys.",
  "reasoning_trace": [
    "Assigned transform targets decorrelation of correlated subqueries with early customer filtering.",
    "Three correlated subqueries (store_sales, web_sales, catalog_sales) share common date and customer filters.",
    "Customer filters reduce outer row count from 1447 to smaller set before subquery execution.",
    "Date dimension scan is materialized once and reused across all three subqueries."
  ],
  "target_ir": "Introduce filtered_customers CTE with all customer filters applied; convert correlated subqueries to semi/anti-joins using precomputed customer keys and date ranges.",
  "verification": {
    "executable": false,
    "no_missing_tables": true,
    "alias_consistent": true,
    "no_orphan_scans": true,
    "semantics_preserved": true,
    "null_semantics_safe": true,
    "ctes_selective_or_na": true
  },
  "tree": {
    "root_node_id": "final_select",
    "nodes": [
      {
        "node_id": "final_select",
        "parent_node_id": null,
        "sources": [],
        "outputs": ["cd_gender", "cd_marital_status", "cd_education_status", "cnt1", "cd_purchase_estimate", "cnt2", "cd_credit_rating", "cnt3"],
        "changed": false
      }
    ]
  }
}