[
  {
    "target_id": "t1",
    "family": "A+C",
    "transform": "early_filter_then_aggregate_pushdown",
    "relevance_score": 0.95,
    "hypothesis": "Push 's_state' filter into CTE wss using join with store. Current CTE outputs 3.2K rows; store scan shows 10 rows. Reduces input to downstream Hash Join (315K rows, 2.4s).",
    "target_ir": "S0: Modify CTE wss (anchor:5f7f8283ea72d640) to join store and add s_state filter.",
    "recommended_examples": [
      "pg_date_cte_explicit_join",
      "pg_materialized_dimension_fact_prefilter"
    ]
  },
  {
    "target_id": "t1",
    "family": "F",
    "transform": "eliminate_self_join_via_conditional_agg",
    "relevance_score": 0.9,
    "hypothesis": "Replace self-join on wss with conditional aggregation in CTE for both time periods. Eliminates Hash Join (315K rows, 2.4s) and reduces intermediate data volume.",
    "target_ir": "S0: Replace CTE wss aggregation (anchor:GROUP BY) with CASE statements for periods 1187-1198 and 1199-1210.",
    "recommended_examples": [
      "pg_explicit_join_materialized"
    ]
  },
  {
    "target_id": "t1",
    "family": "E",
    "transform": "prefetch_store_dimension",
    "relevance_score": 0.85,
    "hypothesis": "Pre-materialize filtered store (10 rows) as CTE to avoid repeated scans. Reduces redundant work in main query.",
    "target_ir": "S0: Insert CTE 'stores' before wss: SELECT * FROM store WHERE s_state IN (...).",
    "recommended_examples": [
      "multi_dimension_prefetch"
    ]
  },
  {
    "target_id": "t1",
    "family": "C",
    "transform": "push_agg_into_cte",
    "relevance_score": 0.8,
    "hypothesis": "Compute sales ratios in CTE after aggregation. Reduces Hash Join input (315K rows \u2192 10 rows) by minimizing row size early.",
    "target_ir": "S0: Replace main query FROM (anchor:0b824afb49a292d0) with pre-aggregated CTE outputting ratios.",
    "recommended_examples": [
      "pg_materialized_dimension_fact_prefilter"
    ]
  }
]