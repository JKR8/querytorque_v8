```json
{
  "plan_id": "compile_p1",
  "dialect": "postgres",
  "confidence": 0.85,
  "based_on": "p02",
  "strategy": "Convert comma joins to explicit JOINs and isolate date filter into MATERIALIZED CTE to enable better join order optimization.",
  "hypothesis": "Winning probe p02 showed 2.45x speedup by addressing comma-join weakness and providing early filtering for date dimension. This rewrite is safe and executable.",
  "expected_explain_delta": "Plan should show explicit joins and a CTE scan for date_dim, reducing the rows fed into the hash join and nested loops.",
  "target_ir": "Update final_select to use explicit JOIN syntax with date_filter CTE.",
  "tree": {
    "root_node_id": "final_select",
    "nodes": [
      {
        "node_id": "final_select",
        "parent_node_id": null,
        "sources": [],
        "outputs": ["brand_id", "brand", "i_manufact_id", "i_manufact", "ext_price"],
        "changed": true,
        "sql": "WITH date_filter AS MATERIALIZED (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy = 4) SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN date_filter ON ss_sold_date_sk = date_filter.d_date_sk JOIN item ON ss_item_sk = i_item_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN store ON ss_store_sk = s_store_sk WHERE i_category = 'Jewelry' AND substring(ca_zip,1,5) <> substring(s_zip,1,5) AND ca_state = 'IL' AND c_birth_month = 1 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100"
      }
    ]
  }
}
```