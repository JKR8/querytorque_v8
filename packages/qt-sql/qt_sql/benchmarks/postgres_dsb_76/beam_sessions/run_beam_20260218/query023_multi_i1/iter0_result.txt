{
  "iteration": 0,
  "n_api_calls": 11,
  "beam_cost_usd": 0.03979903,
  "beam_cost_priced_calls": 11,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 163011,
    "completion_tokens": 27414,
    "total_tokens": 190425,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 85568,
    "reasoning_tokens": 14989
  },
  "best_speedup": 3.41,
  "best_patch_id": "compile_p2",
  "best_sql": "WITH filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_sold_date_sk, ss_quantity, ss_sales_price, ss_wholesale_cost FROM store_sales ss INNER JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 1998 AND ss.ss_wholesale_cost BETWEEN 11 AND 21), frequent_ss_items AS (SELECT substring(i_item_desc,1,30) itemdesc, i_item_sk item_sk, d_date solddate, count(*) cnt FROM filtered_store_sales fss INNER JOIN date_dim d ON fss.ss_sold_date_sk = d.d_date_sk INNER JOIN item i ON fss.ss_item_sk = i.i_item_sk WHERE i.i_manager_id BETWEEN 81 and 100 AND i.i_category IN ('Children', 'Men', 'Sports') GROUP BY substring(i_item_desc,1,30), i_item_sk, d_date HAVING count(*) > 4), max_store_sales AS (SELECT max(csales) tpcds_cmax FROM (SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) csales FROM filtered_store_sales fss INNER JOIN customer c ON fss.ss_customer_sk = c.c_customer_sk GROUP BY c_customer_sk) tmp1), best_ss_customer AS (SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) ssales FROM filtered_store_sales fss INNER JOIN customer c ON fss.ss_customer_sk = c.c_customer_sk WHERE c.c_birth_year BETWEEN 1934 AND 1940 GROUP BY c_customer_sk HAVING sum(ss_quantity*ss_sales_price) > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100;",
  "patches": [
    {
      "patch_id": "p03",
      "family": "E",
      "transform": "pg_self_join_decomposition",
      "relevance_score": 0.6,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: column \"d_date\" does not exist\nLINE 1: ...ring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date sol...\n                                                             ^\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_sold_date_sk, ss_quantity, ss_sales_price FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 1998 AND ss_wholesale_cost BETWEEN 11 AND 21), frequent_ss_items AS (SELECT substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt FROM filtered_store_sales JOIN item ON filtered_store_sales.ss_item_sk = i_item_sk WHERE i_manager_id BETWEEN 81 and 100 AND i_category IN ('Children', 'Men', 'Sports') GROUP BY substring(i_item_desc,1,30),i_item_sk,d_date HAVING count(*) >4), max_store_sales AS (SELECT max(csales) tpcds_cmax FROM (SELECT c_customer_sk,sum(ss_quantity*ss_sales_price) csales FROM filtered_store_sales JOIN customer ON filtered_store_sales.ss_customer_sk = c_customer_sk GROUP BY c_customer_sk) tmp1), best_ss_customer AS (SELECT c_customer_sk,sum(ss_quantity*ss_sales_price) ssales FROM filtered_store_sales JOIN customer ON filtered_store_sales.ss_customer_sk = c_customer_sk WHERE c_birth_year BETWEEN 1934 AND 1940 GROUP BY c_customer_sk HAVING sum(ss_quantity*ss_sales_price) > (95/100.0) * (SELECT * FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Materialize the store_sales scan for d_year=1998 and ss_wholesale_cost BETWEEN 11 AND 21 into a shared CTE, then reuse it in both best_ss_customer and frequent_ss_items CTEs to avoid repeated store_sales scans."
    },
    {
      "patch_id": "p02",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.7,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: current transaction is aborted, commands ignored until end of transaction block\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH frequent_ss_items AS (WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998), item_filtered AS (SELECT i_item_sk, substring(i_item_desc,1,30) AS itemdesc FROM item WHERE i_manager_id BETWEEN 81 AND 100 AND i_category IN ('Children', 'Men', 'Sports')) SELECT f.itemdesc AS itemdesc, ss.ss_item_sk AS item_sk, d.d_date_sk AS solddate, COUNT(*) AS cnt FROM store_sales ss JOIN date_filtered d ON ss.ss_sold_date_sk = d.d_date_sk JOIN item_filtered f ON ss.ss_item_sk = f.i_item_sk GROUP BY f.itemdesc, ss.ss_item_sk, d.d_date_sk HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM store_sales, customer, date_dim WHERE ss_customer_sk = c_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY c_customer_sk) AS tmp1), best_ss_customer AS (WITH customer_filtered AS (SELECT c_customer_sk FROM customer WHERE c_birth_year BETWEEN 1934 AND 1940) SELECT c.c_customer_sk, SUM(ss.ss_quantity * ss.ss_sales_price) AS ssales FROM store_sales ss JOIN customer_filtered c ON ss.ss_customer_sk = c.c_customer_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 1998 AND ss.ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY c.c_customer_sk HAVING SUM(ss.ss_quantity * ss.ss_sales_price) > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Pre-filter all selective dimensions (date_dim for d_year=1998, item for i_manager_id and i_category, customer for c_birth_year) into separate CTEs, then join them with store_sales in the CTE definitions using explicit JOIN syntax."
    },
    {
      "patch_id": "p01",
      "family": "A",
      "transform": "date_cte_explicit_join",
      "relevance_score": 0.75,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: current transaction is aborted, commands ignored until end of transaction block\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH d1998 AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 1998), frequent_ss_items AS (SELECT substring(i_item_desc,1,30) AS itemdesc, i_item_sk AS item_sk, d.d_date AS solddate, count(*) AS cnt FROM store_sales ss INNER JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE d.d_year = 1998 AND i.i_manager_id BETWEEN 81 AND 100 AND i.i_category IN ('Children', 'Men', 'Sports') GROUP BY substring(i_item_desc,1,30), i_item_sk, d.d_date HAVING count(*) > 4), max_store_sales AS (SELECT max(csales) AS tpcds_cmax FROM (SELECT c.c_customer_sk, sum(ss.ss_quantity * ss.ss_sales_price) AS csales FROM store_sales ss INNER JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk INNER JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 1998 AND ss.ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY c.c_customer_sk) tmp1), best_ss_customer AS (SELECT c.c_customer_sk, sum(ss.ss_quantity * ss.ss_sales_price) AS ssales FROM store_sales ss INNER JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE c.c_birth_year BETWEEN 1934 AND 1940 GROUP BY c.c_customer_sk HAVING sum(ss.ss_quantity * ss.ss_sales_price) > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Replace comma joins in frequent_ss_items and best_ss_customer CTE definitions with explicit INNER JOIN syntax and pre-filter date_dim into a tiny CTE for d_year=1998, then join with fact tables."
    },
    {
      "patch_id": "p04",
      "family": "C",
      "transform": "aggregate_pushdown",
      "relevance_score": 0.55,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: current transaction is aborted, commands ignored until end of transaction block\n",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH frequent_ss_items AS (SELECT substring(i_item_desc,1,30) AS itemdesc, i_item_sk AS item_sk, d_date AS solddate, COUNT(*) AS cnt FROM (SELECT ss_item_sk, ss_sold_date_sk, COUNT(*) AS cnt FROM store_sales WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 1998) GROUP BY ss_item_sk, ss_sold_date_sk) p JOIN date_dim d ON p.ss_sold_date_sk = d.d_date_sk JOIN item i ON p.ss_item_sk = i.i_item_sk WHERE d.d_year = 1998 AND i.i_manager_id BETWEEN 81 AND 100 AND i.i_category IN ('Children', 'Men', 'Sports') GROUP BY substring(i_item_desc,1,30), i_item_sk, d_date HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM store_sales, customer, date_dim WHERE ss_customer_sk = c_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY c_customer_sk) AS tmp1), best_ss_customer AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM store_sales, customer WHERE ss_customer_sk = c_customer_sk AND c_birth_year BETWEEN 1934 AND 1940 GROUP BY c_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (95 / 100.0) * (SELECT * FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] In the frequent_ss_items CTE, pre-aggregate store_sales by ss_item_sk and ss_sold_date_sk before joining with date_dim and item, then apply the substring and other filters."
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "WIN",
      "speedup": 2.94,
      "semantic_passed": true,
      "error": null,
      "original_ms": 10303.1,
      "patch_ms": 3508.6,
      "output_sql": "WITH d1998 AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 1998), d1998_m10 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 10), frequent_ss_items AS (SELECT substring(i_item_desc,1,30) AS itemdesc, i_item_sk AS item_sk, d.d_date AS solddate, COUNT(*) AS cnt FROM store_sales ss INNER JOIN d1998 d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_manager_id BETWEEN 81 AND 100 AND i.i_category IN ('Children', 'Men', 'Sports') GROUP BY substring(i_item_desc,1,30), i_item_sk, d.d_date HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT c.c_customer_sk, SUM(ss.ss_quantity * ss.ss_sales_price) AS csales FROM store_sales ss INNER JOIN d1998 d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY c.c_customer_sk) tmp1), best_ss_customer AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM store_sales, customer WHERE ss_customer_sk = c_customer_sk AND c_birth_year BETWEEN 1934 AND 1940 GROUP BY c_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (95 / 100.0) * (SELECT * FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "WIN",
      "speedup": 2.92,
      "semantic_passed": true,
      "error": null,
      "original_ms": 10303.1,
      "patch_ms": 3527.3,
      "output_sql": "WITH date_1998 AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 1998), item_filtered AS (SELECT i_item_sk, i_item_desc FROM item WHERE i_manager_id BETWEEN 81 and 100 AND i_category IN ('Children', 'Men', 'Sports')), customer_filtered AS (SELECT c_customer_sk FROM customer WHERE c_birth_year BETWEEN 1934 AND 1940), max_store_sales AS (SELECT max(csales) tpcds_cmax FROM (SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) csales FROM store_sales ss INNER JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk INNER JOIN date_1998 d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY c_customer_sk) tmp1), frequent_ss_items AS (SELECT substring(i_item_desc,1,30) itemdesc, i_item_sk item_sk, d_date solddate, count(*) cnt FROM store_sales ss INNER JOIN date_1998 d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN item_filtered i ON ss.ss_item_sk = i.i_item_sk GROUP BY substring(i_item_desc,1,30), i_item_sk, d_date HAVING count(*) > 4), best_ss_customer AS (SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) ssales FROM store_sales ss INNER JOIN customer_filtered c ON ss.ss_customer_sk = c.c_customer_sk GROUP BY c_customer_sk HAVING sum(ss_quantity*ss_sales_price) > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p2",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "WIN",
      "speedup": 3.41,
      "semantic_passed": true,
      "error": null,
      "original_ms": 10303.1,
      "patch_ms": 3021.5,
      "output_sql": "WITH filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_sold_date_sk, ss_quantity, ss_sales_price, ss_wholesale_cost FROM store_sales ss INNER JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 1998 AND ss.ss_wholesale_cost BETWEEN 11 AND 21), frequent_ss_items AS (SELECT substring(i_item_desc,1,30) itemdesc, i_item_sk item_sk, d_date solddate, count(*) cnt FROM filtered_store_sales fss INNER JOIN date_dim d ON fss.ss_sold_date_sk = d.d_date_sk INNER JOIN item i ON fss.ss_item_sk = i.i_item_sk WHERE i.i_manager_id BETWEEN 81 and 100 AND i.i_category IN ('Children', 'Men', 'Sports') GROUP BY substring(i_item_desc,1,30), i_item_sk, d_date HAVING count(*) > 4), max_store_sales AS (SELECT max(csales) tpcds_cmax FROM (SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) csales FROM filtered_store_sales fss INNER JOIN customer c ON fss.ss_customer_sk = c.c_customer_sk GROUP BY c_customer_sk) tmp1), best_ss_customer AS (SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) ssales FROM filtered_store_sales fss INNER JOIN customer c ON fss.ss_customer_sk = c.c_customer_sk WHERE c.c_birth_year BETWEEN 1934 AND 1940 GROUP BY c_customer_sk HAVING sum(ss_quantity*ss_sales_price) > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100;",
      "has_explain": true,
      "description": null
    }
  ],
  "explains": {
    "compile_p1": "Limit  (rows=1, time=4132.052)\n  Index Scan on date_dim (date_dim_2)  (rows=365, time=1.627)\n  Aggregate  (rows=3, time=951.774)\n    Hash Join  (rows=151572, time=820.84)\n      Nested Loop  (rows=4520756, time=504.628)\n        CTE Scan (d)  (rows=365, time=0.205)\n        Index Only Scan on store_sales (ss)  (rows=12386, time=0.835)\n      Hash  (rows=6872, time=18.576)\n        Seq Scan on item  (rows=6872, time=17.457)\n  Aggregate  (rows=24387, time=3007.669)\n    Aggregate  (rows=1, time=2136.227",
    "compile_p2": "Limit  (rows=1, time=3873.73)\n  Gather  (rows=259471, time=1335.347)\n    Nested Loop  (rows=259471, time=1318.045)\n      Index Only Scan on date_dim (d)  (rows=365, time=4.605)\n      Index Only Scan on store_sales (ss)  (rows=711, time=3.532)\n  Aggregate  (rows=0, time=0.0)\n    Sort  (rows=0, time=0.0)\n      Nested Loop  (rows=0, time=0.0)\n        Hash Join  (rows=0, time=0.0)\n          CTE Scan (fss)  (rows=0, time=0.0)\n          Hash  (rows=0, time=0.0)\n            Seq Scan on item (i)  (rows="
  }
}