{
  "probe_id": "p01",
  "transform_id": "date_cte_explicit_join",
  "family": "F",
  "status": "failed",
  "failure_reason": "Adding d_moy filter to CTE WHERE clause changed result row count from 0 to 2910, breaking semantic equivalence.",
  "partial_work": {
    "attempted_approach": "Converted comma joins to explicit INNER JOINs and added d_moy IN (2,3) filter to CTE's WHERE clause",
    "blocking_issue": "Filtering d_moy early in CTE changes the result set because outer query expects all d_moy values for correlation",
    "hypothesis_still_valid": false
  },
  "dialect": "postgres",
  "hypothesis": "Early filtering of d_moy in CTE breaks outer query correlation logic which requires full d_moy distribution for join matching.",
  "reasoning_trace": [
    "CTE originally groups by d_moy but doesn't filter it, allowing outer query to correlate on specific d_moy values",
    "Adding d_moy IN (2,3) to CTE WHERE clause restricts data prematurely, removing necessary rows for outer join conditions",
    "Outer query self-join on inv1.d_moy=2 and inv2.d_moy=3 requires both d_moy values present in CTE output"
  ],
  "target_ir": "No structural change due to semantic conflict with early filtering approach.",
  "verification": {
    "executable": false,
    "no_missing_tables": true,
    "alias_consistent": true,
    "no_orphan_scans": true,
    "semantics_preserved": false,
    "null_semantics_safe": true,
    "ctes_selective_or_na": true
  },
  "tree": {
    "root_node_id": "final_select",
    "nodes": [
      {
        "node_id": "final_select",
        "parent_node_id": null,
        "sources": ["inv"],
        "outputs": ["w_warehouse_sk", "i_item_sk", "d_moy", "mean", "cov", "w_warehouse_sk", "i_item_sk", "d_moy", "mean", "cov"],
        "changed": false
      },
      {
        "node_id": "inv",
        "parent_node_id": "final_select",
        "sources": ["inventory", "item", "warehouse", "date_dim"],
        "outputs": ["w_warehouse_name", "w_warehouse_sk", "i_item_sk", "d_moy", "stdev", "mean", "cov"],
        "changed": false
      }
    ]
  }
}