[
  {
    "target_id": "t1",
    "family": "E",
    "transform": "materialization_prefetch",
    "relevance_score": 0.95,
    "hypothesis": "CTEs best_ss_customer (4.1s) and frequent_ss_items are evaluated twice due to UNION ALL branches, causing redundant computation.",
    "target_ir": "S0 [SELECT]\n  CTE: frequent_ss_items  (unchanged)\n  CTE: max_store_sales  (unchanged)\n  CTE: best_ss_customer  (unchanged)\n  MAIN QUERY (via Q_S0)\n    WITH main_sales AS (\n        SELECT cs_quantity * cs_list_price AS sales, cs_bill_customer_sk, cs_item_sk, cs_wholesale_cost\n        FROM catalog_sales\n        JOIN date_dim ON cs_sold_date_sk = d_date_sk AND d_year = 1999 AND d_moy = 5\n        UNION ALL\n        SELECT ws_quantity * ws_list_price, ws_bill_customer_sk, ws_item_sk, ws_wholesale_cost\n        FROM web_sales\n        JOIN date_dim ON ws_sold_date_sk = d_date_sk AND d_year = 1999 AND d_moy = 5\n    )\n    SELECT SUM(sales)\n    FROM main_sales\n    WHERE wholesale_cost BETWEEN 26 AND 36\n      AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items)\n      AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer)\n    LIMIT 100",
    "recommended_examples": [
      "multi_dimension_prefetch"
    ]
  },
  {
    "target_id": "t2",
    "family": "A",
    "transform": "predicate_pushback",
    "relevance_score": 0.85,
    "hypothesis": "Unnecessary join with customer in max_store_sales CTE (3.1s) since customer attributes aren't used in aggregation.",
    "target_ir": "S0 [SELECT]\n  CTE: frequent_ss_items  (unchanged)\n  CTE: max_store_sales  (via CTE_Q_S0_max_store_sales)\n    FROM: store_sales, date_dim\n    WHERE: ss_sold_date_sk = d_date_sk AND d_year = 1999 AND ss_wholesale_cost BETWEEN 26 AND 36\n    GROUP BY: ss_customer_sk\n  CTE: best_ss_customer  (unchanged)\n  MAIN QUERY (unchanged)",
    "recommended_examples": [
      "pg_date_cte_explicit_join"
    ]
  }
]