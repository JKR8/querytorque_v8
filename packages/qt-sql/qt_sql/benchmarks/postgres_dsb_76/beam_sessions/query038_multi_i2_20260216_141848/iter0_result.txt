{
  "iteration": 0,
  "n_api_calls": 6,
  "best_speedup": 1.04,
  "best_patch_id": "t3",
  "best_sql": "WITH store_sales_filtered AS (SELECT * FROM store_sales WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_sales_filtered AS (SELECT * FROM catalog_sales WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_sales_filtered AS (SELECT * FROM web_sales WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales_filtered, date_dim, customer WHERE ss_sold_date_sk = d_date_sk AND ss_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales_filtered, date_dim, customer WHERE cs_sold_date_sk = d_date_sk AND cs_bill_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales_filtered, date_dim, customer WHERE ws_sold_date_sk = d_date_sk AND ws_bill_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10)) AS hot_cust LIMIT 100;",
  "patches": [
    {
      "patch_id": "t1",
      "family": "D",
      "transform": "intersect_to_exists",
      "relevance_score": 0.95,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Equivalence (after retry): checksum 23741c356c789badef33447f1f27f2b6 vs 2a9ccd09d8f9afdc982ef7c840c1fcc0",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM store WHERE EXISTS(SELECT 1 FROM catalog WHERE c_last_name = store.c_last_name AND c_first_name = store.c_first_name AND d_date = store.d_date) AND EXISTS(SELECT 1 FROM web WHERE c_last_name = store.c_last_name AND c_first_name = store.c_first_name AND d_date = store.d_date) LIMIT 100;",
      "has_explain": false
    },
    {
      "patch_id": "t3",
      "family": "A",
      "transform": "predicate_pushback",
      "relevance_score": 0.8,
      "status": "NEUTRAL",
      "speedup": 1.04,
      "semantic_passed": true,
      "error": null,
      "original_ms": 1625.4,
      "patch_ms": 1562.7,
      "output_sql": "WITH store_sales_filtered AS (SELECT * FROM store_sales WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_sales_filtered AS (SELECT * FROM catalog_sales WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_sales_filtered AS (SELECT * FROM web_sales WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales_filtered, date_dim, customer WHERE ss_sold_date_sk = d_date_sk AND ss_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales_filtered, date_dim, customer WHERE cs_sold_date_sk = d_date_sk AND cs_bill_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales_filtered, date_dim, customer WHERE ws_sold_date_sk = d_date_sk AND ws_bill_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10)) AS hot_cust LIMIT 100;",
      "has_explain": true
    },
    {
      "patch_id": "t2",
      "family": "E+F",
      "transform": "multi_dimension_prefetch+explicit_join_order",
      "relevance_score": 0.85,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1 structural: LITERAL MISMATCH: Original literals missing from rewrite \u2014 numbers: ['11.0']. The rewrite changed filter values instead of preserving them.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH filtered_date AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1218), filtered_customer AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_month IN (2, 3, 4, 10)) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM filtered_date JOIN store_sales ON ss_sold_date_sk = d_date_sk JOIN filtered_customer ON ss_customer_sk = c_customer_sk WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM filtered_date JOIN catalog_sales ON cs_sold_date_sk = d_date_sk JOIN filtered_customer ON cs_bill_customer_sk = c_customer_sk WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM filtered_date JOIN web_sales ON ws_sold_date_sk = d_date_sk JOIN filtered_customer ON ws_bill_customer_sk = c_customer_sk WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) AS hot_cust LIMIT 100;",
      "has_explain": false
    },
    {
      "patch_id": "syn_w2",
      "family": "B",
      "transform": "decorrelate",
      "relevance_score": 0.3,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Tier-1 structural: LITERAL MISMATCH: Original literals missing from rewrite \u2014 numbers: ['11.0']. The rewrite changed filter values instead of preserving them.",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE ss_sold_date_sk = d_date_sk AND ss_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1218 AND c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE cs_sold_date_sk = d_date_sk AND cs_bill_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1218 AND c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE ws_sold_date_sk = d_date_sk AND ws_bill_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1218 AND c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM store WHERE EXISTS(SELECT 1 FROM catalog WHERE c_last_name = store.c_last_name AND c_first_name = store.c_first_name AND d_date = store.d_date) AND EXISTS(SELECT 1 FROM web WHERE c_last_name = store.c_last_name AND c_first_name = store.c_first_name AND d_date = store.d_date) LIMIT 100;",
      "has_explain": false
    }
  ],
  "explains": {
    "t3": "Limit  (rows=1, time=1862.71)\n  Aggregate  (rows=1, time=1862.708)\n    Subquery Scan (hot_cust)  (rows=45, time=1862.697)\n      SetOp  (rows=45, time=1862.691)\n        Append  (rows=21988, time=1854.96)\n          Subquery Scan (*SELECT* 3)  (rows=21773, time=352.015)\n            Unique  (rows=21773, time=350.293)\n              Gather Merge  (rows=27322, time=347.585)\n                Sort  (rows=13661, time=304.495)\n                  Nested Loop  (rows=13661, time=287.441)\n                    Nes"
  }
}