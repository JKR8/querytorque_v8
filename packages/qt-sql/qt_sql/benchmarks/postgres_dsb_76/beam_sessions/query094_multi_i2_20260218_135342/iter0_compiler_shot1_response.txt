```json
[
  {
    "plan_id": "compile_p1",
    "dialect": "postgres",
    "confidence": 0.5,
    "based_on": "p02",
    "strategy": "Convert comma joins to explicit INNER JOIN syntax without CTE fences to preserve optimizer join reordering.",
    "hypothesis": "Probe p02 regressed due to CTE materialization blocking predicate pushdown; explicit JOIN syntax alone may improve join order without fence penalties.",
    "expected_explain_delta": "Nested Loop may become Hash Join or Merge Join; earlier filter application on date_dim and customer_address.",
    "target_ir": "Change final_select join syntax from comma-separated to explicit INNER JOIN.",
    "tree": {
      "root_node_id": "final_select",
      "nodes": [
        {
          "node_id": "final_select",
          "parent_node_id": null,
          "sources": [],
          "outputs": ["order count", "total shipping cost", "total net profit"],
          "changed": true,
          "sql": "SELECT COUNT(DISTINCT ws1.ws_order_number) AS \"order count\", SUM(ws1.ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws1.ws_net_profit) AS \"total net profit\" FROM web_sales ws1 INNER JOIN date_dim ON ws1.ws_ship_date_sk = date_dim.d_date_sk INNER JOIN customer_address ON ws1.ws_ship_addr_sk = customer_address.ca_address_sk INNER JOIN web_site ON ws1.ws_web_site_sk = web_site.web_site_sk WHERE date_dim.d_date BETWEEN '1999-10-01' AND CAST('1999-10-01' AS DATE) + INTERVAL '60 day' AND customer_address.ca_state IN ('MO','MT','OK','SC','TX','WI') AND web_site.web_gmt_offset >= -5 AND ws1.ws_list_price BETWEEN 253 AND 282 AND EXISTS (SELECT 1 FROM web_sales ws2 WHERE ws1.ws_order_number = ws2.ws_order_number AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) AND NOT EXISTS (SELECT 1 FROM web_returns wr1 WHERE ws1.ws_order_number = wr1.wr_order_number AND wr1.wr_reason_sk IN (8, 18, 20, 23, 41)) ORDER BY COUNT(DISTINCT ws1.ws_order_number) LIMIT 100"
        }
      ]
    }
  },
  {
    "plan_id": "compile_p2",
    "dialect": "postgres",
    "confidence": 0.4,
    "based_on": "p01",
    "strategy": "Push wr_reason_sk filter early via derived table in NOT EXISTS while preserving EXISTS semiâ€‘join and explicit JOIN syntax.",
    "hypothesis": "Primary hotspot is full scan of web_returns without wr_reason_sk filter; derived table may enable early filtering without CTE materialization that caused p01 regression.",
    "expected_explain_delta": "Seq Scan on web_returns should include wr_reason_sk filter; hash join input rows reduced.",
    "target_ir": "Change NOT EXISTS subquery to use filtered derived table and keep explicit JOINs.",
    "tree": {
      "root_node_id": "final_select",
      "nodes": [
        {
          "node_id": "final_select",
          "parent_node_id": null,
          "sources": [],
          "outputs": ["order count", "total shipping cost", "total net profit"],
          "changed": true,
          "sql": "SELECT COUNT(DISTINCT ws1.ws_order_number) AS \"order count\", SUM(ws1.ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws1.ws_net_profit) AS \"total net profit\" FROM web_sales ws1 INNER JOIN date_dim ON ws1.ws_ship_date_sk = date_dim.d_date_sk INNER JOIN customer_address ON ws1.ws_ship_addr_sk = customer_address.ca_address_sk INNER JOIN web_site ON ws1.ws_web_site_sk = web_site.web_site_sk WHERE date_dim.d_date BETWEEN '1999-10-01' AND CAST('1999-10-01' AS DATE) + INTERVAL '60 day' AND customer_address.ca_state IN ('MO','MT','OK','SC','TX','WI') AND web_site.web_gmt_offset >= -5 AND ws1.ws_list_price BETWEEN 253 AND 282 AND EXISTS (SELECT 1 FROM web_sales ws2 WHERE ws1.ws_order_number = ws2.ws_order_number AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) AND NOT EXISTS (SELECT 1 FROM (SELECT wr_order_number FROM web_returns WHERE wr_reason_sk IN (8, 18, 20, 23, 41)) wr1 WHERE ws1.ws_order_number = wr1.wr_order_number) ORDER BY COUNT(DISTINCT ws1.ws_order_number) LIMIT 100"
        }
      ]
    }
  }
]
```