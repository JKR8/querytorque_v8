{
  "probe_id": "p12",
  "transform_id": "dimension_prefetch_star",
  "family": "F",
  "status": "success",
  "dialect": "postgres",
  "hypothesis": "Converting comma-separated joins to explicit JOIN syntax and prefetching selective dimensions into CTEs will reduce inventory scan size and enable hash joins.",
  "reasoning_trace": [
    "Assigned transform targets comma-join syntax and late filtering of selective dimensions.",
    "Creating CTEs for filtered date_dim, item, and warehouse enables tiny hash tables.",
    "Explicit JOIN syntax allows better join reordering and selectivity propagation."
  ],
  "target_ir": "CTEs for date_dim, item, warehouse; explicit JOINs in 'inv' CTE; final_select unchanged.",
  "verification": {
    "executable": true,
    "no_missing_tables": true,
    "alias_consistent": true,
    "no_orphan_scans": true,
    "semantics_preserved": true,
    "null_semantics_safe": true,
    "ctes_selective_or_na": true
  },
  "tree": {
    "root_node_id": "final_select",
    "nodes": [
      {
        "node_id": "final_select",
        "parent_node_id": null,
        "sources": ["inv"],
        "outputs": ["w_warehouse_sk", "i_item_sk", "d_moy", "mean", "cov", "w_warehouse_sk", "i_item_sk", "d_moy", "mean", "cov"],
        "changed": false
      },
      {
        "node_id": "inv",
        "parent_node_id": "final_select",
        "sources": ["inventory", "item_prefetch", "warehouse_prefetch", "date_dim_prefetch"],
        "outputs": ["w_warehouse_name", "w_warehouse_sk", "i_item_sk", "d_moy", "stdev", "mean", "cov"],
        "changed": true,
        "sql": "with date_dim_prefetch as (select d_date_sk from date_dim where d_year = 2002), item_prefetch as (select i_item_sk from item where i_category IN ('Shoes', 'Sports') and i_manager_id BETWEEN 42 and 61), warehouse_prefetch as (select w_warehouse_sk from warehouse) select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory join item_prefetch on inv_item_sk = item_prefetch.i_item_sk join warehouse_prefetch on inv_warehouse_sk = warehouse_prefetch.w_warehouse_sk join date_dim_prefetch on inv_date_sk = date_dim_prefetch.d_date_sk where inv_quantity_on_hand between 791 and 991 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo where case mean when 0 then 0 else stdev/mean end > 1"
      }
    ]
  }
}