{
  "probe_id": "p01",
  "transform_id": "or_to_union",
  "family": "D",
  "dialect": "postgres",
  "hypothesis": "Splitting the OR condition on different columns into UNION ALL branches may enable index scans per branch, avoiding a full table scan due to OR blocking bitmap index usage.",
  "reasoning_trace": [
    "OR condition spans two columns: i_manufact_id (IN list) and i_manager_id (BETWEEN range)",
    "PostgreSQL may not use index scans efficiently when OR spans multiple columns",
    "UNION ALL allows each branch to be optimized independently with focused predicates"
  ],
  "target_ir": "Two UNION ALL branches, each with a simplified WHERE condition on a single column, preserving all joins and outer query structure.",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_body",
      "target": {"by_node_id": "S0"},
      "payload": {
        "sql_fragment": "(select  sum(cs_ext_discount_amt)  as \"excess discount amount\" from catalog_sales, item, date_dim where i_manufact_id in (47, 226, 612, 676, 818) and i_item_sk = cs_item_sk and d_date between '1998-01-06' and cast('1998-01-06' as date) + interval '90 day' and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales, date_dim where cs_item_sk = i_item_sk and d_date between '1998-01-06' and cast('1998-01-06' as date) + interval '90 day' and d_date_sk = cs_sold_date_sk and cs_list_price between 108 and 137 and cs_sales_price / cs_list_price BETWEEN 23 * 0.01 AND 43 * 0.01 )) UNION ALL (select  sum(cs_ext_discount_amt)  as \"excess discount amount\" from catalog_sales, item, date_dim where i_manager_id BETWEEN 71 and 100 and i_item_sk = cs_item_sk and d_date between '1998-01-06' and cast('1998-01-06' as date) + interval '90 day' and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales, date_dim where cs_item_sk = i_item_sk and d_date between '1998-01-06' and cast('1998-01-06' as date) + interval '90 day' and d_date_sk = cs_sold_date_sk and cs_list_price between 108 and 137 and cs_sales_price / cs_list_price BETWEEN 23 * 0.01 AND 43 * 0.01 ))"
      }
    }
  ]
}