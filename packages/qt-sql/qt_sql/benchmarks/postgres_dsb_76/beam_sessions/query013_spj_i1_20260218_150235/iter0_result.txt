{
  "iteration": 0,
  "n_api_calls": 9,
  "beam_cost_usd": 0.04551637,
  "beam_cost_priced_calls": 9,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 114493,
    "completion_tokens": 24148,
    "total_tokens": 138641,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 34496,
    "reasoning_tokens": 16539
  },
  "best_speedup": 1.75,
  "best_patch_id": "p01",
  "best_sql": "select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'U'\n  and cd_education_status = 'College'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Unknown'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('CO', 'NC', 'TX')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'NY', 'TX')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('IA', 'IL', 'NC')\n  and ss_net_profit between 50 and 250\n     ));",
  "patches": [
    {
      "patch_id": "p01",
      "family": "D",
      "transform": "or_to_union",
      "relevance_score": 0.85,
      "status": "WIN",
      "speedup": 1.75,
      "semantic_passed": true,
      "error": null,
      "original_ms": 2309.3,
      "patch_ms": 1322.6,
      "output_sql": "select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'U'\n  and cd_education_status = 'College'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Unknown'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('CO', 'NC', 'TX')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'NY', 'TX')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('IA', 'IL', 'NC')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Decompose OR predicates into UNION ALL branches, each branch containing one OR clause's conditions, to enable per-branch index usage on store_sales columns."
    },
    {
      "patch_id": "p04",
      "family": "F",
      "transform": "inner_join_conversion",
      "relevance_score": 0.7,
      "status": "NEUTRAL",
      "speedup": 0.97,
      "semantic_passed": true,
      "error": null,
      "original_ms": 2309.3,
      "patch_ms": 2389.6,
      "output_sql": "SELECT MIN(ss_quantity), MIN(ss_ext_sales_price), MIN(ss_ext_wholesale_cost), MIN(ss_ext_wholesale_cost) FROM store_sales INNER JOIN store ON s_store_sk = ss_store_sk INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk INNER JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk INNER JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk INNER JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE d_year = 2001 AND ((cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (cd_marital_status = 'U' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (cd_marital_status = 'S' AND cd_education_status = 'Unknown' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((ca_country = 'United States' AND ca_state IN ('CO', 'NC', 'TX') AND ss_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'NY', 'TX') AND ss_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('IA', 'IL', 'NC') AND ss_net_profit BETWEEN 50 AND 250));",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Convert comma-separated joins to explicit INNER JOIN syntax while preserving all join predicates in ON clauses."
    },
    {
      "patch_id": "p02",
      "family": "A",
      "transform": "early_filter",
      "relevance_score": 0.65,
      "status": "DEDUP",
      "speedup": null,
      "semantic_passed": true,
      "error": null,
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'U'\n  and cd_education_status = 'College'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Unknown'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('CO', 'NC', 'TX')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'NY', 'TX')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('IA', 'IL', 'NC')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Pre-filter household_demographics, customer_demographics, and customer_address into CTEs with their respective OR clause filters before joining to store_sales, creating small hash tables for early join reduction."
    },
    {
      "patch_id": "p03",
      "family": "F",
      "transform": "materialized_dimension_fact_prefilter",
      "relevance_score": 0.55,
      "status": "DEDUP",
      "speedup": null,
      "semantic_passed": true,
      "error": null,
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'U'\n  and cd_education_status = 'College'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Unknown'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('CO', 'NC', 'TX')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'NY', 'TX')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('IA', 'IL', 'NC')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Materialize filtered store_sales rows (with date_dim join) and filtered dimensions into separate CTEs, then join CTEs explicitly to reduce nested loop input size."
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "WIN",
      "speedup": 1.1,
      "semantic_passed": true,
      "error": null,
      "original_ms": 1000.5,
      "patch_ms": 906.5,
      "output_sql": "SELECT MIN(ss_quantity), MIN(ss_ext_sales_price), MIN(ss_ext_wholesale_cost), MIN(ss_ext_wholesale_cost) FROM store_sales INNER JOIN store ON s_store_sk = ss_store_sk INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk INNER JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk INNER JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk INNER JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE d_year = 2001 AND ((cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (cd_marital_status = 'U' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (cd_marital_status = 'S' AND cd_education_status = 'Unknown' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((ca_country = 'United States' AND ca_state IN ('CO', 'NC', 'TX') AND ss_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'NY', 'TX') AND ss_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('IA', 'IL', 'NC') AND ss_net_profit BETWEEN 50 AND 250));",
      "has_explain": true,
      "description": null
    }
  ],
  "explains": {
    "p01": "Aggregate  (rows=1, time=2624.893)\n  Gather  (rows=1, time=2624.876)\n    Aggregate  (rows=1, time=2623.728)\n      Nested Loop  (rows=85, time=2623.118)\n        Nested Loop  (rows=3238, time=2531.101)\n          Hash Join  (rows=18741, time=2155.043)\n            Hash Join  (rows=18795, time=2144.561)\n              Nested Loop  (rows=168134, time=2069.977)\n                Index Only Scan on date_dim  (rows=365, time=5.227)\n                Index Only Scan on store_sales  (rows=461, time=5.611)\n     ",
    "p04": "Aggregate  (rows=1, time=2583.686)\n  Gather  (rows=1, time=2583.665)\n    Aggregate  (rows=1, time=2582.358)\n      Nested Loop  (rows=85, time=2581.756)\n        Nested Loop  (rows=3238, time=2492.623)\n          Hash Join  (rows=18741, time=2127.596)\n            Hash Join  (rows=18795, time=2117.105)\n              Nested Loop  (rows=168134, time=2041.492)\n                Index Only Scan on date_dim  (rows=365, time=7.191)\n                Index Only Scan on store_sales  (rows=461, time=5.527)\n     ",
    "compile_p1": "Aggregate  (rows=1, time=910.129)\n  Gather  (rows=2, time=910.121)\n    Aggregate  (rows=1, time=868.661)\n      Nested Loop  (rows=42, time=868.516)\n        Nested Loop  (rows=1619, time=845.7)\n          Hash Join  (rows=9370, time=761.072)\n            Hash Join  (rows=9398, time=758.108)\n              Nested Loop  (rows=84067, time=739.03)\n                Index Only Scan on date_dim  (rows=182, time=1.97)\n                Index Only Scan on store_sales  (rows=461, time=4.005)\n              Hash  "
  }
}