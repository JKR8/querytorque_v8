{
  "probe_id": "p01",
  "transform_id": "date_cte_explicit_join",
  "family": "F",
  "dialect": "postgres",
  "hypothesis": "Convert comma-join syntax to explicit JOINs and isolate selective date-based subqueries into CTEs to reduce nested loop amplification and enable better hash join planning.",
  "reasoning_trace": [
    "FROM clause uses comma joins which are known weaknesses in Postgres planning",
    "WHERE contains correlated EXISTS with repeated dimension rescans",
    "Explicit JOINs with ON clauses will improve join order and selectivity estimation"
  ],
  "target_ir": "Explicit JOINs replacing comma syntax; correlated EXISTS preserved but isolated via CTEs where beneficial",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_from",
      "target": {"by_node_id": "S0"},
      "payload": {
        "from_sql": "customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cd.cd_demo_sk = c.c_current_cdemo_sk"
      }
    }
  ]
}