Worker Role: W3
Family: E
Transform: prefetch_customer_demographics
Status: OK

--- OUTPUT SQL ---
WITH filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics), filtered_customers AS (SELECT c_customer_id, c_first_name, c_last_name, c_current_cdemo_sk, c_current_addr_sk FROM customer), joined_customer_data AS (SELECT c.c_customer_id, c.c_first_name, c.c_last_name FROM filtered_customers AS c JOIN filtered_customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE ca.ca_city = 'Mount Vernon') SELECT c_customer_id AS customer_id, COALESCE(c_last_name, '') || ', ' || COALESCE(c_first_name, '') AS customername FROM joined_customer_data WHERE ib_lower_bound >= 40374 AND ib_upper_bound <= 90374 AND ib_income_band_sk = hd_income_band_sk AND hd_demo_sk = c_current_hdemo_sk AND sr_cdemo_sk = c_current_cdemo_sk ORDER BY c_customer_id LIMIT 100;