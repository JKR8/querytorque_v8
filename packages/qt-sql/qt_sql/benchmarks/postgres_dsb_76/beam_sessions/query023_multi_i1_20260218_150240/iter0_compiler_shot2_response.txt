```json
[
  {
    "plan_id": "compile_p1",
    "dialect": "postgres",
    "confidence": 0.75,
    "based_on": "p01,p02",
    "strategy": "Explicit join conversion with dimension prefetch to address comma-join weakness and CTE materialization fences.",
    "hypothesis": "All probes failed due to syntax errors, but evidence suggests comma-joins and late-applied dimension filters cause CTE materialization hotspots. Convert to explicit joins with selective dimension CTEs to enable predicate pushdown.",
    "expected_explain_delta": "CTE materialization reduced, nested loops replaced by hash joins with early dimension filtering.",
    "target_ir": "Replace comma joins with explicit INNER JOIN in frequent_ss_items and best_ss_customer CTEs, add selective dimension prefetch CTEs.",
    "tree": {
      "root_node_id": "final_select",
      "nodes": [
        {
          "node_id": "final_select",
          "parent_node_id": null,
          "sources": ["catalog_sales", "date_dim", "web_sales", "best_ss_customer", "frequent_ss_items"],
          "outputs": ["SUM(sales)"],
          "changed": false
        },
        {
          "node_id": "frequent_ss_items",
          "parent_node_id": "final_select",
          "sources": ["store_sales", "date_1998", "item_filtered"],
          "outputs": ["itemdesc", "item_sk", "solddate", "cnt"],
          "changed": true,
          "sql": "SELECT substring(i_item_desc,1,30) itemdesc, i_item_sk item_sk, d_date solddate, count(*) cnt FROM store_sales ss INNER JOIN date_1998 d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN item_filtered i ON ss.ss_item_sk = i.i_item_sk GROUP BY substring(i_item_desc,1,30), i_item_sk, d_date HAVING count(*) > 4"
        },
        {
          "node_id": "max_store_sales",
          "parent_node_id": "best_ss_customer",
          "sources": ["store_sales", "customer", "date_1998"],
          "outputs": ["tpcds_cmax"],
          "changed": true,
          "sql": "SELECT max(csales) tpcds_cmax FROM (SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) csales FROM store_sales ss INNER JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk INNER JOIN date_1998 d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY c_customer_sk) tmp1"
        },
        {
          "node_id": "best_ss_customer",
          "parent_node_id": "final_select",
          "sources": ["store_sales", "customer_filtered", "max_store_sales"],
          "outputs": ["c_customer_sk", "ssales"],
          "changed": true,
          "sql": "SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) ssales FROM store_sales ss INNER JOIN customer_filtered c ON ss.ss_customer_sk = c.c_customer_sk GROUP BY c_customer_sk HAVING sum(ss_quantity*ss_sales_price) > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)"
        },
        {
          "node_id": "date_1998",
          "parent_node_id": "final_select",
          "sources": ["date_dim"],
          "outputs": ["d_date_sk", "d_date"],
          "changed": true,
          "sql": "SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 1998"
        },
        {
          "node_id": "item_filtered",
          "parent_node_id": "final_select",
          "sources": ["item"],
          "outputs": ["i_item_sk", "i_item_desc"],
          "changed": true,
          "sql": "SELECT i_item_sk, i_item_desc FROM item WHERE i_manager_id BETWEEN 81 and 100 AND i_category IN ('Children', 'Men', 'Sports')"
        },
        {
          "node_id": "customer_filtered",
          "parent_node_id": "final_select",
          "sources": ["customer"],
          "outputs": ["c_customer_sk"],
          "changed": true,
          "sql": "SELECT c_customer_sk FROM customer WHERE c_birth_year BETWEEN 1934 AND 1940"
        }
      ]
    }
  },
  {
    "plan_id": "compile_p2",
    "dialect": "postgres",
    "confidence": 0.65,
    "based_on": "p03",
    "strategy": "Shared fact scan materialization to eliminate repeated store_sales scans in CTEs.",
    "hypothesis": "Probe p03 failed due to missing d_date column but hypothesis is valid: share filtered store_sales scan across CTEs to avoid repeated fact table access.",
    "expected_explain_delta": "Reduced store_sales scan count from 3 to 1, CTE computations become joins over materialized subset.",
    "target_ir": "Introduce filtered_store_sales CTE with all required columns, update dependent CTEs to use it.",
    "tree": {
      "root_node_id": "final_select",
      "nodes": [
        {
          "node_id": "final_select",
          "parent_node_id": null,
          "sources": ["catalog_sales", "date_dim", "web_sales", "best_ss_customer", "frequent_ss_items"],
          "outputs": ["SUM(sales)"],
          "changed": false
        },
        {
          "node_id": "filtered_store_sales",
          "parent_node_id": "final_select",
          "sources": ["store_sales", "date_dim"],
          "outputs": ["ss_item_sk", "ss_customer_sk", "ss_sold_date_sk", "ss_quantity", "ss_sales_price", "ss_wholesale_cost"],
          "changed": true,
          "sql": "SELECT ss_item_sk, ss_customer_sk, ss_sold_date_sk, ss_quantity, ss_sales_price, ss_wholesale_cost FROM store_sales ss INNER JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE d.d_year = 1998 AND ss.ss_wholesale_cost BETWEEN 11 AND 21"
        },
        {
          "node_id": "frequent_ss_items",
          "parent_node_id": "final_select",
          "sources": ["filtered_store_sales", "date_dim", "item"],
          "outputs": ["itemdesc", "item_sk", "solddate", "cnt"],
          "changed": true,
          "sql": "SELECT substring(i_item_desc,1,30) itemdesc, i_item_sk item_sk, d_date solddate, count(*) cnt FROM filtered_store_sales fss INNER JOIN date_dim d ON fss.ss_sold_date_sk = d.d_date_sk INNER JOIN item i ON fss.ss_item_sk = i.i_item_sk WHERE i.i_manager_id BETWEEN 81 and 100 AND i.i_category IN ('Children', 'Men', 'Sports') GROUP BY substring(i_item_desc,1,30), i_item_sk, d_date HAVING count(*) > 4"
        },
        {
          "node_id": "max_store_sales",
          "parent_node_id": "best_ss_customer",
          "sources": ["filtered_store_sales", "customer"],
          "outputs": ["tpcds_cmax"],
          "changed": true,
          "sql": "SELECT max(csales) tpcds_cmax FROM (SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) csales FROM filtered_store_sales fss INNER JOIN customer c ON fss.ss_customer_sk = c.c_customer_sk GROUP BY c_customer_sk) tmp1"
        },
        {
          "node_id": "best_ss_customer",
          "parent_node_id": "final_select",
          "sources": ["filtered_store_sales", "customer"],
          "outputs": ["c_customer_sk", "ssales"],
          "changed": true,
          "sql": "SELECT c_customer_sk, sum(ss_quantity*ss_sales_price) ssales FROM filtered_store_sales fss INNER JOIN customer c ON fss.ss_customer_sk = c.c_customer_sk WHERE c.c_birth_year BETWEEN 1934 AND 1940 GROUP BY c_customer_sk HAVING sum(ss_quantity*ss_sales_price) > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)"
        }
      ]
    }
  }
]
```