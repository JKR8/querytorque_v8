{
  "probe_id": "p01",
  "transform_id": "early_filter",
  "family": "A",
  "dialect": "postgres",
  "hypothesis": "Adding d_year filters directly in each UNION branch reduces base table scan volume and enables earlier filtering in the plan.",
  "reasoning_trace": [
    "Execution plan shows 20s Append node from scanning all years; filtering early will reduce I/O.",
    "Each UNION branch scans date_dim independently; pushing d_year filter into each reduces rows early."
  ],
  "target_ir": "Three UNION branches with 'AND d.d_year IN (1998,1999)' added to their WHERE clauses",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_where_predicate",
      "target": {"by_node_id": "S0"},
      "payload": {
        "expr_sql": "i_category='Children' AND cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND cr_reason_sk IN (8, 18, 20, 23, 41) AND d.d_year IN (1998,1999)"
      }
    },
    {
      "step_id": "s2",
      "op": "replace_where_predicate",
      "target": {"by_node_id": "S0"},
      "payload": {
        "expr_sql": "i_category='Children' AND ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND sr_reason_sk IN (8, 18, 20, 23, 41) AND d.d_year IN (1998,1999)"
      }
    },
    {
      "step_id": "s3",
      "op": "replace_where_predicate",
      "target": {"by_node_id": "S0"},
      "payload": {
        "expr_sql": "i_category='Children' AND ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND wr_reason_sk IN (8, 18, 20, 23, 41) AND d.d_year IN (1998,1999)"
      }
    }
  ]
}