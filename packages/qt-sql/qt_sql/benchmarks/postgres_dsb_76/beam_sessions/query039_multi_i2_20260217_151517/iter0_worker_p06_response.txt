{
  "probe_id": "p01",
  "transform_id": "materialize_cte",
  "family": "E",
  "dialect": "postgres",
  "hypothesis": "Adding MATERIALIZED to the CTE ensures its result is computed once and reused, avoiding repeated aggregation and filtering during self-join.",
  "reasoning_trace": [
    "CTE 'inv' performs expensive aggregation over 133M+ rows with multiple joins and filters.",
    "Self-join on CTE causes repeated execution or late pruning of d_moy.",
    "PostgreSQL benefits from explicit materialization to prevent re-computation."
  ],
  "target_ir": "CTE marked as MATERIALIZED; body logic unchanged; self-join preserved.",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_expr_subtree",
      "target": {"by_node_id": "S0", "by_anchor_hash": "ceb681f4fee117f7"},
      "payload": {
        "expr_sql": "CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1"
      }
    }
  ]
}