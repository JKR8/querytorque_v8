{
  "probe_id": "p01",
  "transform_id": "inner_join_conversion",
  "family": "F",
  "dialect": "postgres",
  "hypothesis": "Convert comma join to explicit INNER JOIN in main query to enable better join ordering and avoid nested loop due to weak cardinality estimation.",
  "reasoning_trace": [
    "Target comma join between inv1 and inv2 in FROM clause",
    "Preserve all join conditions and filters as specified in node contract",
    "Enable hash join path by rewriting comma join to explicit JOIN syntax"
  ],
  "target_ir": "Main query with explicit INNER JOIN on inv1, inv2 with preserved join conditions and filters",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_from",
      "target": {"by_node_id": "S0"},
      "payload": {
        "from_sql": "inv inv1 INNER JOIN inv inv2 ON inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk"
      }
    }
  ]
}