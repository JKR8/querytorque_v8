{
  "probe_id": "p01",
  "transform_id": "early_filter",
  "family": "A",
  "dialect": "postgres",
  "hypothesis": "Adding d_moy filter early in the CTE reduces inventory scan volume and avoids unnecessary aggregation work.",
  "reasoning_trace": [
    "CTE aggregates 133M+ rows from inventory without early d_moy filtering",
    "Self-join on CTE output forces full materialization before d_moy conditions apply",
    "Filtering d_moy IN (5,6) early reduces CTE size and improves downstream performance"
  ],
  "target_ir": "CTE with added d_moy filter in WHERE clause; main query unchanged",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_where_predicate",
      "target": {
        "by_node_id": "S0",
        "by_anchor_hash": "ceb681f4fee117f7"
      },
      "payload": {
        "expr_sql": "d_moy IN (5,6) AND d_year = 2002 AND i_category IN ('Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 61 AND inv_quantity_on_hand BETWEEN 791 AND 991 AND CASE mean WHEN 0 THEN 0 ELSE stdev/mean END > 1"
      }
    }
  ]
}