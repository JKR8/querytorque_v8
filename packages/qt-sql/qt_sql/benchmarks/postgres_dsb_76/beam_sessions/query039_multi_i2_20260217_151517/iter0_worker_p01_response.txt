{
  "probe_id": "p01",
  "transform_id": "date_cte_explicit_join",
  "family": "F",
  "dialect": "postgres",
  "hypothesis": "Convert comma joins in the CTE definition to explicit JOIN syntax to enable better join planning and row estimation in PostgreSQL.",
  "reasoning_trace": [
    "The innermost subquery in the CTE uses comma joins with no explicit ON conditions.",
    "PostgreSQL's planner struggles with row estimates on comma-joined tables without explicit JOIN syntax.",
    "Explicit JOINs will allow PostgreSQL to use hash joins instead of nested loops and improve predicate pushdown."
  ],
  "target_ir": "CTE with explicit JOINs in FROM clause; all original WHERE conditions preserved.",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_from",
      "target": {"by_node_id": "S0"},
      "payload": {
        "from_sql": "from inventory inv JOIN item i ON inv.inv_item_sk = i.i_item_sk JOIN warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk JOIN date_dim d ON inv.inv_date_sk = d.d_date_sk"
      }
    }
  ]
}