{
  "probe_id": "p01",
  "transform_id": "sf_sk_pushdown_multi_fact",
  "family": "A",
  "dialect": "postgres",
  "hypothesis": "Pushing d_date_sk range filter into inventory join condition enables index scan and avoids full table scan of 133M rows.",
  "reasoning_trace": [
    "Inventory table joined via comma join with date_dim; no explicit JOIN clause",
    "Filter on d_year=2002 is present but not pushed down to inv_date_sk",
    "PostgreSQL does not push predicates into comma joins effectively",
    "Adding explicit d_date_sk BETWEEN condition will enable index usage"
  ],
  "target_ir": "Explicit JOIN syntax with d_date_sk range in ON clause for inventory-date_dim join",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_from",
      "target": {"by_node_id": "S0"},
      "payload": {
        "from_sql": "(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stdev,mean, case mean when 0 then null else stdev/mean end cov from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean from inventory JOIN item ON inv_item_sk = i_item_sk JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk JOIN date_dim ON inv_date_sk = d_date_sk AND d_date_sk BETWEEN (SELECT min(d_date_sk) FROM date_dim WHERE d_year = 2002) AND (SELECT max(d_date_sk) FROM date_dim WHERE d_year = 2002) where d_year =2002 and i_category IN ('Shoes', 'Sports') and i_manager_id BETWEEN 42 and 61 and inv_quantity_on_hand between 791 and 991 group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo"
      }
    }
  ]
}