Worker Role: W3
Family: F
Transform: explicit_join_order
Status: OK

--- OUTPUT SQL ---
WITH filtered_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id BETWEEN 797 AND 996 OR i_category IN ('Men', 'Shoes', 'Sports')), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-01-29' AND CAST('1999-01-29' AS DATE) + INTERVAL '90 DAY') SELECT SUM(ws_ext_discount_amt) AS "Excess Discount Amount" FROM web_sales INNER JOIN filtered_items ON ws_item_sk = filtered_items.i_item_sk INNER JOIN filtered_dates ON ws_sold_date_sk = filtered_dates.d_date_sk WHERE ws_wholesale_cost BETWEEN 35 AND 55 AND ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM web_sales INNER JOIN filtered_dates ON ws_sold_date_sk = filtered_dates.d_date_sk WHERE ws_item_sk = filtered_items.i_item_sk AND ws_wholesale_cost BETWEEN 35 AND 55 AND ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01) ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;