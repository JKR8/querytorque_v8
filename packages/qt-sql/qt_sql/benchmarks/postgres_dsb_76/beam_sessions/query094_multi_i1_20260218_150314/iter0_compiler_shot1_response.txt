```json
{
  "plan_id": "compile_p1",
  "dialect": "postgres",
  "confidence": 0.72,
  "based_on": "p01",
  "strategy": "Convert comma joins to explicit INNER JOIN syntax to enable better join reordering, while preserving semi-join/anti-join optimizer patterns.",
  "hypothesis": "Only p01 showed improvement (1.05x) by converting comma joins to explicit joins; other CTE-based approaches regressed. The original plan shows sequential scan on web_returns (33,995 rows) is the largest hotspot, but no probe addressed it. This rewrite keeps EXISTS/NOT EXISTS intact to preserve PostgreSQL's semi-join optimization while allowing join reordering.",
  "expected_explain_delta": "Explicit join syntax may enable better join order selection; expect reduced nested loop iterations and same scan patterns.",
  "target_ir": "Update final_select to use explicit INNER JOIN with selective predicates in ON clauses.",
  "tree": {
    "root_node_id": "final_select",
    "nodes": [
      {
        "node_id": "final_select",
        "parent_node_id": null,
        "sources": [],
        "outputs": ["order count", "total shipping cost", "total net profit"],
        "changed": true,
        "sql": "SELECT COUNT(DISTINCT ws1.ws_order_number) AS \"order count\", SUM(ws1.ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws1.ws_net_profit) AS \"total net profit\" FROM web_sales ws1 INNER JOIN date_dim ON ws1.ws_ship_date_sk = date_dim.d_date_sk AND date_dim.d_date BETWEEN '2002-9-01' AND CAST('2002-9-01' AS DATE) + INTERVAL '60 day' INNER JOIN customer_address ON ws1.ws_ship_addr_sk = customer_address.ca_address_sk AND customer_address.ca_state IN ('CA','MI','OH','SD','TX','VA') INNER JOIN web_site ON ws1.ws_web_site_sk = web_site.web_site_sk AND web_site.web_gmt_offset >= -5 WHERE ws1.ws_list_price BETWEEN 237 AND 266 AND EXISTS (SELECT * FROM web_sales ws2 WHERE ws1.ws_order_number = ws2.ws_order_number AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) AND NOT EXISTS (SELECT * FROM web_returns wr1 WHERE ws1.ws_order_number = wr1.wr_order_number AND wr1.wr_reason_sk IN (7, 25, 26, 52, 69)) ORDER BY COUNT(DISTINCT ws1.ws_order_number) LIMIT 100"
      }
    ]
  }
}
```