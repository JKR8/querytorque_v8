```json
[
  {
    "family": "B",
    "transform": "shared_scan_decorrelate",
    "target_id": "t1",
    "relevance_score": 0.95,
    "hypothesis": "Correlated subquery re-computes state averages per outer row. Decorrelation via pre-aggregated state thresholds eliminates per-row execution.",
    "target_ir": "S0 [SELECT]\n  CTE: customer_total_return (unchanged)\n    FROM: catalog_returns, date_dim, customer_address\n    WHERE [c0335294749216b8]: cr_returned_date_sk = d_date_sk AND d_year = 2000 AND cr_returning_addr_sk = ca_address_sk\n    GROUP BY: cr_returning_customer_sk, ca_state\n  CTE: state_avg (new)\n    FROM: customer_total_return\n    GROUP BY: ctr_state\n    SELECT: ctr_state, AVG(ctr_total_return) AS avg_return\n  MAIN QUERY\n    FROM: customer_total_return ctr1\n      INNER JOIN state_avg sa ON ctr1.ctr_state = sa.ctr_state\n      , customer_address, customer\n    WHERE [modified]: ctr1.ctr_total_return > sa.avg_return * 1.2\n      AND ca_address_sk = c_current_addr_sk\n      AND ca_state = 'IA'\n      AND ctr1.ctr_customer_sk = c_customer_sk\n    ORDER BY: (unchained)",
    "recommended_examples": ["pg_shared_scan_decorrelate"]
  },
  {
    "family": "F",
    "transform": "explicit_join_restructure",
    "target_id": "t2",
    "relevance_score": 0.8,
    "hypothesis": "Implicit joins in CTE prevent optimal predicate pushdown. Explicit INNER JOIN structure enables better join order optimization for date_dim filter.",
    "target_ir": "S0 [SELECT]\n  CTE: customer_total_return (modified)\n    FROM: catalog_returns\n      INNER JOIN date_dim ON cr_returned_date_sk = d_date_sk\n      INNER JOIN customer_address ON cr_returning_addr_sk = ca_address_sk\n    WHERE: d_year = 2000\n    GROUP BY: cr_returning_customer_sk, ca_state\n  MAIN QUERY STRUCTURE UNCHANGED",
    "recommended_examples": ["pg_explicit_join_materialized"]
  }
]
```

## Analysis

**Chosen families**: [B, F]  
**Confidence**: High

- **Family B (Decorrelation)**: HIGH  
  The correlated subquery computing state averages forces per-row execution. Pre-aggregating thresholds eliminates correlation.

- **Family F (Join Transform)**: MEDIUM  
  Implicit joins in CTE may limit predicate pushdown for d_year=2000 filter. Explicit JOIN syntax helps optimize join order.

- **Family A (Early Filtering)**: LOW  
  Key filters (d_year=2000, ca_state='IA') are already present in CTE/MAIN WHERE. Minimal gain from further pushdown.

- **Family E (Materialization)**: LOW  
  CTE customer_total_return is referenced twice but computed once. No repeated scan optimization needed.

- **Family C/D**: NOT APPLICABLE  
  No aggregation ordering issues or set operations.

Primary bottleneck is correlation (B), secondary is join structure (F). Targets address these with structural rewrites.