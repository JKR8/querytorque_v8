{
  "probe_id": "p01",
  "transform_id": "or_to_union",
  "family": "D",
  "dialect": "postgres",
  "hypothesis": "Splitting the OR condition on different columns (i_manufact_id and i_manager_id) into UNION ALL branches may enable index-based access paths per branch, avoiding a full scan with filter.",
  "reasoning_trace": [
    "OR condition spans two different columns: i_manufact_id and i_manager_id",
    "PostgreSQL may not use indexes efficiently for cross-column OR filters",
    "UNION ALL allows each branch to be optimized independently with potential index use"
  ],
  "target_ir": "Two UNION ALL branches, each with a simplified WHERE predicate on a single column from item, joined with catalog_sales and date_dim",
  "steps": [
    {
      "step_id": "s1",
      "op": "replace_body",
      "target": {"by_node_id": "S0"},
      "payload": {
        "sql_fragment": "(SELECT SUM(cs_ext_discount_amt) AS \"excess discount amount\" FROM catalog_sales, item, date_dim WHERE i_manufact_id IN (184, 307, 365, 560, 681) AND i_item_sk = cs_item_sk AND d_date BETWEEN '2001-02-23' AND cast('2001-02-23' as date) + interval '90 day' AND d_date_sk = cs_sold_date_sk AND cs_ext_discount_amt > (SELECT 1.3 * avg(cs_ext_discount_amt) FROM catalog_sales, date_dim WHERE cs_item_sk = i_item_sk AND d_date BETWEEN '2001-02-23' AND cast('2001-02-23' as date) + interval '90 day' AND d_date_sk = cs_sold_date_sk AND cs_list_price BETWEEN 115 AND 144 AND cs_sales_price / cs_list_price BETWEEN 21 * 0.01 AND 41 * 0.01)) UNION ALL (SELECT SUM(cs_ext_discount_amt) AS \"excess discount amount\" FROM catalog_sales, item, date_dim WHERE i_manager_id BETWEEN 42 AND 71 AND i_item_sk = cs_item_sk AND d_date BETWEEN '2001-02-23' AND cast('2001-02-23' as date) + interval '90 day' AND d_date_sk = cs_sold_date_sk AND cs_ext_discount_amt > (SELECT 1.3 * avg(cs_ext_discount_amt) FROM catalog_sales, date_dim WHERE cs_item_sk = i_item_sk AND d_date BETWEEN '2001-02-23' AND cast('2001-02-23' as date) + interval '90 day' AND d_date_sk = cs_sold_date_sk AND cs_list_price BETWEEN 115 AND 144 AND cs_sales_price / cs_list_price BETWEEN 21 * 0.01 AND 41 * 0.01))"
      }
    }
  ]
}