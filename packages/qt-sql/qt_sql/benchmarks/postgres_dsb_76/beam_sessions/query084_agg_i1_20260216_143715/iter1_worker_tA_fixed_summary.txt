Worker Role: W4
Family: A
Transform: predicate_pushback_cte_fixed
Status: OK

--- OUTPUT SQL ---
WITH filtered_customers AS (SELECT c_customer_id, c_first_name, c_last_name, c_current_addr_sk FROM customer WHERE c_current_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Jackson')), income_filtered AS (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 23567 AND ib_upper_bound <= 23567 + 50000) SELECT c_customer_id AS customer_id, COALESCE(c_last_name, '') || ', ' || COALESCE(c_first_name, '') AS customername FROM filtered_customers JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk JOIN income_filtered ON ib_income_band_sk = hd_income_band_sk JOIN store_returns ON sr_cdemo_sk = cd_demo_sk WHERE ca_city = 'Jackson' AND ib_lower_bound >= 23567 AND ib_upper_bound <= 23567 + 50000 ORDER BY c_customer_id LIMIT 100;