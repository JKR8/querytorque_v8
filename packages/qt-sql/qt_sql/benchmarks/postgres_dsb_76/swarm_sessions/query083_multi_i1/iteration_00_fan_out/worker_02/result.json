{
  "worker_id": 2,
  "strategy": "pg_self_join_decomposition",
  "examples_used": [
    "pg_self_join_decomposition",
    "shared_dimension_multi_channel"
  ],
  "optimized_sql": "with sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n\twhere d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  where d_date in ('2002-02-26','2002-05-03','2002-08-19','2002-11-18')))\n and   sr_returned_date_sk   = d_date_sk\n and i_category IN ('Home', 'Men')\n and i_manager_id BETWEEN 8 and 17\n and sr_return_amt / sr_return_quantity between 237 and 266\n and sr_reason_sk in (6, 7, 25, 45, 51)\ngroup by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  \t  where d_date in ('2002-02-26','2002-05-03','2002-08-19','2002-11-18')))\n and   cr_returned_date_sk   = d_date_sk\n and i_category IN ('Home', 'Men')\n and i_manager_id BETWEEN 8 and 17\n and cr_return_amount / cr_return_quantity between 237 and 266\n and cr_reason_sk in (6, 7, 25, 45, 51)\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t\t\t  where d_date in ('2002-02-26','2002-05-03','2002-08-19','2002-11-18')))\n and   wr_returned_date_sk   = d_date_sk\n and i_category IN ('Home', 'Men')\n and i_manager_id BETWEEN 8 and 17\n and wr_return_amt / wr_return_quantity between 237 and 266\n and wr_reason_sk in (6, 7, 25, 45, 51)\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id\n order by sr_items.item_id\n         ,sr_item_qty\n limit 100;",
  "speedup": 1.0042326930123309,
  "status": "NEUTRAL",
  "transforms": [],
  "hint": "pg_self_join_decomposition: Apply the pattern of materializing the shared fact+d",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}