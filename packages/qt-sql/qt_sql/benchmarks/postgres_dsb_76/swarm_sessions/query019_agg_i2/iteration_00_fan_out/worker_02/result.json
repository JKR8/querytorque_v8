{
  "worker_id": 2,
  "strategy": "late_attribute_binding_defer_zip",
  "examples_used": [
    "dimension_cte_isolate",
    "early_filter_decorrelate",
    "pg_self_join_decomposition"
  ],
  "optimized_sql": "WITH filtered_fact AS (SELECT ss_ext_sales_price, i_brand_id, i_brand, i_manufact_id, i_manufact, c_current_addr_sk, ss_store_sk FROM store_sales INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk AND d_year = 1999 AND d_moy = 2 INNER JOIN item ON ss_item_sk = i_item_sk AND i_category = 'Shoes' INNER JOIN customer ON ss_customer_sk = c_customer_sk AND c_birth_month = 2 WHERE ss_wholesale_cost BETWEEN 76 AND 96), early_aggregation AS (SELECT i_brand_id, i_brand, i_manufact_id, i_manufact, c_current_addr_sk, ss_store_sk, SUM(ss_ext_sales_price) AS ext_price FROM filtered_fact GROUP BY i_brand_id, i_brand, i_manufact_id, i_manufact, c_current_addr_sk, ss_store_sk), late_zip_join AS (SELECT agg.i_brand_id, agg.i_brand, agg.i_manufact_id, agg.i_manufact, agg.ext_price FROM early_aggregation agg INNER JOIN customer_address ON agg.c_current_addr_sk = ca_address_sk AND ca_state = 'KS' INNER JOIN store ON agg.ss_store_sk = s_store_sk WHERE substring(ca_zip,1,5) <> substring(s_zip,1,5)) SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ext_price) AS ext_price FROM late_zip_join GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100",
  "speedup": 1.0475868188308057,
  "status": "NEUTRAL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "dimension_cte_isolate: Apply filtering dimensions early (date, item, customer) a",
  "error_message": "INTERFACE: [early_aggregation] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [filtered_fact]? [filtered_fact] only provides ['c_current_addr_sk', 'i_brand', 'i_brand_id', 'i_manufact', 'i_manufact_id', 'ss_ext_sales_price', 'ss_store_sk'] | INTERFACE: [early_aggregation] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [filtered_fact]? [filtered_fact] only provides ['c_current_addr_sk', 'i_brand', 'i_brand_id', 'i_manufact', 'i_manufact_id', 'ss_ext_sales_price', 'ss_store_sk'] | INTERFACE: [early_aggregation] uses \"i_manufact_id\" \u2014 did you mean \"i_manufact\" from [filtered_fact]? [filtered_fact] only provides ['c_current_addr_sk', 'i_brand', 'i_brand_id', 'i_manufact', 'i_manufact_id', 'ss_ext_sales_price', 'ss_store_sk'] | INTERFACE: [early_aggregation] uses \"i_manufact\" \u2014 did you mean \"i_manufact_id\" from [filtered_fact]? [filtered_fact] only provides ['c_current_addr_sk', 'i_brand', 'i_brand_id', 'i_manufact', 'i_manufact_id', 'ss_ext_sales_price', 'ss_store_sk']",
  "error_messages": [
    "INTERFACE: [early_aggregation] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [filtered_fact]? [filtered_fact] only provides ['c_current_addr_sk', 'i_brand', 'i_brand_id', 'i_manufact', 'i_manufact_id', 'ss_ext_sales_price', 'ss_store_sk']",
    "INTERFACE: [early_aggregation] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [filtered_fact]? [filtered_fact] only provides ['c_current_addr_sk', 'i_brand', 'i_brand_id', 'i_manufact', 'i_manufact_id', 'ss_ext_sales_price', 'ss_store_sk']",
    "INTERFACE: [early_aggregation] uses \"i_manufact_id\" \u2014 did you mean \"i_manufact\" from [filtered_fact]? [filtered_fact] only provides ['c_current_addr_sk', 'i_brand', 'i_brand_id', 'i_manufact', 'i_manufact_id', 'ss_ext_sales_price', 'ss_store_sk']",
    "INTERFACE: [early_aggregation] uses \"i_manufact\" \u2014 did you mean \"i_manufact_id\" from [filtered_fact]? [filtered_fact] only provides ['c_current_addr_sk', 'i_brand', 'i_brand_id', 'i_manufact', 'i_manufact_id', 'ss_ext_sales_price', 'ss_store_sk']"
  ],
  "error_category": null,
  "set_local_config": {
    "params": {
      "work_mem": "64MB",
      "max_parallel_workers_per_gather": "2",
      "from_collapse_limit": "1",
      "join_collapse_limit": "1"
    },
    "commands": [
      "SET LOCAL from_collapse_limit = '1'",
      "SET LOCAL join_collapse_limit = '1'",
      "SET LOCAL max_parallel_workers_per_gather = '2'",
      "SET LOCAL work_mem = '64MB'"
    ],
    "config_speedup": 1.0475868188308057,
    "rewrite_only_speedup": 0.9916381330155526
  }
}