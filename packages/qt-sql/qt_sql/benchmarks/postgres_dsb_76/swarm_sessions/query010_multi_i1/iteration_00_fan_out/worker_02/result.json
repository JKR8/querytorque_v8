{
  "worker_id": 2,
  "strategy": "shared_dimension_materialization",
  "examples_used": [
    "pg_self_join_decomposition",
    "pg_dimension_prefetch_star"
  ],
  "optimized_sql": "WITH filtered_dimensions_cte AS (SELECT d.d_date_sk, i.i_item_sk FROM date_dim d CROSS JOIN item i WHERE d.d_year = 1999 AND d.d_moy BETWEEN 8 AND 11 AND i.i_category IN ('Children', 'Electronics', 'Music') AND i.i_manager_id BETWEEN 66 AND 75), store_sales_join AS (SELECT DISTINCT ss.ss_customer_sk FROM store_sales ss JOIN filtered_dimensions_cte f ON ss.ss_sold_date_sk = f.d_date_sk AND ss.ss_item_sk = f.i_item_sk WHERE ss.ss_list_price > 0 AND ss.ss_sales_price / ss.ss_list_price BETWEEN 20 * 0.01 AND 30 * 0.01), web_sales_join AS (SELECT DISTINCT ws.ws_bill_customer_sk FROM web_sales ws JOIN filtered_dimensions_cte f ON ws.ws_sold_date_sk = f.d_date_sk AND ws.ws_item_sk = f.i_item_sk WHERE ws.ws_list_price > 0 AND ws.ws_sales_price / ws.ws_list_price BETWEEN 20 * 0.01 AND 30 * 0.01), catalog_sales_join AS (SELECT DISTINCT cs.cs_ship_customer_sk FROM catalog_sales cs JOIN filtered_dimensions_cte f ON cs.cs_sold_date_sk = f.d_date_sk AND cs.cs_item_sk = f.i_item_sk WHERE cs.cs_list_price > 0 AND cs.cs_sales_price / cs.cs_list_price BETWEEN 20 * 0.01 AND 30 * 0.01), customer_filter AS (SELECT c.c_current_addr_sk, c.c_current_cdemo_sk FROM customer c JOIN store_sales_join ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN web_sales_join ws ON c.c_customer_sk = ws.ws_bill_customer_sk LEFT JOIN catalog_sales_join cs ON c.c_customer_sk = cs.cs_ship_customer_sk WHERE c.c_birth_month IN (1, 5) AND (ws.ws_bill_customer_sk IS NOT NULL OR cs.cs_ship_customer_sk IS NOT NULL)), address_filter AS (SELECT cf.c_current_cdemo_sk FROM customer_filter cf JOIN customer_address ca ON cf.c_current_addr_sk = ca.ca_address_sk WHERE ca.ca_county IN ('Grays Harbor County', 'Kootenai County', 'Pike County', 'Thomas County', 'Uinta County')), demographics_filter AS (SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating, cd.cd_dep_count, cd.cd_dep_employed_count, cd.cd_dep_college_count FROM address_filter af JOIN customer_demographics cd ON af.c_current_cdemo_sk = cd.cd_demo_sk WHERE cd.cd_marital_status IN ('U', 'U', 'M') AND cd.cd_education_status IN ('College', 'Primary', '2 yr Degree') AND cd.cd_gender = 'M') SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM demographics_filter GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",
  "speedup": 0.0,
  "status": "REGRESSION",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- pg_self_join_decomposition: Apply shared materialization of date_dim and item ",
  "error_message": "DID_NOT_FINISH: slower than original",
  "error_messages": [
    "DID_NOT_FINISH: slower than original"
  ],
  "error_category": null
}