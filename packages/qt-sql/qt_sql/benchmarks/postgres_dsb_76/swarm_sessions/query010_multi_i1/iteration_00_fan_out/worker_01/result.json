{
  "worker_id": 1,
  "strategy": "explicit_join_dimension_prefetch",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH date_filter_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy BETWEEN 8 AND 11), item_filter_cte AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Electronics', 'Music') AND i_manager_id BETWEEN 66 AND 75), store_sales_subquery AS (SELECT DISTINCT ss_customer_sk FROM store_sales INNER JOIN date_filter_cte ON ss_sold_date_sk = d_date_sk INNER JOIN item_filter_cte ON ss_item_sk = i_item_sk WHERE ss_sales_price / ss_list_price BETWEEN 20 * 0.01 AND 30 * 0.01), web_sales_subquery AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales INNER JOIN date_filter_cte ON ws_sold_date_sk = d_date_sk INNER JOIN item_filter_cte ON ws_item_sk = i_item_sk WHERE ws_sales_price / ws_list_price BETWEEN 20 * 0.01 AND 30 * 0.01), catalog_sales_subquery AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales INNER JOIN date_filter_cte ON cs_sold_date_sk = d_date_sk INNER JOIN item_filter_cte ON cs_item_sk = i_item_sk WHERE cs_sales_price / cs_list_price BETWEEN 20 * 0.01 AND 30 * 0.01), customer_join AS (SELECT c.c_current_addr_sk, c.c_current_cdemo_sk, c.c_customer_sk FROM customer c INNER JOIN store_sales_subquery ON c.c_customer_sk = ss_customer_sk LEFT JOIN web_sales_subquery ON c.c_customer_sk = ws_bill_customer_sk LEFT JOIN catalog_sales_subquery ON c.c_customer_sk = cs_ship_customer_sk WHERE c.c_birth_month IN (1, 5) AND (ws_bill_customer_sk IS NOT NULL OR cs_ship_customer_sk IS NOT NULL)), address_join AS (SELECT cj.c_current_cdemo_sk, cj.c_customer_sk FROM customer_join cj INNER JOIN customer_address ca ON cj.c_current_addr_sk = ca.ca_address_sk WHERE ca.ca_county IN ('Grays Harbor County', 'Kootenai County', 'Pike County', 'Thomas County', 'Uinta County')), demographics_join AS (SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating, cd.cd_dep_count, cd.cd_dep_employed_count, cd.cd_dep_college_count FROM address_join aj INNER JOIN customer_demographics cd ON aj.c_current_cdemo_sk = cd.cd_demo_sk WHERE cd.cd_marital_status IN ('U', 'U', 'M') AND cd.cd_education_status IN ('College', 'Primary', '2 yr Degree') AND cd.cd_gender = 'M') SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM demographics_join GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",
  "speedup": 2.0029148953088534,
  "status": "WIN",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply pre-filtering of date_dim and item into CTEs",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "set_local_config": {
    "params": {
      "max_parallel_workers_per_gather": "2",
      "work_mem": "64MB",
      "from_collapse_limit": "8",
      "join_collapse_limit": "8"
    },
    "commands": [
      "SET LOCAL from_collapse_limit = '8'",
      "SET LOCAL join_collapse_limit = '8'",
      "SET LOCAL max_parallel_workers_per_gather = '2'",
      "SET LOCAL work_mem = '64MB'"
    ],
    "config_speedup": 1.3797304233825436,
    "rewrite_only_speedup": 2.0029148953088534
  }
}