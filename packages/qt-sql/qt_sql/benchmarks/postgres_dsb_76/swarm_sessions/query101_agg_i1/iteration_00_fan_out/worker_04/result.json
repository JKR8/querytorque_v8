{
  "worker_id": 4,
  "strategy": "explicit_joins_materialized_dims",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join",
    "pg_materialized_dimension_fact_prefilter"
  ],
  "optimized_sql": "WITH dim_date1 AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 1998), dim_date2 AS (SELECT d_date_sk, d_date FROM date_dim), dim_item AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Electronics', 'Music')), dim_customer AS (SELECT c.c_customer_sk, c.c_first_name, c.c_last_name FROM customer c INNER JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk INNER JOIN household_demographics hd ON c.c_current_hdemo_sk = hd.hd_demo_sk WHERE ca.ca_state IN ('AR', 'CO', 'NC', 'NY', 'TX') AND hd.hd_income_band_sk BETWEEN 7 AND 13 AND hd.hd_buy_potential = '0-500'), fact_store_returns AS (SELECT sr.sr_ticket_number, sr.sr_item_sk, sr.sr_returned_date_sk FROM store_returns sr INNER JOIN dim_date1 ON sr.sr_returned_date_sk = dim_date1.d_date_sk INNER JOIN dim_item ON sr.sr_item_sk = dim_item.i_item_sk), fact_store_sales AS (SELECT ss.ss_customer_sk, ss.ss_item_sk, ss.ss_ticket_number FROM store_sales ss INNER JOIN fact_store_returns ON ss.ss_ticket_number = fact_store_returns.sr_ticket_number AND ss.ss_item_sk = fact_store_returns.sr_item_sk INNER JOIN dim_item ON ss.ss_item_sk = dim_item.i_item_sk INNER JOIN dim_customer ON ss.ss_customer_sk = dim_customer.c_customer_sk WHERE ss.ss_sales_price / ss.ss_list_price BETWEEN 35 * 0.01 AND 55 * 0.01), fact_web_sales AS (SELECT ws.ws_bill_customer_sk, ws.ws_item_sk, ws.ws_sold_date_sk FROM web_sales ws INNER JOIN fact_store_returns ON ws.ws_item_sk = fact_store_returns.sr_item_sk INNER JOIN dim_item ON ws.ws_item_sk = dim_item.i_item_sk INNER JOIN dim_date2 ON ws.ws_sold_date_sk = dim_date2.d_date_sk), fact_web_sales_join AS (SELECT fact_store_sales.ss_customer_sk, dim_customer.c_first_name, dim_customer.c_last_name FROM fact_store_sales INNER JOIN fact_web_sales ON fact_store_sales.ss_customer_sk = fact_web_sales.ws_bill_customer_sk AND fact_store_sales.ss_item_sk = fact_web_sales.ws_item_sk INNER JOIN dim_customer ON fact_store_sales.ss_customer_sk = dim_customer.c_customer_sk), date_window_filter AS (SELECT fact_web_sales_join.ss_customer_sk AS c_customer_sk, fact_web_sales_join.c_first_name, fact_web_sales_join.c_last_name, COUNT(*) AS cnt FROM fact_web_sales_join INNER JOIN fact_store_returns ON fact_store_returns.sr_item_sk = (SELECT ws_item_sk FROM fact_web_sales WHERE ws_bill_customer_sk = fact_web_sales_join.ss_customer_sk LIMIT 1) INNER JOIN dim_date1 ON fact_store_returns.sr_returned_date_sk = dim_date1.d_date_sk INNER JOIN fact_web_sales ON fact_web_sales.ws_bill_customer_sk = fact_web_sales_join.ss_customer_sk INNER JOIN dim_date2 ON fact_web_sales.ws_sold_date_sk = dim_date2.d_date_sk WHERE dim_date2.d_date BETWEEN dim_date1.d_date AND (dim_date1.d_date + INTERVAL '90 DAY') GROUP BY fact_web_sales_join.ss_customer_sk, fact_web_sales_join.c_first_name, fact_web_sales_join.c_last_name) SELECT c_customer_sk, c_first_name, c_last_name, cnt FROM date_window_filter ORDER BY cnt",
  "speedup": 0.0,
  "status": "REGRESSION",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "pg_dimension_prefetch_star: Apply pre-filtering of all dimensions into MATERIALI",
  "error_message": "DID_NOT_FINISH: slower than original",
  "error_messages": [
    "DID_NOT_FINISH: slower than original"
  ],
  "error_category": null,
  "exploratory": true
}