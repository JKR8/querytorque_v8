{
  "worker_id": 2,
  "strategy": "non_equi_date_prefilter",
  "examples_used": [
    "pg_materialized_dimension_fact_prefilter",
    "non_equi_join_input_blindness"
  ],
  "optimized_sql": "WITH date_pairs AS (SELECT d1.d_date_sk AS d1_date_sk, d1.d_date AS d1_date, d2.d_date_sk AS d2_date_sk FROM date_dim d1 INNER JOIN date_dim d2 ON d2.d_date BETWEEN d1.d_date AND (d1.d_date + INTERVAL '90 DAY') WHERE d1.d_year = 1998), filtered_item AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Electronics', 'Music')), store_returns_with_date AS (SELECT sr_ticket_number, sr_item_sk, d2_date_sk FROM store_returns INNER JOIN date_pairs ON sr_returned_date_sk = d1_date_sk), store_returns_with_item AS (SELECT sr_ticket_number, sr_item_sk, d2_date_sk FROM store_returns_with_date INNER JOIN filtered_item ON sr_item_sk = i_item_sk), store_sales_with_item AS (SELECT ss_ticket_number, ss_item_sk, ss_customer_sk FROM store_sales INNER JOIN filtered_item ON ss_item_sk = i_item_sk WHERE ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 55 * 0.01), store_sales_joined AS (SELECT ss_customer_sk, ss_item_sk, d2_date_sk FROM store_sales_with_item INNER JOIN store_returns_with_item ON ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk), web_sales_joined AS (SELECT ws_bill_customer_sk, ws_item_sk FROM web_sales INNER JOIN store_returns_with_date ON ws_item_sk = sr_item_sk INNER JOIN date_pairs ON ws_sold_date_sk = d2_date_sk AND store_returns_with_date.d2_date_sk = date_pairs.d2_date_sk), final_join AS (SELECT ss_customer_sk FROM store_sales_joined INNER JOIN web_sales_joined ON ss_customer_sk = ws_bill_customer_sk AND ss_item_sk = ws_item_sk), aggregation AS (SELECT c_customer_sk, c_first_name, c_last_name, COUNT(*) AS cnt FROM final_join INNER JOIN customer ON ss_customer_sk = c_customer_sk INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk INNER JOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk WHERE ca_state IN ('AR', 'CO', 'NC', 'NY', 'TX') AND hd_income_band_sk BETWEEN 7 AND 13 AND hd_buy_potential = '0-500' GROUP BY c_customer_sk, c_first_name, c_last_name) SELECT c_customer_sk, c_first_name, c_last_name, cnt FROM aggregation ORDER BY cnt",
  "speedup": 0.0,
  "status": "ERROR",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "pg_materialized_dimension_fact_prefilter: Apply staged reduction by pre-joining ",
  "error_message": "INTERFACE: [store_returns_with_date] uses \"d1_date_sk\" \u2014 did you mean \"d1_date\" from [date_pairs]? [date_pairs] only provides ['d1_date', 'd1_date_sk', 'd2_date_sk'] | column reference \"d2_date_sk\" is ambiguous\nLINE 1: ...tem_sk INNER JOIN date_pairs ON ws_sold_date_sk = d2_date_sk...\n                                                             ^\n",
  "error_messages": [
    "INTERFACE: [store_returns_with_date] uses \"d1_date_sk\" \u2014 did you mean \"d1_date\" from [date_pairs]? [date_pairs] only provides ['d1_date', 'd1_date_sk', 'd2_date_sk']",
    "column reference \"d2_date_sk\" is ambiguous\nLINE 1: ...tem_sk INNER JOIN date_pairs ON ws_sold_date_sk = d2_date_sk...\n                                                             ^\n"
  ],
  "error_category": "unknown"
}