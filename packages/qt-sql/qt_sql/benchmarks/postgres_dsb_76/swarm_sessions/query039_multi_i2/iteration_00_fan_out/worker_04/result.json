{
  "worker_id": 4,
  "strategy": "lateral_parallel_union",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_materialized_dimension_fact_prefilter",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH dim_date AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 2002 AND d_moy IN (5, 6)), dim_item AS (SELECT i_item_sk FROM item WHERE i_category IN ('Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 61), dim_warehouse AS (SELECT w_warehouse_sk, w_warehouse_name FROM warehouse), lateral_union_months AS (SELECT dim_warehouse.w_warehouse_sk, dim_item.i_item_sk, month_stats.d_moy, month_stats.mean, month_stats.stdev / month_stats.mean AS cov FROM dim_warehouse, dim_item, LATERAL (SELECT d_moy, STDDEV_SAMP(inv_quantity_on_hand) AS stdev, AVG(inv_quantity_on_hand) AS mean FROM inventory JOIN dim_date ON inv_date_sk = dim_date.d_date_sk WHERE inv_warehouse_sk = dim_warehouse.w_warehouse_sk AND inv_item_sk = dim_item.i_item_sk AND inv_quantity_on_hand BETWEEN 791 AND 991 GROUP BY d_moy HAVING CASE AVG(inv_quantity_on_hand) WHEN 0 THEN 0 ELSE STDDEV_SAMP(inv_quantity_on_hand)/AVG(inv_quantity_on_hand) END > 1) AS month_stats)\nSELECT m5.w_warehouse_sk, m5.i_item_sk, m5.d_moy, m5.mean, m5.cov, m6.w_warehouse_sk, m6.i_item_sk, m6.d_moy, m6.mean, m6.cov FROM lateral_union_months AS m5 INNER JOIN lateral_union_months AS m6 ON m5.w_warehouse_sk = m6.w_warehouse_sk AND m5.i_item_sk = m6.i_item_sk WHERE m5.d_moy = 5 AND m6.d_moy = 6 AND m5.cov > 1.5 ORDER BY m5.w_warehouse_sk, m5.i_item_sk, m5.d_moy, m5.mean, m5.cov, m6.d_moy, m6.mean, m6.cov",
  "speedup": 1.2165086961790574,
  "status": "WIN",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply dimension CTEs; ignore explicit JOIN syntax ",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}