{
  "worker_id": 3,
  "strategy": "early_filter_decorrelate",
  "examples_used": [
    "early_filter_decorrelate",
    "pg_materialized_dimension_fact_prefilter"
  ],
  "optimized_sql": "WITH transitive_filtered_returns AS (SELECT sr_customer_sk AS ctr_customer_sk,\n       sr_store_sk AS ctr_store_sk,\n       sr_reason_sk AS ctr_reason_sk,\n       SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return\nFROM store_returns sr\nJOIN date_dim ON sr_returned_date_sk = d_date_sk\nJOIN store ON s_store_sk = sr_store_sk\nJOIN customer ON c_customer_sk = sr_customer_sk\nJOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk\nWHERE d_year = 2000\n  AND sr_return_amt / sr_return_quantity BETWEEN 115 AND 174\n  AND s_state IN ('IA', 'KY', 'NE')\n  AND cd_marital_status IN ('S', 'S')\n  AND cd_education_status IN ('4 yr Degree', '4 yr Degree')\n  AND cd_gender = 'M'\n  AND c_birth_month = 4\n  AND c_birth_year BETWEEN 1987 AND 1993\nGROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk),\n     store_averages AS (SELECT ctr_store_sk,\n       AVG(ctr_total_return) * 1.2 AS store_threshold\nFROM transitive_filtered_returns\nGROUP BY ctr_store_sk),\n     dimension_joins AS (SELECT r.ctr_customer_sk,\n       r.ctr_store_sk,\n       r.ctr_reason_sk,\n       r.ctr_total_return\nFROM transitive_filtered_returns r\nJOIN store_averages s ON r.ctr_store_sk = s.ctr_store_sk\nWHERE r.ctr_total_return > s.store_threshold\n  AND r.ctr_reason_sk BETWEEN 17 AND 20)\nSELECT c_customer_id\nFROM dimension_joins d\nJOIN customer c ON d.ctr_customer_sk = c.c_customer_sk\nORDER BY c_customer_id\nLIMIT 100",
  "speedup": 18.351157947568165,
  "status": "WIN",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- early_filter_decorrelate: Push dimension filters into the CTE definition early",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}