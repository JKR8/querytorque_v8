{
  "worker_id": 3,
  "strategy": "comma_join_explicit_with_quarter_split",
  "examples_used": [
    "pg_date_cte_explicit_join",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH ss_q1 AS (SELECT ca_county, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk INNER JOIN customer_address ON ss_addr_sk = ca_address_sk INNER JOIN item ON ss_item_sk = i_item_sk WHERE i_color IN ('navajo','orchid') AND i_manager_id BETWEEN 8 AND 27 AND ss_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA','IL') AND d_qoy = 1 AND d_year = 1998 GROUP BY ca_county, d_year), ss_q2 AS (SELECT ca_county, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk INNER JOIN customer_address ON ss_addr_sk = ca_address_sk INNER JOIN item ON ss_item_sk = i_item_sk WHERE i_color IN ('navajo','orchid') AND i_manager_id BETWEEN 8 AND 27 AND ss_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA','IL') AND d_qoy = 2 AND d_year = 1998 GROUP BY ca_county, d_year), ss_q3 AS (SELECT ca_county, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk INNER JOIN customer_address ON ss_addr_sk = ca_address_sk INNER JOIN item ON ss_item_sk = i_item_sk WHERE i_color IN ('navajo','orchid') AND i_manager_id BETWEEN 8 AND 27 AND ss_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA','IL') AND d_qoy = 3 AND d_year = 1998 GROUP BY ca_county, d_year), ws_q1 AS (SELECT ca_county, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales INNER JOIN date_dim ON ws_sold_date_sk = d_date_sk INNER JOIN customer_address ON ws_bill_addr_sk = ca_address_sk INNER JOIN item ON ws_item_sk = i_item_sk WHERE i_color IN ('navajo','orchid') AND i_manager_id BETWEEN 8 AND 27 AND ws_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA','IL') AND d_qoy = 1 AND d_year = 1998 GROUP BY ca_county, d_year), ws_q2 AS (SELECT ca_county, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales INNER JOIN date_dim ON ws_sold_date_sk = d_date_sk INNER JOIN customer_address ON ws_bill_addr_sk = ca_address_sk INNER JOIN item ON ws_item_sk = i_item_sk WHERE i_color IN ('navajo','orchid') AND i_manager_id BETWEEN 8 AND 27 AND ws_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA','IL') AND d_qoy = 2 AND d_year = 1998 GROUP BY ca_county, d_year), ws_q3 AS (SELECT ca_county, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales INNER JOIN date_dim ON ws_sold_date_sk = d_date_sk INNER JOIN customer_address ON ws_bill_addr_sk = ca_address_sk INNER JOIN item ON ws_item_sk = i_item_sk WHERE i_color IN ('navajo','orchid') AND i_manager_id BETWEEN 8 AND 27 AND ws_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA','IL') AND d_qoy = 3 AND d_year = 1998 GROUP BY ca_county, d_year) SELECT ss_q1.ca_county, ss_q1.d_year, ws_q2.web_sales / ws_q1.web_sales AS web_q1_q2_increase, ss_q2.store_sales / ss_q1.store_sales AS store_q1_q2_increase, ws_q3.web_sales / ws_q2.web_sales AS web_q2_q3_increase, ss_q3.store_sales / ss_q2.store_sales AS store_q2_q3_increase FROM ss_q1, ss_q2, ss_q3, ws_q1, ws_q2, ws_q3 WHERE ss_q1.ca_county = ss_q2.ca_county AND ss_q2.ca_county = ss_q3.ca_county AND ss_q1.ca_county = ws_q1.ca_county AND ws_q1.ca_county = ws_q2.ca_county AND ws_q1.ca_county = ws_q3.ca_county AND CASE WHEN ws_q1.web_sales > 0 THEN ws_q2.web_sales / ws_q1.web_sales ELSE NULL END > CASE WHEN ss_q1.store_sales > 0 THEN ss_q2.store_sales / ss_q1.store_sales ELSE NULL END AND CASE WHEN ws_q2.web_sales > 0 THEN ws_q3.web_sales / ws_q2.web_sales ELSE NULL END > CASE WHEN ss_q2.store_sales > 0 THEN ss_q3.store_sales / ss_q2.store_sales ELSE NULL END ORDER BY ss_q1.d_year",
  "speedup": 0.16781736310034642,
  "status": "REGRESSION",
  "transforms": [
    "prefetch_fact_join"
  ],
  "hint": "- pg_date_cte_explicit_join: convert comma joins to explicit JOINs; pre-filter d",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}