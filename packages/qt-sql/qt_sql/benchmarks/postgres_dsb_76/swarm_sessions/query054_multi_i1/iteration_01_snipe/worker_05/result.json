{
  "worker_id": 5,
  "strategy": "retry_1",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_self_join_decomposition",
    "early_filter_decorrelate",
    "pg_materialized_dimension_fact_prefilter",
    "inline_decorrelate_materialized",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH filtered_item AS (SELECT i_item_sk FROM item WHERE i_category = 'Electronics' AND i_class = 'personal'), filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 1), filtered_customer AS (SELECT c_customer_sk, c_current_addr_sk FROM customer WHERE c_birth_year BETWEEN 1928 AND 1941), cs_or_ws_sales AS (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales WHERE cs_wholesale_cost BETWEEN 35 AND 65 UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk FROM web_sales WHERE ws_wholesale_cost BETWEEN 35 AND 65), my_customers AS (SELECT DISTINCT fc.c_customer_sk, fc.c_current_addr_sk FROM cs_or_ws_sales sales JOIN filtered_date fd ON sales.sold_date_sk = fd.d_date_sk JOIN filtered_item fi ON sales.item_sk = fi.i_item_sk JOIN filtered_customer fc ON sales.customer_sk = fc.c_customer_sk), date_range AS (SELECT d_month_seq + 1 AS month_start, d_month_seq + 3 AS month_end FROM date_dim WHERE d_year = 1998 AND d_moy = 1 LIMIT 1), my_revenue AS (SELECT mc.c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers mc JOIN store_sales ss ON mc.c_customer_sk = ss.ss_customer_sk JOIN customer_address ca ON mc.c_current_addr_sk = ca.ca_address_sk JOIN store s ON ca.ca_county = s.s_county AND ca.ca_state = s.s_state JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_wholesale_cost BETWEEN 35 AND 65 AND s.s_state IN ('AR','CO','IA','IL','KY','NC','NM','NY','PA','TX') AND d.d_month_seq BETWEEN (SELECT month_start FROM date_range) AND (SELECT month_end FROM date_range) GROUP BY mc.c_customer_sk), segments AS (SELECT CAST((revenue / 50) AS INT) AS segment FROM my_revenue) SELECT segment, COUNT(*) AS num_customers, segment * 50 AS segment_base FROM segments GROUP BY segment ORDER BY segment, num_customers LIMIT 100",
  "speedup": 0.05142369175990627,
  "status": "REGRESSION",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}