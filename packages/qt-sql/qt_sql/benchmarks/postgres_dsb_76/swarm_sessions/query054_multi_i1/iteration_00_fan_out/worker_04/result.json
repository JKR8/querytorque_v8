{
  "worker_id": 4,
  "strategy": "early_fact_filtering_with_dimension_prefetch",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "prefetch_fact_join",
    "star_join_prefetch"
  ],
  "optimized_sql": "WITH filtered_item AS (SELECT i_item_sk FROM item WHERE i_category = 'Electronics' AND i_class = 'personal'), filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 1), filtered_customer AS (SELECT c_customer_sk, c_current_addr_sk FROM customer WHERE c_birth_year BETWEEN 1928 AND 1941), filtered_catalog_sales AS (SELECT cs.cs_bill_customer_sk AS customer_sk, fc.c_current_addr_sk FROM catalog_sales cs INNER JOIN filtered_date fd ON cs.cs_sold_date_sk = fd.d_date_sk INNER JOIN filtered_item fi ON cs.cs_item_sk = fi.i_item_sk INNER JOIN filtered_customer fc ON cs.cs_bill_customer_sk = fc.c_customer_sk WHERE cs.cs_wholesale_cost BETWEEN 35 AND 65), filtered_web_sales AS (SELECT ws.ws_bill_customer_sk AS customer_sk, fc.c_current_addr_sk FROM web_sales ws INNER JOIN filtered_date fd ON ws.ws_sold_date_sk = fd.d_date_sk INNER JOIN filtered_item fi ON ws.ws_item_sk = fi.i_item_sk INNER JOIN filtered_customer fc ON ws.ws_bill_customer_sk = fc.c_customer_sk WHERE ws.ws_wholesale_cost BETWEEN 35 AND 65), union_all AS (SELECT customer_sk, c_current_addr_sk FROM filtered_catalog_sales UNION ALL SELECT customer_sk, c_current_addr_sk FROM filtered_web_sales), my_customers AS (SELECT DISTINCT customer_sk AS c_customer_sk, c_current_addr_sk FROM union_all), my_revenue AS (SELECT c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers mc INNER JOIN store_sales ss ON mc.c_customer_sk = ss.ss_customer_sk INNER JOIN customer_address ca ON mc.c_current_addr_sk = ca.ca_address_sk INNER JOIN store s ON ca.ca_county = s.s_county AND ca.ca_state = s.s_state INNER JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk WHERE ss.ss_wholesale_cost BETWEEN 35 AND 65 AND s.s_state IN ('AR','CO','IA','IL','KY','NC','NM','NY','PA','TX') AND d.d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 1) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 1) GROUP BY c_customer_sk), segments AS (SELECT CAST((revenue/50) AS INT) AS segment FROM my_revenue) SELECT segment, COUNT(*) AS num_customers, segment*50 AS segment_base FROM segments GROUP BY segment ORDER BY segment, num_customers LIMIT 100",
  "speedup": 0.5093523211909325,
  "status": "REGRESSION",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply pre-filtering dimension tables into CTEs. Al",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}