{
  "worker_id": 4,
  "strategy": "compound_prefetch_consolidation",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_self_join_decomposition",
    "inline_decorrelate_materialized"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998), filtered_item AS (SELECT i_item_sk, i_item_desc, i_manager_id, i_category FROM item WHERE i_manager_id BETWEEN 81 AND 100 AND i_category IN ('Children', 'Men', 'Sports')), filtered_customer AS (SELECT c_customer_sk, c_birth_year FROM customer WHERE c_birth_year BETWEEN 1934 AND 1940), consolidated_sales AS (SELECT ss.ss_item_sk, COALESCE(fi.i_item_desc, ss.i_item_desc) AS i_item_desc, d.d_date, ss.ss_customer_sk, COALESCE(c.c_birth_year, ss.c_birth_year) AS c_birth_year, ss.ss_wholesale_cost, ss.ss_quantity, ss.ss_sales_price, COALESCE(fi.i_manager_id, ss.i_manager_id) AS i_manager_id, COALESCE(fi.i_category, ss.i_category) AS i_category FROM store_sales ss INNER JOIN filtered_date fd ON ss.ss_sold_date_sk = fd.d_date_sk LEFT JOIN filtered_item fi ON ss.ss_item_sk = fi.i_item_sk LEFT JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk), frequent_ss_items AS (SELECT SUBSTRING(cs.i_item_desc FROM 1 FOR 30) AS itemdesc, cs.ss_item_sk AS item_sk, cs.d_date AS solddate, COUNT(*) AS cnt FROM consolidated_sales cs INNER JOIN filtered_item fi ON cs.ss_item_sk = fi.i_item_sk WHERE cs.i_manager_id BETWEEN 81 AND 100 AND cs.i_category IN ('Children', 'Men', 'Sports') GROUP BY SUBSTRING(cs.i_item_desc FROM 1 FOR 30), cs.ss_item_sk, cs.d_date HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT cs.ss_customer_sk, SUM(cs.ss_quantity * cs.ss_sales_price) AS csales FROM consolidated_sales cs INNER JOIN customer c ON cs.ss_customer_sk = c.c_customer_sk WHERE cs.ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY cs.ss_customer_sk) AS tmp1), threshold_value AS (SELECT tpcds_cmax * 95/100.0 AS threshold FROM max_store_sales), best_ss_customer AS (SELECT cs.ss_customer_sk AS c_customer_sk, SUM(cs.ss_quantity * cs.ss_sales_price) AS ssales FROM consolidated_sales cs INNER JOIN filtered_customer fc ON cs.ss_customer_sk = fc.c_customer_sk GROUP BY cs.ss_customer_sk HAVING SUM(cs.ss_quantity * cs.ss_sales_price) > (SELECT threshold FROM threshold_value)), filtered_date_oct AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 10) SELECT SUM(sales) FROM (SELECT cs.cs_quantity * cs.cs_list_price AS sales FROM catalog_sales cs INNER JOIN filtered_date_oct fd ON cs.cs_sold_date_sk = fd.d_date_sk WHERE cs.cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs.cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs.cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws.ws_quantity * ws.ws_list_price AS sales FROM web_sales ws INNER JOIN filtered_date_oct fd ON ws.ws_sold_date_sk = fd.d_date_sk WHERE ws.ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws.ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws.ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100",
  "speedup": 0.0,
  "status": "ERROR",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply pre-filtering of all dimensions into CTEs.\n-",
  "error_message": "Execution failed: column ss.i_item_desc does not exist\nLINE 1: ...S (SELECT ss.ss_item_sk, COALESCE(fi.i_item_desc, ss.i_item_...\n                                                             ^\nHINT:  Perhaps you meant to reference the column \"fi.i_item_desc\".\n",
  "error_messages": [
    "Execution failed: column ss.i_item_desc does not exist\nLINE 1: ...S (SELECT ss.ss_item_sk, COALESCE(fi.i_item_desc, ss.i_item_...\n                                                             ^\nHINT:  Perhaps you meant to reference the column \"fi.i_item_desc\".\n"
  ],
  "error_category": "execution",
  "exploratory": true
}