{
  "worker_id": 2,
  "strategy": "scan_consolidation_pivot",
  "examples_used": [
    "pg_self_join_decomposition",
    "single_pass_aggregation"
  ],
  "optimized_sql": "WITH consolidated_store_sales AS (SELECT ss_item_sk, i_item_desc, d_date, ss_customer_sk, c_birth_year, ss_wholesale_cost, ss_quantity, ss_sales_price, d_date_sk, i_manager_id, i_category FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk LEFT JOIN customer ON ss_customer_sk = c_customer_sk WHERE d_year = 1998), frequent_ss_items AS (SELECT SUBSTRING(i_item_desc FROM 1 FOR 30) AS itemdesc, ss_item_sk AS item_sk, d_date AS solddate, COUNT(*) AS cnt FROM consolidated_store_sales WHERE i_manager_id BETWEEN 81 AND 100 AND i_category IN ('Children', 'Men', 'Sports') GROUP BY SUBSTRING(i_item_desc FROM 1 FOR 30), ss_item_sk, d_date HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT ss_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM consolidated_store_sales WHERE ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY ss_customer_sk) tmp1), best_ss_customer AS (SELECT ss_customer_sk AS c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM consolidated_store_sales WHERE c_birth_year BETWEEN 1934 AND 1940 GROUP BY ss_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) tmp2 LIMIT 100",
  "speedup": 0.6463139415758822,
  "status": "REGRESSION",
  "transforms": [
    "prefetch_fact_join"
  ],
  "hint": "- pg_self_join_decomposition: Apply single materialized scan of store_sales+date",
  "error_message": "INTERFACE: [frequent_ss_items] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [consolidated_store_sales]? [consolidated_store_sales] only provides ['c_birth_year', 'd_date', 'd_date_sk', 'i_category', 'i_item_desc', 'i_manager_id', 'ss_customer_sk', 'ss_item_sk', 'ss_quantity', 'ss_sales_price', 'ss_wholesale_cost']",
  "error_messages": [
    "INTERFACE: [frequent_ss_items] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [consolidated_store_sales]? [consolidated_store_sales] only provides ['c_birth_year', 'd_date', 'd_date_sk', 'i_category', 'i_item_desc', 'i_manager_id', 'ss_customer_sk', 'ss_item_sk', 'ss_quantity', 'ss_sales_price', 'ss_wholesale_cost']"
  ],
  "error_category": null
}