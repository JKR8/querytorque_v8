{
  "worker_id": 1,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_date, d_year, d_moy FROM date_dim WHERE d_year = 1998), filtered_item AS (SELECT i_item_sk, i_item_desc FROM item WHERE i_manager_id BETWEEN 81 AND 100 AND i_category IN ('Children', 'Men', 'Sports')), filtered_customer AS (SELECT c_customer_sk FROM customer WHERE c_birth_year BETWEEN 1934 AND 1940), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM store_sales INNER JOIN filtered_date ON ss_sold_date_sk = d_date_sk INNER JOIN customer ON ss_customer_sk = c_customer_sk WHERE ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY c_customer_sk) AS tmp1), frequent_ss_items AS (SELECT SUBSTRING(i_item_desc FROM 1 FOR 30) AS itemdesc, i_item_sk AS item_sk, d_date AS solddate, COUNT(*) AS cnt FROM store_sales INNER JOIN filtered_date ON ss_sold_date_sk = d_date_sk INNER JOIN filtered_item ON ss_item_sk = i_item_sk GROUP BY SUBSTRING(i_item_desc FROM 1 FOR 30), i_item_sk, d_date HAVING COUNT(*) > 4), best_ss_customer AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM store_sales INNER JOIN filtered_customer ON ss_customer_sk = c_customer_sk GROUP BY c_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales INNER JOIN filtered_date ON cs_sold_date_sk = d_date_sk AND d_moy = 10 WHERE cs_wholesale_cost BETWEEN 11 AND 21 AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales INNER JOIN filtered_date ON ws_sold_date_sk = d_date_sk AND d_moy = 10 WHERE ws_wholesale_cost BETWEEN 11 AND 21 AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer)) AS tmp2 LIMIT 100",
  "speedup": 0.9410322609393107,
  "status": "REGRESSION",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply pre-filtering of date_dim, item, customer in",
  "error_message": "INTERFACE: [max_store_sales] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk', 'd_moy', 'd_year'] | INTERFACE: [frequent_ss_items] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk', 'd_moy', 'd_year'] | INTERFACE: [frequent_ss_items] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk', 'd_moy', 'd_year']",
  "error_messages": [
    "INTERFACE: [max_store_sales] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk', 'd_moy', 'd_year']",
    "INTERFACE: [frequent_ss_items] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk', 'd_moy', 'd_year']",
    "INTERFACE: [frequent_ss_items] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk', 'd_moy', 'd_year']"
  ],
  "error_category": null
}