{
  "worker_id": 4,
  "strategy": "compound_prefetch_pivot_pushdown",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_self_join_decomposition",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_qoy, d_year FROM date_dim WHERE d_year = 1999 AND d_qoy IN (1, 2, 3)), filtered_item AS (SELECT i_item_sk FROM item WHERE i_color IN ('dark', 'puff') AND i_manager_id BETWEEN 15 AND 34), filtered_ca AS (SELECT ca_address_sk, ca_county FROM customer_address WHERE ca_state IN ('KS', 'OH')), ss_fact_join AS (SELECT ca.ca_county, fd.d_qoy, fd.d_year, ss.ss_ext_sales_price FROM store_sales ss INNER JOIN filtered_date fd ON ss.ss_sold_date_sk = fd.d_date_sk INNER JOIN filtered_item fi ON ss.ss_item_sk = fi.i_item_sk INNER JOIN filtered_ca ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_list_price BETWEEN 244 AND 258), ss_pivot AS (SELECT ca_county, d_year, SUM(CASE WHEN d_qoy = 1 THEN ss_ext_sales_price END) AS store_sales_q1, SUM(CASE WHEN d_qoy = 2 THEN ss_ext_sales_price END) AS store_sales_q2, SUM(CASE WHEN d_qoy = 3 THEN ss_ext_sales_price END) AS store_sales_q3 FROM ss_fact_join GROUP BY ca_county, d_year), ws_fact_join AS (SELECT ca.ca_county, fd.d_qoy, fd.d_year, ws.ws_ext_sales_price FROM web_sales ws INNER JOIN filtered_date fd ON ws.ws_sold_date_sk = fd.d_date_sk INNER JOIN filtered_item fi ON ws.ws_item_sk = fi.i_item_sk INNER JOIN filtered_ca ca ON ws.ws_bill_addr_sk = ca.ca_address_sk WHERE ws.ws_list_price BETWEEN 244 AND 258), ws_pivot AS (SELECT ca_county, d_year, SUM(CASE WHEN d_qoy = 1 THEN ws_ext_sales_price END) AS web_sales_q1, SUM(CASE WHEN d_qoy = 2 THEN ws_ext_sales_price END) AS web_sales_q2, SUM(CASE WHEN d_qoy = 3 THEN ws_ext_sales_price END) AS web_sales_q3 FROM ws_fact_join GROUP BY ca_county, d_year) SELECT ss.ca_county, ss.d_year, CASE WHEN ws.web_sales_q1 > 0 THEN ws.web_sales_q2 / ws.web_sales_q1 ELSE NULL END AS web_q1_q2_increase, CASE WHEN ss.store_sales_q1 > 0 THEN ss.store_sales_q2 / ss.store_sales_q1 ELSE NULL END AS store_q1_q2_increase, CASE WHEN ws.web_sales_q2 > 0 THEN ws.web_sales_q3 / ws.web_sales_q2 ELSE NULL END AS web_q2_q3_increase, CASE WHEN ss.store_sales_q2 > 0 THEN ss.store_sales_q3 / ss.store_sales_q2 ELSE NULL END AS store_q2_q3_increase FROM ss_pivot ss INNER JOIN ws_pivot ws ON ss.ca_county = ws.ca_county WHERE CASE WHEN ws.web_sales_q1 > 0 THEN ws.web_sales_q2 / ws.web_sales_q1 ELSE NULL END > CASE WHEN ss.store_sales_q1 > 0 THEN ss.store_sales_q2 / ss.store_sales_q1 ELSE NULL END AND CASE WHEN ws.web_sales_q2 > 0 THEN ws.web_sales_q3 / ws.web_sales_q2 ELSE NULL END > CASE WHEN ss.store_sales_q2 > 0 THEN ss.store_sales_q3 / ss.store_sales_q2 ELSE NULL END ORDER BY ss.d_year",
  "speedup": 1.2569121010765656,
  "status": "WIN",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply pre-filtering all three dimensions into CTEs",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true,
  "set_local_config": {
    "params": {
      "enable_hashjoin": "on",
      "enable_mergejoin": "off",
      "enable_nestloop": "off",
      "work_mem": "64MB",
      "hash_mem_multiplier": "2.0"
    },
    "commands": [
      "SET LOCAL enable_hashjoin = 'on'",
      "SET LOCAL enable_mergejoin = 'off'",
      "SET LOCAL enable_nestloop = 'off'",
      "SET LOCAL hash_mem_multiplier = '2.0'",
      "SET LOCAL work_mem = '64MB'"
    ],
    "config_speedup": 0.7647940850607391,
    "rewrite_only_speedup": 1.2569121010765656
  }
}