{
  "worker_id": 4,
  "strategy": "deferred_dimension_single_scan_pivot",
  "examples_used": [
    "pg_date_cte_explicit_join",
    "late_attribute_binding",
    "single_pass_aggregation"
  ],
  "optimized_sql": "WITH ticket_items_cte AS (SELECT s.ss_ticket_number, s.ss_item_sk, s.ss_customer_sk FROM store_sales s JOIN date_dim d ON s.ss_sold_date_sk = d.d_date_sk WHERE d.d_year BETWEEN 1999 AND 2000 AND s.ss_list_price BETWEEN 115 AND 129), item_pairs_cte AS (SELECT i1.i_item_sk AS i1_item_sk, i2.i_item_sk AS i2_item_sk FROM ticket_items_cte t1 JOIN ticket_items_cte t2 ON t1.ss_ticket_number = t2.ss_ticket_number JOIN item i1 ON t1.ss_item_sk = i1.i_item_sk JOIN item i2 ON t2.ss_item_sk = i2.i_item_sk JOIN customer c ON t1.ss_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE i1.i_category IN ('Electronics', 'Men') AND i2.i_manager_id BETWEEN 44 AND 63 AND cd.cd_marital_status = 'D' AND cd.cd_education_status = 'College' AND i1.i_item_sk < i2.i_item_sk) SELECT i1_item_sk AS i_item_sk, i2_item_sk AS i_item_sk, cnt FROM (SELECT i1_item_sk, i2_item_sk, COUNT(*) AS cnt FROM item_pairs_cte GROUP BY i1_item_sk, i2_item_sk ORDER BY cnt) final_aggregate",
  "speedup": 0.0,
  "status": "FAIL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- pg_date_cte_explicit_join: Apply date CTE isolation; but defer all other dimen",
  "error_message": "Row count mismatch: original=368, optimized=362",
  "error_messages": [
    "Row count mismatch: original=368, optimized=362"
  ],
  "error_category": "semantic",
  "exploratory": true
}