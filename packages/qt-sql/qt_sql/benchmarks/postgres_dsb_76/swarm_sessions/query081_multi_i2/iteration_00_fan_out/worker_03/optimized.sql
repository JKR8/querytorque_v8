WITH base_agg_cte AS (SELECT cr.cr_returning_customer_sk AS ctr_customer_sk, ca1.ca_state AS ctr_state, SUM(cr.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns cr INNER JOIN date_dim d ON cr.cr_returned_date_sk = d.d_date_sk INNER JOIN customer_address ca1 ON cr.cr_returning_addr_sk = ca1.ca_address_sk WHERE d.d_year = 2002 GROUP BY cr.cr_returning_customer_sk, ca1.ca_state), state_avg_cte AS (SELECT ctr_state, AVG(ctr_total_return) * 1.2 AS state_avg_threshold FROM base_agg_cte GROUP BY ctr_state) SELECT c.c_customer_id, c.c_salutation, c.c_first_name, c.c_last_name, ca2.ca_street_number, ca2.ca_street_name, ca2.ca_street_type, ca2.ca_suite_number, ca2.ca_city, ca2.ca_county, ca2.ca_state, ca2.ca_zip, ca2.ca_country, ca2.ca_gmt_offset, ca2.ca_location_type, ctr1.ctr_total_return FROM base_agg_cte ctr1 INNER JOIN state_avg_cte sa ON ctr1.ctr_state = sa.ctr_state INNER JOIN customer c ON ctr1.ctr_customer_sk = c.c_customer_sk INNER JOIN customer_address ca2 ON ca2.ca_address_sk = c.c_current_addr_sk WHERE ca2.ca_state = 'OH' AND ctr1.ctr_total_return > sa.state_avg_threshold ORDER BY c.c_customer_id, c.c_salutation, c.c_first_name, c.c_last_name, ca2.ca_street_number, ca2.ca_street_name, ca2.ca_street_type, ca2.ca_suite_number, ca2.ca_city, ca2.ca_county, ca2.ca_state, ca2.ca_zip, ca2.ca_country, ca2.ca_gmt_offset, ca2.ca_location_type, ctr1.ctr_total_return LIMIT 100