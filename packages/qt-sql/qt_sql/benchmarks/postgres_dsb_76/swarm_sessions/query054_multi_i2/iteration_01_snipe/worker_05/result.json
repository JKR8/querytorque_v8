{
  "worker_id": 5,
  "strategy": "retry_1",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "early_filter_decorrelate",
    "pg_self_join_decomposition",
    "inline_decorrelate_materialized",
    "pg_materialized_dimension_fact_prefilter",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "with my_customers as (\n select distinct c_customer_sk\n        , c_current_addr_sk\n from\n        ( select cs_sold_date_sk sold_date_sk,\n                 cs_bill_customer_sk customer_sk,\n                 cs_item_sk item_sk,\n                 cs_wholesale_cost wholesale_cost\n          from   catalog_sales\n          union all\n          select ws_sold_date_sk sold_date_sk,\n                 ws_bill_customer_sk customer_sk,\n                 ws_item_sk item_sk,\n                 ws_wholesale_cost wholesale_cost\n          from   web_sales\n         ) cs_or_ws_sales,\n         item,\n         date_dim,\n         customer\n where   sold_date_sk = d_date_sk\n         and item_sk = i_item_sk\n         and i_category = 'Home'\n         and i_class = 'curtains/drapes'\n         and c_customer_sk = cs_or_ws_sales.customer_sk\n         and d_moy = 5\n         and d_year = 1998\n         and wholesale_cost BETWEEN 70 AND 100\n         and c_birth_year BETWEEN 1942 AND 1955\n )\n , my_revenue as (\n select c_customer_sk,\n        sum(ss_ext_sales_price) as revenue\n from   my_customers,\n        store_sales,\n        customer_address,\n        store,\n        date_dim\n where  c_current_addr_sk = ca_address_sk\n        and ca_county = s_county\n        and ca_state = s_state\n        and ss_sold_date_sk = d_date_sk\n        and c_customer_sk = ss_customer_sk\n        and ss_wholesale_cost BETWEEN 70 AND 100\n        and s_state in ('AR','GA','IN'\n                    ,'KS','KY','NC'\n                    ,'OH','PA','SD'\n                    ,'VA')\n        and d_month_seq between (select distinct d_month_seq+1\n                                 from   date_dim where d_year = 1998 and d_moy = 5)\n                           and  (select distinct d_month_seq+3\n                                 from   date_dim where d_year = 1998 and d_moy = 5)\n group by c_customer_sk\n )\n , segments as\n (select cast((revenue/50) as int) as segment\n  from   my_revenue\n )\n  select  segment, count(*) as num_customers, segment*50 as segment_base\n from segments\n group by segment\n order by segment, num_customers\n limit 100;",
  "speedup": 0.5641096765153348,
  "status": "REGRESSION",
  "transforms": [],
  "hint": "",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}