{
  "worker_id": 1,
  "strategy": "explicit_join_dimension_prefetch",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH date_dim_cte AS (SELECT d_date_sk, d_month_seq FROM date_dim WHERE d_year = 1998 AND d_moy = 5), item_cte AS (SELECT i_item_sk FROM item WHERE i_category = 'Home' AND i_class = 'curtains/drapes'), sales_union_cte AS (SELECT cs_bill_customer_sk AS customer_sk FROM catalog_sales JOIN date_dim_cte ON cs_sold_date_sk = d_date_sk JOIN item_cte ON cs_item_sk = i_item_sk WHERE cs_wholesale_cost BETWEEN 70 AND 100 UNION ALL SELECT ws_bill_customer_sk AS customer_sk FROM web_sales JOIN date_dim_cte ON ws_sold_date_sk = d_date_sk JOIN item_cte ON ws_item_sk = i_item_sk WHERE ws_wholesale_cost BETWEEN 70 AND 100), customer_cte AS (SELECT c_customer_sk, c_current_addr_sk FROM customer WHERE c_birth_year BETWEEN 1942 AND 1955), my_customers AS (SELECT DISTINCT c.c_customer_sk, c.c_current_addr_sk FROM sales_union_cte s JOIN customer_cte c ON s.customer_sk = c.c_customer_sk), my_revenue AS (SELECT c.c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN store s ON ca.ca_county = s.s_county AND ca.ca_state = s.s_state JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk JOIN date_dim dd ON ss.ss_sold_date_sk = dd.d_date_sk WHERE ss.ss_wholesale_cost BETWEEN 70 AND 100 AND s.s_state IN ('AR','GA','IN','KS','KY','NC','OH','PA','SD','VA') AND dd.d_month_seq BETWEEN (SELECT d_month_seq+1 FROM date_dim_cte) AND (SELECT d_month_seq+3 FROM date_dim_cte) GROUP BY c.c_customer_sk), segments AS (SELECT CAST((revenue/50) AS INTEGER) AS segment FROM my_revenue) SELECT segment, COUNT(*) AS num_customers, segment*50 AS segment_base FROM segments GROUP BY segment ORDER BY segment, num_customers LIMIT 100",
  "speedup": 1.0157503595398798,
  "status": "NEUTRAL",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- pg_dimension_prefetch_star: apply pre-filtering date_dim and item into CTEs an",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}