{
  "worker_id": 4,
  "strategy": "minimal_change_explicit_joins",
  "examples_used": [
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH ssr AS (SELECT s_store_id AS store_id,\n       SUM(ss_ext_sales_price) AS sales,\n       SUM(COALESCE(sr_return_amt, 0)) AS returns,\n       SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit\nFROM store_sales\nLEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number)\nINNER JOIN date_dim ON (ss_sold_date_sk = d_date_sk)\nINNER JOIN store ON (ss_store_sk = s_store_sk)\nINNER JOIN item ON (ss_item_sk = i_item_sk)\nINNER JOIN promotion ON (ss_promo_sk = p_promo_sk)\nWHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY'\n  AND i_current_price > 50\n  AND p_channel_email = 'Y'\n  AND p_channel_tv = 'N'\n  AND p_channel_radio = 'N'\n  AND p_channel_press = 'N'\n  AND p_channel_event = 'N'\n  AND ss_wholesale_cost BETWEEN 21 AND 36\n  AND i_category IN ('Men', 'Music')\nGROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id,\n       SUM(cs_ext_sales_price) AS sales,\n       SUM(COALESCE(cr_return_amount, 0)) AS returns,\n       SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number)\nINNER JOIN date_dim ON (cs_sold_date_sk = d_date_sk)\nINNER JOIN catalog_page ON (cs_catalog_page_sk = cp_catalog_page_sk)\nINNER JOIN item ON (cs_item_sk = i_item_sk)\nINNER JOIN promotion ON (cs_promo_sk = p_promo_sk)\nWHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY'\n  AND i_current_price > 50\n  AND p_channel_email = 'Y'\n  AND p_channel_tv = 'N'\n  AND p_channel_radio = 'N'\n  AND p_channel_press = 'N'\n  AND p_channel_event = 'N'\n  AND cs_wholesale_cost BETWEEN 21 AND 36\n  AND i_category IN ('Men', 'Music')\nGROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id,\n       SUM(ws_ext_sales_price) AS sales,\n       SUM(COALESCE(wr_return_amt, 0)) AS returns,\n       SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit\nFROM web_sales\nLEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number)\nINNER JOIN date_dim ON (ws_sold_date_sk = d_date_sk)\nINNER JOIN web_site ON (ws_web_site_sk = web_site_sk)\nINNER JOIN item ON (ws_item_sk = i_item_sk)\nINNER JOIN promotion ON (ws_promo_sk = p_promo_sk)\nWHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY'\n  AND i_current_price > 50\n  AND p_channel_email = 'Y'\n  AND p_channel_tv = 'N'\n  AND p_channel_radio = 'N'\n  AND p_channel_press = 'N'\n  AND p_channel_event = 'N'\n  AND ws_wholesale_cost BETWEEN 21 AND 36\n  AND i_category IN ('Men', 'Music')\nGROUP BY web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100",
  "speedup": 1.1305226098100225,
  "status": "WIN",
  "transforms": [],
  "hint": "- pg_date_cte_explicit_join: Apply explicit JOIN syntax conversion only. Ignore ",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}