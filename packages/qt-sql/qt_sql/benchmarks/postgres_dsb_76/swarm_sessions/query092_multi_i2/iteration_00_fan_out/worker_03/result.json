{
  "worker_id": 3,
  "strategy": "shared_scan_decomposition",
  "examples_used": [
    "pg_self_join_decomposition"
  ],
  "optimized_sql": "WITH common_scan AS (SELECT ws_item_sk, ws_sold_date_sk, ws_ext_discount_amt, ws_wholesale_cost, ws_sales_price, ws_list_price, d_date_sk FROM web_sales INNER JOIN date_dim ON d_date_sk = ws_sold_date_sk WHERE d_date BETWEEN '1999-01-29' AND CAST('1999-01-29' AS DATE) + INTERVAL '90 DAY' AND ws_wholesale_cost BETWEEN 35 AND 55), threshold_computation AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM common_scan WHERE ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01 GROUP BY ws_item_sk), outer_rows AS (SELECT cs.ws_item_sk, cs.ws_ext_discount_amt FROM common_scan cs INNER JOIN item ON i_item_sk = cs.ws_item_sk WHERE (i_manufact_id BETWEEN 797 AND 996 OR i_category IN ('Men', 'Shoes', 'Sports'))), join_filter AS (SELECT o.ws_ext_discount_amt FROM outer_rows o INNER JOIN threshold_computation t ON o.ws_item_sk = t.ws_item_sk WHERE o.ws_ext_discount_amt > t.threshold) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM join_filter ORDER BY SUM(ws_ext_discount_amt) LIMIT 100",
  "speedup": 8043.914518272762,
  "status": "WIN",
  "transforms": [
    "decorrelate"
  ],
  "hint": "Apply the shared materialization pattern: common_scan CTE contains the expensive",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}