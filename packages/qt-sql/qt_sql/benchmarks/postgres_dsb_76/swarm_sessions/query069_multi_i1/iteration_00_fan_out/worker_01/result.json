{
  "worker_id": 1,
  "strategy": "explicit_join_dimension_prefetch",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH filtered_ca AS (SELECT ca_address_sk, ca_state FROM customer_address WHERE ca_state IN ('CO','NC','TX')), filtered_cd AS (SELECT cd_demo_sk, cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating FROM customer_demographics WHERE cd_marital_status IN ('S','M','U') AND cd_education_status IN ('Primary','College')), filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12), store_sales_cte AS (SELECT ss_customer_sk FROM store_sales INNER JOIN filtered_date ON ss_sold_date_sk = d_date_sk WHERE ss_list_price BETWEEN 80 AND 169), web_sales_cte AS (SELECT ws_bill_customer_sk FROM web_sales INNER JOIN filtered_date ON ws_sold_date_sk = d_date_sk WHERE ws_list_price BETWEEN 80 AND 169), catalog_sales_cte AS (SELECT cs_ship_customer_sk FROM catalog_sales INNER JOIN filtered_date ON cs_sold_date_sk = d_date_sk WHERE cs_list_price BETWEEN 80 AND 169), customer_join AS (SELECT c.c_customer_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating FROM customer c INNER JOIN filtered_ca ca ON c.c_current_addr_sk = ca.ca_address_sk INNER JOIN filtered_cd cd ON cd.cd_demo_sk = c.c_current_cdemo_sk), store_semi AS (SELECT cj.c_customer_sk, cj.cd_gender, cj.cd_marital_status, cj.cd_education_status, cj.cd_purchase_estimate, cj.cd_credit_rating FROM customer_join cj INNER JOIN store_sales_cte ss ON cj.c_customer_sk = ss.ss_customer_sk), web_anti AS (SELECT ss.c_customer_sk, ss.cd_gender, ss.cd_marital_status, ss.cd_education_status, ss.cd_purchase_estimate, ss.cd_credit_rating FROM store_semi ss LEFT JOIN web_sales_cte ws ON ss.c_customer_sk = ws.ws_bill_customer_sk WHERE ws.ws_bill_customer_sk IS NULL), catalog_anti AS (SELECT wa.cd_gender, wa.cd_marital_status, wa.cd_education_status, wa.cd_purchase_estimate, wa.cd_credit_rating FROM web_anti wa LEFT JOIN catalog_sales_cte cs ON wa.c_customer_sk = cs.cs_ship_customer_sk WHERE cs.cs_ship_customer_sk IS NULL) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM catalog_anti GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100",
  "speedup": 15.115807070396235,
  "status": "WIN",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply pre-filtering of customer_address and custom",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}