{
  "worker_id": 2,
  "strategy": "decorrelate_materialized_sets",
  "examples_used": [
    "inline_decorrelate_materialized",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12), store_customers AS MATERIALIZED (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk WHERE ss_list_price BETWEEN 80 AND 169), web_customers AS MATERIALIZED (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN filtered_date ON ws_sold_date_sk = d_date_sk WHERE ws_list_price BETWEEN 80 AND 169), catalog_customers AS MATERIALIZED (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN filtered_date ON cs_sold_date_sk = d_date_sk WHERE cs_list_price BETWEEN 80 AND 169), customer_base AS (SELECT c.c_customer_sk, cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE ca.ca_state IN ('CO','NC','TX') AND cd.cd_marital_status IN ('S','M','U') AND cd.cd_education_status IN ('Primary','College')), set_joins AS (SELECT cb.cd_gender, cb.cd_marital_status, cb.cd_education_status, cb.cd_purchase_estimate, cb.cd_credit_rating FROM customer_base cb INNER JOIN store_customers sc ON cb.c_customer_sk = sc.ss_customer_sk LEFT JOIN web_customers wc ON cb.c_customer_sk = wc.ws_bill_customer_sk LEFT JOIN catalog_customers cc ON cb.c_customer_sk = cc.cs_ship_customer_sk WHERE wc.ws_bill_customer_sk IS NULL AND cc.cs_ship_customer_sk IS NULL) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM set_joins GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100",
  "speedup": 17.482116951150278,
  "status": "WIN",
  "transforms": [
    "materialize_cte"
  ],
  "hint": "- inline_decorrelate_materialized: Apply MATERIALIZED keyword to channel custome",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}