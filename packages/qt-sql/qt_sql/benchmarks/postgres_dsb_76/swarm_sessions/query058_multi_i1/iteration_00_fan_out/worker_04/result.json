{
  "worker_id": 4,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "scan_consolidation_pivot"
  ],
  "optimized_sql": "WITH date_list_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')), unified_sales_cte AS (SELECT i.i_item_id, c.c_birth_year, sales.channel, sales.sales_price FROM (SELECT ss_item_sk AS item_sk, ss_sold_date_sk AS sold_date_sk, ss_customer_sk AS customer_sk, ss_ext_sales_price AS sales_price, ss_list_price AS list_price, 'store' AS channel FROM store_sales UNION ALL SELECT cs_item_sk, cs_sold_date_sk, cs_bill_customer_sk, cs_ext_sales_price, cs_list_price, 'catalog' FROM catalog_sales UNION ALL SELECT ws_item_sk, ws_sold_date_sk, ws_bill_customer_sk, ws_ext_sales_price, ws_list_price, 'web' FROM web_sales) sales INNER JOIN date_list_cte ON sales.sold_date_sk = date_list_cte.d_date_sk INNER JOIN item i ON sales.item_sk = i.i_item_sk INNER JOIN customer c ON sales.customer_sk = c.c_customer_sk WHERE sales.list_price BETWEEN 242 AND 271 AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951), aggregated_sales_cte AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, channel, SUM(sales_price) AS channel_rev FROM unified_sales_cte GROUP BY i_item_id, c_birth_year, channel), pivoted_sales_cte AS (SELECT item_id, birth_year, MAX(CASE WHEN channel = 'store' THEN channel_rev END) AS ss_item_rev, MAX(CASE WHEN channel = 'catalog' THEN channel_rev END) AS cs_item_rev, MAX(CASE WHEN channel = 'web' THEN channel_rev END) AS ws_item_rev FROM aggregated_sales_cte GROUP BY item_id, birth_year) SELECT item_id, birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM pivoted_sales_cte WHERE ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100",
  "speedup": 0.7320390884149754,
  "status": "REGRESSION",
  "transforms": [
    "or_to_union"
  ],
  "hint": "single_pass_aggregation: Apply UNION ALL consolidation of three fact tables with",
  "error_message": "INTERFACE: [pivoted_sales_cte] uses \"channel_rev\" \u2014 did you mean \"channel\" from [aggregated_sales_cte]? [aggregated_sales_cte] only provides ['birth_year', 'channel', 'channel_rev', 'item_id'] | INTERFACE: [pivoted_sales_cte] uses \"channel\" \u2014 did you mean \"channel_rev\" from [aggregated_sales_cte]? [aggregated_sales_cte] only provides ['birth_year', 'channel', 'channel_rev', 'item_id']",
  "error_messages": [
    "INTERFACE: [pivoted_sales_cte] uses \"channel_rev\" \u2014 did you mean \"channel\" from [aggregated_sales_cte]? [aggregated_sales_cte] only provides ['birth_year', 'channel', 'channel_rev', 'item_id']",
    "INTERFACE: [pivoted_sales_cte] uses \"channel\" \u2014 did you mean \"channel_rev\" from [aggregated_sales_cte]? [aggregated_sales_cte] only provides ['birth_year', 'channel', 'channel_rev', 'item_id']"
  ],
  "error_category": null,
  "exploratory": true
}