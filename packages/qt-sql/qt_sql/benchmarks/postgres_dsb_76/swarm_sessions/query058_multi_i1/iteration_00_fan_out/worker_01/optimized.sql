WITH date_range_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')), item_filtered_cte AS (SELECT i_item_sk, i_item_id FROM item WHERE i_manager_id BETWEEN 71 AND 100), customer_filtered_cte AS (SELECT c_customer_sk, c_birth_year FROM customer WHERE c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT item_filtered_cte.i_item_id AS item_id, customer_filtered_cte.c_birth_year AS birth_year, SUM(store_sales.ss_ext_sales_price) AS ss_item_rev FROM store_sales INNER JOIN date_range_cte ON store_sales.ss_sold_date_sk = date_range_cte.d_date_sk INNER JOIN item_filtered_cte ON store_sales.ss_item_sk = item_filtered_cte.i_item_sk INNER JOIN customer_filtered_cte ON store_sales.ss_customer_sk = customer_filtered_cte.c_customer_sk WHERE store_sales.ss_list_price BETWEEN 242 AND 271 GROUP BY item_filtered_cte.i_item_id, customer_filtered_cte.c_birth_year), cs_items AS (SELECT item_filtered_cte.i_item_id AS item_id, customer_filtered_cte.c_birth_year AS birth_year, SUM(catalog_sales.cs_ext_sales_price) AS cs_item_rev FROM catalog_sales INNER JOIN date_range_cte ON catalog_sales.cs_sold_date_sk = date_range_cte.d_date_sk INNER JOIN item_filtered_cte ON catalog_sales.cs_item_sk = item_filtered_cte.i_item_sk INNER JOIN customer_filtered_cte ON catalog_sales.cs_bill_customer_sk = customer_filtered_cte.c_customer_sk WHERE catalog_sales.cs_list_price BETWEEN 242 AND 271 GROUP BY item_filtered_cte.i_item_id, customer_filtered_cte.c_birth_year), ws_items AS (SELECT item_filtered_cte.i_item_id AS item_id, customer_filtered_cte.c_birth_year AS birth_year, SUM(web_sales.ws_ext_sales_price) AS ws_item_rev FROM web_sales INNER JOIN date_range_cte ON web_sales.ws_sold_date_sk = date_range_cte.d_date_sk INNER JOIN item_filtered_cte ON web_sales.ws_item_sk = item_filtered_cte.i_item_sk INNER JOIN customer_filtered_cte ON web_sales.ws_bill_customer_sk = customer_filtered_cte.c_customer_sk WHERE web_sales.ws_list_price BETWEEN 242 AND 271 GROUP BY item_filtered_cte.i_item_id, customer_filtered_cte.c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_items.ss_item_rev, ss_items.ss_item_rev/((ss_items.ss_item_rev+cs_items.cs_item_rev+ws_items.ws_item_rev)/3) * 100 ss_dev, cs_items.cs_item_rev, cs_items.cs_item_rev/((ss_items.ss_item_rev+cs_items.cs_item_rev+ws_items.ws_item_rev)/3) * 100 cs_dev, ws_items.ws_item_rev, ws_items.ws_item_rev/((ss_items.ss_item_rev+cs_items.cs_item_rev+ws_items.ws_item_rev)/3) * 100 ws_dev, (ss_items.ss_item_rev+cs_items.cs_item_rev+ws_items.ws_item_rev)/3 average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id=cs_items.item_id AND ss_items.item_id=ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_items.ss_item_rev between 0.9 * cs_items.cs_item_rev and 1.1 * cs_items.cs_item_rev AND ss_items.ss_item_rev between 0.9 * ws_items.ws_item_rev and 1.1 * ws_items.ws_item_rev AND cs_items.cs_item_rev between 0.9 * ss_items.ss_item_rev and 1.1 * ss_items.ss_item_rev AND cs_items.cs_item_rev between 0.9 * ws_items.ws_item_rev and 1.1 * ws_items.ws_item_rev AND ws_items.ws_item_rev between 0.9 * ss_items.ss_item_rev and 1.1 * ss_items.ss_item_rev AND ws_items.ws_item_rev between 0.9 * cs_items.cs_item_rev and 1.1 * cs_items.cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100