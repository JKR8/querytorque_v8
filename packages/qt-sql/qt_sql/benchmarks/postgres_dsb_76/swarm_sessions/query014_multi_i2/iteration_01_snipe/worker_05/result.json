{
  "worker_id": 5,
  "strategy": "retry_1",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "early_filter_decorrelate",
    "pg_materialized_dimension_fact_prefilter",
    "pg_self_join_decomposition",
    "inline_decorrelate_materialized",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH week_seq AS (SELECT (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 12) AS week_seq_1999, (SELECT d_week_seq FROM date_dim WHERE d_year = 2000 AND d_moy = 12 AND d_dom = 12) AS week_seq_2000), filtered_items AS (SELECT i_item_sk, i_brand_id, i_class_id, i_category_id FROM item WHERE i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51), cross_items AS (SELECT i_item_sk AS ss_item_sk FROM (SELECT i_brand_id, i_class_id, i_category_id FROM (SELECT i_brand_id, i_class_id, i_category_id, 'store' AS channel FROM store_sales JOIN filtered_items ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND ss_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT i_brand_id, i_class_id, i_category_id, 'catalog' AS channel FROM catalog_sales JOIN filtered_items ON cs_item_sk = i_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND cs_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT i_brand_id, i_class_id, i_category_id, 'web' AS channel FROM web_sales JOIN filtered_items ON ws_item_sk = i_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND ws_wholesale_cost BETWEEN 76 AND 96) AS channel_sales GROUP BY i_brand_id, i_class_id, i_category_id HAVING COUNT(DISTINCT channel) = 3) AS ci JOIN filtered_items ON ci.i_brand_id = filtered_items.i_brand_id AND ci.i_class_id = filtered_items.i_class_id AND ci.i_category_id = filtered_items.i_category_id), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND ss_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND cs_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE ws_wholesale_cost BETWEEN 76 AND 96 AND d_year BETWEEN 1999 AND 1999 + 2) AS x), store_sales_aggregated AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales JOIN filtered_items ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk CROSS JOIN week_seq WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d_week_seq IN (week_seq_1999, week_seq_2000) AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51 AND ss_wholesale_cost BETWEEN 76 AND 96 GROUP BY d_year, i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) SELECT 'store' AS ty_channel, ty.i_brand_id AS ty_brand, ty.i_class_id AS ty_class, ty.i_category_id AS ty_category, ty.sales AS ty_sales, ty.number_sales AS ty_number_sales, 'store' AS ly_channel, ly.i_brand_id AS ly_brand, ly.i_class_id AS ly_class, ly.i_category_id AS ly_category, ly.sales AS ly_sales, ly.number_sales AS ly_number_sales FROM (SELECT * FROM store_sales_aggregated WHERE d_year = 2000) ty JOIN (SELECT * FROM store_sales_aggregated WHERE d_year = 1999) ly ON ty.i_brand_id = ly.i_brand_id AND ty.i_class_id = ly.i_class_id AND ty.i_category_id = ly.i_category_id ORDER BY ty_channel, ty_brand, ty_class, ty_category LIMIT 100",
  "speedup": 0.0,
  "status": "ERROR",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "",
  "error_message": "INTERFACE: [store_sales_aggregated] uses \"i_category\" \u2014 did you mean \"i_category_id\" from [filtered_items]? [filtered_items] only provides ['i_brand_id', 'i_category_id', 'i_class_id', 'i_item_sk'] | Execution failed: column \"i_category\" does not exist\nLINE 1: ... d_week_seq IN (week_seq_1999, week_seq_2000) AND i_category...\n                                                             ^\nHINT:  Perhaps you meant to reference the column \"filtered_items.i_category_id\".\n",
  "error_messages": [
    "INTERFACE: [store_sales_aggregated] uses \"i_category\" \u2014 did you mean \"i_category_id\" from [filtered_items]? [filtered_items] only provides ['i_brand_id', 'i_category_id', 'i_class_id', 'i_item_sk']",
    "Execution failed: column \"i_category\" does not exist\nLINE 1: ... d_week_seq IN (week_seq_1999, week_seq_2000) AND i_category...\n                                                             ^\nHINT:  Perhaps you meant to reference the column \"filtered_items.i_category_id\".\n"
  ],
  "error_category": "execution"
}