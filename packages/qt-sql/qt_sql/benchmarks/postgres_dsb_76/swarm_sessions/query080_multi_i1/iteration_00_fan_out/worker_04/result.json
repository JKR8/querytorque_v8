{
  "worker_id": 4,
  "strategy": "materialized_dimension_fact_prefilter_compound",
  "examples_used": [
    "pg_materialized_dimension_fact_prefilter",
    "inline_decorrelate_materialized",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('1998-08-29' AS DATE) AND CAST('1998-08-29' AS DATE) + INTERVAL '30 DAY'), filtered_item AS (SELECT i_item_sk, i_current_price, i_category FROM item WHERE i_current_price > 50 AND i_category IN ('Children', 'Sports')), filtered_promotion AS (SELECT p_promo_sk, p_channel_email, p_channel_tv, p_channel_radio, p_channel_press, p_channel_event FROM promotion WHERE p_channel_email = 'N' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N'), ssr_pre AS (SELECT ss_store_sk, ss_item_sk, ss_ticket_number, ss_ext_sales_price, ss_net_profit, ss_sold_date_sk, ss_promo_sk FROM store_sales WHERE ss_wholesale_cost BETWEEN 23 AND 38 AND ss_sold_date_sk IN (SELECT d_date_sk FROM filtered_date) AND ss_item_sk IN (SELECT i_item_sk FROM filtered_item) AND ss_promo_sk IN (SELECT p_promo_sk FROM filtered_promotion)), ssr AS (SELECT s_store_id as store_id, SUM(ss_ext_sales_price) as sales, SUM(COALESCE(sr_return_amt, 0)) as returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) as profit FROM ssr_pre LEFT OUTER JOIN store_returns ON (ssr_pre.ss_item_sk = store_returns.sr_item_sk AND ssr_pre.ss_ticket_number = store_returns.sr_ticket_number) INNER JOIN store ON ssr_pre.ss_store_sk = store.s_store_sk GROUP BY s_store_id), csr_pre AS (SELECT cs_catalog_page_sk, cs_item_sk, cs_order_number, cs_ext_sales_price, cs_net_profit, cs_sold_date_sk, cs_promo_sk FROM catalog_sales WHERE cs_wholesale_cost BETWEEN 23 AND 38 AND cs_sold_date_sk IN (SELECT d_date_sk FROM filtered_date) AND cs_item_sk IN (SELECT i_item_sk FROM filtered_item) AND cs_promo_sk IN (SELECT p_promo_sk FROM filtered_promotion)), csr AS (SELECT cp_catalog_page_id as catalog_page_id, SUM(cs_ext_sales_price) as sales, SUM(COALESCE(cr_return_amount, 0)) as returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) as profit FROM csr_pre LEFT OUTER JOIN catalog_returns ON (csr_pre.cs_item_sk = catalog_returns.cr_item_sk AND csr_pre.cs_order_number = catalog_returns.cr_order_number) INNER JOIN catalog_page ON csr_pre.cs_catalog_page_sk = catalog_page.cp_catalog_page_sk GROUP BY cp_catalog_page_id), wsr_pre AS (SELECT ws_web_site_sk, ws_item_sk, ws_order_number, ws_ext_sales_price, ws_net_profit, ws_sold_date_sk, ws_promo_sk FROM web_sales WHERE ws_wholesale_cost BETWEEN 23 AND 38 AND ws_sold_date_sk IN (SELECT d_date_sk FROM filtered_date) AND ws_item_sk IN (SELECT i_item_sk FROM filtered_item) AND ws_promo_sk IN (SELECT p_promo_sk FROM filtered_promotion)), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) as sales, SUM(COALESCE(wr_return_amt, 0)) as returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) as profit FROM wsr_pre LEFT OUTER JOIN web_returns ON (wsr_pre.ws_item_sk = web_returns.wr_item_sk AND wsr_pre.ws_order_number = web_returns.wr_order_number) INNER JOIN web_site ON wsr_pre.ws_web_site_sk = web_site.web_site_sk GROUP BY web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100",
  "speedup": 1.0824713328281588,
  "status": "IMPROVED",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- pg_materialized_dimension_fact_prefilter: Apply MATERIALIZED CTEs for dimensio",
  "error_message": "INTERFACE: [ssr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk'] | INTERFACE: [csr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk'] | INTERFACE: [wsr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk']",
  "error_messages": [
    "INTERFACE: [ssr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [csr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [wsr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk']"
  ],
  "error_category": null,
  "exploratory": true
}