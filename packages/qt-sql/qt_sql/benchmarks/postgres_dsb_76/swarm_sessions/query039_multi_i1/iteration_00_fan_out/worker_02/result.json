{
  "worker_id": 2,
  "strategy": "pg_self_join_decomposition",
  "examples_used": [
    "pg_self_join_decomposition"
  ],
  "optimized_sql": "WITH base_scan_agg AS (SELECT w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy, STDDEV_SAMP(inv_quantity_on_hand) AS stdev, AVG(inv_quantity_on_hand) AS mean FROM inventory, item, warehouse, date_dim WHERE inv_item_sk = i_item_sk AND inv_warehouse_sk = w_warehouse_sk AND inv_date_sk = d_date_sk AND d_year = 2002 AND i_category IN ('Jewelry', 'Men') AND i_manager_id BETWEEN 81 AND 100 AND inv_quantity_on_hand BETWEEN 0 AND 200 GROUP BY w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy), month2_cte AS (SELECT w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM base_scan_agg WHERE d_moy = 2 AND CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1), month3_cte AS (SELECT w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM base_scan_agg WHERE d_moy = 3 AND CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1) SELECT inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM month2_cte AS inv1, month3_cte AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk ORDER BY inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.d_moy, inv2.mean, inv2.cov",
  "speedup": 0.0,
  "status": "REGRESSION",
  "transforms": [
    "pushdown"
  ],
  "hint": "- pg_self_join_decomposition: Apply the pattern of materializing base fact+dimen",
  "error_message": "INTERFACE: [joined_months_main] declares outputs ['inv1.cov', 'inv1.d_moy', 'inv1.i_item_sk', 'inv1.mean', 'inv1.w_warehouse_sk', 'inv2.cov', 'inv2.d_moy', 'inv2.i_item_sk', 'inv2.mean', 'inv2.w_warehouse_sk'] but SELECT only produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk'] | INTERFACE: [joined_months_main] SELECT produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk'] not declared in outputs | DID_NOT_FINISH: slower than original",
  "error_messages": [
    "INTERFACE: [joined_months_main] declares outputs ['inv1.cov', 'inv1.d_moy', 'inv1.i_item_sk', 'inv1.mean', 'inv1.w_warehouse_sk', 'inv2.cov', 'inv2.d_moy', 'inv2.i_item_sk', 'inv2.mean', 'inv2.w_warehouse_sk'] but SELECT only produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk']",
    "INTERFACE: [joined_months_main] SELECT produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk'] not declared in outputs",
    "DID_NOT_FINISH: slower than original"
  ],
  "error_category": null
}