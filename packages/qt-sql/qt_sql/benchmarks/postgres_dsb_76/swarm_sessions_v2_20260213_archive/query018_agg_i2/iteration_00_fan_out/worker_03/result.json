{
  "worker_id": 3,
  "strategy": "late_attribute_binding",
  "examples_used": [
    "dimension_cte_isolate",
    "late_attribute_binding"
  ],
  "optimized_sql": "WITH fact_dim_agg AS (SELECT \n  i_item_id,\n  c_current_addr_sk,\n  AVG(CAST(cs_quantity AS DECIMAL(12,2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12,2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12,2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12,2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12,2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12,2))) AS agg6\nFROM catalog_sales\nINNER JOIN date_dim ON cs_sold_date_sk = d_date_sk\nINNER JOIN item ON cs_item_sk = i_item_sk\nINNER JOIN customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk\nINNER JOIN customer ON cs_bill_customer_sk = c_customer_sk\nWHERE d_year = 1999\n  AND i_category = 'Music'\n  AND cd_gender = 'F'\n  AND cd_education_status = '4 yr Degree'\n  AND c_birth_month = 12\n  AND cs_wholesale_cost BETWEEN 5 AND 10\nGROUP BY i_item_id, c_current_addr_sk, c_birth_year), address_join AS (SELECT \n  f.i_item_id,\n  ca.ca_country,\n  ca.ca_state,\n  ca.ca_county,\n  f.agg1,\n  f.agg2,\n  f.agg3,\n  f.agg4,\n  f.agg5,\n  f.agg6\nFROM fact_dim_agg f\nINNER JOIN customer_address ca ON f.c_current_addr_sk = ca.ca_address_sk\nWHERE ca.ca_state IN ('AR', 'IN', 'VA')) SELECT \n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  CASE WHEN COUNT(*) > 0 THEN AVG(CAST(agg1 AS DECIMAL(12,2))) END AS agg1,\n  CASE WHEN COUNT(*) > 0 THEN AVG(CAST(agg2 AS DECIMAL(12,2))) END AS agg2,\n  CASE WHEN COUNT(*) > 0 THEN AVG(CAST(agg3 AS DECIMAL(12,2))) END AS agg3,\n  CASE WHEN COUNT(*) > 0 THEN AVG(CAST(agg4 AS DECIMAL(12,2))) END AS agg4,\n  CASE WHEN COUNT(*) > 0 THEN AVG(CAST(agg5 AS DECIMAL(12,2))) END AS agg5,\n  CASE WHEN COUNT(*) > 0 THEN AVG(CAST(agg6 AS DECIMAL(12,2))) END AS agg6\nFROM address_join\nGROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county)\nORDER BY ca_country, ca_state, ca_county, i_item_id\nLIMIT 100",
  "speedup": 1.0202495698467344,
  "status": "NEUTRAL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "dimension_cte_isolate: Apply isolating customer_address as separate CTE joined l",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "set_local_config": {
    "params": {
      "work_mem": "512MB",
      "hash_mem_multiplier": "2.0",
      "max_parallel_workers_per_gather": "2",
      "parallel_tuple_cost": "0.1",
      "parallel_setup_cost": "1000.0"
    },
    "commands": [
      "SET LOCAL hash_mem_multiplier = '2.0'",
      "SET LOCAL max_parallel_workers_per_gather = '2'",
      "SET LOCAL parallel_setup_cost = '1000.0'",
      "SET LOCAL parallel_tuple_cost = '0.1'",
      "SET LOCAL work_mem = '512MB'"
    ],
    "config_speedup": 1.0202495698467344,
    "rewrite_only_speedup": 0.994138766882075
  }
}