{
  "worker_id": 3,
  "strategy": "union_all_channel_consolidation",
  "examples_used": [
    "shared_dimension_multi_channel",
    "union_cte_split"
  ],
  "optimized_sql": "WITH store_channel AS (SELECT DISTINCT 'store' AS channel, customer.c_last_name, customer.c_first_name, date_dim.d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND date_dim.d_month_seq BETWEEN 1207 AND 1207 + 11 AND customer.c_birth_month IN (2, 3, 4, 10) AND store_sales.ss_list_price BETWEEN 241 AND 300 AND store_sales.ss_wholesale_cost BETWEEN 76 AND 96), catalog_channel AS (SELECT DISTINCT 'catalog' AS channel, customer.c_last_name, customer.c_first_name, date_dim.d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND date_dim.d_month_seq BETWEEN 1207 AND 1207 + 11 AND customer.c_birth_month IN (2, 3, 4, 10) AND catalog_sales.cs_list_price BETWEEN 241 AND 300 AND catalog_sales.cs_wholesale_cost BETWEEN 76 AND 96), web_channel AS (SELECT DISTINCT 'web' AS channel, customer.c_last_name, customer.c_first_name, date_dim.d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND date_dim.d_month_seq BETWEEN 1207 AND 1207 + 11 AND customer.c_birth_month IN (2, 3, 4, 10) AND web_sales.ws_list_price BETWEEN 241 AND 300 AND web_sales.ws_wholesale_cost BETWEEN 76 AND 96), all_channel_sales AS (SELECT channel, c_last_name, c_first_name, d_date FROM store_channel UNION ALL SELECT channel, c_last_name, c_first_name, d_date FROM catalog_channel UNION ALL SELECT channel, c_last_name, c_first_name, d_date FROM web_channel), grouped_channels AS (SELECT c_last_name, c_first_name, d_date FROM all_channel_sales GROUP BY c_last_name, c_first_name, d_date HAVING COUNT(DISTINCT channel) = 3) SELECT COUNT(*) FROM grouped_channels LIMIT 100",
  "speedup": 0.9232870152332204,
  "status": "REGRESSION",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- shared_dimension_multi_channel: Apply sharing of dimension tables across UNION",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}