{
  "worker_id": 2,
  "strategy": "intersect_to_exists_rewrite",
  "examples_used": [
    "intersect_to_exists",
    "multi_intersect_exists_cte"
  ],
  "optimized_sql": "WITH base_channel AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_exists AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_exists AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM base_channel b WHERE EXISTS (SELECT 1 FROM catalog_exists c WHERE b.c_last_name = c.c_last_name AND b.c_first_name = c.c_first_name AND b.d_date = c.d_date) AND EXISTS (SELECT 1 FROM web_exists w WHERE b.c_last_name = w.c_last_name AND b.c_first_name = w.c_first_name AND b.d_date = w.d_date)",
  "speedup": 0.0,
  "status": "FAIL",
  "transforms": [
    "intersect_to_exists"
  ],
  "hint": "- intersect_to_exists: Rewrite INTERSECT as EXISTS subqueries, using store_sales",
  "error_message": "Value mismatch: rows differ between original and optimized",
  "error_messages": [
    "Value mismatch: rows differ between original and optimized"
  ],
  "error_category": "semantic"
}