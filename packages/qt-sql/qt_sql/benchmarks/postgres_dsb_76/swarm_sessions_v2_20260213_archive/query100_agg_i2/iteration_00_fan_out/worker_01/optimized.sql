WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year BETWEEN 1999 AND 2000), item1_cte AS (SELECT i_item_sk FROM item WHERE i_category IN ('Electronics', 'Men')), item2_cte AS (SELECT i_item_sk FROM item WHERE i_manager_id BETWEEN 44 AND 63), cd_cte AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D' AND cd_education_status = 'College'), sales_base_cte AS NOT MATERIALIZED (SELECT ss_ticket_number, ss_item_sk, ss_customer_sk, ss_list_price FROM store_sales INNER JOIN date_cte ON store_sales.ss_sold_date_sk = date_cte.d_date_sk WHERE ss_list_price BETWEEN 115 AND 129), joined_fact_cte AS (SELECT i1.i_item_sk AS item1_sk, i2.i_item_sk AS item2_sk FROM sales_base_cte s1 INNER JOIN sales_base_cte s2 ON s1.ss_ticket_number = s2.ss_ticket_number INNER JOIN item1_cte i1 ON s1.ss_item_sk = i1.i_item_sk INNER JOIN item2_cte i2 ON s2.ss_item_sk = i2.i_item_sk INNER JOIN customer c ON s1.ss_customer_sk = c.c_customer_sk INNER JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk INNER JOIN cd_cte cd ON c.c_current_cdemo_sk = cd.cd_demo_sk WHERE i1.i_item_sk < i2.i_item_sk) SELECT item1_sk AS i_item_sk, item2_sk AS i_item_sk, COUNT(*) AS cnt FROM joined_fact_cte GROUP BY item1_sk, item2_sk ORDER BY cnt