{
  "worker_id": 5,
  "strategy": "retry_1",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_materialized_dimension_fact_prefilter",
    "pg_self_join_decomposition",
    "early_filter_decorrelate",
    "inline_decorrelate_materialized",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_qoy, d_year FROM date_dim WHERE d_year = 1999 AND d_qoy IN (1, 2, 3)), filtered_item AS (SELECT i_item_sk FROM item WHERE i_color IN ('dark', 'puff') AND i_manager_id BETWEEN 15 AND 34), filtered_ca AS (SELECT ca_address_sk, ca_county FROM customer_address WHERE ca_state IN ('KS', 'OH')), ss_pivot AS (SELECT ca_county, d_year, SUM(CASE WHEN d_qoy = 1 THEN ss_ext_sales_price END) AS store_sales_q1, SUM(CASE WHEN d_qoy = 2 THEN ss_ext_sales_price END) AS store_sales_q2, SUM(CASE WHEN d_qoy = 3 THEN ss_ext_sales_price END) AS store_sales_q3 FROM store_sales INNER JOIN filtered_date ON store_sales.ss_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_item ON store_sales.ss_item_sk = filtered_item.i_item_sk INNER JOIN filtered_ca ON store_sales.ss_addr_sk = filtered_ca.ca_address_sk WHERE store_sales.ss_list_price BETWEEN 244 AND 258 GROUP BY ca_county, d_year), ws_pivot AS (SELECT ca_county, d_year, SUM(CASE WHEN d_qoy = 1 THEN ws_ext_sales_price END) AS web_sales_q1, SUM(CASE WHEN d_qoy = 2 THEN ws_ext_sales_price END) AS web_sales_q2, SUM(CASE WHEN d_qoy = 3 THEN ws_ext_sales_price END) AS web_sales_q3 FROM web_sales INNER JOIN filtered_date ON web_sales.ws_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_item ON web_sales.ws_item_sk = filtered_item.i_item_sk INNER JOIN filtered_ca ON web_sales.ws_bill_addr_sk = filtered_ca.ca_address_sk WHERE web_sales.ws_list_price BETWEEN 244 AND 258 GROUP BY ca_county, d_year) SELECT ss_pivot.ca_county, ss_pivot.d_year, CASE WHEN web_sales_q1 > 0 THEN web_sales_q2 / web_sales_q1 ELSE NULL END AS web_q1_q2_increase, CASE WHEN store_sales_q1 > 0 THEN store_sales_q2 / store_sales_q1 ELSE NULL END AS store_q1_q2_increase, CASE WHEN web_sales_q2 > 0 THEN web_sales_q3 / web_sales_q2 ELSE NULL END AS web_q2_q3_increase, CASE WHEN store_sales_q2 > 0 THEN store_sales_q3 / store_sales_q2 ELSE NULL END AS store_q2_q3_increase FROM ss_pivot JOIN ws_pivot ON ss_pivot.ca_county = ws_pivot.ca_county WHERE CASE WHEN web_sales_q1 > 0 THEN web_sales_q2 / web_sales_q1 ELSE NULL END > CASE WHEN store_sales_q1 > 0 THEN store_sales_q2 / store_sales_q1 ELSE NULL END AND CASE WHEN web_sales_q2 > 0 THEN web_sales_q3 / web_sales_q2 ELSE NULL END > CASE WHEN store_sales_q2 > 0 THEN store_sales_q3 / store_sales_q2 ELSE NULL END ORDER BY ss_pivot.d_year",
  "speedup": 1.270955735935953,
  "status": "WIN",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}