{
  "worker_id": 1,
  "strategy": "star_join_prefetch with decorrelation",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH d2_filtered AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 1999 AND d_moy = 7), d1_d2_range AS (SELECT d1.d_date_sk, d2.d_date_sk AS d2_date_sk, d2.d_date AS d2_date FROM date_dim d1 CROSS JOIN d2_filtered d2 WHERE d1.d_date BETWEEN (d2.d_date - INTERVAL '120 DAY') AND d2.d_date), store_returns_filtered AS (SELECT sr_item_sk, sr_ticket_number, sr_customer_sk, sr_returned_date_sk FROM store_returns INNER JOIN d2_filtered ON store_returns.sr_returned_date_sk = d2_filtered.d_date_sk), sales_returns_joined AS (SELECT ss_store_sk, sr_returned_date_sk, ss_sold_date_sk FROM store_sales INNER JOIN store_returns_filtered ON (store_sales.ss_item_sk = store_returns_filtered.sr_item_sk AND store_sales.ss_ticket_number = store_returns_filtered.sr_ticket_number AND store_sales.ss_customer_sk = store_returns_filtered.sr_customer_sk) INNER JOIN d1_d2_range ON store_sales.ss_sold_date_sk = d1_d2_range.d_date_sk), store_joined AS (SELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, sr_returned_date_sk, ss_sold_date_sk FROM sales_returns_joined INNER JOIN store ON sales_returns_joined.ss_store_sk = store.s_store_sk) SELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 30 AND sr_returned_date_sk - ss_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 60 AND sr_returned_date_sk - ss_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 90 AND sr_returned_date_sk - ss_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM store_joined GROUP BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip ORDER BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip LIMIT 100",
  "speedup": 0.0,
  "status": "FAIL",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "pg_dimension_prefetch_star: Apply pre-filtering of d2 into CTE and convert comma",
  "error_message": "Value mismatch: rows differ between original and optimized",
  "error_messages": [
    "Value mismatch: rows differ between original and optimized"
  ],
  "error_category": "semantic"
}