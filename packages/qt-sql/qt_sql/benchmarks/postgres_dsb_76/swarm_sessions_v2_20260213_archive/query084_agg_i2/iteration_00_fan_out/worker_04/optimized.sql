WITH limited_customers AS (SELECT c_customer_id, c_current_addr_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_last_name, c_first_name FROM customer ORDER BY c_customer_id LIMIT 100) SELECT cust.c_customer_id AS customer_id, COALESCE(cust.c_last_name,'') || ', ' || COALESCE(cust.c_first_name,'') AS customername FROM limited_customers cust JOIN LATERAL (SELECT 1 FROM customer_address WHERE ca_address_sk = cust.c_current_addr_sk AND ca_city = 'Mount Vernon') addr ON true JOIN LATERAL (SELECT 1 FROM customer_demographics WHERE cd_demo_sk = cust.c_current_cdemo_sk) cd ON true JOIN LATERAL (SELECT 1 FROM household_demographics hd INNER JOIN income_band ON ib_income_band_sk = hd.hd_income_band_sk WHERE hd_demo_sk = cust.c_current_hdemo_sk AND ib_lower_bound >= 40374 AND ib_upper_bound <= 90374) hd_ib ON true JOIN LATERAL (SELECT 1 FROM store_returns WHERE sr_cdemo_sk = cust.c_current_cdemo_sk) sr ON true ORDER BY cust.c_customer_id