{
  "worker_id": 4,
  "strategy": "Compound dimension prefetch with early aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH filtered_items AS (SELECT i_item_sk, i_manufact_id, i_manager_id FROM item WHERE i_manufact_id IN (47, 226, 612, 676, 818) OR i_manager_id BETWEEN 71 AND 100), filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN '1998-01-06' AND cast('1998-01-06' as date) + interval '90 day'), sales_agg AS (SELECT cs_item_sk, SUM(cs_ext_discount_amt) AS total_discount, COUNT(CASE WHEN cs_list_price BETWEEN 108 AND 137 AND cs_sales_price / cs_list_price BETWEEN 0.23 AND 0.43 THEN cs_ext_discount_amt END) AS qualifying_count, SUM(CASE WHEN cs_list_price BETWEEN 108 AND 137 AND cs_sales_price / cs_list_price BETWEEN 0.23 AND 0.43 THEN cs_ext_discount_amt END) AS qualifying_sum FROM catalog_sales JOIN filtered_dates ON d_date_sk = cs_sold_date_sk GROUP BY cs_item_sk), threshold_derive AS (SELECT cs_item_sk, total_discount, 1.3 * qualifying_sum / qualifying_count AS threshold FROM sales_agg WHERE qualifying_count > 0), excess_filter AS (SELECT (total_discount - threshold) AS excess_amount FROM threshold_derive JOIN filtered_items ON i_item_sk = cs_item_sk WHERE total_discount > threshold) SELECT SUM(excess_amount) AS \"excess discount amount\" FROM excess_filter ORDER BY SUM(excess_amount) ASC LIMIT 100",
  "speedup": 1115.2379520700563,
  "status": "WIN",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- From single_pass_aggregation: Apply CASE expressions to compute qualifying ave",
  "error_message": "INTERFACE: [sales_agg] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_dates]? [filtered_dates] only provides ['d_date', 'd_date_sk']",
  "error_messages": [
    "INTERFACE: [sales_agg] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_dates]? [filtered_dates] only provides ['d_date', 'd_date_sk']"
  ],
  "error_category": null,
  "exploratory": true
}