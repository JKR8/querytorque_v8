{
  "worker_id": 2,
  "strategy": "pg_dimension_prefetch_star",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), store_filtered AS (SELECT s_store_sk FROM store WHERE s_state IN ('IA','KY','NE')), customer_filtered AS (SELECT c_customer_sk, c_current_cdemo_sk, c_customer_id FROM customer WHERE c_birth_month = 4 AND c_birth_year BETWEEN 1987 AND 1993), demo_filtered AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status IN ('S','S') AND cd_education_status IN ('4 yr Degree','4 yr Degree') AND cd_gender = 'M'), returns_cte AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns INNER JOIN date_filtered ON sr_returned_date_sk = date_filtered.d_date_sk WHERE sr_return_amt / sr_return_quantity BETWEEN 115 AND 174 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), subquery_cte AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS store_threshold FROM returns_cte GROUP BY ctr_store_sk) SELECT cf.c_customer_id FROM returns_cte r1 INNER JOIN subquery_cte s ON r1.ctr_store_sk = s.ctr_store_sk INNER JOIN store_filtered sf ON r1.ctr_store_sk = sf.s_store_sk INNER JOIN customer_filtered cf ON r1.ctr_customer_sk = cf.c_customer_sk INNER JOIN demo_filtered df ON cf.c_current_cdemo_sk = df.cd_demo_sk WHERE r1.ctr_total_return > s.store_threshold AND r1.ctr_reason_sk BETWEEN 17 AND 20 ORDER BY cf.c_customer_id LIMIT 100",
  "speedup": 27.21809974227123,
  "status": "WIN",
  "transforms": [
    "multi_dimension_prefetch"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply pre-filtering of ALL dimension tables into C",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}