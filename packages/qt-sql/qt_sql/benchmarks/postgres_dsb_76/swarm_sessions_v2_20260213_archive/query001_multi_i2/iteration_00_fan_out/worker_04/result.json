{
  "worker_id": 4,
  "strategy": "window_function_decorrelate",
  "examples_used": [
    "(no direct examples - novel approach)"
  ],
  "optimized_sql": "WITH returns_with_store_avg AS (SELECT sr_customer_sk AS ctr_customer_sk,\n       sr_store_sk AS ctr_store_sk,\n       sr_reason_sk AS ctr_reason_sk,\n       SUM(sr_return_amt_inc_tax) AS ctr_total_return,\n       AVG(SUM(sr_return_amt_inc_tax)) OVER (PARTITION BY sr_store_sk) * 1.2 AS store_avg_threshold\nFROM store_returns\nINNER JOIN date_dim ON sr_returned_date_sk = d_date_sk\nWHERE d_year = 2000\n  AND sr_return_amt / sr_return_quantity BETWEEN 115 AND 174\nGROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk) SELECT c_customer_id\nFROM returns_with_store_avg r\nINNER JOIN store ON s_store_sk = r.ctr_store_sk\nINNER JOIN customer ON c_customer_sk = r.ctr_customer_sk\nINNER JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk\nWHERE r.ctr_total_return > r.store_avg_threshold\n  AND r.ctr_reason_sk BETWEEN 17 AND 20\n  AND s_state IN ('IA', 'KY', 'NE')\n  AND cd_marital_status IN ('S', 'S')\n  AND cd_education_status IN ('4 yr Degree', '4 yr Degree')\n  AND cd_gender = 'M'\n  AND c_birth_month = 4\n  AND c_birth_year BETWEEN 1987 AND 1993\nORDER BY c_customer_id\nLIMIT 100",
  "speedup": 16.991517462882054,
  "status": "WIN",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- No direct examples. Create novel approach using window function to compute sto",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}