{
  "worker_id": 3,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation"
  ],
  "optimized_sql": "WITH date_month_cte AS (SELECT d_date_sk, d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')), date_expanded_cte AS (SELECT d.d_date_sk, d.d_date FROM date_dim d JOIN date_month_cte dm ON d.d_month_seq = dm.d_month_seq), filtered_facts AS (SELECT i_item_id, sr_return_quantity AS store_qty, NULL::numeric AS catalog_qty, NULL::numeric AS web_qty FROM store_returns, item, date_expanded_cte WHERE sr_item_sk = i_item_sk AND sr_returned_date_sk = d_date_sk AND i_category IN ('Children','Electronics') AND i_manager_id BETWEEN 15 AND 24 AND sr_reason_sk IN (7,18,19,22,36) AND sr_return_amt/sr_return_quantity BETWEEN 253 AND 282 UNION ALL SELECT i_item_id, NULL, cr_return_quantity, NULL FROM catalog_returns, item, date_expanded_cte WHERE cr_item_sk = i_item_sk AND cr_returned_date_sk = d_date_sk AND i_category IN ('Children','Electronics') AND i_manager_id BETWEEN 15 AND 24 AND cr_reason_sk IN (7,18,19,22,36) AND cr_return_amount/cr_return_quantity BETWEEN 253 AND 282 UNION ALL SELECT i_item_id, NULL, NULL, wr_return_quantity FROM web_returns, item, date_expanded_cte WHERE wr_item_sk = i_item_sk AND wr_returned_date_sk = d_date_sk AND i_category IN ('Children','Electronics') AND i_manager_id BETWEEN 15 AND 24 AND wr_reason_sk IN (7,18,19,22,36) AND wr_return_amt/wr_return_quantity BETWEEN 253 AND 282), consolidated_aggregates AS (SELECT i_item_id AS item_id, SUM(store_qty) AS sr_item_qty, SUM(catalog_qty) AS cr_item_qty, SUM(web_qty) AS wr_item_qty FROM filtered_facts GROUP BY i_item_id) SELECT item_id, sr_item_qty, sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 AS sr_dev, cr_item_qty, cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 AS cr_dev, wr_item_qty, wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 AS wr_dev, (sr_item_qty+cr_item_qty+wr_item_qty)/3.0 AS average FROM consolidated_aggregates ORDER BY item_id, sr_item_qty LIMIT 100",
  "speedup": 0.0,
  "status": "FAIL",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation: Use UNION ALL with NULL placeholders and single GROUP",
  "error_message": "INTERFACE: [filtered_facts] declares outputs ['catalog_qty', 'store_qty', 'web_qty'] but SELECT only produces ['i_item_id', 'wr_return_quantity'] | INTERFACE: [filtered_facts] SELECT produces ['wr_return_quantity'] not declared in outputs | INTERFACE: [filtered_facts] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_expanded_cte]? [date_expanded_cte] only provides ['d_date', 'd_date_sk'] | Row count mismatch: original=0, optimized=3",
  "error_messages": [
    "INTERFACE: [filtered_facts] declares outputs ['catalog_qty', 'store_qty', 'web_qty'] but SELECT only produces ['i_item_id', 'wr_return_quantity']",
    "INTERFACE: [filtered_facts] SELECT produces ['wr_return_quantity'] not declared in outputs",
    "INTERFACE: [filtered_facts] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_expanded_cte]? [date_expanded_cte] only provides ['d_date', 'd_date_sk']",
    "Row count mismatch: original=0, optimized=3"
  ],
  "error_category": "semantic"
}