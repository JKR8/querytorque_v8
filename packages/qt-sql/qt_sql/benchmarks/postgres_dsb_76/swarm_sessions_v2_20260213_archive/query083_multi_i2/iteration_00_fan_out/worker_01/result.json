{
  "worker_id": 1,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join",
    "pg_materialized_dimension_fact_prefilter"
  ],
  "optimized_sql": "WITH date_filter_cte AS (SELECT d_date_sk, d_date, d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05')), item_filter_cte AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24), store_returns_agg AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns INNER JOIN date_filter_cte ON sr_returned_date_sk = d_date_sk INNER JOIN item_filter_cte ON sr_item_sk = i_item_sk WHERE sr_reason_sk IN (7, 18, 19, 22, 36) AND sr_return_amt / sr_return_quantity BETWEEN 253 AND 282 GROUP BY i_item_id), catalog_returns_agg AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns INNER JOIN date_filter_cte ON cr_returned_date_sk = d_date_sk INNER JOIN item_filter_cte ON cr_item_sk = i_item_sk WHERE cr_reason_sk IN (7, 18, 19, 22, 36) AND cr_return_amount / cr_return_quantity BETWEEN 253 AND 282 GROUP BY i_item_id), web_returns_agg AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns INNER JOIN date_filter_cte ON wr_returned_date_sk = d_date_sk INNER JOIN item_filter_cte ON wr_item_sk = i_item_sk WHERE wr_reason_sk IN (7, 18, 19, 22, 36) AND wr_return_amt / wr_return_quantity BETWEEN 253 AND 282 GROUP BY i_item_id) SELECT store_returns_agg.item_id, sr_item_qty, sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 AS sr_dev, cr_item_qty, cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 AS cr_dev, wr_item_qty, wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 AS wr_dev, (sr_item_qty+cr_item_qty+wr_item_qty)/3.0 AS average FROM store_returns_agg INNER JOIN catalog_returns_agg ON store_returns_agg.item_id = catalog_returns_agg.item_id INNER JOIN web_returns_agg ON store_returns_agg.item_id = web_returns_agg.item_id ORDER BY store_returns_agg.item_id, sr_item_qty LIMIT 100",
  "speedup": 6.109249409257354,
  "status": "WIN",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply pre-filtering of date and item into CTEs and",
  "error_message": "INTERFACE: [store_returns_agg] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_filter_cte]? [date_filter_cte] only provides ['d_date', 'd_date_sk', 'd_month_seq'] | INTERFACE: [catalog_returns_agg] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_filter_cte]? [date_filter_cte] only provides ['d_date', 'd_date_sk', 'd_month_seq'] | INTERFACE: [web_returns_agg] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_filter_cte]? [date_filter_cte] only provides ['d_date', 'd_date_sk', 'd_month_seq']",
  "error_messages": [
    "INTERFACE: [store_returns_agg] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_filter_cte]? [date_filter_cte] only provides ['d_date', 'd_date_sk', 'd_month_seq']",
    "INTERFACE: [catalog_returns_agg] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_filter_cte]? [date_filter_cte] only provides ['d_date', 'd_date_sk', 'd_month_seq']",
    "INTERFACE: [web_returns_agg] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_filter_cte]? [date_filter_cte] only provides ['d_date', 'd_date_sk', 'd_month_seq']"
  ],
  "error_category": null
}