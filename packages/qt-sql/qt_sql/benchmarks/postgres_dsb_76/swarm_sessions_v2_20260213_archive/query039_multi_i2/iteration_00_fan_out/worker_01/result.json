{
  "worker_id": 1,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 2002), filtered_item AS (SELECT i_item_sk FROM item WHERE i_category IN ('Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 61), filtered_warehouse AS (SELECT w_warehouse_sk, w_warehouse_name FROM warehouse), joined_fact AS (SELECT w.w_warehouse_sk, w.w_warehouse_name, i.i_item_sk, d.d_moy, inv.inv_quantity_on_hand FROM inventory inv INNER JOIN filtered_date d ON inv.inv_date_sk = d.d_date_sk INNER JOIN filtered_item i ON inv.inv_item_sk = i.i_item_sk INNER JOIN filtered_warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE inv.inv_quantity_on_hand BETWEEN 791 AND 991), aggregated AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, STDDEV_SAMP(inv_quantity_on_hand) AS stdev, AVG(inv_quantity_on_hand) AS mean FROM joined_fact GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy), filtered_cov AS (SELECT w_warehouse_sk, i_item_sk, d_moy, mean, CASE WHEN mean = 0 THEN NULL ELSE stdev/mean END AS cov FROM aggregated WHERE CASE WHEN mean = 0 THEN 0 ELSE stdev/mean END > 1) SELECT inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM filtered_cov AS inv1 INNER JOIN filtered_cov AS inv2 ON inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk WHERE inv1.d_moy = 5 AND inv2.d_moy = 6 ORDER BY inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.d_moy, inv2.mean, inv2.cov",
  "speedup": 1.8959177954014166,
  "status": "WIN",
  "transforms": [
    "multi_dimension_prefetch"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply pre-filtering of all 3 dimensions into CTEs ",
  "error_message": "INTERFACE: [main_self_join] declares outputs ['inv1.cov', 'inv1.d_moy', 'inv1.i_item_sk', 'inv1.mean', 'inv1.w_warehouse_sk', 'inv2.cov', 'inv2.d_moy', 'inv2.i_item_sk', 'inv2.mean', 'inv2.w_warehouse_sk'] but SELECT only produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk'] | INTERFACE: [main_self_join] SELECT produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk'] not declared in outputs | INTERFACE: [main_self_join] declares outputs ['inv1.cov', 'inv1.d_moy', 'inv1.i_item_sk', 'inv1.mean', 'inv1.w_warehouse_sk', 'inv2.cov', 'inv2.d_moy', 'inv2.i_item_sk', 'inv2.mean', 'inv2.w_warehouse_sk'] but SELECT only produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk'] | INTERFACE: [main_self_join] SELECT produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk'] not declared in outputs",
  "error_messages": [
    "INTERFACE: [main_self_join] declares outputs ['inv1.cov', 'inv1.d_moy', 'inv1.i_item_sk', 'inv1.mean', 'inv1.w_warehouse_sk', 'inv2.cov', 'inv2.d_moy', 'inv2.i_item_sk', 'inv2.mean', 'inv2.w_warehouse_sk'] but SELECT only produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk']",
    "INTERFACE: [main_self_join] SELECT produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk'] not declared in outputs",
    "INTERFACE: [main_self_join] declares outputs ['inv1.cov', 'inv1.d_moy', 'inv1.i_item_sk', 'inv1.mean', 'inv1.w_warehouse_sk', 'inv2.cov', 'inv2.d_moy', 'inv2.i_item_sk', 'inv2.mean', 'inv2.w_warehouse_sk'] but SELECT only produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk']",
    "INTERFACE: [main_self_join] SELECT produces ['cov', 'd_moy', 'i_item_sk', 'mean', 'w_warehouse_sk'] not declared in outputs"
  ],
  "error_category": null
}