{
  "worker_id": 4,
  "strategy": "composite_prefilter_parallel_hash",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_date_cte_explicit_join",
    "inline_decorrelate_materialized"
  ],
  "optimized_sql": "WITH filtered_d2 AS (SELECT d_date_sk, d_date, (d_date - INTERVAL '120 day') AS window_start FROM date_dim WHERE d_year = 2000 AND d_moy = 8), d1_window_lateral AS (SELECT d2.d_date_sk AS d2_date_sk, d1.d_date_sk AS d1_date_sk FROM filtered_d2 d2, LATERAL (SELECT d_date_sk FROM date_dim d1 WHERE d1.d_date BETWEEN d2.window_start AND d2.d_date) d1), store_returns_filtered AS (SELECT sr_ticket_number, sr_item_sk, sr_customer_sk, fd.d_date_sk AS return_date_sk FROM store_returns sr INNER JOIN filtered_d2 fd ON sr.sr_returned_date_sk = fd.d_date_sk), store_sales_hash_join AS (SELECT ss.ss_store_sk, ss.ss_sold_date_sk, srf.return_date_sk FROM store_sales ss INNER JOIN store_returns_filtered srf ON ss.ss_ticket_number = srf.sr_ticket_number AND ss.ss_item_sk = srf.sr_item_sk AND ss.ss_customer_sk = srf.sr_customer_sk INNER JOIN d1_window_lateral dwl ON ss.ss_sold_date_sk = dwl.d1_date_sk), store_hash_join AS (SELECT s.*, sshj.ss_sold_date_sk, sshj.return_date_sk FROM store_sales_hash_join sshj INNER JOIN store s ON sshj.ss_store_sk = s.s_store_sk) SELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, SUM(CASE WHEN (return_date_sk - ss_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (return_date_sk - ss_sold_date_sk > 30) AND (return_date_sk - ss_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (return_date_sk - ss_sold_date_sk > 60) AND (return_date_sk - ss_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (return_date_sk - ss_sold_date_sk > 90) AND (return_date_sk - ss_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (return_date_sk - ss_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM store_hash_join GROUP BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip ORDER BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip LIMIT 100",
  "speedup": 0.0,
  "status": "FAIL",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- pg_dimension_prefetch_star: pre-filter d2 and compute window_start; apply expl",
  "error_message": "INTERFACE: [store_hash_join] declares outputs ['s_city', 's_company_id', 's_county', 's_state', 's_store_name', 's_street_name', 's_street_number', 's_street_type', 's_suite_number', 's_zip'] but SELECT only produces ['*', 'return_date_sk', 'ss_sold_date_sk'] | INTERFACE: [store_hash_join] SELECT produces ['*'] not declared in outputs | INTERFACE: [d1_window_lateral] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_d2]? [filtered_d2] only provides ['d_date', 'd_date_sk', 'window_start'] | Value mismatch: rows differ between original and optimized",
  "error_messages": [
    "INTERFACE: [store_hash_join] declares outputs ['s_city', 's_company_id', 's_county', 's_state', 's_store_name', 's_street_name', 's_street_number', 's_street_type', 's_suite_number', 's_zip'] but SELECT only produces ['*', 'return_date_sk', 'ss_sold_date_sk']",
    "INTERFACE: [store_hash_join] SELECT produces ['*'] not declared in outputs",
    "INTERFACE: [d1_window_lateral] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_d2]? [filtered_d2] only provides ['d_date', 'd_date_sk', 'window_start']",
    "Value mismatch: rows differ between original and optimized"
  ],
  "error_category": "semantic",
  "exploratory": true
}