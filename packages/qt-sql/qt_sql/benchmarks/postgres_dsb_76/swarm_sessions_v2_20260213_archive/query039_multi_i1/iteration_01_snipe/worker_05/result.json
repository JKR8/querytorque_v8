{
  "worker_id": 5,
  "strategy": "retry_1",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_materialized_dimension_fact_prefilter",
    "early_filter_decorrelate",
    "pg_self_join_decomposition",
    "inline_decorrelate_materialized",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 2002 AND d_moy IN (2, 3)), filtered_item AS (SELECT i_item_sk FROM item WHERE i_category IN ('Jewelry', 'Men') AND i_manager_id BETWEEN 81 AND 100), filtered_warehouse AS (SELECT w_warehouse_sk, w_warehouse_name FROM warehouse), base_agg AS (SELECT w.w_warehouse_sk, w.w_warehouse_name, i.i_item_sk, d.d_moy, STDDEV_SAMP(inv.inv_quantity_on_hand) AS stdev, AVG(inv.inv_quantity_on_hand) AS mean FROM inventory inv INNER JOIN filtered_date d ON inv.inv_date_sk = d.d_date_sk INNER JOIN filtered_item i ON inv.inv_item_sk = i.i_item_sk INNER JOIN filtered_warehouse w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE inv.inv_quantity_on_hand BETWEEN 0 AND 200 GROUP BY w.w_warehouse_sk, w.w_warehouse_name, i.i_item_sk, d.d_moy), inv AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM base_agg WHERE CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1) SELECT inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM inv AS inv1, inv AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk AND inv1.d_moy = 2 AND inv2.d_moy = 2 + 1 ORDER BY inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.d_moy, inv2.mean, inv2.cov",
  "speedup": 30.56526963464076,
  "status": "WIN",
  "transforms": [
    "decorrelate"
  ],
  "hint": "",
  "error_message": "INTERFACE: [base_agg] references 'inv.inv_quantity_on_hand' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk'] | INTERFACE: [base_agg] references 'inv.inv_quantity_on_hand' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk'] | INTERFACE: [base_agg] references 'inv.inv_date_sk' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk'] | INTERFACE: [base_agg] references 'inv.inv_item_sk' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk'] | INTERFACE: [base_agg] references 'inv.inv_warehouse_sk' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk'] | INTERFACE: [base_agg] references 'inv.inv_quantity_on_hand' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk'] | INTERFACE: [base_agg] references inv.inv_quantity_on_hand but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk'] | INTERFACE: [base_agg] references inv.inv_date_sk but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk'] | INTERFACE: [base_agg] references inv.inv_item_sk but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk'] | INTERFACE: [base_agg] references inv.inv_warehouse_sk but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
  "error_messages": [
    "INTERFACE: [base_agg] references 'inv.inv_quantity_on_hand' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
    "INTERFACE: [base_agg] references 'inv.inv_quantity_on_hand' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
    "INTERFACE: [base_agg] references 'inv.inv_date_sk' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
    "INTERFACE: [base_agg] references 'inv.inv_item_sk' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
    "INTERFACE: [base_agg] references 'inv.inv_warehouse_sk' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
    "INTERFACE: [base_agg] references 'inv.inv_quantity_on_hand' but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
    "INTERFACE: [base_agg] references inv.inv_quantity_on_hand but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
    "INTERFACE: [base_agg] references inv.inv_date_sk but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
    "INTERFACE: [base_agg] references inv.inv_item_sk but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']",
    "INTERFACE: [base_agg] references inv.inv_warehouse_sk but [inv] only provides ['cov', 'd_moy', 'i_item_sk', 'mean', 'stdev', 'w_warehouse_name', 'w_warehouse_sk']"
  ],
  "error_category": null
}