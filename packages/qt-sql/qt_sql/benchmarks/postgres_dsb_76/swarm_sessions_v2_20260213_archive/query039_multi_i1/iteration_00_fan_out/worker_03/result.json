{
  "worker_id": 3,
  "strategy": "scan_consolidation_pivot",
  "examples_used": [
    "pg_materialized_dimension_fact_prefilter",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH filtered_months_agg AS (SELECT w.w_warehouse_sk, w.w_warehouse_name, i.i_item_sk, dd.d_moy, STDDEV_SAMP(inv.inv_quantity_on_hand) AS stdev, AVG(inv.inv_quantity_on_hand) AS mean FROM inventory inv, item i, warehouse w, date_dim dd WHERE inv.inv_item_sk = i.i_item_sk AND inv.inv_warehouse_sk = w.w_warehouse_sk AND inv.inv_date_sk = dd.d_date_sk AND dd.d_year = 2002 AND dd.d_moy IN (2, 3) AND i.i_category IN ('Jewelry', 'Men') AND i.i_manager_id BETWEEN 81 AND 100 AND inv.inv_quantity_on_hand BETWEEN 0 AND 200 GROUP BY w.w_warehouse_sk, w.w_warehouse_name, i.i_item_sk, dd.d_moy), pivoted_months AS (SELECT w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM filtered_months_agg), cov_filtered AS (SELECT w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy, stdev, mean, cov FROM pivoted_months WHERE CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1), inv AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, stdev, mean, cov FROM cov_filtered) SELECT inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM inv AS inv1, inv AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk AND inv1.d_moy = 2 AND inv2.d_moy = 2 + 1 ORDER BY inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.d_moy, inv2.mean, inv2.cov",
  "speedup": 0.0,
  "status": "FAIL",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- pg_materialized_dimension_fact_prefilter: Apply early filtering of date_dim to",
  "error_message": "Row count mismatch: original=0, optimized=13",
  "error_messages": [
    "Row count mismatch: original=0, optimized=13"
  ],
  "error_category": "semantic"
}