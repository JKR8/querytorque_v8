{
  "worker_id": 4,
  "strategy": "compound_explicit_prefilter_covpush",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_self_join_decomposition",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 2002 AND d_moy IN (2, 3)), filtered_items AS (SELECT i_item_sk FROM item WHERE i_category IN ('Jewelry', 'Men') AND i_manager_id BETWEEN 81 AND 100), filtered_warehouses AS (SELECT w_warehouse_sk, w_warehouse_name FROM warehouse), joined_fact AS (SELECT w.w_warehouse_sk, w.w_warehouse_name, i.i_item_sk, d.d_moy, inv.inv_quantity_on_hand FROM inventory inv INNER JOIN filtered_dates d ON inv.inv_date_sk = d.d_date_sk INNER JOIN filtered_items i ON inv.inv_item_sk = i.i_item_sk INNER JOIN filtered_warehouses w ON inv.inv_warehouse_sk = w.w_warehouse_sk WHERE inv.inv_quantity_on_hand BETWEEN 0 AND 200), monthly_agg_prefiltered AS (SELECT w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy, STDDEV_SAMP(inv_quantity_on_hand) AS stdev, AVG(inv_quantity_on_hand) AS mean FROM joined_fact GROUP BY w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy), month2_data AS (SELECT w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM monthly_agg_prefiltered WHERE d_moy = 2 AND CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1), month3_data AS (SELECT w_warehouse_sk, w_warehouse_name, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM monthly_agg_prefiltered WHERE d_moy = 3 AND CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1), joined_main AS (SELECT inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM month2_data inv1 INNER JOIN month3_data inv2 ON inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk ORDER BY inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.d_moy, inv2.mean, inv2.cov) SELECT w_warehouse_sk, i_item_sk, d_moy, mean, cov, w_warehouse_sk, i_item_sk, d_moy, mean, cov FROM joined_main",
  "speedup": 0.0,
  "status": "ERROR",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- pg_dimension_prefetch_star: Apply explicit JOINs with pre-filtered dimension C",
  "error_message": "column reference \"w_warehouse_sk\" is ambiguous\nLINE 1: ...inv1.cov, inv2.d_moy, inv2.mean, inv2.cov) SELECT w_warehous...\n                                                             ^\n",
  "error_messages": [
    "column reference \"w_warehouse_sk\" is ambiguous\nLINE 1: ...inv1.cov, inv2.d_moy, inv2.mean, inv2.cov) SELECT w_warehous...\n                                                             ^\n"
  ],
  "error_category": "unknown",
  "exploratory": true
}