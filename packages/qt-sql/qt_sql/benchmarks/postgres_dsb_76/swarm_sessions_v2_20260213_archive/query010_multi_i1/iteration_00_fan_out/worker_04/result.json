{
  "worker_id": 4,
  "strategy": "channel_consolidation_union",
  "examples_used": [
    "or_to_union",
    "single_pass_aggregation"
  ],
  "optimized_sql": "WITH date_filter_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy BETWEEN 8 AND 11), item_filter_cte AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Electronics', 'Music') AND i_manager_id BETWEEN 66 AND 75), all_sales_union_cte AS (SELECT ss_customer_sk AS customer_sk, 'store' AS channel FROM store_sales ss INNER JOIN date_filter_cte d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN item_filter_cte i ON ss.ss_item_sk = i.i_item_sk WHERE ss.ss_sales_price / ss.ss_list_price BETWEEN 20 * 0.01 AND 30 * 0.01 UNION ALL SELECT ws_bill_customer_sk AS customer_sk, 'web' AS channel FROM web_sales ws INNER JOIN date_filter_cte d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN item_filter_cte i ON ws.ws_item_sk = i.i_item_sk WHERE ws.ws_sales_price / ws.ws_list_price BETWEEN 20 * 0.01 AND 30 * 0.01 UNION ALL SELECT cs_ship_customer_sk AS customer_sk, 'catalog' AS channel FROM catalog_sales cs INNER JOIN date_filter_cte d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN item_filter_cte i ON cs.cs_item_sk = i.i_item_sk WHERE cs.cs_sales_price / cs.cs_list_price BETWEEN 20 * 0.01 AND 30 * 0.01), customer_join AS (SELECT DISTINCT c.c_current_addr_sk, c.c_current_cdemo_sk FROM customer c INNER JOIN all_sales_union_cte s ON c.c_customer_sk = s.customer_sk WHERE c.c_birth_month IN (1, 5) AND EXISTS (SELECT 1 FROM all_sales_union_cte s2 WHERE s2.customer_sk = c.c_customer_sk AND s2.channel = 'store') AND EXISTS (SELECT 1 FROM all_sales_union_cte s3 WHERE s3.customer_sk = c.c_customer_sk AND s3.channel IN ('web', 'catalog'))) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM customer_join cj INNER JOIN customer_address ca ON cj.c_current_addr_sk = ca.ca_address_sk INNER JOIN customer_demographics cd ON cj.c_current_cdemo_sk = cd.cd_demo_sk WHERE ca.ca_county IN ('Grays Harbor County', 'Kootenai County', 'Pike County', 'Thomas County', 'Uinta County') AND cd.cd_marital_status IN ('U', 'U', 'M') AND cd.cd_education_status IN ('College', 'Primary', '2 yr Degree') AND cd.cd_gender = 'M' GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",
  "speedup": 0.0,
  "status": "REGRESSION",
  "transforms": [
    "or_to_union"
  ],
  "hint": "- or_to_union: Convert OR between web_sales and catalog_sales to UNION ALL, but ",
  "error_message": "DID_NOT_FINISH: slower than original",
  "error_messages": [
    "DID_NOT_FINISH: slower than original"
  ],
  "error_category": null,
  "exploratory": true
}