{
  "worker_id": 2,
  "strategy": "global_predicate_pushdown",
  "examples_used": [
    "early_filter_decorrelate",
    "pushdown"
  ],
  "optimized_sql": "WITH filtered_sales_cte AS (SELECT cs_sold_date_sk, cs_item_sk, cs_bill_cdemo_sk, cs_bill_customer_sk, cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, cs_net_profit FROM catalog_sales WHERE cs_wholesale_cost BETWEEN 41 AND 46), date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998), join_date_cte AS (SELECT f.cs_item_sk, f.cs_bill_cdemo_sk, f.cs_bill_customer_sk, f.cs_quantity, f.cs_list_price, f.cs_coupon_amt, f.cs_sales_price, f.cs_net_profit FROM filtered_sales_cte f INNER JOIN date_cte d ON f.cs_sold_date_sk = d.d_date_sk), item_cte AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Sports'), join_item_cte AS (SELECT i.i_item_id, j.cs_bill_cdemo_sk, j.cs_bill_customer_sk, j.cs_quantity, j.cs_list_price, j.cs_coupon_amt, j.cs_sales_price, j.cs_net_profit FROM join_date_cte j INNER JOIN item_cte i ON j.cs_item_sk = i.i_item_sk), cd_cte AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = 'College'), join_cd_cte AS (SELECT j.i_item_id, j.cs_bill_customer_sk, j.cs_quantity, j.cs_list_price, j.cs_coupon_amt, j.cs_sales_price, j.cs_net_profit FROM join_item_cte j INNER JOIN cd_cte c ON j.cs_bill_cdemo_sk = c.cd_demo_sk), customer_cte AS (SELECT c_customer_sk, c_current_addr_sk, c_birth_year FROM customer WHERE c_birth_month = 2), join_customer_cte AS (SELECT j.i_item_id, c.c_current_addr_sk, c.c_birth_year, j.cs_quantity, j.cs_list_price, j.cs_coupon_amt, j.cs_sales_price, j.cs_net_profit FROM join_cd_cte j INNER JOIN customer_cte c ON j.cs_bill_customer_sk = c.c_customer_sk), ca_cte AS (SELECT ca_address_sk, ca_country, ca_state, ca_county FROM customer_address WHERE ca_state IN ('AR', 'NY', 'TX')), join_ca_cte AS (SELECT j.i_item_id, ca.ca_country, ca.ca_state, ca.ca_county, j.cs_quantity, j.cs_list_price, j.cs_coupon_amt, j.cs_sales_price, j.cs_net_profit, j.c_birth_year FROM join_customer_cte j INNER JOIN ca_cte ca ON j.c_current_addr_sk = ca.ca_address_sk) SELECT i_item_id, ca_country, ca_state, ca_county, avg(cast(cs_quantity as decimal(12,2))) as agg1, avg(cast(cs_list_price as decimal(12,2))) as agg2, avg(cast(cs_coupon_amt as decimal(12,2))) as agg3, avg(cast(cs_sales_price as decimal(12,2))) as agg4, avg(cast(cs_net_profit as decimal(12,2))) as agg5, avg(cast(c_birth_year as decimal(12,2))) as agg6 FROM join_ca_cte GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100",
  "speedup": 1.0207570739425562,
  "status": "NEUTRAL",
  "transforms": [
    "pushdown"
  ],
  "hint": "early_filter_decorrelate: Apply early filtering of dimension tables into CTEs. I",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "set_local_config": {
    "params": {
      "max_parallel_workers_per_gather": "2",
      "work_mem": "64MB",
      "enable_nestloop": "off",
      "enable_hashjoin": "on",
      "jit": "off"
    },
    "commands": [
      "SET LOCAL enable_hashjoin = 'on'",
      "SET LOCAL enable_nestloop = 'off'",
      "SET LOCAL jit = 'off'",
      "SET LOCAL max_parallel_workers_per_gather = '2'",
      "SET LOCAL work_mem = '64MB'"
    ],
    "config_speedup": 0.4074801821103688,
    "rewrite_only_speedup": 1.0207570739425562
  }
}