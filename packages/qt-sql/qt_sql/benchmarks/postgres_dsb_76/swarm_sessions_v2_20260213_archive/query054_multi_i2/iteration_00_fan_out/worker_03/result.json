{
  "worker_id": 3,
  "strategy": "union_consolidation_shared_dimensions",
  "examples_used": [
    "shared_dimension_multi_channel",
    "pg_dimension_prefetch_star",
    "union_consolidation"
  ],
  "optimized_sql": "WITH date_dim_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), item_cte AS (SELECT i_item_sk FROM item WHERE i_category = 'Home' AND i_class = 'curtains/drapes'), customer_cte AS (SELECT c_customer_sk, c_current_addr_sk FROM customer WHERE c_birth_year BETWEEN 1942 AND 1955), sales_customers AS (SELECT cs_bill_customer_sk AS customer_sk FROM catalog_sales INNER JOIN date_dim_cte ON cs_sold_date_sk = d_date_sk INNER JOIN item_cte ON cs_item_sk = i_item_sk INNER JOIN customer_cte ON cs_bill_customer_sk = c_customer_sk WHERE cs_wholesale_cost BETWEEN 70 AND 100 UNION ALL SELECT ws_bill_customer_sk AS customer_sk FROM web_sales INNER JOIN date_dim_cte ON ws_sold_date_sk = d_date_sk INNER JOIN item_cte ON ws_item_sk = i_item_sk INNER JOIN customer_cte ON ws_bill_customer_sk = c_customer_sk WHERE ws_wholesale_cost BETWEEN 70 AND 100), my_customers AS (SELECT DISTINCT customer_sk AS c_customer_sk, (SELECT c_current_addr_sk FROM customer_cte WHERE c_customer_sk = sales_customers.customer_sk) AS c_current_addr_sk FROM sales_customers), my_revenue AS (SELECT c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers INNER JOIN store_sales ON c_customer_sk = ss_customer_sk INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk INNER JOIN store ON ca_county = s_county AND ca_state = s_state INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE ss_wholesale_cost BETWEEN 70 AND 100 AND s_state IN ('AR','GA','IN','KS','KY','NC','OH','PA','SD','VA') AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq+1 FROM date_dim WHERE d_year = 1998 AND d_moy = 5) AND (SELECT DISTINCT d_month_seq+3 FROM date_dim WHERE d_year = 1998 AND d_moy = 5) GROUP BY c_customer_sk), segments AS (SELECT CAST((revenue/50) AS INT) AS segment FROM my_revenue) SELECT segment, COUNT(*) AS num_customers, segment*50 AS segment_base FROM segments GROUP BY segment ORDER BY segment, num_customers LIMIT 100",
  "speedup": 0.09294304828355454,
  "status": "REGRESSION",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- shared_dimension_multi_channel: apply shared dimension joins across UNION bran",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}