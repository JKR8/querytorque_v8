{
  "worker_id": 4,
  "strategy": "late_attribute_binding_compound",
  "examples_used": [
    "early_filter_decorrelate",
    "pg_materialized_dimension_fact_prefilter"
  ],
  "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), returning_addr AS (SELECT ca_address_sk, ca_state FROM customer_address), fact_agg AS (SELECT cr.cr_returning_customer_sk AS ctr_customer_sk, ra.ca_state AS ctr_state, SUM(cr.cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns cr INNER JOIN date_filter d ON cr.cr_returned_date_sk = d.d_date_sk INNER JOIN returning_addr ra ON cr.cr_returning_addr_sk = ra.ca_address_sk GROUP BY cr.cr_returning_customer_sk, ra.ca_state), state_filter AS (SELECT f.ctr_customer_sk, f.ctr_state, f.ctr_total_return FROM fact_agg f CROSS JOIN LATERAL (SELECT AVG(f2.ctr_total_return) * 1.2 AS threshold FROM fact_agg f2 WHERE f.ctr_state = f2.ctr_state) AS state_avg WHERE f.ctr_total_return > state_avg.threshold), customer_filter AS (SELECT sf.ctr_customer_sk, sf.ctr_state, sf.ctr_total_return, c.c_customer_id, c.c_salutation, c.c_first_name, c.c_last_name FROM state_filter sf INNER JOIN customer c ON sf.ctr_customer_sk = c.c_customer_sk WHERE EXISTS (SELECT 1 FROM customer_address ca WHERE ca.ca_address_sk = c.c_current_addr_sk AND ca.ca_state = 'OH')) SELECT cf.c_customer_id, cf.c_salutation, cf.c_first_name, cf.c_last_name, ca.ca_street_number, ca.ca_street_name, ca.ca_street_type, ca.ca_suite_number, ca.ca_city, ca.ca_county, ca.ca_state, ca.ca_zip, ca.ca_country, ca.ca_gmt_offset, ca.ca_location_type, cf.ctr_total_return FROM customer_filter cf INNER JOIN customer_address ca ON ca.ca_address_sk = (SELECT c_current_addr_sk FROM customer WHERE c_customer_sk = cf.ctr_customer_sk) WHERE ca.ca_state = 'OH' ORDER BY cf.c_customer_id, cf.c_salutation, cf.c_first_name, cf.c_last_name, ca.ca_street_number, ca.ca_street_name, ca.ca_street_type, ca.ca_suite_number, ca.ca_city, ca.ca_county, ca.ca_state, ca.ca_zip, ca.ca_country, ca.ca_gmt_offset, ca.ca_location_type, cf.ctr_total_return LIMIT 100",
  "speedup": 1.249521735817156,
  "status": "WIN",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- Apply early_filter_decorrelate: Push date filter early, use LATERAL for state ",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}