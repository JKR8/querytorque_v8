{
  "worker_id": 5,
  "strategy": "retry_1",
  "examples_used": [
    "pg_materialized_dimension_fact_prefilter",
    "pg_dimension_prefetch_star",
    "pg_self_join_decomposition",
    "early_filter_decorrelate",
    "inline_decorrelate_materialized",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH dim_item AS (SELECT i_item_sk FROM item WHERE i_category IN ('Men', 'Shoes', 'Sports') AND i_manager_id IN (6, 11, 16, 17, 19, 28, 47, 82, 88, 98)), dim_customer AS (SELECT c_customer_sk, cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count FROM customer JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE ca_state IN ('AR', 'CA', 'KS', 'NY', 'VA')), dim_date_1998 AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 1998), store_sales_base AS (SELECT ss.ss_item_sk, ss.ss_customer_sk, dc.cd_gender, dc.cd_marital_status, dc.cd_education_status, dc.hd_vehicle_count, dd.d_date FROM store_sales ss JOIN dim_item di ON ss.ss_item_sk = di.i_item_sk JOIN dim_customer dc ON ss.ss_customer_sk = dc.c_customer_sk JOIN dim_date_1998 dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN inventory inv ON inv.inv_item_sk = ss.ss_item_sk AND inv.inv_date_sk = ss.ss_sold_date_sk JOIN warehouse w ON w.w_warehouse_sk = inv.inv_warehouse_sk JOIN store s ON s.s_state = w.w_state WHERE inv.inv_quantity_on_hand >= ss.ss_quantity), date_windows AS (SELECT ss_item_sk, ss_customer_sk, cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count, d_date, d_date + INTERVAL '30 day' AS window_end FROM store_sales_base), web_sales_base AS (SELECT ws.ws_item_sk, ws.ws_bill_customer_sk FROM web_sales ws JOIN dim_item di ON ws.ws_item_sk = di.i_item_sk JOIN dim_customer dc ON ws.ws_bill_customer_sk = dc.c_customer_sk JOIN date_dim d2 ON ws.ws_sold_date_sk = d2.d_date_sk JOIN date_windows dw ON ws.ws_item_sk = dw.ss_item_sk AND ws.ws_bill_customer_sk = dw.ss_customer_sk AND d2.d_date BETWEEN dw.d_date AND dw.window_end WHERE ws.ws_wholesale_cost BETWEEN 76 AND 96), matched_pairs AS (SELECT dw.cd_gender, dw.cd_marital_status, dw.cd_education_status, dw.hd_vehicle_count FROM date_windows dw JOIN web_sales_base wb ON dw.ss_item_sk = wb.ws_item_sk AND dw.ss_customer_sk = wb.ws_bill_customer_sk) SELECT cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count, COUNT(*) AS cnt FROM matched_pairs GROUP BY cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count ORDER BY cnt",
  "speedup": 0.007551212831119669,
  "status": "REGRESSION",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}