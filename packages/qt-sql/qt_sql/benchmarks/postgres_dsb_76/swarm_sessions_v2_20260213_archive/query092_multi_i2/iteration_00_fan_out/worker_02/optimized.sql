WITH date_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN '1999-01-29' AND CAST('1999-01-29' AS DATE) + INTERVAL '90 DAY'), item_cte AS (SELECT i_item_sk, i_manufact_id, i_category FROM item WHERE (i_manufact_id BETWEEN 797 AND 996 OR i_category IN ('Men', 'Shoes', 'Sports'))), fact_with_dates AS (SELECT ws_item_sk, ws_sold_date_sk, ws_ext_discount_amt, ws_wholesale_cost, ws_sales_price, ws_list_price FROM web_sales INNER JOIN date_cte ON date_cte.d_date_sk = web_sales.ws_sold_date_sk WHERE web_sales.ws_wholesale_cost BETWEEN 35 AND 55), final_explicit_join AS (SELECT fact_with_dates.ws_ext_discount_amt FROM item_cte INNER JOIN fact_with_dates ON item_cte.i_item_sk = fact_with_dates.ws_item_sk WHERE fact_with_dates.ws_ext_discount_amt > (SELECT 1.3 * AVG(sub.ws_ext_discount_amt) FROM fact_with_dates AS sub WHERE sub.ws_item_sk = item_cte.i_item_sk AND sub.ws_sales_price / sub.ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01)) SELECT SUM(ws_ext_discount_amt) AS "Excess Discount Amount" FROM final_explicit_join ORDER BY SUM(ws_ext_discount_amt) ASC LIMIT 100