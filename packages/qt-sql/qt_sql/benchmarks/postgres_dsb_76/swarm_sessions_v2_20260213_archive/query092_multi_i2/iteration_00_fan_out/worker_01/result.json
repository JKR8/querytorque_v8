{
  "worker_id": 1,
  "strategy": "decorrelation_materialized_cte",
  "examples_used": [
    "inline_decorrelate_materialized"
  ],
  "optimized_sql": "WITH filtered_date AS MATERIALIZED (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN '1999-01-29' AND (CAST('1999-01-29' AS DATE) + INTERVAL '90 DAY')), filtered_item AS MATERIALIZED (SELECT i_item_sk, i_manufact_id, i_category FROM item WHERE (i_manufact_id BETWEEN 797 AND 996 OR i_category IN ('Men', 'Shoes', 'Sports'))), fact_prefilter AS MATERIALIZED (SELECT ws.ws_item_sk, ws.ws_sold_date_sk, ws.ws_ext_discount_amt, ws.ws_wholesale_cost, ws.ws_sales_price, ws.ws_list_price FROM web_sales ws INNER JOIN filtered_date fd ON fd.d_date_sk = ws.ws_sold_date_sk WHERE ws.ws_wholesale_cost BETWEEN 35 AND 55), per_item_threshold AS MATERIALIZED (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM fact_prefilter WHERE ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01 GROUP BY ws_item_sk), main_join AS MATERIALIZED (SELECT fp.ws_ext_discount_amt FROM filtered_item fi INNER JOIN fact_prefilter fp ON fi.i_item_sk = fp.ws_item_sk INNER JOIN per_item_threshold pit ON fp.ws_item_sk = pit.ws_item_sk WHERE fp.ws_ext_discount_amt > pit.threshold) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM main_join ORDER BY SUM(ws_ext_discount_amt) ASC LIMIT 100",
  "speedup": 4437.538254286918,
  "status": "WIN",
  "transforms": [
    "decorrelate"
  ],
  "hint": "Apply the 3-CTE decomposition pattern: (1) filtered_date CTE, (2) fact_prefilter",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "set_local_config": {
    "params": {
      "work_mem": "512MB"
    },
    "commands": [
      "SET LOCAL work_mem = '512MB'"
    ],
    "config_speedup": 4437.538254286918,
    "rewrite_only_speedup": 4132.814980121883
  }
}