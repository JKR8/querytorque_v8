{
  "worker_id": 5,
  "strategy": "retry_1",
  "examples_used": [
    "pg_dimension_prefetch_star",
    "pg_materialized_dimension_fact_prefilter",
    "pg_self_join_decomposition",
    "early_filter_decorrelate",
    "inline_decorrelate_materialized",
    "pg_date_cte_explicit_join"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998), filtered_item AS (SELECT i_item_sk, i_item_desc FROM item WHERE i_manager_id BETWEEN 81 AND 100 AND i_category IN ('Children', 'Men', 'Sports')), filtered_customer AS (SELECT c_customer_sk FROM customer WHERE c_birth_year BETWEEN 1934 AND 1940), frequent_ss_items AS (SELECT substring(i_item_desc,1,30) AS itemdesc, i_item_sk AS item_sk, d_date AS solddate, count(*) AS cnt FROM store_sales INNER JOIN filtered_date ON ss_sold_date_sk = d_date_sk INNER JOIN filtered_item ON ss_item_sk = i_item_sk GROUP BY substring(i_item_desc,1,30), i_item_sk, d_date HAVING count(*) > 4), store_sales_enriched AS (SELECT ss_customer_sk, ss_quantity, ss_sales_price, ss_wholesale_cost, d_date_sk, c_customer_sk FROM store_sales LEFT JOIN filtered_date ON ss_sold_date_sk = d_date_sk LEFT JOIN filtered_customer ON ss_customer_sk = c_customer_sk), customer_aggregates AS (SELECT ss_customer_sk, SUM(CASE WHEN d_date_sk IS NOT NULL AND ss_wholesale_cost BETWEEN 11 AND 21 THEN ss_quantity * ss_sales_price END) AS csales, SUM(CASE WHEN c_customer_sk IS NOT NULL THEN ss_quantity * ss_sales_price END) AS ssales FROM store_sales_enriched GROUP BY ss_customer_sk), max_store_sales AS (SELECT max(csales) AS tpcds_cmax FROM customer_aggregates WHERE csales IS NOT NULL), best_ss_customer AS (SELECT ss_customer_sk AS c_customer_sk, ssales FROM customer_aggregates WHERE ssales IS NOT NULL AND ssales > (95/100.0) * (SELECT tpcds_cmax FROM max_store_sales)) SELECT sum(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales INNER JOIN filtered_date ON cs_sold_date_sk = d_date_sk AND d_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_moy = 10) WHERE cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales INNER JOIN filtered_date ON ws_sold_date_sk = d_date_sk AND d_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_moy = 10) WHERE ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) tmp2 LIMIT 100",
  "speedup": 0.0,
  "status": "ERROR",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "",
  "error_message": "INTERFACE: [frequent_ss_items] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [filtered_date]? [filtered_date] only provides ['d_date_sk'] | Execution failed: column \"d_date\" does not exist\nLINE 1: ...tem_desc,1,30) AS itemdesc, i_item_sk AS item_sk, d_date AS ...\n                                                             ^\nHINT:  Perhaps you meant to reference the column \"filtered_date.d_date_sk\".\n",
  "error_messages": [
    "INTERFACE: [frequent_ss_items] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [filtered_date]? [filtered_date] only provides ['d_date_sk']",
    "Execution failed: column \"d_date\" does not exist\nLINE 1: ...tem_desc,1,30) AS itemdesc, i_item_sk AS item_sk, d_date AS ...\n                                                             ^\nHINT:  Perhaps you meant to reference the column \"filtered_date.d_date_sk\".\n"
  ],
  "error_category": "execution"
}