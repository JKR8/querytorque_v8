{
  "worker_id": 1,
  "strategy": "conservative_early_filter_restructure",
  "examples_used": [
    "early_filter_decorrelate",
    "pg_date_cte_explicit_join",
    "pg_dimension_prefetch_star"
  ],
  "optimized_sql": "WITH filtered_dates AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_year = 1998\n      AND d_moy BETWEEN 4 AND 7\n),\nfiltered_items AS (\n    SELECT i_item_sk\n    FROM item\n    WHERE i_category IN ('Children', 'Electronics', 'Men')\n      AND i_manager_id BETWEEN 51 AND 60\n),\nprefiltered_customers AS (\n    SELECT \n        c.c_customer_sk,\n        c.c_current_cdemo_sk,\n        cd.cd_gender,\n        cd.cd_marital_status,\n        cd.cd_education_status,\n        cd.cd_purchase_estimate,\n        cd.cd_credit_rating,\n        cd.cd_dep_count,\n        cd.cd_dep_employed_count,\n        cd.cd_dep_college_count\n    FROM customer AS c\n    JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk\n    WHERE ca.ca_county IN ('Hickman County', 'Ohio County', 'Parke County', 'Pointe Coupee Parish', 'Siskiyou County')\n      AND c.c_birth_month IN (3, 8)\n      AND cd.cd_marital_status IN ('S', 'U', 'M')\n      AND cd.cd_education_status IN ('Secondary', 'Advanced Degree', '4 yr Degree')\n      AND cd.cd_gender = 'M'\n)\nSELECT\n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    COUNT(*) AS cnt1,\n    cd_purchase_estimate,\n    COUNT(*) AS cnt2,\n    cd_credit_rating,\n    COUNT(*) AS cnt3,\n    cd_dep_count,\n    COUNT(*) AS cnt4,\n    cd_dep_employed_count,\n    COUNT(*) AS cnt5,\n    cd_dep_college_count,\n    COUNT(*) AS cnt6\nFROM prefiltered_customers AS c\nWHERE EXISTS (\n    SELECT 1\n    FROM store_sales AS ss\n    JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk\n    JOIN filtered_items AS i ON ss.ss_item_sk = i.i_item_sk\n    WHERE ss.ss_customer_sk = c.c_customer_sk\n      AND ss.ss_sales_price / ss.ss_list_price BETWEEN 11 * 0.01 AND 21 * 0.01\n)\nAND (\n    EXISTS (\n        SELECT 1\n        FROM web_sales AS ws\n        JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk\n        JOIN filtered_items AS i ON ws.ws_item_sk = i.i_item_sk\n        WHERE ws.ws_bill_customer_sk = c.c_customer_sk\n          AND ws.ws_sales_price / ws.ws_list_price BETWEEN 11 * 0.01 AND 21 * 0.01\n    )\n    OR EXISTS (\n        SELECT 1\n        FROM catalog_sales AS cs\n        JOIN filtered_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk\n        JOIN filtered_items AS i ON cs.cs_item_sk = i.i_item_sk\n        WHERE cs.cs_ship_customer_sk = c.c_customer_sk\n          AND cs.cs_sales_price / cs.cs_list_price BETWEEN 11 * 0.01 AND 21 * 0.01\n    )\n)\nGROUP BY\n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    cd_purchase_estimate,\n    cd_credit_rating,\n    cd_dep_count,\n    cd_dep_employed_count,\n    cd_dep_college_count\nORDER BY\n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    cd_purchase_estimate,\n    cd_credit_rating,\n    cd_dep_count,\n    cd_dep_employed_count,\n    cd_dep_college_count\nLIMIT 100;",
  "speedup": 1.2129022433709193,
  "status": "WIN",
  "transforms": [
    "materialize_cte"
  ],
  "hint": "Focus on safe, proven improvements: convert implicit joins to explicit JOINs, push filters early into CTEs for date and item dimensions, and pre-filter customer/customer_address tables before the main grouping.",
  "error_message": null
}