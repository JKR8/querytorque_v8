{
  "worker_id": 3,
  "strategy": "aggressive_multi_fact_prefetch",
  "examples_used": [
    "pg_materialized_dimension_fact_prefilter",
    "pg_self_join_decomposition",
    "early_filter_decorrelate"
  ],
  "optimized_sql": "WITH \nfiltered_date AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_year = 1998\n      AND d_moy BETWEEN 4 AND 7\n),\nfiltered_item AS (\n    SELECT i_item_sk\n    FROM item\n    WHERE i_category IN ('Children', 'Electronics', 'Men')\n      AND i_manager_id BETWEEN 51 AND 60\n),\nstore_sales_filtered AS (\n    SELECT DISTINCT ss_customer_sk\n    FROM store_sales\n    JOIN filtered_date ON ss_sold_date_sk = d_date_sk\n    JOIN filtered_item ON ss_item_sk = i_item_sk\n    WHERE ss_sales_price / ss_list_price BETWEEN 0.11 AND 0.21\n),\nweb_sales_filtered AS (\n    SELECT DISTINCT ws_bill_customer_sk\n    FROM web_sales\n    JOIN filtered_date ON ws_sold_date_sk = d_date_sk\n    JOIN filtered_item ON ws_item_sk = i_item_sk\n    WHERE ws_sales_price / ws_list_price BETWEEN 0.11 AND 0.21\n),\ncatalog_sales_filtered AS (\n    SELECT DISTINCT cs_ship_customer_sk\n    FROM catalog_sales\n    JOIN filtered_date ON cs_sold_date_sk = d_date_sk\n    JOIN filtered_item ON cs_item_sk = i_item_sk\n    WHERE cs_sales_price / cs_list_price BETWEEN 0.11 AND 0.21\n)\nSELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) AS cnt1,\n  cd_purchase_estimate,\n  COUNT(*) AS cnt2,\n  cd_credit_rating,\n  COUNT(*) AS cnt3,\n  cd_dep_count,\n  COUNT(*) AS cnt4,\n  cd_dep_employed_count,\n  COUNT(*) AS cnt5,\n  cd_dep_college_count,\n  COUNT(*) AS cnt6\nFROM customer AS c\nJOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics ON cd_demo_sk = c.c_current_cdemo_sk\nWHERE ca_county IN (\n    'Hickman County',\n    'Ohio County',\n    'Parke County',\n    'Pointe Coupee Parish',\n    'Siskiyou County'\n  )\n  AND c.c_birth_month IN (3, 8)\n  AND cd_marital_status IN ('S', 'U', 'M')\n  AND cd_education_status IN ('Secondary', 'Advanced Degree', '4 yr Degree')\n  AND cd_gender = 'M'\n  AND EXISTS (SELECT 1 FROM store_sales_filtered WHERE ss_customer_sk = c.c_customer_sk)\n  AND (\n    EXISTS (SELECT 1 FROM web_sales_filtered WHERE ws_bill_customer_sk = c.c_customer_sk)\n    OR EXISTS (SELECT 1 FROM catalog_sales_filtered WHERE cs_ship_customer_sk = c.c_customer_sk)\n  )\nGROUP BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nLIMIT 100;",
  "speedup": 0.7884319707407736,
  "status": "REGRESSION",
  "transforms": [
    "materialize_cte"
  ],
  "hint": "Materialize pre-filtered fact data from all three sales channels into separate CTEs, then join once to customer. Consider collapsing the OR of EXISTS subqueries into a single semi-join against a unified sales dataset.",
  "error_message": null
}