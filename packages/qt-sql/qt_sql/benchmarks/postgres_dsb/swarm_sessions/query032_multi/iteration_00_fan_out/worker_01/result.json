{
  "worker_id": 1,
  "strategy": "safe_pushdown_explicit_join",
  "examples_used": [
    "early_filter_decorrelate",
    "pg_date_cte_explicit_join",
    "pg_dimension_prefetch_star"
  ],
  "optimized_sql": "WITH filtered_dates AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_date BETWEEN '1999-03-07' AND CAST('1999-03-07' AS DATE) + INTERVAL '90 DAY'\n),\nfiltered_items AS (\n    SELECT i_item_sk\n    FROM item\n    WHERE i_manufact_id IN (1, 78, 97, 516, 521) \n       OR i_manager_id BETWEEN 25 AND 54\n),\nitem_avg_discount AS (\n    SELECT \n        cs_item_sk,\n        1.3 * AVG(cs_ext_discount_amt) AS avg_discount_threshold\n    FROM catalog_sales\n    JOIN filtered_dates ON d_date_sk = cs_sold_date_sk\n    WHERE cs_list_price BETWEEN 16 AND 45\n      AND cs_sales_price / cs_list_price BETWEEN 63 * 0.01 AND 83 * 0.01\n    GROUP BY cs_item_sk\n)\nSELECT\n    SUM(cs_ext_discount_amt) AS \"excess discount amount\"\nFROM catalog_sales\nJOIN filtered_items ON i_item_sk = cs_item_sk\nJOIN filtered_dates ON d_date_sk = cs_sold_date_sk\nLEFT JOIN item_avg_discount ON cs_item_sk = item_avg_discount.cs_item_sk\nWHERE cs_ext_discount_amt > avg_discount_threshold\nORDER BY SUM(cs_ext_discount_amt)\nLIMIT 100",
  "speedup": 0.0,
  "status": "ERROR",
  "transforms": [
    "decorrelate",
    "date_cte_isolate",
    "dimension_cte_isolate"
  ],
  "hint": "Use early filtering and decorrelation of the subquery, convert implicit joins to explicit joins, and pre-filter dimension tables to reduce join cost.",
  "error_message": "Execution failed: column reference \"cs_item_sk\" is ambiguous\nLINE 27: LEFT JOIN item_avg_discount ON cs_item_sk = item_avg_discoun...\n                                        ^\n",
  "error_messages": [
    "Execution failed: column reference \"cs_item_sk\" is ambiguous\nLINE 27: LEFT JOIN item_avg_discount ON cs_item_sk = item_avg_discoun...\n                                        ^\n"
  ],
  "error_category": "execution"
}