```sql
WITH filtered_dates AS (
    SELECT d_date_sk
    FROM date_dim
    WHERE d_year = 1999
      AND d_moy BETWEEN 5 AND 7
),
store_sales_agg AS (
    SELECT
        ss_item_sk,
        ss_store_sk,
        ss_customer_sk,
        ss_ticket_number,
        SUM(ss_net_profit) AS ss_net_profit
    FROM store_sales
    JOIN date_dim d1 ON ss_sold_date_sk = d1.d_date_sk
    WHERE d1.d_moy = 5
      AND d1.d_year = 1999
    GROUP BY ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number
)
SELECT
    i_item_id,
    i_item_desc,
    s_store_id,
    s_store_name,
    SUM(ss_net_profit) AS store_sales_profit,
    SUM(sr_net_loss) AS store_returns_loss,
    SUM(cs_net_profit) AS catalog_sales_profit
FROM store_sales_agg ss
JOIN store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk
                     AND ss.ss_item_sk = sr.sr_item_sk
                     AND ss.ss_ticket_number = sr.sr_ticket_number
JOIN filtered_dates d2 ON sr.sr_returned_date_sk = d2.d_date_sk
JOIN catalog_sales cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk
                     AND sr.sr_item_sk = cs.cs_item_sk
JOIN filtered_dates d3 ON cs.cs_sold_date_sk = d3.d_date_sk
JOIN store ON ss.ss_store_sk = store.s_store_sk
JOIN item ON ss.ss_item_sk = item.i_item_sk
GROUP BY
    i_item_id,
    i_item_desc,
    s_store_id,
    s_store_name
ORDER BY
    i_item_id,
    i_item_desc,
    s_store_id,
    s_store_name
LIMIT 100
```

**Changes**: Pre-aggregated store_sales early using the selective May 1999 filter, created a shared date_dim CTE for both store_returns and catalog_sales (May-Jul 1999), and converted to explicit joins with proper join order.

**Expected speedup**: ~2.5-3.0x due to reduced fact table scans, early aggregation of the largest table (store_sales), and elimination of redundant date_dim scans.