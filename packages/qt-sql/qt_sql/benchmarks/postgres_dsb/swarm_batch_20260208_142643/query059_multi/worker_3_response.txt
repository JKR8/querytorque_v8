```sql
WITH filtered_store AS (
  SELECT s_store_sk, s_store_id, s_store_name
  FROM store
  WHERE s_state IN ('GA', 'IA', 'LA', 'MO', 'SD', 'TN', 'TX', 'VA')
),
date_periods AS (
  SELECT 
    d_date_sk,
    d_week_seq,
    d_day_name,
    CASE 
      WHEN d_month_seq BETWEEN 1208 AND 1208 + 11 THEN 1
      WHEN d_month_seq BETWEEN 1208 + 12 AND 1208 + 23 THEN 2
    END AS period
  FROM date_dim
  WHERE d_month_seq BETWEEN 1208 AND 1208 + 23
),
store_sales_filtered AS (
  SELECT 
    ss_store_sk,
    ss_sold_date_sk,
    ss_sales_price,
    ss_list_price
  FROM store_sales
  WHERE ss_sales_price / ss_list_price BETWEEN 11 * 0.01 AND 31 * 0.01
),
wss_base AS (
  SELECT
    d.period,
    d.d_week_seq,
    ss.ss_store_sk,
    SUM(CASE WHEN d.d_day_name = 'Sunday' THEN ss.ss_sales_price END) AS sun_sales,
    SUM(CASE WHEN d.d_day_name = 'Monday' THEN ss.ss_sales_price END) AS mon_sales,
    SUM(CASE WHEN d.d_day_name = 'Tuesday' THEN ss.ss_sales_price END) AS tue_sales,
    SUM(CASE WHEN d.d_day_name = 'Wednesday' THEN ss.ss_sales_price END) AS wed_sales,
    SUM(CASE WHEN d.d_day_name = 'Thursday' THEN ss.ss_sales_price END) AS thu_sales,
    SUM(CASE WHEN d.d_day_name = 'Friday' THEN ss.ss_sales_price END) AS fri_sales,
    SUM(CASE WHEN d.d_day_name = 'Saturday' THEN ss.ss_sales_price END) AS sat_sales
  FROM store_sales_filtered ss
  JOIN date_periods d ON d.d_date_sk = ss.ss_sold_date_sk
  JOIN filtered_store s ON s.s_store_sk = ss.ss_store_sk
  WHERE d.period IS NOT NULL
  GROUP BY d.period, d.d_week_seq, ss.ss_store_sk
),
period1 AS (
  SELECT
    s.s_store_name,
    s.s_store_id,
    w.d_week_seq,
    w.sun_sales,
    w.mon_sales,
    w.tue_sales,
    w.wed_sales,
    w.thu_sales,
    w.fri_sales,
    w.sat_sales
  FROM wss_base w
  JOIN filtered_store s ON s.s_store_sk = w.ss_store_sk
  WHERE w.period = 1
),
period2 AS (
  SELECT
    s.s_store_name,
    s.s_store_id,
    w.d_week_seq,
    w.sun_sales,
    w.mon_sales,
    w.tue_sales,
    w.wed_sales,
    w.thu_sales,
    w.fri_sales,
    w.sat_sales
  FROM wss_base w
  JOIN filtered_store s ON s.s_store_sk = w.ss_store_sk
  WHERE w.period = 2
)
SELECT
  p1.s_store_name AS s_store_name1,
  p1.s_store_id AS s_store_id1,
  p1.d_week_seq AS d_week_seq1,
  p1.sun_sales / p2.sun_sales AS "sun_sales1 / sun_sales2",
  p1.mon_sales / p2.mon_sales AS "mon_sales1 / mon_sales2",
  p1.tue_sales / p2.tue_sales AS "tue_sales1 / tue_sales2",
  p1.wed_sales / p2.wed_sales AS "wed_sales1 / wed_sales2",
  p1.thu_sales / p2.thu_sales AS "thu_sales1 / thu_sales2",
  p1.fri_sales / p2.fri_sales AS "fri_sales1 / fri_sales2",
  p1.sat_sales / p2.sat_sales AS "sat_sales1 / sat_sales2"
FROM period1 p1
JOIN period2 p2 ON p1.s_store_id = p2.s_store_id 
  AND p1.d_week_seq = p2.d_week_seq - 52
ORDER BY p1.s_store_name, p1.s_store_id, p1.d_week_seq
LIMIT 100;
```

**Changes**: 
- Pre-filtered store and date dimension tables into separate CTEs with selective WHERE clauses
- Created a single base aggregation CTE that computes all sales metrics for both time periods
- Split the base aggregation into period-specific CTEs using a period indicator
- Restructured the self-join to use the pre-materialized period CTEs

**Expected speedup**: ~2.5-3.5x due to reduced fact table scanning, better dimension filtering, and eliminating redundant computation of the same base aggregation twice.