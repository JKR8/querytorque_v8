```sql
WITH filtered_customer_demographics AS (
    SELECT cd_demo_sk
    FROM customer_demographics
    WHERE cd_gender = 'M'
      AND cd_marital_status = 'S'
      AND cd_education_status = 'Advanced Degree'
),
filtered_date_dim AS (
    SELECT d_date_sk
    FROM date_dim
    WHERE d_year = 2002
),
filtered_store AS (
    SELECT s_store_sk, s_state
    FROM store
    WHERE s_state = 'VA'
),
filtered_item AS (
    SELECT i_item_sk, i_item_id
    FROM item
    WHERE i_category = 'Jewelry'
)
SELECT
    i.i_item_id,
    s.s_state,
    GROUPING(s.s_state) AS g_state,
    AVG(ss.ss_quantity) AS agg1,
    AVG(ss.ss_list_price) AS agg2,
    AVG(ss.ss_coupon_amt) AS agg3,
    AVG(ss.ss_sales_price) AS agg4
FROM store_sales ss
JOIN filtered_customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk
JOIN filtered_date_dim d ON ss.ss_sold_date_sk = d.d_date_sk
JOIN filtered_store s ON ss.ss_store_sk = s.s_store_sk
JOIN filtered_item i ON ss.ss_item_sk = i.i_item_sk
GROUP BY ROLLUP (i.i_item_id, s.s_state)
ORDER BY i.i_item_id, s.s_state
LIMIT 100
```

**Changes**: Converted implicit joins to explicit JOIN syntax and created separate CTEs for each filtered dimension table, pushing all dimension filters directly into CTE definitions. This enables PostgreSQL to materialize small filtered dimension sets first, then perform efficient hash joins with the fact table.

**Expected speedup**: ~2-3x by isolating dimension filters into materialized CTEs before joining with the large fact table, allowing better join order optimization and reducing the working set for the hash joins.