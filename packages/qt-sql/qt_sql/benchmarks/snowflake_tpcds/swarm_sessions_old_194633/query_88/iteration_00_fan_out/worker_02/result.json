{
  "worker_id": 2,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation"
  ],
  "optimized_sql": "WITH time_buckets AS (SELECT t_time_sk, CASE WHEN (t_hour = 8 AND t_minute >= 30) THEN 1 WHEN (t_hour = 9 AND t_minute < 30) THEN 2 WHEN (t_hour = 9 AND t_minute >= 30) THEN 3 WHEN (t_hour = 10 AND t_minute < 30) THEN 4 WHEN (t_hour = 10 AND t_minute >= 30) THEN 5 WHEN (t_hour = 11 AND t_minute < 30) THEN 6 WHEN (t_hour = 11 AND t_minute >= 30) THEN 7 WHEN (t_hour = 12 AND t_minute < 30) THEN 8 END AS interval_id FROM time_dim WHERE ((t_hour = 8 AND t_minute >= 30) OR (t_hour = 9 AND t_minute < 30) OR (t_hour = 9 AND t_minute >= 30) OR (t_hour = 10 AND t_minute < 30) OR (t_hour = 10 AND t_minute >= 30) OR (t_hour = 11 AND t_minute < 30) OR (t_hour = 11 AND t_minute >= 30) OR (t_hour = 12 AND t_minute < 30))), sales_agg AS (SELECT tb.interval_id, COUNT(*) AS cnt FROM store_sales ss JOIN time_buckets tb ON ss.ss_sold_time_sk = tb.t_time_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk WHERE s.s_store_name = 'ese' AND ((hd.hd_dep_count = -1 AND hd.hd_vehicle_count <= 1) OR (hd.hd_dep_count = 4 AND hd.hd_vehicle_count <= 6) OR (hd.hd_dep_count = 3 AND hd.hd_vehicle_count <= 5)) GROUP BY tb.interval_id), final AS (SELECT COALESCE(MAX(CASE WHEN interval_id = 1 THEN cnt END), 0) AS h8_30_to_9, COALESCE(MAX(CASE WHEN interval_id = 2 THEN cnt END), 0) AS h9_to_9_30, COALESCE(MAX(CASE WHEN interval_id = 3 THEN cnt END), 0) AS h9_30_to_10, COALESCE(MAX(CASE WHEN interval_id = 4 THEN cnt END), 0) AS h10_to_10_30, COALESCE(MAX(CASE WHEN interval_id = 5 THEN cnt END), 0) AS h10_30_to_11, COALESCE(MAX(CASE WHEN interval_id = 6 THEN cnt END), 0) AS h11_to_11_30, COALESCE(MAX(CASE WHEN interval_id = 7 THEN cnt END), 0) AS h11_30_to_12, COALESCE(MAX(CASE WHEN interval_id = 8 THEN cnt END), 0) AS h12_to_12_30 FROM sales_agg) SELECT * FROM final",
  "speedup": 0.0,
  "status": "ERROR",
  "transforms": [
    "decorrelate"
  ],
  "hint": "Use single_pass_aggregation's CASE grouping. Ignore bitmap techniques.",
  "error_message": "INTERFACE: [main_query] declares outputs ['h10_30_to_11', 'h10_to_10_30', 'h11_30_to_12', 'h11_to_11_30', 'h12_to_12_30', 'h8_30_to_9', 'h9_30_to_10', 'h9_to_9_30'] but SELECT only produces ['*'] | INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs | IO Error: Cannot open database \"/mnt/c/Users/jakc9/Documents/QueryTorque_V8/snowflake://JKDL:YourNewPassword123!@CVRYJTF-AW47074/SNOWFLAKE_SAMPLE_DATA/TPCDS_SF10TCL?warehouse=COMPUTE_WH&role=ACCOUNTADMIN\" in read-only mode: database does not exist",
  "error_messages": [
    "INTERFACE: [main_query] declares outputs ['h10_30_to_11', 'h10_to_10_30', 'h11_30_to_12', 'h11_to_11_30', 'h12_to_12_30', 'h8_30_to_9', 'h9_30_to_10', 'h9_to_9_30'] but SELECT only produces ['*']",
    "INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs",
    "IO Error: Cannot open database \"/mnt/c/Users/jakc9/Documents/QueryTorque_V8/snowflake://JKDL:YourNewPassword123!@CVRYJTF-AW47074/SNOWFLAKE_SAMPLE_DATA/TPCDS_SF10TCL?warehouse=COMPUTE_WH&role=ACCOUNTADMIN\" in read-only mode: database does not exist"
  ],
  "error_category": "execution"
}