{
  "worker_id": 2,
  "strategy": "aggregate_below_join",
  "examples_used": [
    "single_pass_aggregation"
  ],
  "optimized_sql": "WITH store_pre AS (SELECT s_store_sk FROM store WHERE s_state = 'SD'), ctr_agg AS (SELECT\n  sr_customer_sk,\n  sr_store_sk,\n  SUM(SR_FEE) AS ctr_total_return,\n  AVG(SUM(SR_FEE)) OVER (PARTITION BY sr_store_sk) * 1.2 AS avg_store\nFROM store_returns\nJOIN date_dim ON sr_returned_date_sk = d_date_sk\nJOIN store_pre ON sr_store_sk = s_store_sk\nWHERE d_year = 2000\nGROUP BY sr_customer_sk, sr_store_sk) SELECT c_customer_id\nFROM ctr_agg\nJOIN customer ON sr_customer_sk = c_customer_sk\nWHERE ctr_total_return > avg_store\nORDER BY c_customer_id\nLIMIT 100",
  "speedup": 0.6849957771447613,
  "status": "REGRESSION",
  "transforms": [
    "decorrelate"
  ],
  "hint": "Use window function for per-store avg. Ignore bitmap aggregation from example.",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}