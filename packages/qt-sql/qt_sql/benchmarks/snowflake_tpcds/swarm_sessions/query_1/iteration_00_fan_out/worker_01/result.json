{
  "worker_id": 1,
  "strategy": "cte_predicate_split",
  "examples_used": [
    "dimension_cte_isolate",
    "early_filter"
  ],
  "optimized_sql": "WITH ctr_base AS (SELECT\n    sr_customer_sk AS ctr_customer_sk,\n    sr_store_sk AS ctr_store_sk,\n    SUM(SR_FEE) AS ctr_total_return\nFROM store_returns\nJOIN date_dim ON store_returns.sr_returned_date_sk = date_dim.d_date_sk\nWHERE date_dim.d_year = 2000\nGROUP BY sr_customer_sk, sr_store_sk), ctr_sd AS (SELECT\n    ctr_base.ctr_customer_sk,\n    ctr_base.ctr_store_sk,\n    ctr_total_return\nFROM ctr_base\nJOIN store ON ctr_base.ctr_store_sk = store.s_store_sk\nWHERE store.s_state = 'SD'), ctr_avg AS (SELECT\n    ctr_store_sk,\n    AVG(ctr_total_return) * 1.2 AS avg_return\nFROM ctr_base\nGROUP BY ctr_store_sk) SELECT\n    customer.c_customer_id\nFROM ctr_sd\nJOIN customer ON ctr_sd.ctr_customer_sk = customer.c_customer_sk\nJOIN ctr_avg ON ctr_sd.ctr_store_sk = ctr_avg.ctr_store_sk\nWHERE ctr_sd.ctr_total_return > ctr_avg.avg_return\nORDER BY customer.c_customer_id\nLIMIT 100",
  "speedup": 0.7896625975987169,
  "status": "REGRESSION",
  "transforms": [
    "decorrelate"
  ],
  "hint": "Apply dimension_cte_isolate pattern to store table. Ignore date filtering from e",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}