{
  "worker_id": 4,
  "strategy": "qualify_filter",
  "examples_used": [
    "deferred_window_aggregation"
  ],
  "optimized_sql": "WITH ctr_qualified AS (SELECT\n    sr_customer_sk,\n    sr_store_sk,\n    SUM(SR_FEE) AS ctr_total_return,\n    AVG(SUM(SR_FEE)) OVER (PARTITION BY sr_store_sk) AS store_avg\nFROM store_returns\nJOIN date_dim ON sr_returned_date_sk = d_date_sk\nJOIN store ON sr_store_sk = s_store_sk\nWHERE d_year = 2000\n  AND s_state = 'SD'\nGROUP BY sr_customer_sk, sr_store_sk\nQUALIFY ctr_total_return > store_avg * 1.2) SELECT\n    c_customer_id\nFROM ctr_qualified\nJOIN store ON ctr_qualified.sr_store_sk = store.s_store_sk\nJOIN customer ON ctr_qualified.sr_customer_sk = c_customer_sk\nORDER BY c_customer_id\nLIMIT 100",
  "speedup": 0.9396861183155873,
  "status": "REGRESSION",
  "transforms": [
    "pushdown"
  ],
  "hint": "Move filter to QUALIFY. Ignore window merging from example.",
  "error_message": "INTERFACE: [ctr_qualified] SELECT produces ['store_avg'] not declared in outputs",
  "error_messages": [
    "INTERFACE: [ctr_qualified] SELECT produces ['store_avg'] not declared in outputs"
  ],
  "error_category": null,
  "exploratory": true
}