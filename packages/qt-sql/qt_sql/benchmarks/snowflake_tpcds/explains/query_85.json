{
  "execution_time_ms": null,
  "plan_text": "GlobalStats | 30129 | 30124 | 500899529728\n1 | 0 | Result | SUBSTR(REASON.R_REASON_DESC, 1, 20), SCALED_ROUND_INT_DIVIDE(SUM(SUM(SUM_INTERNAL(SUM_INTERNAL(SUM(SUM_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), COUNT(*)))), COUNT(COUNT(COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), COUNT(*))))), (SUM(SUM(SUM_INTERNAL(SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), COUNT(*))))) / (COUNT(COUNT(COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), COUNT(*))))), (SUM(SUM(SUM_INTERNAL(SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_FEE)))), COUNT(*)), COUNT(*))))) / (COUNT(COUNT(COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_FEE)))), COUNT(*)), COUNT(*)))))\n1 | 1 | [0] | SortWithLimit | sortKey: [SUBSTR(REASON.R_REASON_DESC, 1, 20) ASC NULLS LAST, SCALED_ROUND_INT_DIVIDE(SUM(WEB_SALES.WS_QUANTITY), COUNT(WEB_SALES.WS_QUANTITY)) ASC NULLS LAST, (SUM(WEB_RETURNS.WR_REFUNDED_CASH)) / (COUNT(WEB_RETURNS.WR_REFUNDED_CASH)) ASC NULLS LAST, (SUM(WEB_RETURNS.WR_FEE)) / (COUNT(WEB_RETURNS.WR_FEE)) ASC NULLS LAST], rowCount: 100\n1 | 2 | [1] | Aggregate | aggExprs: [SUM(SUM(SUM_INTERNAL(SUM_INTERNAL(SUM(SUM_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), COUNT(*)))), COUNT(COUNT(COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), COUNT(*)))), SUM(SUM(SUM_INTERNAL(SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), COUNT(*)))), COUNT(COUNT(COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), COUNT(*)))), SUM(SUM(SUM_INTERNAL(SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_FEE)))), COUNT(*)), COUNT(*)))), COUNT(COUNT(COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_FEE)))), COUNT(*)), COUNT(*))))], groupKeys: [REASON.R_REASON_DESC]\n1 | 3 | [2] | Aggregate | aggExprs: [SUM(SUM_INTERNAL(SUM_INTERNAL(SUM(SUM_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), COUNT(*))), SUM(SUM_INTERNAL(SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), COUNT(*))), SUM(SUM_INTERNAL(SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_FEE)))), COUNT(*)), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_FEE)))), COUNT(*)), COUNT(*)))], groupKeys: [REASON.R_REASON_DESC]\n1 | 4 | [3] | InnerJoin | joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_SALES.WS_WEB_PAGE_SK)\n1 | 5 | [4] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_PAGE | WP_WEB_PAGE_SK | 1 | 1 | 63488\n1 | 6 | [4] | Aggregate | aggExprs: [SUM_INTERNAL(SUM_INTERNAL(SUM(SUM_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), COUNT(*)), COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), COUNT(*)), SUM_INTERNAL(SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), COUNT(*)), COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), COUNT(*)), SUM_INTERNAL(SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_FEE)))), COUNT(*)), COUNT(*)), COUNT_INTERNAL(COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_FEE)))), COUNT(*)), COUNT(*))], groupKeys: [REASON.R_REASON_DESC, WEB_SALES.WS_WEB_PAGE_SK]\n1 | 7 | [6] | InnerJoin | joinKey: (REASON.R_REASON_SK = WEB_RETURNS.WR_REASON_SK)\n1 | 8 | [7] | Aggregate | aggExprs: [COUNT(*)], groupKeys: [REASON.R_REASON_DESC, REASON.R_REASON_SK]\n1 | 9 | [8] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.REASON | R_REASON_SK, R_REASON_DESC | 1 | 1 | 2560\n1 | 10 | [7] | Aggregate | aggExprs: [SUM_INTERNAL(SUM(SUM_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), COUNT_INTERNAL(COUNT(COUNT_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(*)), SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(*)), SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_RETURNS.WR_FEE)))), COUNT(*)), COUNT_INTERNAL(COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_FEE)))), COUNT(*))], groupKeys: [WEB_SALES.WS_WEB_PAGE_SK, WEB_RETURNS.WR_REASON_SK]\n1 | 11 | [10] | InnerJoin | joinKey: (WEB_RETURNS.WR_REFUNDED_ADDR_SK = CUSTOMER_ADDRESS.CA_ADDRESS_SK), joinFilter: ((CUSTOMER_ADDRESS.CA_STATE IN 'FL' IN 'TX' IN 'DE') AND ((WEB_SALES.WS_NET_PROFIT >= 100) AND (WEB_SALES.WS_NET_PROFIT <= 200))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'IN' IN 'ND' IN 'ID') AND ((WEB_SALES.WS_NET_PROFIT >= 150) AND (WEB_SALES.WS_NET_PROFIT <= 300))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'MT' IN 'IL' IN 'OH') AND ((WEB_SALES.WS_NET_PROFIT >= 50) AND (WEB_SALES.WS_NET_PROFIT <= 250)))\n1 | 12 | [11] | Aggregate | aggExprs: [SUM(SUM_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), COUNT(COUNT_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*))), SUM(SUM(SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH)))), COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH)))), SUM(SUM(SUM(SUM(WEB_RETURNS.WR_FEE)))), COUNT(COUNT(COUNT(COUNT(WEB_RETURNS.WR_FEE))))], groupKeys: [WEB_SALES.WS_WEB_PAGE_SK, WEB_RETURNS.WR_REASON_SK, WEB_RETURNS.WR_REFUNDED_ADDR_SK, WEB_SALES.WS_NET_PROFIT]\n1 | 13 | [12] | InnerJoin | joinKey: (DATE_DIM.D_DATE_SK = WEB_SALES.WS_SOLD_DATE_SK)\n1 | 14 | [13] | Filter | DATE_DIM.D_YEAR = 2000\n1 | 15 | [14] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE_SK, D_YEAR | 1 | 1 | 2138624\n1 | 16 | [13] | Aggregate | aggExprs: [SUM_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*)), COUNT_INTERNAL(WEB_SALES.WS_QUANTITY, COUNT(*)), SUM(SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH))), COUNT(COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH))), SUM(SUM(SUM(WEB_RETURNS.WR_FEE))), COUNT(COUNT(COUNT(WEB_RETURNS.WR_FEE)))], groupKeys: [WEB_SALES.WS_WEB_PAGE_SK, WEB_RETURNS.WR_REASON_SK, WEB_RETURNS.WR_REFUNDED_ADDR_SK, WEB_SALES.WS_NET_PROFIT, WEB_SALES.WS_SOLD_DATE_SK]\n1 | 17 | [16] | InnerJoin | joinKey: (WEB_RETURNS.WR_ITEM_SK = WEB_SALES.WS_ITEM_SK) AND (WEB_RETURNS.WR_ORDER_NUMBER = WEB_SALES.WS_ORDER_NUMBER), joinFilter: ((CD1.CD_MARITAL_STATUS = 'M') AND (CD1.CD_EDUCATION_STATUS = '4 yr Degree') AND ((WEB_SALES.WS_SALES_PRICE >= 100) AND (WEB_SALES.WS_SALES_PRICE <= 150))) OR ((CD1.CD_MARITAL_STATUS = 'S') AND (CD1.CD_EDUCATION_STATUS = 'Secondary') AND ((WEB_SALES.WS_SALES_PRICE >= 50) AND (WEB_SALES.WS_SALES_PRICE <= 100))) OR ((CD1.CD_MARITAL_STATUS = 'W') AND (CD1.CD_EDUCATION_STATUS = 'Advanced Degree') AND ((WEB_SALES.WS_SALES_PRICE >= 150) AND (WEB_SALES.WS_SALES_PRICE <= 200)))\n1 | 18 | [17] | Aggregate | aggExprs: [SUM(SUM(WEB_RETURNS.WR_REFUNDED_CASH)), COUNT(COUNT(WEB_RETURNS.WR_REFUNDED_CASH)), SUM(SUM(WEB_RETURNS.WR_FEE)), COUNT(COUNT(WEB_RETURNS.WR_FEE)), COUNT(*)], groupKeys: [WEB_RETURNS.WR_REASON_SK, WEB_RETURNS.WR_REFUNDED_ADDR_SK, WEB_RETURNS.WR_ITEM_SK, WEB_RETURNS.WR_ORDER_NUMBER, CD1.CD_MARITAL_STATUS, CD1.CD_EDUCATION_STATUS]\n1 | 19 | [18] | InnerJoin | joinKey: (CD1.CD_DEMO_SK = WEB_RETURNS.WR_REFUNDED_CDEMO_SK) AND (CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS) AND (CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS)\n1 | 20 | [19] | Filter | (CD1.CD_MARITAL_STATUS IN 'M' IN 'S' IN 'W') AND (CD1.CD_EDUCATION_STATUS IN '4 yr Degree' IN 'Secondary' IN 'Advanced Degree')\n1 | 21 | [20] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS | CD1 | CD_DEMO_SK, CD_MARITAL_STATUS, CD_EDUCATION_STATUS | 1 | 1 | 7446528\n1 | 22 | [19] | Aggregate | aggExprs: [SUM(WEB_RETURNS.WR_REFUNDED_CASH), COUNT(WEB_RETURNS.WR_REFUNDED_CASH), SUM(WEB_RETURNS.WR_FEE), COUNT(WEB_RETURNS.WR_FEE), COUNT(*)], groupKeys: [WEB_RETURNS.WR_REASON_SK, WEB_RETURNS.WR_REFUNDED_ADDR_SK, WEB_RETURNS.WR_ITEM_SK, WEB_RETURNS.WR_ORDER_NUMBER, WEB_RETURNS.WR_REFUNDED_CDEMO_SK, CD2.CD_EDUCATION_STATUS, CD2.CD_MARITAL_STATUS]\n1 | 23 | [22] | JoinFilter | joinKey: (CD1.CD_DEMO_SK = WEB_RETURNS.WR_REFUNDED_CDEMO_SK) AND (CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS) AND (CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS)\n1 | 24 | [23] | InnerJoin | joinKey: (CD2.CD_DEMO_SK = WEB_RETURNS.WR_RETURNING_CDEMO_SK)\n1 | 25 | [24] | Filter | (CD2.CD_MARITAL_STATUS IN 'M' IN 'S' IN 'W') AND (CD2.CD_EDUCATION_STATUS IN '4 yr Degree' IN 'Secondary' IN 'Advanced Degree')\n1 | 26 | [25] | JoinFilter | joinKey: (CD1.CD_DEMO_SK = WEB_RETURNS.WR_REFUNDED_CDEMO_SK) AND (CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS) AND (CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS)\n1 | 27 | [26] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_DEMOGRAPHICS | CD2 | CD_DEMO_SK, CD_MARITAL_STATUS, CD_EDUCATION_STATUS | 1 | 1 | 7446528\n1 | 28 | [24] | Filter | (WEB_RETURNS.WR_RETURNING_CDEMO_SK IS NOT NULL) AND (WEB_RETURNS.WR_REFUNDED_ADDR_SK IS NOT NULL) AND (WEB_RETURNS.WR_REFUNDED_CDEMO_SK IS NOT NULL) AND (WEB_RETURNS.WR_REASON_SK IS NOT NULL)\n1 | 29 | [28] | JoinFilter | joinKey: (REASON.R_REASON_SK = WEB_RETURNS.WR_REASON_SK)\n1 | 30 | [29] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_RETURNS | WR_ITEM_SK, WR_REFUNDED_CDEMO_SK, WR_REFUNDED_ADDR_SK, WR_RETURNING_CDEMO_SK, WR_REASON_SK, WR_ORDER_NUMBER, WR_FEE, WR_REFUNDED_CASH | 2289 | 2289 | 39149218304\n1 | 31 | [17] | Filter | ((WEB_SALES.WS_SALES_PRICE >= 100) OR (WEB_SALES.WS_SALES_PRICE >= 50) OR (WEB_SALES.WS_SALES_PRICE <= 100) OR (WEB_SALES.WS_SALES_PRICE >= 150) OR (WEB_SALES.WS_SALES_PRICE <= 200)) AND ((WEB_SALES.WS_SALES_PRICE <= 150) OR (WEB_SALES.WS_SALES_PRICE >= 50) OR (WEB_SALES.WS_SALES_PRICE <= 100) OR (WEB_SALES.WS_SALES_PRICE >= 150) OR (WEB_SALES.WS_SALES_PRICE <= 200)) AND ((WEB_SALES.WS_NET_PROFIT >= 100) OR (WEB_SALES.WS_NET_PROFIT >= 150) OR (WEB_SALES.WS_NET_PROFIT <= 300) OR (WEB_SALES.WS_NET_PROFIT >= 50) OR (WEB_SALES.WS_NET_PROFIT <= 250)) AND ((WEB_SALES.WS_NET_PROFIT <= 200) OR (WEB_SALES.WS_NET_PROFIT >= 150) OR (WEB_SALES.WS_NET_PROFIT <= 300) OR (WEB_SALES.WS_NET_PROFIT >= 50) OR (WEB_SALES.WS_NET_PROFIT <= 250)) AND (WEB_SALES.WS_WEB_PAGE_SK IS NOT NULL) AND (WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL)\n1 | 32 | [31] | JoinFilter | joinKey: (WEB_PAGE.WP_WEB_PAGE_SK = WEB_SALES.WS_WEB_PAGE_SK)\n1 | 33 | [32] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES | WS_SOLD_DATE_SK, WS_ITEM_SK, WS_WEB_PAGE_SK, WS_ORDER_NUMBER, WS_QUANTITY, WS_SALES_PRICE, WS_NET_PROFIT | 27579 | 27574 | 460956759040\n1 | 34 | [11] | Aggregate | aggExprs: [COUNT(*)], groupKeys: [CUSTOMER_ADDRESS.CA_ADDRESS_SK, CUSTOMER_ADDRESS.CA_STATE]\n1 | 35 | [34] | Filter | (CUSTOMER_ADDRESS.CA_COUNTRY = 'United States') AND ((CUSTOMER_ADDRESS.CA_STATE IN 'FL' IN 'TX' IN 'DE') OR (CUSTOMER_ADDRESS.CA_STATE IN 'IN' IN 'ND' IN 'ID') OR (CUSTOMER_ADDRESS.CA_STATE IN 'MT' IN 'IL' IN 'OH'))\n1 | 36 | [35] | JoinFilter | joinKey: (WEB_RETURNS.WR_REFUNDED_ADDR_SK = CUSTOMER_ADDRESS.CA_ADDRESS_SK), joinFilter: ((CUSTOMER_ADDRESS.CA_STATE IN 'FL' IN 'TX' IN 'DE') AND ((WEB_SALES.WS_NET_PROFIT >= 100) AND (WEB_SALES.WS_NET_PROFIT <= 200))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'IN' IN 'ND' IN 'ID') AND ((WEB_SALES.WS_NET_PROFIT >= 150) AND (WEB_SALES.WS_NET_PROFIT <= 300))) OR ((CUSTOMER_ADDRESS.CA_STATE IN 'MT' IN 'IL' IN 'OH') AND ((WEB_SALES.WS_NET_PROFIT >= 50) AND (WEB_SALES.WS_NET_PROFIT <= 250)))\n1 | 37 | [36] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CUSTOMER_ADDRESS | CA_ADDRESS_SK, CA_STATE, CA_COUNTRY | 256 | 256 | 776454656",
  "plan_json": null,
  "actual_rows": null
}