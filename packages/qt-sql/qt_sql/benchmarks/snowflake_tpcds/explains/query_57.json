{
  "execution_time_ms": null,
  "plan_text": "GlobalStats | 54926 | 54926 | 923643444224\n1 | 0 | Result | V1.I_BRAND, V1.D_YEAR, V1.AVG_MONTHLY_SALES, V1.SUM_SALES, V1_LAG.SUM_SALES, V1_LEAD.SUM_SALES\n1 | 1 | [0] | SortWithLimit | sortKey: [(V1.SUM_SALES) - V1.AVG_MONTHLY_SALES ASC NULLS LAST, V1_LEAD.SUM_SALES ASC NULLS LAST], rowCount: 100\n1 | 2 | [1] | InnerJoin | joinKey: (V1.RN = (V1_LAG.RN) + 1) AND (V1.CC_NAME = V1_LAG.CC_NAME) AND (V1.I_BRAND = V1_LAG.I_BRAND) AND (V1.I_CATEGORY = V1_LAG.I_CATEGORY)\n1 | 3 | [2] | InnerJoin | joinKey: (V1.RN = (V1_LEAD.RN) - 1) AND (V1.CC_NAME = V1_LEAD.CC_NAME) AND (V1.I_BRAND = V1_LEAD.I_BRAND) AND (V1.I_CATEGORY = V1_LEAD.I_CATEGORY)\n1 | 4 | [3] | WithReference\n1 | 5 | [4] | Filter | (DATE_DIM.D_YEAR = 1999) AND (AVG(SUM(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR) > 0) AND ((CASE_FLATTENED(AVG(SUM(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR) > 0, SCALED_ROUND_INT_DIVIDE(ABS((SUM(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))))) - AVG(SUM(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR)), AVG(SUM(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR)), null)) > 0.1) AND (ITEM.I_BRAND IS NOT NULL) AND (ITEM.I_CATEGORY IS NOT NULL)\n1 | 6 | [5, 25, 28] | WithClause | V1\n1 | 7 | [6] | WindowFunction | AVG(SUM(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))))) OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR), RANK() OVER (PARTITION BY ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME ORDER BY DATE_DIM.D_YEAR ASC NULLS LAST, DATE_DIM.D_MOY ASC NULLS LAST)\n1 | 8 | [7] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))))], groupKeys: [ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR, DATE_DIM.D_MOY]\n1 | 9 | [8] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))))], groupKeys: [ITEM.I_CATEGORY, ITEM.I_BRAND, CALL_CENTER.CC_NAME, DATE_DIM.D_YEAR, DATE_DIM.D_MOY]\n1 | 10 | [9] | InnerJoin | joinKey: (CALL_CENTER.CC_CALL_CENTER_SK = CATALOG_SALES.CS_CALL_CENTER_SK)\n1 | 11 | [10] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CALL_CENTER | CC_CALL_CENTER_SK, CC_NAME | 1 | 1 | 18432\n1 | 12 | [10] | Aggregate | aggExprs: [SUM(SUM(SUM(CATALOG_SALES.CS_SALES_PRICE)))], groupKeys: [ITEM.I_CATEGORY, ITEM.I_BRAND, DATE_DIM.D_YEAR, DATE_DIM.D_MOY, CATALOG_SALES.CS_CALL_CENTER_SK]\n1 | 13 | [12] | InnerJoin | joinKey: (ITEM.I_ITEM_SK = CATALOG_SALES.CS_ITEM_SK)\n1 | 14 | [13] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM | I_ITEM_SK, I_BRAND, I_CATEGORY | 2 | 2 | 23811584\n1 | 15 | [13] | Aggregate | aggExprs: [SUM(SUM(CATALOG_SALES.CS_SALES_PRICE))], groupKeys: [DATE_DIM.D_YEAR, DATE_DIM.D_MOY, CATALOG_SALES.CS_CALL_CENTER_SK, CATALOG_SALES.CS_ITEM_SK]\n1 | 16 | [15] | InnerJoin | joinKey: (DATE_DIM.D_DATE_SK = CATALOG_SALES.CS_SOLD_DATE_SK)\n1 | 17 | [16] | Filter | (DATE_DIM.D_YEAR IN 1999 IN 1998 IN 2000) AND ((DATE_DIM.D_YEAR = 1999) OR ((DATE_DIM.D_YEAR = 1998) AND (DATE_DIM.D_MOY = 12)) OR ((DATE_DIM.D_YEAR = 2000) AND (DATE_DIM.D_MOY = 1)))\n1 | 18 | [17] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE_SK, D_YEAR, D_MOY | 1 | 1 | 2138624\n1 | 19 | [16] | Aggregate | aggExprs: [SUM(CATALOG_SALES.CS_SALES_PRICE)], groupKeys: [CATALOG_SALES.CS_CALL_CENTER_SK, CATALOG_SALES.CS_ITEM_SK, CATALOG_SALES.CS_SOLD_DATE_SK]\n1 | 20 | [19] | Filter | (CATALOG_SALES.CS_CALL_CENTER_SK IS NOT NULL) AND (CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL)\n1 | 21 | [20] | JoinFilter | joinKey: (CALL_CENTER.CC_CALL_CENTER_SK = CATALOG_SALES.CS_CALL_CENTER_SK)\n1 | 22 | [21] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES | CS_SOLD_DATE_SK, CS_CALL_CENTER_SK, CS_ITEM_SK, CS_SALES_PRICE | 54922 | 54922 | 923617475584\n1 | 23 | [3] | JoinFilter | joinKey: (V1.RN = (V1_LEAD.RN) - 1) AND (V1.CC_NAME = V1_LEAD.CC_NAME) AND (V1.I_BRAND = V1_LEAD.I_BRAND) AND (V1.I_CATEGORY = V1_LEAD.I_CATEGORY)\n1 | 24 | [23] | WithReference | V1_LEAD\n1 | 25 | [24] | Filter | (V1_LEAD.I_BRAND IS NOT NULL) AND (V1_LEAD.I_CATEGORY IS NOT NULL)\n1 | 26 | [2] | JoinFilter | joinKey: (V1.RN = (V1_LAG.RN) + 1) AND (V1.CC_NAME = V1_LAG.CC_NAME) AND (V1.I_BRAND = V1_LAG.I_BRAND) AND (V1.I_CATEGORY = V1_LAG.I_CATEGORY)\n1 | 27 | [26] | WithReference | V1_LAG\n1 | 28 | [27] | Filter | (ITEM.I_BRAND IS NOT NULL) AND (ITEM.I_CATEGORY IS NOT NULL)",
  "plan_json": null,
  "actual_rows": null
}