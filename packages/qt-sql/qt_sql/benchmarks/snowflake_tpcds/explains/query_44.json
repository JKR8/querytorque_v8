{
  "execution_time_ms": null,
  "plan_text": "GlobalStats | 145440 | 145440 | 2503895804928\n1 | 0 | Result | (SUM(STORE_SALES.SS_NET_PROFIT)) / (COUNT(STORE_SALES.SS_NET_PROFIT))\n1 | 3 | [2] | Aggregate | aggExprs: [SUM(STORE_SALES.SS_NET_PROFIT), COUNT(STORE_SALES.SS_NET_PROFIT)], groupKeys: [STORE_SALES.SS_STORE_SK]\n1 | 4 | [3] | Filter | (STORE_SALES.SS_STORE_SK = 146) AND (STORE_SALES.SS_ADDR_SK IS NULL)\n1 | 5 | [4] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES | SS_ADDR_SK, SS_STORE_SK, SS_NET_PROFIT | 72718 | 72718 | 1251924090880\n2 | 0 | Result | RANK() OVER (ORDER BY (SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT)) ASC NULLS LAST), I1.I_PRODUCT_NAME, I2.I_PRODUCT_NAME\n2 | 1 | [0] | SortWithLimit | sortKey: [V11.RNK ASC NULLS LAST], rowCount: 100\n2 | 2 | [1] | InnerJoin | joinKey: (SS1.SS_ITEM_SK = I1.I_ITEM_SK)\n2 | 3 | [2] | InnerJoin | joinKey: (RANK() OVER (ORDER BY (SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT)) ASC NULLS LAST) = RANK() OVER (ORDER BY (SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT)) DESC NULLS FIRST))\n2 | 4 | [3] | Filter | RANK() OVER (ORDER BY (SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT)) ASC NULLS LAST) < 11\n2 | 5 | [4] | WindowFunction | RANK() OVER (ORDER BY (SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT)) ASC NULLS LAST)\n2 | 6 | [5] | Filter | ((SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT))) > (0.9 * ConstantSubquery0)\n2 | 9 | [8] | Aggregate | aggExprs: [SUM(SS1.SS_NET_PROFIT), COUNT(SS1.SS_NET_PROFIT)], groupKeys: [SS1.SS_ITEM_SK]\n2 | 10 | [9] | Filter | (SS1.SS_STORE_SK = 146) AND (SS1.SS_NET_PROFIT IS NOT NULL)\n2 | 11 | [10] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES | SS1 | SS_ITEM_SK, SS_STORE_SK, SS_NET_PROFIT | 72718 | 72718 | 1251924090880\n2 | 12 | [3] | InnerJoin | joinKey: (SS1.SS_ITEM_SK = I2.I_ITEM_SK)\n2 | 13 | [12] | Filter | RANK() OVER (ORDER BY (SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT)) DESC NULLS FIRST) < 11\n2 | 14 | [13] | JoinFilter | joinKey: (RANK() OVER (ORDER BY (SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT)) ASC NULLS LAST) = RANK() OVER (ORDER BY (SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT)) DESC NULLS FIRST))\n2 | 15 | [14] | WindowFunction | RANK() OVER (ORDER BY (SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT)) DESC NULLS FIRST)\n2 | 16 | [15] | Filter | ((SUM(SS1.SS_NET_PROFIT)) / (COUNT(SS1.SS_NET_PROFIT))) > (0.9 * Subquery(Step1))\n2 | 18 | [12] | JoinFilter | joinKey: (SS1.SS_ITEM_SK = I2.I_ITEM_SK)\n2 | 19 | [18] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM | I2 | I_ITEM_SK, I_PRODUCT_NAME | 2 | 2 | 23811584\n2 | 20 | [2] | JoinFilter | joinKey: (SS1.SS_ITEM_SK = I1.I_ITEM_SK)\n2 | 21 | [20] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM | I1 | I_ITEM_SK, I_PRODUCT_NAME | 2 | 2 | 23811584",
  "plan_json": null,
  "actual_rows": null
}