{
  "execution_time_ms": null,
  "plan_text": "GlobalStats | 82504 | 82298 | 1381147276288\n1 | 0 | Result | WSWSCS.D_WEEK_SEQ, ROUND((WSWSCS.SUN_SALES) / (WSWSCS_0.SUN_SALES), 2), ROUND((WSWSCS.MON_SALES) / (WSWSCS_0.MON_SALES), 2), ROUND((WSWSCS.TUE_SALES) / (WSWSCS_0.TUE_SALES), 2), ROUND((WSWSCS.WED_SALES) / (WSWSCS_0.WED_SALES), 2), ROUND((WSWSCS.THU_SALES) / (WSWSCS_0.THU_SALES), 2), ROUND((WSWSCS.FRI_SALES) / (WSWSCS_0.FRI_SALES), 2), ROUND((WSWSCS.SAT_SALES) / (WSWSCS_0.SAT_SALES), 2)\n1 | 1 | [0] | Sort | WSWSCS.D_WEEK_SEQ ASC NULLS LAST\n1 | 2 | [1] | InnerJoin | joinKey: (DATE_DIM.D_WEEK_SEQ = WSWSCS.D_WEEK_SEQ)\n1 | 3 | [2] | InnerJoin | joinKey: (DATE_DIM.D_WEEK_SEQ = WSWSCS_0.D_WEEK_SEQ - 53)\n1 | 4 | [3] | Filter | DATE_DIM.D_YEAR = 1998\n1 | 5 | [4] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_WEEK_SEQ, D_YEAR | 1 | 1 | 2138624\n1 | 6 | [3] | InnerJoin | joinKey: (DATE_DIM_0.D_WEEK_SEQ = WSWSCS_0.D_WEEK_SEQ)\n1 | 7 | [6] | Filter | DATE_DIM_0.D_YEAR = 1999\n1 | 8 | [7] | JoinFilter | joinKey: (DATE_DIM.D_WEEK_SEQ = WSWSCS_0.D_WEEK_SEQ - 53)\n1 | 9 | [8] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | DATE_DIM_0 | D_WEEK_SEQ, D_YEAR | 1 | 1 | 2138624\n1 | 10 | [6] | JoinFilter | joinKey: (DATE_DIM.D_WEEK_SEQ = WSWSCS_0.D_WEEK_SEQ - 53)\n1 | 11 | [10] | WithReference | WSWSCS_0\n1 | 12 | [11, 27] | WithClause | WSWSCS\n1 | 13 | [12] | Aggregate | aggExprs: [SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Sunday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)).condAggr(0), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Monday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)).condAggr(1), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Tuesday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)).condAggr(2), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Wednesday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)).condAggr(3), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Thursday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)).condAggr(4), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Friday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)).condAggr(5), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Saturday', UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE), null)).condAggr(6)], groupKeys: [DATE_DIM.D_WEEK_SEQ]\n1 | 14 | [13] | Aggregate | aggExprs: [SUM_INTERNAL(SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE)), COUNT(*))], groupKeys: [IFF(DATE_DIM.D_DAY_NAME = 'Sunday', 0, IFF(DATE_DIM.D_DAY_NAME = 'Monday', 1, IFF(DATE_DIM.D_DAY_NAME = 'Tuesday', 2, IFF(DATE_DIM.D_DAY_NAME = 'Wednesday', 3, IFF(DATE_DIM.D_DAY_NAME = 'Thursday', 4, IFF(DATE_DIM.D_DAY_NAME = 'Friday', 5, IFF(DATE_DIM.D_DAY_NAME = 'Saturday', 6, null))))))), DATE_DIM.D_WEEK_SEQ]\n1 | 15 | [14] | InnerJoin | joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(WEB_SALES.WS_SOLD_DATE_SK, CATALOG_SALES.CS_SOLD_DATE_SK))\n1 | 16 | [15] | Aggregate | aggExprs: [COUNT(*)], groupKeys: [IFF(DATE_DIM.D_DAY_NAME = 'Sunday', 0, IFF(DATE_DIM.D_DAY_NAME = 'Monday', 1, IFF(DATE_DIM.D_DAY_NAME = 'Tuesday', 2, IFF(DATE_DIM.D_DAY_NAME = 'Wednesday', 3, IFF(DATE_DIM.D_DAY_NAME = 'Thursday', 4, IFF(DATE_DIM.D_DAY_NAME = 'Friday', 5, IFF(DATE_DIM.D_DAY_NAME = 'Saturday', 6, null))))))), DATE_DIM.D_WEEK_SEQ, DATE_DIM.D_DATE_SK]\n1 | 17 | [16] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE_SK, D_WEEK_SEQ, D_DAY_NAME | 1 | 1 | 2138624\n1 | 18 | [15] | Aggregate | aggExprs: [SUM(UNION_ALL(WEB_SALES.WS_EXT_SALES_PRICE, CATALOG_SALES.CS_EXT_SALES_PRICE))], groupKeys: [UNION_ALL(WEB_SALES.WS_SOLD_DATE_SK, CATALOG_SALES.CS_SOLD_DATE_SK)]\n1 | 19 | [18] | UnionAll\n1 | 20 | [19] | Filter | WEB_SALES.WS_SOLD_DATE_SK IS NOT NULL\n1 | 21 | [20] | JoinFilter | joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(WEB_SALES.WS_SOLD_DATE_SK, CATALOG_SALES.CS_SOLD_DATE_SK))\n1 | 22 | [21] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WEB_SALES | WS_SOLD_DATE_SK, WS_EXT_SALES_PRICE | 27579 | 27574 | 460956759040\n1 | 23 | [19] | Filter | CATALOG_SALES.CS_SOLD_DATE_SK IS NOT NULL\n1 | 24 | [23] | JoinFilter | joinKey: (DATE_DIM.D_DATE_SK = UNION_ALL(WEB_SALES.WS_SOLD_DATE_SK, CATALOG_SALES.CS_SOLD_DATE_SK))\n1 | 25 | [24] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.CATALOG_SALES | CS_SOLD_DATE_SK, CS_EXT_SALES_PRICE | 54922 | 54721 | 920184101376\n1 | 26 | [2] | JoinFilter | joinKey: (DATE_DIM.D_WEEK_SEQ = WSWSCS.D_WEEK_SEQ)\n1 | 27 | [26] | WithReference",
  "plan_json": null,
  "actual_rows": null
}