{
  "execution_time_ms": null,
  "plan_text": "GlobalStats | 72723 | 72723 | 1251930778112\n1 | 0 | Result | STORE.S_STORE_NAME, STORE.S_STORE_ID, WSS.D_WEEK_SEQ, (WSS.SUN_SALES) / (WSS_0.SUN_SALES), (WSS.MON_SALES) / (WSS_0.MON_SALES), (WSS.TUE_SALES) / (WSS_0.TUE_SALES), (WSS.WED_SALES) / (WSS_0.WED_SALES), (WSS.THU_SALES) / (WSS_0.THU_SALES), (WSS.FRI_SALES) / (WSS_0.FRI_SALES), (WSS.SAT_SALES) / (WSS_0.SAT_SALES)\n1 | 1 | [0] | SortWithLimit | sortKey: [STORE.S_STORE_NAME ASC NULLS LAST, STORE.S_STORE_ID ASC NULLS LAST, WSS.D_WEEK_SEQ ASC NULLS LAST], rowCount: 100\n1 | 2 | [1] | InnerJoin | joinKey: (D.D_WEEK_SEQ = WSS.D_WEEK_SEQ)\n1 | 3 | [2] | Filter | (D.D_MONTH_SEQ >= 1196) AND (D.D_MONTH_SEQ <= 1207)\n1 | 4 | [3] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D | D_MONTH_SEQ, D_WEEK_SEQ | 1 | 1 | 2138624\n1 | 5 | [2] | InnerJoin | joinKey: (STORE.S_STORE_SK = WSS.SS_STORE_SK) AND (WSS_0.D_WEEK_SEQ - 52 = WSS.D_WEEK_SEQ)\n1 | 6 | [5] | InnerJoin | joinKey: (STORE.S_STORE_ID = STORE_0.S_STORE_ID)\n1 | 7 | [6] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE | S_STORE_SK, S_STORE_ID, S_STORE_NAME | 1 | 1 | 135680\n1 | 8 | [6] | InnerJoin | joinKey: (STORE_0.S_STORE_SK = WSS_0.SS_STORE_SK)\n1 | 9 | [8] | JoinFilter | joinKey: (STORE.S_STORE_ID = STORE_0.S_STORE_ID)\n1 | 10 | [9] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE | STORE_0 | S_STORE_SK, S_STORE_ID | 1 | 1 | 135680\n1 | 11 | [8] | InnerJoin | joinKey: (D_0.D_WEEK_SEQ = WSS_0.D_WEEK_SEQ)\n1 | 12 | [11] | Filter | (D_0.D_MONTH_SEQ >= 1208) AND (D_0.D_MONTH_SEQ <= 1219)\n1 | 13 | [12] | JoinFilter | joinKey: (D.D_WEEK_SEQ = WSS.D_WEEK_SEQ)\n1 | 14 | [13] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_0 | D_MONTH_SEQ, D_WEEK_SEQ | 1 | 1 | 2138624\n1 | 15 | [11] | JoinFilter | joinKey: (D.D_WEEK_SEQ = WSS.D_WEEK_SEQ)\n1 | 16 | [15] | WithReference | WSS_0\n1 | 17 | [16] | Filter | WSS_0.SS_STORE_SK IS NOT NULL\n1 | 18 | [17, 31] | WithClause | WSS\n1 | 19 | [18] | Aggregate | aggExprs: [SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Sunday', STORE_SALES.SS_SALES_PRICE, null)).condAggr(0), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Monday', STORE_SALES.SS_SALES_PRICE, null)).condAggr(1), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Tuesday', STORE_SALES.SS_SALES_PRICE, null)).condAggr(2), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Wednesday', STORE_SALES.SS_SALES_PRICE, null)).condAggr(3), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Thursday', STORE_SALES.SS_SALES_PRICE, null)).condAggr(4), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Friday', STORE_SALES.SS_SALES_PRICE, null)).condAggr(5), SUM(CASE_FLATTENED(DATE_DIM.D_DAY_NAME = 'Saturday', STORE_SALES.SS_SALES_PRICE, null)).condAggr(6)], groupKeys: [DATE_DIM.D_WEEK_SEQ, STORE_SALES.SS_STORE_SK]\n1 | 20 | [19] | Aggregate | aggExprs: [SUM_INTERNAL(SUM(STORE_SALES.SS_SALES_PRICE), COUNT(*))], groupKeys: [IFF(DATE_DIM.D_DAY_NAME = 'Sunday', 0, IFF(DATE_DIM.D_DAY_NAME = 'Monday', 1, IFF(DATE_DIM.D_DAY_NAME = 'Tuesday', 2, IFF(DATE_DIM.D_DAY_NAME = 'Wednesday', 3, IFF(DATE_DIM.D_DAY_NAME = 'Thursday', 4, IFF(DATE_DIM.D_DAY_NAME = 'Friday', 5, IFF(DATE_DIM.D_DAY_NAME = 'Saturday', 6, null))))))), DATE_DIM.D_WEEK_SEQ, STORE_SALES.SS_STORE_SK]\n1 | 21 | [20] | InnerJoin | joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)\n1 | 22 | [21] | Aggregate | aggExprs: [COUNT(*)], groupKeys: [IFF(DATE_DIM.D_DAY_NAME = 'Sunday', 0, IFF(DATE_DIM.D_DAY_NAME = 'Monday', 1, IFF(DATE_DIM.D_DAY_NAME = 'Tuesday', 2, IFF(DATE_DIM.D_DAY_NAME = 'Wednesday', 3, IFF(DATE_DIM.D_DAY_NAME = 'Thursday', 4, IFF(DATE_DIM.D_DAY_NAME = 'Friday', 5, IFF(DATE_DIM.D_DAY_NAME = 'Saturday', 6, null))))))), DATE_DIM.D_WEEK_SEQ, DATE_DIM.D_DATE_SK]\n1 | 23 | [22] | JoinFilter | joinKey: (D_0.D_WEEK_SEQ = WSS_0.D_WEEK_SEQ) OR (D.D_WEEK_SEQ = WSS.D_WEEK_SEQ)\n1 | 24 | [23] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE_SK, D_WEEK_SEQ, D_DAY_NAME | 1 | 1 | 2138624\n1 | 25 | [21] | Aggregate | aggExprs: [SUM(STORE_SALES.SS_SALES_PRICE)], groupKeys: [STORE_SALES.SS_STORE_SK, STORE_SALES.SS_SOLD_DATE_SK]\n1 | 26 | [25] | Filter | STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL\n1 | 27 | [26] | JoinFilter | joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)\n1 | 28 | [27] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES | SS_SOLD_DATE_SK, SS_STORE_SK, SS_SALES_PRICE | 72718 | 72718 | 1251924090880\n1 | 29 | [5] | JoinFilter | joinKey: (D.D_WEEK_SEQ = WSS.D_WEEK_SEQ)\n1 | 30 | [29] | WithReference\n1 | 31 | [30] | Filter | WSS.SS_STORE_SK IS NOT NULL",
  "plan_json": null,
  "actual_rows": null
}