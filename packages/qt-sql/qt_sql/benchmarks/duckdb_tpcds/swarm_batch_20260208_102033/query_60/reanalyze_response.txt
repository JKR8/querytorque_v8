FAILURE_ANALYSIS:
All previous attempts failed to achieve significant speedup because they focused only on dimension pre-filtering and CTE materialization, which DuckDB's optimizer already handles automatically. The original query's bottleneck is the triple scan of large fact tables (store_sales, catalog_sales, web_sales) with similar filters, executed sequentially. Each attempt merely rewrote the structure without addressing the fundamental problem: redundant computation across channels. Since DuckDB's optimizer can push filters and materialize CTEs independently, these syntactic changes yielded negligible gains (0.99xâ€“1.15x). The real bottleneck is the three separate heavy aggregations on large fact tables.

UNEXPLORED_OPPORTUNITIES:
1. **Single-pass multi-channel aggregation**: Combine all three sales channel scans into one CTE using UNION ALL before aggregation, reducing from three separate GROUP BY operations to one.
2. **Bloom filter semi-joins**: Convert the item subquery to a bloom filter or semi-join to reduce fact table scans early.
3. **Parallel fact table processing**: Use DuckDB's ability to process UNION ALL branches in parallel by restructuring CTEs.
4. **Aggregation pushdown elimination**: Remove the intermediate aggregations in ss/cs/ws CTEs entirely, streaming raw sales records directly to final aggregation.

REFINED_STRATEGY:
Transform the query to perform a single aggregation pass over a unified sales stream. Instead of three separate CTEs with aggregations, create one CTE that unions all filtered sales records (without aggregation), then apply a single GROUP BY. This reduces computational overhead and allows DuckDB to optimize the union and aggregation as a single pipeline. Additionally, use explicit semi-joins instead of IN subqueries for better filter pushdown.

EXAMPLES: single_pass_aggregation, shared_dimension_multi_channel, prefetch_fact_join
HINT: Consolidate all three sales channel scans into a single UNION ALL stream before aggregation, using pre-filtered dimension CTEs for join efficiency. Eliminate intermediate aggregations entirely.