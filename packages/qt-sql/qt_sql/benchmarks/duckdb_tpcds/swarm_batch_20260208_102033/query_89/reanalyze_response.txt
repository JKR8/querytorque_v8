FAILURE_ANALYSIS:
All workers fell short because they focused exclusively on dimension pre-filtering while missing the core computational bottleneck: the expensive window function computing `avg_monthly_sales`. The attempts achieved minimal speedup (≤1.06x) because they reduced initial data volume but still required full computation of `AVG(SUM(...)) OVER (PARTITION BY ...)` across all qualified rows. Worker 4's approach tried structural transformation but introduced a syntax error (missing d_moy in filtered_dates CTE) and didn't address the window function cost. The real bottleneck is the two-level aggregation (SUM then AVG over partition) that must scan and process all matching sales data regardless of early filtering.

UNEXPLORED_OPPORTUNITIES:
1. **Partial pre-aggregation**: Pre-compute monthly sales sums before joining all dimensions, reducing data before the expensive window function.
2. **Materialized partitioning**: Store intermediate results partitioned by (category, brand, store, company) to avoid repeated scans.
3. **Pruning before window computation**: Use the 0.1 threshold to eliminate non-deviating rows early via approximate calculations or two-phase filtering.
4. **Join order optimization**: Reorder joins to maximize reduction before aggregation (store → date → item → sales).
5. **Leverage DuckDB's parallel window functions**: Use explicit partitioning hints for better multi-core utilization.

REFINED_STRATEGY:
Combine dimension pre-filtering with two-phase aggregation and partial pre-aggregation. First, filter dimensions to CTEs as in successful attempts. Second, compute monthly sales sums in a CTE grouped by the minimal keys needed. Third, compute the window average on this much smaller intermediate result. Finally, apply the deviation filter and ordering. Use UNION ALL for the disjoint OR conditions in item to potentially enable better predicate pushdown.

EXAMPLES: single_pass_aggregation, or_to_union, dimension_cte_isolate
HINT: Pre-aggregate sales at the (item_sk, store_sk, d_moy) level first to reduce data volume before the expensive window computation. Use UNION ALL for the two item category conditions since they're disjoint. Ensure all necessary columns (d_moy) are present in CTEs. Consider materializing intermediate aggregations.