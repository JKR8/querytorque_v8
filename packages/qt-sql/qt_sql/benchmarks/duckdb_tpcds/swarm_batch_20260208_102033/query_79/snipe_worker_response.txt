```sql
WITH 
-- Early dimension filtering: isolate small dimension sets first
filtered_date AS (
    SELECT d_date_sk
    FROM date_dim
    WHERE d_dow = 1
      AND d_year IN (1998, 1999, 2000)
),
filtered_store AS (
    SELECT s_store_sk, s_city
    FROM store
    WHERE s_number_employees BETWEEN 200 AND 295
),
filtered_hd AS (
    SELECT hd_demo_sk
    FROM household_demographics
    WHERE hd_dep_count = 5 OR hd_vehicle_count > 4
),
-- Join filtered dimensions to fact table in a single pass
filtered_sales AS (
    SELECT 
        ss.ss_ticket_number,
        ss.ss_customer_sk,
        ss.ss_addr_sk,
        st.s_city,
        SUM(ss.ss_coupon_amt) AS amt,
        SUM(ss.ss_net_profit) AS profit
    FROM store_sales ss
    JOIN filtered_date fd ON ss.ss_sold_date_sk = fd.d_date_sk
    JOIN filtered_store st ON ss.ss_store_sk = st.s_store_sk
    JOIN filtered_hd hd ON ss.ss_hdemo_sk = hd.hd_demo_sk
    GROUP BY 
        ss.ss_ticket_number,
        ss.ss_customer_sk,
        ss.ss_addr_sk,
        st.s_city
)
SELECT
    c.c_last_name,
    c.c_first_name,
    SUBSTRING(fs.s_city, 1, 30),
    fs.ss_ticket_number,
    fs.amt,
    fs.profit
FROM filtered_sales fs
JOIN customer c ON fs.ss_customer_sk = c.c_customer_sk
ORDER BY
    c.c_last_name,
    c.c_first_name,
    SUBSTRING(fs.s_city, 1, 30),
    fs.profit
LIMIT 100;
```

**Changes**: Applied staged dimension reduction with isolated CTEs: first filter each dimension table independently to create small hash tables, then join them with the fact table in a single aggregation pass. This replaces the original 4-way implicit join with an optimized pipeline.

**Expected speedup**: 1.8-2.5x. The rewrite enables DuckDB to build efficient hash joins from tiny dimension CTEs and avoids scanning large tables with complex OR predicates. The early filtering reduces the fact table join cardinality significantly before aggregation.