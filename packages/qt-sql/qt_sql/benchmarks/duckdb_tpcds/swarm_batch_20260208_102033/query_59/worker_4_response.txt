```sql
WITH wss AS (
  SELECT
    d.d_week_seq,
    ss.ss_store_sk,
    SUM(CASE WHEN d.d_day_name = 'Sunday' THEN ss.ss_sales_price END) AS sun_sales,
    SUM(CASE WHEN d.d_day_name = 'Monday' THEN ss.ss_sales_price END) AS mon_sales,
    SUM(CASE WHEN d.d_day_name = 'Tuesday' THEN ss.ss_sales_price END) AS tue_sales,
    SUM(CASE WHEN d.d_day_name = 'Wednesday' THEN ss.ss_sales_price END) AS wed_sales,
    SUM(CASE WHEN d.d_day_name = 'Thursday' THEN ss.ss_sales_price END) AS thu_sales,
    SUM(CASE WHEN d.d_day_name = 'Friday' THEN ss.ss_sales_price END) AS fri_sales,
    SUM(CASE WHEN d.d_day_name = 'Saturday' THEN ss.ss_sales_price END) AS sat_sales
  FROM store_sales AS ss
  JOIN date_dim AS d ON d.d_date_sk = ss.ss_sold_date_sk
  GROUP BY d.d_week_seq, ss.ss_store_sk
)
SELECT
  y.s_store_name AS s_store_name1,
  y.s_store_id AS s_store_id1,
  y.d_week_seq AS d_week_seq1,
  y.sun_sales / x.sun_sales AS "sun_sales1 / sun_sales2",
  y.mon_sales / x.mon_sales AS "mon_sales1 / mon_sales2",
  y.tue_sales / x.tue_sales AS "tue_sales1 / tue_sales2",
  y.wed_sales / x.wed_sales AS "wed_sales1 / wed_sales2",
  y.thu_sales / x.thu_sales AS "thu_sales1 / thu_sales2",
  y.fri_sales / x.fri_sales AS "fri_sales1 / fri_sales2",
  y.sat_sales / x.sat_sales AS "sat_sales1 / sat_sales2"
FROM (
  SELECT
    s.s_store_name,
    s.s_store_id,
    w.d_week_seq,
    w.sun_sales,
    w.mon_sales,
    w.tue_sales,
    w.wed_sales,
    w.thu_sales,
    w.fri_sales,
    w.sat_sales
  FROM wss AS w
  JOIN store AS s ON w.ss_store_sk = s.s_store_sk
  WHERE EXISTS (
    SELECT 1
    FROM date_dim AS d
    WHERE d.d_week_seq = w.d_week_seq
      AND d.d_month_seq BETWEEN 1196 AND 1196 + 11
  )
) AS y
JOIN (
  SELECT
    s.s_store_id,
    w.d_week_seq,
    w.sun_sales,
    w.mon_sales,
    w.tue_sales,
    w.wed_sales,
    w.thu_sales,
    w.fri_sales,
    w.sat_sales
  FROM wss AS w
  JOIN store AS s ON w.ss_store_sk = s.s_store_sk
  WHERE EXISTS (
    SELECT 1
    FROM date_dim AS d
    WHERE d.d_week_seq = w.d_week_seq
      AND d.d_month_seq BETWEEN 1196 + 12 AND 1196 + 23
  )
) AS x ON y.s_store_id = x.s_store_id
  AND y.d_week_seq = x.d_week_seq - 52
ORDER BY y.s_store_name, y.s_store_id, y.d_week_seq
LIMIT 100
```

**Changes**: Transformed the main query's two subqueries (y and x) into EXISTS-based semi-joins with `date_dim`, eliminating the Cartesian product implicit joins and reducing unnecessary data materialization. This defers the date filtering to a correlated subquery that can short-circuit scanning.

**Expected speedup**: 1.3-1.6x from eliminating the implicit join and allowing semi-join optimizations.