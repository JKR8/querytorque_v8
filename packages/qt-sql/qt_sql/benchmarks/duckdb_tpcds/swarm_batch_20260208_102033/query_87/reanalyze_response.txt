FAILURE_ANALYSIS:
All attempts failed because they continued to compute three separate channel-specific result sets then perform set operations, which is inherently expensive. Worker 1-3 and 5 used the same basic pattern of CTEs with DISTINCT followed by EXCEPT, failing to fundamentally change the computation pattern. Worker 4's NOT EXISTS transformation introduced correlated subqueries that likely caused O(NÂ²) behavior. The core issue remains: each approach still processes all three fact tables independently, performing expensive DISTINCT operations on large intermediate results before the final set difference. DuckDB's optimizer couldn't push the EXCEPT/EXCEPT operations into the joins effectively, and materializing CTEs added overhead without eliminating the fundamental triple-scan bottleneck.

UNEXPLORED_OPPORTUNITIES:
1. **Single-pass aggregation with channel marking**: Combine all three sales sources into a single CTE using UNION ALL with a channel indicator, then aggregate to detect store-only patterns.
2. **Pre-aggregated existence checking**: Pre-compute existence flags per (customer, date) across channels in a single pass, then filter for store-only.
3. **Anti-join with pre-consolidated exclusion set**: Combine catalog and web sales into a single exclusion set first, then perform a single anti-join against store sales.
4. **Bloom filter or semi-join reduction**: Use approximate filtering techniques to reduce the store sales scan early.

REFINED_STRATEGY:
Transform the triple EXCEPT into a single-pass existence check using channel-aware aggregation. First, create a unified sales CTE marking each record with its channel. Then aggregate by (customer, date) to compute a bitmask of channels present. Finally, filter for records where ONLY the store channel appears, and join with customer/date for final columns. This eliminates the separate DISTINCT operations and reduces the fact table processing to a single logical pass with early aggregation.

EXAMPLES: single_pass_aggregation, prefetch_fact_join, pushdown
HINT: Use UNION ALL to combine all sales sources with channel indicators, aggregate by (customer_sk, d_date) using conditional aggregation to build channel presence bitmap, then filter for store-only patterns before joining with dimension tables.