```sql
WITH monthly_sales AS (
  SELECT
    i_category,
    i_brand,
    cc_name,
    d_year,
    d_moy,
    SUM(cs_sales_price) AS sum_sales,
    AVG(SUM(cs_sales_price)) OVER (
      PARTITION BY i_category, i_brand, cc_name, d_year
    ) AS avg_monthly_sales,
    LAG(SUM(cs_sales_price)) OVER (
      PARTITION BY i_category, i_brand, cc_name 
      ORDER BY d_year, d_moy
    ) AS psum,
    LEAD(SUM(cs_sales_price)) OVER (
      PARTITION BY i_category, i_brand, cc_name 
      ORDER BY d_year, d_moy
    ) AS nsum
  FROM catalog_sales
  JOIN item ON cs_item_sk = i_item_sk
  JOIN date_dim ON cs_sold_date_sk = d_date_sk
  JOIN call_center ON cc_call_center_sk = cs_call_center_sk
  WHERE 
    d_year = 1999 
    OR (d_year = 1998 AND d_moy = 12)
    OR (d_year = 2000 AND d_moy = 1)
  GROUP BY
    i_category,
    i_brand,
    cc_name,
    d_year,
    d_moy
)
SELECT
  i_brand,
  d_year,
  avg_monthly_sales,
  sum_sales,
  psum,
  nsum
FROM monthly_sales
WHERE
  d_year = 1999
  AND avg_monthly_sales > 0
  AND psum IS NOT NULL
  AND nsum IS NOT NULL
  AND ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales > 0.1
ORDER BY
  sum_sales - avg_monthly_sales,
  nsum
LIMIT 100
```

**Changes**: Eliminated triangular self‑join by computing LAG/LEAD directly in the window, merged all window functions into a single CTE, converted to explicit JOIN syntax, and simplified the deviation filter since `avg_monthly_sales > 0` is already checked.

**Expected speedup**: 2–3× due to removing O(n²) self‑join and reducing intermediate materialization.