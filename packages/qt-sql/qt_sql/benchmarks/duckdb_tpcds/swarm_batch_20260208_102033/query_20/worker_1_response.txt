```sql
WITH filtered_date AS (
    SELECT d_date_sk
    FROM date_dim
    WHERE d_date BETWEEN CAST('2002-01-26' AS DATE) 
                    AND (CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY)
),
filtered_item AS (
    SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price
    FROM item
    WHERE i_category IN ('Shoes', 'Books', 'Women')
),
joined_base AS (
    SELECT 
        i.i_item_id,
        i.i_item_desc,
        i.i_category,
        i.i_class,
        i.i_current_price,
        cs.cs_ext_sales_price
    FROM catalog_sales cs
    JOIN filtered_item i ON cs.cs_item_sk = i.i_item_sk
    JOIN filtered_date d ON cs.cs_sold_date_sk = d.d_date_sk
),
aggregated AS (
    SELECT
        i_item_id,
        i_item_desc,
        i_category,
        i_class,
        i_current_price,
        SUM(cs_ext_sales_price) AS itemrevenue
    FROM joined_base
    GROUP BY
        i_item_id,
        i_item_desc,
        i_category,
        i_class,
        i_current_price
)
SELECT
    i_item_id,
    i_item_desc,
    i_category,
    i_class,
    i_current_price,
    itemrevenue,
    itemrevenue * 100 / SUM(itemrevenue) OVER (PARTITION BY i_class) AS revenueratio
FROM aggregated
ORDER BY
    i_category,
    i_class,
    i_item_id,
    i_item_desc,
    revenueratio
LIMIT 100;
```

Changes: Created CTEs to filter dimension tables (date_dim and item) before joining with the large fact table (catalog_sales), reducing the intermediate join size. Used explicit JOIN syntax for clarity while maintaining exact semantic equivalence.

Expected speedup: 2-3x by reducing the fact table scan to only rows matching filtered dimension keys.