FAILURE_ANALYSIS:
All attempts failed because they only applied surface-level optimizations without addressing the core bottleneck: massive intermediate data volume from Cartesian-like joins between large fact tables and pre-filtered dimension CTEs. Worker 1-5 all used the same pattern of pre-filtering dimension tables into CTEs (date_dim, time_dim, ship_mode) but then performed inefficient N:M joins with web_sales/catalog_sales. DuckDB's optimizer couldn't push the warehouse join predicate into the fact table scans early enough, causing full fact table scans followed by expensive hash joins. The UNION ALL structure also forced two separate large aggregations instead of a consolidated single pass over combined data. The attempts essentially rearranged deck chairs on the Titanic without reducing the fundamental data movement.

UNEXPLORED_OPPORTUNITIES:
1. **Pre-aggregation before dimension joins**: Aggregate fact tables at warehouse_sk + date_sk + time_sk + ship_mode_sk level before joining with dimension tables to reduce row counts dramatically.
2. **Horizontal partitioning by month**: Use DuckDB's struct/pivot capabilities to avoid 24 conditional SUMs per row.
3. **Merge-union optimization**: Transform UNION ALL of web/catalog sales into a single parameterized CTE with table-valued parameters.
4. **Time dimension elimination**: The time filter (8-hour window) could be pushed into fact table storage pruning if timestamp partitioning exists.
5. **Warehouse dimension pre-selection**: If warehouse distribution is skewed, filter warehouses early based on fact table presence.

REFINED_STRATEGY:
Combine pre-aggregation with horizontal restructuring: First, create a unified sales CTE that aggregates both web and catalog sales at the lowest grain (warehouse_sk + date_sk + time_sk + ship_mode_sk) with monthly amounts stored in arrays. Then join this compact result with all dimension tables in a single pass. Use DuckDB's UNNEST with FILTER for efficient monthly aggregation instead of 24 CASE statements. Finally, restructure the UNION ALL as a parameterized template to avoid code duplication while enabling better plan caching.

EXAMPLES: single_pass_aggregation, prefetch_fact_join, multi_dimension_prefetch
HINT: Build a compact fact summary CTE with ARRAY_AGG for monthly amounts before joining to any dimension tables. Use DuckDB's struct type to store {month, sales_amount, net_amount} tuples, then UNNEST with GROUP BY warehouse attributes. This reduces the 24 conditional aggregates to a single array transformation and cuts intermediate data by 10-100x.