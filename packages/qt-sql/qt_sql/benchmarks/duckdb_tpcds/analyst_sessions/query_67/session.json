{
  "query_id": "query_67",
  "max_iterations": 1,
  "target_speedup": 2.0,
  "n_workers": 1,
  "best_speedup": 1.1954025457438324,
  "best_sql": "WITH filtered_dates AS (\n  SELECT d_date_sk, d_year, d_qoy, d_moy\n  FROM date_dim\n  WHERE d_month_seq BETWEEN 1206 AND 1206 + 11\n),\nfiltered_sales AS (\n  SELECT \n    ss_sales_price,\n    ss_quantity,\n    ss_item_sk,\n    ss_store_sk,\n    d.d_year,\n    d.d_qoy,\n    d.d_moy\n  FROM store_sales ss\n  JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk\n),\nitem_dim AS (\n  SELECT \n    i_item_sk,\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name\n  FROM item\n),\nstore_dim AS (\n  SELECT \n    s_store_sk,\n    s_store_id\n  FROM store\n)\nSELECT *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n  FROM (\n    SELECT\n      i.i_category,\n      i.i_class,\n      i.i_brand,\n      i.i_product_name,\n      fs.d_year,\n      fs.d_qoy,\n      fs.d_moy,\n      s.s_store_id,\n      SUM(COALESCE(fs.ss_sales_price * fs.ss_quantity, 0)) AS sumsales\n    FROM filtered_sales fs\n    JOIN item_dim i ON fs.ss_item_sk = i.i_item_sk\n    JOIN store_dim s ON fs.ss_store_sk = s.s_store_sk\n    GROUP BY ROLLUP (\n      i.i_category,\n      i.i_class,\n      i.i_brand,\n      i.i_product_name,\n      fs.d_year,\n      fs.d_qoy,\n      fs.d_moy,\n      s.s_store_id\n    )\n  ) AS dw1\n) AS dw2\nWHERE rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100",
  "n_iterations": 1
}