{
  "worker_id": 2,
  "strategy": "rollup_to_union_windowing",
  "examples_used": [
    "rollup_to_union_windowing",
    "union_cte_split"
  ],
  "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1188 AND 1188 + 11), inventory_date_item AS (SELECT i.i_product_name, i.i_brand, i.i_class, i.i_category, inv.inv_quantity_on_hand FROM inventory inv JOIN date_filtered df ON inv.inv_date_sk = df.d_date_sk JOIN item i ON inv.inv_item_sk = i.i_item_sk), union_levels AS ((SELECT i_product_name, i_brand, i_class, i_category, AVG(inv_quantity_on_hand) AS qoh FROM inventory_date_item GROUP BY i_product_name, i_brand, i_class, i_category UNION ALL SELECT i_product_name, i_brand, i_class, NULL AS i_category, AVG(inv_quantity_on_hand) AS qoh FROM inventory_date_item GROUP BY i_product_name, i_brand, i_class UNION ALL SELECT i_product_name, i_brand, NULL, NULL, AVG(inv_quantity_on_hand) AS qoh FROM inventory_date_item GROUP BY i_product_name, i_brand UNION ALL SELECT i_product_name, NULL, NULL, NULL, AVG(inv_quantity_on_hand) AS qoh FROM inventory_date_item GROUP BY i_product_name UNION ALL SELECT NULL, NULL, NULL, NULL, AVG(inv_quantity_on_hand) AS qoh FROM inventory_date_item)) SELECT i_product_name, i_brand, i_class, i_category, qoh FROM union_levels ORDER BY qoh ASC, i_product_name ASC, i_brand ASC, i_class ASC, i_category ASC LIMIT 100",
  "speedup": 1.2177237614096699,
  "status": "WIN",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- rollup_to_union_windowing: Apply exact pattern - replace ROLLUP with explicit ",
  "error_message": "INTERFACE: [union_levels] declares outputs ['i_brand', 'i_category', 'i_class', 'i_product_name'] but SELECT only produces ['qoh']",
  "error_messages": [
    "INTERFACE: [union_levels] declares outputs ['i_brand', 'i_category', 'i_class', 'i_product_name'] but SELECT only produces ['qoh']"
  ],
  "error_category": null
}