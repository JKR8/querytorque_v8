{
  "worker_id": 4,
  "strategy": "or_to_union (exploration)",
  "examples_used": [
    "or_to_union",
    "multi_intersect_exists_cte"
  ],
  "optimized_sql": "WITH branch_books AS (SELECT ws_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price, ws_ext_sales_price FROM web_sales INNER JOIN date_dim ON ws_sold_date_sk = d_date_sk INNER JOIN item ON ws_item_sk = i_item_sk WHERE i_category = 'Books' AND d_date BETWEEN CAST('1998-04-06' AS DATE) AND (CAST('1998-04-06' AS DATE) + INTERVAL 30 DAY)), branch_sports AS (SELECT ws_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price, ws_ext_sales_price FROM web_sales INNER JOIN date_dim ON ws_sold_date_sk = d_date_sk INNER JOIN item ON ws_item_sk = i_item_sk WHERE i_category = 'Sports' AND d_date BETWEEN CAST('1998-04-06' AS DATE) AND (CAST('1998-04-06' AS DATE) + INTERVAL 30 DAY)), branch_men AS (SELECT ws_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price, ws_ext_sales_price FROM web_sales INNER JOIN date_dim ON ws_sold_date_sk = d_date_sk INNER JOIN item ON ws_item_sk = i_item_sk WHERE i_category = 'Men' AND d_date BETWEEN CAST('1998-04-06' AS DATE) AND (CAST('1998-04-06' AS DATE) + INTERVAL 30 DAY)), union_all AS (SELECT * FROM branch_books UNION ALL SELECT * FROM branch_sports UNION ALL SELECT * FROM branch_men), aggregated_union AS (SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ws_ext_sales_price) AS itemrevenue FROM union_all GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price), windowed AS (SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, itemrevenue, (itemrevenue * 100 / SUM(itemrevenue) OVER (PARTITION BY i_class)) AS revenueratio FROM aggregated_union) SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, itemrevenue, revenueratio FROM windowed ORDER BY i_category ASC, i_class ASC, i_item_id ASC, i_item_desc ASC, revenueratio ASC LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "or_to_union"
  ],
  "hint": "- or_to_union: apply splitting i_category IN into three UNION ALL branches; igno",
  "error_message": "INTERFACE: [union_all] declares outputs ['i_category', 'i_class', 'i_current_price', 'i_item_desc', 'i_item_id', 'ws_ext_sales_price', 'ws_item_sk'] but SELECT only produces ['*'] | INTERFACE: [union_all] SELECT produces ['*'] not declared in outputs",
  "error_messages": [
    "INTERFACE: [union_all] declares outputs ['i_category', 'i_class', 'i_current_price', 'i_item_desc', 'i_item_id', 'ws_ext_sales_price', 'ws_item_sk'] but SELECT only produces ['*']",
    "INTERFACE: [union_all] SELECT produces ['*'] not declared in outputs"
  ],
  "error_category": null,
  "exploratory": true
}