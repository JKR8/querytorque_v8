{
  "worker_id": 2,
  "strategy": "inner_join_conversion",
  "examples_used": [
    "early_filter",
    "pushdown"
  ],
  "optimized_sql": "WITH filtered_reason AS (SELECT r_reason_sk, r_reason_desc FROM reason WHERE r_reason_desc = 'duplicate purchase'), joined_returns_sales AS (SELECT ss.ss_customer_sk, ss.ss_quantity, ss.ss_sales_price, sr.sr_return_quantity FROM store_sales ss INNER JOIN store_returns sr ON (ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number) INNER JOIN filtered_reason fr ON sr.sr_reason_sk = fr.r_reason_sk), aggregated AS (SELECT ss_customer_sk, SUM((ss_quantity - sr_return_quantity) * ss_sales_price) AS sumsales FROM joined_returns_sales GROUP BY ss_customer_sk), top_n AS (SELECT ss_customer_sk, sumsales FROM aggregated ORDER BY sumsales ASC, ss_customer_sk ASC LIMIT 100) SELECT ss_customer_sk, sumsales FROM top_n",
  "speedup": 3.439868888508907,
  "status": "WIN",
  "transforms": [
    "pushdown"
  ],
  "hint": "- early_filter: Use the filtered reason CTE, but keep the join order as store_sa",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}