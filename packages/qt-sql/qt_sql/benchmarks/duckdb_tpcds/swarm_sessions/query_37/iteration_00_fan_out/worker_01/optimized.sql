WITH filtered_item AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 45 AND 75 AND i_manufact_id IN (856, 707, 1000, 747)), filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-21' AS DATE) AND (CAST('1999-02-21' AS DATE) + INTERVAL 60 DAY)), filtered_inventory AS (SELECT inv_item_sk, inv_date_sk FROM inventory WHERE inv_quantity_on_hand BETWEEN 100 AND 500), prejoined_inv_item_date AS (SELECT fi.i_item_sk, fi.i_item_id, fi.i_item_desc, fi.i_current_price FROM filtered_inventory inv INNER JOIN filtered_item fi ON inv.inv_item_sk = fi.i_item_sk INNER JOIN filtered_date fd ON inv.inv_date_sk = fd.d_date_sk) SELECT i_item_id, i_item_desc, i_current_price FROM prejoined_inv_item_date WHERE EXISTS (SELECT 1 FROM catalog_sales WHERE cs_item_sk = i_item_sk) GROUP BY i_item_id, i_item_desc, i_current_price ORDER BY i_item_id LIMIT 100