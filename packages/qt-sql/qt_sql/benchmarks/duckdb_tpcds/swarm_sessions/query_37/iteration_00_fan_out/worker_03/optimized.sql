WITH filtered_item AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 45 AND 75 AND i_manufact_id IN (856,707,1000,747)), filtered_inventory_date AS (SELECT f.i_item_sk, f.i_item_id, f.i_item_desc, f.i_current_price FROM inventory AS inv INNER JOIN filtered_item AS f ON inv.inv_item_sk = f.i_item_sk INNER JOIN date_dim AS d ON inv.inv_date_sk = d.d_date_sk WHERE inv.inv_quantity_on_hand BETWEEN 100 AND 500 AND d.d_date BETWEEN CAST('1999-02-21' AS DATE) AND (CAST('1999-02-21' AS DATE) + INTERVAL 60 DAY)), grouped_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM filtered_inventory_date GROUP BY i_item_sk, i_item_id, i_item_desc, i_current_price), final_catalog_join AS (SELECT g.i_item_id, g.i_item_desc, g.i_current_price FROM grouped_items AS g INNER JOIN catalog_sales AS cs ON cs.cs_item_sk = g.i_item_sk GROUP BY g.i_item_id, g.i_item_desc, g.i_current_price ORDER BY g.i_item_id LIMIT 100) SELECT i_item_id, i_item_desc, i_current_price FROM final_catalog_join