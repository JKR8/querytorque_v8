WITH filtered_item AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 45 AND 75 AND i_manufact_id IN (856,707,1000,747)), filtered_inventory_date AS (SELECT fi.i_item_sk, fi.i_item_id, fi.i_item_desc, fi.i_current_price FROM inventory inv INNER JOIN filtered_item fi ON inv.inv_item_sk = fi.i_item_sk INNER JOIN date_dim dd ON inv.inv_date_sk = dd.d_date_sk WHERE inv.inv_quantity_on_hand BETWEEN 100 AND 500 AND dd.d_date BETWEEN CAST('1999-02-21' AS DATE) AND (CAST('1999-02-21' AS DATE) + INTERVAL 60 DAY)), exists_check AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM filtered_inventory_date fid WHERE EXISTS (SELECT 1 FROM catalog_sales cs WHERE cs.cs_item_sk = fid.i_item_sk)) SELECT i_item_id, i_item_desc, i_current_price FROM exists_check GROUP BY i_item_id, i_item_desc, i_current_price ORDER BY i_item_id LIMIT 100