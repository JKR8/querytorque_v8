{
  "worker_id": 1,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "dimension_cte_isolate",
    "prefetch_fact_join",
    "date_cte_isolate"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk, d_year, d_qoy FROM date_dim WHERE d_date_sk BETWEEN 2450815 AND 2452653), item_cte AS (SELECT i_item_sk, i_category FROM item), store_sales_prejoin AS (SELECT 'store' AS channel, 'ss_hdemo_sk' AS col_name, d.d_year, d.d_qoy, i.i_category, ss.ss_ext_sales_price AS ext_sales_price FROM store_sales ss JOIN date_cte d ON ss.ss_sold_date_sk = d.d_date_sk JOIN item_cte i ON ss.ss_item_sk = i.i_item_sk WHERE ss.ss_hdemo_sk IS NULL), web_sales_prejoin AS (SELECT 'web' AS channel, 'ws_bill_addr_sk' AS col_name, d.d_year, d.d_qoy, i.i_category, ws.ws_ext_sales_price AS ext_sales_price FROM web_sales ws JOIN date_cte d ON ws.ws_sold_date_sk = d.d_date_sk JOIN item_cte i ON ws.ws_item_sk = i.i_item_sk WHERE ws.ws_bill_addr_sk IS NULL), catalog_sales_prejoin AS (SELECT 'catalog' AS channel, 'cs_warehouse_sk' AS col_name, d.d_year, d.d_qoy, i.i_category, cs.cs_ext_sales_price AS ext_sales_price FROM catalog_sales cs JOIN date_cte d ON cs.cs_sold_date_sk = d.d_date_sk JOIN item_cte i ON cs.cs_item_sk = i.i_item_sk WHERE cs.cs_warehouse_sk IS NULL), union_all AS (SELECT channel, col_name, d_year, d_qoy, i_category, ext_sales_price FROM store_sales_prejoin UNION ALL SELECT channel, col_name, d_year, d_qoy, i_category, ext_sales_price FROM web_sales_prejoin UNION ALL SELECT channel, col_name, d_year, d_qoy, i_category, ext_sales_price FROM catalog_sales_prejoin) SELECT channel, col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ext_sales_price) AS sales_amt FROM union_all GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category LIMIT 100",
  "speedup": 0.8260865801886242,
  "status": "REGRESSION",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- dimension_cte_isolate: Apply pre-filtering of date_dim and item into CTEs; ign",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}