{
  "worker_id": 3,
  "strategy": "union_consolidation",
  "examples_used": [
    "shared_dimension_multi_channel",
    "date_cte_isolate"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk, d_year, d_qoy FROM date_dim WHERE d_date_sk BETWEEN 2450815 AND 2452653), item_cte AS (SELECT i_item_sk, i_category FROM item), union_all_prejoined AS (SELECT 'store' AS channel, 'ss_hdemo_sk' AS col_name, d_year, d_qoy, i_category, ss_ext_sales_price AS ext_sales_price FROM store_sales JOIN date_cte ON ss_sold_date_sk = date_cte.d_date_sk JOIN item_cte ON ss_item_sk = item_cte.i_item_sk WHERE ss_hdemo_sk IS NULL UNION ALL SELECT 'web', 'ws_bill_addr_sk', d_year, d_qoy, i_category, ws_ext_sales_price FROM web_sales JOIN date_cte ON ws_sold_date_sk = date_cte.d_date_sk JOIN item_cte ON ws_item_sk = item_cte.i_item_sk WHERE ws_bill_addr_sk IS NULL UNION ALL SELECT 'catalog', 'cs_warehouse_sk', d_year, d_qoy, i_category, cs_ext_sales_price FROM catalog_sales JOIN date_cte ON cs_sold_date_sk = date_cte.d_date_sk JOIN item_cte ON cs_item_sk = item_cte.i_item_sk WHERE cs_warehouse_sk IS NULL) SELECT channel, col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ext_sales_price) AS sales_amt FROM union_all_prejoined GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- shared_dimension_multi_channel: Extract shared dimension filters (date_cte, it",
  "error_message": "INTERFACE: [union_all_prejoined] declares outputs ['channel', 'col_name', 'ext_sales_price'] but SELECT only produces ['catalog', 'cs_ext_sales_price', 'cs_warehouse_sk', 'd_qoy', 'd_year', 'i_category'] | INTERFACE: [union_all_prejoined] SELECT produces ['catalog', 'cs_ext_sales_price', 'cs_warehouse_sk'] not declared in outputs",
  "error_messages": [
    "INTERFACE: [union_all_prejoined] declares outputs ['channel', 'col_name', 'ext_sales_price'] but SELECT only produces ['catalog', 'cs_ext_sales_price', 'cs_warehouse_sk', 'd_qoy', 'd_year', 'i_category']",
    "INTERFACE: [union_all_prejoined] SELECT produces ['catalog', 'cs_ext_sales_price', 'cs_warehouse_sk'] not declared in outputs"
  ],
  "error_category": null
}