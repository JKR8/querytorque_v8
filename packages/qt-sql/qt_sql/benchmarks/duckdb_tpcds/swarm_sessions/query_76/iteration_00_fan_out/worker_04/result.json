{
  "worker_id": 4,
  "strategy": "aggregate_pushdown",
  "examples_used": [
    "pushdown",
    "single_pass_aggregation"
  ],
  "optimized_sql": "WITH store_agg AS (SELECT 'store' AS channel, 'ss_hdemo_sk' AS col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ss_ext_sales_price) AS sales_amt FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk WHERE ss_hdemo_sk IS NULL AND d_date_sk BETWEEN 2450816 AND 2452642 GROUP BY d_year, d_qoy, i_category), web_agg AS (SELECT 'web' AS channel, 'ws_bill_addr_sk' AS col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ws_ext_sales_price) AS sales_amt FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN item ON ws_item_sk = i_item_sk WHERE ws_bill_addr_sk IS NULL AND d_date_sk BETWEEN 2450816 AND 2452642 GROUP BY d_year, d_qoy, i_category), catalog_agg AS (SELECT 'catalog' AS channel, 'cs_warehouse_sk' AS col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(cs_ext_sales_price) AS sales_amt FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk JOIN item ON cs_item_sk = i_item_sk WHERE cs_warehouse_sk IS NULL AND d_date_sk BETWEEN 2450815 AND 2452653 GROUP BY d_year, d_qoy, i_category), union_all AS (SELECT * FROM store_agg UNION ALL SELECT * FROM web_agg UNION ALL SELECT * FROM catalog_agg) SELECT channel, col_name, d_year, d_qoy, i_category, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM union_all GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- pushdown: Push aggregation down to each branch (pre-aggregate); ignore consoli",
  "error_message": "INTERFACE: [union_all] declares outputs ['channel', 'col_name', 'd_qoy', 'd_year', 'i_category', 'sales_amt', 'sales_cnt'] but SELECT only produces ['*'] | INTERFACE: [union_all] SELECT produces ['*'] not declared in outputs",
  "error_messages": [
    "INTERFACE: [union_all] declares outputs ['channel', 'col_name', 'd_qoy', 'd_year', 'i_category', 'sales_amt', 'sales_cnt'] but SELECT only produces ['*']",
    "INTERFACE: [union_all] SELECT produces ['*'] not declared in outputs"
  ],
  "error_category": null,
  "exploratory": true
}