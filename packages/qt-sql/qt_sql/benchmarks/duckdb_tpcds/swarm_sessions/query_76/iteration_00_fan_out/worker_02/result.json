{
  "worker_id": 2,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "channel_bitmap_aggregation",
    "single_pass_aggregation"
  ],
  "optimized_sql": "WITH all_sales_cte AS (SELECT 'store' AS channel, 'ss_hdemo_sk' AS col_name, ss_ext_sales_price AS ext_sales_price, ss_sold_date_sk AS sold_date_sk, ss_item_sk AS item_sk FROM store_sales WHERE ss_hdemo_sk IS NULL UNION ALL SELECT 'web' AS channel, 'ws_bill_addr_sk' AS col_name, ws_ext_sales_price AS ext_sales_price, ws_sold_date_sk AS sold_date_sk, ws_item_sk AS item_sk FROM web_sales WHERE ws_bill_addr_sk IS NULL UNION ALL SELECT 'catalog' AS channel, 'cs_warehouse_sk' AS col_name, cs_ext_sales_price AS ext_sales_price, cs_sold_date_sk AS sold_date_sk, cs_item_sk AS item_sk FROM catalog_sales WHERE cs_warehouse_sk IS NULL), joined_sales AS (SELECT a.channel, a.col_name, d.d_year, d.d_qoy, i.i_category, a.ext_sales_price FROM all_sales_cte a JOIN date_dim d ON a.sold_date_sk = d.d_date_sk JOIN item i ON a.item_sk = i.i_item_sk) SELECT channel, col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ext_sales_price) AS sales_amt FROM joined_sales GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel, col_name, d_year, d_qoy, i_category LIMIT 100",
  "speedup": 0.7835054440683459,
  "status": "REGRESSION",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- channel_bitmap_aggregation: Apply consolidation of fact table scans into one U",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}