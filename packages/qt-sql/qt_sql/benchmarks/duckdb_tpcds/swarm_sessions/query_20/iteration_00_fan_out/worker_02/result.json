{
  "worker_id": 2,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "prefetch_fact_join",
    "date_cte_isolate",
    "dimension_cte_isolate"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2002-01-26' AS DATE) AND (CAST('2002-01-26' AS DATE) + INTERVAL 30 DAY)), item_cte AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Shoes', 'Books', 'Women')), prefetched_sales AS (SELECT i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price, cs.cs_ext_sales_price FROM catalog_sales cs INNER JOIN date_cte d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN item_cte i ON cs.cs_item_sk = i.i_item_sk), aggregated AS (SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(cs_ext_sales_price) AS itemrevenue FROM prefetched_sales GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price), windowed AS (SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, itemrevenue, itemrevenue * 100 / SUM(itemrevenue) OVER (PARTITION BY i_class) AS revenueratio FROM aggregated ORDER BY i_category, i_class, i_item_id, i_item_desc, revenueratio LIMIT 100) SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, itemrevenue, revenueratio FROM windowed",
  "speedup": 1.1079353188524603,
  "status": "WIN",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "Apply: Pre-filter date_dim and item into CTEs before joining with catalog_sales.",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}