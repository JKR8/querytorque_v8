{
  "worker_id": 1,
  "strategy": "window_elimination_via_class_cte",
  "examples_used": [
    "deferred_window_aggregation"
  ],
  "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2002-01-26' AS DATE) AND (CAST('2002-01-26' AS DATE) + INTERVAL 30 DAY)),\n     filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Shoes', 'Books', 'Women')),\n     joined_sales AS (SELECT \n    i.i_item_sk,\n    i.i_item_id,\n    i.i_item_desc,\n    i.i_category,\n    i.i_class,\n    i.i_current_price,\n    cs.cs_ext_sales_price\nFROM catalog_sales cs\nINNER JOIN filtered_dates d ON cs.cs_sold_date_sk = d.d_date_sk\nINNER JOIN filtered_items i ON cs.cs_item_sk = i.i_item_sk),\n     item_aggregates AS (SELECT \n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    SUM(cs_ext_sales_price) AS itemrevenue\nFROM joined_sales\nGROUP BY \n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price),\n     class_aggregates AS (SELECT \n    i.i_class,\n    SUM(js.cs_ext_sales_price) AS classrevenue\nFROM filtered_items i\nINNER JOIN joined_sales js ON i.i_item_sk = js.i_item_sk\nGROUP BY i.i_class)\nSELECT \n    ia.i_item_id,\n    ia.i_item_desc,\n    ia.i_category,\n    ia.i_class,\n    ia.i_current_price,\n    ia.itemrevenue,\n    ia.itemrevenue * 100 / ca.classrevenue AS revenueratio\nFROM item_aggregates ia\nINNER JOIN class_aggregates ca ON ia.i_class = ca.i_class\nORDER BY \n    ia.i_category,\n    ia.i_class,\n    ia.i_item_id,\n    ia.i_item_desc,\n    revenueratio\nLIMIT 100",
  "speedup": 1.2170438647926158,
  "status": "WIN",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "Apply: Defer window computation by pre-computing class aggregates separately, th",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}