{
  "worker_id": 4,
  "strategy": "compound_deferred_shared",
  "examples_used": [
    "deferred_window_aggregation",
    "shared_dimension_multi_channel"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1216 AND 1216+11), web_daily AS (SELECT ws_item_sk, d_date, SUM(ws_sales_price) AS daily_web FROM web_sales INNER JOIN date_cte ON ws_sold_date_sk = d_date_sk WHERE ws_item_sk IS NOT NULL GROUP BY ws_item_sk, d_date), store_daily AS (SELECT ss_item_sk, d_date, SUM(ss_sales_price) AS daily_store FROM store_sales INNER JOIN date_cte ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IS NOT NULL GROUP BY ss_item_sk, d_date), combined AS (SELECT COALESCE(web_daily.ws_item_sk, store_daily.ss_item_sk) AS item_sk, COALESCE(web_daily.d_date, store_daily.d_date) AS d_date, daily_web, daily_store FROM web_daily FULL OUTER JOIN store_daily ON web_daily.ws_item_sk = store_daily.ss_item_sk AND web_daily.d_date = store_daily.d_date), single_window_carryforward AS (SELECT item_sk, d_date, daily_web AS web_sales, daily_store AS store_sales, COALESCE(daily_web, LAST_VALUE(daily_web IGNORE NULLS) OVER (PARTITION BY item_sk ORDER BY d_date ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) AS web_cumulative, COALESCE(daily_store, LAST_VALUE(daily_store IGNORE NULLS) OVER (PARTITION BY item_sk ORDER BY d_date ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) AS store_cumulative FROM combined) SELECT * FROM single_window_carryforward WHERE web_cumulative > store_cumulative ORDER BY item_sk, d_date LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "decorrelate"
  ],
  "hint": "Combine deferred window and shared dimension patterns. Use LAST_VALUE IGNORE NUL",
  "error_message": "INTERFACE: [main_query] declares outputs ['d_date', 'item_sk', 'store_cumulative', 'store_sales', 'web_cumulative', 'web_sales'] but SELECT only produces ['*'] | INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs | INTERFACE: [web_daily] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk'] | INTERFACE: [web_daily] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk'] | INTERFACE: [store_daily] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk'] | INTERFACE: [store_daily] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']",
  "error_messages": [
    "INTERFACE: [main_query] declares outputs ['d_date', 'item_sk', 'store_cumulative', 'store_sales', 'web_cumulative', 'web_sales'] but SELECT only produces ['*']",
    "INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs",
    "INTERFACE: [web_daily] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [web_daily] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [store_daily] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [store_daily] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']"
  ],
  "error_category": null,
  "exploratory": true
}