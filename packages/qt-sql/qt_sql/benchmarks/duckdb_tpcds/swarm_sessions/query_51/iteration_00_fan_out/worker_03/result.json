{
  "worker_id": 3,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "prefetch_fact_join",
    "dimension_cte_isolate",
    "early_filter"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1216 AND 1216+11), web_prejoin AS (SELECT ws_item_sk, d_date, ws_sales_price FROM web_sales INNER JOIN date_cte ON ws_sold_date_sk = d_date_sk WHERE ws_item_sk IS NOT NULL), web_daily AS (SELECT ws_item_sk, d_date, SUM(ws_sales_price) AS daily_web FROM web_prejoin GROUP BY ws_item_sk, d_date), store_prejoin AS (SELECT ss_item_sk, d_date, ss_sales_price FROM store_sales INNER JOIN date_cte ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IS NOT NULL), store_daily AS (SELECT ss_item_sk, d_date, SUM(ss_sales_price) AS daily_store FROM store_prejoin GROUP BY ss_item_sk, d_date), combined AS (SELECT COALESCE(w.ws_item_sk, s.ss_item_sk) AS item_sk, COALESCE(w.d_date, s.d_date) AS d_date, w.daily_web, s.daily_store FROM web_daily w FULL OUTER JOIN store_daily s ON w.ws_item_sk = s.ss_item_sk AND w.d_date = s.d_date), cumulative AS (SELECT item_sk, d_date, daily_web AS web_sales, daily_store AS store_sales, SUM(daily_web) OVER (PARTITION BY item_sk ORDER BY d_date ROWS UNBOUNDED PRECEDING) AS web_cumulative, SUM(daily_store) OVER (PARTITION BY item_sk ORDER BY d_date ROWS UNBOUNDED PRECEDING) AS store_cumulative FROM combined) SELECT * FROM cumulative WHERE web_cumulative > store_cumulative ORDER BY item_sk, d_date LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "prefetch_fact_join"
  ],
  "hint": "Apply prefetch_fact_join pattern: filter date dimension first, then pre-join wit",
  "error_message": "INTERFACE: [main_query] declares outputs ['d_date', 'item_sk', 'store_cumulative', 'store_sales', 'web_cumulative', 'web_sales'] but SELECT only produces ['*'] | INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs | INTERFACE: [web_prejoin] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk'] | INTERFACE: [web_prejoin] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk'] | INTERFACE: [store_prejoin] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk'] | INTERFACE: [store_prejoin] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']",
  "error_messages": [
    "INTERFACE: [main_query] declares outputs ['d_date', 'item_sk', 'store_cumulative', 'store_sales', 'web_cumulative', 'web_sales'] but SELECT only produces ['*']",
    "INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs",
    "INTERFACE: [web_prejoin] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [web_prejoin] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [store_prejoin] uses \"d_date\" \u2014 did you mean \"d_date_sk\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [store_prejoin] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_cte]? [date_cte] only provides ['d_date', 'd_date_sk']"
  ],
  "error_category": null
}