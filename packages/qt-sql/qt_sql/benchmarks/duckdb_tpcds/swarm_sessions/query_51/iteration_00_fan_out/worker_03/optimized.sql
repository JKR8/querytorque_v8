WITH date_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1216 AND 1216+11), web_prejoin AS (SELECT ws_item_sk, d_date, ws_sales_price FROM web_sales INNER JOIN date_cte ON ws_sold_date_sk = d_date_sk WHERE ws_item_sk IS NOT NULL), web_daily AS (SELECT ws_item_sk, d_date, SUM(ws_sales_price) AS daily_web FROM web_prejoin GROUP BY ws_item_sk, d_date), store_prejoin AS (SELECT ss_item_sk, d_date, ss_sales_price FROM store_sales INNER JOIN date_cte ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IS NOT NULL), store_daily AS (SELECT ss_item_sk, d_date, SUM(ss_sales_price) AS daily_store FROM store_prejoin GROUP BY ss_item_sk, d_date), combined AS (SELECT COALESCE(w.ws_item_sk, s.ss_item_sk) AS item_sk, COALESCE(w.d_date, s.d_date) AS d_date, w.daily_web, s.daily_store FROM web_daily w FULL OUTER JOIN store_daily s ON w.ws_item_sk = s.ss_item_sk AND w.d_date = s.d_date), cumulative AS (SELECT item_sk, d_date, daily_web AS web_sales, daily_store AS store_sales, SUM(daily_web) OVER (PARTITION BY item_sk ORDER BY d_date ROWS UNBOUNDED PRECEDING) AS web_cumulative, SUM(daily_store) OVER (PARTITION BY item_sk ORDER BY d_date ROWS UNBOUNDED PRECEDING) AS store_cumulative FROM combined) SELECT * FROM cumulative WHERE web_cumulative > store_cumulative ORDER BY item_sk, d_date LIMIT 100