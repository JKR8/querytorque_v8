{
  "worker_id": 3,
  "strategy": "decorrelation_with_preaggregation",
  "examples_used": [
    "decorrelate",
    "composite_decorrelate_union",
    "multi_intersect_exists_cte"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-4-01' AND (CAST('2002-4-01' AS DATE) + INTERVAL 60 DAY)), addr_cte AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'WV'), call_cte AS (SELECT cc_call_center_sk FROM call_center WHERE cc_county IN ('Ziebach County', 'Luce County', 'Richland County', 'Daviess County', 'Barrow County')), multi_warehouse_cte AS (SELECT cs1.cs_order_number, cs1.cs_ext_ship_cost, cs1.cs_net_profit, cs1.cs_warehouse_sk FROM catalog_sales cs1 INNER JOIN date_cte ON cs1.cs_ship_date_sk = date_cte.d_date_sk INNER JOIN addr_cte ON cs1.cs_ship_addr_sk = addr_cte.ca_address_sk INNER JOIN call_cte ON cs1.cs_call_center_sk = call_cte.cc_call_center_sk), returns_cte AS (SELECT cr_order_number FROM catalog_returns GROUP BY cr_order_number), joined_filter AS (SELECT cs1.cs_order_number, cs1.cs_ext_ship_cost, cs1.cs_net_profit FROM multi_warehouse_cte cs1 WHERE EXISTS (SELECT 1 FROM catalog_sales cs2 WHERE cs1.cs_order_number = cs2.cs_order_number AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) AND NOT EXISTS (SELECT 1 FROM returns_cte r WHERE cs1.cs_order_number = r.cr_order_number)) SELECT COUNT(DISTINCT cs_order_number) AS \"order count\", SUM(cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs_net_profit) AS \"total net profit\" FROM joined_filter ORDER BY COUNT(DISTINCT cs_order_number) LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- decorrelate: Apply pre-aggregation of catalog_returns into CTE for anti-join; ",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}