{
  "worker_id": 1,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "date_cte_isolate",
    "prefetch_fact_join",
    "multi_dimension_prefetch"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN DATE '2002-4-01' AND (DATE '2002-4-01' + INTERVAL 60 DAY)), addr_cte AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'WV'), call_cte AS (SELECT cc_call_center_sk FROM call_center WHERE cc_county IN ('Ziebach County','Luce County','Richland County','Daviess County','Barrow County')), prefetch_cte AS (SELECT cs1.cs_order_number, cs1.cs_ext_ship_cost, cs1.cs_net_profit, cs1.cs_warehouse_sk FROM catalog_sales cs1 INNER JOIN date_cte ON cs1.cs_ship_date_sk = date_cte.d_date_sk INNER JOIN addr_cte ON cs1.cs_ship_addr_sk = addr_cte.ca_address_sk INNER JOIN call_cte ON cs1.cs_call_center_sk = call_cte.cc_call_center_sk), multi_warehouse_filter AS (SELECT cs_order_number, cs_ext_ship_cost, cs_net_profit FROM prefetch_cte cs1 WHERE EXISTS (SELECT 1 FROM catalog_sales cs2 WHERE cs1.cs_order_number = cs2.cs_order_number AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)), no_returns_filter AS (SELECT cs_order_number, cs_ext_ship_cost, cs_net_profit FROM multi_warehouse_filter cs1 WHERE NOT EXISTS (SELECT 1 FROM catalog_returns cr1 WHERE cs1.cs_order_number = cr1.cr_order_number)) SELECT COUNT(DISTINCT cs_order_number) AS \"order count\", SUM(cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs_net_profit) AS \"total net profit\" FROM no_returns_filter ORDER BY COUNT(DISTINCT cs_order_number) LIMIT 100",
  "speedup": 1.058410122071004,
  "status": "IMPROVED",
  "transforms": [
    "multi_dimension_prefetch"
  ],
  "hint": "- date_cte_isolate: Apply date filtering into separate CTE; ignore that Q31 regr",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}