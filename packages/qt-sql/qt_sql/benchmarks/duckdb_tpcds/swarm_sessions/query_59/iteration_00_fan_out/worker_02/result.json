{
  "worker_id": 2,
  "strategy": "date_cte_isolate",
  "examples_used": [
    "date_cte_isolate",
    "early_filter"
  ],
  "optimized_sql": "WITH date_period1_cte AS (SELECT d_date_sk, d_week_seq FROM date_dim WHERE d_month_seq BETWEEN 1196 AND 1196 + 11), date_period2_cte AS (SELECT d_date_sk, d_week_seq FROM date_dim WHERE d_month_seq BETWEEN 1196 + 12 AND 1196 + 23), wss_period1_cte AS (SELECT d_week_seq, ss_store_sk, SUM(CASE WHEN d_day_name = 'Sunday' THEN ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN d_day_name = 'Monday' THEN ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN d_day_name = 'Tuesday' THEN ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN d_day_name = 'Wednesday' THEN ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN d_day_name = 'Thursday' THEN ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN d_day_name = 'Friday' THEN ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN d_day_name = 'Saturday' THEN ss_sales_price ELSE NULL END) AS sat_sales FROM store_sales JOIN date_period1_cte ON ss_sold_date_sk = d_date_sk GROUP BY d_week_seq, ss_store_sk), wss_period2_cte AS (SELECT d_week_seq, ss_store_sk, SUM(CASE WHEN d_day_name = 'Sunday' THEN ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN d_day_name = 'Monday' THEN ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN d_day_name = 'Tuesday' THEN ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN d_day_name = 'Wednesday' THEN ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN d_day_name = 'Thursday' THEN ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN d_day_name = 'Friday' THEN ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN d_day_name = 'Saturday' THEN ss_sales_price ELSE NULL END) AS sat_sales FROM store_sales JOIN date_period2_cte ON ss_sold_date_sk = d_date_sk GROUP BY d_week_seq, ss_store_sk), joined_periods AS (SELECT s.s_store_name, s.s_store_id, p1.d_week_seq AS d_week_seq1, p1.sun_sales AS sun_sales1, p1.mon_sales AS mon_sales1, p1.tue_sales AS tue_sales1, p1.wed_sales AS wed_sales1, p1.thu_sales AS thu_sales1, p1.fri_sales AS fri_sales1, p1.sat_sales AS sat_sales1, p2.sun_sales AS sun_sales2, p2.mon_sales AS mon_sales2, p2.tue_sales AS tue_sales2, p2.wed_sales AS wed_sales2, p2.thu_sales AS thu_sales2, p2.fri_sales AS fri_sales2, p2.sat_sales AS sat_sales2 FROM wss_period1_cte p1 JOIN wss_period2_cte p2 ON p1.ss_store_sk = p2.ss_store_sk AND p1.d_week_seq = p2.d_week_seq - 52 JOIN store s ON p1.ss_store_sk = s.s_store_sk) SELECT s_store_name AS s_store_name1, s_store_id AS s_store_id1, d_week_seq1, sun_sales1 / sun_sales2, mon_sales1 / mon_sales2, tue_sales1 / tue_sales2, wed_sales1 / wed_sales2, thu_sales1 / thu_sales2, fri_sales1 / fri_sales2, sat_sales1 / sat_sales2 FROM joined_periods ORDER BY s_store_name1, s_store_id1, d_week_seq1 LIMIT 100",
  "speedup": 0.0,
  "status": "ERROR",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "date_cte_isolate: Apply the pattern of extracting date filtering into separate C",
  "error_message": "INTERFACE: [final_select] declares outputs ['fri_sales1 / fri_sales2', 'mon_sales1 / mon_sales2', 'sat_sales1 / sat_sales2', 'sun_sales1 / sun_sales2', 'thu_sales1 / thu_sales2', 'tue_sales1 / tue_sales2', 'wed_sales1 / wed_sales2'] but SELECT only produces ['d_week_seq1', 's_store_id1', 's_store_name1'] | Optimized query execution failed: Binder Error: Referenced column \"d_day_name\" not found in FROM clause!\nCandidate bindings: \"d_date_sk\", \"d_week_seq\", \"ss_addr_sk\", \"ss_coupon_amt\", \"ss_sold_date_sk\"\n\nLINE 1: ...iod1_cte AS (SELECT d_week_seq, ss_store_sk, SUM(CASE WHEN d_day_name = 'Sunday' THEN ss_sales_price ELSE NULL END...\n                                                                      ^",
  "error_messages": [
    "INTERFACE: [final_select] declares outputs ['fri_sales1 / fri_sales2', 'mon_sales1 / mon_sales2', 'sat_sales1 / sat_sales2', 'sun_sales1 / sun_sales2', 'thu_sales1 / thu_sales2', 'tue_sales1 / tue_sales2', 'wed_sales1 / wed_sales2'] but SELECT only produces ['d_week_seq1', 's_store_id1', 's_store_name1']",
    "Optimized query execution failed: Binder Error: Referenced column \"d_day_name\" not found in FROM clause!\nCandidate bindings: \"d_date_sk\", \"d_week_seq\", \"ss_addr_sk\", \"ss_coupon_amt\", \"ss_sold_date_sk\"\n\nLINE 1: ...iod1_cte AS (SELECT d_week_seq, ss_store_sk, SUM(CASE WHEN d_day_name = 'Sunday' THEN ss_sales_price ELSE NULL END...\n                                                                      ^"
  ],
  "error_category": "execution"
}