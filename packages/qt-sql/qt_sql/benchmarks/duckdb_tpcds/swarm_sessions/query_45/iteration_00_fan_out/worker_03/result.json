{
  "worker_id": 3,
  "strategy": "prefetch_fact_join",
  "examples_used": [
    "prefetch_fact_join",
    "early_filter",
    "date_cte_isolate"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2000), fact_date_join AS (SELECT ws_sales_price, ws_bill_customer_sk, ws_item_sk FROM web_sales JOIN date_cte ON ws_sold_date_sk = d_date_sk), zip_customers AS (SELECT c_customer_sk, ca_zip, ca_city FROM customer JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE substr(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')), item_filtered AS (SELECT i_item_sk FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)), or_join AS (SELECT COALESCE(zip_customers.ca_zip, '') AS ca_zip, COALESCE(zip_customers.ca_city, '') AS ca_city, fact_date_join.ws_sales_price FROM fact_date_join LEFT JOIN zip_customers ON fact_date_join.ws_bill_customer_sk = zip_customers.c_customer_sk LEFT JOIN item_filtered ON fact_date_join.ws_item_sk = item_filtered.i_item_sk WHERE zip_customers.c_customer_sk IS NOT NULL OR item_filtered.i_item_sk IS NOT NULL) SELECT ca_zip, ca_city, SUM(ws_sales_price) FROM or_join GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "prefetch_fact_join"
  ],
  "hint": "prefetch_fact_join: Build CTE chain: date_cte -> fact_date_join, then join filte",
  "error_message": "INTERFACE: [main_query] declares outputs ['sum(ws_sales_price)'] but SELECT only produces ['ca_city', 'ca_zip']",
  "error_messages": [
    "INTERFACE: [main_query] declares outputs ['sum(ws_sales_price)'] but SELECT only produces ['ca_city', 'ca_zip']"
  ],
  "error_category": null
}