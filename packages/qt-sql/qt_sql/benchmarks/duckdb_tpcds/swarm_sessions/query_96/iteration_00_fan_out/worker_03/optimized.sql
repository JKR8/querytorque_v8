WITH filtered_time AS (SELECT t_time_sk FROM time_dim WHERE t_hour = 8 AND t_minute >= 30), main_join AS (SELECT 1 AS join_key FROM store_sales INNER JOIN filtered_time ON ss_sold_time_sk = t_time_sk INNER JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk INNER JOIN store ON ss_store_sk = s_store_sk WHERE household_demographics.hd_dep_count = 3 AND store.s_store_name = 'ese'), aggregate AS (SELECT COUNT(*) AS cnt FROM main_join), limit AS (SELECT cnt FROM aggregate ORDER BY cnt ASC LIMIT 100) SELECT cnt AS "count(*)" FROM limit