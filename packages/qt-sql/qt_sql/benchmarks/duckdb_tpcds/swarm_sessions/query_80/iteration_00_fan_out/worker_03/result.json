{
  "worker_id": 3,
  "strategy": "early_filter",
  "examples_used": [
    "early_filter"
  ],
  "optimized_sql": "WITH ssr_early AS (SELECT s_store_id AS store_id,\n       SUM(ss_ext_sales_price) AS sales,\n       SUM(COALESCE(sr_return_amt, 0)) AS \"returns\",\n       SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit\nFROM store_sales\nINNER JOIN date_dim ON ss_sold_date_sk = d_date_sk\n   AND d_date BETWEEN CAST('1998-08-28' AS DATE) AND (CAST('1998-08-28' AS DATE) + INTERVAL 30 DAY)\nINNER JOIN item ON ss_item_sk = i_item_sk\n   AND i_current_price > 50\nINNER JOIN promotion ON ss_promo_sk = p_promo_sk\n   AND p_channel_tv = 'N'\nINNER JOIN store ON ss_store_sk = s_store_sk\nLEFT JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number)\nGROUP BY s_store_id),\n     csr_early AS (SELECT cp_catalog_page_id AS catalog_page_id,\n       SUM(cs_ext_sales_price) AS sales,\n       SUM(COALESCE(cr_return_amount, 0)) AS \"returns\",\n       SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit\nFROM catalog_sales\nINNER JOIN date_dim ON cs_sold_date_sk = d_date_sk\n   AND d_date BETWEEN CAST('1998-08-28' AS DATE) AND (CAST('1998-08-28' AS DATE) + INTERVAL 30 DAY)\nINNER JOIN item ON cs_item_sk = i_item_sk\n   AND i_current_price > 50\nINNER JOIN promotion ON cs_promo_sk = p_promo_sk\n   AND p_channel_tv = 'N'\nINNER JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk\nLEFT JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number)\nGROUP BY cp_catalog_page_id),\n     wsr_early AS (SELECT web_site_id,\n       SUM(ws_ext_sales_price) AS sales,\n       SUM(COALESCE(wr_return_amt, 0)) AS \"returns\",\n       SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit\nFROM web_sales\nINNER JOIN date_dim ON ws_sold_date_sk = d_date_sk\n   AND d_date BETWEEN CAST('1998-08-28' AS DATE) AND (CAST('1998-08-28' AS DATE) + INTERVAL 30 DAY)\nINNER JOIN item ON ws_item_sk = i_item_sk\n   AND i_current_price > 50\nINNER JOIN promotion ON ws_promo_sk = p_promo_sk\n   AND p_channel_tv = 'N'\nINNER JOIN web_site ON ws_web_site_sk = web_site_sk\nLEFT JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number)\nGROUP BY web_site_id)\nSELECT channel,\n       id,\n       SUM(sales) AS sales,\n       SUM(\"returns\") AS \"returns\",\n       SUM(profit) AS profit\nFROM (SELECT 'store channel' AS channel,\n             'store' || store_id AS id,\n             sales,\n             \"returns\",\n             profit\n      FROM ssr_early\n      UNION ALL\n      SELECT 'catalog channel' AS channel,\n             'catalog_page' || catalog_page_id AS id,\n             sales,\n             \"returns\",\n             profit\n      FROM csr_early\n      UNION ALL\n      SELECT 'web channel' AS channel,\n             'web_site' || web_site_id AS id,\n             sales,\n             \"returns\",\n             profit\n      FROM wsr_early) x\nGROUP BY ROLLUP(channel, id)\nORDER BY channel, id\nLIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "prefetch_fact_join"
  ],
  "hint": "Apply the early filter principle by moving dimension join conditions (including ",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}