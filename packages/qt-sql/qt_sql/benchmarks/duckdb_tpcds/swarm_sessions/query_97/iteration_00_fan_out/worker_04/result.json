{
  "worker_id": 4,
  "strategy": "set_operations_intersect_except",
  "examples_used": [
    "intersect_to_exists",
    "multi_intersect_exists_cte"
  ],
  "optimized_sql": "WITH store_distinct AS (SELECT ss_customer_sk AS customer_sk, ss_item_sk AS item_sk FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 GROUP BY ss_customer_sk, ss_item_sk), catalog_distinct AS (SELECT cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1214 AND 1214 + 11 GROUP BY cs_bill_customer_sk, cs_item_sk), intersect_count AS (SELECT COUNT(*) AS store_and_catalog FROM (SELECT customer_sk, item_sk FROM store_distinct INTERSECT SELECT customer_sk, item_sk FROM catalog_distinct)), except_store AS (SELECT COUNT(*) AS store_only FROM (SELECT customer_sk, item_sk FROM store_distinct EXCEPT SELECT customer_sk, item_sk FROM catalog_distinct)), except_catalog AS (SELECT COUNT(*) AS catalog_only FROM (SELECT customer_sk, item_sk FROM catalog_distinct EXCEPT SELECT customer_sk, item_sk FROM store_distinct)) SELECT store_only, catalog_only, store_and_catalog FROM except_store, except_catalog, intersect_count LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "intersect_to_exists"
  ],
  "hint": "- intersect_to_exists: We are doing the opposite: using INTERSECT/EXCEPT instead",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}