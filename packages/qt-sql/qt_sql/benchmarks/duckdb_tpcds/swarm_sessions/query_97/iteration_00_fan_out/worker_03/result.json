{
  "worker_id": 3,
  "strategy": "single_pass_aggregation via scalar subqueries",
  "examples_used": [
    "single_pass_aggregation",
    "pushdown"
  ],
  "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11), store_agg AS (SELECT ss_customer_sk AS customer_sk, ss_item_sk AS item_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk, ss_item_sk), catalog_agg AS (SELECT cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales JOIN date_filter ON cs_sold_date_sk = d_date_sk GROUP BY cs_bill_customer_sk, cs_item_sk) SELECT (SELECT COUNT(*) FROM store_agg s WHERE NOT EXISTS (SELECT 1 FROM catalog_agg c WHERE c.customer_sk = s.customer_sk AND c.item_sk = s.item_sk)) AS store_only, (SELECT COUNT(*) FROM catalog_agg c WHERE NOT EXISTS (SELECT 1 FROM store_agg s WHERE s.customer_sk = c.customer_sk AND s.item_sk = c.item_sk)) AS catalog_only, (SELECT COUNT(*) FROM store_agg s WHERE EXISTS (SELECT 1 FROM catalog_agg c WHERE c.customer_sk = s.customer_sk AND c.item_sk = s.item_sk)) AS store_and_catalog LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- single_pass_aggregation: Consolidate multiple aggregations into single query u",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}