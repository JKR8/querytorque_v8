WITH store_distinct AS (SELECT ss_customer_sk AS customer_sk, ss_item_sk AS item_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_month_seq BETWEEN 1214 AND 1214 + 11 GROUP BY ss_customer_sk, ss_item_sk), catalog_distinct AS (SELECT cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_month_seq BETWEEN 1214 AND 1214 + 11 GROUP BY cs_bill_customer_sk, cs_item_sk), store_only_count AS (SELECT COUNT(*) AS store_only FROM store_distinct s WHERE NOT EXISTS (SELECT 1 FROM catalog_distinct c WHERE c.customer_sk = s.customer_sk AND c.item_sk = s.item_sk)), catalog_only_count AS (SELECT COUNT(*) AS catalog_only FROM catalog_distinct c WHERE NOT EXISTS (SELECT 1 FROM store_distinct s WHERE s.customer_sk = c.customer_sk AND s.item_sk = c.item_sk)), overlap_count AS (SELECT COUNT(*) AS store_and_catalog FROM store_distinct s WHERE EXISTS (SELECT 1 FROM catalog_distinct c WHERE c.customer_sk = s.customer_sk AND c.item_sk = s.item_sk)) SELECT store_only, catalog_only, store_and_catalog FROM store_only_count, catalog_only_count, overlap_count LIMIT 100