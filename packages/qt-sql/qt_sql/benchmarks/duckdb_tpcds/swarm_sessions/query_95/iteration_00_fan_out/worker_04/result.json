{
  "worker_id": 4,
  "strategy": "compound_semantic_prefetch",
  "examples_used": [
    "materialize_cte",
    "prefetch_fact_join",
    "dimension_cte_isolate"
  ],
  "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN DATE '1999-02-01' AND (DATE '1999-02-01' + INTERVAL 60 DAY)), ca_filter AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'NC'), web_filter AS (SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'), prefetch_ws AS (SELECT ws1.ws_order_number, ws1.ws_ext_ship_cost, ws1.ws_net_profit FROM web_sales ws1, date_filter, ca_filter, web_filter WHERE ws1.ws_ship_date_sk = date_filter.d_date_sk AND ws1.ws_ship_addr_sk = ca_filter.ca_address_sk AND ws1.ws_web_site_sk = web_filter.web_site_sk), ws_wh_grouped AS (SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING MIN(ws_warehouse_sk) <> MAX(ws_warehouse_sk)) SELECT COUNT(DISTINCT ws_order_number) AS \"order count\", SUM(ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws_net_profit) AS \"total net profit\" FROM prefetch_ws WHERE ws_order_number IN (SELECT wr_order_number FROM web_returns WHERE wr_order_number IN (SELECT ws_order_number FROM ws_wh_grouped)) ORDER BY COUNT(DISTINCT ws_order_number) LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- materialize_cte: Materialize ws_wh_grouped.\n- prefetch_fact_join: Use CTE chai",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}