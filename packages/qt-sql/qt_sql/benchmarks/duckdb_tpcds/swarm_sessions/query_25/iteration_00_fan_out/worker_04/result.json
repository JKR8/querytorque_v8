{
  "worker_id": 4,
  "strategy": "join_reordering",
  "examples_used": [
    "early_filter",
    "prefetch_fact_join",
    "or_to_union"
  ],
  "optimized_sql": "WITH date_d1 AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2000), store_sales_small AS (SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN date_d1 ON ss_sold_date_sk = d_date_sk WHERE ss_ticket_number <= 2399999), date_d2 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2000), store_returns_with_d2 AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN date_d2 ON sr_returned_date_sk = d_date_sk), join_sr_ss AS (SELECT ss.ss_item_sk, ss.ss_store_sk, ss.ss_customer_sk, ss.ss_ticket_number, ss.ss_net_profit, sr.sr_net_loss FROM store_sales_small ss JOIN store_returns_with_d2 sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number), date_d3 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2000), catalog_sales_with_d3 AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN date_d3 ON cs_sold_date_sk = d_date_sk), join_cs AS (SELECT j.ss_item_sk, j.ss_store_sk, j.ss_net_profit, j.sr_net_loss, cs.cs_net_profit FROM join_sr_ss j JOIN catalog_sales_with_d3 cs ON j.ss_customer_sk = cs.cs_bill_customer_sk AND j.ss_item_sk = cs.cs_item_sk) SELECT i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name, SUM(jc.ss_net_profit) AS store_sales_profit, SUM(jc.sr_net_loss) AS store_returns_loss, SUM(jc.cs_net_profit) AS catalog_sales_profit FROM join_cs jc JOIN store s ON jc.ss_store_sk = s.s_store_sk JOIN item i ON jc.ss_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name ORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "prefetch_fact_join"
  ],
  "hint": "- early_filter (Q11): Apply filtering dimension (date) first and join with fact ",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}