{
  "worker_id": 3,
  "strategy": "prefetch_fact_join",
  "examples_used": [
    "prefetch_fact_join",
    "multi_dimension_prefetch"
  ],
  "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_week_seq IN (SELECT d_week_seq FROM date_dim WHERE d_date IN ('2001-06-06', '2001-09-02', '2001-11-11'))), sr_prejoin AS (SELECT sr_item_sk, sr_return_quantity FROM store_returns JOIN filtered_dates ON sr_returned_date_sk = d_date_sk), cr_prejoin AS (SELECT cr_item_sk, cr_return_quantity FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk), wr_prejoin AS (SELECT wr_item_sk, wr_return_quantity FROM web_returns JOIN filtered_dates ON wr_returned_date_sk = d_date_sk), sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM sr_prejoin JOIN item ON sr_item_sk = i_item_sk GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM cr_prejoin JOIN item ON cr_item_sk = i_item_sk GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM wr_prejoin JOIN item ON wr_item_sk = i_item_sk GROUP BY i_item_id) SELECT sr_items.item_id, sr_item_qty, sr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS sr_dev, cr_item_qty, cr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS cr_dev, wr_item_qty, wr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM sr_items, cr_items, wr_items WHERE sr_items.item_id = cr_items.item_id AND sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id, sr_item_qty LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "- prefetch_fact_join: Apply the pattern of building a CTE chain: filter dimensio",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}