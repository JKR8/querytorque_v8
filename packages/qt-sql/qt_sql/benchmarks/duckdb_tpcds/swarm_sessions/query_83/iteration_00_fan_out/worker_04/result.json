{
  "worker_id": 4,
  "strategy": "late_attribute_binding",
  "examples_used": [
    "dimension_cte_isolate",
    "late_attribute_binding (novel)"
  ],
  "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_week_seq IN (SELECT d_week_seq FROM date_dim WHERE d_date IN ('2001-06-06','2001-09-02','2001-11-11'))), sr_agg AS (SELECT sr_item_sk AS item_sk, SUM(sr_return_quantity) AS sr_qty FROM store_returns JOIN filtered_dates ON sr_returned_date_sk = d_date_sk GROUP BY sr_item_sk), cr_agg AS (SELECT cr_item_sk AS item_sk, SUM(cr_return_quantity) AS cr_qty FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk GROUP BY cr_item_sk), wr_agg AS (SELECT wr_item_sk AS item_sk, SUM(wr_return_quantity) AS wr_qty FROM web_returns JOIN filtered_dates ON wr_returned_date_sk = d_date_sk GROUP BY wr_item_sk) SELECT i.i_item_id AS item_id, sr_agg.sr_qty AS sr_item_qty, sr_agg.sr_qty/(sr_agg.sr_qty + cr_agg.cr_qty + wr_agg.wr_qty)/3.0 * 100 AS sr_dev, cr_agg.cr_qty AS cr_item_qty, cr_agg.cr_qty/(sr_agg.sr_qty + cr_agg.cr_qty + wr_agg.wr_qty)/3.0 * 100 AS cr_dev, wr_agg.wr_qty AS wr_item_qty, wr_agg.wr_qty/(sr_agg.sr_qty + cr_agg.cr_qty + wr_agg.wr_qty)/3.0 * 100 AS wr_dev, (sr_agg.sr_qty + cr_agg.cr_qty + wr_agg.wr_qty)/3.0 AS average FROM sr_agg JOIN cr_agg ON sr_agg.item_sk = cr_agg.item_sk JOIN wr_agg ON sr_agg.item_sk = wr_agg.item_sk JOIN item i ON sr_agg.item_sk = i.i_item_sk ORDER BY i.i_item_id, sr_agg.sr_qty LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- dimension_cte_isolate: Apply the pattern of pre-filtering dimension tables int",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}