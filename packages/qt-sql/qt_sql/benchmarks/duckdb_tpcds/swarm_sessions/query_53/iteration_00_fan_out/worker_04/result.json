{
  "worker_id": 4,
  "strategy": "compound_prefetch_early_aggregation",
  "examples_used": [
    "prefetch_fact_join",
    "early_filter",
    "pushdown"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk, d_qoy FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1211), store_cte AS (SELECT s_store_sk FROM store WHERE s_store_sk <= 100), prefact_cte AS (SELECT ss_item_sk, ss_sales_price, d_qoy FROM store_sales INNER JOIN date_cte ON ss_sold_date_sk = d_date_sk INNER JOIN store_cte ON ss_store_sk = s_store_sk), join_item_cte AS (SELECT i_manufact_id, d_qoy, ss_sales_price FROM prefact_cte INNER JOIN item ON ss_item_sk = i_item_sk WHERE ((i_category IN ('Books','Children','Electronics') AND i_class IN ('personal','portable','reference','self-help') AND i_brand IN ('scholaramalgamalg #14','scholaramalgamalg #7','exportiunivamalg #9','scholaramalgamalg #9')) OR (i_category IN ('Women','Music','Men') AND i_class IN ('accessories','classical','fragrances','pants') AND i_brand IN ('amalgimporto #1','edu packscholar #1','exportiimporto #1','importoamalg #1')))), agg_cte AS (SELECT i_manufact_id, d_qoy, SUM(ss_sales_price) AS sum_sales FROM join_item_cte GROUP BY i_manufact_id, d_qoy), window_cte AS (SELECT i_manufact_id, d_qoy, sum_sales, AVG(sum_sales) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM agg_cte), filter_cte AS (SELECT i_manufact_id, sum_sales, avg_quarterly_sales FROM window_cte WHERE CASE WHEN avg_quarterly_sales > 0 THEN ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales ELSE NULL END > 0.1), top_n AS (SELECT i_manufact_id, sum_sales, avg_quarterly_sales FROM filter_cte ORDER BY avg_quarterly_sales ASC, sum_sales ASC, i_manufact_id ASC LIMIT 100) SELECT * FROM top_n",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "early_filter"
  ],
  "hint": "- prefetch_fact_join: Apply the concept of pre-joining fact with some dimensions",
  "error_message": "INTERFACE: [main_query] declares outputs ['avg_quarterly_sales', 'i_manufact_id', 'sum_sales'] but SELECT only produces ['*'] | INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs",
  "error_messages": [
    "INTERFACE: [main_query] declares outputs ['avg_quarterly_sales', 'i_manufact_id', 'sum_sales'] but SELECT only produces ['*']",
    "INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs"
  ],
  "error_category": null,
  "exploratory": true
}