{
  "worker_id": 1,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation",
    "pushdown"
  ],
  "optimized_sql": "WITH store_aggregates_cte AS (SELECT COUNT(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN 1 END) as cnt_1_20, AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_ext_sales_price END) as avg_ext_1_20, AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_net_profit END) as avg_net_1_20, COUNT(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN 1 END) as cnt_21_40, AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_ext_sales_price END) as avg_ext_21_40, AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_net_profit END) as avg_net_21_40, COUNT(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN 1 END) as cnt_41_60, AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_ext_sales_price END) as avg_ext_41_60, AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_net_profit END) as avg_net_41_60, COUNT(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN 1 END) as cnt_61_80, AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_ext_sales_price END) as avg_ext_61_80, AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_net_profit END) as avg_net_61_80, COUNT(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN 1 END) as cnt_81_100, AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_ext_sales_price END) as avg_ext_81_100, AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_net_profit END) as avg_net_81_100 FROM store_sales WHERE ss_quantity BETWEEN 1 AND 100) SELECT CASE WHEN cnt_1_20 > 2972190 THEN avg_ext_1_20 ELSE avg_net_1_20 END as bucket1, CASE WHEN cnt_21_40 > 4505785 THEN avg_ext_21_40 ELSE avg_net_21_40 END as bucket2, CASE WHEN cnt_41_60 > 1575726 THEN avg_ext_41_60 ELSE avg_net_41_60 END as bucket3, CASE WHEN cnt_61_80 > 3188917 THEN avg_ext_61_80 ELSE avg_net_61_80 END as bucket4, CASE WHEN cnt_81_100 > 3525216 THEN avg_ext_81_100 ELSE avg_net_81_100 END as bucket5 FROM reason CROSS JOIN store_aggregates_cte WHERE r_reason_sk = 1",
  "speedup": 0.6360398164635136,
  "status": "REGRESSION",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation: Apply CASE WHEN inside aggregates to compute all metr",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}