{
  "worker_id": 1,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "dimension_cte_isolate",
    "prefetch_fact_join",
    "date_cte_isolate"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2002-05-20' AS DATE) AND (CAST('2002-05-20' AS DATE) + INTERVAL 30 DAY)), filtered_item AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Music', 'Shoes')), prefetched_sales AS (SELECT i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price, ss.ss_ext_sales_price FROM store_sales ss INNER JOIN filtered_date fd ON ss.ss_sold_date_sk = fd.d_date_sk INNER JOIN filtered_item i ON ss.ss_item_sk = i.i_item_sk), main_aggregation AS (SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ss_ext_sales_price) AS itemrevenue FROM prefetched_sales GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price), window_computation AS (SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, itemrevenue, itemrevenue * 100 / SUM(itemrevenue) OVER (PARTITION BY i_class) AS revenueratio FROM main_aggregation) SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, itemrevenue, revenueratio FROM window_computation ORDER BY i_category, i_class, i_item_id, i_item_desc, revenueratio",
  "speedup": 1.0710123713782356,
  "status": "IMPROVED",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- dimension_cte_isolate: Apply pre-filtering of both date_dim and item into sepa",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}