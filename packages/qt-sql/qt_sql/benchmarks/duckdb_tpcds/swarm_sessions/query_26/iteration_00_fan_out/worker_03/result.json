{
  "worker_id": 3,
  "strategy": "prefetch_fact_join",
  "examples_used": [
    "prefetch_fact_join",
    "early_filter",
    "pushdown"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), fact_date_join AS (SELECT cs_item_sk, cs_bill_cdemo_sk, cs_promo_sk, cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price FROM catalog_sales JOIN date_cte ON cs_sold_date_sk = d_date_sk), customer_join AS (SELECT fact_date_join.cs_item_sk, fact_date_join.cs_promo_sk, fact_date_join.cs_quantity, fact_date_join.cs_list_price, fact_date_join.cs_coupon_amt, fact_date_join.cs_sales_price FROM fact_date_join JOIN customer_demographics ON fact_date_join.cs_bill_cdemo_sk = customer_demographics.cd_demo_sk WHERE customer_demographics.cd_gender = 'M' AND customer_demographics.cd_marital_status = 'S' AND customer_demographics.cd_education_status = 'Unknown'), promotion_join AS (SELECT customer_join.cs_item_sk, customer_join.cs_quantity, customer_join.cs_list_price, customer_join.cs_coupon_amt, customer_join.cs_sales_price FROM customer_join JOIN promotion ON customer_join.cs_promo_sk = promotion.p_promo_sk WHERE promotion.p_channel_email = 'N' OR promotion.p_channel_event = 'N'), item_join AS (SELECT item.i_item_id, promotion_join.cs_quantity, promotion_join.cs_list_price, promotion_join.cs_coupon_amt, promotion_join.cs_sales_price FROM promotion_join JOIN item ON promotion_join.cs_item_sk = item.i_item_sk) SELECT i_item_id, AVG(cs_quantity) AS agg1, AVG(cs_list_price) AS agg2, AVG(cs_coupon_amt) AS agg3, AVG(cs_sales_price) AS agg4 FROM item_join GROUP BY i_item_id ORDER BY i_item_id LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "prefetch_fact_join"
  ],
  "hint": "- prefetch_fact_join: Apply staged CTE chain: date filter \u2192 fact join \u2192 other di",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}