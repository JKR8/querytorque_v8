{
  "worker_id": 2,
  "strategy": "prefetch_fact_join",
  "examples_used": [
    "prefetch_fact_join (Q63)",
    "multi_dimension_prefetch (Q43)",
    "date_cte_isolate (Q6)"
  ],
  "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE (d_dom BETWEEN 1 AND 3 OR d_dom BETWEEN 25 AND 28) AND d_year IN (1998, 1999, 2000)), fact_date_join AS (SELECT ss_sold_date_sk, ss_store_sk, ss_hdemo_sk, ss_ticket_number, ss_customer_sk FROM store_sales INNER JOIN date_filtered ON ss_sold_date_sk = d_date_sk), store_filtered AS (SELECT s_store_sk FROM store WHERE s_county IN ('Ziebach County', 'Daviess County', 'Walker County', 'Richland County', 'Barrow County', 'Franklin Parish', 'Williamson County', 'Luce County')), fact_store_join AS (SELECT fact_date_join.ss_sold_date_sk, fact_date_join.ss_store_sk, fact_date_join.ss_hdemo_sk, fact_date_join.ss_ticket_number, fact_date_join.ss_customer_sk FROM fact_date_join INNER JOIN store_filtered ON fact_date_join.ss_store_sk = store_filtered.s_store_sk), hh_filtered AS (SELECT hd_demo_sk FROM household_demographics WHERE (hd_buy_potential = '1001-5000' OR hd_buy_potential = '0-500') AND hd_vehicle_count > 0 AND (CASE WHEN hd_vehicle_count > 0 THEN hd_dep_count / hd_vehicle_count ELSE NULL END) > 1.2), fact_hh_join AS (SELECT fact_store_join.ss_ticket_number, fact_store_join.ss_customer_sk FROM fact_store_join INNER JOIN hh_filtered ON fact_store_join.ss_hdemo_sk = hh_filtered.hd_demo_sk), aggregation AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM fact_hh_join GROUP BY ss_ticket_number, ss_customer_sk), customer_join AS (SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, aggregation.ss_ticket_number, aggregation.cnt FROM aggregation INNER JOIN customer ON aggregation.ss_customer_sk = customer.c_customer_sk WHERE aggregation.cnt BETWEEN 15 AND 20) SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM customer_join ORDER BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC, ss_ticket_number",
  "speedup": 0.9357917888790693,
  "status": "REGRESSION",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- prefetch_fact_join (Q63): Apply staged join pipeline: filter date_dim first, p",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}