{
  "worker_id": 1,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation"
  ],
  "optimized_sql": "WITH store_agg AS (SELECT c.c_customer_id AS customer_id,\n       c.c_first_name AS customer_first_name,\n       c.c_last_name AS customer_last_name,\n       d.d_year AS year,\n       STDDEV_SAMP(ss.ss_net_paid) AS year_total,\n       's' AS sale_type\nFROM customer c\nJOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nJOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE d.d_year IN (1999, 2000)\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year),\n     web_agg AS (SELECT c.c_customer_id AS customer_id,\n       c.c_first_name AS customer_first_name,\n       c.c_last_name AS customer_last_name,\n       d.d_year AS year,\n       STDDEV_SAMP(ws.ws_net_paid) AS year_total,\n       'w' AS sale_type\nFROM customer c\nJOIN web_sales ws ON c.c_customer_sk = ws.ws_bill_customer_sk\nJOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\nWHERE d.d_year IN (1999, 2000)\nGROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, d.d_year)\nSELECT s2000.customer_id,\n       s2000.customer_first_name,\n       s2000.customer_last_name\nFROM store_agg s1999\nJOIN store_agg s2000 ON s1999.customer_id = s2000.customer_id\nJOIN web_agg w1999 ON s1999.customer_id = w1999.customer_id\nJOIN web_agg w2000 ON s1999.customer_id = w2000.customer_id\nWHERE s1999.year = 1999 AND s1999.sale_type = 's'\n  AND s2000.year = 2000 AND s2000.sale_type = 's'\n  AND w1999.year = 1999 AND w1999.sale_type = 'w'\n  AND w2000.year = 2000 AND w2000.sale_type = 'w'\n  AND s1999.year_total > 0\n  AND w1999.year_total > 0\n  AND (w2000.year_total / w1999.year_total) > (s2000.year_total / s1999.year_total)\nORDER BY s2000.customer_first_name ASC,\n         s2000.customer_id ASC,\n         s2000.customer_last_name ASC\nLIMIT 100",
  "speedup": 2.19606477114086,
  "status": "WIN",
  "transforms": [
    "union_cte_split"
  ],
  "hint": "- single_pass_aggregation: Apply consolidation of multiple year scans into singl",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}