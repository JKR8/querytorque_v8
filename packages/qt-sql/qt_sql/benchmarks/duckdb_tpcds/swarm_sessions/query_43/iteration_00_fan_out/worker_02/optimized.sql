WITH filtered_date AS (SELECT d_date_sk, d_day_name FROM date_dim WHERE d_year = 2000), date_filtered_sales AS (SELECT ss_store_sk, d_day_name, ss_sales_price FROM store_sales INNER JOIN filtered_date ON ss_sold_date_sk = d_date_sk), filtered_store_join AS (SELECT s_store_name, s_store_id, d_day_name, ss_sales_price FROM date_filtered_sales INNER JOIN store ON ss_store_sk = s_store_sk AND s_gmt_offset = -5) SELECT s_store_name, s_store_id, SUM(CASE WHEN d_day_name='Sunday' THEN ss_sales_price END) AS sun_sales, SUM(CASE WHEN d_day_name='Monday' THEN ss_sales_price END) AS mon_sales, SUM(CASE WHEN d_day_name='Tuesday' THEN ss_sales_price END) AS tue_sales, SUM(CASE WHEN d_day_name='Wednesday' THEN ss_sales_price END) AS wed_sales, SUM(CASE WHEN d_day_name='Thursday' THEN ss_sales_price END) AS thu_sales, SUM(CASE WHEN d_day_name='Friday' THEN ss_sales_price END) AS fri_sales, SUM(CASE WHEN d_day_name='Saturday' THEN ss_sales_price END) AS sat_sales FROM filtered_store_join GROUP BY s_store_name, s_store_id ORDER BY s_store_name, s_store_id, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales LIMIT 100