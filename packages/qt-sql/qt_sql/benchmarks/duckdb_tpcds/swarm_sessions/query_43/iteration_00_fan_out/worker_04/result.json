{
  "worker_id": 4,
  "strategy": "composite_key_prejoin",
  "examples_used": [
    "multi_date_range_cte",
    "channel_bitmap_aggregation",
    "single_pass_aggregation"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_day_name FROM date_dim WHERE d_year = 2000), filtered_store AS (SELECT s_store_sk, s_store_name, s_store_id FROM store WHERE s_gmt_offset = -5), dim_key_product AS (SELECT fd.d_date_sk, fd.d_day_name, fs.s_store_sk, fs.s_store_name, fs.s_store_id FROM filtered_date fd CROSS JOIN filtered_store fs), fact_composite_join AS (SELECT dkp.s_store_name, dkp.s_store_id, dkp.d_day_name, ss.ss_sales_price FROM dim_key_product dkp INNER JOIN store_sales ss ON ss.ss_sold_date_sk = dkp.d_date_sk AND ss.ss_store_sk = dkp.s_store_sk), attribute_join AS (SELECT s_store_name, s_store_id, d_day_name, ss_sales_price FROM fact_composite_join)\nSELECT s_store_name, s_store_id, SUM(CASE WHEN d_day_name='Sunday' THEN ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN d_day_name='Monday' THEN ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN d_day_name='Tuesday' THEN ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN d_day_name='Wednesday' THEN ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN d_day_name='Thursday' THEN ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN d_day_name='Friday' THEN ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN d_day_name='Saturday' THEN ss_sales_price ELSE NULL END) AS sat_sales FROM attribute_aj GROUP BY s_store_name, s_store_id ORDER BY s_store_name, s_store_id, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "multi_dimension_prefetch"
  ],
  "hint": "- multi_date_range_cte (Q29): Apply creating separate CTEs for each dimension fi",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}