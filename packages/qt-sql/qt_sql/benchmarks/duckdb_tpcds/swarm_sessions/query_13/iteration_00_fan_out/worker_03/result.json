{
  "worker_id": 3,
  "strategy": "single_pass_pivot",
  "examples_used": [
    "single_pass_aggregation (Q9)",
    "channel_bitmap_aggregation (Q88)"
  ],
  "optimized_sql": "WITH filtered_fact AS (SELECT ss.ss_quantity, ss.ss_ext_sales_price, ss.ss_ext_wholesale_cost, ss.ss_sales_price, ss.ss_net_profit, cd.cd_marital_status, cd.cd_education_status, hd.hd_dep_count, ca.ca_state FROM store_sales ss INNER JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk AND d.d_year = 2001 INNER JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk AND ca.ca_country = 'United States' INNER JOIN customer_demographics cd ON ss.ss_cdemo_sk = cd.cd_demo_sk INNER JOIN household_demographics hd ON ss.ss_hdemo_sk = hd.hd_demo_sk INNER JOIN store s ON ss.ss_store_sk = s.s_store_sk WHERE (cd.cd_marital_status, cd.cd_education_status, hd.hd_dep_count) IN (('D', 'Unknown', 3), ('S', 'College', 1), ('M', '4 yr Degree', 1)) AND ca.ca_state IN ('SD', 'KS', 'MI', 'MO', 'ND', 'CO', 'NH', 'OH', 'TX') AND ((ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND cd.cd_marital_status = 'D') OR (ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND cd.cd_marital_status = 'S') OR (ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND cd.cd_marital_status = 'M'))), scenario_label AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM filtered_fact WHERE ((cd_marital_status = 'D' AND cd_education_status = 'Unknown' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((ca_state IN ('SD', 'KS', 'MI') AND ss_net_profit BETWEEN 100 AND 200) OR (ca_state IN ('MO', 'ND', 'CO') AND ss_net_profit BETWEEN 150 AND 300) OR (ca_state IN ('NH', 'OH', 'TX') AND ss_net_profit BETWEEN 50 AND 250))) SELECT AVG(ss_quantity) AS \"avg(ss_quantity)\", AVG(ss_ext_sales_price) AS \"avg(ss_ext_sales_price)\", AVG(ss_ext_wholesale_cost) AS \"avg(ss_ext_wholesale_cost)\", SUM(ss_ext_wholesale_cost) AS \"sum(ss_ext_wholesale_cost)\" FROM scenario_label",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "prefetch_fact_join"
  ],
  "hint": "Q9 consolidates multiple subqueries into CASE aggregates; adapt by pushing filte",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}