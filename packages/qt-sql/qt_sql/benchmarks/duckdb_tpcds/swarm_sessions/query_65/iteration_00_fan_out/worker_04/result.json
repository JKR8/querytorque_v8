{
  "worker_id": 4,
  "strategy": "window_function_aggregation",
  "examples_used": [
    "deferred_window_aggregation",
    "single_pass_aggregation"
  ],
  "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1221 AND 1221+11), fact_with_date AS (SELECT ss_store_sk, ss_item_sk, ss_sales_price FROM store_sales INNER JOIN date_filter ON store_sales.ss_sold_date_sk = date_filter.d_date_sk), store_item_revenue_window AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue, AVG(SUM(ss_sales_price)) OVER (PARTITION BY ss_store_sk) AS ave FROM fact_with_date GROUP BY ss_store_sk, ss_item_sk), filtered_pairs AS (SELECT ss_store_sk, ss_item_sk, revenue FROM store_item_revenue_window WHERE revenue <= 0.1 * ave), join_store_item AS (SELECT store.s_store_name, item.i_item_desc, filtered_pairs.revenue, item.i_current_price, item.i_wholesale_cost, item.i_brand FROM filtered_pairs INNER JOIN store ON filtered_pairs.ss_store_sk = store.s_store_sk INNER JOIN item ON filtered_pairs.ss_item_sk = item.i_item_sk) SELECT s_store_name, i_item_desc, revenue, i_current_price, i_wholesale_cost, i_brand FROM join_store_item ORDER BY s_store_name ASC, i_item_desc ASC LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "deferred_window_aggregation: Apply the principle of computing window function (A",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}