WITH date_dim_cte AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11 AND d_year = 2002), item_cte AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1), joined_fact AS (SELECT d.d_year, i.i_category_id, i.i_category, ss.ss_ext_sales_price FROM store_sales ss INNER JOIN date_dim_cte d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN item_cte i ON ss.ss_item_sk = i.i_item_sk), aggregate AS (SELECT d_year, i_category_id, i_category, SUM(ss_ext_sales_price) AS sum_sales FROM joined_fact GROUP BY d_year, i_category_id, i_category) SELECT d_year, i_category_id, i_category, sum_sales AS "sum(ss_ext_sales_price)" FROM aggregate ORDER BY sum_sales DESC, d_year, i_category_id, i_category LIMIT 100