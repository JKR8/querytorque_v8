{
  "worker_id": 4,
  "strategy": "compound_single_pass_prefetch_union",
  "examples_used": [
    "single_pass_aggregation",
    "or_to_union",
    "star_join_prefetch"
  ],
  "optimized_sql": "WITH promotion_dmail AS (SELECT p_promo_sk FROM promotion WHERE p_channel_dmail = 'Y'), promotion_email AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'Y'), promotion_tv AS (SELECT p_promo_sk FROM promotion WHERE p_channel_tv = 'Y'), union_promotion AS (SELECT p_promo_sk FROM promotion_dmail UNION DISTINCT SELECT p_promo_sk FROM promotion_email UNION DISTINCT SELECT p_promo_sk FROM promotion_tv), filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy = 11), filtered_item AS (SELECT i_item_sk FROM item WHERE i_category = 'Jewelry'), filtered_store AS (SELECT s_store_sk FROM store WHERE s_gmt_offset = -7), filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7), single_scan AS (SELECT SUM(ss_ext_sales_price) AS total, SUM(CASE WHEN p.p_promo_sk IS NOT NULL THEN ss_ext_sales_price ELSE 0 END) AS promotions FROM store_sales INNER JOIN filtered_date ON ss_sold_date_sk = d_date_sk INNER JOIN filtered_store ON ss_store_sk = s_store_sk INNER JOIN filtered_item ON ss_item_sk = i_item_sk INNER JOIN customer ON ss_customer_sk = c_customer_sk INNER JOIN filtered_customer_address ON ca_address_sk = c_current_addr_sk LEFT JOIN union_promotion p ON ss_promo_sk = p.p_promo_sk) SELECT promotions, total, CAST(promotions AS DECIMAL(15,4))/CAST(total AS DECIMAL(15,4))*100 FROM single_scan ORDER BY promotions, total LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "or_to_union"
  ],
  "hint": "- single_pass_aggregation (Q9): Apply consolidation of two subqueries into one s",
  "error_message": "INTERFACE: [final_calculation] declares outputs ['cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100'] but SELECT only produces ['promotions', 'total']",
  "error_messages": [
    "INTERFACE: [final_calculation] declares outputs ['cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100'] but SELECT only produces ['promotions', 'total']"
  ],
  "error_category": null,
  "exploratory": true
}