{
  "worker_id": 4,
  "strategy": "late_attribute_binding_with_pivot",
  "examples_used": [
    "single_pass_aggregation",
    "deferred_window_aggregation",
    "dimension_cte_isolate"
  ],
  "optimized_sql": "-- start query 21 in stream 0 using template query21.tpl\nselect *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2002-02-27' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2002-02-27' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between (cast ('2002-02-27' as date) - INTERVAL 30 DAY)\n                    and (cast ('2002-02-27' as date) + INTERVAL 30 DAY)\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n LIMIT 100;\n\n-- end query 21 in stream 0 using template query21.tpl",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [],
  "hint": "- single_pass_aggregation: Apply consolidating before/after aggregation into one",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}