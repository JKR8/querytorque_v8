{
  "worker_id": 4,
  "strategy": "single_pass_aggregation adaptation (dimension bitmap join)",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation",
    "pushdown"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), store_cte AS (SELECT s_store_sk FROM store WHERE s_store_sk <= 100), demographics_bitmap AS (SELECT cd_demo_sk, CASE WHEN cd_marital_status = 'U' AND cd_education_status = 'Primary' THEN 1 WHEN cd_marital_status = 'W' AND cd_education_status = 'College' THEN 2 WHEN cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' THEN 3 END AS demo_group FROM customer_demographics WHERE (cd_marital_status = 'U' AND cd_education_status = 'Primary') OR (cd_marital_status = 'W' AND cd_education_status = 'College') OR (cd_marital_status = 'D' AND cd_education_status = '2 yr Degree')), address_bitmap AS (SELECT ca_address_sk, CASE WHEN ca_state IN ('MD','MN','IA') THEN 1 WHEN ca_state IN ('VA','IL','TX') THEN 2 WHEN ca_state IN ('MI','WI','IN') THEN 3 END AS addr_group FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('MD','MN','IA','VA','IL','TX','MI','WI','IN')), store_sales_enriched AS (SELECT ss.ss_quantity FROM store_sales ss INNER JOIN date_cte d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN store_cte s ON ss.ss_store_sk = s.s_store_sk INNER JOIN demographics_bitmap cd ON ss.ss_cdemo_sk = cd.cd_demo_sk INNER JOIN address_bitmap ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ((cd.demo_group = 1 AND ss.ss_sales_price BETWEEN 100.00 AND 150.00) OR (cd.demo_group = 2 AND ss.ss_sales_price BETWEEN 50.00 AND 100.00) OR (cd.demo_group = 3 AND ss.ss_sales_price BETWEEN 150.00 AND 200.00)) AND ((ca.addr_group = 1 AND ss.ss_net_profit BETWEEN 0 AND 2000) OR (ca.addr_group = 2 AND ss.ss_net_profit BETWEEN 150 AND 3000) OR (ca.addr_group = 3 AND ss.ss_net_profit BETWEEN 50 AND 25000))), aggregation AS (SELECT SUM(ss_quantity) AS total_quantity FROM store_sales_enriched) SELECT total_quantity AS \"sum(ss_quantity)\" FROM aggregation",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "date_cte_isolate"
  ],
  "hint": "single_pass_aggregation: Adapt CASE labeling to encode OR groups; ignore the sca",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}