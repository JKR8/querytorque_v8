{
  "worker_id": 1,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation"
  ],
  "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1184 AND 1184 + 11), sales_unified AS (SELECT customer.c_last_name, customer.c_first_name, date_filtered.d_date, sales.channel FROM (SELECT ss_sold_date_sk AS sold_date_sk, ss_customer_sk AS customer_sk, 'store' AS channel FROM store_sales UNION ALL SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, 'catalog' AS channel FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, 'web' AS channel FROM web_sales) sales INNER JOIN date_filtered ON sales.sold_date_sk = date_filtered.d_date_sk INNER JOIN customer ON sales.customer_sk = customer.c_customer_sk), channel_presence AS (SELECT c_last_name, c_first_name, d_date, MAX(CASE WHEN channel = 'store' THEN 1 ELSE 0 END) AS has_store, MAX(CASE WHEN channel = 'catalog' THEN 1 ELSE 0 END) AS has_catalog, MAX(CASE WHEN channel = 'web' THEN 1 ELSE 0 END) AS has_web FROM sales_unified GROUP BY c_last_name, c_first_name, d_date), store_only AS (SELECT c_last_name, c_first_name, d_date FROM channel_presence WHERE has_store = 1 AND has_catalog = 0 AND has_web = 0), count AS (SELECT COUNT(*) AS \"count(*)\" FROM store_only) SELECT \"count(*)\" FROM count",
  "speedup": 1.3983514207958936,
  "status": "WIN",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation (Q9): Apply CASE aggregation to detect channel presenc",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}