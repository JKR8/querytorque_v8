{
  "worker_id": 3,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "dimension_cte_isolate",
    "multi_dimension_prefetch",
    "prefetch_fact_join"
  ],
  "optimized_sql": "WITH date_seq_cte AS (SELECT DISTINCT d_month_seq FROM date_dim WHERE d_year = 2002 AND d_moy = 3), filtered_dates AS (SELECT d.d_date_sk FROM date_dim d INNER JOIN date_seq_cte ds ON d.d_month_seq = ds.d_month_seq), item_avg_cte AS (SELECT i_category, AVG(i_current_price) AS avg_price FROM item GROUP BY i_category), filtered_items AS (SELECT i.i_item_sk, i.i_category FROM item i INNER JOIN item_avg_cte ia ON i.i_category = ia.i_category WHERE i.i_current_price > 1.2 * ia.avg_price), prefetch_core AS (SELECT s.ss_customer_sk, fi.i_category FROM store_sales s INNER JOIN filtered_dates fd ON s.ss_sold_date_sk = fd.d_date_sk INNER JOIN filtered_items fi ON s.ss_item_sk = fi.i_item_sk) SELECT a.ca_state AS state, COUNT(*) AS cnt FROM prefetch_core pc INNER JOIN customer c ON pc.ss_customer_sk = c.c_customer_sk INNER JOIN customer_address a ON c.c_current_addr_sk = a.ca_address_sk GROUP BY a.ca_state HAVING COUNT(*) >= 10 ORDER BY cnt, a.ca_state LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- dimension_cte_isolate: Apply pre-filtering of date_dim and item into CTEs. Ign",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}