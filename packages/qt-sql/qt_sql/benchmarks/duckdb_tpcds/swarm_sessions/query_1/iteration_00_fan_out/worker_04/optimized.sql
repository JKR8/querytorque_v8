WITH store_sd AS (SELECT s_store_sk FROM store WHERE s_state = 'SD'), date_2000 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), prefiltered_returns AS (SELECT sr_customer_sk, sr_store_sk, sr_fee FROM store_returns INNER JOIN date_2000 ON sr_returned_date_sk = d_date_sk INNER JOIN store_sd ON sr_store_sk = s_store_sk), window_aggregates AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, SUM(sr_fee) AS ctr_total_return, AVG(SUM(sr_fee)) OVER (PARTITION BY sr_store_sk) AS store_avg_return FROM prefiltered_returns GROUP BY sr_customer_sk, sr_store_sk), filtered_customers AS (SELECT ctr_customer_sk FROM window_aggregates WHERE ctr_total_return > store_avg_return * 1.2), customer_lookup AS (SELECT c_customer_id FROM filtered_customers INNER JOIN customer ON ctr_customer_sk = c_customer_sk) SELECT c_customer_id FROM customer_lookup ORDER BY c_customer_id LIMIT 100