{
  "worker_id": 3,
  "strategy": "late_attribute_binding",
  "examples_used": [
    "dimension_cte_isolate",
    "early_filter"
  ],
  "optimized_sql": "WITH customer_total_return_filtered AS (SELECT\n  sr_customer_sk AS ctr_customer_sk,\n  sr_store_sk AS ctr_store_sk,\n  SUM(SR_FEE) AS ctr_total_return\nFROM store_returns\nINNER JOIN date_dim ON sr_returned_date_sk = d_date_sk\nINNER JOIN store ON sr_store_sk = s_store_sk\nWHERE d_year = 2000\n  AND s_state = 'SD'\nGROUP BY sr_customer_sk, sr_store_sk),\nstore_averages AS (SELECT\n  ctr_store_sk,\n  AVG(ctr_total_return) AS store_avg_return\nFROM customer_total_return_filtered\nGROUP BY ctr_store_sk),\nfiltered_ids AS (SELECT\n  ctr1.ctr_customer_sk\nFROM customer_total_return_filtered AS ctr1\nINNER JOIN store_averages ON ctr1.ctr_store_sk = store_averages.ctr_store_sk\nWHERE ctr1.ctr_total_return > store_averages.store_avg_return * 1.2),\ncustomer_lookup AS (SELECT\n  c_customer_id\nFROM filtered_ids\nINNER JOIN customer ON filtered_ids.ctr_customer_sk = c_customer_sk)\nSELECT\n  c_customer_id\nFROM customer_lookup\nORDER BY c_customer_id ASC\nLIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- dimension_cte_isolate: Pre-filter store and date dimensions, but combine them ",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}