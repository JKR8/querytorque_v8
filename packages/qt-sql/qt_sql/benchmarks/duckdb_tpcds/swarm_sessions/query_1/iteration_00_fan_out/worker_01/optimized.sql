WITH store_sd AS (SELECT s_store_sk FROM store WHERE s_state = 'SD'), date_2000 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), prefiltered_returns AS (SELECT sr_customer_sk, sr_store_sk, sr_fee FROM store_returns JOIN date_2000 ON sr_returned_date_sk = date_2000.d_date_sk JOIN store_sd ON sr_store_sk = store_sd.s_store_sk), customer_store_totals AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, SUM(sr_fee) AS ctr_total_return FROM prefiltered_returns GROUP BY sr_customer_sk, sr_store_sk), store_averages AS (SELECT ctr_store_sk, AVG(ctr_total_return) AS store_avg_return FROM customer_store_totals GROUP BY ctr_store_sk), filtered_totals AS (SELECT ctr_customer_sk, ctr_store_sk FROM customer_store_totals AS ctr1 JOIN store_averages ON ctr1.ctr_store_sk = store_averages.ctr_store_sk WHERE ctr1.ctr_total_return > store_averages.store_avg_return * 1.2), customer_join AS (SELECT c_customer_id FROM filtered_totals JOIN customer ON ctr_customer_sk = c_customer_sk) SELECT c_customer_id FROM customer_join ORDER BY c_customer_id ASC LIMIT 100