{
  "worker_id": 2,
  "strategy": "shared_dimension_multi_channel",
  "examples_used": [
    "shared_dimension_multi_channel",
    "single_pass_aggregation",
    "channel_bitmap_aggregation"
  ],
  "optimized_sql": "WITH filtered_item AS (SELECT i_item_sk, i_item_id FROM item WHERE i_color IN ('powder','green','cyan')), filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 2), filtered_customer AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -6), all_sales AS (SELECT ss_item_sk AS item_sk, ss_sold_date_sk AS date_sk, ss_addr_sk AS addr_sk, ss_ext_sales_price AS sales_price FROM store_sales UNION ALL SELECT cs_item_sk, cs_sold_date_sk, cs_bill_addr_sk, cs_ext_sales_price FROM catalog_sales UNION ALL SELECT ws_item_sk, ws_sold_date_sk, ws_bill_addr_sk, ws_ext_sales_price FROM web_sales), joined_sales AS (SELECT fi.i_item_id, als.sales_price FROM all_sales als INNER JOIN filtered_item fi ON als.item_sk = fi.i_item_sk INNER JOIN filtered_date fd ON als.date_sk = fd.d_date_sk INNER JOIN filtered_customer fc ON als.addr_sk = fc.ca_address_sk), item_aggregate AS (SELECT i_item_id, SUM(sales_price) AS total_sales FROM joined_sales GROUP BY i_item_id) SELECT i_item_id, total_sales FROM item_aggregate ORDER BY total_sales ASC, i_item_id ASC LIMIT 100",
  "speedup": 0.0,
  "status": "FAIL",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- shared_dimension_multi_channel: Apply the idea of extracting shared dimension ",
  "error_message": "INTERFACE: [all_sales] declares outputs ['addr_sk', 'date_sk', 'item_sk', 'sales_price'] but SELECT only produces ['ws_bill_addr_sk', 'ws_ext_sales_price', 'ws_item_sk', 'ws_sold_date_sk'] | INTERFACE: [all_sales] SELECT produces ['ws_bill_addr_sk', 'ws_ext_sales_price', 'ws_item_sk', 'ws_sold_date_sk'] not declared in outputs | Value mismatch: rows differ between original and optimized",
  "error_messages": [
    "INTERFACE: [all_sales] declares outputs ['addr_sk', 'date_sk', 'item_sk', 'sales_price'] but SELECT only produces ['ws_bill_addr_sk', 'ws_ext_sales_price', 'ws_item_sk', 'ws_sold_date_sk']",
    "INTERFACE: [all_sales] SELECT produces ['ws_bill_addr_sk', 'ws_ext_sales_price', 'ws_item_sk', 'ws_sold_date_sk'] not declared in outputs",
    "Value mismatch: rows differ between original and optimized"
  ],
  "error_category": "semantic"
}