{
  "worker_id": 1,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "date_cte_isolate",
    "prefetch_fact_join",
    "dimension_cte_isolate"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 2), filtered_customer AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -6), filtered_item AS (SELECT i_item_sk, i_item_id FROM item WHERE i_color IN ('powder', 'green', 'cyan')), ss_joined AS (SELECT filtered_item.i_item_id, store_sales.ss_ext_sales_price FROM store_sales INNER JOIN filtered_date ON store_sales.ss_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_customer ON store_sales.ss_addr_sk = filtered_customer.ca_address_sk INNER JOIN filtered_item ON store_sales.ss_item_sk = filtered_item.i_item_sk), ss_agg AS (SELECT i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM ss_joined GROUP BY i_item_id), cs_joined AS (SELECT filtered_item.i_item_id, catalog_sales.cs_ext_sales_price FROM catalog_sales INNER JOIN filtered_date ON catalog_sales.cs_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_customer ON catalog_sales.cs_bill_addr_sk = filtered_customer.ca_address_sk INNER JOIN filtered_item ON catalog_sales.cs_item_sk = filtered_item.i_item_sk), cs_agg AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM cs_joined GROUP BY i_item_id), ws_joined AS (SELECT filtered_item.i_item_id, web_sales.ws_ext_sales_price FROM web_sales INNER JOIN filtered_date ON web_sales.ws_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_customer ON web_sales.ws_bill_addr_sk = filtered_customer.ca_address_sk INNER JOIN filtered_item ON web_sales.ws_item_sk = filtered_item.i_item_sk), ws_agg AS (SELECT i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM ws_joined GROUP BY i_item_id), union_all AS (SELECT i_item_id, total_sales FROM ss_agg UNION ALL SELECT i_item_id, total_sales FROM cs_agg UNION ALL SELECT i_item_id, total_sales FROM ws_agg) SELECT i_item_id, SUM(total_sales) AS total_sales FROM union_all GROUP BY i_item_id ORDER BY total_sales ASC, i_item_id ASC LIMIT 100",
  "speedup": 0.0,
  "status": "FAIL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- date_cte_isolate: Apply the pattern of extracting date filter into a CTE; igno",
  "error_message": "Value mismatch: rows differ between original and optimized",
  "error_messages": [
    "Value mismatch: rows differ between original and optimized"
  ],
  "error_category": "semantic"
}