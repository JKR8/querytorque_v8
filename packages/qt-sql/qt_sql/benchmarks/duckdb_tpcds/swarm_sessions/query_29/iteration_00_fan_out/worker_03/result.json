{
  "worker_id": 3,
  "strategy": "dimension_cte_isolate",
  "examples_used": [
    "dimension_cte_isolate"
  ],
  "optimized_sql": "WITH d1_cte AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 1999), d2_cte AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 7 AND d_year = 1999), d3_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001)), store_cte AS (SELECT s_store_sk, s_store_id, s_store_name FROM store WHERE s_store_sk <= 100), item_cte AS (SELECT i_item_sk, i_item_id, i_item_desc FROM item), fact_join_all AS (SELECT item_cte.i_item_id, item_cte.i_item_desc, store_cte.s_store_id, store_cte.s_store_name, ss_quantity, sr_return_quantity, cs_quantity FROM store_sales JOIN d1_cte ON store_sales.ss_sold_date_sk = d1_cte.d_date_sk JOIN store_cte ON store_sales.ss_store_sk = store_cte.s_store_sk JOIN item_cte ON store_sales.ss_item_sk = item_cte.i_item_sk JOIN store_returns ON store_sales.ss_customer_sk = store_returns.sr_customer_sk AND store_sales.ss_item_sk = store_returns.sr_item_sk AND store_sales.ss_ticket_number = store_returns.sr_ticket_number JOIN d2_cte ON store_returns.sr_returned_date_sk = d2_cte.d_date_sk JOIN catalog_sales ON store_returns.sr_customer_sk = catalog_sales.cs_bill_customer_sk AND store_returns.sr_item_sk = catalog_sales.cs_item_sk JOIN d3_cte ON catalog_sales.cs_sold_date_sk = d3_cte.d_date_sk), aggregate AS (SELECT i_item_id, i_item_desc, s_store_id, s_store_name, AVG(ss_quantity) AS store_sales_quantity, AVG(sr_return_quantity) AS store_returns_quantity, AVG(cs_quantity) AS catalog_sales_quantity FROM fact_join_all GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name) SELECT i_item_id, i_item_desc, s_store_id, s_store_name, store_sales_quantity, store_returns_quantity, catalog_sales_quantity FROM aggregate ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "Apply the pattern of pre-filtering ALL dimension tables (date_dim for d1/d2/d3, ",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}