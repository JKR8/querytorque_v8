{
  "worker_id": 1,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "multi_dimension_prefetch",
    "prefetch_fact_join",
    "dimension_cte_isolate"
  ],
  "optimized_sql": "WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), store_cte AS (SELECT s_store_sk, s_state FROM store WHERE s_state IN ('MO','AL','MI','TN','LA','SC')), customer_demographics_cte AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'D' AND cd_education_status = 'Secondary'), item_cte AS (SELECT i_item_sk, i_item_id FROM item), fact_filtered AS (SELECT ss.ss_item_sk, ss.ss_quantity, ss.ss_list_price, ss.ss_coupon_amt, ss.ss_sales_price, st.s_state FROM store_sales ss INNER JOIN date_cte dt ON ss.ss_sold_date_sk = dt.d_date_sk INNER JOIN store_cte st ON ss.ss_store_sk = st.s_store_sk INNER JOIN customer_demographics_cte cd ON ss.ss_cdemo_sk = cd.cd_demo_sk), join_all AS (SELECT it.i_item_id, ff.s_state, ff.ss_quantity, ff.ss_list_price, ff.ss_coupon_amt, ff.ss_sales_price FROM fact_filtered ff INNER JOIN item_cte it ON ff.ss_item_sk = it.i_item_sk), aggregate_rollup AS (SELECT i_item_id, s_state, GROUPING(s_state) AS g_state, AVG(ss_quantity) AS agg1, AVG(ss_list_price) AS agg2, AVG(ss_coupon_amt) AS agg3, AVG(ss_sales_price) AS agg4 FROM join_all GROUP BY ROLLUP (i_item_id, s_state)) SELECT i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 FROM aggregate_rollup ORDER BY i_item_id, s_state LIMIT 100",
  "speedup": 1.5222663833534233,
  "status": "WIN",
  "transforms": [
    "multi_dimension_prefetch"
  ],
  "hint": "- multi_dimension_prefetch (Q43): Apply the pattern of pre-filtering multiple di",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}