{
  "worker_id": 4,
  "strategy": "single_pass_all_channels",
  "examples_used": [
    "channel_bitmap_aggregation",
    "single_pass_aggregation",
    "union_cte_split"
  ],
  "optimized_sql": "-- start query 77 in stream 0 using template query77.tpl\nwith ss as\n (select s_store_sk,\n         sum(ss_ext_sales_price) as sales,\n         sum(ss_net_profit) as profit\n from store_sales,\n      date_dim,\n      store\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-05' as date) \n                  and (cast('1998-08-05' as date) + INTERVAL 30 DAY) \n       and ss_store_sk = s_store_sk\n group by s_store_sk)\n ,\n sr as\n (select s_store_sk,\n         sum(sr_return_amt) as \"returns\",\n         sum(sr_net_loss) as profit_loss\n from store_returns,\n      date_dim,\n      store\n where sr_returned_date_sk = d_date_sk\n       and d_date between cast('1998-08-05' as date)\n                  and (cast('1998-08-05' as date) + INTERVAL 30 DAY)\n       and sr_store_sk = s_store_sk\n group by s_store_sk), \n cs as\n (select cs_call_center_sk,\n        sum(cs_ext_sales_price) as sales,\n        sum(cs_net_profit) as profit\n from catalog_sales,\n      date_dim\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-05' as date)\n                  and (cast('1998-08-05' as date) + INTERVAL 30 DAY)\n group by cs_call_center_sk \n ), \n cr as\n (select cr_call_center_sk,\n         sum(cr_return_amount) as \"returns\",\n         sum(cr_net_loss) as profit_loss\n from catalog_returns,\n      date_dim\n where cr_returned_date_sk = d_date_sk\n       and d_date between cast('1998-08-05' as date)\n                  and (cast('1998-08-05' as date) + INTERVAL 30 DAY)\n group by cr_call_center_sk\n ), \n ws as\n ( select wp_web_page_sk,\n        sum(ws_ext_sales_price) as sales,\n        sum(ws_net_profit) as profit\n from web_sales,\n      date_dim,\n      web_page\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-05' as date)\n                  and (cast('1998-08-05' as date) + INTERVAL 30 DAY)\n       and ws_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk), \n wr as\n (select wp_web_page_sk,\n        sum(wr_return_amt) as \"returns\",\n        sum(wr_net_loss) as profit_loss\n from web_returns,\n      date_dim,\n      web_page\n where wr_returned_date_sk = d_date_sk\n       and d_date between cast('1998-08-05' as date)\n                  and (cast('1998-08-05' as date) + INTERVAL 30 DAY)\n       and wr_web_page_sk = wp_web_page_sk\n group by wp_web_page_sk)\n  select channel\n        , id\n        , sum(sales) as sales\n        , sum(\"returns\") as \"returns\"\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , ss.s_store_sk as id\n        , sales\n        , coalesce(\"returns\", 0) as \"returns\"\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ss left join sr\n        on  ss.s_store_sk = sr.s_store_sk\n union all\n select 'catalog channel' as channel\n        , cs_call_center_sk as id\n        , sales\n        , \"returns\"\n        , (profit - profit_loss) as profit\n from  cs\n       , cr\n union all\n select 'web channel' as channel\n        , ws.wp_web_page_sk as id\n        , sales\n        , coalesce(\"returns\", 0) AS \"returns\"\n        , (profit - coalesce(profit_loss,0)) as profit\n from   ws left join wr\n        on  ws.wp_web_page_sk = wr.wp_web_page_sk\n ) x\n group by rollup (channel, id)\n order by channel\n         ,id\n LIMIT 100;\n\n-- end query 77 in stream 0 using template query77.tpl",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [],
  "hint": "- channel_bitmap_aggregation: Apply the idea of labeling rows by channel and typ",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}