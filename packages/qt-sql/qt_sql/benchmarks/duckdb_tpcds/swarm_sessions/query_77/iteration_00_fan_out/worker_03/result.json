{
  "worker_id": 3,
  "strategy": "prefetch_fact_join",
  "examples_used": [
    "prefetch_fact_join",
    "multi_dimension_prefetch",
    "pushdown"
  ],
  "optimized_sql": "WITH date_range AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('1998-08-05' AS DATE) AND (CAST('1998-08-05' AS DATE) + INTERVAL 30 DAY)), store_sales_pre AS (SELECT ss_store_sk, ss_ext_sales_price, ss_net_profit FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk), store_returns_pre AS (SELECT sr_store_sk, sr_return_amt, sr_net_loss FROM store_returns JOIN date_range ON sr_returned_date_sk = d_date_sk), cs_pre AS (SELECT cs_call_center_sk, cs_ext_sales_price, cs_net_profit FROM catalog_sales JOIN date_range ON cs_sold_date_sk = d_date_sk), cr_pre AS (SELECT cr_call_center_sk, cr_return_amount, cr_net_loss FROM catalog_returns JOIN date_range ON cr_returned_date_sk = d_date_sk), ws_pre AS (SELECT ws_web_page_sk, ws_ext_sales_price, ws_net_profit FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk), wr_pre AS (SELECT wr_web_page_sk, wr_return_amt, wr_net_loss FROM web_returns JOIN date_range ON wr_returned_date_sk = d_date_sk), ss_agg AS (SELECT store.s_store_sk, SUM(ss_ext_sales_price) AS sales, SUM(ss_net_profit) AS profit FROM store_sales_pre JOIN store ON ss_store_sk = store.s_store_sk WHERE store.s_store_sk <= 100 GROUP BY store.s_store_sk), sr_agg AS (SELECT store.s_store_sk, SUM(sr_return_amt) AS \"returns\", SUM(sr_net_loss) AS profit_loss FROM store_returns_pre JOIN store ON sr_store_sk = store.s_store_sk WHERE store.s_store_sk <= 100 GROUP BY store.s_store_sk), cs_agg AS (SELECT cs_call_center_sk, SUM(cs_ext_sales_price) AS sales, SUM(cs_net_profit) AS profit FROM cs_pre GROUP BY cs_call_center_sk), cr_agg AS (SELECT cr_call_center_sk, SUM(cr_return_amount) AS \"returns\", SUM(cr_net_loss) AS profit_loss FROM cr_pre GROUP BY cr_call_center_sk), ws_agg AS (SELECT wp_web_page_sk, SUM(ws_ext_sales_price) AS sales, SUM(ws_net_profit) AS profit FROM ws_pre JOIN web_page ON ws_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk), wr_agg AS (SELECT wp_web_page_sk, SUM(wr_return_amt) AS \"returns\", SUM(wr_net_loss) AS profit_loss FROM wr_pre JOIN web_page ON wr_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk) SELECT channel, id, SUM(sales) AS sales, SUM(\"returns\") AS \"returns\", SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, ss_agg.s_store_sk AS id, sales, COALESCE(\"returns\", 0) AS \"returns\", (profit - COALESCE(profit_loss, 0)) AS profit FROM ss_agg LEFT JOIN sr_agg ON ss_agg.s_store_sk = sr_agg.s_store_sk UNION ALL SELECT 'catalog channel' AS channel, cs_call_center_sk AS id, sales, \"returns\", (profit - profit_loss) AS profit FROM cs_agg CROSS JOIN cr_agg UNION ALL SELECT 'web channel' AS channel, ws_agg.wp_web_page_sk AS id, sales, COALESCE(\"returns\", 0) AS \"returns\", (profit - COALESCE(profit_loss, 0)) AS profit FROM ws_agg LEFT JOIN wr_agg ON ws_agg.wp_web_page_sk = wr_agg.wp_web_page_sk) x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "prefetch_fact_join"
  ],
  "hint": "- prefetch_fact_join: Apply staged CTE chain: filter date, then join with fact t",
  "error_message": "INTERFACE: [store_sales_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk'] | INTERFACE: [store_returns_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk'] | INTERFACE: [cs_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk'] | INTERFACE: [cr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk'] | INTERFACE: [ws_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk'] | INTERFACE: [wr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk']",
  "error_messages": [
    "INTERFACE: [store_sales_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [store_returns_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [cs_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [cr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [ws_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk']",
    "INTERFACE: [wr_pre] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [date_range]? [date_range] only provides ['d_date', 'd_date_sk']"
  ],
  "error_category": null
}