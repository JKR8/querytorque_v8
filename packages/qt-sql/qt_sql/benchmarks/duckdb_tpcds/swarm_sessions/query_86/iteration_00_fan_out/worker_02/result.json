{
  "worker_id": 2,
  "strategy": "dimension_cte_isolate",
  "examples_used": [
    "dimension_cte_isolate",
    "multi_dimension_prefetch",
    "early_filter"
  ],
  "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1224 AND 1224 + 11), filtered_items AS (SELECT i_item_sk, i_category, i_class FROM item WHERE 1=1), fact_with_dates AS (SELECT ws_item_sk, ws_net_paid FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk), joined_all AS (SELECT i_category, i_class, ws_net_paid FROM fact_with_dates JOIN filtered_items ON ws_item_sk = i_item_sk), rollup_agg AS (SELECT i_category, i_class, SUM(ws_net_paid) AS total_sum, GROUPING(i_category) AS gcat, GROUPING(i_class) AS gcls FROM joined_all GROUP BY ROLLUP(i_category, i_class)), final_window AS (SELECT total_sum, i_category, i_class, (gcat + gcls) AS lochierarchy, RANK() OVER (PARTITION BY (gcat + gcls), CASE WHEN gcls = 0 THEN i_category END ORDER BY total_sum DESC) AS rank_within_parent FROM rollup_agg), top_n AS (SELECT total_sum, i_category, i_class, lochierarchy, rank_within_parent FROM final_window ORDER BY lochierarchy DESC, CASE WHEN lochierarchy = 0 THEN i_category END, rank_within_parent LIMIT 100) SELECT total_sum, i_category, i_class, lochierarchy, rank_within_parent FROM top_n",
  "speedup": 1.1571023753638534,
  "status": "WIN",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- dimension_cte_isolate: Apply pre-filtering of both date_dim and item into CTEs",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}