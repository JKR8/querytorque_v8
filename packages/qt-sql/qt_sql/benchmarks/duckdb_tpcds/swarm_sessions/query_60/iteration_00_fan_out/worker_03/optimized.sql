WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 8), filtered_item AS (SELECT i_item_id, i_item_sk FROM item WHERE i_category = 'Children'), filtered_ca AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7), prefetched_sales AS (SELECT ss_item_sk AS item_sk, ss_sold_date_sk AS date_sk, ss_addr_sk AS addr_sk, ss_ext_sales_price AS sales_price FROM store_sales WHERE ss_item_sk IN (SELECT i_item_sk FROM filtered_item) AND ss_sold_date_sk IN (SELECT d_date_sk FROM filtered_date) AND ss_addr_sk IN (SELECT ca_address_sk FROM filtered_ca) UNION ALL SELECT cs_item_sk, cs_sold_date_sk, cs_bill_addr_sk, cs_ext_sales_price FROM catalog_sales WHERE cs_item_sk IN (SELECT i_item_sk FROM filtered_item) AND cs_sold_date_sk IN (SELECT d_date_sk FROM filtered_date) AND cs_bill_addr_sk IN (SELECT ca_address_sk FROM filtered_ca) UNION ALL SELECT ws_item_sk, ws_sold_date_sk, ws_bill_addr_sk, ws_ext_sales_price FROM web_sales WHERE ws_item_sk IN (SELECT i_item_sk FROM filtered_item) AND ws_sold_date_sk IN (SELECT d_date_sk FROM filtered_date) AND ws_bill_addr_sk IN (SELECT ca_address_sk FROM filtered_ca)), main_aggregation AS (SELECT i.i_item_id, SUM(ps.sales_price) AS total_sales FROM prefetched_sales ps JOIN filtered_item i ON ps.item_sk = i.i_item_sk JOIN filtered_date d ON ps.date_sk = d.d_date_sk JOIN filtered_ca ca ON ps.addr_sk = ca.ca_address_sk GROUP BY i.i_item_id ORDER BY i.i_item_id ASC, total_sales ASC LIMIT 100) SELECT i_item_id, total_sales FROM main_aggregation