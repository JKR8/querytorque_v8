WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 8), filtered_item AS (SELECT i_item_id, i_item_sk FROM item WHERE i_category = 'Children'), filtered_ca AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7), ss AS (SELECT filtered_item.i_item_id, ss_ext_sales_price AS total_sales FROM store_sales JOIN filtered_date ON store_sales.ss_sold_date_sk = filtered_date.d_date_sk JOIN filtered_ca ON store_sales.ss_addr_sk = filtered_ca.ca_address_sk JOIN filtered_item ON store_sales.ss_item_sk = filtered_item.i_item_sk), cs AS (SELECT filtered_item.i_item_id, cs_ext_sales_price AS total_sales FROM catalog_sales JOIN filtered_date ON catalog_sales.cs_sold_date_sk = filtered_date.d_date_sk JOIN filtered_ca ON catalog_sales.cs_bill_addr_sk = filtered_ca.ca_address_sk JOIN filtered_item ON catalog_sales.cs_item_sk = filtered_item.i_item_sk), ws AS (SELECT filtered_item.i_item_id, ws_ext_sales_price AS total_sales FROM web_sales JOIN filtered_date ON web_sales.ws_sold_date_sk = filtered_date.d_date_sk JOIN filtered_ca ON web_sales.ws_bill_addr_sk = filtered_ca.ca_address_sk JOIN filtered_item ON web_sales.ws_item_sk = filtered_item.i_item_sk), union_all AS (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws), main_aggregation AS (SELECT i_item_id, SUM(total_sales) AS total_sales FROM union_all GROUP BY i_item_id ORDER BY i_item_id ASC, total_sales ASC LIMIT 100) SELECT i_item_id, total_sales FROM main_aggregation