{
  "worker_id": 2,
  "strategy": "single_pass_aggregation_via_union_rewrite",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation",
    "pushdown"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 8), filtered_item AS (SELECT i_item_id, i_item_sk FROM item WHERE i_category = 'Children'), filtered_ca AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7), all_sales_raw AS (SELECT ss_item_sk AS item_sk, ss_sold_date_sk AS date_sk, ss_addr_sk AS addr_sk, ss_ext_sales_price AS sales_price FROM store_sales UNION ALL SELECT cs_item_sk, cs_sold_date_sk, cs_bill_addr_sk, cs_ext_sales_price FROM catalog_sales UNION ALL SELECT ws_item_sk, ws_sold_date_sk, ws_bill_addr_sk, ws_ext_sales_price FROM web_sales), joined_sales AS (SELECT fi.i_item_id, asr.sales_price FROM all_sales_raw asr JOIN filtered_date fd ON asr.date_sk = fd.d_date_sk JOIN filtered_ca fc ON asr.addr_sk = fc.ca_address_sk JOIN filtered_item fi ON asr.item_sk = fi.i_item_sk), main_aggregation AS (SELECT i_item_id, SUM(sales_price) AS total_sales FROM joined_sales GROUP BY i_item_id ORDER BY i_item_id ASC, total_sales ASC LIMIT 100) SELECT i_item_id, total_sales FROM main_aggregation",
  "speedup": 0.0,
  "status": "FAIL",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation: Consolidate the three channel scans into a single UNI",
  "error_message": "INTERFACE: [all_sales_raw] declares outputs ['addr_sk', 'date_sk', 'item_sk', 'sales_price'] but SELECT only produces ['ws_bill_addr_sk', 'ws_ext_sales_price', 'ws_item_sk', 'ws_sold_date_sk'] | INTERFACE: [all_sales_raw] SELECT produces ['ws_bill_addr_sk', 'ws_ext_sales_price', 'ws_item_sk', 'ws_sold_date_sk'] not declared in outputs | Value mismatch: rows differ between original and optimized",
  "error_messages": [
    "INTERFACE: [all_sales_raw] declares outputs ['addr_sk', 'date_sk', 'item_sk', 'sales_price'] but SELECT only produces ['ws_bill_addr_sk', 'ws_ext_sales_price', 'ws_item_sk', 'ws_sold_date_sk']",
    "INTERFACE: [all_sales_raw] SELECT produces ['ws_bill_addr_sk', 'ws_ext_sales_price', 'ws_item_sk', 'ws_sold_date_sk'] not declared in outputs",
    "Value mismatch: rows differ between original and optimized"
  ],
  "error_category": "semantic"
}