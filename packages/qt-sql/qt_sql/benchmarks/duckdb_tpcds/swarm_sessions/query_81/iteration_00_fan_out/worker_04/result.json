{
  "worker_id": 4,
  "strategy": "early_ca_filter_derived",
  "examples_used": [
    "early_filter",
    "window_optimization",
    "prefetch_fact_join"
  ],
  "optimized_sql": "WITH ca_customers AS (SELECT c_customer_sk, c_customer_id, c_salutation, c_first_name, c_last_name, ca_address_sk, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type FROM customer INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE ca_state = 'CA'), customer_total_return_all AS (SELECT cr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, SUM(cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns INNER JOIN date_dim ON cr_returned_date_sk = d_date_sk INNER JOIN customer_address ON cr_returning_addr_sk = ca_address_sk WHERE d_year = 2002 GROUP BY cr_returning_customer_sk, ca_state), state_averages AS (SELECT ctr_state, AVG(ctr_total_return) AS state_avg FROM customer_total_return_all GROUP BY ctr_state), ctr_joined AS (SELECT cc.c_customer_sk, cc.c_customer_id, cc.c_salutation, cc.c_first_name, cc.c_last_name, cc.ca_street_number, cc.ca_street_name, cc.ca_street_type, cc.ca_suite_number, cc.ca_city, cc.ca_county, cc.ca_state, cc.ca_zip, cc.ca_country, cc.ca_gmt_offset, cc.ca_location_type, ctra.ctr_total_return, sa.state_avg, ctra.ctr_state FROM ca_customers cc INNER JOIN customer_total_return_all ctra ON cc.c_customer_sk = ctra.ctr_customer_sk INNER JOIN state_averages sa ON ctra.ctr_state = sa.ctr_state) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return FROM ctr_joined WHERE ctr_total_return > state_avg * 1.2 ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "early_filter"
  ],
  "hint": "- early_filter: Filter customer and customer_address for CA first, then join to ",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}