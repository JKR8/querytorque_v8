{
  "worker_id": 2,
  "strategy": "single_pass_multi_channel_aggregation",
  "examples_used": [
    "channel_bitmap_aggregation",
    "single_pass_aggregation",
    "union_consolidation"
  ],
  "optimized_sql": "WITH date_week_cte AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2001-03-24')), all_sales_union_cte AS (SELECT i.i_item_id, sales.channel, sales.sales_price FROM (SELECT ss_item_sk AS item_sk, ss_sold_date_sk AS date_sk, ss_ext_sales_price AS sales_price, 'store' AS channel FROM store_sales UNION ALL SELECT cs_item_sk, cs_sold_date_sk, cs_ext_sales_price, 'catalog' FROM catalog_sales UNION ALL SELECT ws_item_sk, ws_sold_date_sk, ws_ext_sales_price, 'web' FROM web_sales) sales JOIN date_week_cte d ON sales.date_sk = d.d_date_sk JOIN item i ON sales.item_sk = i.i_item_sk), channel_pivot_cte AS (SELECT i_item_id AS item_id, SUM(CASE WHEN channel = 'store' THEN sales_price END) AS ss_item_rev, SUM(CASE WHEN channel = 'catalog' THEN sales_price END) AS cs_item_rev, SUM(CASE WHEN channel = 'web' THEN sales_price END) AS ws_item_rev FROM all_sales_union_cte GROUP BY i_item_id) SELECT item_id, ss_item_rev, CASE WHEN ((ss_item_rev+cs_item_rev+ws_item_rev)/3) <> 0 THEN ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3)*100 END AS ss_dev, cs_item_rev, CASE WHEN ((ss_item_rev+cs_item_rev+ws_item_rev)/3) <> 0 THEN cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3)*100 END AS cs_dev, ws_item_rev, CASE WHEN ((ss_item_rev+cs_item_rev+ws_item_rev)/3) <> 0 THEN ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3)*100 END AS ws_dev, (ss_item_rev+cs_item_rev+ws_item_rev)/3 AS average FROM channel_pivot_cte WHERE ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, ss_item_rev LIMIT 100",
  "speedup": 0.776528062740569,
  "status": "REGRESSION",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- channel_bitmap_aggregation: Apply consolidating multiple fact scans into singl",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}