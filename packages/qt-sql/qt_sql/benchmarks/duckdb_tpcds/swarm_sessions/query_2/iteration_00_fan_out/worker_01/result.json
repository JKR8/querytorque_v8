{
  "worker_id": 1,
  "strategy": "union_cte_split",
  "examples_used": [
    "union_cte_split",
    "pushdown",
    "date_cte_isolate"
  ],
  "optimized_sql": "-- start query 2 in stream 0 using template query2.tpl\nwith wscs as\n (select sold_date_sk\n        ,sales_price\n  from (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales \n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 1998) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 1998+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1;\n\n-- end query 2 in stream 0 using template query2.tpl",
  "speedup": 1.0000995960733534,
  "status": "NEUTRAL",
  "transforms": [],
  "hint": "- union_cte_split (Q74): Apply splitting of wswscs into year-specific CTEs; igno",
  "error_message": "INTERFACE: [main_query] declares outputs ['round(y.fri_sales / z.fri_sales, 2)', 'round(y.mon_sales / z.mon_sales, 2)', 'round(y.sat_sales / z.sat_sales, 2)', 'round(y.sun_sales / z.sun_sales, 2)', 'round(y.thu_sales / z.thu_sales, 2)', 'round(y.tue_sales / z.tue_sales, 2)', 'round(y.wed_sales / z.wed_sales, 2)'] but SELECT only produces ['d_week_seq1']",
  "error_messages": [
    "INTERFACE: [main_query] declares outputs ['round(y.fri_sales / z.fri_sales, 2)', 'round(y.mon_sales / z.mon_sales, 2)', 'round(y.sat_sales / z.sat_sales, 2)', 'round(y.sun_sales / z.sun_sales, 2)', 'round(y.thu_sales / z.thu_sales, 2)', 'round(y.tue_sales / z.tue_sales, 2)', 'round(y.wed_sales / z.wed_sales, 2)'] but SELECT only produces ['d_week_seq1']"
  ],
  "error_category": null
}