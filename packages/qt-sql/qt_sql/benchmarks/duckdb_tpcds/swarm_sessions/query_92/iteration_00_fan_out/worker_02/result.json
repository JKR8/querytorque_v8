{
  "worker_id": 2,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation"
  ],
  "optimized_sql": "WITH filtered_item AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_manufact_id = 320), filtered_date AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN '2002-02-26' AND (CAST('2002-02-26' AS DATE) + INTERVAL 90 DAY)), web_sales_enriched AS (SELECT ws.ws_ext_discount_amt, ws.ws_item_sk, AVG(ws.ws_ext_discount_amt) OVER (PARTITION BY ws.ws_item_sk) AS avg_disc FROM web_sales ws INNER JOIN filtered_date fd ON fd.d_date_sk = ws.ws_sold_date_sk INNER JOIN filtered_item fi ON fi.i_item_sk = ws.ws_item_sk), filtered_rows AS (SELECT ws_ext_discount_amt FROM web_sales_enriched WHERE ws_ext_discount_amt > 1.3 * avg_disc), agg AS (SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM filtered_rows), top_n AS (SELECT \"Excess Discount Amount\" FROM agg ORDER BY \"Excess Discount Amount\" ASC LIMIT 100) SELECT \"Excess Discount Amount\" FROM top_n",
  "speedup": 1.3191474513783898,
  "status": "WIN",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation: Consolidate the two web_sales scans into one by compu",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}