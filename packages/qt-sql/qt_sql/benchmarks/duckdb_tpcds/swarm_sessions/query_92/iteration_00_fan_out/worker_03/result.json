{
  "worker_id": 3,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "prefetch_fact_join",
    "dimension_cte_isolate",
    "multi_dimension_prefetch"
  ],
  "optimized_sql": "WITH filtered_item AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_manufact_id = 320), filtered_date AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN '2002-02-26' AND (CAST('2002-02-26' AS DATE) + INTERVAL 90 DAY)), web_sales_filtered AS (SELECT ws_ext_discount_amt, ws_item_sk, ws_sold_date_sk FROM web_sales INNER JOIN filtered_date ON d_date_sk = ws_sold_date_sk INNER JOIN filtered_item ON i_item_sk = ws_item_sk), item_avg_discount AS (SELECT ws_item_sk, avg(ws_ext_discount_amt) AS avg_disc FROM web_sales_filtered GROUP BY ws_item_sk), main_join AS (SELECT ws_ext_discount_amt FROM web_sales_filtered INNER JOIN item_avg_discount ON web_sales_filtered.ws_item_sk = item_avg_discount.ws_item_sk WHERE ws_ext_discount_amt > 1.3 * avg_disc), filter_agg AS (SELECT sum(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM main_join), top_n AS (SELECT \"Excess Discount Amount\" FROM filter_agg ORDER BY \"Excess Discount Amount\" ASC LIMIT 100) SELECT \"Excess Discount Amount\" FROM top_n",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- prefetch_fact_join: Pre-join filtered dimensions with fact table (web_sales_fi",
  "error_message": "INTERFACE: [web_sales_filtered] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk']",
  "error_messages": [
    "INTERFACE: [web_sales_filtered] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_date]? [filtered_date] only provides ['d_date', 'd_date_sk']"
  ],
  "error_category": null
}