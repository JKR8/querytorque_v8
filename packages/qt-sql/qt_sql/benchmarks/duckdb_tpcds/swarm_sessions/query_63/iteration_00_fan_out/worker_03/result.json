{
  "worker_id": 3,
  "strategy": "multi_dimension_prefetch",
  "examples_used": [
    "multi_dimension_prefetch (Q43)"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_month_seq IN (1181,1182,1183,1184,1185,1186,1187,1188,1189,1190,1191,1192)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_store_sk <= 100), prefetched_sales AS (SELECT ss_item_sk, ss_sales_price, d_moy FROM store_sales INNER JOIN filtered_date ON ss_sold_date_sk = d_date_sk INNER JOIN filtered_store ON ss_store_sk = s_store_sk), join_item AS (SELECT i_manager_id, d_moy, ss_sales_price FROM prefetched_sales INNER JOIN item ON ss_item_sk = i_item_sk WHERE ((i_category IN ('Books','Children','Electronics') AND i_class IN ('personal','portable','reference','self-help') AND i_brand IN ('scholaramalgamalg #14','scholaramalgamalg #7','exportiunivamalg #9','scholaramalgamalg #9')) OR (i_category IN ('Women','Music','Men') AND i_class IN ('accessories','classical','fragrances','pants') AND i_brand IN ('amalgimporto #1','edu packscholar #1','exportiimporto #1','importoamalg #1')))), aggregated_sales AS (SELECT i_manager_id, d_moy, SUM(ss_sales_price) AS sum_sales FROM join_item GROUP BY i_manager_id, d_moy), windowed AS (SELECT i_manager_id, sum_sales, d_moy, AVG(sum_sales) OVER (PARTITION BY i_manager_id) AS avg_monthly_sales FROM aggregated_sales), filtered AS (SELECT i_manager_id, sum_sales, avg_monthly_sales FROM windowed WHERE CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1), ordered AS (SELECT i_manager_id, sum_sales, avg_monthly_sales FROM filtered ORDER BY i_manager_id ASC, avg_monthly_sales ASC, sum_sales ASC), limited AS (SELECT i_manager_id, sum_sales, avg_monthly_sales FROM ordered LIMIT 100) SELECT * FROM limited",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "multi_dimension_prefetch"
  ],
  "hint": "- Apply the multi_dimension_prefetch pattern: create CTEs for filtered date_dim ",
  "error_message": "INTERFACE: [main_query] declares outputs ['avg_monthly_sales', 'i_manager_id', 'sum_sales'] but SELECT only produces ['*'] | INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs",
  "error_messages": [
    "INTERFACE: [main_query] declares outputs ['avg_monthly_sales', 'i_manager_id', 'sum_sales'] but SELECT only produces ['*']",
    "INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs"
  ],
  "error_category": null
}