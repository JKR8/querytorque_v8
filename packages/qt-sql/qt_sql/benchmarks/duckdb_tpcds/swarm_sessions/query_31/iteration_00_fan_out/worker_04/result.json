{
  "worker_id": 4,
  "strategy": "compound_union_split_shared_dims",
  "examples_used": [
    "union_cte_split",
    "shared_dimension_multi_channel",
    "multi_dimension_prefetch"
  ],
  "optimized_sql": "WITH date_filter AS (SELECT d_date_sk, d_qoy, d_year FROM date_dim WHERE d_year = 2000 AND d_qoy IN (1, 2, 3)), addr_all AS (SELECT ca_address_sk, ca_county FROM customer_address), store_q1 AS (SELECT a.ca_county, SUM(ss_ext_sales_price) AS store_sales FROM store_sales s JOIN date_filter d ON s.ss_sold_date_sk = d.d_date_sk JOIN addr_all a ON s.ss_addr_sk = a.ca_address_sk WHERE d.d_qoy = 1 GROUP BY a.ca_county), store_q2 AS (SELECT a.ca_county, SUM(ss_ext_sales_price) AS store_sales FROM store_sales s JOIN date_filter d ON s.ss_sold_date_sk = d.d_date_sk JOIN addr_all a ON s.ss_addr_sk = a.ca_address_sk WHERE d.d_qoy = 2 GROUP BY a.ca_county), store_q3 AS (SELECT a.ca_county, SUM(ss_ext_sales_price) AS store_sales FROM store_sales s JOIN date_filter d ON s.ss_sold_date_sk = d.d_date_sk JOIN addr_all a ON s.ss_addr_sk = a.ca_address_sk WHERE d.d_qoy = 3 GROUP BY a.ca_county), web_q1 AS (SELECT a.ca_county, SUM(ws_ext_sales_price) AS web_sales FROM web_sales w JOIN date_filter d ON w.ws_sold_date_sk = d.d_date_sk JOIN addr_all a ON w.ws_bill_addr_sk = a.ca_address_sk WHERE d.d_qoy = 1 GROUP BY a.ca_county), web_q2 AS (SELECT a.ca_county, SUM(ws_ext_sales_price) AS web_sales FROM web_sales w JOIN date_filter d ON w.ws_sold_date_sk = d.d_date_sk JOIN addr_all a ON w.ws_bill_addr_sk = a.ca_address_sk WHERE d.d_qoy = 2 GROUP BY a.ca_county), web_q3 AS (SELECT a.ca_county, SUM(ws_ext_sales_price) AS web_sales FROM web_sales w JOIN date_filter d ON w.ws_sold_date_sk = d.d_date_sk JOIN addr_all a ON w.ws_bill_addr_sk = a.ca_address_sk WHERE d.d_qoy = 3 GROUP BY a.ca_county) SELECT sq1.ca_county, 2000 AS d_year, (wq2.web_sales / wq1.web_sales) AS web_q1_q2_increase, (sq2.store_sales / sq1.store_sales) AS store_q1_q2_increase, (wq3.web_sales / wq2.web_sales) AS web_q2_q3_increase, (sq3.store_sales / sq2.store_sales) AS store_q2_q3_increase FROM store_q1 sq1 JOIN store_q2 sq2 ON sq1.ca_county = sq2.ca_county JOIN store_q3 sq3 ON sq2.ca_county = sq3.ca_county JOIN web_q1 wq1 ON sq1.ca_county = wq1.ca_county JOIN web_q2 wq2 ON wq1.ca_county = wq2.ca_county JOIN web_q3 wq3 ON wq2.ca_county = wq3.ca_county WHERE (wq2.web_sales / NULLIF(wq1.web_sales, 0)) > (sq2.store_sales / NULLIF(sq1.store_sales, 0)) AND (wq3.web_sales / NULLIF(wq2.web_sales, 0)) > (sq3.store_sales / NULLIF(sq2.store_sales, 0)) ORDER BY web_q1_q2_increase",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "union_cte_split"
  ],
  "hint": "- union_cte_split: Apply splitting by quarter to eliminate generic CTE self-join",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}