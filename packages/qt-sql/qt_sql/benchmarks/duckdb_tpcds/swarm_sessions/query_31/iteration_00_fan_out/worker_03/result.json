{
  "worker_id": 3,
  "strategy": "scan_consolidation_pivot",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation"
  ],
  "optimized_sql": "WITH date_filter AS (SELECT d_date_sk, d_qoy, d_year FROM date_dim WHERE d_year = 2000 AND d_qoy IN (1, 2, 3)), store_pivot AS (SELECT ca.ca_county, SUM(CASE WHEN df.d_qoy = 1 THEN ss.ss_ext_sales_price END) AS store_sales_q1, SUM(CASE WHEN df.d_qoy = 2 THEN ss.ss_ext_sales_price END) AS store_sales_q2, SUM(CASE WHEN df.d_qoy = 3 THEN ss.ss_ext_sales_price END) AS store_sales_q3 FROM store_sales ss JOIN date_filter df ON ss.ss_sold_date_sk = df.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk GROUP BY ca.ca_county), web_pivot AS (SELECT ca.ca_county, SUM(CASE WHEN df.d_qoy = 1 THEN ws.ws_ext_sales_price END) AS web_sales_q1, SUM(CASE WHEN df.d_qoy = 2 THEN ws.ws_ext_sales_price END) AS web_sales_q2, SUM(CASE WHEN df.d_qoy = 3 THEN ws.ws_ext_sales_price END) AS web_sales_q3 FROM web_sales ws JOIN date_filter df ON ws.ws_sold_date_sk = df.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk GROUP BY ca.ca_county) SELECT sp.ca_county, 2000 AS d_year, wp.web_sales_q2 / wp.web_sales_q1 AS web_q1_q2_increase, sp.store_sales_q2 / sp.store_sales_q1 AS store_q1_q2_increase, wp.web_sales_q3 / wp.web_sales_q2 AS web_q2_q3_increase, sp.store_sales_q3 / sp.store_sales_q2 AS store_q2_q3_increase FROM store_pivot sp JOIN web_pivot wp ON sp.ca_county = wp.ca_county WHERE (wp.web_sales_q2 / NULLIF(wp.web_sales_q1, 0)) > (sp.store_sales_q2 / NULLIF(sp.store_sales_q1, 0)) AND (wp.web_sales_q3 / NULLIF(wp.web_sales_q2, 0)) > (sp.store_sales_q3 / NULLIF(sp.store_sales_q2, 0)) ORDER BY web_q1_q2_increase",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation: Apply consolidation of multiple quarter aggregates in",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}