{
  "worker_id": 3,
  "strategy": "dimension_prefetch_shared",
  "examples_used": [
    "dimension_cte_isolate",
    "prefetch_fact_join",
    "early_filter"
  ],
  "optimized_sql": "WITH store_baseline_cte AS (SELECT AVG(ss_net_profit) AS store_avg FROM store_sales WHERE ss_store_sk = 146 AND ss_addr_sk IS NULL GROUP BY ss_store_sk), item_aggregates_cte AS (SELECT ss_item_sk AS item_sk, AVG(ss_net_profit) AS item_avg FROM store_sales WHERE ss_store_sk = 146 GROUP BY ss_item_sk), item_cte AS (SELECT i_item_sk, i_product_name FROM item WHERE i_item_sk IN (SELECT item_sk FROM item_aggregates_cte)), asc_ranked AS (SELECT ia.item_sk, RANK() OVER (ORDER BY ia.item_avg ASC) AS rnk FROM item_aggregates_cte ia CROSS JOIN store_baseline_cte sb WHERE ia.item_avg > 0.9 * sb.store_avg), desc_ranked AS (SELECT ia.item_sk, RANK() OVER (ORDER BY ia.item_avg DESC) AS rnk FROM item_aggregates_cte ia CROSS JOIN store_baseline_cte sb WHERE ia.item_avg > 0.9 * sb.store_avg) SELECT asc_r.rnk AS rnk, i1.i_product_name AS best_performing, i2.i_product_name AS worst_performing FROM asc_ranked asc_r JOIN desc_ranked desc_r ON asc_r.rnk = desc_r.rnk JOIN item_cte i1 ON asc_r.item_sk = i1.i_item_sk JOIN item_cte i2 ON desc_r.item_sk = i2.i_item_sk WHERE asc_r.rnk < 11 AND desc_r.rnk < 11 ORDER BY asc_r.rnk LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- dimension_cte_isolate: Pre-filter item table into CTE to avoid double scan\n- p",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}