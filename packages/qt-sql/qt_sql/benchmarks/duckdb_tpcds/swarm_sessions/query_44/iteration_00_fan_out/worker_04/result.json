{
  "worker_id": 4,
  "strategy": "window_consolidation_self_join_elimination",
  "examples_used": [
    "deferred_window_aggregation",
    "self_join_to_window",
    "union_cte_split"
  ],
  "optimized_sql": "WITH combined_cte AS (SELECT ss_item_sk AS item_sk, AVG(ss_net_profit) AS item_avg, (SELECT AVG(ss_net_profit) FROM store_sales WHERE ss_store_sk = 146 AND ss_addr_sk IS NULL GROUP BY ss_store_sk) AS store_avg FROM store_sales WHERE ss_store_sk = 146 GROUP BY ss_item_sk), ranked_pairs AS (SELECT item_sk, RANK() OVER (ORDER BY item_avg ASC) AS asc_rnk, RANK() OVER (ORDER BY item_avg DESC) AS desc_rnk FROM combined_cte WHERE item_avg > 0.9 * store_avg) SELECT asc.rnk, i1.i_product_name AS best_performing, i2.i_product_name AS worst_performing FROM (SELECT item_sk, asc_rnk AS rnk FROM ranked_pairs WHERE asc_rnk < 11) AS asc JOIN (SELECT item_sk, desc_rnk AS rnk FROM ranked_pairs WHERE desc_rnk < 11) AS desc ON asc.rnk = desc.rnk JOIN item i1 ON asc.item_sk = i1.i_item_sk JOIN item i2 ON desc.item_sk = i2.i_item_sk ORDER BY asc.rnk LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "decorrelate"
  ],
  "hint": "- deferred_window_aggregation: Compute both rankings in single window pass, filt",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}