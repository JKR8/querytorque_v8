WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-01-07' AND (CAST('1999-01-07' AS DATE) + INTERVAL 90 DAY)), filtered_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id = 29), prefetched_sales AS (SELECT cs.cs_item_sk, cs.cs_ext_discount_amt FROM catalog_sales cs INNER JOIN filtered_dates d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN filtered_items i ON cs.cs_item_sk = i.i_item_sk), item_averages AS (SELECT cs_item_sk, AVG(cs_ext_discount_amt) AS item_avg_discount FROM prefetched_sales GROUP BY cs_item_sk) SELECT SUM(ps.cs_ext_discount_amt) AS "excess discount amount" FROM prefetched_sales ps INNER JOIN item_averages ia ON ps.cs_item_sk = ia.cs_item_sk WHERE ps.cs_ext_discount_amt > 1.3 * ia.item_avg_discount LIMIT 100