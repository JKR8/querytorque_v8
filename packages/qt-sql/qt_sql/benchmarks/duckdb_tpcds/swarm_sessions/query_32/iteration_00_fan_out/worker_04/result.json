{
  "worker_id": 4,
  "strategy": "window_function_consolidation",
  "examples_used": [
    "single_pass_aggregation",
    "deferred_window_aggregation",
    "SELF_JOIN_TO_WINDOW"
  ],
  "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-01-07' AND (CAST('1999-01-07' AS DATE) + INTERVAL 90 DAY)), filtered_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id = 29), sales_window_agg AS (SELECT cs.cs_ext_discount_amt, AVG(cs.cs_ext_discount_amt) OVER (PARTITION BY cs.cs_item_sk) AS item_avg_discount FROM catalog_sales cs INNER JOIN filtered_dates d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN filtered_items i ON cs.cs_item_sk = i.i_item_sk), final_filter AS (SELECT SUM(cs_ext_discount_amt) AS \"excess discount amount\" FROM sales_window_agg WHERE cs_ext_discount_amt > 1.3 * item_avg_discount) SELECT \"excess discount amount\" FROM final_filter LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation: Use window function instead of CASE aggregates; ignor",
  "error_message": null,
  "error_messages": [],
  "error_category": null,
  "exploratory": true
}