{
  "worker_id": 1,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation"
  ],
  "optimized_sql": "WITH store_sales_scan AS (SELECT ss_quantity, ss_list_price, ss_coupon_amt, ss_wholesale_cost FROM store_sales WHERE ss_quantity BETWEEN 0 AND 30), conditional_aggregation AS (SELECT AVG(CASE WHEN ss_quantity BETWEEN 0 AND 5 AND (ss_list_price BETWEEN 131 AND 141 OR ss_coupon_amt BETWEEN 16798 AND 17798 OR ss_wholesale_cost BETWEEN 25 AND 45) THEN ss_list_price END) AS B1_LP, COUNT(CASE WHEN ss_quantity BETWEEN 0 AND 5 AND (ss_list_price BETWEEN 131 AND 141 OR ss_coupon_amt BETWEEN 16798 AND 17798 OR ss_wholesale_cost BETWEEN 25 AND 45) THEN ss_list_price END) AS B1_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 0 AND 5 AND (ss_list_price BETWEEN 131 AND 141 OR ss_coupon_amt BETWEEN 16798 AND 17798 OR ss_wholesale_cost BETWEEN 25 AND 45) THEN ss_list_price END) AS B1_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 6 AND 10 AND (ss_list_price BETWEEN 145 AND 155 OR ss_coupon_amt BETWEEN 14792 AND 15792 OR ss_wholesale_cost BETWEEN 46 AND 66) THEN ss_list_price END) AS B2_LP, COUNT(CASE WHEN ss_quantity BETWEEN 6 AND 10 AND (ss_list_price BETWEEN 145 AND 155 OR ss_coupon_amt BETWEEN 14792 AND 15792 OR ss_wholesale_cost BETWEEN 46 AND 66) THEN ss_list_price END) AS B2_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 6 AND 10 AND (ss_list_price BETWEEN 145 AND 155 OR ss_coupon_amt BETWEEN 14792 AND 15792 OR ss_wholesale_cost BETWEEN 46 AND 66) THEN ss_list_price END) AS B2_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 11 AND 15 AND (ss_list_price BETWEEN 150 AND 160 OR ss_coupon_amt BETWEEN 6600 AND 7600 OR ss_wholesale_cost BETWEEN 9 AND 29) THEN ss_list_price END) AS B3_LP, COUNT(CASE WHEN ss_quantity BETWEEN 11 AND 15 AND (ss_list_price BETWEEN 150 AND 160 OR ss_coupon_amt BETWEEN 6600 AND 7600 OR ss_wholesale_cost BETWEEN 9 AND 29) THEN ss_list_price END) AS B3_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 11 AND 15 AND (ss_list_price BETWEEN 150 AND 160 OR ss_coupon_amt BETWEEN 6600 AND 7600 OR ss_wholesale_cost BETWEEN 9 AND 29) THEN ss_list_price END) AS B3_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 16 AND 20 AND (ss_list_price BETWEEN 91 AND 101 OR ss_coupon_amt BETWEEN 13493 AND 14493 OR ss_wholesale_cost BETWEEN 36 AND 56) THEN ss_list_price END) AS B4_LP, COUNT(CASE WHEN ss_quantity BETWEEN 16 AND 20 AND (ss_list_price BETWEEN 91 AND 101 OR ss_coupon_amt BETWEEN 13493 AND 14493 OR ss_wholesale_cost BETWEEN 36 AND 56) THEN ss_list_price END) AS B4_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 16 AND 20 AND (ss_list_price BETWEEN 91 AND 101 OR ss_coupon_amt BETWEEN 13493 AND 14493 OR ss_wholesale_cost BETWEEN 36 AND 56) THEN ss_list_price END) AS B4_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 21 AND 25 AND (ss_list_price BETWEEN 0 AND 10 OR ss_coupon_amt BETWEEN 7629 AND 8629 OR ss_wholesale_cost BETWEEN 6 AND 26) THEN ss_list_price END) AS B5_LP, COUNT(CASE WHEN ss_quantity BETWEEN 21 AND 25 AND (ss_list_price BETWEEN 0 AND 10 OR ss_coupon_amt BETWEEN 7629 AND 8629 OR ss_wholesale_cost BETWEEN 6 AND 26) THEN ss_list_price END) AS B5_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 21 AND 25 AND (ss_list_price BETWEEN 0 AND 10 OR ss_coupon_amt BETWEEN 7629 AND 8629 OR ss_wholesale_cost BETWEEN 6 AND 26) THEN ss_list_price END) AS B5_CNTD, AVG(CASE WHEN ss_quantity BETWEEN 26 AND 30 AND (ss_list_price BETWEEN 89 AND 99 OR ss_coupon_amt BETWEEN 15257 AND 16257 OR ss_wholesale_cost BETWEEN 31 AND 51) THEN ss_list_price END) AS B6_LP, COUNT(CASE WHEN ss_quantity BETWEEN 26 AND 30 AND (ss_list_price BETWEEN 89 AND 99 OR ss_coupon_amt BETWEEN 15257 AND 16257 OR ss_wholesale_cost BETWEEN 31 AND 51) THEN ss_list_price END) AS B6_CNT, COUNT(DISTINCT CASE WHEN ss_quantity BETWEEN 26 AND 30 AND (ss_list_price BETWEEN 89 AND 99 OR ss_coupon_amt BETWEEN 15257 AND 16257 OR ss_wholesale_cost BETWEEN 31 AND 51) THEN ss_list_price END) AS B6_CNTD FROM store_sales_scan) SELECT * FROM conditional_aggregation LIMIT 100",
  "speedup": 0.719577486109506,
  "status": "REGRESSION",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation (Q9): Apply the pattern of merging multiple scalar sub",
  "error_message": "INTERFACE: [main_query] declares outputs ['b1_cnt', 'b1_cntd', 'b1_lp', 'b2_cnt', 'b2_cntd', 'b2_lp', 'b3_cnt', 'b3_cntd', 'b3_lp', 'b4_cnt', 'b4_cntd', 'b4_lp', 'b5_cnt', 'b5_cntd', 'b5_lp', 'b6_cnt', 'b6_cntd', 'b6_lp'] but SELECT only produces ['*'] | INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs",
  "error_messages": [
    "INTERFACE: [main_query] declares outputs ['b1_cnt', 'b1_cntd', 'b1_lp', 'b2_cnt', 'b2_cntd', 'b2_lp', 'b3_cnt', 'b3_cntd', 'b3_lp', 'b4_cnt', 'b4_cntd', 'b4_lp', 'b5_cnt', 'b5_cntd', 'b5_lp', 'b6_cnt', 'b6_cntd', 'b6_lp'] but SELECT only produces ['*']",
    "INTERFACE: [main_query] SELECT produces ['*'] not declared in outputs"
  ],
  "error_category": null
}