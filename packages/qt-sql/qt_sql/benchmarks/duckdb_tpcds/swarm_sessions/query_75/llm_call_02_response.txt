```sql
WITH filtered_item AS (
  SELECT 
    i_item_sk,
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id
  FROM item
  WHERE i_category = 'Home'
),
date_1999 AS (
  SELECT d_date_sk
  FROM date_dim
  WHERE d_year = 1999
),
date_1998 AS (
  SELECT d_date_sk
  FROM date_dim
  WHERE d_year = 1998
),
catalog_sales_1999 AS (
  SELECT
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id,
    cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt,
    cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt
  FROM catalog_sales
  JOIN filtered_item ON i_item_sk = cs_item_sk
  JOIN date_1999 ON d_date_sk = cs_sold_date_sk
  LEFT JOIN catalog_returns ON (
    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk
  )
),
catalog_sales_1998 AS (
  SELECT
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id,
    cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt,
    cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt
  FROM catalog_sales
  JOIN filtered_item ON i_item_sk = cs_item_sk
  JOIN date_1998 ON d_date_sk = cs_sold_date_sk
  LEFT JOIN catalog_returns ON (
    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk
  )
),
store_sales_1999 AS (
  SELECT
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id,
    ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt,
    ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt
  FROM store_sales
  JOIN filtered_item ON i_item_sk = ss_item_sk
  JOIN date_1999 ON d_date_sk = ss_sold_date_sk
  LEFT JOIN store_returns ON (
    ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk
  )
),
store_sales_1998 AS (
  SELECT
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id,
    ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt,
    ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt
  FROM store_sales
  JOIN filtered_item ON i_item_sk = ss_item_sk
  JOIN date_1998 ON d_date_sk = ss_sold_date_sk
  LEFT JOIN store_returns ON (
    ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk
  )
),
web_sales_1999 AS (
  SELECT
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id,
    ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt,
    ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt
  FROM web_sales
  JOIN filtered_item ON i_item_sk = ws_item_sk
  JOIN date_1999 ON d_date_sk = ws_sold_date_sk
  LEFT JOIN web_returns ON (
    ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk
  )
),
web_sales_1998 AS (
  SELECT
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id,
    ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt,
    ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt
  FROM web_sales
  JOIN filtered_item ON i_item_sk = ws_item_sk
  JOIN date_1998 ON d_date_sk = ws_sold_date_sk
  LEFT JOIN web_returns ON (
    ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk
  )
),
all_sales_1999 AS (
  SELECT
    1999 AS d_year,
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id,
    SUM(sales_cnt) AS sales_cnt,
    SUM(sales_amt) AS sales_amt
  FROM (
    SELECT * FROM catalog_sales_1999
    UNION ALL
    SELECT * FROM store_sales_1999
    UNION ALL
    SELECT * FROM web_sales_1999
  ) AS sales_detail
  GROUP BY
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id
),
all_sales_1998 AS (
  SELECT
    1998 AS d_year,
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id,
    SUM(sales_cnt) AS sales_cnt,
    SUM(sales_amt) AS sales_amt
  FROM (
    SELECT * FROM catalog_sales_1998
    UNION ALL
    SELECT * FROM store_sales_1998
    UNION ALL
    SELECT * FROM web_sales_1998
  ) AS sales_detail
  GROUP BY
    i_brand_id,
    i_class_id,
    i_category_id,
    i_manufact_id
)
SELECT
  prev_yr.d_year AS prev_year,
  curr_yr.d_year AS year,
  curr_yr.i_brand_id,
  curr_yr.i_class_id,
  curr_yr.i_category_id,
  curr_yr.i_manufact_id,
  prev_yr.sales_cnt AS prev_yr_cnt,
  curr_yr.sales_cnt AS curr_yr_cnt,
  curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff,
  curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff
FROM all_sales_1999 AS curr_yr
JOIN all_sales_1998 AS prev_yr ON
  curr_yr.i_brand_id = prev_yr.i_brand_id
  AND curr_yr.i_class_id = prev_yr.i_class_id
  AND curr_yr.i_category_id = prev_yr.i_category_id
  AND curr_yr.i_manufact_id = prev_yr.i_manufact_id
WHERE CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9
ORDER BY
  sales_cnt_diff,
  sales_amt_diff
LIMIT 100;
```

**Changes**: 
1. Created filtered_item CTE to apply i_category='Home' filter once, reused across all sales channels
2. Created date_1999 and date_1998 CTEs to filter date_dim early for each needed year
3. Split the all_sales CTE into separate year-specific CTEs (1998 and 1999) that filter at the lowest level, avoiding scanning all years
4. Each sales channel is computed separately per year, then aggregated, reducing the data flowing through UNION ALL
5. Converted implicit cross join to explicit INNER JOIN in main query

**Expected speedup**: 3-4x by filtering dimension tables early, reducing data volumes in UNION ALL operations, and avoiding grouping unnecessary years