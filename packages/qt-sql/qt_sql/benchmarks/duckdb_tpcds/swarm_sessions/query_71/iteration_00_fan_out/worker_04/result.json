{
  "worker_id": 4,
  "strategy": "channel_aggregation_pushdown",
  "examples_used": [
    "single_pass_aggregation",
    "pushdown"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 12 AND d_year = 1998), filtered_item AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 1), web_channel_agg AS (SELECT i_brand_id, i_brand, ws_sold_time_sk AS time_sk, SUM(ws_ext_sales_price) AS ext_price FROM web_sales JOIN filtered_date ON ws_sold_date_sk = d_date_sk JOIN filtered_item ON ws_item_sk = i_item_sk GROUP BY i_brand_id, i_brand, ws_sold_time_sk), catalog_channel_agg AS (SELECT i_brand_id, i_brand, cs_sold_time_sk AS time_sk, SUM(cs_ext_sales_price) AS ext_price FROM catalog_sales JOIN filtered_date ON cs_sold_date_sk = d_date_sk JOIN filtered_item ON cs_item_sk = i_item_sk GROUP BY i_brand_id, i_brand, cs_sold_time_sk), store_channel_agg AS (SELECT i_brand_id, i_brand, ss_sold_time_sk AS time_sk, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_item ON ss_item_sk = i_item_sk GROUP BY i_brand_id, i_brand, ss_sold_time_sk), union_all AS (SELECT i_brand_id, i_brand, time_sk, ext_price FROM web_channel_agg UNION ALL SELECT i_brand_id, i_brand, time_sk, ext_price FROM catalog_channel_agg UNION ALL SELECT i_brand_id, i_brand, time_sk, ext_price FROM store_channel_agg), join_time AS (SELECT i_brand_id, i_brand, t_hour, t_minute, ext_price FROM union_all JOIN time_dim ON time_sk = t_time_sk WHERE t_meal_time = 'breakfast' OR t_meal_time = 'dinner'), final_union AS (SELECT i_brand_id, i_brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM join_time GROUP BY i_brand_id, i_brand, t_hour, t_minute) SELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, ext_price FROM final_union ORDER BY ext_price DESC, i_brand_id",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation: Apply early aggregation per channel; ignore the CASE ",
  "error_message": "INTERFACE: [web_channel_agg] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk'] | INTERFACE: [web_channel_agg] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk'] | INTERFACE: [catalog_channel_agg] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk'] | INTERFACE: [catalog_channel_agg] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk'] | INTERFACE: [store_channel_agg] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk'] | INTERFACE: [store_channel_agg] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk'] | INTERFACE: [union_all] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [catalog_channel_agg]? [catalog_channel_agg] only provides ['ext_price', 'i_brand', 'i_brand_id', 'time_sk'] | INTERFACE: [union_all] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [catalog_channel_agg]? [catalog_channel_agg] only provides ['ext_price', 'i_brand', 'i_brand_id', 'time_sk'] | INTERFACE: [join_time] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [union_all]? [union_all] only provides ['ext_price', 'i_brand', 'i_brand_id', 'time_sk'] | INTERFACE: [join_time] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [union_all]? [union_all] only provides ['ext_price', 'i_brand', 'i_brand_id', 'time_sk'] | INTERFACE: [final_union] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [join_time]? [join_time] only provides ['ext_price', 'i_brand', 'i_brand_id', 't_hour', 't_minute'] | INTERFACE: [final_union] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [join_time]? [join_time] only provides ['ext_price', 'i_brand', 'i_brand_id', 't_hour', 't_minute']",
  "error_messages": [
    "INTERFACE: [web_channel_agg] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk']",
    "INTERFACE: [web_channel_agg] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk']",
    "INTERFACE: [catalog_channel_agg] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk']",
    "INTERFACE: [catalog_channel_agg] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk']",
    "INTERFACE: [store_channel_agg] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk']",
    "INTERFACE: [store_channel_agg] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [filtered_item]? [filtered_item] only provides ['i_brand', 'i_brand_id', 'i_item_sk']",
    "INTERFACE: [union_all] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [catalog_channel_agg]? [catalog_channel_agg] only provides ['ext_price', 'i_brand', 'i_brand_id', 'time_sk']",
    "INTERFACE: [union_all] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [catalog_channel_agg]? [catalog_channel_agg] only provides ['ext_price', 'i_brand', 'i_brand_id', 'time_sk']",
    "INTERFACE: [join_time] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [union_all]? [union_all] only provides ['ext_price', 'i_brand', 'i_brand_id', 'time_sk']",
    "INTERFACE: [join_time] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [union_all]? [union_all] only provides ['ext_price', 'i_brand', 'i_brand_id', 'time_sk']",
    "INTERFACE: [final_union] uses \"i_brand_id\" \u2014 did you mean \"i_brand\" from [join_time]? [join_time] only provides ['ext_price', 'i_brand', 'i_brand_id', 't_hour', 't_minute']",
    "INTERFACE: [final_union] uses \"i_brand\" \u2014 did you mean \"i_brand_id\" from [join_time]? [join_time] only provides ['ext_price', 'i_brand', 'i_brand_id', 't_hour', 't_minute']"
  ],
  "error_category": null,
  "exploratory": true
}