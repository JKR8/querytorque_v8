{
  "worker_id": 1,
  "strategy": "single_pass_aggregation",
  "examples_used": [
    "single_pass_aggregation",
    "channel_bitmap_aggregation"
  ],
  "optimized_sql": "WITH filtered_time AS (SELECT t_time_sk, t_hour FROM time_dim WHERE t_hour BETWEEN 10 AND 11 OR t_hour BETWEEN 16 AND 17), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 2), filtered_wp AS (SELECT wp_web_page_sk FROM web_page WHERE wp_char_count BETWEEN 5000 AND 5200), consolidated_fact_scan AS (SELECT ws.ws_sold_time_sk, ws.ws_ship_hdemo_sk, ws.ws_web_page_sk, ft.t_hour FROM web_sales ws INNER JOIN filtered_time ft ON ws.ws_sold_time_sk = ft.t_time_sk INNER JOIN filtered_hd fhd ON ws.ws_ship_hdemo_sk = fhd.hd_demo_sk INNER JOIN filtered_wp fwp ON ws.ws_web_page_sk = fwp.wp_web_page_sk), conditional_aggregate AS (SELECT COUNT(*) FILTER (WHERE t_hour BETWEEN 10 AND 11) AS amc, COUNT(*) FILTER (WHERE t_hour BETWEEN 16 AND 17) AS pmc FROM consolidated_fact_scan) SELECT CAST(amc AS DECIMAL(15,4)) / CAST(pmc AS DECIMAL(15,4)) AS am_pm_ratio FROM conditional_aggregate ORDER BY am_pm_ratio LIMIT 100",
  "speedup": 1.4710183563531358,
  "status": "WIN",
  "transforms": [
    "single_pass_aggregation"
  ],
  "hint": "- single_pass_aggregation (Q9): Apply the pattern of replacing multiple scalar s",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}