{
  "worker_id": 3,
  "strategy": "early_filter_with_union_time",
  "examples_used": [
    "early_filter",
    "pushdown"
  ],
  "optimized_sql": "WITH time_windows AS (SELECT t_time_sk, CASE WHEN t_hour BETWEEN 10 AND 11 THEN 'AM' WHEN t_hour BETWEEN 16 AND 17 THEN 'PM' END AS time_window FROM time_dim WHERE (t_hour BETWEEN 10 AND 11) OR (t_hour BETWEEN 16 AND 17)), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 2), filtered_wp AS (SELECT wp_web_page_sk FROM web_page WHERE wp_char_count BETWEEN 5000 AND 5200), fact_join AS (SELECT ws.ws_sold_time_sk, ws.ws_ship_hdemo_sk, ws.ws_web_page_sk, tw.time_window FROM web_sales ws INNER JOIN time_windows tw ON ws.ws_sold_time_sk = tw.t_time_sk INNER JOIN filtered_hd hd ON ws.ws_ship_hdemo_sk = hd.hd_demo_sk INNER JOIN filtered_wp wp ON ws.ws_web_page_sk = wp.wp_web_page_sk), window_aggregate AS (SELECT time_window, COUNT(*) AS cnt FROM fact_join GROUP BY time_window) SELECT CAST(MAX(CASE WHEN time_window = 'AM' THEN cnt END) AS DECIMAL(15,4)) / CAST(MAX(CASE WHEN time_window = 'PM' THEN cnt END) AS DECIMAL(15,4)) AS am_pm_ratio FROM window_aggregate ORDER BY am_pm_ratio LIMIT 100",
  "speedup": 1.0,
  "status": "NEUTRAL",
  "transforms": [
    "early_filter"
  ],
  "hint": "- early_filter (Q11): Apply filtering of dimension tables first, then join with ",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}