{
  "worker_id": 2,
  "strategy": "star_join_prefetch",
  "examples_used": [
    "prefetch_fact_join",
    "dimension_cte_isolate"
  ],
  "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-2-01' AND (CAST('2000-2-01' AS DATE) + INTERVAL 60 DAY)), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'OK'), filtered_website AS (SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'), fact_prejoin AS (SELECT ws_order_number, ws_ext_ship_cost, ws_net_profit, ws_warehouse_sk FROM web_sales ws1 JOIN filtered_date ON ws1.ws_ship_date_sk = filtered_date.d_date_sk JOIN filtered_address ON ws1.ws_ship_addr_sk = filtered_address.ca_address_sk JOIN filtered_website ON ws1.ws_web_site_sk = filtered_website.web_site_sk), multi_warehouse_set AS (SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1), no_returns_set AS (SELECT wr_order_number FROM web_returns GROUP BY wr_order_number), final_join_aggregation AS (SELECT COUNT(DISTINCT fp.ws_order_number) AS \"order count\", SUM(fp.ws_ext_ship_cost) AS \"total shipping cost\", SUM(fp.ws_net_profit) AS \"total net profit\" FROM fact_prejoin fp JOIN multi_warehouse_set mws ON fp.ws_order_number = mws.ws_order_number LEFT JOIN no_returns_set nrs ON fp.ws_order_number = nrs.wr_order_number WHERE nrs.wr_order_number IS NULL GROUP BY ()) SELECT \"order count\", \"total shipping cost\", \"total net profit\" FROM final_join_aggregation ORDER BY \"order count\" LIMIT 100",
  "speedup": 0.20820045778176013,
  "status": "REGRESSION",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "- prefetch_fact_join (Q63): Apply chain: filter dimensions, pre-join with fact. ",
  "error_message": null,
  "error_messages": [],
  "error_category": null
}