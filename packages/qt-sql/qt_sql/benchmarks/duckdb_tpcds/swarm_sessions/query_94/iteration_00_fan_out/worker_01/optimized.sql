WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-2-01' AND (CAST('2000-2-01' AS DATE) + INTERVAL 60 DAY)), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'OK'), filtered_website AS (SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'), candidate_orders AS (SELECT ws1.ws_order_number, ws1.ws_ext_ship_cost, ws1.ws_net_profit, ws1.ws_warehouse_sk FROM web_sales ws1 INNER JOIN filtered_date fd ON ws1.ws_ship_date_sk = fd.d_date_sk INNER JOIN filtered_address fa ON ws1.ws_ship_addr_sk = fa.ca_address_sk INNER JOIN filtered_website fw ON ws1.ws_web_site_sk = fw.web_site_sk), multi_warehouse_flag AS (SELECT ws_order_number, ws_ext_ship_cost, ws_net_profit FROM (SELECT ws_order_number, ws_ext_ship_cost, ws_net_profit, ws_warehouse_sk, COUNT(DISTINCT ws_warehouse_sk) OVER (PARTITION BY ws_order_number) AS warehouse_count FROM candidate_orders) sub WHERE warehouse_count >= 2) SELECT COUNT(DISTINCT ws_order_number) AS "order count", SUM(ws_ext_ship_cost) AS "total shipping cost", SUM(ws_net_profit) AS "total net profit" FROM multi_warehouse_flag mwf WHERE NOT EXISTS (SELECT 1 FROM web_returns wr WHERE wr.wr_order_number = mwf.ws_order_number) ORDER BY COUNT(DISTINCT ws_order_number) LIMIT 100