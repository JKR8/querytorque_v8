{
  "worker_id": 2,
  "strategy": "dimension_cte_isolate",
  "examples_used": [
    "dimension_cte_isolate",
    "early_filter"
  ],
  "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1183 AND 1183 + 11), potential_customers AS (SELECT DISTINCT c.c_customer_sk, c.c_last_name, c.c_first_name FROM (SELECT ss_customer_sk AS customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk UNION SELECT cs_bill_customer_sk AS customer_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk UNION SELECT ws_bill_customer_sk AS customer_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk) cust_keys INNER JOIN customer c ON cust_keys.customer_sk = c.c_customer_sk), store_channel AS (SELECT DISTINCT pc.c_last_name, pc.c_first_name, fd.d_date FROM store_sales ss INNER JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk INNER JOIN potential_customers pc ON ss.ss_customer_sk = pc.c_customer_sk), catalog_channel AS (SELECT DISTINCT pc.c_last_name, pc.c_first_name, fd.d_date FROM catalog_sales cs INNER JOIN filtered_dates fd ON cs.cs_sold_date_sk = fd.d_date_sk INNER JOIN potential_customers pc ON cs.cs_bill_customer_sk = pc.c_customer_sk), web_channel AS (SELECT DISTINCT pc.c_last_name, pc.c_first_name, fd.d_date FROM web_sales ws INNER JOIN filtered_dates fd ON ws.ws_sold_date_sk = fd.d_date_sk INNER JOIN potential_customers pc ON ws.ws_bill_customer_sk = pc.c_customer_sk), intersect_sets AS ((SELECT c_last_name, c_first_name, d_date FROM store_channel) INTERSECT (SELECT c_last_name, c_first_name, d_date FROM catalog_channel) INTERSECT (SELECT c_last_name, c_first_name, d_date FROM web_channel)) SELECT COUNT(*) FROM intersect_sets LIMIT 100",
  "speedup": 0.6027907024064735,
  "status": "REGRESSION",
  "transforms": [
    "dimension_cte_isolate"
  ],
  "hint": "Apply: Pre-filter customer table to only those appearing in any sales channel du",
  "error_message": "INTERFACE: [potential_customers] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_dates]? [filtered_dates] only provides ['d_date', 'd_date_sk']",
  "error_messages": [
    "INTERFACE: [potential_customers] uses \"d_date_sk\" \u2014 did you mean \"d_date\" from [filtered_dates]? [filtered_dates] only provides ['d_date', 'd_date_sk']"
  ],
  "error_category": null
}