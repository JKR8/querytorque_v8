[
  {
    "probe_id": "p_demo_b1",
    "transform_id": "decorrelate",
    "family": "B",
    "status": "PASS",
    "failure_category": "-",
    "speedup": 1.18,
    "description": "Decorrelate scalar aggregate with precomputed store averages.",
    "explain_text": "LEFT_DELIM_JOIN removed; HASH_JOIN against store_averages; CTE_SCAN remains single-pass.",
    "sql": "WITH customer_total_return AS ( SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, SUM(sr_fee) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 GROUP BY sr_customer_sk, sr_store_sk), store_averages AS ( SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_return FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return ctr1, store, customer, store_averages sa WHERE ctr1.ctr_store_sk = sa.ctr_store_sk AND ctr1.ctr_total_return > sa.avg_return AND s_store_sk = ctr1.ctr_store_sk AND s_state = 'SD' AND ctr1.ctr_customer_sk = c_customer_sk ORDER BY c_customer_id LIMIT 100",
    "error": ""
  },
  {
    "probe_id": "p_demo_f2",
    "transform_id": "inner_join_conversion",
    "family": "F",
    "status": "FAIL",
    "failure_category": "semantic_violation",
    "speedup": null,
    "description": "Join topology rewrite candidate.",
    "explain_text": "No reliable delta; failed semantic gate.",
    "sql": "SELECT c_customer_id FROM customer_total_return ctr1 JOIN store s ON s.s_store_sk = ctr1.ctr_store_sk JOIN customer c ON c.c_customer_sk = ctr1.ctr_customer_sk WHERE s.s_state = 'SD' ORDER BY c_customer_id LIMIT 100",
    "error": "Tier-2 row-count mismatch against original."
  }
]