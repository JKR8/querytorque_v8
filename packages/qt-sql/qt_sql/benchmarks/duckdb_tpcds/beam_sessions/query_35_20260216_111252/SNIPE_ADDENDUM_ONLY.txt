


## Previous Attempt Results

### History — All Prior Patches

| Iter | Patch | Family | Transform | Speedup | Status | Orig ms | Patch ms | Error (summary) |
|------|-------|--------|-----------|---------|--------|---------|----------|-----------------|
| 0 | t1 | B | exists_to_semijoin | 2.88x | WIN | 134 | 46 |  |
| 0 | t2 | E+F | date_dim_prefetch+comma_to_innerjoin | 1.11x | WIN | 134 | 120 |  |
| 0 | ast_w4 | B | composite_decorrelate_union | 2.95x | WIN | 134 | 45 |  |
| 0 | syn_w1 | A | early_filter | 2.99x | WIN | 134 | 45 |  |

### Latest Iteration 0 — Detailed Results

#### Race Results

| Patch | Family | Transform | Speedup | Status | Orig ms | Patch ms | Semantic | Error |
|-------|--------|-----------|---------|--------|---------|----------|----------|-------|
| t1 | B | exists_to_semijoin | 2.88x | WIN | 134 | 46 | PASS |  |
| t2 | E+F | date_dim_prefetch+comma_to_innerjoin | 1.11x | WIN | 134 | 120 | PASS |  |
| ast_w4 | B | composite_decorrelate_union | 2.95x | WIN | 134 | 45 | PASS |  |
| syn_w1 | A | early_filter | 2.99x | WIN | 134 | 45 | PASS |  |

#### Patched SQL

**t1 (Family B, exists_to_semijoin) — 2.88x WIN:**
```sql
WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4), store_customers AS (SELECT ss_customer_sk FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk), web_customers AS (SELECT ws_bill_customer_sk FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk GROUP BY ws_bill_customer_sk), catalog_customers AS (SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_range ON cs_sold_date_sk = d_date_sk GROUP BY cs_ship_customer_sk) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c INNER JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk INNER JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk SEMI JOIN store_customers AS sc ON c.c_customer_sk = sc.ss_customer_sk SEMI JOIN (SELECT ws_bill_customer_sk FROM web_customers UNION SELECT cs_ship_customer_sk FROM catalog_customers) AS wc ON c.c_customer_sk = wc.ws_bill_customer_sk WHERE TRUE GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;

/* end query 35 in stream 0 using template query35.tpl */;
```

**t2 (Family E+F, date_dim_prefetch+comma_to_innerjoin) — 1.11x WIN:**
```sql
WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c INNER JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk INNER JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE EXISTS(SELECT 1 FROM store_sales AS ss, date_range AS dr WHERE c.c_customer_sk = ss.ss_customer_sk AND ss.ss_sold_date_sk = dr.d_date_sk) AND (EXISTS(SELECT 1 FROM web_sales AS ws, date_range AS dr WHERE c.c_customer_sk = ws.ws_bill_customer_sk AND ws.ws_sold_date_sk = dr.d_date_sk) OR EXISTS(SELECT 1 FROM catalog_sales AS cs, date_range AS dr WHERE c.c_customer_sk = cs.cs_ship_customer_sk AND cs.cs_sold_date_sk = dr.d_date_sk)) GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;

/* end query 35 in stream 0 using template query35.tpl */;
```

**ast_w4 (Family B, composite_decorrelate_union) — 2.95x WIN:**
```sql
WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4), store_customers AS (SELECT ss_customer_sk FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk), web_customers AS (SELECT ws_bill_customer_sk FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk GROUP BY ws_bill_customer_sk), catalog_customers AS (SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_range ON cs_sold_date_sk = d_date_sk GROUP BY cs_ship_customer_sk) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk SEMI JOIN store_customers AS sc ON c.c_customer_sk = sc.ss_customer_sk SEMI JOIN (SELECT ws_bill_customer_sk FROM web_customers UNION SELECT cs_ship_customer_sk FROM catalog_customers) AS wc ON c.c_customer_sk = wc.ws_bill_customer_sk WHERE 1 = 1 GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;

/* end query 35 in stream 0 using template query35.tpl */;
```

**syn_w1 (Family A, early_filter) — 2.99x WIN:**
```sql
WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4), store_customers AS (SELECT ss_customer_sk FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk), web_customers AS (SELECT ws_bill_customer_sk FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk GROUP BY ws_bill_customer_sk), catalog_customers AS (SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_range ON cs_sold_date_sk = d_date_sk GROUP BY cs_ship_customer_sk) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk SEMI JOIN store_customers AS sc ON c.c_customer_sk = sc.ss_customer_sk SEMI JOIN (SELECT ws_bill_customer_sk FROM web_customers UNION SELECT cs_ship_customer_sk FROM catalog_customers) AS wc ON c.c_customer_sk = wc.ws_bill_customer_sk WHERE TRUE GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;

/* end query 35 in stream 0 using template query35.tpl */;
```

#### Execution Plans

**Original EXPLAIN:**
```
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE -- start query 35 in stream 0 using template query35.tpl select     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   max(cd_dep_count),   sum(cd_dep_count),   max(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   max(cd_dep_employed_count),   sum(cd_dep_employed_count),   max(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   max(cd_dep_college_count),   sum(cd_dep_college_count),   max(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  LIMIT 100;  -- end query 35 in stream 0 using template query35.tpl 
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.370s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│    TOP_N    │
│    ──────   │
│     Top:    │
│     100     │
│             │
│  Order By:  │
│ ca.ca_state │
│      ASC    │
│ tpcds_sf10_2│
│.main.custome│
│r_demographic│
│ s.cd_gender │
│      ASC    │
│ tpcds_sf10_2│
│.main.custome│
│r_demographic│
│s.cd_marital_│
│  status ASC │
│ tpcds_sf10_2│
│.main.custome│
│r_demographic│
│s.cd_dep_coun│
│    t ASC    │
│ tpcds_sf10_2│
│.main.custome│
│r_demographic│
│s.cd_dep_empl│
│  oyed_count │
│      ASC    │
│ tpcds_sf10_2│
│.main.custome│
│r_demographic│
│s.cd_dep_coll│
│ege_count ASC│
│             │
│   100 rows  │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
```

**t1 (Family B, 2.88x WIN) EXPLAIN:**
```
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4), store_customers AS (SELECT ss_customer_sk FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk), web_customers AS (SELECT ws_bill_customer_sk FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk GROUP BY ws_bill_customer_sk), catalog_customers AS (SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_range ON cs_sold_date_sk = d_date_sk GROUP BY cs_ship_customer_sk) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c INNER JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk INNER JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk SEMI JOIN store_customers AS sc ON c.c_customer_sk = sc.ss_customer_sk SEMI JOIN (SELECT ws_bill_customer_sk FROM web_customers UNION SELECT cs_ship_customer_sk FROM catalog_customers) AS wc ON c.c_customer_sk = wc.ws_bill_customer_sk WHERE TRUE GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;  /* end query 35 in stream 0 using template query35.tpl */;
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.0503s             ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────┐
│         QUERY         │
└───────────┬───────────┘
┌───────────┴───────────┐
│    EXPLAIN_ANALYZE    │
│    ────────────────   │
│         0 rows        │
│        (0.00s)        │
└───────────┬───────────┘
┌───────────┴───────────┐
│         TOP_N         │
│    ────────────────   │
│        Top: 100       │
│                       │
│       Order By:       │
│    ca.ca_state ASC    │
│    cd.cd_gender ASC   │
│  cd.cd_marital_status │
│           ASC         │
│  cd.cd_dep_count ASC  │
│cd.cd_dep_employed_coun│
│         t ASC         │
│cd.cd_dep_college_count│
│           ASC         │
│                       │
│        100 rows       │
│        (0.00s)        │
└───────────┬───────────┘
┌───────────┴───────────┐
│       PROJECTION      │
│    ────────────────   │
│        ca_state       │
│       cd_gender       │
│   cd_marital_status   │
│      cd_dep_count     │
│          cnt1         │
│   max(cd_dep_count)   │
│   sum(cd_dep_count)   │
│   max(cd_dep_count)   │
│ cd_dep_employed_count │
│          cnt2         │
│max(cd_dep_employed_cou│
│          nt)          │
│sum(cd_dep_employed_cou│
│          nt)          │
│max(cd_dep_employed_cou│
│          nt)          │
│  cd_dep_college_count │
│          cnt3         │
```

**t2 (Family E+F, 1.11x WIN) EXPLAIN:**
```
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c INNER JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk INNER JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE EXISTS(SELECT 1 FROM store_sales AS ss, date_range AS dr WHERE c.c_customer_sk = ss.ss_customer_sk AND ss.ss_sold_date_sk = dr.d_date_sk) AND (EXISTS(SELECT 1 FROM web_sales AS ws, date_range AS dr WHERE c.c_customer_sk = ws.ws_bill_customer_sk AND ws.ws_sold_date_sk = dr.d_date_sk) OR EXISTS(SELECT 1 FROM catalog_sales AS cs, date_range AS dr WHERE c.c_customer_sk = cs.cs_ship_customer_sk AND cs.cs_sold_date_sk = dr.d_date_sk)) GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;  /* end query 35 in stream 0 using template query35.tpl */;
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.126s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│    TOP_N    │
│    ──────   │
│     Top:    │
│     100     │
│             │
│  Order By:  │
│ ca.ca_state │
│      ASC    │
│ cd.cd_gender│
│      ASC    │
│cd.cd_marital│
│ _status ASC │
│cd.cd_dep_cou│
│    nt ASC   │
│cd.cd_dep_emp│
│ loyed_count │
│      ASC    │
│cd.cd_dep_col│
│  lege_count │
│      ASC    │
│             │
│   100 rows  │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│   ca_state  │
│  cd_gender  │
│cd_marital_st│
│     atus    │
│ cd_dep_count│
│     cnt1    │
│max(cd_dep_co│
│     unt)    │
│sum(cd_dep_co│
│     unt)    │
│max(cd_dep_co│
│     unt)    │
```

**ast_w4 (Family B, 2.95x WIN) EXPLAIN:**
```
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4), store_customers AS (SELECT ss_customer_sk FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk), web_customers AS (SELECT ws_bill_customer_sk FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk GROUP BY ws_bill_customer_sk), catalog_customers AS (SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_range ON cs_sold_date_sk = d_date_sk GROUP BY cs_ship_customer_sk) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk SEMI JOIN store_customers AS sc ON c.c_customer_sk = sc.ss_customer_sk SEMI JOIN (SELECT ws_bill_customer_sk FROM web_customers UNION SELECT cs_ship_customer_sk FROM catalog_customers) AS wc ON c.c_customer_sk = wc.ws_bill_customer_sk WHERE 1 = 1 GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;  /* end query 35 in stream 0 using template query35.tpl */;
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.0496s             ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────┐
│         QUERY         │
└───────────┬───────────┘
┌───────────┴───────────┐
│    EXPLAIN_ANALYZE    │
│    ────────────────   │
│         0 rows        │
│        (0.00s)        │
└───────────┬───────────┘
┌───────────┴───────────┐
│         TOP_N         │
│    ────────────────   │
│        Top: 100       │
│                       │
│       Order By:       │
│    ca.ca_state ASC    │
│    cd.cd_gender ASC   │
│  cd.cd_marital_status │
│           ASC         │
│  cd.cd_dep_count ASC  │
│cd.cd_dep_employed_coun│
│         t ASC         │
│cd.cd_dep_college_count│
│           ASC         │
│                       │
│        100 rows       │
│        (0.00s)        │
└───────────┬───────────┘
┌───────────┴───────────┐
│       PROJECTION      │
│    ────────────────   │
│        ca_state       │
│       cd_gender       │
│   cd_marital_status   │
│      cd_dep_count     │
│          cnt1         │
│   max(cd_dep_count)   │
│   sum(cd_dep_count)   │
│   max(cd_dep_count)   │
│ cd_dep_employed_count │
│          cnt2         │
│max(cd_dep_employed_cou│
│          nt)          │
│sum(cd_dep_employed_cou│
│          nt)          │
│max(cd_dep_employed_cou│
│          nt)          │
│  cd_dep_college_count │
│          cnt3         │
```

**syn_w1 (Family A, 2.99x WIN) EXPLAIN:**
```
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4), store_customers AS (SELECT ss_customer_sk FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk), web_customers AS (SELECT ws_bill_customer_sk FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk GROUP BY ws_bill_customer_sk), catalog_customers AS (SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_range ON cs_sold_date_sk = d_date_sk GROUP BY cs_ship_customer_sk) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk SEMI JOIN store_customers AS sc ON c.c_customer_sk = sc.ss_customer_sk SEMI JOIN (SELECT ws_bill_customer_sk FROM web_customers UNION SELECT cs_ship_customer_sk FROM catalog_customers) AS wc ON c.c_customer_sk = wc.ws_bill_customer_sk WHERE TRUE GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;  /* end query 35 in stream 0 using template query35.tpl */;
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.0468s             ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────┐
│         QUERY         │
└───────────┬───────────┘
┌───────────┴───────────┐
│    EXPLAIN_ANALYZE    │
│    ────────────────   │
│         0 rows        │
│        (0.00s)        │
└───────────┬───────────┘
┌───────────┴───────────┐
│         TOP_N         │
│    ────────────────   │
│        Top: 100       │
│                       │
│       Order By:       │
│    ca.ca_state ASC    │
│    cd.cd_gender ASC   │
│  cd.cd_marital_status │
│           ASC         │
│  cd.cd_dep_count ASC  │
│cd.cd_dep_employed_coun│
│         t ASC         │
│cd.cd_dep_college_count│
│           ASC         │
│                       │
│        100 rows       │
│        (0.00s)        │
└───────────┬───────────┘
┌───────────┴───────────┐
│       PROJECTION      │
│    ────────────────   │
│        ca_state       │
│       cd_gender       │
│   cd_marital_status   │
│      cd_dep_count     │
│          cnt1         │
│   max(cd_dep_count)   │
│   sum(cd_dep_count)   │
│   max(cd_dep_count)   │
│ cd_dep_employed_count │
│          cnt2         │
│max(cd_dep_employed_cou│
│          nt)          │
│sum(cd_dep_employed_cou│
│          nt)          │
│max(cd_dep_employed_cou│
│          nt)          │
│  cd_dep_college_count │
│          cnt3         │
```

## Your Task (Iteration 2)

Analyze the history summary table and the detailed latest results above.

**Key questions:**
- For WINNING patches: can you improve further? Combine with other strategies?
- For NEUTRAL patches: what went wrong? Look at the EXPLAIN plan. Can you fix the approach?
- For FAILED/ERROR patches: what caused the error? Look at the patched SQL. Propose an alternative.
- For REGRESSION patches: why did it get slower? Look at the patched SQL and EXPLAIN. Avoid that pattern.

Output a new JSON array of up to 4 patch plans (same format as before).
You may keep successful approaches and refine them, or try entirely new families.
