{
  "iteration": 0,
  "n_api_calls": 8,
  "best_speedup": 0.0,
  "best_patch_id": null,
  "best_sql": null,
  "patches": [
    {
      "patch_id": "ast_w4",
      "family": "B",
      "transform": "composite_decorrelate_union",
      "relevance_score": 1.0,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Equivalence (after retry): checksum 29893592f410526a126ae862c93e6abf vs 2ad62e7eb6972f92b66a037924b01caa",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4), sales_customers AS (SELECT ss_customer_sk AS customer_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk UNION SELECT ws_bill_customer_sk FROM web_sales JOIN date_filter ON ws_sold_date_sk = d_date_sk UNION SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_filter ON cs_sold_date_sk = d_date_sk) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE c.c_customer_sk IN (SELECT customer_sk FROM sales_customers) GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;\n\n/* end query 35 in stream 0 using template query35.tpl */;",
      "has_explain": false
    },
    {
      "patch_id": "t3",
      "family": "A",
      "transform": "push_cd_filters",
      "relevance_score": 0.75,
      "status": "REGRESSION",
      "speedup": 0.86,
      "semantic_passed": true,
      "error": null,
      "original_ms": 117.2,
      "patch_ms": 135.9,
      "output_sql": "WITH filtered_demographics AS (SELECT * FROM customer_demographics WHERE cd_demo_sk >= 4 AND cd_demo_sk <= 1920791) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c INNER JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk INNER JOIN filtered_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE c.c_current_addr_sk = ca.ca_address_sk AND cd_demo_sk = c.c_current_cdemo_sk AND EXISTS(SELECT * FROM store_sales, date_dim WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) AND (EXISTS(SELECT * FROM web_sales, date_dim WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4) OR EXISTS(SELECT * FROM catalog_sales, date_dim WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_qoy < 4)) GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;\n\n/* end query 35 in stream 0 using template query35.tpl */;",
      "has_explain": true
    },
    {
      "patch_id": "t1",
      "family": "B",
      "transform": "decorrelate_union",
      "relevance_score": 0.98,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Equivalence (after retry): checksum 29893592f410526a126ae862c93e6abf vs 2ad62e7eb6972f92b66a037924b01caa",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4), sales_customers AS (SELECT ss_customer_sk AS customer_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk UNION SELECT ws_bill_customer_sk FROM web_sales JOIN date_filter ON ws_sold_date_sk = d_date_sk UNION SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_filter ON cs_sold_date_sk = d_date_sk) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE c.c_customer_sk IN (SELECT customer_sk FROM sales_customers) GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;\n\n/* end query 35 in stream 0 using template query35.tpl */;",
      "has_explain": false
    },
    {
      "patch_id": "t2",
      "family": "E",
      "transform": "multi_dimension_prefetch",
      "relevance_score": 0.9,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Equivalence (after retry): checksum 29893592f410526a126ae862c93e6abf vs 2ad62e7eb6972f92b66a037924b01caa",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_qoy < 4) /* start query 35 in stream 0 using template query35.tpl */ SELECT ca_state, cd_gender, cd_marital_status, cd_dep_count, COUNT(*) AS cnt1, MAX(cd_dep_count), SUM(cd_dep_count), MAX(cd_dep_count), cd_dep_employed_count, COUNT(*) AS cnt2, MAX(cd_dep_employed_count), SUM(cd_dep_employed_count), MAX(cd_dep_employed_count), cd_dep_college_count, COUNT(*) AS cnt3, MAX(cd_dep_college_count), SUM(cd_dep_college_count), MAX(cd_dep_college_count) FROM customer AS c, customer_address AS ca, customer_demographics AS cd WHERE c.c_current_addr_sk = ca.ca_address_sk AND cd.cd_demo_sk = c.c_current_cdemo_sk AND (EXISTS(SELECT * FROM store_sales, date_filter WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk) OR EXISTS(SELECT * FROM web_sales, date_filter WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk) OR EXISTS(SELECT * FROM catalog_sales, date_filter WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk)) GROUP BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;\n\n/* end query 35 in stream 0 using template query35.tpl */;",
      "has_explain": false
    }
  ],
  "explains": {
    "t3": "Total execution time: 5986ms\n\nTOP_N [100 rows, 1.7ms]\n  HASH_GROUP_BY [58K rows, 57.9ms]\n    FILTER [77K rows, 5.9ms]\n      LEFT_DELIM_JOIN MARK on c_customer_sk IS NOT DISTINCT FROM c_customer_sk [0 rows, 42.9ms]\n        LEFT_DELIM_JOIN MARK on c_customer_sk IS NOT DISTINCT FROM c_customer_sk [0 rows, 65.5ms, 1%]\n          LEFT_DELIM_JOIN SEMI on c_customer_sk IS NOT DISTINCT FROM c_customer_sk [0 rows, 22.2ms]\n            HASH_JOIN INNER on ca_address_sk = c_current_addr_sk [483K rows, 52.0ms]"
  }
}