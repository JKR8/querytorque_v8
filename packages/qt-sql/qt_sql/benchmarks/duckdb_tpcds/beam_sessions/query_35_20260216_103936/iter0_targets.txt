[
  {
    "target_id": "t1",
    "family": "B",
    "transform": "decorrelate_exists",
    "relevance_score": 0.98,
    "hypothesis": "Correlated EXISTS subqueries re-scan sales tables per customer row. Precompute customer sets for each channel in target period.",
    "target_ir": "S0 [SELECT]\n  CTE: date_filter  (via CTE_Q_S0_date_filter)\n    FROM: date_dim\n    WHERE [d_date_filter]: d_year=2001 AND d_qoy<4\n  CTE: store_customers  (via CTE_Q_S0_store_customers)\n    FROM: store_sales, date_filter\n    WHERE: ss_sold_date_sk = d_date_sk\n    GROUP BY: ss_customer_sk\n  CTE: web_customers  (via CTE_Q_S0_web_customers)\n    FROM: web_sales, date_filter\n    WHERE: ws_sold_date_sk = d_date_sk\n    GROUP BY: ws_bill_customer_sk\n  CTE: catalog_customers  (via CTE_Q_S0_catalog_customers)\n    FROM: catalog_sales, date_filter\n    WHERE: cs_sold_date_sk = d_date_sk\n    GROUP BY: cs_ship_customer_sk\n  MAIN QUERY (via Q_S0)\n    FROM: customer c\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN customer_demographics cd ON cd_demo_sk = c.c_current_cdemo_sk\n    WHERE: c.c_customer_sk IN (store_customers)\n      AND (c.c_customer_sk IN (web_customers) OR c.c_customer_sk IN (catalog_customers))\n    GROUP BY: ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count\n    ORDER BY: ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count\n    LIMIT 100",
    "recommended_examples": [
      "decorrelate"
    ]
  },
  {
    "target_id": "t2",
    "family": "E",
    "transform": "date_dim_prefetch",
    "relevance_score": 0.95,
    "hypothesis": "Identical date_dim scan repeated 3x. Materialize filtered dates once for reuse across sales channels.",
    "target_ir": "S0 [SELECT]\n  CTE: date_filter  (via CTE_Q_S0_date_filter)\n    FROM: date_dim\n    WHERE [d_date_filter]: d_year=2001 AND d_qoy<4\n  MAIN QUERY (via Q_S0)\n    FROM: customer c, customer_address ca, customer_demographics\n    WHERE: c.c_current_addr_sk = ca.ca_address_sk \n      AND cd_demo_sk = c.c_current_cdemo_sk\n      AND EXISTS (SELECT 1 FROM store_sales, date_filter WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk)\n      AND (EXISTS (SELECT 1 FROM web_sales, date_filter WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk) \n        OR EXISTS (SELECT 1 FROM catalog_sales, date_filter WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk))\n    GROUP BY: ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count\n    ORDER BY: ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count\n    LIMIT 100",
    "recommended_examples": [
      "multi_dimension_prefetch"
    ]
  },
  {
    "target_id": "t3",
    "family": "A",
    "transform": "customer_chain_filter",
    "relevance_score": 0.85,
    "hypothesis": "Customer dimension joins happen before sales filters. Prefilter sales-active customers first.",
    "target_ir": "S0 [SELECT]\n  CTE: sales_customers  (via CTE_Q_S0_sales_customers)\n    FROM: (SELECT ss_customer_sk FROM store_sales, date_dim WHERE ...)\n      UNION (SELECT ws_bill_customer_sk FROM web_sales, date_dim WHERE ...)\n      UNION (SELECT cs_ship_customer_sk FROM catalog_sales, date_dim WHERE ...)\n  MAIN QUERY (via Q_S0)\n    FROM: sales_customers sc\n    JOIN customer c ON sc.customer_sk = c.c_customer_sk\n    JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\n    JOIN customer_demographics cd ON cd_demo_sk = c.c_current_cdemo_sk\n    GROUP BY: ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count\n    ORDER BY: ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count\n    LIMIT 100",
    "recommended_examples": [
      "date_cte_isolate"
    ]
  }
]