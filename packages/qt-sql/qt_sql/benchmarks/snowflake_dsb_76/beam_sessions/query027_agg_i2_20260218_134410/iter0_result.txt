{
  "iteration": 0,
  "n_api_calls": 3,
  "beam_cost_usd": 0.0,
  "beam_cost_priced_calls": 0,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 0,
    "completion_tokens": 0,
    "total_tokens": 0,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 0,
    "reasoning_tokens": 0
  },
  "best_speedup": 1.01,
  "best_patch_id": "p03",
  "best_sql": "WITH aggregated_results AS (WITH date_dim_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999),\n     customer_demographics_filtered AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'W' AND cd_education_status = 'Secondary'),\n     store_filtered AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'OH'),\n     item_filtered AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music')\nSELECT  i_item_id,\n        s_state, \n        grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nFROM store_sales\nJOIN date_dim_filtered ON ss_sold_date_sk = d_date_sk\nJOIN customer_demographics_filtered ON ss_cdemo_sk = cd_demo_sk\nJOIN store_filtered ON ss_store_sk = s_store_sk\nJOIN item_filtered ON ss_item_sk = i_item_sk\nGROUP BY rollup (i_item_id, s_state)\nORDER BY i_item_id, s_state\nLIMIT 100) select  i_item_id,\n        s_state, grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nfrom store_sales, customer_demographics, date_dim, store, item\nwhere ss_sold_date_sk = d_date_sk and\n      ss_item_sk = i_item_sk and\n      ss_store_sk = s_store_sk and\n      ss_cdemo_sk = cd_demo_sk and\n      cd_gender = 'M' and\n      cd_marital_status = 'W' and\n      cd_education_status = 'Secondary' and\n      d_year = 1999 and\n      s_state = 'OH' and\n     i_category  = 'Music'\n group by rollup (i_item_id, s_state)\n order by i_item_id\n         ,s_state\n limit 100;",
  "patches": [
    {
      "patch_id": "p03",
      "family": "A",
      "transform": "multi_dimension_prefetch",
      "relevance_score": 0.55,
      "status": "NEUTRAL",
      "speedup": 1.01,
      "semantic_passed": true,
      "error": null,
      "original_ms": 168.5,
      "patch_ms": 166.4,
      "output_sql": "WITH aggregated_results AS (WITH date_dim_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999),\n     customer_demographics_filtered AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'W' AND cd_education_status = 'Secondary'),\n     store_filtered AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'OH'),\n     item_filtered AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music')\nSELECT  i_item_id,\n        s_state, \n        grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nFROM store_sales\nJOIN date_dim_filtered ON ss_sold_date_sk = d_date_sk\nJOIN customer_demographics_filtered ON ss_cdemo_sk = cd_demo_sk\nJOIN store_filtered ON ss_store_sk = s_store_sk\nJOIN item_filtered ON ss_item_sk = i_item_sk\nGROUP BY rollup (i_item_id, s_state)\nORDER BY i_item_id, s_state\nLIMIT 100) select  i_item_id,\n        s_state, grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nfrom store_sales, customer_demographics, date_dim, store, item\nwhere ss_sold_date_sk = d_date_sk and\n      ss_item_sk = i_item_sk and\n      ss_store_sk = s_store_sk and\n      ss_cdemo_sk = cd_demo_sk and\n      cd_gender = 'M' and\n      cd_marital_status = 'W' and\n      cd_education_status = 'Secondary' and\n      d_year = 1999 and\n      s_state = 'OH' and\n     i_category  = 'Music'\n group by rollup (i_item_id, s_state)\n order by i_item_id\n         ,s_state\n limit 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Pre-filter all dimension tables (date_dim, customer_demographics, store, item) into separate CTEs, then join them with store_sales in a single CTE to apply combined filters early."
    },
    {
      "patch_id": "p02",
      "family": "C",
      "transform": "aggregate_pushdown",
      "relevance_score": 0.65,
      "status": "REGRESSION",
      "speedup": 0.85,
      "semantic_passed": true,
      "error": null,
      "original_ms": 168.5,
      "patch_ms": 198.8,
      "output_sql": "WITH store_sales_agg AS (SELECT ss_item_sk, ss_store_sk, ss_cdemo_sk, ss_sold_date_sk, SUM(ss_quantity) AS sum_ss_quantity, COUNT(ss_quantity) AS count_ss_quantity, SUM(ss_list_price) AS sum_ss_list_price, COUNT(ss_list_price) AS count_ss_list_price, SUM(ss_coupon_amt) AS sum_ss_coupon_amt, COUNT(ss_coupon_amt) AS count_ss_coupon_amt, SUM(ss_sales_price) AS sum_ss_sales_price, COUNT(ss_sales_price) AS count_ss_sales_price FROM store_sales WHERE ss_sold_date_sk IS NOT NULL AND ss_cdemo_sk IS NOT NULL AND ss_store_sk IS NOT NULL GROUP BY ss_item_sk, ss_store_sk, ss_cdemo_sk, ss_sold_date_sk) select  i_item_id,\n        s_state, grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nfrom store_sales, customer_demographics, date_dim, store, item\nwhere ss_sold_date_sk = d_date_sk and\n      ss_item_sk = i_item_sk and\n      ss_store_sk = s_store_sk and\n      ss_cdemo_sk = cd_demo_sk and\n      cd_gender = 'M' and\n      cd_marital_status = 'W' and\n      cd_education_status = 'Secondary' and\n      d_year = 1999 and\n      s_state = 'OH' and\n     i_category  = 'Music'\n group by rollup (i_item_id, s_state)\n order by i_item_id\n         ,s_state\n limit 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Pre-aggregate store_sales by all dimension foreign keys (ss_item_sk, ss_store_sk, ss_cdemo_sk, ss_sold_date_sk) before joining to dimensions, preserving sums and counts for final AVG."
    },
    {
      "patch_id": "p01",
      "family": "A",
      "transform": "sf_sk_pushdown_multi_fact",
      "relevance_score": 0.85,
      "status": "REGRESSION",
      "speedup": 0.86,
      "semantic_passed": true,
      "error": null,
      "original_ms": 168.5,
      "patch_ms": 195.3,
      "output_sql": "WITH date_sk_range AS (SELECT MIN(d_date_sk) AS min_date_sk, MAX(d_date_sk) AS max_date_sk FROM date_dim WHERE d_year = 1999), filtered_store_sales AS (SELECT ss.* FROM store_sales ss JOIN date_sk_range dr ON ss.ss_sold_date_sk BETWEEN dr.min_date_sk AND dr.max_date_sk), agg_result AS (SELECT  i_item_id, s_state, grouping(s_state) g_state, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 FROM filtered_store_sales, customer_demographics, store, item WHERE ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND ss_cdemo_sk = cd_demo_sk AND cd_gender = 'M' AND cd_marital_status = 'W' AND cd_education_status = 'Secondary' AND s_state = 'OH' AND i_category  = 'Music' GROUP BY rollup (i_item_id, s_state) ORDER BY i_item_id, s_state LIMIT 100) select  i_item_id,\n        s_state, grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nfrom store_sales, customer_demographics, date_dim, store, item\nwhere ss_sold_date_sk = d_date_sk and\n      ss_item_sk = i_item_sk and\n      ss_store_sk = s_store_sk and\n      ss_cdemo_sk = cd_demo_sk and\n      cd_gender = 'M' and\n      cd_marital_status = 'W' and\n      cd_education_status = 'Secondary' and\n      d_year = 1999 and\n      s_state = 'OH' and\n     i_category  = 'Music'\n group by rollup (i_item_id, s_state)\n order by i_item_id\n         ,s_state\n limit 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Add explicit date_sk range filter to store_sales scan derived from date_dim.d_year = 1999, using a CTE to precompute min/max date_sk."
    },
    {
      "patch_id": "p04",
      "family": "A",
      "transform": "dimension_cte_isolate",
      "relevance_score": 0.5,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: 000904 (42000): 01c27ccc-3205-67d8-0002-fcfe00023e5a: SQL compilation error: error line 15 at position 6\ninvalid identifier 'D_YEAR'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999) select  i_item_id,\n        s_state, grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nfrom store_sales, customer_demographics, date_filter, store, item\nwhere ss_sold_date_sk = d_date_sk and\n      ss_item_sk = i_item_sk and\n      ss_store_sk = s_store_sk and\n      ss_cdemo_sk = cd_demo_sk and\n      cd_gender = 'M' and\n      cd_marital_status = 'W' and\n      cd_education_status = 'Secondary' and\n      d_year = 1999 and\n      s_state = 'OH' and\n     i_category  = 'Music'\n group by rollup (i_item_id, s_state)\n order by i_item_id\n         ,s_state\n limit 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Isolate date_dim filter into a CTE returning only d_date_sk, then join with store_sales early to push date_sk range."
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: 000904 (42000): 01c27ccc-3205-67d4-0002-fcfe00024f96: SQL compilation error: error line 21 at position 11\ninvalid identifier 'SS_QUANTITY'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_sales_agg AS (SELECT ss_item_sk,\n       ss_store_sk,\n       ss_cdemo_sk,\n       ss_sold_date_sk,\n       SUM(ss_quantity) AS sum_ss_quantity,\n       COUNT(ss_quantity) AS count_ss_quantity,\n       SUM(ss_list_price) AS sum_ss_list_price,\n       COUNT(ss_list_price) AS count_ss_list_price,\n       SUM(ss_coupon_amt) AS sum_ss_coupon_amt,\n       COUNT(ss_coupon_amt) AS count_ss_coupon_amt,\n       SUM(ss_sales_price) AS sum_ss_sales_price,\n       COUNT(ss_sales_price) AS count_ss_sales_price\nFROM store_sales\nWHERE ss_sold_date_sk IS NOT NULL\n  AND ss_cdemo_sk IS NOT NULL\n  AND ss_store_sk IS NOT NULL\n  AND ss_item_sk IS NOT NULL\nGROUP BY ss_item_sk, ss_store_sk, ss_cdemo_sk, ss_sold_date_sk) SELECT i_item_id,\n       s_state,\n       grouping(s_state) g_state,\n       avg(ss_quantity) agg1,\n       avg(ss_list_price) agg2,\n       avg(ss_coupon_amt) agg3,\n       avg(ss_sales_price) agg4\nFROM store_sales_agg ssa\nJOIN date_dim d ON ssa.ss_sold_date_sk = d.d_date_sk\nJOIN customer_demographics cd ON ssa.ss_cdemo_sk = cd.cd_demo_sk\nJOIN store s ON ssa.ss_store_sk = s.s_store_sk\nJOIN item i ON ssa.ss_item_sk = i.i_item_sk\nWHERE cd_gender = 'M'\n  AND cd_marital_status = 'W'\n  AND cd_education_status = 'Secondary'\n  AND d_year = 1999\n  AND s_state = 'OH'\n  AND i_category = 'Music'\nGROUP BY ROLLUP (i_item_id, s_state)\nORDER BY i_item_id, s_state\nLIMIT 100;",
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "compile_p2",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "REGRESSION",
      "speedup": 0.84,
      "semantic_passed": true,
      "error": null,
      "original_ms": 168.4,
      "patch_ms": 200.5,
      "output_sql": "WITH date_dim_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), customer_demographics_filtered AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'W' AND cd_education_status = 'Secondary'), store_filtered AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'OH'), item_filtered AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music') SELECT i_item_id,\n       s_state,\n       grouping(s_state) g_state,\n       avg(ss_quantity) agg1,\n       avg(ss_list_price) agg2,\n       avg(ss_coupon_amt) agg3,\n       avg(ss_sales_price) agg4\nFROM store_sales ss\nJOIN date_dim_filtered d ON ss.ss_sold_date_sk = d.d_date_sk\nJOIN customer_demographics_filtered cd ON ss.ss_cdemo_sk = cd.cd_demo_sk\nJOIN store_filtered s ON ss.ss_store_sk = s.s_store_sk\nJOIN item_filtered i ON ss.ss_item_sk = i.i_item_sk\nGROUP BY ROLLUP (i_item_id, s_state)\nORDER BY i_item_id, s_state\nLIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_agg_pushdown",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "REGRESSION",
      "speedup": 0.85,
      "semantic_passed": true,
      "error": null,
      "original_ms": 168.4,
      "patch_ms": 198.6,
      "output_sql": "WITH store_sales_agg AS (\n    SELECT\n        ss_item_sk,\n        ss_store_sk,\n        ss_cdemo_sk,\n        ss_sold_date_sk,\n        SUM(ss_quantity) AS sum_qty,\n        COUNT(ss_quantity) AS cnt_qty,\n        SUM(ss_list_price) AS sum_price,\n        COUNT(ss_list_price) AS cnt_price,\n        SUM(ss_coupon_amt) AS sum_coupon,\n        COUNT(ss_coupon_amt) AS cnt_coupon,\n        SUM(ss_sales_price) AS sum_sales,\n        COUNT(ss_sales_price) AS cnt_sales\n    FROM store_sales\n    WHERE ss_sold_date_sk IS NOT NULL\n      AND ss_cdemo_sk IS NOT NULL\n      AND ss_store_sk IS NOT NULL\n    GROUP BY ss_item_sk, ss_store_sk, ss_cdemo_sk, ss_sold_date_sk\n)\nSELECT\n    i_item_id,\n    s_state,\n    GROUPING(s_state) AS g_state,\n    SUM(sum_qty) / SUM(cnt_qty) AS agg1,\n    SUM(sum_price) / SUM(cnt_price) AS agg2,\n    SUM(sum_coupon) / SUM(cnt_coupon) AS agg3,\n    SUM(sum_sales) / SUM(cnt_sales) AS agg4\nFROM store_sales_agg\nJOIN date_dim ON ss_sold_date_sk = d_date_sk\nJOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk\nJOIN store ON ss_store_sk = s_store_sk\nJOIN item ON ss_item_sk = i_item_sk\nWHERE cd_gender = 'M'\n  AND cd_marital_status = 'W'\n  AND cd_education_status = 'Secondary'\n  AND d_year = 1999\n  AND s_state = 'OH'\n  AND i_category = 'Music'\nGROUP BY ROLLUP (i_item_id, s_state)\nORDER BY i_item_id, s_state\nLIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_dimension_prefilter",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "REGRESSION",
      "speedup": 0.85,
      "semantic_passed": true,
      "error": null,
      "original_ms": 168.4,
      "patch_ms": 198.3,
      "output_sql": "WITH date_dim_filtered AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_year = 1999\n),\ncustomer_demographics_filtered AS (\n    SELECT cd_demo_sk\n    FROM customer_demographics\n    WHERE cd_gender = 'M'\n      AND cd_marital_status = 'W'\n      AND cd_education_status = 'Secondary'\n),\nstore_filtered AS (\n    SELECT s_store_sk, s_state\n    FROM store\n    WHERE s_state = 'OH'\n),\nitem_filtered AS (\n    SELECT i_item_sk, i_item_id\n    FROM item\n    WHERE i_category = 'Music'\n)\nSELECT\n    i_item_id,\n    s_state,\n    GROUPING(s_state) AS g_state,\n    AVG(ss_quantity) AS agg1,\n    AVG(ss_list_price) AS agg2,\n    AVG(ss_coupon_amt) AS agg3,\n    AVG(ss_sales_price) AS agg4\nFROM store_sales\nJOIN date_dim_filtered d ON ss_sold_date_sk = d.d_date_sk\nJOIN customer_demographics_filtered cd ON ss_cdemo_sk = cd.cd_demo_sk\nJOIN store_filtered s ON ss_store_sk = s.s_store_sk\nJOIN item_filtered i ON ss_item_sk = i.i_item_sk\nGROUP BY ROLLUP (i_item_id, s_state)\nORDER BY i_item_id, s_state\nLIMIT 100;",
      "has_explain": true,
      "description": null
    }
  ],
  "explains": {
    "p03": "GlobalStats | 72723 | 70417 | 1212661790720\n1 | 0 | Result | ITEM.I_ITEM_ID, STORE.S_STATE, GROUPING_ID(STORE.S_STATE), SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(STORE_SALES.SS_QUANTITY, COUNT(*))), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(STORE_SALES.SS_QUANTITY, COUNT(*))), COUNT(*)))), (SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(STORE_SALES.SS_LIST_PRICE, COUNT(*))), COUNT(*)))) / (COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(STORE_SALES.SS_LIST_PRICE, COUNT(*))), COUNT(*))))",
    "p02": "GlobalStats | 72723 | 70417 | 1212661790720\n1 | 0 | Result | ITEM.I_ITEM_ID, STORE.S_STATE, GROUPING_ID(STORE.S_STATE), SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(STORE_SALES.SS_QUANTITY, COUNT(*))), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(STORE_SALES.SS_QUANTITY, COUNT(*))), COUNT(*)))), (SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(STORE_SALES.SS_LIST_PRICE, COUNT(*))), COUNT(*)))) / (COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(STORE_SALES.SS_LIST_PRICE, COUNT(*))), COUNT(*))))",
    "p01": "GlobalStats | 72723 | 70417 | 1212661790720\n1 | 0 | Result | ITEM.I_ITEM_ID, STORE.S_STATE, GROUPING_ID(STORE.S_STATE), SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(STORE_SALES.SS_QUANTITY, COUNT(*))), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(STORE_SALES.SS_QUANTITY, COUNT(*))), COUNT(*)))), (SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(STORE_SALES.SS_LIST_PRICE, COUNT(*))), COUNT(*)))) / (COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(STORE_SALES.SS_LIST_PRICE, COUNT(*))), COUNT(*))))",
    "compile_p2": "GlobalStats | 72723 | 70417 | 1212661790720\n1 | 0 | Result | ITEM.I_ITEM_ID, STORE.S_STATE, GROUPING_ID(STORE.S_STATE), SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(SS.SS_QUANTITY, COUNT(*))), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(SS.SS_QUANTITY, COUNT(*))), COUNT(*)))), (SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(SS.SS_LIST_PRICE, COUNT(*))), COUNT(*)))) / (COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(SS.SS_LIST_PRICE, COUNT(*))), COUNT(*)))), (SUM(SUM_INTERNAL(SUM(SUM_INTERNAL",
    "compile_agg_pushdown": "GlobalStats | 72723 | 70417 | 1212661790720\n1 | 0 | Result | ITEM.I_ITEM_ID, STORE.S_STATE, GROUPING_ID(STORE.S_STATE), SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_QUANTITY))), COUNT(*))), COUNT(*))), SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(SUM(SUM(COUNT(STORE_SALES.SS_QUANTITY))), COUNT(*))), COUNT(*)))), (SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_LIST_PRICE))), COUNT(*))), COUNT(*)))) / (SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(SUM(SUM(COUNT(STORE",
    "compile_dimension_prefilter": "GlobalStats | 72723 | 70417 | 1212661790720\n1 | 0 | Result | ITEM.I_ITEM_ID, STORE.S_STATE, GROUPING_ID(STORE.S_STATE), SCALED_ROUND_INT_DIVIDE(SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(STORE_SALES.SS_QUANTITY, COUNT(*))), COUNT(*))), COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(STORE_SALES.SS_QUANTITY, COUNT(*))), COUNT(*)))), (SUM(SUM_INTERNAL(SUM(SUM_INTERNAL(STORE_SALES.SS_LIST_PRICE, COUNT(*))), COUNT(*)))) / (COUNT(COUNT_INTERNAL(COUNT(COUNT_INTERNAL(STORE_SALES.SS_LIST_PRICE, COUNT(*))), COUNT(*))))"
  }
}