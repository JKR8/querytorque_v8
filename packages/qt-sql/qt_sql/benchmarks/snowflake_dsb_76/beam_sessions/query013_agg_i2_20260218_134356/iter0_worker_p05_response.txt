{
  "probe_id": "scout_1",
  "transform_id": "multi_dimension_prefetch",
  "family": "A",
  "status": "success",
  "dialect": "snowflake",
  "hypothesis": "Pre-filtering all dimension tables into a single CTE reduces the number of join conditions on STORE_SALES and enables better partition pruning.",
  "reasoning_trace": [
    "Assigned transform targets prefetching of filtered dimension keys to reduce fact table scan.",
    "All required dimension filters are preserved in new CTE.",
    "Join graph simplified by replacing multiple dimension joins with one prefetch join.",
    "Output semantics preserved through equivalent filter and join logic."
  ],
  "target_ir": "Dimension filters consolidated into one prefetch CTE; fact scan now joins once with prefetch.",
  "verification": {
    "executable": true,
    "no_missing_tables": true,
    "alias_consistent": true,
    "no_orphan_scans": true,
    "semantics_preserved": true,
    "null_semantics_safe": true,
    "ctes_selective_or_na": true
  },
  "tree": {
    "root_node_id": "final_select",
    "nodes": [
      {
        "node_id": "final_select",
        "parent_node_id": null,
        "sources": ["prefetch_dimensions", "store_sales"],
        "outputs": ["AVG(ss_quantity)", "AVG(ss_ext_sales_price)", "AVG(ss_ext_wholesale_cost)", "SUM(ss_ext_wholesale_cost)"],
        "changed": true,
        "sql": "SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM store_sales ss JOIN prefetch_dimensions pd ON ss.ss_cdemo_sk = pd.cd_demo_sk AND ss.ss_hdemo_sk = pd.hd_demo_sk AND ss.ss_addr_sk = pd.ca_address_sk AND ss.ss_sold_date_sk = pd.d_date_sk"
      },
      {
        "node_id": "prefetch_dimensions",
        "parent_node_id": "final_select",
        "sources": ["customer_demographics", "household_demographics", "customer_address", "date_dim"],
        "outputs": ["cd_demo_sk", "hd_demo_sk", "ca_address_sk", "d_date_sk"],
        "changed": true,
        "sql": "SELECT cd.cd_demo_sk, hd.hd_demo_sk, ca.ca_address_sk, d.d_date_sk FROM customer_demographics cd, household_demographics hd, customer_address ca, date_dim d WHERE ((cd.cd_marital_status = 'M' AND cd.cd_education_status = '2 yr Degree' AND hd.hd_dep_count = 3) OR (cd.cd_marital_status = 'S' AND cd.cd_education_status = 'Primary' AND hd.hd_dep_count = 1) OR (cd.cd_marital_status = 'W' AND cd.cd_education_status = 'Primary' AND hd.hd_dep_count = 1)) AND ((ca.ca_country = 'United States' AND ca.ca_state IN ('GA', 'KY', 'SD') AND ss_net_profit BETWEEN 100 AND 200) OR (ca.ca_country = 'United States' AND ca.ca_state IN ('AR', 'IN', 'VA') AND ss_net_profit BETWEEN 150 AND 300) OR (ca.ca_country = 'United States' AND ca.ca_state IN ('KS', 'OH', 'SD') AND ss_net_profit BETWEEN 50 AND 250)) AND d.d_year = 2001"
      }
    ]
  }
}