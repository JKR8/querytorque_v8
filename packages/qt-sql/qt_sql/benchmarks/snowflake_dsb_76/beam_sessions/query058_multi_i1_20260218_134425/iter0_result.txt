{
  "iteration": 0,
  "n_api_calls": 11,
  "beam_cost_usd": 0.03587218,
  "beam_cost_priced_calls": 11,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 112484,
    "completion_tokens": 30462,
    "total_tokens": 142946,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 49472,
    "reasoning_tokens": 16354
  },
  "best_speedup": 1.15,
  "best_patch_id": "compile_p1",
  "best_sql": "WITH item_filter AS (SELECT i_item_sk, i_item_id FROM item WHERE i_manager_id BETWEEN 71 AND 100), customer_filter AS (SELECT c_customer_sk, c_birth_year FROM customer WHERE c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales, item_filter, date_dim, customer_filter WHERE ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ss_list_price BETWEEN 242 AND 271 AND ss_customer_sk = c_customer_sk GROUP BY i_item_id, c_birth_year), cs_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales, item_filter, date_dim, customer_filter WHERE cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND cs_list_price BETWEEN 242 AND 271 AND cs_bill_customer_sk = c_customer_sk GROUP BY i_item_id, c_birth_year), ws_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales, item_filter, date_dim, customer_filter WHERE ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ws_list_price BETWEEN 242 AND 271 AND ws_bill_customer_sk = c_customer_sk GROUP BY i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
  "patches": [
    {
      "patch_id": "p04",
      "family": "E",
      "transform": "materialize_cte",
      "relevance_score": 0.7,
      "status": "REGRESSION",
      "speedup": 0.87,
      "semantic_passed": true,
      "error": null,
      "original_ms": 154.0,
      "patch_ms": 177.8,
      "output_sql": "WITH date_sk_filter AS (select d_date_sk, d_date\n  from date_dim\n  where d_month_seq = (select d_month_seq\n                      from date_dim\n                      where d_date = '1998-05-19')), ss_items AS (select i_item_id item_id\n     ,c_birth_year birth_year\n      ,sum(ss_ext_sales_price) ss_item_rev\nfrom store_sales\n    ,item\n    ,date_sk_filter\n    ,customer\nwhere ss_item_sk = i_item_sk\n  and d_date in (select d_date from date_sk_filter)\n  and ss_sold_date_sk   = d_date_sk\n  and ss_list_price between 242 and 271\n  and i_manager_id BETWEEN 71 and 100\n  and ss_customer_sk = c_customer_sk\n  and c_birth_year BETWEEN 1945 AND 1951\ngroup by i_item_id, c_birth_year), cs_items AS (select i_item_id item_id\n     ,c_birth_year birth_year\n       ,sum(cs_ext_sales_price) cs_item_rev\nfrom catalog_sales\n    ,item\n    ,date_sk_filter\n    ,customer\nwhere cs_item_sk = i_item_sk\n and  d_date in (select d_date from date_sk_filter)\n and  cs_sold_date_sk = d_date_sk\n and  cs_list_price between 242 and 271\n and i_manager_id BETWEEN 71 and 100\n and cs_bill_customer_sk = c_customer_sk\n and c_birth_year BETWEEN 1945 AND 1951\ngroup by i_item_id, c_birth_year), ws_items AS (select i_item_id item_id\n     ,c_birth_year birth_year\n       ,sum(ws_ext_sales_price) ws_item_rev\nfrom web_sales\n    ,item\n    ,date_sk_filter\n    ,customer\nwhere ws_item_sk = i_item_sk\n and  d_date in (select d_date from date_sk_filter)\n and ws_sold_date_sk   = d_date_sk\n and ws_list_price between 242 and 271\n and i_manager_id BETWEEN 71 and 100\n and ws_bill_customer_sk = c_customer_sk\n and c_birth_year BETWEEN 1945 AND 1951\ngroup by i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Materialize the date_dim subquery result (list of date_sk) into a CTE to avoid recomputing it three times."
    },
    {
      "patch_id": "p01",
      "family": "A",
      "transform": "sf_sk_pushdown_multi_fact",
      "relevance_score": 0.85,
      "status": "REGRESSION",
      "speedup": 0.91,
      "semantic_passed": true,
      "error": null,
      "original_ms": 154.0,
      "patch_ms": 169.6,
      "output_sql": "WITH date_sk_filter AS (select d_date_sk date_sk\n  from date_dim\n  where d_month_seq = (\n    select d_month_seq\n    from date_dim\n    where d_date = '1998-05-19'\n  )), ss_items AS (select i_item_id item_id\n       ,c_birth_year birth_year\n        ,sum(ss_ext_sales_price) ss_item_rev\n from store_sales\n     ,item\n     ,date_dim\n     ,customer\n     ,date_sk_filter\n where ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_date_sk in (select date_sk from date_sk_filter)\n   and ss_list_price between 242 and 271\n   and i_manager_id BETWEEN 71 and 100\n   and ss_customer_sk = c_customer_sk\n   and c_birth_year BETWEEN 1945 AND 1951\ngroup by i_item_id, c_birth_year), cs_items AS (select i_item_id item_id\n        ,c_birth_year birth_year\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n      ,customer\n      ,date_sk_filter\n where cs_item_sk = i_item_sk\n  and cs_sold_date_sk = d_date_sk\n  and d_date_sk in (select date_sk from date_sk_filter)\n  and cs_list_price between 242 and 271\n  and i_manager_id BETWEEN 71 and 100\n  and cs_bill_customer_sk = c_customer_sk\n  and c_birth_year BETWEEN 1945 AND 1951\ngroup by i_item_id, c_birth_year), ws_items AS (select i_item_id item_id\n      ,c_birth_year birth_year\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n      ,customer\n      ,date_sk_filter\n where ws_item_sk = i_item_sk\n  and ws_sold_date_sk = d_date_sk\n  and d_date_sk in (select date_sk from date_sk_filter)\n  and ws_list_price between 242 and 271\n  and i_manager_id BETWEEN 71 and 100\n  and ws_bill_customer_sk = c_customer_sk\n  and c_birth_year BETWEEN 1945 AND 1951\ngroup by i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Precompute date_sk keys for the month_seq in a CTE, then add explicit date_sk BETWEEN or IN list to each fact table join condition to enable micro-partition pruning."
    },
    {
      "patch_id": "p03",
      "family": "C",
      "transform": "channel_bitmap_aggregation",
      "relevance_score": 0.5,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Row count: orig=0, patch=100",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH ss_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(CASE WHEN ss.ss_list_price BETWEEN 242 AND 271 THEN ss.ss_ext_sales_price ELSE 0 END) AS ss_item_rev FROM store_sales ss JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951 GROUP BY i_item_id, c_birth_year), cs_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(CASE WHEN cs.cs_list_price BETWEEN 242 AND 271 THEN cs.cs_ext_sales_price ELSE 0 END) AS cs_item_rev FROM catalog_sales cs JOIN item i ON cs.cs_item_sk = i.i_item_sk JOIN date_dim d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951 GROUP BY i_item_id, c_birth_year), ws_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(CASE WHEN ws.ws_list_price BETWEEN 242 AND 271 THEN ws.ws_ext_sales_price ELSE 0 END) AS ws_item_rev FROM web_sales ws JOIN item i ON ws.ws_item_sk = i.i_item_sk JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND i.i_manager_id BETWEEN 71 AND 100 AND c.c_birth_year BETWEEN 1945 AND 1951 GROUP BY i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, CASE WHEN ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) = 0 THEN NULL ELSE ss_item_rev / NULLIF(((ss_item_rev + cs_item_rev + ws_item_rev) / 3), 0) * 100 END AS ss_dev, cs_item_rev, CASE WHEN ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) = 0 THEN NULL ELSE cs_item_rev / NULLIF(((ss_item_rev + cs_item_rev + ws_item_rev) / 3), 0) * 100 END AS cs_dev, ws_item_rev, CASE WHEN ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) = 0 THEN NULL ELSE ws_item_rev / NULLIF(((ss_item_rev + cs_item_rev + ws_item_rev) / 3), 0) * 100 END AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Consolidate the three CTEs into a single scan per fact table with conditional aggregation, then union and group by item_id, birth_year, and channel indicator."
    },
    {
      "patch_id": "p02",
      "family": "A",
      "transform": "dimension_cte_isolate",
      "relevance_score": 0.55,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: 000904 (42000): 01c27c69-3205-67d8-0002-fcfe000211ee: SQL compilation error: error line 1 at position 226\ninvalid identifier 'I_ITEM_ID'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH item_sk_filter AS (select i_item_sk from item where i_manager_id between 71 and 100), customer_sk_filter AS (select c_customer_sk, c_birth_year from customer where c_birth_year between 1945 and 1951), ss_items AS (select i_item_id item_id\n     ,c_birth_year birth_year\n      ,sum(ss_ext_sales_price) ss_item_rev\nfrom store_sales\n    ,item_sk_filter\n    ,date_dim\n    ,customer_sk_filter\nwhere ss_item_sk = i_item_sk\n  and d_date in (select d_date\n                 from date_dim\n                 where d_month_seq = (select d_month_seq\n                                     from date_dim\n                                     where d_date = '1998-05-19'))\n  and ss_sold_date_sk   = d_date_sk\n  and ss_list_price between 242 and 271\n  and ss_customer_sk = c_customer_sk\ngroup by i_item_id, c_birth_year), cs_items AS (select i_item_id item_id\n       ,c_birth_year birth_year\n       ,sum(cs_ext_sales_price) cs_item_rev\nfrom catalog_sales\n    ,item_sk_filter\n    ,date_dim\n    ,customer_sk_filter\nwhere cs_item_sk = i_item_sk\n and  d_date in (select d_date\n                 from date_dim\n                 where d_month_seq = (select d_month_seq\n                                     from date_dim\n                                     where d_date = '1998-05-19'))\n and  cs_sold_date_sk = d_date_sk\n and  cs_list_price between 242 and 271\n and cs_bill_customer_sk = c_customer_sk\ngroup by i_item_id, c_birth_year), ws_items AS (select i_item_id item_id\n     ,c_birth_year birth_year\n       ,sum(ws_ext_sales_price) ws_item_rev\nfrom web_sales\n    ,item_sk_filter\n    ,date_dim\n    ,customer_sk_filter\nwhere ws_item_sk = i_item_sk\n and  d_date in (select d_date\n                 from date_dim\n                 where d_month_seq = (select d_month_seq\n                                    from date_dim\n                                    where d_date = '1998-05-19'))\n and ws_sold_date_sk   = d_date_sk\n and ws_list_price between 242 and 271\n and ws_bill_customer_sk = c_customer_sk\ngroup by i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Pre-filter item and customer tables into separate CTEs returning only surrogate keys (i_item_sk, c_customer_sk) that meet the manager_id and birth_year filters, then join these CTEs to each fact table."
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Node `item_filter` missing parent_node_id",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": null,
      "has_explain": false,
      "description": null
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "WIN",
      "speedup": 1.15,
      "semantic_passed": true,
      "error": null,
      "original_ms": 231.6,
      "patch_ms": 201.3,
      "output_sql": "WITH item_filter AS (SELECT i_item_sk, i_item_id FROM item WHERE i_manager_id BETWEEN 71 AND 100), customer_filter AS (SELECT c_customer_sk, c_birth_year FROM customer WHERE c_birth_year BETWEEN 1945 AND 1951), ss_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales, item_filter, date_dim, customer_filter WHERE ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ss_list_price BETWEEN 242 AND 271 AND ss_customer_sk = c_customer_sk GROUP BY i_item_id, c_birth_year), cs_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales, item_filter, date_dim, customer_filter WHERE cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND cs_list_price BETWEEN 242 AND 271 AND cs_bill_customer_sk = c_customer_sk GROUP BY i_item_id, c_birth_year), ws_items AS (SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales, item_filter, date_dim, customer_filter WHERE ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1998-05-19')) AND ws_list_price BETWEEN 242 AND 271 AND ws_bill_customer_sk = c_customer_sk GROUP BY i_item_id, c_birth_year) SELECT ss_items.item_id, ss_items.birth_year, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_items.birth_year = cs_items.birth_year AND ss_items.birth_year = ws_items.birth_year AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY item_id, birth_year, ss_item_rev LIMIT 100;",
      "has_explain": true,
      "description": null
    }
  ],
  "explains": {
    "p04": "GlobalStats | 1 | 1 | 2138624\n1 | 0 | Result | DATE_DIM.D_MONTH_SEQ\n1 | 3 | [2] | Filter | DATE_DIM.D_DATE = '1998-05-19'\n1 | 4 | [3] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE, D_MONTH_SEQ | 1 | 1 | 2138624\n2 | 0 | Result | ITEM.I_ITEM_ID, CUSTOMER.C_BIRTH_YEAR, SUM(STORE_SALES.SS_EXT_SALES_PRICE), (SCALED_ROUND_INT_DIVIDE(SUM(STORE_SALES.SS_EXT_SALES_PRICE), (((SUM(STORE_SALES.SS_EXT_SALES_PRICE)) + (SUM(CATALOG_SALES.CS_EXT_SALES_PRICE))) + (SUM(WEB_SALES.WS_EXT_SALES",
    "p01": "GlobalStats | 1 | 1 | 2138624\n1 | 0 | Result | DATE_DIM.D_MONTH_SEQ\n1 | 3 | [2] | Filter | DATE_DIM.D_DATE = '1998-05-19'\n1 | 4 | [3] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE, D_MONTH_SEQ | 1 | 1 | 2138624\n2 | 0 | Result | ITEM.I_ITEM_ID, CUSTOMER.C_BIRTH_YEAR, SUM(STORE_SALES.SS_EXT_SALES_PRICE), (SCALED_ROUND_INT_DIVIDE(SUM(STORE_SALES.SS_EXT_SALES_PRICE), (((SUM(STORE_SALES.SS_EXT_SALES_PRICE)) + (SUM(CATALOG_SALES.CS_EXT_SALES_PRICE))) + (SUM(WEB_SALES.WS_EXT_SALES",
    "compile_p1": "GlobalStats | 1 | 1 | 2138624\n1 | 0 | Result | DATE_DIM.D_MONTH_SEQ\n1 | 3 | [2] | Filter | DATE_DIM.D_DATE = '1998-05-19'\n1 | 4 | [3] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE, D_MONTH_SEQ | 1 | 1 | 2138624\n2 | 0 | Result | ITEM_FILTER.I_ITEM_ID, CUSTOMER_FILTER.C_BIRTH_YEAR, SUM(STORE_SALES.SS_EXT_SALES_PRICE), (SCALED_ROUND_INT_DIVIDE(SUM(STORE_SALES.SS_EXT_SALES_PRICE), (((SUM(STORE_SALES.SS_EXT_SALES_PRICE)) + (SUM(CATALOG_SALES.CS_EXT_SALES_PRICE))) + (SUM(WEB_SALE"
  }
}