{
  "iteration": 0,
  "n_api_calls": 7,
  "beam_cost_usd": 0.0,
  "beam_cost_priced_calls": 0,
  "beam_cost_unpriced_calls": 7,
  "beam_token_totals": {
    "prompt_tokens": 0,
    "completion_tokens": 0,
    "total_tokens": 0,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 0,
    "reasoning_tokens": 0
  },
  "best_speedup": 1.19,
  "best_patch_id": "p11",
  "best_sql": "SELECT MIN(ss_quantity), MIN(ss_ext_sales_price), MIN(ss_ext_wholesale_cost), MIN(ss_ext_wholesale_cost) FROM store_sales INNER JOIN store ON s_store_sk = ss_store_sk INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk INNER JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk INNER JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk INNER JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE d_year = 2001 AND ((cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (cd_marital_status = 'S' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (cd_marital_status = 'W' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD') AND ss_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'IN', 'VA') AND ss_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'SD') AND ss_net_profit BETWEEN 50 AND 250));",
  "patches": [
    {
      "patch_id": "p08",
      "family": "A",
      "transform": "prefetch_fact_join",
      "relevance_score": 0.52,
      "status": "REGRESSION",
      "speedup": 0.87,
      "semantic_passed": true,
      "error": null,
      "original_ms": 176.4,
      "patch_ms": 202.0,
      "output_sql": "WITH reduced_store_sales AS (WITH filtered_date_dim AS (\n  SELECT d_date_sk\n  FROM date_dim\n  WHERE d_year = 2001\n),\nfiltered_store_sales AS (\n  SELECT ss.*\n  FROM store_sales ss\n  JOIN filtered_date_dim fdd ON ss.ss_sold_date_sk = fdd.d_date_sk\n)\nSELECT\n  MIN(ss.ss_quantity) AS min_ss_quantity,\n  MIN(ss.ss_ext_sales_price) AS min_ss_ext_sales_price,\n  MIN(ss.ss_ext_wholesale_cost) AS min_ss_ext_wholesale_cost\nFROM filtered_store_sales ss\nJOIN store s ON s.s_store_sk = ss.ss_store_sk\nJOIN customer_demographics cd ON cd.cd_demo_sk = ss.ss_cdemo_sk\nJOIN household_demographics hd ON hd.hd_demo_sk = ss.ss_hdemo_sk\nJOIN customer_address ca ON ca.ca_address_sk = ss.ss_addr_sk\nWHERE (\n  (hd.hd_demo_sk = ss.ss_hdemo_sk AND cd.cd_demo_sk = ss.ss_cdemo_sk AND cd.cd_marital_status = 'M' AND cd.cd_education_status = '2 yr Degree' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND hd.hd_dep_count = 3)\n  OR\n  (hd.hd_demo_sk = ss.ss_hdemo_sk AND cd.cd_demo_sk = ss.ss_cdemo_sk AND cd.cd_marital_status = 'S' AND cd.cd_education_status = 'Primary' AND ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND hd.hd_dep_count = 1)\n  OR\n  (hd.hd_demo_sk = ss.ss_hdemo_sk AND cd.cd_demo_sk = ss.ss_cdemo_sk AND cd.cd_marital_status = 'W' AND cd.cd_education_status = 'Primary' AND ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND hd.hd_dep_count = 1)\n)\nAND (\n  (ca.ca_address_sk = ss.ss_addr_sk AND ca.ca_country = 'United States' AND ca.ca_state IN ('GA', 'KY', 'SD') AND ss.ss_net_profit BETWEEN 100 AND 200)\n  OR\n  (ca.ca_address_sk = ss.ss_addr_sk AND ca.ca_country = 'United States' AND ca.ca_state IN ('AR', 'IN', 'VA') AND ss.ss_net_profit BETWEEN 150 AND 300)\n  OR\n  (ca.ca_address_sk = ss.ss_addr_sk AND ca.ca_country = 'United States' AND ca.ca_state IN ('KS', 'OH', 'SD') AND ss.ss_net_profit BETWEEN 50 AND 250)\n)) select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('GA', 'KY', 'SD')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'IN', 'VA')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('KS', 'OH', 'SD')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Build CTE chain: filtered date_dim \u2192 filtered store_sales \u2192 filtered customer_demographics/household_demographics \u2192 filtered customer_address, progressively reducing data."
    },
    {
      "patch_id": "p06",
      "family": "A",
      "transform": "sf_sk_pushdown_union_all",
      "relevance_score": 0.7,
      "status": "WIN",
      "speedup": 1.18,
      "semantic_passed": true,
      "error": null,
      "original_ms": 176.4,
      "patch_ms": 150.0,
      "output_sql": "select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('GA', 'KY', 'SD')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'IN', 'VA')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('KS', 'OH', 'SD')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Apply date_sk BETWEEN pushdown within each UNION ALL branch if OR split is performed (probe p02)."
    },
    {
      "patch_id": "p05",
      "family": "A",
      "transform": "multi_dimension_prefetch",
      "relevance_score": 0.55,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Retry failed: Missing `tree` object",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH dimension_prefetch AS (WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), cd_filtered AS (SELECT cd_demo_sk FROM customer_demographics WHERE (cd_marital_status = 'M' AND cd_education_status = '2 yr Degree') OR (cd_marital_status = 'S' AND cd_education_status = 'Primary') OR (cd_marital_status = 'W' AND cd_education_status = 'Primary')), hd_filtered AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count IN (1, 3)), ca_filtered AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD', 'AR', 'IN', 'VA', 'KS', 'OH')), s_filtered AS (SELECT s_store_sk FROM store) SELECT d_date_sk, cd_demo_sk, hd_demo_sk, ca_address_sk, s_store_sk FROM date_filtered, cd_filtered, hd_filtered, ca_filtered, s_filtered) SELECT MIN(ss_quantity), MIN(ss_ext_sales_price), MIN(ss_ext_wholesale_cost), MIN(ss_ext_wholesale_cost) FROM store_sales JOIN dimension_prefetch ON ss_sold_date_sk = d_date_sk AND ss_cdemo_sk = cd_demo_sk AND ss_hdemo_sk = hd_demo_sk AND ss_addr_sk = ca_address_sk AND ss_store_sk = s_store_sk;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Create a single CTE that pre\u2011joins all filtered dimensions (date_dim, customer_demographics, household_demographics, customer_address, store) into a composite key set, then join once to store_sales."
    },
    {
      "patch_id": "p09",
      "family": "E",
      "transform": "materialize_cte",
      "relevance_score": 0.45,
      "status": "NEUTRAL",
      "speedup": 1.0,
      "semantic_passed": true,
      "error": null,
      "original_ms": 176.4,
      "patch_ms": 175.6,
      "output_sql": "WITH filtered_store_sales AS (SELECT ss_sold_date_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_quantity, ss_sales_price, ss_ext_sales_price, ss_ext_wholesale_cost, ss_net_profit FROM store_sales WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_year = 2001) AND ((ss_hdemo_sk IN (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 3) AND ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = '2 yr Degree') AND ss_sales_price BETWEEN 100.00 AND 150.00) OR (ss_hdemo_sk IN (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 1) AND ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'Primary') AND ss_sales_price BETWEEN 50.00 AND 100.00) OR (ss_hdemo_sk IN (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 1) AND ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'W' AND cd_education_status = 'Primary') AND ss_sales_price BETWEEN 150.00 AND 200.00)) AND ((ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD')) AND ss_net_profit BETWEEN 100 AND 200) OR (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('AR', 'IN', 'VA')) AND ss_net_profit BETWEEN 150 AND 300) OR (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'SD')) AND ss_net_profit BETWEEN 50 AND 250))) select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('GA', 'KY', 'SD')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'IN', 'VA')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('KS', 'OH', 'SD')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Materialize the filtered store_sales with date_sk range and OR conditions into a CTE, then join dimensions."
    },
    {
      "patch_id": "p03",
      "family": "C",
      "transform": "aggregate_pushdown",
      "relevance_score": 0.8,
      "status": "WIN",
      "speedup": 1.1,
      "semantic_passed": true,
      "error": null,
      "original_ms": 176.4,
      "patch_ms": 159.8,
      "output_sql": "WITH preagg_store_sales AS (SELECT ss_store_sk, ss_cdemo_sk, ss_hdemo_sk, ss_sold_date_sk, ss_addr_sk, MIN(ss_quantity) AS ss_quantity, MIN(ss_ext_sales_price) AS ss_ext_sales_price, MIN(ss_ext_wholesale_cost) AS ss_ext_wholesale_cost FROM store_sales GROUP BY ss_store_sk, ss_cdemo_sk, ss_hdemo_sk, ss_sold_date_sk, ss_addr_sk) select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('GA', 'KY', 'SD')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'IN', 'VA')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('KS', 'OH', 'SD')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Pre\u2011aggregate store_sales by (ss_store_sk, ss_cdemo_sk, ss_hdemo_sk, ss_sold_date_sk, ss_addr_sk) before joining to dimensions, pushing MIN(ss_quantity), MIN(ss_ext_sales_price), MIN(ss_ext_wholesale_cost) down."
    },
    {
      "patch_id": "p04",
      "family": "A",
      "transform": "dimension_cte_isolate",
      "relevance_score": 0.6,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Retry failed: Missing `tree` object",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH store_sales_filtered AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_store_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_sold_date_sk FROM store_sales WHERE ss_store_sk IS NOT NULL AND ss_cdemo_sk IS NOT NULL AND ss_hdemo_sk IS NOT NULL AND ss_sold_date_sk IS NOT NULL AND ss_addr_sk IS NOT NULL), date_dim_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), customer_demographics_cte AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status IN ('M', 'S', 'W') AND cd_education_status IN ('2 yr Degree', 'Primary')), household_demographics_cte AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count IN (1, 3)), customer_address_cte AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD', 'AR', 'IN', 'VA', 'KS', 'OH')), store_cte AS (SELECT s_store_sk FROM store) SELECT MIN(ss_quantity), MIN(ss_ext_sales_price), MIN(ss_ext_wholesale_cost), MIN(ss_ext_wholesale_cost) FROM store_sales_filtered JOIN store_cte ON s_store_sk = ss_store_sk JOIN customer_demographics_cte ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics_cte ON hd_demo_sk = ss_hdemo_sk JOIN customer_address_cte ON ca_address_sk = ss_addr_sk JOIN date_dim_cte ON d_date_sk = ss_sold_date_sk;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Pre\u2011filter each dimension table into a CTE returning only surrogate keys, then join those CTEs to store_sales."
    },
    {
      "patch_id": "p12",
      "family": "C",
      "transform": "channel_bitmap_aggregation",
      "relevance_score": 0.48,
      "status": "DEDUP",
      "speedup": null,
      "semantic_passed": false,
      "error": null,
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('GA', 'KY', 'SD')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'IN', 'VA')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('KS', 'OH', 'SD')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Consolidate three OR branches into a single scan with CASE labels, compute MIN per branch via conditional aggregation."
    },
    {
      "patch_id": "p01",
      "family": "A",
      "transform": "sf_sk_pushdown_multi_fact",
      "relevance_score": 0.92,
      "status": "DEDUP",
      "speedup": null,
      "semantic_passed": false,
      "error": null,
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('GA', 'KY', 'SD')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'IN', 'VA')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('KS', 'OH', 'SD')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Add explicit ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_year=2001) AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_year=2001) to store_sales filter."
    },
    {
      "patch_id": "p10",
      "family": "C",
      "transform": "single_pass_aggregation",
      "relevance_score": 0.5,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Retry failed: Missing `tree` object",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": null,
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Consolidate nested aggregates into a single aggregate that computes MINs directly after the final join."
    },
    {
      "patch_id": "p02",
      "family": "D",
      "transform": "or_to_union",
      "relevance_score": 0.75,
      "status": "WIN",
      "speedup": 1.11,
      "semantic_passed": true,
      "error": null,
      "original_ms": 176.4,
      "patch_ms": 158.8,
      "output_sql": "WITH union_branches AS (SELECT MIN(ss_quantity) AS ss_quantity, MIN(ss_ext_sales_price) AS ss_ext_sales_price, MIN(ss_ext_wholesale_cost) AS ss_ext_wholesale_cost FROM (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2001 AND cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 AND ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD') AND ss_net_profit BETWEEN 100 AND 200 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2001 AND cd_marital_status = 'S' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('AR', 'IN', 'VA') AND ss_net_profit BETWEEN 150 AND 300 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2001 AND cd_marital_status = 'W' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'SD') AND ss_net_profit BETWEEN 50 AND 250) AS subquery) select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('GA', 'KY', 'SD')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'IN', 'VA')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('KS', 'OH', 'SD')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Split OR conditions into UNION ALL of three branches: (cd_marital_status='M' AND cd_education_status='2 yr Degree' AND ss_sales_price BETWEEN 100 AND 150 AND hd_dep_count=3) UNION ALL \u2026 etc. for each OR branch."
    },
    {
      "patch_id": "p07",
      "family": "A",
      "transform": "early_filter",
      "relevance_score": 0.58,
      "status": "DEDUP",
      "speedup": null,
      "semantic_passed": false,
      "error": null,
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('GA', 'KY', 'SD')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'IN', 'VA')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('KS', 'OH', 'SD')\n  and ss_net_profit between 50 and 250\n     ));",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Push customer_address and customer_demographics/household_demographics OR filters into separate CTEs that pre\u2011filter store_sales before the main join."
    },
    {
      "patch_id": "p11",
      "family": "F",
      "transform": "inner_join_conversion",
      "relevance_score": 0.4,
      "status": "WIN",
      "speedup": 1.19,
      "semantic_passed": true,
      "error": null,
      "original_ms": 176.4,
      "patch_ms": 148.6,
      "output_sql": "SELECT MIN(ss_quantity), MIN(ss_ext_sales_price), MIN(ss_ext_wholesale_cost), MIN(ss_ext_wholesale_cost) FROM store_sales INNER JOIN store ON s_store_sk = ss_store_sk INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk INNER JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk INNER JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk INNER JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE d_year = 2001 AND ((cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (cd_marital_status = 'S' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (cd_marital_status = 'W' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD') AND ss_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'IN', 'VA') AND ss_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'SD') AND ss_net_profit BETWEEN 50 AND 250));",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Convert comma\u2011separated FROM list to explicit INNER JOIN syntax with deterministic join order."
    }
  ],
  "explains": {
    "p08": "GlobalStats | 72978 | 70672 | 1213414464512\n1 | 0 | Result | MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST)))))))\n1 | 1 | [0] | Aggregate | aggExprs: [MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(M",
    "p06": "GlobalStats | 72978 | 70672 | 1213414464512\n1 | 0 | Result | MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST)))))))\n1 | 1 | [0] | Aggregate | aggExprs: [MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(M",
    "p09": "GlobalStats | 72978 | 70672 | 1213414464512\n1 | 0 | Result | MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST)))))))\n1 | 1 | [0] | Aggregate | aggExprs: [MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(M",
    "p03": "GlobalStats | 72978 | 70672 | 1213414464512\n1 | 0 | Result | MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST)))))))\n1 | 1 | [0] | Aggregate | aggExprs: [MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(M",
    "p02": "GlobalStats | 72978 | 70672 | 1213414464512\n1 | 0 | Result | MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST)))))))\n1 | 1 | [0] | Aggregate | aggExprs: [MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(M",
    "p11": "GlobalStats | 72978 | 70672 | 1213414464512\n1 | 0 | Result | MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_WHOLESALE_COST)))))))\n1 | 1 | [0] | Aggregate | aggExprs: [MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_QUANTITY))))))), MIN(MIN(MIN(MIN(MIN(MIN(MIN(STORE_SALES.SS_EXT_SALES_PRICE))))))), MIN(MIN(M"
  }
}