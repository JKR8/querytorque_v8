{
  "iteration": 0,
  "n_api_calls": 7,
  "beam_cost_usd": 0.02557562,
  "beam_cost_priced_calls": 7,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 87299,
    "completion_tokens": 17356,
    "total_tokens": 104655,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 23360,
    "reasoning_tokens": 7495
  },
  "best_speedup": 1.02,
  "best_patch_id": "p02",
  "best_sql": "WITH agg_store_sales AS (SELECT ss_customer_sk, ss_item_sk, ss_ticket_number, ss_store_sk, ss_sold_date_sk, SUM(ss_net_profit) AS net_profit FROM store_sales WHERE ss_sold_date_sk IS NOT NULL AND ss_store_sk IS NOT NULL AND ss_customer_sk IS NOT NULL GROUP BY ss_customer_sk, ss_item_sk, ss_ticket_number, ss_store_sk, ss_sold_date_sk), agg_store_returns AS (SELECT sr_customer_sk, sr_item_sk, sr_ticket_number, sr_returned_date_sk, SUM(sr_net_loss) AS sr_net_loss FROM store_returns WHERE sr_returned_date_sk IS NOT NULL AND sr_customer_sk IS NOT NULL GROUP BY sr_customer_sk, sr_item_sk, sr_ticket_number, sr_returned_date_sk), agg_catalog_sales AS (SELECT cs_bill_customer_sk, cs_item_sk, cs_sold_date_sk, SUM(cs_net_profit) AS net_profit FROM catalog_sales WHERE cs_sold_date_sk IS NOT NULL AND cs_bill_customer_sk IS NOT NULL GROUP BY cs_bill_customer_sk, cs_item_sk, cs_sold_date_sk) SELECT i_item_id, i_item_desc, s_store_id, s_store_name, stddev_samp(ss.net_profit) AS store_sales_profit, stddev_samp(sr.sr_net_loss) AS store_returns_loss, stddev_samp(cs.net_profit) AS catalog_sales_profit FROM agg_store_sales ss JOIN agg_store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN agg_catalog_sales cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk JOIN date_dim d1 ON d1.d_date_sk = ss.ss_sold_date_sk JOIN date_dim d2 ON d2.d_date_sk = sr.sr_returned_date_sk JOIN date_dim d3 ON d3.d_date_sk = cs.cs_sold_date_sk JOIN store s ON s.s_store_sk = ss.ss_store_sk JOIN item i ON i.i_item_sk = ss.ss_item_sk WHERE d1.d_moy = 2 AND d1.d_year = 2000 AND d2.d_moy BETWEEN 2 AND 4 AND d2.d_year = 2000 AND d3.d_moy BETWEEN 2 AND 4 AND d3.d_year = 2000 GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100;",
  "patches": [
    {
      "patch_id": "p01",
      "family": "A",
      "transform": "sf_sk_pushdown_multi_fact",
      "relevance_score": 0.88,
      "status": "NEUTRAL",
      "speedup": 0.98,
      "semantic_passed": true,
      "error": null,
      "original_ms": 157.5,
      "patch_ms": 161.1,
      "output_sql": "WITH d1_sk_range AS (SELECT MIN(d_date_sk) AS min_sk, MAX(d_date_sk) AS max_sk FROM date_dim WHERE d_moy = 2 AND d_year = 2000), d2_sk_range AS (SELECT MIN(d_date_sk) AS min_sk, MAX(d_date_sk) AS max_sk FROM date_dim WHERE d_moy BETWEEN 2 AND 4 AND d_year = 2000), d3_sk_range AS (SELECT MIN(d_date_sk) AS min_sk, MAX(d_date_sk) AS max_sk FROM date_dim WHERE d_moy BETWEEN 2 AND 4 AND d_year = 2000), store_sales_filtered AS (SELECT * FROM store_sales WHERE ss_sold_date_sk BETWEEN (SELECT min_sk FROM d1_sk_range) AND (SELECT max_sk FROM d1_sk_range)), store_returns_filtered AS (SELECT * FROM store_returns WHERE sr_returned_date_sk BETWEEN (SELECT min_sk FROM d2_sk_range) AND (SELECT max_sk FROM d2_sk_range)), catalog_sales_filtered AS (SELECT * FROM catalog_sales WHERE cs_sold_date_sk BETWEEN (SELECT min_sk FROM d3_sk_range) AND (SELECT max_sk FROM d3_sk_range)) select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,stddev_samp(ss_net_profit) as store_sales_profit\n ,stddev_samp(sr_net_loss) as store_returns_loss\n ,stddev_samp(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 2\n and d1.d_year = 2000\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy               between 2 and  2 + 2\n and d2.d_year              = 2000\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy               between 2 and  2 + 2\n and d3.d_year              = 2000\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Add explicit date_sk BETWEEN range filters to each fact\u2011table scan derived from date_dim predicates, enabling micro\u2011partition pruning. Compute min/max date_sk from filtered date_dim CTE for each alias (d1, d2, d3) and push into corresponding fact\u2011table WHERE clauses."
    },
    {
      "patch_id": "p04",
      "family": "F",
      "transform": "inner_join_conversion",
      "relevance_score": 0.5,
      "status": "NEUTRAL",
      "speedup": 1.01,
      "semantic_passed": true,
      "error": null,
      "original_ms": 157.5,
      "patch_ms": 155.5,
      "output_sql": "SELECT \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,stddev_samp(ss_net_profit) AS store_sales_profit\n ,stddev_samp(sr_net_loss) AS store_returns_loss\n ,stddev_samp(cs_net_profit) AS catalog_sales_profit\nFROM store_sales\nINNER JOIN store_returns ON store_sales.ss_customer_sk = store_returns.sr_customer_sk\n  AND store_sales.ss_item_sk = store_returns.sr_item_sk\n  AND store_sales.ss_ticket_number = store_returns.sr_ticket_number\nINNER JOIN catalog_sales ON store_returns.sr_customer_sk = catalog_sales.cs_bill_customer_sk\n  AND store_returns.sr_item_sk = catalog_sales.cs_item_sk\nINNER JOIN date_dim d1 ON d1.d_date_sk = store_sales.ss_sold_date_sk\nINNER JOIN date_dim d2 ON d2.d_date_sk = store_returns.sr_returned_date_sk\nINNER JOIN date_dim d3 ON d3.d_date_sk = catalog_sales.cs_sold_date_sk\nINNER JOIN store ON store.s_store_sk = store_sales.ss_store_sk\nINNER JOIN item ON item.i_item_sk = store_sales.ss_item_sk\nWHERE\n d1.d_moy = 2\n AND d1.d_year = 2000\n AND d2.d_moy BETWEEN 2 AND 4\n AND d2.d_year = 2000\n AND d3.d_moy BETWEEN 2 AND 4\n AND d3.d_year = 2000\nGROUP BY\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\nORDER BY\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\nLIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Convert comma\u2011separated joins to explicit INNER JOIN syntax, preserving all existing join conditions, to give optimizer clearer join\u2011graph semantics."
    },
    {
      "patch_id": "p03",
      "family": "A",
      "transform": "multi_date_range_cte",
      "relevance_score": 0.55,
      "status": "FAIL",
      "speedup": null,
      "semantic_passed": false,
      "error": "Retry failed: Tree sources include a dependency cycle",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH d1_cte AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 2 AND d_year = 2000), d2_cte AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 2 AND 4 AND d_year = 2000), d3_cte AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 2 AND 4 AND d_year = 2000), store_sales AS (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN d1_cte ON ss_sold_date_sk = d1_cte.d_date_sk), store_returns AS (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN d2_cte ON sr_returned_date_sk = d2_cte.d_date_sk), catalog_sales AS (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, cs_net_profit FROM catalog_sales JOIN d3_cte ON cs_sold_date_sk = d3_cte.d_date_sk) select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,stddev_samp(ss_net_profit) as store_sales_profit\n ,stddev_samp(sr_net_loss) as store_returns_loss\n ,stddev_samp(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 2\n and d1.d_year = 2000\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy               between 2 and  2 + 2\n and d2.d_year              = 2000\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy               between 2 and  2 + 2\n and d3.d_year              = 2000\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Isolate each date_dim filter into separate CTEs (d1_cte, d2_cte, d3_cte) containing only the surrogate keys for the filtered date ranges, then join those CTEs with fact tables."
    },
    {
      "patch_id": "p02",
      "family": "C",
      "transform": "aggregate_pushdown",
      "relevance_score": 0.75,
      "status": "NEUTRAL",
      "speedup": 1.02,
      "semantic_passed": true,
      "error": null,
      "original_ms": 157.5,
      "patch_ms": 154.4,
      "output_sql": "WITH agg_store_sales AS (SELECT ss_customer_sk, ss_item_sk, ss_ticket_number, ss_store_sk, ss_sold_date_sk, SUM(ss_net_profit) AS net_profit FROM store_sales WHERE ss_sold_date_sk IS NOT NULL AND ss_store_sk IS NOT NULL AND ss_customer_sk IS NOT NULL GROUP BY ss_customer_sk, ss_item_sk, ss_ticket_number, ss_store_sk, ss_sold_date_sk), agg_store_returns AS (SELECT sr_customer_sk, sr_item_sk, sr_ticket_number, sr_returned_date_sk, SUM(sr_net_loss) AS sr_net_loss FROM store_returns WHERE sr_returned_date_sk IS NOT NULL AND sr_customer_sk IS NOT NULL GROUP BY sr_customer_sk, sr_item_sk, sr_ticket_number, sr_returned_date_sk), agg_catalog_sales AS (SELECT cs_bill_customer_sk, cs_item_sk, cs_sold_date_sk, SUM(cs_net_profit) AS net_profit FROM catalog_sales WHERE cs_sold_date_sk IS NOT NULL AND cs_bill_customer_sk IS NOT NULL GROUP BY cs_bill_customer_sk, cs_item_sk, cs_sold_date_sk) SELECT i_item_id, i_item_desc, s_store_id, s_store_name, stddev_samp(ss.net_profit) AS store_sales_profit, stddev_samp(sr.sr_net_loss) AS store_returns_loss, stddev_samp(cs.net_profit) AS catalog_sales_profit FROM agg_store_sales ss JOIN agg_store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN agg_catalog_sales cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk JOIN date_dim d1 ON d1.d_date_sk = ss.ss_sold_date_sk JOIN date_dim d2 ON d2.d_date_sk = sr.sr_returned_date_sk JOIN date_dim d3 ON d3.d_date_sk = cs.cs_sold_date_sk JOIN store s ON s.s_store_sk = ss.ss_store_sk JOIN item i ON i.i_item_sk = ss.ss_item_sk WHERE d1.d_moy = 2 AND d1.d_year = 2000 AND d2.d_moy BETWEEN 2 AND 4 AND d2.d_year = 2000 AND d3.d_moy BETWEEN 2 AND 4 AND d3.d_year = 2000 GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Pre\u2011aggregate each fact table by its join keys (customer_sk, item_sk, ticket_number, store_sk) and grouping keys (item_id, item_desc, store_id, store_name) before joining, reducing rows flowing into the main join tree."
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "REGRESSION",
      "speedup": 0.93,
      "semantic_passed": true,
      "error": null,
      "original_ms": 168.9,
      "patch_ms": 181.6,
      "output_sql": "WITH filtered_store_sales AS (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, ss_net_profit FROM store_sales INNER JOIN date_dim d1 ON d1.d_date_sk = ss_sold_date_sk WHERE d1.d_moy = 2 AND d1.d_year = 2000), filtered_store_returns AS (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns INNER JOIN date_dim d2 ON d2.d_date_sk = sr_returned_date_sk WHERE d2.d_moy BETWEEN 2 AND 4 AND d2.d_year = 2000), filtered_catalog_sales AS (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, cs_net_profit FROM catalog_sales INNER JOIN date_dim d3 ON d3.d_date_sk = cs_sold_date_sk WHERE d3.d_moy BETWEEN 2 AND 4 AND d3.d_year = 2000) SELECT i_item_id, i_item_desc, s_store_id, s_store_name, stddev_samp(ss_net_profit) AS store_sales_profit, stddev_samp(sr_net_loss) AS store_returns_loss, stddev_samp(cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales ss INNER JOIN filtered_store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number INNER JOIN filtered_catalog_sales cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk INNER JOIN store s ON s.s_store_sk = ss.ss_store_sk INNER JOIN item i ON i.i_item_sk = ss.ss_item_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "compile_p2",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "NEUTRAL",
      "speedup": 0.98,
      "semantic_passed": true,
      "error": null,
      "original_ms": 168.9,
      "patch_ms": 172.1,
      "output_sql": "WITH grouped_store_sales AS (SELECT ss_sold_date_sk, ss_item_sk, ss_customer_sk, ss_store_sk, ss_ticket_number, ss_net_profit FROM store_sales), grouped_store_returns AS (SELECT sr_returned_date_sk, sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns), grouped_catalog_sales AS (SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk, cs_net_profit FROM catalog_sales) SELECT i_item_id, i_item_desc, s_store_id, s_store_name, stddev_samp(ss_net_profit) AS store_sales_profit, stddev_samp(sr_net_loss) AS store_returns_loss, stddev_samp(cs_net_profit) AS catalog_sales_profit FROM grouped_store_sales ss INNER JOIN grouped_store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number INNER JOIN grouped_catalog_sales cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk INNER JOIN date_dim d1 ON d1.d_date_sk = ss.ss_sold_date_sk INNER JOIN date_dim d2 ON d2.d_date_sk = sr.sr_returned_date_sk INNER JOIN date_dim d3 ON d3.d_date_sk = cs.cs_sold_date_sk INNER JOIN store s ON s.s_store_sk = ss.ss_store_sk INNER JOIN item i ON i.i_item_sk = ss.ss_item_sk WHERE d1.d_moy = 2 AND d1.d_year = 2000 AND d2.d_moy BETWEEN 2 AND 4 AND d2.d_year = 2000 AND d3.d_moy BETWEEN 2 AND 4 AND d3.d_year = 2000 GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100;",
      "has_explain": true,
      "description": null
    }
  ],
  "explains": {
    "p01": "GlobalStats | 134716 | 132209 | 2257606169088\n1 | 0 | Result | ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, STORE.S_STORE_ID, STORE.S_STORE_NAME, SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT(COUNT(COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_NET_PROFIT)), COUNT(*))))))) * (SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_NET_PROFIT) * (STORE_SALES.SS_NET_PROFIT))), COUNT(*)))))))) - ((SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_NET_PROFIT)), COUNT(*))))))) * (SUM(SUM(SUM(SUM(SUM",
    "p04": "GlobalStats | 134716 | 132209 | 2257606169088\n1 | 0 | Result | ITEM.I_ITEM_ID, ITEM.I_ITEM_DESC, STORE.S_STORE_ID, STORE.S_STORE_NAME, SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT(COUNT(COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_NET_PROFIT)), COUNT(*))))))) * (SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_NET_PROFIT) * (STORE_SALES.SS_NET_PROFIT))), COUNT(*)))))))) - ((SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_NET_PROFIT)), COUNT(*))))))) * (SUM(SUM(SUM(SUM(SUM",
    "p02": "GlobalStats | 134716 | 132048 | 2254860128768\n1 | 0 | Result | I.I_ITEM_ID, I.I_ITEM_DESC, S.S_STORE_ID, S.S_STORE_NAME, SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT(COUNT(COUNT(COUNT_INTERNAL(COUNT(COUNT(SUM(STORE_SALES.SS_NET_PROFIT))), COUNT(*))))))) * (SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM((SUM(STORE_SALES.SS_NET_PROFIT)) * (SUM(STORE_SALES.SS_NET_PROFIT)))), COUNT(*)))))))) - ((SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))), COUNT(*))))))) * (SUM(SUM(SUM(S",
    "compile_p1": "GlobalStats | 134716 | 132209 | 2257606169088\n1 | 0 | Result | I.I_ITEM_ID, I.I_ITEM_DESC, S.S_STORE_ID, S.S_STORE_NAME, SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT(COUNT(COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_NET_PROFIT)), COUNT(*))))))) * (SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_NET_PROFIT) * (STORE_SALES.SS_NET_PROFIT))), COUNT(*)))))))) - ((SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_NET_PROFIT)), COUNT(*))))))) * (SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(",
    "compile_p2": "GlobalStats | 134716 | 132209 | 2257606169088\n1 | 0 | Result | I.I_ITEM_ID, I.I_ITEM_DESC, S.S_STORE_ID, S.S_STORE_NAME, SQRT(TO_DOUBLE(SCALED_ROUND_INT_DIVIDE(IFF((((COUNT(COUNT(COUNT(COUNT(COUNT_INTERNAL(COUNT(COUNT(STORE_SALES.SS_NET_PROFIT)), COUNT(*))))))) * (SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM((STORE_SALES.SS_NET_PROFIT) * (STORE_SALES.SS_NET_PROFIT))), COUNT(*)))))))) - ((SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM(SUM(STORE_SALES.SS_NET_PROFIT)), COUNT(*))))))) * (SUM(SUM(SUM(SUM(SUM_INTERNAL(SUM("
  }
}