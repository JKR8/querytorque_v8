{
  "iteration": 0,
  "n_api_calls": 9,
  "beam_cost_usd": 0.03785511,
  "beam_cost_priced_calls": 9,
  "beam_cost_unpriced_calls": 0,
  "beam_token_totals": {
    "prompt_tokens": 96342,
    "completion_tokens": 37811,
    "total_tokens": 134153,
    "prompt_cache_hit_tokens": 0,
    "prompt_cache_miss_tokens": 0,
    "cached_tokens": 31936,
    "reasoning_tokens": 19117
  },
  "best_speedup": 1.2,
  "best_patch_id": "compile_p1",
  "best_sql": "WITH shared_dimensions AS (SELECT d_date_sk, d_date, i_item_sk, i_current_price, i_category, p_promo_sk, p_channel_email, p_channel_tv, p_channel_radio, p_channel_press, p_channel_event FROM date_dim, item, promotion WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day' AND i_current_price > 50 AND i_category IN ('Men', 'Music') AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N'), ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number), shared_dimensions, store WHERE ss_sold_date_sk = shared_dimensions.d_date_sk AND ss_store_sk = s_store_sk AND ss_item_sk = shared_dimensions.i_item_sk AND ss_promo_sk = shared_dimensions.p_promo_sk AND ss_wholesale_cost BETWEEN 21 AND 36 AND ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number), shared_dimensions, catalog_page WHERE cs_sold_date_sk = shared_dimensions.d_date_sk AND cs_catalog_page_sk = cp_catalog_page_sk AND cs_item_sk = shared_dimensions.i_item_sk AND cs_promo_sk = shared_dimensions.p_promo_sk AND cs_wholesale_cost BETWEEN 21 AND 36 AND cs_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number), shared_dimensions, web_site WHERE ws_sold_date_sk = shared_dimensions.d_date_sk AND ws_web_site_sk = web_site_sk AND ws_item_sk = shared_dimensions.i_item_sk AND ws_promo_sk = shared_dimensions.p_promo_sk AND ws_wholesale_cost BETWEEN 21 AND 36 AND ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') GROUP BY web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
  "patches": [
    {
      "patch_id": "p01",
      "family": "A",
      "transform": "sf_sk_pushdown_union_all",
      "relevance_score": 0.8,
      "status": "IMPROVED",
      "speedup": 1.06,
      "semantic_passed": true,
      "error": null,
      "original_ms": 203.5,
      "patch_ms": 192.3,
      "output_sql": "WITH ssr AS (select  s_store_id as store_id,\n         sum(ss_ext_sales_price) as sales,\n         sum(coalesce(sr_return_amt, 0)) as returns,\n         sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n from store_sales left outer join store_returns on\n        (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n    date_dim,\n    store,\n    item,\n    promotion\nwhere ss_sold_date_sk = d_date_sk\n      and d_date between cast('1999-10-21' as date)\n                 and cast('1999-10-21' as date) + interval '30 day'\n      and ss_store_sk = s_store_sk\n      and ss_item_sk = i_item_sk\n      and i_current_price > 50\n      and ss_promo_sk = p_promo_sk\n      and p_channel_email = 'Y'\n      and p_channel_tv = 'N'\n      and p_channel_radio = 'N'\n      and p_channel_press = 'N'\n      and p_channel_event = 'N'\n      and ss_wholesale_cost BETWEEN 21 AND 36\n      and i_category IN ('Men', 'Music')\n      and ss_sold_date_sk between (select min(d_date_sk) from date_dim where d_date between cast('1999-10-21' as date) and cast('1999-10-21' as date) + interval '30 day')\n                            and (select max(d_date_sk) from date_dim where d_date between cast('1999-10-21' as date) and cast('1999-10-21' as date) + interval '30 day')\ngroup by s_store_id), csr AS (select  cp_catalog_page_id as catalog_page_id,\n         sum(cs_ext_sales_price) as sales,\n         sum(coalesce(cr_return_amount, 0)) as returns,\n         sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n from catalog_sales left outer join catalog_returns on\n        (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n    date_dim,\n    catalog_page,\n    item,\n    promotion\nwhere cs_sold_date_sk = d_date_sk\n      and d_date between cast('1999-10-21' as date)\n                 and cast('1999-10-21' as date) + interval '30 day'\n      and cs_catalog_page_sk = cp_catalog_page_sk\n      and cs_item_sk = i_item_sk\n      and i_current_price > 50\n      and cs_promo_sk = p_promo_sk\n      and p_channel_email = 'Y'\n      and p_channel_tv = 'N'\n      and p_channel_radio = 'N'\n      and p_channel_press = 'N'\n      and p_channel_event = 'N'\n      and cs_wholesale_cost BETWEEN 21 AND 36\n      and i_category IN ('Men', 'Music')\n      and cs_sold_date_sk between (select min(d_date_sk) from date_dim where d_date between cast('1999-10-21' as date) and cast('1999-10-21' as date) + interval '30 day')\n                            and (select max(d_date_sk) from date_dim where d_date between cast('1999-10-21' as date) and cast('1999-10-21' as date) + interval '30 day')\ngroup by cp_catalog_page_id), wsr AS (select  web_site_id,\n         sum(ws_ext_sales_price) as sales,\n         sum(coalesce(wr_return_amt, 0)) as returns,\n         sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n from web_sales left outer join web_returns on\n        (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n    date_dim,\n    web_site,\n    item,\n    promotion\nwhere ws_sold_date_sk = d_date_sk\n      and d_date between cast('1999-10-21' as date)\n                 and cast('1999-10-21' as date) + interval '30 day'\n      and ws_web_site_sk = web_site_sk\n      and ws_item_sk = i_item_sk\n      and i_current_price > 50\n      and ws_promo_sk = p_promo_sk\n      and p_channel_email = 'Y'\n      and p_channel_tv = 'N'\n      and p_channel_radio = 'N'\n      and p_channel_press = 'N'\n      and p_channel_event = 'N'\n      and ws_wholesale_cost BETWEEN 21 AND 36\n      and i_category IN ('Men', 'Music')\n      and ws_sold_date_sk between (select min(d_date_sk) from date_dim where d_date between cast('1999-10-21' as date) and cast('1999-10-21' as date) + interval '30 day')\n                            and (select max(d_date_sk) from date_dim where d_date between cast('1999-10-21' as date) and cast('1999-10-21' as date) + interval '30 day')\ngroup by web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Push date_sk BETWEEN range derived from date filter (1999-10-21 to +30 days) into each fact table scan in ssr, csr, wsr CTEs to enable micro-partition pruning, while preserving all original joins and filters."
    },
    {
      "patch_id": "p02",
      "family": "C",
      "transform": "aggregate_pushdown",
      "relevance_score": 0.6,
      "status": "ERROR",
      "speedup": null,
      "semantic_passed": false,
      "error": "Execution: 000904 (42000): 01c27c6f-3205-67d8-0002-fcfe000214ba: SQL compilation error: error line 1 at position 824\ninvalid identifier 'PRE_AGG_STORE.SS_PROMO_SK'",
      "original_ms": null,
      "patch_ms": null,
      "output_sql": "WITH ssr AS (WITH pre_agg_store AS (SELECT ss_item_sk, ss_store_sk, ss_ticket_number, SUM(ss_ext_sales_price) AS sales, SUM(coalesce(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - coalesce(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND ss_wholesale_cost BETWEEN 21 AND 36 GROUP BY ss_item_sk, ss_store_sk, ss_ticket_number) SELECT s_store_id AS store_id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM pre_agg_store JOIN store ON pre_agg_store.ss_store_sk = s_store_sk JOIN item ON pre_agg_store.ss_item_sk = i_item_sk JOIN promotion ON pre_agg_store.ss_promo_sk = p_promo_sk WHERE i_current_price > 50 AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND i_category IN ('Men', 'Music') GROUP BY s_store_id), csr AS (WITH pre_agg_catalog AS (SELECT cs_item_sk, cs_order_number, cs_catalog_page_sk, SUM(cs_ext_sales_price) AS sales, SUM(coalesce(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - coalesce(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number) WHERE cs_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND cs_wholesale_cost BETWEEN 21 AND 36 GROUP BY cs_item_sk, cs_order_number, cs_catalog_page_sk) SELECT cp_catalog_page_id AS catalog_page_id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM pre_agg_catalog JOIN catalog_page ON pre_agg_catalog.cs_catalog_page_sk = cp_catalog_page_sk JOIN item ON pre_agg_catalog.cs_item_sk = i_item_sk JOIN promotion ON pre_agg_catalog.cs_promo_sk = p_promo_sk WHERE i_current_price > 50 AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND i_category IN ('Men', 'Music') GROUP BY cp_catalog_page_id), wsr AS (WITH pre_agg_web AS (SELECT ws_item_sk, ws_order_number, ws_web_site_sk, SUM(ws_ext_sales_price) AS sales, SUM(coalesce(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - coalesce(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number) WHERE ws_sold_date_sk IN (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND ws_wholesale_cost BETWEEN 21 AND 36 GROUP BY ws_item_sk, ws_order_number, ws_web_site_sk) SELECT web_site_id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM pre_agg_web JOIN web_site ON pre_agg_web.ws_web_site_sk = web_site_sk JOIN item ON pre_agg_web.ws_item_sk = i_item_sk JOIN promotion ON pre_agg_web.ws_promo_sk = p_promo_sk WHERE i_current_price > 50 AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND i_category IN ('Men', 'Music') GROUP BY web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
      "has_explain": false,
      "description": "[scout:qwen/qwen3-coder] Pre-aggregate each fact table (store_sales, catalog_sales, web_sales) by join keys (e.g., ss_item_sk, ss_store_sk) before joining with dimensions in ssr, csr, wsr CTEs, preserving all filters and aggregate semantics."
    },
    {
      "patch_id": "p03",
      "family": "A",
      "transform": "shared_dimension_multi_channel",
      "relevance_score": 0.55,
      "status": "IMPROVED",
      "speedup": 1.06,
      "semantic_passed": true,
      "error": null,
      "original_ms": 203.5,
      "patch_ms": 191.7,
      "output_sql": "WITH shared_dimensions AS (select d_date_sk, d_date, i_item_sk, i_current_price, i_category, p_promo_sk, p_channel_email, p_channel_tv, p_channel_radio, p_channel_press, p_channel_event\nfrom date_dim, item, promotion\nwhere d_date between cast('1999-10-21' as date)\n           and cast('1999-10-21' as date) + interval '30 day'\n  and i_current_price > 50\n  and i_category IN ('Men', 'Music')\n  and p_channel_email = 'Y'\n  and p_channel_tv = 'N'\n  and p_channel_radio = 'N'\n  and p_channel_press = 'N'\n  and p_channel_event = 'N'), ssr AS (select  s_store_id as store_id,\n         sum(ss_ext_sales_price) as sales,\n         sum(coalesce(sr_return_amt, 0)) as returns,\n         sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n from store_sales left outer join store_returns on\n        (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n    shared_dimensions,\n    store\nwhere ss_sold_date_sk = shared_dimensions.d_date_sk\n      and ss_store_sk = s_store_sk\n      and ss_item_sk = shared_dimensions.i_item_sk\n      and ss_promo_sk = shared_dimensions.p_promo_sk\n      and shared_dimensions.d_date between cast('1999-10-21' as date)\n                 and cast('1999-10-21' as date) + interval '30 day'\n      and shared_dimensions.i_current_price > 50\n      and shared_dimensions.p_channel_email = 'Y'\n      and shared_dimensions.p_channel_tv = 'N'\n      and shared_dimensions.p_channel_radio = 'N'\n      and shared_dimensions.p_channel_press = 'N'\n      and shared_dimensions.p_channel_event = 'N'\n      and ss_wholesale_cost BETWEEN 21 AND 36\n      and shared_dimensions.i_category IN ('Men', 'Music')\ngroup by s_store_id), csr AS (select  cp_catalog_page_id as catalog_page_id,\n         sum(cs_ext_sales_price) as sales,\n         sum(coalesce(cr_return_amount, 0)) as returns,\n         sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n from catalog_sales left outer join catalog_returns on\n        (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n    shared_dimensions,\n    catalog_page\nwhere cs_sold_date_sk = shared_dimensions.d_date_sk\n      and cs_catalog_page_sk = cp_catalog_page_sk\n      and cs_item_sk = shared_dimensions.i_item_sk\n      and cs_promo_sk = shared_dimensions.p_promo_sk\n      and shared_dimensions.d_date between cast('1999-10-21' as date)\n                 and cast('1999-10-21' as date) + interval '30 day'\n      and shared_dimensions.i_current_price > 50\n      and shared_dimensions.p_channel_email = 'Y'\n      and shared_dimensions.p_channel_tv = 'N'\n      and shared_dimensions.p_channel_radio = 'N'\n      and shared_dimensions.p_channel_press = 'N'\n      and shared_dimensions.p_channel_event = 'N'\n      and cs_wholesale_cost BETWEEN 21 AND 36\n      and shared_dimensions.i_category IN ('Men', 'Music')\ngroup by cp_catalog_page_id), wsr AS (select  web_site_id,\n         sum(ws_ext_sales_price) as sales,\n         sum(coalesce(wr_return_amt, 0)) as returns,\n         sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n from web_sales left outer join web_returns on\n        (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n    shared_dimensions,\n    web_site\nwhere ws_sold_date_sk = shared_dimensions.d_date_sk\n      and ws_web_site_sk = web_site_sk\n      and ws_item_sk = shared_dimensions.i_item_sk\n      and ws_promo_sk = shared_dimensions.p_promo_sk\n      and shared_dimensions.d_date between cast('1999-10-21' as date)\n                 and cast('1999-10-21' as date) + interval '30 day'\n      and shared_dimensions.i_current_price > 50\n      and shared_dimensions.p_channel_email = 'Y'\n      and shared_dimensions.p_channel_tv = 'N'\n      and shared_dimensions.p_channel_radio = 'N'\n      and shared_dimensions.p_channel_press = 'N'\n      and shared_dimensions.p_channel_event = 'N'\n      and ws_wholesale_cost BETWEEN 21 AND 36\n      and shared_dimensions.i_category IN ('Men', 'Music')\ngroup by web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Extract shared dimension filters (date_dim, item, promotion) into a single CTE and reference it in ssr, csr, wsr to avoid redundant dimension scans, while keeping fact table joins unchanged."
    },
    {
      "patch_id": "p04",
      "family": "F",
      "transform": "dimension_prefetch_star",
      "relevance_score": 0.5,
      "status": "NEUTRAL",
      "speedup": 1.03,
      "semantic_passed": true,
      "error": null,
      "original_ms": 203.5,
      "patch_ms": 197.4,
      "output_sql": "WITH ssr AS (WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day'),\n     filtered_item AS (SELECT i_item_sk FROM item WHERE i_current_price > 50 AND i_category IN ('Men', 'Music')),\n     filtered_promotion AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N')\nSELECT s_store_id AS store_id,\n       SUM(ss_ext_sales_price) AS sales,\n       SUM(COALESCE(sr_return_amt, 0)) AS returns,\n       SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit\nFROM store_sales\nLEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number)\nJOIN filtered_date_dim ON ss_sold_date_sk = filtered_date_dim.d_date_sk\nJOIN store ON ss_store_sk = s_store_sk\nJOIN filtered_item ON ss_item_sk = filtered_item.i_item_sk\nJOIN filtered_promotion ON ss_promo_sk = filtered_promotion.p_promo_sk\nWHERE ss_wholesale_cost BETWEEN 21 AND 36\nGROUP BY s_store_id), csr AS (WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day'),\n     filtered_item AS (SELECT i_item_sk FROM item WHERE i_current_price > 50 AND i_category IN ('Men', 'Music')),\n     filtered_promotion AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N')\nSELECT cp_catalog_page_id AS catalog_page_id,\n       SUM(cs_ext_sales_price) AS sales,\n       SUM(COALESCE(cr_return_amount, 0)) AS returns,\n       SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number)\nJOIN filtered_date_dim ON cs_sold_date_sk = filtered_date_dim.d_date_sk\nJOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk\nJOIN filtered_item ON cs_item_sk = filtered_item.i_item_sk\nJOIN filtered_promotion ON cs_promo_sk = filtered_promotion.p_promo_sk\nWHERE cs_wholesale_cost BETWEEN 21 AND 36\nGROUP BY cp_catalog_page_id), wsr AS (WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day'),\n     filtered_item AS (SELECT i_item_sk FROM item WHERE i_current_price > 50 AND i_category IN ('Men', 'Music')),\n     filtered_promotion AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N')\nSELECT web_site_id,\n       SUM(ws_ext_sales_price) AS sales,\n       SUM(COALESCE(wr_return_amt, 0)) AS returns,\n       SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit\nFROM web_sales\nLEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number)\nJOIN filtered_date_dim ON ws_sold_date_sk = filtered_date_dim.d_date_sk\nJOIN web_site ON ws_web_site_sk = web_site_sk\nJOIN filtered_item ON ws_item_sk = filtered_item.i_item_sk\nJOIN filtered_promotion ON ws_promo_sk = filtered_promotion.p_promo_sk\nWHERE ws_wholesale_cost BETWEEN 21 AND 36\nGROUP BY web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
      "has_explain": true,
      "description": "[scout:qwen/qwen3-coder] Pre-filter all selective dimensions (date_dim, item, promotion) into CTEs and convert comma-separated joins to explicit JOIN syntax in ssr, csr, wsr to improve join planning and cardinality estimates."
    },
    {
      "patch_id": "compile_p1",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "WIN",
      "speedup": 1.2,
      "semantic_passed": true,
      "error": null,
      "original_ms": 227.9,
      "patch_ms": 190.2,
      "output_sql": "WITH shared_dimensions AS (SELECT d_date_sk, d_date, i_item_sk, i_current_price, i_category, p_promo_sk, p_channel_email, p_channel_tv, p_channel_radio, p_channel_press, p_channel_event FROM date_dim, item, promotion WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day' AND i_current_price > 50 AND i_category IN ('Men', 'Music') AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N'), ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number), shared_dimensions, store WHERE ss_sold_date_sk = shared_dimensions.d_date_sk AND ss_store_sk = s_store_sk AND ss_item_sk = shared_dimensions.i_item_sk AND ss_promo_sk = shared_dimensions.p_promo_sk AND ss_wholesale_cost BETWEEN 21 AND 36 AND ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number), shared_dimensions, catalog_page WHERE cs_sold_date_sk = shared_dimensions.d_date_sk AND cs_catalog_page_sk = cp_catalog_page_sk AND cs_item_sk = shared_dimensions.i_item_sk AND cs_promo_sk = shared_dimensions.p_promo_sk AND cs_wholesale_cost BETWEEN 21 AND 36 AND cs_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number), shared_dimensions, web_site WHERE ws_sold_date_sk = shared_dimensions.d_date_sk AND ws_web_site_sk = web_site_sk AND ws_item_sk = shared_dimensions.i_item_sk AND ws_promo_sk = shared_dimensions.p_promo_sk AND ws_wholesale_cost BETWEEN 21 AND 36 AND ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') GROUP BY web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "attempt_p01_p03_hybrid",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "NEUTRAL",
      "speedup": 0.96,
      "semantic_passed": true,
      "error": null,
      "original_ms": 227.9,
      "patch_ms": 237.4,
      "output_sql": "WITH shared_dimensions AS (SELECT d_date_sk, i_item_sk, p_promo_sk FROM date_dim, item, promotion WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day' AND i_current_price > 50 AND i_category IN ('Men', 'Music') AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N'), date_range AS (SELECT MIN(d_date_sk) AS min_d_date_sk, MAX(d_date_sk) AS max_d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day'), ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number), shared_dimensions, store WHERE ss_sold_date_sk = shared_dimensions.d_date_sk AND ss_store_sk = s_store_sk AND ss_item_sk = shared_dimensions.i_item_sk AND ss_promo_sk = shared_dimensions.p_promo_sk AND ss_wholesale_cost BETWEEN 21 AND 36 AND ss_sold_date_sk BETWEEN (SELECT min_d_date_sk FROM date_range) AND (SELECT max_d_date_sk FROM date_range) GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number), shared_dimensions, catalog_page WHERE cs_sold_date_sk = shared_dimensions.d_date_sk AND cs_catalog_page_sk = cp_catalog_page_sk AND cs_item_sk = shared_dimensions.i_item_sk AND cs_promo_sk = shared_dimensions.p_promo_sk AND cs_wholesale_cost BETWEEN 21 AND 36 AND cs_sold_date_sk BETWEEN (SELECT min_d_date_sk FROM date_range) AND (SELECT max_d_date_sk FROM date_range) GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number), shared_dimensions, web_site WHERE ws_sold_date_sk = shared_dimensions.d_date_sk AND ws_web_site_sk = web_site_sk AND ws_item_sk = shared_dimensions.i_item_sk AND ws_promo_sk = shared_dimensions.p_promo_sk AND ws_wholesale_cost BETWEEN 21 AND 36 AND ws_sold_date_sk BETWEEN (SELECT min_d_date_sk FROM date_range) AND (SELECT max_d_date_sk FROM date_range) GROUP BY web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "attempt_p01_pushdown_only",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "WIN",
      "speedup": 1.12,
      "semantic_passed": true,
      "error": null,
      "original_ms": 227.9,
      "patch_ms": 203.8,
      "output_sql": "WITH ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number), date_dim, store, item, promotion WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day' AND ss_store_sk = s_store_sk AND ss_item_sk = i_item_sk AND i_current_price > 50 AND ss_promo_sk = p_promo_sk AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ss_wholesale_cost BETWEEN 21 AND 36 AND i_category IN ('Men', 'Music') AND ss_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number), date_dim, catalog_page, item, promotion WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day' AND cs_catalog_page_sk = cp_catalog_page_sk AND cs_item_sk = i_item_sk AND i_current_price > 50 AND cs_promo_sk = p_promo_sk AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND cs_wholesale_cost BETWEEN 21 AND 36 AND i_category IN ('Men', 'Music') AND cs_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number), date_dim, web_site, item, promotion WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day' AND ws_web_site_sk = web_site_sk AND ws_item_sk = i_item_sk AND i_current_price > 50 AND ws_promo_sk = p_promo_sk AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ws_wholesale_cost BETWEEN 21 AND 36 AND i_category IN ('Men', 'Music') AND ws_sold_date_sk BETWEEN (SELECT MIN(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') AND (SELECT MAX(d_date_sk) FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day') GROUP BY web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
      "has_explain": true,
      "description": null
    },
    {
      "patch_id": "attempt_residual_gap",
      "family": "?",
      "transform": "tree_rewrite",
      "relevance_score": 1.0,
      "status": "NEUTRAL",
      "speedup": 0.96,
      "semantic_passed": true,
      "error": null,
      "original_ms": 227.9,
      "patch_ms": 237.7,
      "output_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 day'), item_filter AS (SELECT i_item_sk FROM item WHERE i_current_price > 50 AND i_category IN ('Men', 'Music')), promotion_filter AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N'), ssr AS (SELECT s_store_id AS store_id, SUM(agg.sales) AS sales, SUM(agg.returns) AS returns, SUM(agg.profit) AS profit FROM (SELECT ss_store_sk, ss_item_sk, ss_promo_sk, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM date_filter) AND ss_wholesale_cost BETWEEN 21 AND 36 GROUP BY ss_store_sk, ss_item_sk, ss_promo_sk) agg JOIN store ON agg.ss_store_sk = s_store_sk JOIN item_filter ON agg.ss_item_sk = item_filter.i_item_sk JOIN promotion_filter ON agg.ss_promo_sk = promotion_filter.p_promo_sk GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(agg.sales) AS sales, SUM(agg.returns) AS returns, SUM(agg.profit) AS profit FROM (SELECT cs_catalog_page_sk, cs_item_sk, cs_promo_sk, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number) WHERE cs_sold_date_sk IN (SELECT d_date_sk FROM date_filter) AND cs_wholesale_cost BETWEEN 21 AND 36 GROUP BY cs_catalog_page_sk, cs_item_sk, cs_promo_sk) agg JOIN catalog_page ON agg.cs_catalog_page_sk = cp_catalog_page_sk JOIN item_filter ON agg.cs_item_sk = item_filter.i_item_sk JOIN promotion_filter ON agg.cs_promo_sk = promotion_filter.p_promo_sk GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(agg.sales) AS sales, SUM(agg.returns) AS returns, SUM(agg.profit) AS profit FROM (SELECT ws_web_site_sk, ws_item_sk, ws_promo_sk, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number) WHERE ws_sold_date_sk IN (SELECT d_date_sk FROM date_filter) AND ws_wholesale_cost BETWEEN 21 AND 36 GROUP BY ws_web_site_sk, ws_item_sk, ws_promo_sk) agg JOIN web_site ON agg.ws_web_site_sk = web_site_sk JOIN item_filter ON agg.ws_item_sk = item_filter.i_item_sk JOIN promotion_filter ON agg.ws_promo_sk = promotion_filter.p_promo_sk GROUP BY web_site_id) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
      "has_explain": true,
      "description": null
    }
  ],
  "explains": {
    "p01": "GlobalStats | 0 | 0 | 0\n1 | 0 | Result | X.CHANNEL, SUM(UNION_ALL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(WEB_SALES.WS_EXT_SALES_PRICE))), SUM(UNION_ALL(SUM(IFNULL(STORE_RETURNS.SR_RETURN_AMT, 0)), SUM(IFNULL(CATALOG_RETURNS.CR_RETURN_AMOUNT, 0)), SUM(IFNULL(WEB_RETURNS.WR_RETURN_AMT, 0)))), SUM(UNION_ALL(SUM(STORE_SALES.SS_NET_PROFIT - (IFNULL(STORE_RETURNS.SR_NET_LOSS, 0))), SUM(CATALOG_SALES.CS_NET_PROFIT - (IFNULL(CATALOG_RETURNS.CR_NET_LOSS, 0))), SUM",
    "p03": "GlobalStats | 0 | 0 | 0\n1 | 0 | Result | X.CHANNEL, X.ID, SUM(UNION_ALL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(WEB_SALES.WS_EXT_SALES_PRICE))), SUM(UNION_ALL(SUM(IFNULL(STORE_RETURNS.SR_RETURN_AMT, 0)), SUM(IFNULL(CATALOG_RETURNS.CR_RETURN_AMOUNT, 0)), SUM(IFNULL(WEB_RETURNS.WR_RETURN_AMT, 0)))), SUM(UNION_ALL(SUM(STORE_SALES.SS_NET_PROFIT - (IFNULL(STORE_RETURNS.SR_NET_LOSS, 0))), SUM(CATALOG_SALES.CS_NET_PROFIT - (IFNULL(CATALOG_RETURNS.CR_NET_LOSS, 0))",
    "p04": "GlobalStats | 0 | 0 | 0\n1 | 0 | Result | X.CHANNEL, X.ID, SUM(UNION_ALL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(WEB_SALES.WS_EXT_SALES_PRICE))), SUM(UNION_ALL(SUM(IFNULL(STORE_RETURNS.SR_RETURN_AMT, 0)), SUM(IFNULL(CATALOG_RETURNS.CR_RETURN_AMOUNT, 0)), SUM(IFNULL(WEB_RETURNS.WR_RETURN_AMT, 0)))), SUM(UNION_ALL(SUM(STORE_SALES.SS_NET_PROFIT - (IFNULL(STORE_RETURNS.SR_NET_LOSS, 0))), SUM(CATALOG_SALES.CS_NET_PROFIT - (IFNULL(CATALOG_RETURNS.CR_NET_LOSS, 0))",
    "compile_p1": "GlobalStats | 0 | 0 | 0\n1 | 0 | Result | X.CHANNEL, X.ID, SUM(UNION_ALL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(WEB_SALES.WS_EXT_SALES_PRICE))), SUM(UNION_ALL(SUM(IFNULL(STORE_RETURNS.SR_RETURN_AMT, 0)), SUM(IFNULL(CATALOG_RETURNS.CR_RETURN_AMOUNT, 0)), SUM(IFNULL(WEB_RETURNS.WR_RETURN_AMT, 0)))), SUM(UNION_ALL(SUM(STORE_SALES.SS_NET_PROFIT - (IFNULL(STORE_RETURNS.SR_NET_LOSS, 0))), SUM(CATALOG_SALES.CS_NET_PROFIT - (IFNULL(CATALOG_RETURNS.CR_NET_LOSS, 0))",
    "attempt_p01_p03_hybrid": "GlobalStats | 0 | 0 | 0\n1 | 0 | Result | X.CHANNEL, X.ID, SUM(UNION_ALL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(WEB_SALES.WS_EXT_SALES_PRICE))), SUM(UNION_ALL(SUM(IFNULL(STORE_RETURNS.SR_RETURN_AMT, 0)), SUM(IFNULL(CATALOG_RETURNS.CR_RETURN_AMOUNT, 0)), SUM(IFNULL(WEB_RETURNS.WR_RETURN_AMT, 0)))), SUM(UNION_ALL(SUM(STORE_SALES.SS_NET_PROFIT - (IFNULL(STORE_RETURNS.SR_NET_LOSS, 0))), SUM(CATALOG_SALES.CS_NET_PROFIT - (IFNULL(CATALOG_RETURNS.CR_NET_LOSS, 0))",
    "attempt_p01_pushdown_only": "GlobalStats | 0 | 0 | 0\n1 | 0 | Result | X.CHANNEL, SUM(UNION_ALL(SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(CATALOG_SALES.CS_EXT_SALES_PRICE), SUM(WEB_SALES.WS_EXT_SALES_PRICE))), SUM(UNION_ALL(SUM(IFNULL(STORE_RETURNS.SR_RETURN_AMT, 0)), SUM(IFNULL(CATALOG_RETURNS.CR_RETURN_AMOUNT, 0)), SUM(IFNULL(WEB_RETURNS.WR_RETURN_AMT, 0)))), SUM(UNION_ALL(SUM(STORE_SALES.SS_NET_PROFIT - (IFNULL(STORE_RETURNS.SR_NET_LOSS, 0))), SUM(CATALOG_SALES.CS_NET_PROFIT - (IFNULL(CATALOG_RETURNS.CR_NET_LOSS, 0))), SUM",
    "attempt_residual_gap": "GlobalStats | 169343 | 169343 | 2883056855552\n1 | 0 | Result | X.CHANNEL, X.ID, SUM(UNION_ALL(SUM(SUM_INTERNAL(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))), COUNT(*))), SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(CATALOG_SALES.CS_EXT_SALES_PRICE))), COUNT(*)))), SUM(SUM_INTERNAL(SUM(SUM(SUM(SUM(WEB_SALES.WS_EXT_SALES_PRICE)))), COUNT(*))))), SUM(UNION_ALL(SUM(SUM_INTERNAL(SUM(SUM(SUM(SUM(IFNULL(STORE_RETURNS.SR_RETURN_AMT, 0))))), COUNT(*))), SUM(SUM(SUM_INTERNAL(SUM(SUM(SUM(IFNULL(CATALOG_RETURNS.CR"
  }
}