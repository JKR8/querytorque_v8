{
  "probe_id": "p12",
  "transform_id": "sf_sk_pushdown_multi_fact",
  "family": "A",
  "status": "success",
  "dialect": "snowflake",
  "hypothesis": "Adding explicit date_sk BETWEEN predicate derived from date_dim filter to WEB_SALES scans enhances micro-partition pruning without altering join semantics.",
  "reasoning_trace": [
    "Assigned transform targets adding date_sk range filter to WEB_SALES based on date_dim d_date filter.",
    "WEB_SALES is scanned twice with high I/O (461GB each), making it a prime candidate for partition pruning improvement.",
    "The d_date filter is '1999-01-29' to '1999-04-29', which can be converted to corresponding date_sk range.",
    "No semantic changes are introduced; output columns, aliases, and row semantics remain unchanged."
  ],
  "target_ir": "WEB_SALES scans gain additional date_sk BETWEEN predicate derived from d_date range.",
  "verification": {
    "executable": true,
    "no_missing_tables": true,
    "alias_consistent": true,
    "no_orphan_scans": true,
    "semantics_preserved": true,
    "null_semantics_safe": true,
    "ctes_selective_or_na": true
  },
  "tree": {
    "root_node_id": "final_select",
    "nodes": [
      {
        "node_id": "final_select",
        "parent_node_id": null,
        "sources": [],
        "outputs": ["Excess Discount Amount"],
        "changed": true,
        "sql": "SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales, item, date_dim WHERE (i_manufact_id BETWEEN 797 AND 996 OR i_category IN ('Men', 'Shoes', 'Sports')) AND i_item_sk = ws_item_sk AND d_date BETWEEN '1999-01-29' AND CAST('1999-01-29' AS DATE) + INTERVAL '90 day' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 35 AND 55 AND ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM web_sales, date_dim WHERE ws_item_sk = i_item_sk AND d_date BETWEEN '1999-01-29' AND CAST('1999-01-29' AS DATE) + INTERVAL '90 day' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 35 AND 55 AND ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01) ORDER BY SUM(ws_ext_discount_amt) LIMIT 100"
      }
    ]
  }
}