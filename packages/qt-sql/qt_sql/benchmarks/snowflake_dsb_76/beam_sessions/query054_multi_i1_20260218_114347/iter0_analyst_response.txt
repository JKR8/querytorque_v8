```json
{
  "dispatch": {
    "dialect": "snowflake",
    "importance_stars": 2,
    "probe_count": 5,
    "early_stop": false,
    "equivalence_tier": "unordered",
    "hypothesis": "The query's primary bottleneck is the repeated scans of catalog_sales and web_sales without effective predicate pushdown to prune micro-partitions. Additionally, there's an opportunity to push aggregation earlier in the query plan.",
    "reasoning_trace": [
      "Union of catalog_sales and web_sales without date_sk BETWEEN predicate pushdown scans entire tables.",
      "Multiple aggregations could be consolidated or pushed down to reduce intermediate data volume.",
      "No evidence of nested loops or correlated subqueries needing decorrelation."
    ],
    "cost_spine": ["TableScan (CATALOG_SALES)", "TableScan (WEB_SALES)", "UnionAll", "Aggregate"],
    "hotspots": [
      {
        "op": "TableScan (CATALOG_SALES)",
        "why": "full scan without effective predicate pushdown",
        "evidence": "parts=54721/54922 bytes=920184101376"
      },
      {
        "op": "TableScan (WEB_SALES)",
        "why": "full scan without effective predicate pushdown",
        "evidence": "parts=27574/27579 bytes=460956759040"
      },
      {
        "op": "Aggregate",
        "why": "multiple aggregation steps",
        "evidence": "four aggregation nodes in the plan"
      }
    ],
    "do_not_do": [
      "avoid materializing EXISTS patterns unnecessarily",
      "avoid wrapping filter columns in functions"
    ]
  },
  "probe_summary_schema": [
    "probe_id",
    "transform_id",
    "family",
    "expected_explain_delta",
    "confidence",
    "exploration",
    "target",
    "dag_target_hint",
    "recommended_patch_ops",
    "recommended_examples"
  ],
  "probes": [
    {
      "probe_id": "p01",
      "transform_id": "sf_sk_pushdown_union_all",
      "family": "A",
      "target": "Push date_sk BETWEEN predicate into both catalog_sales and web_sales branches of the UNION ALL.",
      "dag_target_hint": "Modify my_customers CTE to include date_sk range predicate for each sales channel.",
      "node_contract": {
        "from_must_include": ["catalog_sales", "web_sales", "date_dim"],
        "where_must_preserve": ["d_moy = 1", "d_year = 1998"],
        "output_must_preserve": ["customer_sk"]
      },
      "gates_checked": ["G_SF_SK_DATE_FILTER_REQUIRED:PASS", "G_SF_SK_SCAN_PRESSURE:PASS"],
      "exploration": false,
      "exploration_hypothesis": "",
      "confidence": 0.85,
      "expected_explain_delta": "Catalog_sales and web_sales scans show reduced partitions scanned.",
      "recommended_patch_ops": ["replace_from", "replace_where_predicate"],
      "recommended_examples": ["sf_sk_pushdown_union_all"],
      "gold_example_id": "sf_sk_pushdown_union_all"
    },
    {
      "probe_id": "p02",
      "transform_id": "aggregate_pushdown",
      "family": "C",
      "target": "Pre-aggregate catalog_sales and web_sales by customer_sk before joining with other tables.",
      "dag_target_hint": "Modify my_customers CTE to include pre-aggregation of sales data.",
      "node_contract": {
        "from_must_include": ["catalog_sales", "web_sales"],
        "where_must_preserve": ["wholesale_cost BETWEEN 35 AND 65"],
        "output_must_preserve": ["customer_sk"]
      },
      "gates_checked": ["DG_TYPE_ENUM:PASS", "DG_SEVERITY_ENUM:PASS"],
      "exploration": false,
      "exploration_hypothesis": "",
      "confidence": 0.75,
      "expected_explain_delta": "Reduced row count flowing through joins and subsequent aggregations.",
      "recommended_patch_ops": ["insert_cte", "replace_from"],
      "recommended_examples": ["aggregate_pushdown"],
      "gold_example_id": "aggregate_pushdown"
    },
    {
      "probe_id": "p03",
      "transform_id": "date_cte_isolate",
      "family": "A",
      "target": "Extract date_dim filtering into a separate CTE to materialize date_sks once.",
      "dag_target_hint": "Add date_filter CTE before my_customers CTE.",
      "node_contract": {
        "from_must_include": ["date_dim"],
        "where_must_preserve": ["d_moy = 1", "d_year = 1998"],
        "output_must_preserve": ["d_date_sk"]
      },
      "gates_checked": ["DG_TYPE_ENUM:PASS", "DG_SEVERITY_ENUM:PASS"],
      "exploration": true,
      "exploration_hypothesis": "Materializing date dim keys once could enable better join planning.",
      "confidence": 0.65,
      "expected_explain_delta": "Eliminate redundant date_dim scans and improve join planning.",
      "recommended_patch_ops": ["insert_cte", "replace_from"],
      "recommended_examples": ["date_cte_isolate"],
      "gold_example_id": "date_cte_isolate"
    },
    {
      "probe_id": "p04",
      "transform_id": "materialize_cte",
      "family": "E",
      "target": "Materialize the filtered item table once.",
      "dag_target_hint": "Add item_filter CTE before my_customers CTE.",
      "node_contract": {
        "from_must_include": ["item"],
        "where_must_preserve": ["i_category = 'Electronics'", "i_class = 'personal'"],
        "output_must_preserve": ["i_item_sk"]
      },
      "gates_checked": ["DG_TYPE_ENUM:PASS", "DG_SEVERITY_ENUM:PASS"],
      "exploration": true,
      "exploration_hypothesis": "Reusing the filtered item table might reduce redundant scans.",
      "confidence": 0.60,
      "expected_explain_delta": "Potential reduction in item table scans.",
      "recommended_patch_ops": ["insert_cte", "replace_from"],
      "recommended_examples": ["materialize_cte"],
      "gold_example_id": "materialize_cte"
    },
    {
      "probe_id": "p05",
      "transform_id": "shared_dimension_multi_channel",
      "family": "A",
      "target": "Extract shared dimension filters into a single CTE.",
      "dag_target_hint": "Create dim_filters CTE combining date and item filters.",
      "node_contract": {
        "from_must_include": ["date_dim", "item"],
        "where_must_preserve": ["d_moy = 1", "d_year = 1998", "i_category = 'Electronics'", "i_class = 'personal'"],
        "output_must_preserve": ["d_date_sk", "i_item_sk"]
      },
      "gates_checked": ["DG_TYPE_ENUM:PASS", "DG_SEVERITY_ENUM:PASS"],
      "exploration": true,
      "exploration_hypothesis": "Combining dimension filters might reduce redundant processing.",
      "confidence": 0.55,
      "expected_explain_delta": "Potential reduction in dimension table scans.",
      "recommended_patch_ops": ["insert_cte", "replace_from"],
      "recommended_examples": ["shared_dimension_multi_channel"],
      "gold_example_id": ""
    }
  ],
  "dropped": [
    {
      "transform_id": "decorrelate",
      "family": "B",
      "reason": "No correlated scalar aggregate pattern found in query."
    },
    {
      "transform_id": "intersect_to_exists",
      "family": "D",
      "reason": "No INTERSECT operations found in query."
    }
  ]
}
```