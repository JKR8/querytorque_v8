S0 [SELECT]
  CTE: my_customers  (via CTE_Q_S0_my_customers)
    FROM: (subquery) cs_or_ws_sales, item, date_dim, customer
    WHERE [39569bb4425260fb]: sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Electronics' AND i_class = 'pe...
  CTE: my_revenue  (via CTE_Q_S0_my_revenue)
    FROM: my_customers, store_sales, customer_address, store, date_dim
    WHERE [da5ee871ab9d7894]: c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_dat...
    GROUP BY: c_customer_sk
  CTE: segments  (via CTE_Q_S0_segments)
    FROM: my_revenue
  MAIN QUERY (via Q_S0)
    FROM: segments
    GROUP BY: segment
    ORDER BY: segment, num_customers

Patch operations (core+advanced): insert_cte, replace_expr_subtree, replace_where_predicate, replace_from, delete_expr_subtree, replace_body, replace_join_condition, replace_select, replace_block_with_cte_pair, wrap_query_with_cte
Target: by_node_id (statement, e.g. "S0") + by_anchor_hash (expression)