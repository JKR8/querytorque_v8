S0 [SELECT]
  CTE: frequent_ss_items  (via CTE_Q_S0_frequent_ss_items)
    FROM: store_sales, date_dim, item
    WHERE [89fc2fb260a938e8]: ss_sold_date_sk = d_date_sk AND ss_item_sk = i_item_sk AND d_year = 1998 AND i_manager_id BETWEEN...
    GROUP BY: SUBSTRING(i_item_desc, 1, 30), i_item_sk, d_date
  CTE: max_store_sales  (via CTE_Q_S0_max_store_sales)
    FROM: (subquery) tmp1
  CTE: best_ss_customer  (via CTE_Q_S0_best_ss_customer)
    FROM: store_sales, customer
    WHERE [8e7b5f6e04cda7e3]: ss_customer_sk = c_customer_sk AND c_birth_year BETWEEN 1934 AND 1940
    GROUP BY: c_customer_sk
  MAIN QUERY (via Q_S0)
    FROM: (subquery) tmp2

Patch operations (core+advanced): insert_cte, replace_expr_subtree, replace_where_predicate, replace_from, delete_expr_subtree, replace_body, replace_join_condition, replace_select, replace_block_with_cte_pair, wrap_query_with_cte
Target: by_node_id (statement, e.g. "S0") + by_anchor_hash (expression)