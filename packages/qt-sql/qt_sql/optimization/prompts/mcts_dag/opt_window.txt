Apply ONLY window function optimization using node-level rewrites.

TASK: Optimize window functions and their partition/order clauses.

{dag_prompt}

Rules:
1. Combine multiple window functions with the same OVER clause
2. Add explicit frame bounds if missing (ROWS vs RANGE semantics)
3. Remove unnecessary ORDER BY in window functions for aggregates that don't need it
4. Consider replacing window functions with equivalent GROUP BY when simpler
5. Replace correlated subqueries with window functions
6. Consider pre-computing window results in CTEs for reuse
7. Do NOT change the values produced by window functions
8. Preserve partition and ordering semantics exactly

Return JSON:
```json
{{"rewrites": {{"node_id": "SELECT ..."}}, "explanation": "..."}}
```