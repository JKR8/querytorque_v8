Apply ONLY join reordering optimization using node-level rewrites.

TASK: Reorder joins to put most selective/smallest tables first.

{dag_prompt}

Rules:
1. Put tables with strong filter predicates (equality, small ranges) earlier in join order
2. Dimension tables (smaller) should generally come before fact tables (larger)
3. Preserve all predicates exactly - do not add or remove any
4. Do NOT change FROM/JOIN to subqueries or vice versa
5. Keep all column references valid after reordering
6. Only rewrite nodes where join reordering applies

Return JSON:
```json
{{"rewrites": {{"node_id": "SELECT ..."}}, "explanation": "..."}}
```