Apply ONLY CTE inlining using node-level rewrites.

TASK: Inline CTEs back into the main query where beneficial.

{dag_prompt}

Rules:
1. Inline CTEs that are used only once
2. Inline simple CTEs (just a table scan with filters)
3. Keep CTEs that are used multiple times or are complex aggregations
4. Do NOT change the query logic or results
5. Preserve all column names and orderings
6. Remove the inlined CTE and update referencing nodes

Return JSON:
```json
{{"rewrites": {{"main_query": "SELECT ... (with inlined subquery)"}}, "explanation": "..."}}
```