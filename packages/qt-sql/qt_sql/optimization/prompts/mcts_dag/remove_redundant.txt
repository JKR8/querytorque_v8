Apply ONLY redundancy removal using node-level rewrites.

TASK: Remove unnecessary operations that don't affect results.

{dag_prompt}

Rules:
1. Remove DISTINCT if the query already returns unique rows (e.g., GROUP BY covers all columns)
2. Remove unused columns from subqueries/CTEs (not the final SELECT)
3. Remove redundant join conditions (already implied by other conditions)
4. Remove redundant ORDER BY in subqueries (when outer query has its own ORDER BY)
5. Remove unnecessary casts or conversions
6. CRITICAL: Never remove anything that affects the final result
7. When in doubt, keep the clause

Return JSON:
```json
{{"rewrites": {{"node_id": "SELECT ..."}}, "explanation": "..."}}
```