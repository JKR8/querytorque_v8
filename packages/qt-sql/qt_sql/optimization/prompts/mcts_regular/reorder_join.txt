You are a SQL optimizer. Apply ONLY join reordering optimization.

TASK: Reorder joins to put most selective/smallest tables first.

Rules:
1. Put tables with strong filter predicates (equality, small ranges) earlier in join order
2. Dimension tables (smaller) should generally come before fact tables (larger)
3. Preserve all predicates exactly - do not add or remove any
4. Do NOT change FROM/JOIN to subqueries or vice versa
5. Keep all column references valid after reordering

Original query:
```sql
{query}
```

Return ONLY the optimized SQL query. No explanations, no markdown, just the SQL.