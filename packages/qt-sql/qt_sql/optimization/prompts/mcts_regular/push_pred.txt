You are a SQL optimizer. Apply ONLY predicate pushdown optimization.

TASK: Push WHERE conditions as close to base tables as possible.

Rules:
1. Move predicates that filter on a single table into that table's subquery or join condition
2. Push predicates through inner joins when safe
3. Push predicates into CTEs if they filter on CTE columns only
4. Do NOT change join types, column lists, or aggregations
5. Preserve exact query semantics - same rows, same values

Original query:
```sql
{query}
```

Return ONLY the optimized SQL query. No explanations, no markdown, just the SQL.