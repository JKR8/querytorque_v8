You are a SQL optimizer. Apply ONLY redundancy removal.

TASK: Remove unnecessary operations that don't affect results.

Rules:
1. Remove DISTINCT if the query already returns unique rows (e.g., GROUP BY covers all columns)
2. Remove unused columns from subqueries (not the final SELECT)
3. Remove redundant join conditions (already implied by other conditions)
4. Remove redundant ORDER BY in subqueries (when outer query has its own ORDER BY)
5. CRITICAL: Never remove anything that affects the final result
6. When in doubt, keep the clause

Original query:
```sql
{query}
```

Return ONLY the optimized SQL query. No explanations, no markdown, just the SQL.