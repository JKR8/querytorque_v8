{
  "id": "inline_cte",
  "name": "Inline Single-Use CTE",
  "description": "Inline CTEs used only once back into main query for optimizer flexibility",
  "benchmark_queries": [],
  "verified_speedup": "1.1-1.3x",
  "example": {
    "opportunity": "INLINE_CTE",
    "input_slice": "[cte_a]:\nSELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000\n\n[cte_b]:\nSELECT i_item_sk, i_brand FROM item WHERE i_category = 'Music'\n\n[main_query]:\nSELECT SUM(ss_sales_price)\nFROM store_sales\nJOIN cte_a ON ss_sold_date_sk = d_date_sk\nJOIN cte_b ON ss_item_sk = i_item_sk",
    "output": {
      "rewrite_sets": [{
        "id": "rs_01",
        "transform": "inline_cte",
        "nodes": {
          "main_query": "SELECT SUM(ss_sales_price) FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk WHERE d_year = 2000 AND i_category = 'Music'"
        },
        "invariants_kept": ["same result", "same aggregation"],
        "expected_speedup": "1.2x",
        "risk": "low"
      }]
    },
    "key_insight": "Single-use CTEs can prevent optimizer from pushing predicates. Inlining allows better join ordering and predicate pushdown."
  }
}
