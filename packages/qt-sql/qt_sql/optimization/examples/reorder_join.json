{
  "id": "reorder_join",
  "name": "Join Reordering",
  "description": "Reorder joins to put most selective tables first",
  "benchmark_queries": [],
  "verified_speedup": "1.2-1.8x",
  "example": {
    "opportunity": "REORDER_JOIN",
    "input_slice": "[main_query]:\nSELECT SUM(ss_sales_price)\nFROM store_sales, date_dim, store, item\nWHERE ss_sold_date_sk = d_date_sk\n  AND ss_store_sk = s_store_sk\n  AND ss_item_sk = i_item_sk\n  AND d_year = 2000\n  AND s_state = 'TN'\n  AND i_category = 'Electronics'",
    "output": {
      "rewrite_sets": [{
        "id": "rs_01",
        "transform": "reorder_join",
        "nodes": {
          "filtered_stores": "SELECT s_store_sk FROM store WHERE s_state = 'TN'",
          "filtered_items": "SELECT i_item_sk FROM item WHERE i_category = 'Electronics'",
          "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 2000",
          "main_query": "SELECT SUM(ss_sales_price) FROM store_sales ss JOIN filtered_stores fs ON ss.ss_store_sk = fs.s_store_sk JOIN filtered_items fi ON ss.ss_item_sk = fi.i_item_sk JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk"
        },
        "invariants_kept": ["same result", "same aggregation"],
        "expected_speedup": "1.5x",
        "risk": "low"
      }]
    },
    "key_insight": "Filter dimension tables FIRST into small CTEs. Join fact table to filtered dimensions. Smaller dimensions reduce fact table scan."
  }
}
