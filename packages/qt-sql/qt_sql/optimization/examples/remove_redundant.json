{
  "id": "remove_redundant",
  "name": "Remove Redundant Operations",
  "description": "Remove unnecessary DISTINCT, unused columns, redundant ORDER BY",
  "benchmark_queries": [],
  "verified_speedup": "1.05-1.2x",
  "example": {
    "opportunity": "REMOVE_REDUNDANT",
    "input_slice": "[main_query]:\nSELECT DISTINCT c_customer_id, c_first_name, c_last_name, SUM(ss_sales_price) as total\nFROM customer\nJOIN store_sales ON c_customer_sk = ss_customer_sk\nGROUP BY c_customer_id, c_first_name, c_last_name\nORDER BY c_first_name",
    "output": {
      "rewrite_sets": [{
        "id": "rs_01",
        "transform": "remove_redundant",
        "nodes": {
          "main_query": "SELECT c_customer_id, c_first_name, c_last_name, SUM(ss_sales_price) as total FROM customer JOIN store_sales ON c_customer_sk = ss_customer_sk GROUP BY c_customer_id, c_first_name, c_last_name ORDER BY c_first_name"
        },
        "invariants_kept": ["same result rows", "same columns", "same ordering"],
        "expected_speedup": "1.1x",
        "risk": "low"
      }]
    },
    "key_insight": "DISTINCT after GROUP BY on all selected columns is redundant - GROUP BY already produces unique rows. Remove to avoid extra sort/hash."
  }
}
