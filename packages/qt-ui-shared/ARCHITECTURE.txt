┌─────────────────────────────────────────────────────────────────────────────────┐
│                         qt-ui-shared Architecture                               │
│                   Shared React Component Library for Web Apps                   │
└─────────────────────────────────────────────────────────────────────────────────┘

                              ┌──────────────────┐
                              │   qt-ui-shared   │
                              │  (React Library) │
                              └────────┬─────────┘
                                       │
           ┌───────────────────────────┼───────────────────────────┐
           │                           │                           │
           ▼                           ▼                           ▼
    ┌─────────────┐            ┌─────────────┐            ┌─────────────┐
    │ components/ │            │  contexts/  │            │   theme/    │
    └──────┬──────┘            └──────┬──────┘            └──────┬──────┘
           │                          │                          │
           │                          │                          │
           ▼                          ▼                          ▼
┌──────────────────┐       ┌──────────────────┐       ┌──────────────────┐
│                  │       │                  │       │                  │
│  ┌────────────┐  │       │   AuthContext    │       │   Design Tokens  │
│  │ CodeEditor │  │       │                  │       │                  │
│  │            │  │       │ - Auth0 provider │       │ - Colors         │
│  │ Monaco-    │  │       │ - User state     │       │ - Typography     │
│  │ based      │  │       │ - Login/logout   │       │ - Spacing        │
│  │ SQL/DAX    │  │       │ - Token mgmt     │       │ - Borders        │
│  │ editor     │  │       │ - Permissions    │       │ - Shadows        │
│  └────────────┘  │       │                  │       │                  │
│                  │       └──────────────────┘       │  tokens.css      │
│  ┌────────────┐  │                                  │  (CSS variables) │
│  │ DropZone   │  │                                  │                  │
│  │            │  │                                  └──────────────────┘
│  │ Drag-drop  │  │
│  │ file upload│  │
│  │ .sql/.vpax │  │
│  └────────────┘  │
│                  │
│  ┌────────────┐  │
│  │ Report     │  │
│  │ Viewer     │  │
│  │            │  │
│  │ HTML report│  │
│  │ display    │  │
│  └────────────┘  │
│                  │
│  ┌────────────┐  │
│  │ Validation │  │
│  │ Report     │  │
│  │            │  │
│  │ Show       │  │
│  │ issues &   │  │
│  │ suggestions│  │
│  └────────────┘  │
│                  │
└──────────────────┘


┌─────────────────────────────────────────────────────────────────────────────────┐
│                           COMPONENT DETAILS                                     │
└─────────────────────────────────────────────────────────────────────────────────┘


┌──────────────────────────────────────────────────────────────────────────────────┐
│                              CodeEditor                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐  │
│  │  Monaco Editor wrapper for SQL/DAX editing with syntax highlighting        │  │
│  └────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                   │
│    Props:                                                                         │
│    ┌─────────────────────────────────────────────────────────────────────────┐   │
│    │ value: string              Current editor content                       │   │
│    │ onChange: (val) => void    Content change handler                       │   │
│    │ language: 'sql'|'dax'|...  Syntax highlighting mode                     │   │
│    │ readOnly: boolean          Disable editing                              │   │
│    │ height: string             Editor height (CSS)                          │   │
│    │ theme: 'vs'|'vs-dark'      Light or dark mode                           │   │
│    │ lineNumbers: boolean       Show line numbers                            │   │
│    │ minimap: boolean           Show minimap                                 │   │
│    │ wordWrap: 'on'|'off'       Word wrapping mode                           │   │
│    └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                   │
│    Features:                                                                      │
│    • SQL syntax highlighting (Monaco built-in)                                   │
│    • DAX syntax highlighting (custom Monarch tokenizer)                          │
│    • JSON, JavaScript, TypeScript support                                        │
│    • Auto-completion                                                             │
│    • Code folding                                                                │
│    • Format on paste/type                                                        │
│                                                                                   │
│    DAX Keywords Registered:                                                      │
│    CALCULATE, FILTER, ALL, VALUES, SUMMARIZE, VAR, RETURN,                       │
│    SUM, SUMX, COUNT, AVERAGE, RELATED, DATEADD, FORMAT, ...                     │
└──────────────────────────────────────────────────────────────────────────────────┘


┌──────────────────────────────────────────────────────────────────────────────────┐
│                              DropZone                                            │
│  ┌────────────────────────────────────────────────────────────────────────────┐  │
│  │  Drag-and-drop file upload component with visual feedback                  │  │
│  └────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                   │
│    Props:                                                                         │
│    ┌─────────────────────────────────────────────────────────────────────────┐   │
│    │ accept: string[]            Allowed file extensions                     │   │
│    │ onDrop: (files) => void     File drop handler                           │   │
│    │ multiple: boolean           Allow multiple files                        │   │
│    │ children: ReactNode         Custom content                              │   │
│    │ disabled: boolean           Disable interaction                         │   │
│    └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                   │
│    Features:                                                                      │
│    • Drag hover visual feedback                                                  │
│    • File type validation                                                        │
│    • Click to browse files                                                       │
│    • Error state for invalid files                                               │
└──────────────────────────────────────────────────────────────────────────────────┘


┌──────────────────────────────────────────────────────────────────────────────────┐
│                            ReportViewer                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐  │
│  │  Display rendered HTML reports in an iframe/container                      │  │
│  └────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                   │
│    Props:                                                                         │
│    ┌─────────────────────────────────────────────────────────────────────────┐   │
│    │ html: string               Raw HTML content                             │   │
│    │ height: string             Viewer height                                │   │
│    │ onLoad: () => void         Load complete callback                       │   │
│    └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                   │
│    Features:                                                                      │
│    • Sandboxed iframe rendering                                                  │
│    • Scoped CSS isolation                                                        │
│    • Print support                                                               │
│    • Download as HTML/PDF                                                        │
└──────────────────────────────────────────────────────────────────────────────────┘


┌──────────────────────────────────────────────────────────────────────────────────┐
│                          ValidationReport                                        │
│  ┌────────────────────────────────────────────────────────────────────────────┐  │
│  │  Display analysis/validation results with severity-colored issues          │  │
│  └────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                   │
│    Props:                                                                         │
│    ┌─────────────────────────────────────────────────────────────────────────┐   │
│    │ issues: Issue[]            Array of detected issues                     │   │
│    │ score: number              Torque score 0-100                           │   │
│    │ showSuggestions: boolean   Show fix suggestions                         │   │
│    └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                   │
│    Features:                                                                      │
│    • Color-coded severity (critical/high/medium/low)                            │
│    • Expandable issue details                                                    │
│    • Quick-fix suggestions                                                       │
│    • Score visualization                                                         │
└──────────────────────────────────────────────────────────────────────────────────┘


┌──────────────────────────────────────────────────────────────────────────────────┐
│                             AuthContext                                          │
│  ┌────────────────────────────────────────────────────────────────────────────┐  │
│  │  Auth0 integration context for authentication state management             │  │
│  └────────────────────────────────────────────────────────────────────────────┘  │
│                                                                                   │
│    Provides:                                                                      │
│    ┌─────────────────────────────────────────────────────────────────────────┐   │
│    │ isAuthenticated: boolean    User logged in state                        │   │
│    │ isLoading: boolean          Auth check in progress                      │   │
│    │ user: User | null           Current user object                         │   │
│    │ login: () => void           Redirect to Auth0 login                     │   │
│    │ logout: () => void          Log out and clear session                   │   │
│    │ getAccessToken: () => string  Get JWT for API calls                     │   │
│    └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                   │
│    Integration:                                                                   │
│    • Uses @auth0/auth0-react                                                    │
│    • Single Auth0 tenant across both qt-sql and qt-dax apps                     │
│    • Token refresh handling                                                      │
│    • Protected route wrapper                                                     │
└──────────────────────────────────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────────────┐
│                           DESIGN TOKENS (CSS Variables)                         │
└─────────────────────────────────────────────────────────────────────────────────┘

   theme/tokens.css:
   ┌─────────────────────────────────────────────────────────────────────────────┐
   │  :root {                                                                   │
   │    /* Colors */                                                            │
   │    --qt-primary: #3b82f6;                                                  │
   │    --qt-success: #22c55e;                                                  │
   │    --qt-warning: #eab308;                                                  │
   │    --qt-error: #ef4444;                                                    │
   │    --qt-bg: #0f172a;                                                       │
   │    --qt-bg-card: #1e293b;                                                  │
   │    --qt-fg: #f8fafc;                                                       │
   │    --qt-fg-muted: #94a3b8;                                                 │
   │    --qt-border: #334155;                                                   │
   │                                                                            │
   │    /* Typography */                                                        │
   │    --qt-font-sans: 'Inter', sans-serif;                                    │
   │    --qt-font-mono: 'JetBrains Mono', monospace;                            │
   │    --qt-text-xs: 0.75rem;                                                  │
   │    --qt-text-sm: 0.875rem;                                                 │
   │    --qt-text-base: 1rem;                                                   │
   │                                                                            │
   │    /* Spacing & Sizing */                                                  │
   │    --qt-radius: 0.5rem;                                                    │
   │    --qt-space-1: 0.25rem;                                                  │
   │    --qt-space-2: 0.5rem;                                                   │
   │    --qt-space-4: 1rem;                                                     │
   │  }                                                                         │
   └─────────────────────────────────────────────────────────────────────────────┘


┌─────────────────────────────────────────────────────────────────────────────────┐
│                              DEPENDENCY GRAPH                                   │
└─────────────────────────────────────────────────────────────────────────────────┘

                              ┌──────────────────┐
                              │   qt-ui-shared   │
                              │  (standalone)    │
                              └────────┬─────────┘
                                       │
                    ┌──────────────────┴──────────────────┐
                    │                                     │
                    ▼                                     ▼
             ┌──────────────┐                     ┌──────────────┐
             │ qt-sql/web   │                     │ qt-dax/web   │
             │              │                     │              │
             │ sql.query-   │                     │ dax.query-   │
             │ torque.com   │                     │ torque.com   │
             └──────────────┘                     └──────────────┘


┌─────────────────────────────────────────────────────────────────────────────────┐
│                              USAGE EXAMPLES                                     │
└─────────────────────────────────────────────────────────────────────────────────┘

  // Import components
  import { CodeEditor, DropZone, ReportViewer } from 'qt-ui-shared';
  import { AuthProvider, useAuth } from 'qt-ui-shared/contexts';
  import 'qt-ui-shared/theme/tokens.css';

  // CodeEditor for SQL
  <CodeEditor
    value={sql}
    onChange={setSql}
    language="sql"
    height="400px"
    theme="vs-dark"
  />

  // CodeEditor for DAX
  <CodeEditor
    value={dax}
    onChange={setDax}
    language="dax"
    lineNumbers={true}
    minimap={false}
  />

  // DropZone for file upload
  <DropZone
    accept={['.sql', '.vpax']}
    onDrop={handleFiles}
    multiple={false}
  >
    Drop your file here
  </DropZone>

  // Auth wrapper
  <AuthProvider domain="xxx.auth0.com" clientId="xxx">
    <App />
  </AuthProvider>

  // Use auth in component
  const { isAuthenticated, login, user } = useAuth();


┌─────────────────────────────────────────────────────────────────────────────────┐
│                           PEER DEPENDENCIES                                     │
└─────────────────────────────────────────────────────────────────────────────────┘

  {
    "peerDependencies": {
      "react": "^18.0.0",
      "react-dom": "^18.0.0"
    },
    "dependencies": {
      "@monaco-editor/react": "^4.6.0",
      "@auth0/auth0-react": "^2.2.0"
    }
  }
