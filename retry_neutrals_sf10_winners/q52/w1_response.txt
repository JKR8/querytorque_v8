```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000 AND d_moy = 11",
        "filtered_items": "SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 1",
        "main_query": "SELECT fd.d_year, fi.i_brand_id AS brand_id, fi.i_brand AS brand, SUM(ss_ext_sales_price) AS ext_price FROM store_sales ss JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items fi ON ss.ss_item_sk = fi.i_item_sk GROUP BY fd.d_year, fi.i_brand_id, fi.i_brand ORDER BY fd.d_year, ext_price DESC, brand_id LIMIT 100"
      },
      "invariants_kept": [
        "output columns unchanged",
        "grain preserved",
        "same result rows",
        "same ordering"
      ],
      "expected_speedup": "3.2x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filter into CTE to reduce store_sales scan from 345M rows to only those matching November 2000 dates (30 rows). Also pushed item filter into separate CTE to further reduce join cardinality. This avoids full table scan of store_sales by applying both dimension filters early via indexed join keys."
}
```