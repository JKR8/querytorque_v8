{
  "query031_0": {
    "rules_requested": [
      "FILTER_INTO_JOIN",
      "AGGREGATE_PROJECT_MERGE",
      "PROJECT_REDUCE_EXPRESSIONS"
    ],
    "rules_applied": [
      "FILTER_INTO_JOIN",
      "AGGREGATE_PROJECT_MERGE",
      "PROJECT_REDUCE_EXPRESSIONS"
    ],
    "rewrite_ms": 2270,
    "wall_ms": 2276.0,
    "output_sql": "SELECT \"t4\".\"ca_county\", CAST(2002 AS INTEGER) AS \"d_year5\", \"t28\".\"web_sales\" / \"t22\".\"web_sales\" AS \"web_q1_q2_increase\", \"t10\".\"store_sales\" / \"t4\".\"store_sales\" AS \"store_q1_q2_increase\", \"t34\".\"web_sales\" / \"t28\".\"web_sales\" AS \"web_q2_q3_increase\", \"t16\".\"store_sales\" / \"t10\".\"store_sales\" AS \"store_q2_q3_increase\"\nFROM (SELECT *\n        FROM (SELECT \"t0\".\"ca_county\", \"date_dim\".\"d_qoy\", \"date_dim\".\"d_year\", SUM(\"t\".\"ss_ext_sales_price\") AS \"store_sales\"\n                FROM (SELECT *\n                        FROM \"store_sales\"\n                        WHERE \"ss_list_price\" >= 248 AND \"ss_list_price\" <= 262) AS \"t\"\n                    INNER JOIN \"date_dim\" ON \"t\".\"ss_sold_date_sk\" = \"date_dim\".\"d_date_sk\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\"\n                        WHERE CAST(\"ca_state\" AS CHAR(2)) IN ('IL', 'MI')) AS \"t0\" ON \"t\".\"ss_addr_sk\" = \"t0\".\"ca_address_sk\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\"\n                        WHERE (\"i_color\" = 'cornsilk' OR \"i_color\" = 'rosy') AND (\"i_manager_id\" >= 80 AND \"i_manager_id\" <= 99)) AS \"t1\" ON \"t\".\"ss_item_sk\" = \"t1\".\"i_item_sk\"\n                GROUP BY \"date_dim\".\"d_year\", \"date_dim\".\"d_qoy\", \"t0\".\"ca_county\") AS \"t3\"\n        WHERE \"t3\".\"d_qoy\" = 1 AND \"t3\".\"d_year\" = 2002) AS \"t4\"\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t6\".\"ca_county0\", \"date_dim0\".\"d_qoy0\", \"date_dim0\".\"d_year0\", SUM(\"t5\".\"ss_ext_sales_price0\") AS \"store_sales\"\n                FROM (SELECT *\n                        FROM \"store_sales\" AS \"store_sales0\" (\"ss_sold_date_sk0\", \"ss_sold_time_sk0\", \"ss_item_sk0\", \"ss_customer_sk0\", \"ss_cdemo_sk0\", \"ss_hdemo_sk0\", \"ss_addr_sk0\", \"ss_store_sk0\", \"ss_promo_sk0\", \"ss_ticket_number0\", \"ss_quantity0\", \"ss_wholesale_cost0\", \"ss_list_price0\", \"ss_sales_price0\", \"ss_ext_discount_amt0\", \"ss_ext_sales_price0\", \"ss_ext_wholesale_cost0\", \"ss_ext_list_price0\", \"ss_ext_tax0\", \"ss_coupon_amt0\", \"ss_net_paid0\", \"ss_net_paid_inc_tax0\", \"ss_net_profit0\")\n                        WHERE \"ss_list_price0\" >= 248 AND \"ss_list_price0\" <= 262) AS \"t5\"\n                    INNER JOIN \"date_dim\" AS \"date_dim0\" (\"d_date_sk0\", \"d_date_id0\", \"d_date0\", \"d_month_seq0\", \"d_week_seq0\", \"d_quarter_seq0\", \"d_year0\", \"d_dow0\", \"d_moy0\", \"d_dom0\", \"d_qoy0\", \"d_fy_year0\", \"d_fy_quarter_seq0\", \"d_fy_week_seq0\", \"d_day_name0\", \"d_quarter_name0\", \"d_holiday0\", \"d_weekend0\", \"d_following_holiday0\", \"d_first_dom0\", \"d_last_dom0\", \"d_same_day_ly0\", \"d_same_day_lq0\", \"d_current_day0\", \"d_current_week0\", \"d_current_month0\", \"d_current_quarter0\", \"d_current_year0\") ON \"t5\".\"ss_sold_date_sk0\" = \"date_dim0\".\"d_date_sk0\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address0\" (\"ca_address_sk0\", \"ca_address_id0\", \"ca_street_number0\", \"ca_street_name0\", \"ca_street_type0\", \"ca_suite_number0\", \"ca_city0\", \"ca_county0\", \"ca_state0\", \"ca_zip0\", \"ca_country0\", \"ca_gmt_offset0\", \"ca_location_type0\")\n                        WHERE CAST(\"ca_state0\" AS CHAR(2)) IN ('IL', 'MI')) AS \"t6\" ON \"t5\".\"ss_addr_sk0\" = \"t6\".\"ca_address_sk0\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item0\" (\"i_item_sk0\", \"i_item_id0\", \"i_rec_start_date0\", \"i_rec_end_date0\", \"i_item_desc0\", \"i_current_price0\", \"i_wholesale_cost0\", \"i_brand_id0\", \"i_brand0\", \"i_class_id0\", \"i_class0\", \"i_category_id0\", \"i_category0\", \"i_manufact_id0\", \"i_manufact0\", \"i_size0\", \"i_formulation0\", \"i_color0\", \"i_units0\", \"i_container0\", \"i_manager_id0\", \"i_product_name0\")\n                        WHERE (\"i_color0\" = 'cornsilk' OR \"i_color0\" = 'rosy') AND (\"i_manager_id0\" >= 80 AND \"i_manager_id0\" <= 99)) AS \"t7\" ON \"t5\".\"ss_item_sk0\" = \"t7\".\"i_item_sk0\"\n                GROUP BY \"date_dim0\".\"d_year0\", \"date_dim0\".\"d_qoy0\", \"t6\".\"ca_county0\") AS \"t9\"\n        WHERE \"t9\".\"d_qoy0\" = 2 AND \"t9\".\"d_year0\" = 2002) AS \"t10\" ON \"t4\".\"ca_county\" = \"t10\".\"ca_county0\"\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t12\".\"ca_county1\", \"date_dim1\".\"d_qoy1\", \"date_dim1\".\"d_year1\", SUM(\"t11\".\"ss_ext_sales_price1\") AS \"store_sales\"\n                FROM (SELECT *\n                        FROM \"store_sales\" AS \"store_sales1\" (\"ss_sold_date_sk1\", \"ss_sold_time_sk1\", \"ss_item_sk1\", \"ss_customer_sk1\", \"ss_cdemo_sk1\", \"ss_hdemo_sk1\", \"ss_addr_sk1\", \"ss_store_sk1\", \"ss_promo_sk1\", \"ss_ticket_number1\", \"ss_quantity1\", \"ss_wholesale_cost1\", \"ss_list_price1\", \"ss_sales_price1\", \"ss_ext_discount_amt1\", \"ss_ext_sales_price1\", \"ss_ext_wholesale_cost1\", \"ss_ext_list_price1\", \"ss_ext_tax1\", \"ss_coupon_amt1\", \"ss_net_paid1\", \"ss_net_paid_inc_tax1\", \"ss_net_profit1\")\n                        WHERE \"ss_list_price1\" >= 248 AND \"ss_list_price1\" <= 262) AS \"t11\"\n                    INNER JOIN \"date_dim\" AS \"date_dim1\" (\"d_date_sk1\", \"d_date_id1\", \"d_date1\", \"d_month_seq1\", \"d_week_seq1\", \"d_quarter_seq1\", \"d_year1\", \"d_dow1\", \"d_moy1\", \"d_dom1\", \"d_qoy1\", \"d_fy_year1\", \"d_fy_quarter_seq1\", \"d_fy_week_seq1\", \"d_day_name1\", \"d_quarter_name1\", \"d_holiday1\", \"d_weekend1\", \"d_following_holiday1\", \"d_first_dom1\", \"d_last_dom1\", \"d_same_day_ly1\", \"d_same_day_lq1\", \"d_current_day1\", \"d_current_week1\", \"d_current_month1\", \"d_current_quarter1\", \"d_current_year1\") ON \"t11\".\"ss_sold_date_sk1\" = \"date_dim1\".\"d_date_sk1\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address1\" (\"ca_address_sk1\", \"ca_address_id1\", \"ca_street_number1\", \"ca_street_name1\", \"ca_street_type1\", \"ca_suite_number1\", \"ca_city1\", \"ca_county1\", \"ca_state1\", \"ca_zip1\", \"ca_country1\", \"ca_gmt_offset1\", \"ca_location_type1\")\n                        WHERE CAST(\"ca_state1\" AS CHAR(2)) IN ('IL', 'MI')) AS \"t12\" ON \"t11\".\"ss_addr_sk1\" = \"t12\".\"ca_address_sk1\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item1\" (\"i_item_sk1\", \"i_item_id1\", \"i_rec_start_date1\", \"i_rec_end_date1\", \"i_item_desc1\", \"i_current_price1\", \"i_wholesale_cost1\", \"i_brand_id1\", \"i_brand1\", \"i_class_id1\", \"i_class1\", \"i_category_id1\", \"i_category1\", \"i_manufact_id1\", \"i_manufact1\", \"i_size1\", \"i_formulation1\", \"i_color1\", \"i_units1\", \"i_container1\", \"i_manager_id1\", \"i_product_name1\")\n                        WHERE (\"i_color1\" = 'cornsilk' OR \"i_color1\" = 'rosy') AND (\"i_manager_id1\" >= 80 AND \"i_manager_id1\" <= 99)) AS \"t13\" ON \"t11\".\"ss_item_sk1\" = \"t13\".\"i_item_sk1\"\n                GROUP BY \"date_dim1\".\"d_year1\", \"date_dim1\".\"d_qoy1\", \"t12\".\"ca_county1\") AS \"t15\"\n        WHERE \"t15\".\"d_qoy1\" = 3 AND \"t15\".\"d_year1\" = 2002) AS \"t16\" ON \"t10\".\"ca_county0\" = \"t16\".\"ca_county1\"\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t18\".\"ca_county2\", \"date_dim2\".\"d_qoy2\", \"date_dim2\".\"d_year2\", SUM(\"t17\".\"ws_ext_sales_price\") AS \"web_sales\"\n                FROM (SELECT *\n                        FROM \"web_sales\"\n                        WHERE \"ws_list_price\" >= 248 AND \"ws_list_price\" <= 262) AS \"t17\"\n                    INNER JOIN \"date_dim\" AS \"date_dim2\" (\"d_date_sk2\", \"d_date_id2\", \"d_date2\", \"d_month_seq2\", \"d_week_seq2\", \"d_quarter_seq2\", \"d_year2\", \"d_dow2\", \"d_moy2\", \"d_dom2\", \"d_qoy2\", \"d_fy_year2\", \"d_fy_quarter_seq2\", \"d_fy_week_seq2\", \"d_day_name2\", \"d_quarter_name2\", \"d_holiday2\", \"d_weekend2\", \"d_following_holiday2\", \"d_first_dom2\", \"d_last_dom2\", \"d_same_day_ly2\", \"d_same_day_lq2\", \"d_current_day2\", \"d_current_week2\", \"d_current_month2\", \"d_current_quarter2\", \"d_current_year2\") ON \"t17\".\"ws_sold_date_sk\" = \"date_dim2\".\"d_date_sk2\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address2\" (\"ca_address_sk2\", \"ca_address_id2\", \"ca_street_number2\", \"ca_street_name2\", \"ca_street_type2\", \"ca_suite_number2\", \"ca_city2\", \"ca_county2\", \"ca_state2\", \"ca_zip2\", \"ca_country2\", \"ca_gmt_offset2\", \"ca_location_type2\")\n                        WHERE CAST(\"ca_state2\" AS CHAR(2)) IN ('IL', 'MI')) AS \"t18\" ON \"t17\".\"ws_bill_addr_sk\" = \"t18\".\"ca_address_sk2\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item2\" (\"i_item_sk2\", \"i_item_id2\", \"i_rec_start_date2\", \"i_rec_end_date2\", \"i_item_desc2\", \"i_current_price2\", \"i_wholesale_cost2\", \"i_brand_id2\", \"i_brand2\", \"i_class_id2\", \"i_class2\", \"i_category_id2\", \"i_category2\", \"i_manufact_id2\", \"i_manufact2\", \"i_size2\", \"i_formulation2\", \"i_color2\", \"i_units2\", \"i_container2\", \"i_manager_id2\", \"i_product_name2\")\n                        WHERE (\"i_color2\" = 'cornsilk' OR \"i_color2\" = 'rosy') AND (\"i_manager_id2\" >= 80 AND \"i_manager_id2\" <= 99)) AS \"t19\" ON \"t17\".\"ws_item_sk\" = \"t19\".\"i_item_sk2\"\n                GROUP BY \"date_dim2\".\"d_year2\", \"date_dim2\".\"d_qoy2\", \"t18\".\"ca_county2\") AS \"t21\"\n        WHERE \"t21\".\"d_qoy2\" = 1 AND \"t21\".\"d_year2\" = 2002) AS \"t22\" ON \"t4\".\"ca_county\" = \"t22\".\"ca_county2\"\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t24\".\"ca_county3\", \"date_dim3\".\"d_qoy3\", \"date_dim3\".\"d_year3\", SUM(\"t23\".\"ws_ext_sales_price0\") AS \"web_sales\"\n                FROM (SELECT *\n                        FROM \"web_sales\" AS \"web_sales0\" (\"ws_sold_date_sk0\", \"ws_sold_time_sk0\", \"ws_ship_date_sk0\", \"ws_item_sk0\", \"ws_bill_customer_sk0\", \"ws_bill_cdemo_sk0\", \"ws_bill_hdemo_sk0\", \"ws_bill_addr_sk0\", \"ws_ship_customer_sk0\", \"ws_ship_cdemo_sk0\", \"ws_ship_hdemo_sk0\", \"ws_ship_addr_sk0\", \"ws_web_page_sk0\", \"ws_web_site_sk0\", \"ws_ship_mode_sk0\", \"ws_warehouse_sk0\", \"ws_promo_sk0\", \"ws_order_number0\", \"ws_quantity0\", \"ws_wholesale_cost0\", \"ws_list_price0\", \"ws_sales_price0\", \"ws_ext_discount_amt0\", \"ws_ext_sales_price0\", \"ws_ext_wholesale_cost0\", \"ws_ext_list_price0\", \"ws_ext_tax0\", \"ws_coupon_amt0\", \"ws_ext_ship_cost0\", \"ws_net_paid0\", \"ws_net_paid_inc_tax0\", \"ws_net_paid_inc_ship0\", \"ws_net_paid_inc_ship_tax0\", \"ws_net_profit0\")\n                        WHERE \"ws_list_price0\" >= 248 AND \"ws_list_price0\" <= 262) AS \"t23\"\n                    INNER JOIN \"date_dim\" AS \"date_dim3\" (\"d_date_sk3\", \"d_date_id3\", \"d_date3\", \"d_month_seq3\", \"d_week_seq3\", \"d_quarter_seq3\", \"d_year3\", \"d_dow3\", \"d_moy3\", \"d_dom3\", \"d_qoy3\", \"d_fy_year3\", \"d_fy_quarter_seq3\", \"d_fy_week_seq3\", \"d_day_name3\", \"d_quarter_name3\", \"d_holiday3\", \"d_weekend3\", \"d_following_holiday3\", \"d_first_dom3\", \"d_last_dom3\", \"d_same_day_ly3\", \"d_same_day_lq3\", \"d_current_day3\", \"d_current_week3\", \"d_current_month3\", \"d_current_quarter3\", \"d_current_year3\") ON \"t23\".\"ws_sold_date_sk0\" = \"date_dim3\".\"d_date_sk3\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address3\" (\"ca_address_sk3\", \"ca_address_id3\", \"ca_street_number3\", \"ca_street_name3\", \"ca_street_type3\", \"ca_suite_number3\", \"ca_city3\", \"ca_county3\", \"ca_state3\", \"ca_zip3\", \"ca_country3\", \"ca_gmt_offset3\", \"ca_location_type3\")\n                        WHERE CAST(\"ca_state3\" AS CHAR(2)) IN ('IL', 'MI')) AS \"t24\" ON \"t23\".\"ws_bill_addr_sk0\" = \"t24\".\"ca_address_sk3\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item3\" (\"i_item_sk3\", \"i_item_id3\", \"i_rec_start_date3\", \"i_rec_end_date3\", \"i_item_desc3\", \"i_current_price3\", \"i_wholesale_cost3\", \"i_brand_id3\", \"i_brand3\", \"i_class_id3\", \"i_class3\", \"i_category_id3\", \"i_category3\", \"i_manufact_id3\", \"i_manufact3\", \"i_size3\", \"i_formulation3\", \"i_color3\", \"i_units3\", \"i_container3\", \"i_manager_id3\", \"i_product_name3\")\n                        WHERE (\"i_color3\" = 'cornsilk' OR \"i_color3\" = 'rosy') AND (\"i_manager_id3\" >= 80 AND \"i_manager_id3\" <= 99)) AS \"t25\" ON \"t23\".\"ws_item_sk0\" = \"t25\".\"i_item_sk3\"\n                GROUP BY \"date_dim3\".\"d_year3\", \"date_dim3\".\"d_qoy3\", \"t24\".\"ca_county3\") AS \"t27\"\n        WHERE \"t27\".\"d_qoy3\" = 2 AND \"t27\".\"d_year3\" = 2002) AS \"t28\" ON \"t22\".\"ca_county2\" = \"t28\".\"ca_county3\" AND CASE WHEN \"t22\".\"web_sales\" > 0 THEN \"t28\".\"web_sales\" / \"t22\".\"web_sales\" ELSE NULL END > CASE WHEN \"t4\".\"store_sales\" > 0 THEN \"t10\".\"store_sales\" / \"t4\".\"store_sales\" ELSE NULL END\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t30\".\"ca_county4\", \"date_dim4\".\"d_qoy4\", \"date_dim4\".\"d_year4\", SUM(\"t29\".\"ws_ext_sales_price1\") AS \"web_sales\"\n                FROM (SELECT *\n                        FROM \"web_sales\" AS \"web_sales1\" (\"ws_sold_date_sk1\", \"ws_sold_time_sk1\", \"ws_ship_date_sk1\", \"ws_item_sk1\", \"ws_bill_customer_sk1\", \"ws_bill_cdemo_sk1\", \"ws_bill_hdemo_sk1\", \"ws_bill_addr_sk1\", \"ws_ship_customer_sk1\", \"ws_ship_cdemo_sk1\", \"ws_ship_hdemo_sk1\", \"ws_ship_addr_sk1\", \"ws_web_page_sk1\", \"ws_web_site_sk1\", \"ws_ship_mode_sk1\", \"ws_warehouse_sk1\", \"ws_promo_sk1\", \"ws_order_number1\", \"ws_quantity1\", \"ws_wholesale_cost1\", \"ws_list_price1\", \"ws_sales_price1\", \"ws_ext_discount_amt1\", \"ws_ext_sales_price1\", \"ws_ext_wholesale_cost1\", \"ws_ext_list_price1\", \"ws_ext_tax1\", \"ws_coupon_amt1\", \"ws_ext_ship_cost1\", \"ws_net_paid1\", \"ws_net_paid_inc_tax1\", \"ws_net_paid_inc_ship1\", \"ws_net_paid_inc_ship_tax1\", \"ws_net_profit1\")\n                        WHERE \"ws_list_price1\" >= 248 AND \"ws_list_price1\" <= 262) AS \"t29\"\n                    INNER JOIN \"date_dim\" AS \"date_dim4\" (\"d_date_sk4\", \"d_date_id4\", \"d_date4\", \"d_month_seq4\", \"d_week_seq4\", \"d_quarter_seq4\", \"d_year4\", \"d_dow4\", \"d_moy4\", \"d_dom4\", \"d_qoy4\", \"d_fy_year4\", \"d_fy_quarter_seq4\", \"d_fy_week_seq4\", \"d_day_name4\", \"d_quarter_name4\", \"d_holiday4\", \"d_weekend4\", \"d_following_holiday4\", \"d_first_dom4\", \"d_last_dom4\", \"d_same_day_ly4\", \"d_same_day_lq4\", \"d_current_day4\", \"d_current_week4\", \"d_current_month4\", \"d_current_quarter4\", \"d_current_year4\") ON \"t29\".\"ws_sold_date_sk1\" = \"date_dim4\".\"d_date_sk4\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address4\" (\"ca_address_sk4\", \"ca_address_id4\", \"ca_street_number4\", \"ca_street_name4\", \"ca_street_type4\", \"ca_suite_number4\", \"ca_city4\", \"ca_county4\", \"ca_state4\", \"ca_zip4\", \"ca_country4\", \"ca_gmt_offset4\", \"ca_location_type4\")\n                        WHERE CAST(\"ca_state4\" AS CHAR(2)) IN ('IL', 'MI')) AS \"t30\" ON \"t29\".\"ws_bill_addr_sk1\" = \"t30\".\"ca_address_sk4\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item4\" (\"i_item_sk4\", \"i_item_id4\", \"i_rec_start_date4\", \"i_rec_end_date4\", \"i_item_desc4\", \"i_current_price4\", \"i_wholesale_cost4\", \"i_brand_id4\", \"i_brand4\", \"i_class_id4\", \"i_class4\", \"i_category_id4\", \"i_category4\", \"i_manufact_id4\", \"i_manufact4\", \"i_size4\", \"i_formulation4\", \"i_color4\", \"i_units4\", \"i_container4\", \"i_manager_id4\", \"i_product_name4\")\n                        WHERE (\"i_color4\" = 'cornsilk' OR \"i_color4\" = 'rosy') AND (\"i_manager_id4\" >= 80 AND \"i_manager_id4\" <= 99)) AS \"t31\" ON \"t29\".\"ws_item_sk1\" = \"t31\".\"i_item_sk4\"\n                GROUP BY \"date_dim4\".\"d_year4\", \"date_dim4\".\"d_qoy4\", \"t30\".\"ca_county4\") AS \"t33\"\n        WHERE \"t33\".\"d_qoy4\" = 3 AND \"t33\".\"d_year4\" = 2002) AS \"t34\" ON \"t22\".\"ca_county2\" = \"t34\".\"ca_county4\" AND CASE WHEN \"t28\".\"web_sales\" > 0 THEN \"t34\".\"web_sales\" / \"t28\".\"web_sales\" ELSE NULL END > CASE WHEN \"t10\".\"store_sales\" > 0 THEN \"t16\".\"store_sales\" / \"t10\".\"store_sales\" ELSE NULL END\nORDER BY 3;"
  },
  "query031_1": {
    "rules_requested": [
      "FILTER_INTO_JOIN",
      "AGGREGATE_PROJECT_MERGE",
      "PROJECT_REDUCE_EXPRESSIONS"
    ],
    "rules_applied": [
      "FILTER_INTO_JOIN",
      "AGGREGATE_PROJECT_MERGE",
      "PROJECT_REDUCE_EXPRESSIONS"
    ],
    "rewrite_ms": 100,
    "wall_ms": 99.7,
    "output_sql": "SELECT \"t4\".\"ca_county\", CAST(1998 AS INTEGER) AS \"d_year5\", \"t28\".\"web_sales\" / \"t22\".\"web_sales\" AS \"web_q1_q2_increase\", \"t10\".\"store_sales\" / \"t4\".\"store_sales\" AS \"store_q1_q2_increase\", \"t34\".\"web_sales\" / \"t28\".\"web_sales\" AS \"web_q2_q3_increase\", \"t16\".\"store_sales\" / \"t10\".\"store_sales\" AS \"store_q2_q3_increase\"\nFROM (SELECT *\n        FROM (SELECT \"t0\".\"ca_county\", \"date_dim\".\"d_qoy\", \"date_dim\".\"d_year\", SUM(\"t\".\"ss_ext_sales_price\") AS \"store_sales\"\n                FROM (SELECT *\n                        FROM \"store_sales\"\n                        WHERE \"ss_list_price\" >= 107 AND \"ss_list_price\" <= 121) AS \"t\"\n                    INNER JOIN \"date_dim\" ON \"t\".\"ss_sold_date_sk\" = \"date_dim\".\"d_date_sk\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\"\n                        WHERE CAST(\"ca_state\" AS CHAR(2)) IN ('KS', 'ND')) AS \"t0\" ON \"t\".\"ss_addr_sk\" = \"t0\".\"ca_address_sk\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\"\n                        WHERE (\"i_color\" = 'mint' OR \"i_color\" = 'thistle') AND (\"i_manager_id\" >= 13 AND \"i_manager_id\" <= 32)) AS \"t1\" ON \"t\".\"ss_item_sk\" = \"t1\".\"i_item_sk\"\n                GROUP BY \"date_dim\".\"d_year\", \"date_dim\".\"d_qoy\", \"t0\".\"ca_county\") AS \"t3\"\n        WHERE \"t3\".\"d_qoy\" = 1 AND \"t3\".\"d_year\" = 1998) AS \"t4\"\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t6\".\"ca_county0\", \"date_dim0\".\"d_qoy0\", \"date_dim0\".\"d_year0\", SUM(\"t5\".\"ss_ext_sales_price0\") AS \"store_sales\"\n                FROM (SELECT *\n                        FROM \"store_sales\" AS \"store_sales0\" (\"ss_sold_date_sk0\", \"ss_sold_time_sk0\", \"ss_item_sk0\", \"ss_customer_sk0\", \"ss_cdemo_sk0\", \"ss_hdemo_sk0\", \"ss_addr_sk0\", \"ss_store_sk0\", \"ss_promo_sk0\", \"ss_ticket_number0\", \"ss_quantity0\", \"ss_wholesale_cost0\", \"ss_list_price0\", \"ss_sales_price0\", \"ss_ext_discount_amt0\", \"ss_ext_sales_price0\", \"ss_ext_wholesale_cost0\", \"ss_ext_list_price0\", \"ss_ext_tax0\", \"ss_coupon_amt0\", \"ss_net_paid0\", \"ss_net_paid_inc_tax0\", \"ss_net_profit0\")\n                        WHERE \"ss_list_price0\" >= 107 AND \"ss_list_price0\" <= 121) AS \"t5\"\n                    INNER JOIN \"date_dim\" AS \"date_dim0\" (\"d_date_sk0\", \"d_date_id0\", \"d_date0\", \"d_month_seq0\", \"d_week_seq0\", \"d_quarter_seq0\", \"d_year0\", \"d_dow0\", \"d_moy0\", \"d_dom0\", \"d_qoy0\", \"d_fy_year0\", \"d_fy_quarter_seq0\", \"d_fy_week_seq0\", \"d_day_name0\", \"d_quarter_name0\", \"d_holiday0\", \"d_weekend0\", \"d_following_holiday0\", \"d_first_dom0\", \"d_last_dom0\", \"d_same_day_ly0\", \"d_same_day_lq0\", \"d_current_day0\", \"d_current_week0\", \"d_current_month0\", \"d_current_quarter0\", \"d_current_year0\") ON \"t5\".\"ss_sold_date_sk0\" = \"date_dim0\".\"d_date_sk0\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address0\" (\"ca_address_sk0\", \"ca_address_id0\", \"ca_street_number0\", \"ca_street_name0\", \"ca_street_type0\", \"ca_suite_number0\", \"ca_city0\", \"ca_county0\", \"ca_state0\", \"ca_zip0\", \"ca_country0\", \"ca_gmt_offset0\", \"ca_location_type0\")\n                        WHERE CAST(\"ca_state0\" AS CHAR(2)) IN ('KS', 'ND')) AS \"t6\" ON \"t5\".\"ss_addr_sk0\" = \"t6\".\"ca_address_sk0\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item0\" (\"i_item_sk0\", \"i_item_id0\", \"i_rec_start_date0\", \"i_rec_end_date0\", \"i_item_desc0\", \"i_current_price0\", \"i_wholesale_cost0\", \"i_brand_id0\", \"i_brand0\", \"i_class_id0\", \"i_class0\", \"i_category_id0\", \"i_category0\", \"i_manufact_id0\", \"i_manufact0\", \"i_size0\", \"i_formulation0\", \"i_color0\", \"i_units0\", \"i_container0\", \"i_manager_id0\", \"i_product_name0\")\n                        WHERE (\"i_color0\" = 'mint' OR \"i_color0\" = 'thistle') AND (\"i_manager_id0\" >= 13 AND \"i_manager_id0\" <= 32)) AS \"t7\" ON \"t5\".\"ss_item_sk0\" = \"t7\".\"i_item_sk0\"\n                GROUP BY \"date_dim0\".\"d_year0\", \"date_dim0\".\"d_qoy0\", \"t6\".\"ca_county0\") AS \"t9\"\n        WHERE \"t9\".\"d_qoy0\" = 2 AND \"t9\".\"d_year0\" = 1998) AS \"t10\" ON \"t4\".\"ca_county\" = \"t10\".\"ca_county0\"\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t12\".\"ca_county1\", \"date_dim1\".\"d_qoy1\", \"date_dim1\".\"d_year1\", SUM(\"t11\".\"ss_ext_sales_price1\") AS \"store_sales\"\n                FROM (SELECT *\n                        FROM \"store_sales\" AS \"store_sales1\" (\"ss_sold_date_sk1\", \"ss_sold_time_sk1\", \"ss_item_sk1\", \"ss_customer_sk1\", \"ss_cdemo_sk1\", \"ss_hdemo_sk1\", \"ss_addr_sk1\", \"ss_store_sk1\", \"ss_promo_sk1\", \"ss_ticket_number1\", \"ss_quantity1\", \"ss_wholesale_cost1\", \"ss_list_price1\", \"ss_sales_price1\", \"ss_ext_discount_amt1\", \"ss_ext_sales_price1\", \"ss_ext_wholesale_cost1\", \"ss_ext_list_price1\", \"ss_ext_tax1\", \"ss_coupon_amt1\", \"ss_net_paid1\", \"ss_net_paid_inc_tax1\", \"ss_net_profit1\")\n                        WHERE \"ss_list_price1\" >= 107 AND \"ss_list_price1\" <= 121) AS \"t11\"\n                    INNER JOIN \"date_dim\" AS \"date_dim1\" (\"d_date_sk1\", \"d_date_id1\", \"d_date1\", \"d_month_seq1\", \"d_week_seq1\", \"d_quarter_seq1\", \"d_year1\", \"d_dow1\", \"d_moy1\", \"d_dom1\", \"d_qoy1\", \"d_fy_year1\", \"d_fy_quarter_seq1\", \"d_fy_week_seq1\", \"d_day_name1\", \"d_quarter_name1\", \"d_holiday1\", \"d_weekend1\", \"d_following_holiday1\", \"d_first_dom1\", \"d_last_dom1\", \"d_same_day_ly1\", \"d_same_day_lq1\", \"d_current_day1\", \"d_current_week1\", \"d_current_month1\", \"d_current_quarter1\", \"d_current_year1\") ON \"t11\".\"ss_sold_date_sk1\" = \"date_dim1\".\"d_date_sk1\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address1\" (\"ca_address_sk1\", \"ca_address_id1\", \"ca_street_number1\", \"ca_street_name1\", \"ca_street_type1\", \"ca_suite_number1\", \"ca_city1\", \"ca_county1\", \"ca_state1\", \"ca_zip1\", \"ca_country1\", \"ca_gmt_offset1\", \"ca_location_type1\")\n                        WHERE CAST(\"ca_state1\" AS CHAR(2)) IN ('KS', 'ND')) AS \"t12\" ON \"t11\".\"ss_addr_sk1\" = \"t12\".\"ca_address_sk1\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item1\" (\"i_item_sk1\", \"i_item_id1\", \"i_rec_start_date1\", \"i_rec_end_date1\", \"i_item_desc1\", \"i_current_price1\", \"i_wholesale_cost1\", \"i_brand_id1\", \"i_brand1\", \"i_class_id1\", \"i_class1\", \"i_category_id1\", \"i_category1\", \"i_manufact_id1\", \"i_manufact1\", \"i_size1\", \"i_formulation1\", \"i_color1\", \"i_units1\", \"i_container1\", \"i_manager_id1\", \"i_product_name1\")\n                        WHERE (\"i_color1\" = 'mint' OR \"i_color1\" = 'thistle') AND (\"i_manager_id1\" >= 13 AND \"i_manager_id1\" <= 32)) AS \"t13\" ON \"t11\".\"ss_item_sk1\" = \"t13\".\"i_item_sk1\"\n                GROUP BY \"date_dim1\".\"d_year1\", \"date_dim1\".\"d_qoy1\", \"t12\".\"ca_county1\") AS \"t15\"\n        WHERE \"t15\".\"d_qoy1\" = 3 AND \"t15\".\"d_year1\" = 1998) AS \"t16\" ON \"t10\".\"ca_county0\" = \"t16\".\"ca_county1\"\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t18\".\"ca_county2\", \"date_dim2\".\"d_qoy2\", \"date_dim2\".\"d_year2\", SUM(\"t17\".\"ws_ext_sales_price\") AS \"web_sales\"\n                FROM (SELECT *\n                        FROM \"web_sales\"\n                        WHERE \"ws_list_price\" >= 107 AND \"ws_list_price\" <= 121) AS \"t17\"\n                    INNER JOIN \"date_dim\" AS \"date_dim2\" (\"d_date_sk2\", \"d_date_id2\", \"d_date2\", \"d_month_seq2\", \"d_week_seq2\", \"d_quarter_seq2\", \"d_year2\", \"d_dow2\", \"d_moy2\", \"d_dom2\", \"d_qoy2\", \"d_fy_year2\", \"d_fy_quarter_seq2\", \"d_fy_week_seq2\", \"d_day_name2\", \"d_quarter_name2\", \"d_holiday2\", \"d_weekend2\", \"d_following_holiday2\", \"d_first_dom2\", \"d_last_dom2\", \"d_same_day_ly2\", \"d_same_day_lq2\", \"d_current_day2\", \"d_current_week2\", \"d_current_month2\", \"d_current_quarter2\", \"d_current_year2\") ON \"t17\".\"ws_sold_date_sk\" = \"date_dim2\".\"d_date_sk2\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address2\" (\"ca_address_sk2\", \"ca_address_id2\", \"ca_street_number2\", \"ca_street_name2\", \"ca_street_type2\", \"ca_suite_number2\", \"ca_city2\", \"ca_county2\", \"ca_state2\", \"ca_zip2\", \"ca_country2\", \"ca_gmt_offset2\", \"ca_location_type2\")\n                        WHERE CAST(\"ca_state2\" AS CHAR(2)) IN ('KS', 'ND')) AS \"t18\" ON \"t17\".\"ws_bill_addr_sk\" = \"t18\".\"ca_address_sk2\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item2\" (\"i_item_sk2\", \"i_item_id2\", \"i_rec_start_date2\", \"i_rec_end_date2\", \"i_item_desc2\", \"i_current_price2\", \"i_wholesale_cost2\", \"i_brand_id2\", \"i_brand2\", \"i_class_id2\", \"i_class2\", \"i_category_id2\", \"i_category2\", \"i_manufact_id2\", \"i_manufact2\", \"i_size2\", \"i_formulation2\", \"i_color2\", \"i_units2\", \"i_container2\", \"i_manager_id2\", \"i_product_name2\")\n                        WHERE (\"i_color2\" = 'mint' OR \"i_color2\" = 'thistle') AND (\"i_manager_id2\" >= 13 AND \"i_manager_id2\" <= 32)) AS \"t19\" ON \"t17\".\"ws_item_sk\" = \"t19\".\"i_item_sk2\"\n                GROUP BY \"date_dim2\".\"d_year2\", \"date_dim2\".\"d_qoy2\", \"t18\".\"ca_county2\") AS \"t21\"\n        WHERE \"t21\".\"d_qoy2\" = 1 AND \"t21\".\"d_year2\" = 1998) AS \"t22\" ON \"t4\".\"ca_county\" = \"t22\".\"ca_county2\"\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t24\".\"ca_county3\", \"date_dim3\".\"d_qoy3\", \"date_dim3\".\"d_year3\", SUM(\"t23\".\"ws_ext_sales_price0\") AS \"web_sales\"\n                FROM (SELECT *\n                        FROM \"web_sales\" AS \"web_sales0\" (\"ws_sold_date_sk0\", \"ws_sold_time_sk0\", \"ws_ship_date_sk0\", \"ws_item_sk0\", \"ws_bill_customer_sk0\", \"ws_bill_cdemo_sk0\", \"ws_bill_hdemo_sk0\", \"ws_bill_addr_sk0\", \"ws_ship_customer_sk0\", \"ws_ship_cdemo_sk0\", \"ws_ship_hdemo_sk0\", \"ws_ship_addr_sk0\", \"ws_web_page_sk0\", \"ws_web_site_sk0\", \"ws_ship_mode_sk0\", \"ws_warehouse_sk0\", \"ws_promo_sk0\", \"ws_order_number0\", \"ws_quantity0\", \"ws_wholesale_cost0\", \"ws_list_price0\", \"ws_sales_price0\", \"ws_ext_discount_amt0\", \"ws_ext_sales_price0\", \"ws_ext_wholesale_cost0\", \"ws_ext_list_price0\", \"ws_ext_tax0\", \"ws_coupon_amt0\", \"ws_ext_ship_cost0\", \"ws_net_paid0\", \"ws_net_paid_inc_tax0\", \"ws_net_paid_inc_ship0\", \"ws_net_paid_inc_ship_tax0\", \"ws_net_profit0\")\n                        WHERE \"ws_list_price0\" >= 107 AND \"ws_list_price0\" <= 121) AS \"t23\"\n                    INNER JOIN \"date_dim\" AS \"date_dim3\" (\"d_date_sk3\", \"d_date_id3\", \"d_date3\", \"d_month_seq3\", \"d_week_seq3\", \"d_quarter_seq3\", \"d_year3\", \"d_dow3\", \"d_moy3\", \"d_dom3\", \"d_qoy3\", \"d_fy_year3\", \"d_fy_quarter_seq3\", \"d_fy_week_seq3\", \"d_day_name3\", \"d_quarter_name3\", \"d_holiday3\", \"d_weekend3\", \"d_following_holiday3\", \"d_first_dom3\", \"d_last_dom3\", \"d_same_day_ly3\", \"d_same_day_lq3\", \"d_current_day3\", \"d_current_week3\", \"d_current_month3\", \"d_current_quarter3\", \"d_current_year3\") ON \"t23\".\"ws_sold_date_sk0\" = \"date_dim3\".\"d_date_sk3\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address3\" (\"ca_address_sk3\", \"ca_address_id3\", \"ca_street_number3\", \"ca_street_name3\", \"ca_street_type3\", \"ca_suite_number3\", \"ca_city3\", \"ca_county3\", \"ca_state3\", \"ca_zip3\", \"ca_country3\", \"ca_gmt_offset3\", \"ca_location_type3\")\n                        WHERE CAST(\"ca_state3\" AS CHAR(2)) IN ('KS', 'ND')) AS \"t24\" ON \"t23\".\"ws_bill_addr_sk0\" = \"t24\".\"ca_address_sk3\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item3\" (\"i_item_sk3\", \"i_item_id3\", \"i_rec_start_date3\", \"i_rec_end_date3\", \"i_item_desc3\", \"i_current_price3\", \"i_wholesale_cost3\", \"i_brand_id3\", \"i_brand3\", \"i_class_id3\", \"i_class3\", \"i_category_id3\", \"i_category3\", \"i_manufact_id3\", \"i_manufact3\", \"i_size3\", \"i_formulation3\", \"i_color3\", \"i_units3\", \"i_container3\", \"i_manager_id3\", \"i_product_name3\")\n                        WHERE (\"i_color3\" = 'mint' OR \"i_color3\" = 'thistle') AND (\"i_manager_id3\" >= 13 AND \"i_manager_id3\" <= 32)) AS \"t25\" ON \"t23\".\"ws_item_sk0\" = \"t25\".\"i_item_sk3\"\n                GROUP BY \"date_dim3\".\"d_year3\", \"date_dim3\".\"d_qoy3\", \"t24\".\"ca_county3\") AS \"t27\"\n        WHERE \"t27\".\"d_qoy3\" = 2 AND \"t27\".\"d_year3\" = 1998) AS \"t28\" ON \"t22\".\"ca_county2\" = \"t28\".\"ca_county3\" AND CASE WHEN \"t22\".\"web_sales\" > 0 THEN \"t28\".\"web_sales\" / \"t22\".\"web_sales\" ELSE NULL END > CASE WHEN \"t4\".\"store_sales\" > 0 THEN \"t10\".\"store_sales\" / \"t4\".\"store_sales\" ELSE NULL END\n    INNER JOIN (SELECT *\n        FROM (SELECT \"t30\".\"ca_county4\", \"date_dim4\".\"d_qoy4\", \"date_dim4\".\"d_year4\", SUM(\"t29\".\"ws_ext_sales_price1\") AS \"web_sales\"\n                FROM (SELECT *\n                        FROM \"web_sales\" AS \"web_sales1\" (\"ws_sold_date_sk1\", \"ws_sold_time_sk1\", \"ws_ship_date_sk1\", \"ws_item_sk1\", \"ws_bill_customer_sk1\", \"ws_bill_cdemo_sk1\", \"ws_bill_hdemo_sk1\", \"ws_bill_addr_sk1\", \"ws_ship_customer_sk1\", \"ws_ship_cdemo_sk1\", \"ws_ship_hdemo_sk1\", \"ws_ship_addr_sk1\", \"ws_web_page_sk1\", \"ws_web_site_sk1\", \"ws_ship_mode_sk1\", \"ws_warehouse_sk1\", \"ws_promo_sk1\", \"ws_order_number1\", \"ws_quantity1\", \"ws_wholesale_cost1\", \"ws_list_price1\", \"ws_sales_price1\", \"ws_ext_discount_amt1\", \"ws_ext_sales_price1\", \"ws_ext_wholesale_cost1\", \"ws_ext_list_price1\", \"ws_ext_tax1\", \"ws_coupon_amt1\", \"ws_ext_ship_cost1\", \"ws_net_paid1\", \"ws_net_paid_inc_tax1\", \"ws_net_paid_inc_ship1\", \"ws_net_paid_inc_ship_tax1\", \"ws_net_profit1\")\n                        WHERE \"ws_list_price1\" >= 107 AND \"ws_list_price1\" <= 121) AS \"t29\"\n                    INNER JOIN \"date_dim\" AS \"date_dim4\" (\"d_date_sk4\", \"d_date_id4\", \"d_date4\", \"d_month_seq4\", \"d_week_seq4\", \"d_quarter_seq4\", \"d_year4\", \"d_dow4\", \"d_moy4\", \"d_dom4\", \"d_qoy4\", \"d_fy_year4\", \"d_fy_quarter_seq4\", \"d_fy_week_seq4\", \"d_day_name4\", \"d_quarter_name4\", \"d_holiday4\", \"d_weekend4\", \"d_following_holiday4\", \"d_first_dom4\", \"d_last_dom4\", \"d_same_day_ly4\", \"d_same_day_lq4\", \"d_current_day4\", \"d_current_week4\", \"d_current_month4\", \"d_current_quarter4\", \"d_current_year4\") ON \"t29\".\"ws_sold_date_sk1\" = \"date_dim4\".\"d_date_sk4\"\n                    INNER JOIN (SELECT *\n                        FROM \"customer_address\" AS \"customer_address4\" (\"ca_address_sk4\", \"ca_address_id4\", \"ca_street_number4\", \"ca_street_name4\", \"ca_street_type4\", \"ca_suite_number4\", \"ca_city4\", \"ca_county4\", \"ca_state4\", \"ca_zip4\", \"ca_country4\", \"ca_gmt_offset4\", \"ca_location_type4\")\n                        WHERE CAST(\"ca_state4\" AS CHAR(2)) IN ('KS', 'ND')) AS \"t30\" ON \"t29\".\"ws_bill_addr_sk1\" = \"t30\".\"ca_address_sk4\"\n                    INNER JOIN (SELECT *\n                        FROM \"item\" AS \"item4\" (\"i_item_sk4\", \"i_item_id4\", \"i_rec_start_date4\", \"i_rec_end_date4\", \"i_item_desc4\", \"i_current_price4\", \"i_wholesale_cost4\", \"i_brand_id4\", \"i_brand4\", \"i_class_id4\", \"i_class4\", \"i_category_id4\", \"i_category4\", \"i_manufact_id4\", \"i_manufact4\", \"i_size4\", \"i_formulation4\", \"i_color4\", \"i_units4\", \"i_container4\", \"i_manager_id4\", \"i_product_name4\")\n                        WHERE (\"i_color4\" = 'mint' OR \"i_color4\" = 'thistle') AND (\"i_manager_id4\" >= 13 AND \"i_manager_id4\" <= 32)) AS \"t31\" ON \"t29\".\"ws_item_sk1\" = \"t31\".\"i_item_sk4\"\n                GROUP BY \"date_dim4\".\"d_year4\", \"date_dim4\".\"d_qoy4\", \"t30\".\"ca_county4\") AS \"t33\"\n        WHERE \"t33\".\"d_qoy4\" = 3 AND \"t33\".\"d_year4\" = 1998) AS \"t34\" ON \"t22\".\"ca_county2\" = \"t34\".\"ca_county4\" AND CASE WHEN \"t28\".\"web_sales\" > 0 THEN \"t34\".\"web_sales\" / \"t28\".\"web_sales\" ELSE NULL END > CASE WHEN \"t10\".\"store_sales\" > 0 THEN \"t16\".\"store_sales\" / \"t10\".\"store_sales\" ELSE NULL END\nORDER BY 5;"
  },
  "query084_0": {
    "rules_requested": [
      "FILTER_REDUCE_EXPRESSIONS"
    ],
    "rules_applied": [
      "FILTER_REDUCE_EXPRESSIONS"
    ],
    "rewrite_ms": 52,
    "wall_ms": 52.5,
    "output_sql": "SELECT \"customer\".\"c_customer_id\" AS \"customer_id\", CASE WHEN \"customer\".\"c_last_name\" IS NOT NULL THEN CAST(\"customer\".\"c_last_name\" AS CHAR) ELSE '' END || ', ' || CASE WHEN \"customer\".\"c_first_name\" IS NOT NULL THEN CAST(\"customer\".\"c_first_name\" AS CHAR) ELSE '' END AS \"customername\"\nFROM \"customer\",\n    \"customer_address\",\n    \"customer_demographics\",\n    \"household_demographics\",\n    \"income_band\",\n    \"store_returns\"\nWHERE \"customer_address\".\"ca_city\" = 'Marion' AND \"customer\".\"c_current_addr_sk\" = \"customer_address\".\"ca_address_sk\" AND (\"income_band\".\"ib_lower_bound\" >= 26340 AND \"income_band\".\"ib_upper_bound\" <= 76340) AND (\"income_band\".\"ib_income_band_sk\" = \"household_demographics\".\"hd_income_band_sk\" AND \"customer_demographics\".\"cd_demo_sk\" = \"customer\".\"c_current_cdemo_sk\" AND (\"household_demographics\".\"hd_demo_sk\" = \"customer\".\"c_current_hdemo_sk\" AND \"store_returns\".\"sr_cdemo_sk\" = \"customer_demographics\".\"cd_demo_sk\"))\nORDER BY \"customer\".\"c_customer_id\"\nFETCH NEXT 100 ROWS ONLY;"
  },
  "query084_1": {
    "rules_requested": [
      "FILTER_REDUCE_EXPRESSIONS",
      "FILTER_INTO_JOIN",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "rules_applied": [
      "FILTER_REDUCE_EXPRESSIONS",
      "FILTER_INTO_JOIN",
      "SORT_PROJECT_TRANSPOSE"
    ],
    "rewrite_ms": 31,
    "wall_ms": 31.8,
    "output_sql": "SELECT \"customer\".\"c_customer_id\" AS \"customer_id\", CASE WHEN \"customer\".\"c_last_name\" IS NOT NULL THEN CAST(\"customer\".\"c_last_name\" AS CHAR) ELSE '' END || ', ' || CASE WHEN \"customer\".\"c_first_name\" IS NOT NULL THEN CAST(\"customer\".\"c_first_name\" AS CHAR) ELSE '' END AS \"customername\"\nFROM \"customer\"\n    INNER JOIN (SELECT *\n        FROM \"customer_address\"\n        WHERE \"ca_city\" = 'Walnut Grove') AS \"t\" ON \"customer\".\"c_current_addr_sk\" = \"t\".\"ca_address_sk\"\n    INNER JOIN \"customer_demographics\" ON \"customer\".\"c_current_cdemo_sk\" = \"customer_demographics\".\"cd_demo_sk\"\n    INNER JOIN \"household_demographics\" ON \"customer\".\"c_current_hdemo_sk\" = \"household_demographics\".\"hd_demo_sk\"\n    INNER JOIN (SELECT *\n        FROM \"income_band\"\n        WHERE \"ib_lower_bound\" >= 46206 AND \"ib_upper_bound\" <= 96206) AS \"t0\" ON \"household_demographics\".\"hd_income_band_sk\" = \"t0\".\"ib_income_band_sk\"\n    INNER JOIN \"store_returns\" ON \"customer_demographics\".\"cd_demo_sk\" = \"store_returns\".\"sr_cdemo_sk\"\nORDER BY \"customer\".\"c_customer_id\"\nFETCH NEXT 100 ROWS ONLY;"
  },
  "query085_0": {
    "rules_requested": [
      "FILTER_REDUCE_EXPRESSIONS",
      "FILTER_INTO_JOIN",
      "AGGREGATE_PROJECT_MERGE"
    ],
    "rules_applied": [
      "FILTER_REDUCE_EXPRESSIONS",
      "FILTER_INTO_JOIN",
      "AGGREGATE_PROJECT_MERGE"
    ],
    "rewrite_ms": 100,
    "wall_ms": 100.7,
    "output_sql": "SELECT SUBSTRING(\"reason\".\"r_reason_desc\", 1, 20), AVG(\"web_sales\".\"ws_quantity\"), AVG(\"web_returns\".\"wr_refunded_cash\"), AVG(\"web_returns\".\"wr_fee\")\nFROM \"web_sales\"\n    INNER JOIN \"web_returns\" ON \"web_sales\".\"ws_item_sk\" = \"web_returns\".\"wr_item_sk\" AND \"web_sales\".\"ws_order_number\" = \"web_returns\".\"wr_order_number\"\n    INNER JOIN \"web_page\" ON \"web_sales\".\"ws_web_page_sk\" = \"web_page\".\"wp_web_page_sk\"\n    INNER JOIN \"customer_demographics\" ON \"web_returns\".\"wr_refunded_cdemo_sk\" = \"customer_demographics\".\"cd_demo_sk\"\n    INNER JOIN \"customer_demographics\" AS \"customer_demographics0\" (\"cd_demo_sk0\", \"cd_gender0\", \"cd_marital_status0\", \"cd_education_status0\", \"cd_purchase_estimate0\", \"cd_credit_rating0\", \"cd_dep_count0\", \"cd_dep_employed_count0\", \"cd_dep_college_count0\") ON \"web_returns\".\"wr_returning_cdemo_sk\" = \"customer_demographics0\".\"cd_demo_sk0\" AND (\"customer_demographics\".\"cd_marital_status\" = 'S' AND \"customer_demographics\".\"cd_marital_status\" = \"customer_demographics0\".\"cd_marital_status0\" AND \"customer_demographics\".\"cd_education_status\" = 'Unknown' AND \"customer_demographics\".\"cd_education_status\" = \"customer_demographics0\".\"cd_education_status0\" AND (\"web_sales\".\"ws_sales_price\" >= 100.00 AND \"web_sales\".\"ws_sales_price\" <= 150.00) OR \"customer_demographics\".\"cd_marital_status\" = 'D' AND \"customer_demographics\".\"cd_marital_status\" = \"customer_demographics0\".\"cd_marital_status0\" AND \"customer_demographics\".\"cd_education_status\" = 'Advanced Degree' AND \"customer_demographics\".\"cd_education_status\" = \"customer_demographics0\".\"cd_education_status0\" AND (\"web_sales\".\"ws_sales_price\" >= 50.00 AND \"web_sales\".\"ws_sales_price\" <= 100.00) OR \"customer_demographics\".\"cd_marital_status\" = 'M' AND \"customer_demographics\".\"cd_marital_status\" = \"customer_demographics0\".\"cd_marital_status0\" AND \"customer_demographics\".\"cd_education_status\" = 'Secondary' AND \"customer_demographics\".\"cd_education_status\" = \"customer_demographics0\".\"cd_education_status0\" AND (\"web_sales\".\"ws_sales_price\" >= 150.00 AND \"web_sales\".\"ws_sales_price\" <= 200.00))\n    INNER JOIN \"customer_address\" ON \"web_returns\".\"wr_refunded_addr_sk\" = \"customer_address\".\"ca_address_sk\" AND (\"customer_address\".\"ca_country\" = 'United States' AND CAST(\"customer_address\".\"ca_state\" AS CHAR(2)) IN ('KS', 'ND', 'OK') AND (\"web_sales\".\"ws_net_profit\" >= 100 AND \"web_sales\".\"ws_net_profit\" <= 200) OR \"customer_address\".\"ca_country\" = 'United States' AND CAST(\"customer_address\".\"ca_state\" AS CHAR(2)) IN ('GA', 'LA', 'NC') AND (\"web_sales\".\"ws_net_profit\" >= 150 AND \"web_sales\".\"ws_net_profit\" <= 300) OR \"customer_address\".\"ca_country\" = 'United States' AND CAST(\"customer_address\".\"ca_state\" AS CHAR(2)) IN ('IL', 'ME', 'MI') AND (\"web_sales\".\"ws_net_profit\" >= 50 AND \"web_sales\".\"ws_net_profit\" <= 250))\n    INNER JOIN (SELECT *\n        FROM \"date_dim\"\n        WHERE \"d_year\" = 2002) AS \"t\" ON \"web_sales\".\"ws_sold_date_sk\" = \"t\".\"d_date_sk\"\n    INNER JOIN \"reason\" ON \"web_returns\".\"wr_reason_sk\" = \"reason\".\"r_reason_sk\"\nGROUP BY \"reason\".\"r_reason_desc\"\nORDER BY 1, 2, 3, 4\nFETCH NEXT 100 ROWS ONLY;"
  },
  "query085_1": {
    "rules_requested": [
      "FILTER_REDUCE_EXPRESSIONS",
      "FILTER_INTO_JOIN",
      "AGGREGATE_PROJECT_MERGE"
    ],
    "rules_applied": [
      "FILTER_REDUCE_EXPRESSIONS",
      "FILTER_INTO_JOIN",
      "AGGREGATE_PROJECT_MERGE"
    ],
    "rewrite_ms": 45,
    "wall_ms": 45.5,
    "output_sql": "SELECT SUBSTRING(\"reason\".\"r_reason_desc\", 1, 20), AVG(\"web_sales\".\"ws_quantity\"), AVG(\"web_returns\".\"wr_refunded_cash\"), AVG(\"web_returns\".\"wr_fee\")\nFROM \"web_sales\"\n    INNER JOIN \"web_returns\" ON \"web_sales\".\"ws_item_sk\" = \"web_returns\".\"wr_item_sk\" AND \"web_sales\".\"ws_order_number\" = \"web_returns\".\"wr_order_number\"\n    INNER JOIN \"web_page\" ON \"web_sales\".\"ws_web_page_sk\" = \"web_page\".\"wp_web_page_sk\"\n    INNER JOIN \"customer_demographics\" ON \"web_returns\".\"wr_refunded_cdemo_sk\" = \"customer_demographics\".\"cd_demo_sk\"\n    INNER JOIN \"customer_demographics\" AS \"customer_demographics0\" (\"cd_demo_sk0\", \"cd_gender0\", \"cd_marital_status0\", \"cd_education_status0\", \"cd_purchase_estimate0\", \"cd_credit_rating0\", \"cd_dep_count0\", \"cd_dep_employed_count0\", \"cd_dep_college_count0\") ON \"web_returns\".\"wr_returning_cdemo_sk\" = \"customer_demographics0\".\"cd_demo_sk0\" AND (\"customer_demographics\".\"cd_marital_status\" = 'M' AND \"customer_demographics\".\"cd_marital_status\" = \"customer_demographics0\".\"cd_marital_status0\" AND \"customer_demographics\".\"cd_education_status\" = '2 yr Degree' AND \"customer_demographics\".\"cd_education_status\" = \"customer_demographics0\".\"cd_education_status0\" AND (\"web_sales\".\"ws_sales_price\" >= 100.00 AND \"web_sales\".\"ws_sales_price\" <= 150.00) OR \"customer_demographics\".\"cd_marital_status\" = 'S' AND \"customer_demographics\".\"cd_marital_status\" = \"customer_demographics0\".\"cd_marital_status0\" AND \"customer_demographics\".\"cd_education_status\" = 'Unknown' AND \"customer_demographics\".\"cd_education_status\" = \"customer_demographics0\".\"cd_education_status0\" AND (\"web_sales\".\"ws_sales_price\" >= 50.00 AND \"web_sales\".\"ws_sales_price\" <= 100.00) OR \"customer_demographics\".\"cd_marital_status\" = 'D' AND \"customer_demographics\".\"cd_marital_status\" = \"customer_demographics0\".\"cd_marital_status0\" AND \"customer_demographics\".\"cd_education_status\" = 'Advanced Degree' AND \"customer_demographics\".\"cd_education_status\" = \"customer_demographics0\".\"cd_education_status0\" AND (\"web_sales\".\"ws_sales_price\" >= 150.00 AND \"web_sales\".\"ws_sales_price\" <= 200.00))\n    INNER JOIN \"customer_address\" ON \"web_returns\".\"wr_refunded_addr_sk\" = \"customer_address\".\"ca_address_sk\" AND (\"customer_address\".\"ca_country\" = 'United States' AND CAST(\"customer_address\".\"ca_state\" AS CHAR(2)) IN ('MN', 'OK', 'WV') AND (\"web_sales\".\"ws_net_profit\" >= 100 AND \"web_sales\".\"ws_net_profit\" <= 200) OR \"customer_address\".\"ca_country\" = 'United States' AND CAST(\"customer_address\".\"ca_state\" AS CHAR(2)) IN ('IL', 'OK', 'VA') AND (\"web_sales\".\"ws_net_profit\" >= 150 AND \"web_sales\".\"ws_net_profit\" <= 300) OR \"customer_address\".\"ca_country\" = 'United States' AND CAST(\"customer_address\".\"ca_state\" AS CHAR(2)) IN ('GA', 'KY', 'VA') AND (\"web_sales\".\"ws_net_profit\" >= 50 AND \"web_sales\".\"ws_net_profit\" <= 250))\n    INNER JOIN (SELECT *\n        FROM \"date_dim\"\n        WHERE \"d_year\" = 1998) AS \"t\" ON \"web_sales\".\"ws_sold_date_sk\" = \"t\".\"d_date_sk\"\n    INNER JOIN \"reason\" ON \"web_returns\".\"wr_reason_sk\" = \"reason\".\"r_reason_sk\"\nGROUP BY \"reason\".\"r_reason_desc\"\nORDER BY 1, 2, 3, 4\nFETCH NEXT 100 ROWS ONLY;"
  },
  "query091_0": {
    "rules_requested": [
      "AGGREGATE_PROJECT_MERGE",
      "FILTER_INTO_JOIN"
    ],
    "rules_applied": [
      "AGGREGATE_PROJECT_MERGE",
      "FILTER_INTO_JOIN"
    ],
    "rewrite_ms": 50,
    "wall_ms": 50.1,
    "output_sql": "SELECT \"call_center\".\"cc_call_center_id\" AS \"call_center\", \"call_center\".\"cc_name\" AS \"call_center_name\", \"call_center\".\"cc_manager\" AS \"manager\", SUM(\"catalog_returns\".\"cr_net_loss\") AS \"returns_loss\"\nFROM \"call_center\"\n    INNER JOIN \"catalog_returns\" ON \"call_center\".\"cc_call_center_sk\" = \"catalog_returns\".\"cr_call_center_sk\"\n    INNER JOIN (SELECT *\n        FROM \"date_dim\"\n        WHERE \"d_year\" = 2000 AND \"d_moy\" = 3) AS \"t\" ON \"catalog_returns\".\"cr_returned_date_sk\" = \"t\".\"d_date_sk\"\n    INNER JOIN \"customer\" ON \"catalog_returns\".\"cr_returning_customer_sk\" = \"customer\".\"c_customer_sk\"\n    INNER JOIN (SELECT *\n        FROM \"customer_address\"\n        WHERE CAST(\"ca_gmt_offset\" AS DECIMAL(12, 2)) = -7) AS \"t0\" ON \"customer\".\"c_current_addr_sk\" = \"t0\".\"ca_address_sk\"\n    INNER JOIN (SELECT *\n        FROM \"customer_demographics\"\n        WHERE \"cd_marital_status\" = 'M' AND \"cd_education_status\" = 'Unknown' OR \"cd_marital_status\" = 'W' AND \"cd_education_status\" = 'Advanced Degree') AS \"t1\" ON \"customer\".\"c_current_cdemo_sk\" = \"t1\".\"cd_demo_sk\"\n    INNER JOIN (SELECT *\n        FROM \"household_demographics\"\n        WHERE \"hd_buy_potential\" LIKE '501-1000%') AS \"t2\" ON \"customer\".\"c_current_hdemo_sk\" = \"t2\".\"hd_demo_sk\"\nGROUP BY \"call_center\".\"cc_call_center_id\", \"call_center\".\"cc_name\", \"call_center\".\"cc_manager\", \"t1\".\"cd_marital_status\", \"t1\".\"cd_education_status\"\nORDER BY 4 DESC;"
  },
  "query091_1": {
    "rules_requested": [
      "FILTER_INTO_JOIN",
      "JOIN_TO_CORRELATE",
      "AGGREGATE_PROJECT_MERGE"
    ],
    "rules_applied": [
      "FILTER_INTO_JOIN",
      "JOIN_TO_CORRELATE",
      "AGGREGATE_PROJECT_MERGE"
    ],
    "rewrite_ms": 81,
    "wall_ms": 81.7,
    "output_sql": "SELECT \"call_center\".\"cc_call_center_id\" AS \"call_center\", \"call_center\".\"cc_name\" AS \"call_center_name\", \"call_center\".\"cc_manager\" AS \"manager\", SUM(\"t\".\"cr_net_loss\") AS \"returns_loss\"\nFROM \"call_center\"\n    INNER JOIN (SELECT *\n        FROM \"catalog_returns\"\n        WHERE \"cr_call_center_sk\" IS NOT NULL) AS \"t\" ON \"call_center\".\"cc_call_center_sk\" = \"t\".\"cr_call_center_sk\"\n    INNER JOIN (SELECT *\n        FROM \"date_dim\"\n        WHERE \"d_year\" = 2002 AND \"d_moy\" = 3) AS \"t0\" ON \"t\".\"cr_returned_date_sk\" = \"t0\".\"d_date_sk\"\n    INNER JOIN \"customer\" ON \"t\".\"cr_returning_customer_sk\" = \"customer\".\"c_customer_sk\"\n    INNER JOIN (SELECT *\n        FROM \"customer_address\"\n        WHERE CAST(\"ca_gmt_offset\" AS DECIMAL(12, 2)) = -7) AS \"t1\" ON \"customer\".\"c_current_addr_sk\" = \"t1\".\"ca_address_sk\"\n    INNER JOIN (SELECT *\n        FROM \"customer_demographics\"\n        WHERE \"cd_marital_status\" = 'M' AND \"cd_education_status\" = 'Unknown' OR \"cd_marital_status\" = 'W' AND \"cd_education_status\" = 'Advanced Degree') AS \"t2\" ON \"customer\".\"c_current_cdemo_sk\" = \"t2\".\"cd_demo_sk\"\n    INNER JOIN (SELECT *\n        FROM \"household_demographics\"\n        WHERE \"hd_buy_potential\" LIKE '1001-5000%') AS \"t3\" ON \"customer\".\"c_current_hdemo_sk\" = \"t3\".\"hd_demo_sk\"\nGROUP BY \"call_center\".\"cc_call_center_id\", \"call_center\".\"cc_name\", \"call_center\".\"cc_manager\", \"t2\".\"cd_marital_status\", \"t2\".\"cd_education_status\"\nORDER BY 4 DESC;"
  },
  "query094_0": {
    "rules_requested": [
      "FILTER_SUB_QUERY_TO_CORRELATE",
      "FILTER_REDUCE_EXPRESSIONS",
      "AGGREGATE_EXPAND_DISTINCT_AGGREGATES"
    ],
    "rules_applied": [
      "FILTER_SUB_QUERY_TO_CORRELATE",
      "FILTER_REDUCE_EXPRESSIONS",
      "AGGREGATE_EXPAND_DISTINCT_AGGREGATES"
    ],
    "rewrite_ms": 186,
    "wall_ms": 186.9,
    "output_sql": "SELECT COUNT(\"t19\".\"ws_order_number\") FILTER (WHERE \"t19\".\"$g_0\") AS \"order count\", MIN(\"t19\".\"total shipping cost\") FILTER (WHERE \"t19\".\"$g_1\") AS \"total shipping cost\", MIN(\"t19\".\"total net profit\") FILTER (WHERE \"t19\".\"$g_1\") AS \"total net profit\"\nFROM (SELECT \"t\".\"ws_order_number\", SUM(\"t\".\"ws_ext_ship_cost\") AS \"total shipping cost\", SUM(\"t\".\"ws_net_profit\") AS \"total net profit\", GROUPING(\"t\".\"ws_order_number\") = 0 AS \"$g_0\", GROUPING(\"t\".\"ws_order_number\") = 1 AS \"$g_1\"\n        FROM (SELECT *\n                FROM \"web_sales\"\n                WHERE \"ws_list_price\" >= 226 AND \"ws_list_price\" <= 255) AS \"t\"\n            INNER JOIN (SELECT *\n                FROM \"date_dim\"\n                WHERE \"d_date\" >= DATE '2002-06-01' AND \"d_date\" <= DATE '2002-07-31') AS \"t0\" ON \"t\".\"ws_ship_date_sk\" = \"t0\".\"d_date_sk\"\n            INNER JOIN (SELECT *\n                FROM \"customer_address\"\n                WHERE CAST(\"ca_state\" AS CHAR(2)) IN ('DC', 'MO', 'OH', 'OK', 'PA', 'SD')) AS \"t1\" ON \"t\".\"ws_ship_addr_sk\" = \"t1\".\"ca_address_sk\"\n            INNER JOIN (SELECT *\n                FROM \"web_site\"\n                WHERE \"web_gmt_offset\" >= -5) AS \"t2\" ON \"t\".\"ws_web_site_sk\" = \"t2\".\"web_site_sk\"\n            INNER JOIN (SELECT \"t8\".\"ws_warehouse_sk1\", \"t8\".\"ws_order_number1\", TRUE AS \"$f2\"\n                FROM \"web_sales\" AS \"web_sales0\" (\"ws_sold_date_sk0\", \"ws_sold_time_sk0\", \"ws_ship_date_sk0\", \"ws_item_sk0\", \"ws_bill_customer_sk0\", \"ws_bill_cdemo_sk0\", \"ws_bill_hdemo_sk0\", \"ws_bill_addr_sk0\", \"ws_ship_customer_sk0\", \"ws_ship_cdemo_sk0\", \"ws_ship_hdemo_sk0\", \"ws_ship_addr_sk0\", \"ws_web_page_sk0\", \"ws_web_site_sk0\", \"ws_ship_mode_sk0\", \"ws_warehouse_sk0\", \"ws_promo_sk0\", \"ws_order_number0\", \"ws_quantity0\", \"ws_wholesale_cost0\", \"ws_list_price0\", \"ws_sales_price0\", \"ws_ext_discount_amt0\", \"ws_ext_sales_price0\", \"ws_ext_wholesale_cost0\", \"ws_ext_list_price0\", \"ws_ext_tax0\", \"ws_coupon_amt0\", \"ws_ext_ship_cost0\", \"ws_net_paid0\", \"ws_net_paid_inc_tax0\", \"ws_net_paid_inc_ship0\", \"ws_net_paid_inc_ship_tax0\", \"ws_net_profit0\")\n                    INNER JOIN (SELECT \"t3\".\"ws_warehouse_sk1\", \"t3\".\"ws_order_number1\"\n                        FROM (SELECT *\n                                FROM \"web_sales\" AS \"web_sales1\" (\"ws_sold_date_sk1\", \"ws_sold_time_sk1\", \"ws_ship_date_sk1\", \"ws_item_sk1\", \"ws_bill_customer_sk1\", \"ws_bill_cdemo_sk1\", \"ws_bill_hdemo_sk1\", \"ws_bill_addr_sk1\", \"ws_ship_customer_sk1\", \"ws_ship_cdemo_sk1\", \"ws_ship_hdemo_sk1\", \"ws_ship_addr_sk1\", \"ws_web_page_sk1\", \"ws_web_site_sk1\", \"ws_ship_mode_sk1\", \"ws_warehouse_sk1\", \"ws_promo_sk1\", \"ws_order_number1\", \"ws_quantity1\", \"ws_wholesale_cost1\", \"ws_list_price1\", \"ws_sales_price1\", \"ws_ext_discount_amt1\", \"ws_ext_sales_price1\", \"ws_ext_wholesale_cost1\", \"ws_ext_list_price1\", \"ws_ext_tax1\", \"ws_coupon_amt1\", \"ws_ext_ship_cost1\", \"ws_net_paid1\", \"ws_net_paid_inc_tax1\", \"ws_net_paid_inc_ship1\", \"ws_net_paid_inc_ship_tax1\", \"ws_net_profit1\")\n                                WHERE \"ws_list_price1\" >= 226 AND \"ws_list_price1\" <= 255) AS \"t3\"\n                            INNER JOIN (SELECT *\n                                FROM \"date_dim\" AS \"date_dim0\" (\"d_date_sk0\", \"d_date_id0\", \"d_date0\", \"d_month_seq0\", \"d_week_seq0\", \"d_quarter_seq0\", \"d_year0\", \"d_dow0\", \"d_moy0\", \"d_dom0\", \"d_qoy0\", \"d_fy_year0\", \"d_fy_quarter_seq0\", \"d_fy_week_seq0\", \"d_day_name0\", \"d_quarter_name0\", \"d_holiday0\", \"d_weekend0\", \"d_following_holiday0\", \"d_first_dom0\", \"d_last_dom0\", \"d_same_day_ly0\", \"d_same_day_lq0\", \"d_current_day0\", \"d_current_week0\", \"d_current_month0\", \"d_current_quarter0\", \"d_current_year0\")\n                                WHERE \"d_date0\" >= DATE '2002-06-01' AND \"d_date0\" <= DATE '2002-07-31') AS \"t4\" ON \"t3\".\"ws_ship_date_sk1\" = \"t4\".\"d_date_sk0\"\n                            INNER JOIN (SELECT *\n                                FROM \"customer_address\" AS \"customer_address0\" (\"ca_address_sk0\", \"ca_address_id0\", \"ca_street_number0\", \"ca_street_name0\", \"ca_street_type0\", \"ca_suite_number0\", \"ca_city0\", \"ca_county0\", \"ca_state0\", \"ca_zip0\", \"ca_country0\", \"ca_gmt_offset0\", \"ca_location_type0\")\n                                WHERE CAST(\"ca_state0\" AS CHAR(2)) IN ('DC', 'MO', 'OH', 'OK', 'PA', 'SD')) AS \"t5\" ON \"t3\".\"ws_ship_addr_sk1\" = \"t5\".\"ca_address_sk0\"\n                            INNER JOIN (SELECT *\n                                FROM \"web_site\" AS \"web_site0\" (\"web_site_sk0\", \"web_site_id0\", \"web_rec_start_date0\", \"web_rec_end_date0\", \"web_name0\", \"web_open_date_sk0\", \"web_close_date_sk0\", \"web_class0\", \"web_manager0\", \"web_mkt_id0\", \"web_mkt_class0\", \"web_mkt_desc0\", \"web_market_manager0\", \"web_company_id0\", \"web_company_name0\", \"web_street_number0\", \"web_street_name0\", \"web_street_type0\", \"web_suite_number0\", \"web_city0\", \"web_county0\", \"web_state0\", \"web_zip0\", \"web_country0\", \"web_gmt_offset0\", \"web_tax_percentage0\")\n                                WHERE \"web_gmt_offset0\" >= -5) AS \"t6\" ON \"t3\".\"ws_web_site_sk1\" = \"t6\".\"web_site_sk0\"\n                        GROUP BY \"t3\".\"ws_warehouse_sk1\", \"t3\".\"ws_order_number1\") AS \"t8\" ON \"web_sales0\".\"ws_order_number0\" = \"t8\".\"ws_order_number1\" AND \"t8\".\"ws_warehouse_sk1\" <> \"web_sales0\".\"ws_warehouse_sk0\"\n                GROUP BY \"t8\".\"ws_warehouse_sk1\", \"t8\".\"ws_order_number1\") AS \"t11\" ON \"t\".\"ws_warehouse_sk\" = \"t11\".\"ws_warehouse_sk1\" AND \"t\".\"ws_order_number\" = \"t11\".\"ws_order_number1\"\n            LEFT JOIN (SELECT \"wr_order_number\", TRUE AS \"$f1\"\n                FROM \"web_returns\"\n                WHERE \"wr_reason_sk\" IN (3, 6, 18, 30, 40)\n                GROUP BY \"wr_order_number\") AS \"t15\" ON \"t\".\"ws_order_number\" = \"t15\".\"wr_order_number\"\n        WHERE \"t15\".\"$f1\" IS NULL\n        GROUP BY ROLLUP(\"t\".\"ws_order_number\")) AS \"t19\"\nORDER BY 1\nFETCH NEXT 100 ROWS ONLY;"
  },
  "query094_1": {
    "rules_requested": [
      "AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN",
      "AGGREGATE_PROJECT_MERGE"
    ],
    "rules_applied": [
      "AGGREGATE_EXPAND_DISTINCT_AGGREGATES_TO_JOIN",
      "AGGREGATE_PROJECT_MERGE"
    ],
    "rewrite_ms": 33,
    "wall_ms": 33.0,
    "output_sql": "SELECT COUNT(\"t2\".\"ws_order_number\") AS \"order count\", SUM(\"t2\".\"total shipping cost\") AS \"total shipping cost\", SUM(\"t2\".\"total net profit\") AS \"total net profit\"\nFROM (SELECT \"web_sales\".\"ws_order_number\", SUM(\"web_sales\".\"ws_ext_ship_cost\") AS \"total shipping cost\", SUM(\"web_sales\".\"ws_net_profit\") AS \"total net profit\"\n        FROM \"web_sales\",\n            \"date_dim\",\n            \"customer_address\",\n            \"web_site\"\n        WHERE \"date_dim\".\"d_date\" >= '2000-6-01' AND \"date_dim\".\"d_date\" <= (CAST('2000-6-01' AS DATE) + INTERVAL '60' DAY) AND (\"web_sales\".\"ws_ship_date_sk\" = \"date_dim\".\"d_date_sk\" AND (\"web_sales\".\"ws_ship_addr_sk\" = \"customer_address\".\"ca_address_sk\" AND (\"customer_address\".\"ca_state\" = 'IL' OR (\"customer_address\".\"ca_state\" = 'KY' OR \"customer_address\".\"ca_state\" = 'NE') OR (\"customer_address\".\"ca_state\" = 'PA' OR (\"customer_address\".\"ca_state\" = 'VT' OR \"customer_address\".\"ca_state\" = 'WI'))))) AND (\"web_sales\".\"ws_web_site_sk\" = \"web_site\".\"web_site_sk\" AND (\"web_site\".\"web_gmt_offset\" >= -7 AND \"web_sales\".\"ws_list_price\" >= 158) AND (\"web_sales\".\"ws_list_price\" <= 187 AND (EXISTS (SELECT *\n                                        FROM \"web_sales\" AS \"web_sales0\" (\"ws_sold_date_sk0\", \"ws_sold_time_sk0\", \"ws_ship_date_sk0\", \"ws_item_sk0\", \"ws_bill_customer_sk0\", \"ws_bill_cdemo_sk0\", \"ws_bill_hdemo_sk0\", \"ws_bill_addr_sk0\", \"ws_ship_customer_sk0\", \"ws_ship_cdemo_sk0\", \"ws_ship_hdemo_sk0\", \"ws_ship_addr_sk0\", \"ws_web_page_sk0\", \"ws_web_site_sk0\", \"ws_ship_mode_sk0\", \"ws_warehouse_sk0\", \"ws_promo_sk0\", \"ws_order_number0\", \"ws_quantity0\", \"ws_wholesale_cost0\", \"ws_list_price0\", \"ws_sales_price0\", \"ws_ext_discount_amt0\", \"ws_ext_sales_price0\", \"ws_ext_wholesale_cost0\", \"ws_ext_list_price0\", \"ws_ext_tax0\", \"ws_coupon_amt0\", \"ws_ext_ship_cost0\", \"ws_net_paid0\", \"ws_net_paid_inc_tax0\", \"ws_net_paid_inc_ship0\", \"ws_net_paid_inc_ship_tax0\", \"ws_net_profit0\")\n                                        WHERE \"web_sales\".\"ws_order_number\" = \"ws_order_number0\" AND \"web_sales\".\"ws_warehouse_sk\" <> \"ws_warehouse_sk0\") AND NOT EXISTS (SELECT *\n                                        FROM \"web_returns\"\n                                        WHERE \"web_sales\".\"ws_order_number\" = \"wr_order_number\" AND (\"wr_reason_sk\" = 18 OR \"wr_reason_sk\" = 23 OR \"wr_reason_sk\" = 26 OR \"wr_reason_sk\" = 35 OR \"wr_reason_sk\" = 74)))))\n        GROUP BY \"web_sales\".\"ws_order_number\") AS \"t2\"\nORDER BY 1\nFETCH NEXT 100 ROWS ONLY;"
  },
  "query099_0": {
    "rules_requested": [
      "FILTER_REDUCE_EXPRESSIONS",
      "FILTER_INTO_JOIN"
    ],
    "rules_applied": [
      "FILTER_REDUCE_EXPRESSIONS",
      "FILTER_INTO_JOIN"
    ],
    "rewrite_ms": 42,
    "wall_ms": 42.8,
    "output_sql": "SELECT SUBSTRING(\"t0\".\"w_warehouse_name\", 1, 20), \"t1\".\"sm_type\", \"t2\".\"cc_name\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" <= 30 THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" > 30 AND \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" <= 60 THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" > 60 AND \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" <= 90 THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" > 90 AND \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" <= 120 THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" > 120 THEN 1 ELSE 0 END) AS \">120 days\"\nFROM (SELECT *\n        FROM \"catalog_sales\"\n        WHERE \"cs_list_price\" >= 248 AND \"cs_list_price\" <= 277) AS \"t\"\n    INNER JOIN (SELECT *\n        FROM \"warehouse\"\n        WHERE CAST(\"w_gmt_offset\" AS DECIMAL(12, 2)) = -5) AS \"t0\" ON \"t\".\"cs_warehouse_sk\" = \"t0\".\"w_warehouse_sk\"\n    INNER JOIN (SELECT *\n        FROM \"ship_mode\"\n        WHERE \"sm_type\" = 'LIBRARY') AS \"t1\" ON \"t\".\"cs_ship_mode_sk\" = \"t1\".\"sm_ship_mode_sk\"\n    INNER JOIN (SELECT *\n        FROM \"call_center\"\n        WHERE \"cc_class\" = 'small') AS \"t2\" ON \"t\".\"cs_call_center_sk\" = \"t2\".\"cc_call_center_sk\"\n    INNER JOIN (SELECT *\n        FROM \"date_dim\"\n        WHERE \"d_month_seq\" >= 1201 AND \"d_month_seq\" <= 1224) AS \"t3\" ON \"t\".\"cs_ship_date_sk\" = \"t3\".\"d_date_sk\"\nGROUP BY SUBSTRING(\"t0\".\"w_warehouse_name\", 1, 20), \"t1\".\"sm_type\", \"t2\".\"cc_name\"\nORDER BY 1, \"t1\".\"sm_type\", \"t2\".\"cc_name\"\nFETCH NEXT 100 ROWS ONLY;"
  },
  "query099_1": {
    "rules_requested": [
      "FILTER_INTO_JOIN"
    ],
    "rules_applied": [
      "FILTER_INTO_JOIN"
    ],
    "rewrite_ms": 24,
    "wall_ms": 24.1,
    "output_sql": "SELECT SUBSTRING(\"t0\".\"w_warehouse_name\", 1, 20), \"t1\".\"sm_type\", \"t2\".\"cc_name\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" <= 30 THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" > 30 AND \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" <= 60 THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" > 60 AND \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" <= 90 THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" > 90 AND \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" <= 120 THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN \"t\".\"cs_ship_date_sk\" - \"t\".\"cs_sold_date_sk\" > 120 THEN 1 ELSE 0 END) AS \">120 days\"\nFROM (SELECT *\n        FROM \"catalog_sales\"\n        WHERE \"cs_list_price\" >= 13 AND \"cs_list_price\" <= 42) AS \"t\"\n    INNER JOIN (SELECT *\n        FROM \"warehouse\"\n        WHERE CAST(\"w_gmt_offset\" AS DECIMAL(12, 2)) = -5) AS \"t0\" ON \"t\".\"cs_warehouse_sk\" = \"t0\".\"w_warehouse_sk\"\n    INNER JOIN (SELECT *\n        FROM \"ship_mode\"\n        WHERE \"sm_type\" = 'EXPRESS') AS \"t1\" ON \"t\".\"cs_ship_mode_sk\" = \"t1\".\"sm_ship_mode_sk\"\n    INNER JOIN (SELECT *\n        FROM \"call_center\"\n        WHERE \"cc_class\" = 'small') AS \"t2\" ON \"t\".\"cs_call_center_sk\" = \"t2\".\"cc_call_center_sk\"\n    INNER JOIN (SELECT *\n        FROM \"date_dim\"\n        WHERE \"d_month_seq\" >= 1212 AND \"d_month_seq\" <= 1212 + 23) AS \"t3\" ON \"t\".\"cs_ship_date_sk\" = \"t3\".\"d_date_sk\"\nGROUP BY SUBSTRING(\"t0\".\"w_warehouse_name\", 1, 20), \"t1\".\"sm_type\", \"t2\".\"cc_name\"\nORDER BY 1, \"t1\".\"sm_type\", \"t2\".\"cc_name\"\nFETCH NEXT 100 ROWS ONLY;"
  }
}