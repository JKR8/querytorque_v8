┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE WITH broadband_canvas AS (SELECT a.customer_id, a.service_id, a.product_code, a.product_name, CASE WHEN NOT a.location_id IS NULL THEN a.technology_type ELSE NULL END AS service_technology, a.location_id, ak.address_id, a.customer_type, CASE WHEN b.plan_group = 'Plan_Group_Standard' THEN 'Plan_Tier_Standard' WHEN b.plan_group = 'Plan_Group_Basic' THEN 'Plan_Tier_Basic' WHEN b.plan_group = 'Plan_Group_Advanced' THEN 'Plan_Tier_Advanced' WHEN b.plan_group = 'Plan_Group_Premium' THEN 'Plan_Tier_Premium' WHEN b.plan_group = 'Plan_Group_High_Speed' THEN 'Plan_Tier_High_Speed' WHEN product_code = 'Plan_020' THEN CASE WHEN speed_class IN ('Speed_High', 'Speed_High_Plus') THEN 'Plan_Tier_Ultra' WHEN speed_class = 'Speed_Very_High' THEN 'Plan_Tier_Premium' ELSE 'Plan_Tier_Elite' END WHEN product_code = 'Plan_Code_001' THEN 'Plan_Tier_Ultra' WHEN product_code = 'Plan_Code_002' THEN 'Plan_Tier_Premium' WHEN b.plan_group = 'Plan_Group_Elite' THEN 'Plan_Tier_Elite' WHEN b.plan_group = 'Plan_Group_Standard_Voice' THEN 'Plan_Tier_Voice' WHEN b.plan_group IN ('Plan_Group_Bundled', 'Plan_Group_Family', 'Plan_Group_Trial', 'Plan_Group_Business', 'Plan_Group_Data') THEN 'Plan_Tier_Other' ELSE 'Plan_Tier_Other' END AS plan_parent FROM broadband_service_daily AS a LEFT JOIN plan_mapping AS b ON a.product_name = b.product_name LEFT JOIN (SELECT id AS location_id, address_id FROM address_mapping GROUP BY id, address_id) AS ak ON ak.location_id = a.location_id WHERE calendar_date = (SELECT MAX(calendar_date) FROM broadband_service_daily) AND customer_type IN ('Business', 'Consumer') AND NOT ak.address_id IS NULL GROUP BY a.customer_id, a.service_id, a.product_code, a.product_name, a.technology_type, a.location_id, ak.address_id, a.customer_type, CASE WHEN b.plan_group = 'Plan_Group_Standard' THEN 'Plan_Tier_Standard' WHEN b.plan_group = 'Plan_Group_Basic' THEN 'Plan_Tier_Basic' WHEN b.plan_group = 'Plan_Group_Advanced' THEN 'Plan_Tier_Advanced' WHEN b.plan_group = 'Plan_Group_Premium' THEN 'Plan_Tier_Premium' WHEN b.plan_group = 'Plan_Group_High_Speed' THEN 'Plan_Tier_High_Speed' WHEN product_code = 'Plan_020' THEN CASE WHEN speed_class IN ('Speed_High', 'Speed_High_Plus') THEN 'Plan_Tier_Ultra' WHEN speed_class = 'Speed_Very_High' THEN 'Plan_Tier_Premium' ELSE 'Plan_Tier_Elite' END WHEN product_code = 'Plan_Code_001' THEN 'Plan_Tier_Ultra' WHEN product_code = 'Plan_Code_002' THEN 'Plan_Tier_Premium' WHEN b.plan_group = 'Plan_Group_Elite' THEN 'Plan_Tier_Elite' WHEN b.plan_group = 'Plan_Group_Standard_Voice' THEN 'Plan_Tier_Voice' WHEN b.plan_group IN ('Plan_Group_Bundled', 'Plan_Group_Family', 'Plan_Group_Trial', 'Plan_Group_Business', 'Plan_Group_Data') THEN 'Plan_Tier_Other' ELSE 'Plan_Tier_Other' END), mobile_canvas AS (SELECT customer_id, service_id, customer_type, CASE WHEN service_category = 'Data' THEN 'Mobile_Broadband' ELSE 'Mobile_Voice' END AS plan_type_category, CASE WHEN product_code IN ('Product_001', 'Product_002', 'Product_003', 'Product_004', 'Product_005', 'Product_006') THEN 'Plan_Tier_Starter' WHEN product_code IN ('Product_007', 'Product_008', 'Product_009', 'Product_010', 'Product_011', 'Product_012') THEN 'Plan_Tier_Basic' WHEN product_code IN ('Product_013', 'Product_014', 'Product_015', 'Product_016', 'Product_017', 'Product_018') THEN 'Plan_Tier_Advanced' WHEN product_code IN ('Product_019', 'Product_020', 'Product_021', 'Product_022', 'Product_023', 'Product_024') THEN 'Plan_Tier_Premium' WHEN product_code IN ('Product_025', 'Product_026') THEN 'Plan_Tier_Bundle' WHEN product_code IN ('Product_027', 'Product_028') THEN 'Plan_Tier_Extra_Small' WHEN product_code IN ('Product_029', 'Product_030') THEN 'Plan_Tier_Small' WHEN product_code IN ('Product_031', 'Product_032', 'Product_033', 'Product_034') THEN 'Plan_Tier_Medium' WHEN product_code IN ('Product_035', 'Product_036', 'Product_037', 'Product_038') THEN 'Plan_Tier_Large' WHEN product_code IN ('Product_039', 'Product_040') THEN 'Plan_Tier_Extra_Large' WHEN service_category = 'Data' THEN 'Plan_Tier_Mobile_Data' ELSE 'Plan_Tier_Mobile_Other' END AS plan_parent FROM mobile_service_daily AS m WHERE calendar_date IN (SELECT MAX(calendar_date) FROM mobile_service_daily) AND customer_type IN ('Consumer', 'Business')), prepaid_canvas AS (SELECT DISTINCT customer_id, service_id, customer_type, CASE WHEN service_provider = 'Operator_A' AND NOT service_name LIKE '%Data%' THEN 'Plan_Tier_Voice_Service' WHEN service_provider = 'Operator_A' AND service_name LIKE '%Data%' THEN 'Plan_Tier_Data_Service' WHEN service_provider = 'Operator_B' AND NOT service_name LIKE '%Data%' THEN 'Plan_Tier_Alternative_Voice' ELSE 'Plan_Tier_Prepaid_Other' END AS plan_parent FROM prepaid_service_daily WHERE calendar_date = (SELECT MAX(calendar_date) FROM prepaid_service_daily) AND customer_type IN ('Consumer', 'Business')), broadband_active_status AS (SELECT ak.address_id, MAX(CASE WHEN ic1.service_connect_date >= CURRENT_DATE - INTERVAL '90' DAY THEN 'New_Customer' END) AS new_flag, MAX(CASE WHEN NOT ic2.location_id IS NULL THEN 'Active_Operator_A' END) AS active_flag, MAX(CASE WHEN ic2.location_id IS NULL THEN 'Inactive_Operator_A' END) AS inactive_flag FROM broadband_service_daily AS ic1 LEFT JOIN (SELECT id AS location_id, address_id FROM address_mapping GROUP BY id, address_id) AS ak ON ak.location_id = ic1.location_id LEFT JOIN (SELECT DISTINCT ic2.location_id, ic2.service_connect_date FROM broadband_service_daily AS ic2 WHERE calendar_date = (SELECT MAX(calendar_date) FROM broadband_service_daily) AND customer_type IN ('Consumer', 'Business')) AS ic2 ON ic1.location_id = ic2.location_id WHERE ic1.calendar_date >= CURRENT_DATE - INTERVAL '90' DAY AND ic1.customer_type IN ('Consumer', 'Business') GROUP BY ak.address_id), service_data_s1 AS (SELECT customer_id, service_id, customer_type, product_name, service_technology, location_id, plan_parent, CAST(NULL AS TEXT) AS plan_type_category, 'Broadband_Service' AS source FROM broadband_canvas UNION ALL SELECT customer_id, service_id, customer_type, NULL, NULL, NULL, plan_parent, NULL, 'Prepaid_Service' FROM prepaid_canvas UNION ALL SELECT customer_id, service_id, customer_type, NULL, NULL, NULL, plan_parent, plan_type_category, 'Mobile_Service' FROM mobile_canvas), service_tech AS (SELECT DISTINCT service_technology, location_id FROM service_data_s1), service_data AS (SELECT ak.address_id, CASE WHEN NOT ak.address_id IS NULL THEN LISTAGG(c.service_technology, ', ' ORDER BY c.service_technology) ELSE NULL END AS fixed_service_technology, MAX(CASE WHEN a.source = 'Broadband_Service' THEN 'Broadband_Service' END) AS broadband_service, MAX(CASE WHEN a.source = 'Mobile_Service' THEN 'Mobile_Service' END) AS mobile_service, MAX(CASE WHEN a.source = 'Prepaid_Service' THEN 'Prepaid_Service' END) AS prepaid_service, MAX(CASE WHEN a.plan_type_category = 'Data' THEN 'Mobile_Broadband' END) AS mobile_broadband, COUNT(DISTINCT CASE WHEN a.customer_type = 'Consumer' THEN a.customer_id ELSE NULL END) AS consumer_count, COUNT(DISTINCT CASE WHEN a.customer_type = 'Business' THEN a.customer_id ELSE NULL END) AS business_count, COUNT(DISTINCT CASE WHEN a.customer_type = 'Consumer' THEN a.service_id ELSE NULL END) AS consumer_services, COUNT(DISTINCT CASE WHEN a.customer_type = 'Business' THEN a.service_id ELSE NULL END) AS business_services, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Starter' THEN 1 ELSE 0 END) AS service_starter, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Basic' THEN 1 ELSE 0 END) AS service_basic, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Advanced' THEN 1 ELSE 0 END) AS service_advanced, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Premium' THEN 1 ELSE 0 END) AS service_premium, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Ultra' THEN 1 ELSE 0 END) AS service_ultra, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Elite' THEN 1 ELSE 0 END) AS service_elite, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_High_Speed' THEN 1 ELSE 0 END) AS service_high_speed, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Satellite' THEN 1 ELSE 0 END) AS service_satellite, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Voice' THEN 1 ELSE 0 END) AS service_voice, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Other' THEN 1 ELSE 0 END) AS service_other, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Voice_Service' THEN 1 ELSE 0 END) AS prepaid_voice_service, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Data_Service' THEN 1 ELSE 0 END) AS prepaid_data_service, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Alternative_Voice' THEN 1 ELSE 0 END) AS prepaid_alternative, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Prepaid_Other' THEN 1 ELSE 0 END) AS prepaid_other, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Starter' THEN 1 ELSE 0 END) AS mobile_voice_starter, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Basic' THEN 1 ELSE 0 END) AS mobile_voice_basic, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Advanced' THEN 1 ELSE 0 END) AS mobile_voice_advanced, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Premium' THEN 1 ELSE 0 END) AS mobile_voice_premium, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Bundle' THEN 1 ELSE 0 END) AS mobile_voice_bundle, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Mobile_Other' THEN 1 ELSE 0 END) AS mobile_other, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Extra_Small' THEN 1 ELSE 0 END) AS mobile_data_xs, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Small' THEN 1 ELSE 0 END) AS mobile_data_s, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Medium' THEN 1 ELSE 0 END) AS mobile_data_m, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Large' THEN 1 ELSE 0 END) AS mobile_data_l, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Extra_Large' THEN 1 ELSE 0 END) AS mobile_data_xl, SUM(CASE WHEN a.plan_parent = 'Plan_Tier_Mobile_Data' THEN 1 ELSE 0 END) AS mobile_data_other FROM service_data_s1 AS a LEFT JOIN (SELECT customer_id, location_id, customer_type FROM account_daily WHERE calendar_date IN (SELECT MAX(calendar_date) FROM account_daily)) AS b ON a.customer_id = b.customer_id LEFT JOIN (SELECT DISTINCT id AS location_id, address_id FROM address_mapping) AS ak ON COALESCE(a.location_id, b.location_id) = ak.location_id LEFT JOIN service_tech AS c ON a.location_id = c.location_id GROUP BY ak.address_id), connectivity_household_canvas AS (SELECT DISTINCT hh.address_id, consumer_count, consumer_services, business_count, business_services, "State", city, postal_code, latitude, longitude, area_type, fixed_service_technology, CONCAT_WS(',', sd.broadband_service, sd.mobile_service, sd.prepaid_service, sd.mobile_broadband) AS service_portfolio, CONCAT_WS(',', CASE WHEN consumer_count > 0 THEN 'Consumer' END, CASE WHEN business_count > 0 THEN 'Business' END) AS customer_segment, al.location_category AS location_classification, service_starter, service_basic, service_advanced, service_premium, service_ultra, service_elite, service_high_speed, service_voice, service_satellite, service_other, prepaid_voice_service, prepaid_data_service, prepaid_alternative, prepaid_other, mobile_voice_starter, mobile_voice_basic, mobile_voice_advanced, mobile_voice_premium, mobile_voice_bundle, mobile_other, mobile_data_xs, mobile_data_s, mobile_data_m, mobile_data_l, mobile_data_xl, mobile_data_other, mobile_voice_starter + mobile_voice_basic + mobile_voice_advanced + mobile_voice_premium + mobile_voice_bundle + mobile_other + mobile_data_xs + mobile_data_s + mobile_data_m + mobile_data_l + mobile_data_xl + mobile_data_other + service_starter + service_basic + service_advanced + service_premium + service_ultra + service_elite + service_high_speed + service_satellite + service_other + service_voice + prepaid_voice_service + prepaid_data_service + prepaid_alternative + prepaid_other AS total_services_per_household, service_starter + service_basic + service_advanced + service_premium + service_ultra + service_elite + service_high_speed + service_satellite + service_other + service_voice AS fixed_services_per_household, mobile_voice_starter + mobile_voice_basic + mobile_voice_advanced + mobile_voice_premium + mobile_voice_bundle + mobile_data_xs + mobile_data_s + mobile_data_m + mobile_data_l + mobile_data_xl + mobile_data_other + mobile_other AS mobile_services_per_household, prepaid_voice_service + prepaid_data_service + prepaid_alternative + prepaid_other AS prepaid_services_per_household, CASE WHEN NOT new_flag IS NULL THEN new_flag WHEN NOT active_flag IS NULL THEN active_flag WHEN NOT inactive_flag IS NULL THEN inactive_flag WHEN service_starter + service_basic + service_advanced + service_premium + service_ultra + service_elite + service_high_speed + service_satellite + service_other > 0 THEN 'Active_Operator_A' ELSE 'Not_With_Operator_A' END AS broadband_status FROM household_profile_canvas AS hh LEFT JOIN broadband_active_status AS fs ON fs.address_id = hh.address_id LEFT JOIN service_data AS sd ON sd.address_id = hh.address_id LEFT JOIN (SELECT DISTINCT address_id, location_category FROM address_location) AS al ON al.address_id = hh.address_id WHERE calendar_date = (SELECT MAX(calendar_date) FROM household_profile_canvas)) SELECT hh.address_id, consumer_count, business_count, consumer_services, business_services, "state", city, postal_code, latitude, longitude, area_type, fixed_service_technology, nf.technology_type AS network_tech_type, CASE WHEN NOT service_status IS NULL THEN CASE WHEN service_status = 'Service_Status_A' THEN 'Network_Type_A' WHEN service_status = 'Service_Status_B' THEN 'Network_Type_B_Pending' WHEN service_status = 'Service_Status_C' THEN 'Network_Type_C_Not_Installed' WHEN service_status = 'Service_Status_D' THEN 'Network_Type_D_Not_Installed' WHEN technology_type = 'Network_Type_A' AND service_status = 'Service_Status_E' THEN 'Network_Type_E_Pending' WHEN technology_type = 'Network_Type_A' AND service_status = 'Service_Status_F' THEN 'Network_Type_F_Pending' WHEN technology_type = 'Network_Type_A' AND service_status = 'Service_Status_G' THEN 'Network_Type_G_Active' WHEN technology_type = 'Network_Type_B' AND service_status = 'Service_Status_H' THEN 'Network_Type_H_Pending' WHEN technology_type = 'Network_Type_B' AND service_status = 'Service_Status_I' THEN 'Network_Type_I_Pending' WHEN technology_type = 'Network_Type_B' AND service_status = 'Service_Status_G' THEN 'Network_Type_B_Active' WHEN service_status = 'Service_Status_J' THEN 'Network_Type_J_Active' WHEN service_status = 'Service_Status_K' THEN 'Network_Type_K_Pending' WHEN service_status = 'Service_Status_L' THEN 'Network_Type_L_Pending' WHEN service_status = 'Service_Status_M' THEN 'Network_Type_M_Pending' WHEN service_status = 'Service_Status_N' THEN 'Network_Type_N_Not_Installed' WHEN service_status = 'Service_Status_O' THEN 'Network_Type_O_Active' WHEN service_status = 'Service_Status_P' THEN 'Network_Type_P_Pending' WHEN service_status = 'Service_Status_Q' THEN 'Network_Type_Q_Pending' WHEN service_status = 'Service_Status_R' THEN 'Network_Type_R_Not_Serviceable' WHEN service_status = 'Network_Pending' THEN 'Network_Type_Pending' WHEN service_status = 'Service_Status_S' THEN 'Network_Type_S_Active' WHEN service_status = 'Service_Status_T' THEN 'Network_Type_T_Pending' WHEN service_status = 'Service_Status_U' THEN 'Network_Type_U_Pending' WHEN service_status = 'Service_Status_V' THEN 'Network_Type_V_Planned' WHEN service_status = 'Service_Status_W' THEN 'Network_Type_W_Planned' WHEN service_status = 'Service_Status_X' THEN 'Network_Type_X_Planned' ELSE service_status END ELSE 'Not_In_Network_Footprint' END AS service_class, service_restriction, service_status, service_portfolio, customer_segment, location_classification, CASE WHEN NOT nf.address_id IS NULL THEN 'Network_A' ELSE 'Network_Other' END AS network_type, segment_type, segment_group, affluence, household_composition, household_income, head_of_household_age, household_lifestage, child_young_probability, child_teen_probability, service_starter AS plan_starter, service_basic AS plan_basic, service_advanced AS plan_advanced, service_premium AS plan_premium, service_ultra, service_elite, service_high_speed, service_voice, service_satellite, service_other, prepaid_voice_service, prepaid_data_service, prepaid_alternative, prepaid_other, mobile_voice_starter, mobile_voice_basic, mobile_voice_advanced, mobile_voice_premium, mobile_voice_bundle, mobile_other, mobile_data_xs, mobile_data_s, mobile_data_m, mobile_data_l, mobile_data_xl, mobile_data_other, total_services_per_household, fixed_services_per_household, mobile_services_per_household, prepaid_services_per_household, broadband_status FROM connectivity_household_canvas AS hh LEFT JOIN (SELECT DISTINCT address_id, service_status, service_restriction, technology_type FROM broadband_footprint) AS nf ON nf.address_id = hh.address_id LEFT JOIN tbl_household_segmentation AS m ON m.address_id = hh.address_id
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││               Total Time: 1.39s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│     CTE     │
│    ──────   │
│  CTE Name:  │
│service_data_│
│      s1     │
│             ├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
│ Table Index:│                                                                                                                                                                                                                                 
│     172     │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│    0 rows   │                                                                                                                                                                                                                                 
│   (0.00s)   │                                                                                                                                                                                                                                 
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                                 
│    UNION    │                                                                                                                                                                                                                                 
│    ──────   │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│             │                                                                                                                                                                                                          │                      
│    0 rows   │                                                                                                                                                                                                          │                      
│   (0.00s)   │                                                                                                                                                                                                          │                      
└──────┬──────┘                                                                                                                                                                                                          │                      
┌──────┴──────┐                                                                                                                                                                                                   ┌──────┴──────┐               
│    UNION    │                                                                                                                                                                                                   │  PROJECTION │               
│    ──────   │                                                                                                                                                                                                   │    ──────   │               
│             │                                                                                                                                                                                                   │ customer_id │               
│             │                                                                                                                                                                                                   │  service_id │               
│             │                                                                                                                                                                                                   │customer_type│               
│             │                                                                                                                                                                                                   │     NULL    │               
│             │                                                                                                                                                                                                   │     NULL    │               
│             │                                                                                                                                                                                                   │     NULL    │               
│             ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐                                                                                  │ plan_parent │               
│             │                                                                                                                │                                                                                  │plan_type_cat│               
│             │                                                                                                                │                                                                                  │    egory    │               
│             │                                                                                                                │                                                                                  │'Mobile_Servi│               
│             │                                                                                                                │                                                                                  │     ce'     │               
│             │                                                                                                                │                                                                                  │             │               
│    0 rows   │                                                                                                                │                                                                                  │ 30,515 rows │               
│   (0.00s)   │                                                                                                                │                                                                                  │   (0.00s)   │               
└──────┬──────┘                                                                                                                │                                                                                  └──────┬──────┘               
┌──────┴──────┐                                                                                                         ┌──────┴──────┐                                                                           ┌──────┴──────┐               
│  PROJECTION │                                                                                                         │  PROJECTION │                                                                           │  PROJECTION │               
│    ──────   │                                                                                                         │    ──────   │                                                                           │    ──────   │               
│ customer_id │                                                                                                         │ customer_id │                                                                           │ customer_id │               
│  service_id │                                                                                                         │  service_id │                                                                           │  service_id │               
│customer_type│                                                                                                         │customer_type│                                                                           │customer_type│               
│ product_name│                                                                                                         │     NULL    │                                                                           │plan_type_cat│               
│service_techn│                                                                                                         │     NULL    │                                                                           │    egory    │               
│    ology    │                                                                                                         │     NULL    │                                                                           │ plan_parent │               
│ location_id │                                                                                                         │ plan_parent │                                                                           │             │               
│ plan_parent │                                                                                                         │     NULL    │                                                                           │             │               
│plan_type_cat│                                                                                                         │'Prepaid_Serv│                                                                           │             │               
│    egory    │                                                                                                         │     ice'    │                                                                           │             │               
│    source   │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│  7,631 rows │                                                                                                         │  3,091 rows │                                                                           │ 30,515 rows │               
│   (0.00s)   │                                                                                                         │   (0.00s)   │                                                                           │   (0.00s)   │               
└──────┬──────┘                                                                                                         └──────┬──────┘                                                                           └──────┬──────┘               
┌──────┴──────┐                                                                                                         ┌──────┴──────┐                                                                           ┌──────┴──────┐               
│  PROJECTION │                                                                                                         │  PROJECTION │                                                                           │  PROJECTION │               
│    ──────   │                                                                                                         │    ──────   │                                                                           │    ──────   │               
│ customer_id │                                                                                                         │      #0     │                                                                           │ customer_id │               
│  service_id │                                                                                                         │      #1     │                                                                           │  service_id │               
│ product_name│                                                                                                         │__internal_de│                                                                           │customer_type│               
│service_techn│                                                                                                         │compress_stri│                                                                           │(service_cate│               
│    ology    │                                                                                                         │    ng(#2)   │                                                                           │ gory = 'Data│               
│ location_id │                                                                                                         │      #3     │                                                                           │      ')     │               
│customer_type│                                                                                                         │             │                                                                           │   IN (...)  │               
│ plan_parent │                                                                                                         │             │                                                                           │   IN (...)  │               
│             │                                                                                                         │             │                                                                           │   IN (...)  │               
│             │                                                                                                         │             │                                                                           │   IN (...)  │               
│             │                                                                                                         │             │                                                                           │ product_code│               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│  7,631 rows │                                                                                                         │  3,091 rows │                                                                           │ 30,515 rows │               
│   (0.00s)   │                                                                                                         │   (0.00s)   │                                                                           │   (0.00s)   │               
└──────┬──────┘                                                                                                         └──────┬──────┘                                                                           └──────┬──────┘               
┌──────┴──────┐                                                                                                         ┌──────┴──────┐                                                                           ┌──────┴──────┐               
│  PROJECTION │                                                                                                         │HASH_GROUP_BY│                                                                           │  HASH_JOIN  │               
│    ──────   │                                                                                                         │    ──────   │                                                                           │    ──────   │               
│      #0     │                                                                                                         │   Groups:   │                                                                           │  Join Type: │               
│      #1     │                                                                                                         │      #0     │                                                                           │     MARK    │               
│      #2     │                                                                                                         │      #1     │                                                                           │             │               
│      #3     │                                                                                                         │      #2     │                                                                           │ Conditions: │               
│__internal_de│                                                                                                         │      #3     │                                                                           │ product_code│               
│compress_stri│                                                                                                         │             │                                                                           │     = #0    │               
│    ng(#4)   │                                                                                                         │             │                                                                           │             │               
│      #5     │                                                                                                         │             │                                                                           │             │               
│      #6     │                                                                                                         │             │                                                                           │             │               
│__internal_de│                                                                                                         │             │                                                                           │             │               
│compress_stri│                                                                                                         │             │                                                                           │             │               
│    ng(#7)   │                                                                                                         │             │                                                                           │             │               
│      #8     │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             ├───────────────
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│  7,631 rows │                                                                                                         │  3,091 rows │                                                                           │ 30,515 rows │               
│   (0.00s)   │                                                                                                         │   (0.00s)   │                                                                           │   (0.00s)   │               
└──────┬──────┘                                                                                                         └──────┬──────┘                                                                           └──────┬──────┘               
┌──────┴──────┐                                                                                                         ┌──────┴──────┐                                                                           ┌──────┴──────┐               
│HASH_GROUP_BY│                                                                                                         │  PROJECTION │                                                                           │  HASH_JOIN  │               
│    ──────   │                                                                                                         │    ──────   │                                                                           │    ──────   │               
│   Groups:   │                                                                                                         │ customer_id │                                                                           │  Join Type: │               
│      #0     │                                                                                                         │  service_id │                                                                           │     MARK    │               
│      #1     │                                                                                                         │customer_type│                                                                           │             │               
│      #2     │                                                                                                         │ plan_parent │                                                                           │ Conditions: │               
│      #3     │                                                                                                         │             │                                                                           │ product_code│               
│      #4     │                                                                                                         │             │                                                                           │     = #0    │               
│      #5     │                                                                                                         │             │                                                                           │             │               
│      #6     │                                                                                                         │             │                                                                           │             │               
│      #7     │                                                                                                         │             │                                                                           │             │               
│      #8     │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             ├───────────────
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│  7,631 rows │                                                                                                         │  3,091 rows │                                                                           │ 30,515 rows │               
│   (0.01s)   │                                                                                                         │   (0.00s)   │                                                                           │   (0.00s)   │               
└──────┬──────┘                                                                                                         └──────┬──────┘                                                                           └──────┬──────┘               
┌──────┴──────┐                                                                                                         ┌──────┴──────┐                                                                           ┌──────┴──────┐               
│  PROJECTION │                                                                                                         │  PROJECTION │                                                                           │  HASH_JOIN  │               
│    ──────   │                                                                                                         │    ──────   │                                                                           │    ──────   │               
│ customer_id │                                                                                                         │      #0     │                                                                           │  Join Type: │               
│  service_id │                                                                                                         │      #1     │                                                                           │     MARK    │               
│ product_code│                                                                                                         │__internal_co│                                                                           │             │               
│ product_name│                                                                                                         │mpress_string│                                                                           │ Conditions: │               
│technology_ty│                                                                                                         │_uhugeint(#2)│                                                                           │ product_code│               
│      pe     │                                                                                                         │      #3     │                                                                           │     = #0    │               
│ location_id │                                                                                                         │             │                                                                           │             │               
│  address_id │                                                                                                         │             │                                                                           │             │               
│customer_type│                                                                                                         │             │                                                                           │             │               
│ CASE  WHEN (│                                                                                                         │             │                                                                           │             │               
│ (plan_group │                                                                                                         │             │                                                                           │             │               
│= 'Plan_Group│                                                                                                         │             │                                                                           │             │               
│ _Standard'))│                                                                                                         │             │                                                                           │             │               
│ THEN ('Plan_│                                                                                                         │             │                                                                           │             │               
│Tier_Standard│                                                                                                         │             │                                                                           │             │               
│  ') WHEN (  │                                                                                                         │             │                                                                           │             │               
│ (plan_group │                                                                                                         │             │                                                                           │             │               
│= 'Plan_Group│                                                                                                         │             │                                                                           │             │               
│  _Basic'))  │                                                                                                         │             │                                                                           │             │               
│ THEN ('Plan_│                                                                                                         │             │                                                                           │             │               
│ Tier_Basic')│                                                                                                         │             │                                                                           │             │               
│ WHEN ((plan_│                                                                                                         │             │                                                                           │             │               
│   group =   │                                                                                                         │             │                                                                           │             │               
│'Plan_Group_A│                                                                                                         │             │                                                                           │             │               
│  dvanced')) │                                                                                                         │             │                                                                           │             │               
│ THEN ('Plan_│                                                                                                         │             │                                                                           │             │               
│Tier_Advanced│                                                                                                         │             │                                                                           │             │               
│  ') WHEN (  │                                                                                                         │             │                                                                           │             │               
│ (plan_group │                                                                                                         │             │                                                                           │             │               
│= 'Plan_Group│                                                                                                         │             │                                                                           │             │               
│ _Premium')) │                                                                                                         │             │                                                                           │             │               
│ THEN ('Plan_│                                                                                                         │             │                                                                           │             │               
│ Tier_Premium│                                                                                                         │             │                                                                           │             │               
│  ') WHEN (  │                                                                                                         │             │                                                                           │             │               
│ (plan_group │                                                                                                         │             │                                                                           │             │               
│= 'Plan_Group│                                                                                                         │             │                                                                           │             │               
│ _High_Speed'│                                                                                                         │             │                                                                           │             │               
│  )) THEN (  │                                                                                                         │             │                                                                           │             │               
│'Plan_Tier_Hi│                                                                                                         │             │                                                                           │             │               
│  gh_Speed') │                                                                                                         │             │                                                                           │             │               
│ WHEN ((produ│                                                                                                         │             │                                                                           │             │               
│  ct_code =  │                                                                                                         │             │                                                                           │             │               
│ 'Plan_020'))│                                                                                                         │             │                                                                           │             │               
│  THEN (CASE │                                                                                                         │             │                                                                           │             │               
│ WHEN ((speed│                                                                                                         │             │                                                                           │             │               
│ _class IN ( │                                                                                                         │             │                                                                           │             │               
│ 'Speed_High'│                                                                                                         │             │                                                                           │             │               
│, 'Speed_High│                                                                                                         │             │                                                                           │             │               
│  _Plus')))  │                                                                                                         │             │                                                                           │             │               
│ THEN ('Plan_│                                                                                                         │             │                                                                           │             ├───────────────
│ Tier_Ultra')│                                                                                                         │             │                                                                           │             │               
│ WHEN ((speed│                                                                                                         │             │                                                                           │             │               
│  _class =   │                                                                                                         │             │                                                                           │             │               
│'Speed_Very_H│                                                                                                         │             │                                                                           │             │               
│ igh')) THEN │                                                                                                         │             │                                                                           │             │               
│('Plan_Tier_P│                                                                                                         │             │                                                                           │             │               
│   remium')  │                                                                                                         │             │                                                                           │             │               
│ ELSE 'Plan_T│                                                                                                         │             │                                                                           │             │               
│  ier_Elite' │                                                                                                         │             │                                                                           │             │               
│  END) WHEN (│                                                                                                         │             │                                                                           │             │               
│(product_code│                                                                                                         │             │                                                                           │             │               
│ = 'Plan_Code│                                                                                                         │             │                                                                           │             │               
│ _001')) THEN│                                                                                                         │             │                                                                           │             │               
│ ('Plan_Tier_│                                                                                                         │             │                                                                           │             │               
│ Ultra') WHEN│                                                                                                         │             │                                                                           │             │               
│ ((product_co│                                                                                                         │             │                                                                           │             │               
│de = 'Plan_Co│                                                                                                         │             │                                                                           │             │               
│  de_002'))  │                                                                                                         │             │                                                                           │             │               
│ THEN ('Plan_│                                                                                                         │             │                                                                           │             │               
│ Tier_Premium│                                                                                                         │             │                                                                           │             │               
│  ') WHEN (  │                                                                                                         │             │                                                                           │             │               
│ (plan_group │                                                                                                         │             │                                                                           │             │               
│= 'Plan_Group│                                                                                                         │             │                                                                           │             │               
│  _Elite'))  │                                                                                                         │             │                                                                           │             │               
│ THEN ('Plan_│                                                                                                         │             │                                                                           │             │               
│ Tier_Elite')│                                                                                                         │             │                                                                           │             │               
│ WHEN ((plan_│                                                                                                         │             │                                                                           │             │               
│   group =   │                                                                                                         │             │                                                                           │             │               
│'Plan_Group_S│                                                                                                         │             │                                                                           │             │               
│tandard_Voice│                                                                                                         │             │                                                                           │             │               
│  ')) THEN ( │                                                                                                         │             │                                                                           │             │               
│'Plan_Tier_Vo│                                                                                                         │             │                                                                           │             │               
│ ice') WHEN (│                                                                                                         │             │                                                                           │             │               
│ (plan_group │                                                                                                         │             │                                                                           │             │               
│ IN ('Plan_Gr│                                                                                                         │             │                                                                           │             │               
│ oup_Bundled'│                                                                                                         │             │                                                                           │             │               
│, 'Plan_Group│                                                                                                         │             │                                                                           │             │               
│  _Family',  │                                                                                                         │             │                                                                           │             │               
│'Plan_Group_T│                                                                                                         │             │                                                                           │             │               
│rial', 'Plan_│                                                                                                         │             │                                                                           │             │               
│Group_Busines│                                                                                                         │             │                                                                           │             │               
│s', 'Plan_Gro│                                                                                                         │             │                                                                           │             │               
│ up_Data'))) │                                                                                                         │             │                                                                           │             │               
│ THEN ('Plan_│                                                                                                         │             │                                                                           │             │               
│ Tier_Other')│                                                                                                         │             │                                                                           │             │               
│ ELSE 'Plan_T│                                                                                                         │             │                                                                           │             │               
│  ier_Other' │                                                                                                         │             │                                                                           │             │               
│      END    │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│  7,631 rows │                                                                                                         │  3,091 rows │                                                                           │ 30,515 rows │               
│   (0.00s)   │                                                                                                         │   (0.00s)   │                                                                           │   (0.00s)   │               
└──────┬──────┘                                                                                                         └──────┬──────┘                                                                           └──────┬──────┘               
┌──────┴──────┐                                                                                                         ┌──────┴──────┐                                                                           ┌──────┴──────┐               
│  PROJECTION │                                                                                                         │  PROJECTION │                                                                           │  HASH_JOIN  │               
│    ──────   │                                                                                                         │    ──────   │                                                                           │    ──────   │               
│      #0     │                                                                                                         │ customer_id │                                                                           │  Join Type: │               
│      #1     │                                                                                                         │  service_id │                                                                           │     MARK    │               
│__internal_co│                                                                                                         │customer_type│                                                                           │             │               
│mpress_string│                                                                                                         │ plan_parent │                                                                           │ Conditions: │               
│_uhugeint(#2)│                                                                                                         │             │                                                                           │ product_code│               
│      #3     │                                                                                                         │             │                                                                           │     = #0    │               
│      #4     │                                                                                                         │             │                                                                           │             │               
│      #5     │                                                                                                         │             │                                                                           │             │               
│__internal_co│                                                                                                         │             │                                                                           │             │               
│mpress_string│                                                                                                         │             │                                                                           │             │               
│_uhugeint(#6)│                                                                                                         │             │                                                                           │             │               
│      #7     │                                                                                                         │             │                                                                           │             │               
│      #8     │                                                                                                         │             │                                                                           │             │               
│      #9     │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             ├───────────────
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│  7,631 rows │                                                                                                         │  3,091 rows │                                                                           │ 30,515 rows │               
│   (0.00s)   │                                                                                                         │   (0.00s)   │                                                                           │   (0.00s)   │               
└──────┬──────┘                                                                                                         └──────┬──────┘                                                                           └──────┬──────┘               
┌──────┴──────┐                                                                                                         ┌──────┴──────┐                                                                           ┌──────┴──────┐               
│  HASH_JOIN  │                                                                                                         │  PROJECTION │                                                                           │  HASH_JOIN  │               
│    ──────   │                                                                                                         │    ──────   │                                                                           │    ──────   │               
│  Join Type: │                                                                                                         │ customer_id │                                                                           │  Join Type: │               
│    INNER    │                                                                                                         │  service_id │                                                                           │     SEMI    │               
│             │                                                                                                         │customer_type│                                                                           │             │               
│ Conditions: │                                                                                                         │(service_prov│                                                                           │ Conditions: │               
│ location_id │                                                                                                         │ider = 'Opera│                                                                           │calendar_date│               
│= location_id│                                                                                                         │   tor_A')   │                                                                           │     = #0    │               
│             │                                                                                                         │ service_name│                                                                           │             │               
│             │                                                                                                         │service_provi│                                                                           │             │               
│             │                                                                                                         │     der     │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             │                                                                                                         │             │                                                                           │             │               
│             ├───────┐                                                                                                 │             │                                                                           │             ├───────────────
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│             │       │                                                                                                 │             │                                                                           │             │               
│  7,631 rows │       │                                                                                                 │  3,091 rows │                                                                           │ 30,515 rows │               
│   (0.01s)   │       │                                                                                                 │   (0.00s)   │                                                                           │   (0.20s)   │               
└──────┬──────┘       │                                                                                                 └──────┬──────┘                                                                           └──────┬──────┘               
┌──────┴──────┐┌──────┴──────┐                                                                                          ┌──────┴──────┐                                                                           ┌──────┴──────┐               
│HASH_GROUP_BY││  HASH_JOIN  │                                                                                          │  HASH_JOIN  │                                                                           │  PROJECTION │               
│    ──────   ││    ──────   │                                                                                          │    ──────   │                                                                           │    ──────   │               
│   Groups:   ││  Join Type: │                                                                                          │  Join Type: │                                                                           │ customer_id │               
│      #0     ││    INNER    │                                                                                          │    INNER    │                                                                           │  service_id │               
│      #1     ││             │                                                                                          │             │                                                                           │calendar_date│               
│             ││ Conditions: │                                                                                          │ Conditions: │                                                                           │customer_type│               
│             ││calendar_date│                                                                                          │calendar_date│                                                                           │service_categ│               
│             ││  = SUBQUERY ├────────────────────────────────────────────────────┐                                     │  = SUBQUERY ├─────────────────────────────────────┐                                     │     ory     │               
│             ││             │                                                    │                                     │             │                                     │                                     │ product_code│               
│             ││             │                                                    │                                     │             │                                     │                                     │             │               
│             ││             │                                                    │                                     │             │                                     │                                     │             │               
│             ││             │                                                    │                                     │             │                                     │                                     │             │               
│             ││             │                                                    │                                     │             │                                     │                                     │             │               
│ 250,000 rows││  7,632 rows │                                                    │                                     │  3,091 rows │                                     │                                     │27,504,5...  │               
│   (0.03s)   ││   (0.12s)   │                                                    │                                     │   (0.06s)   │                                     │                                     │   (0.35s)   │               
└──────┬──────┘└──────┬──────┘                                                    │                                     └──────┬──────┘                                     │                                     └──────┬──────┘               
┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐               
│  PROJECTION ││  HASH_JOIN  │                                             │  PROJECTION │                              │  PROJECTION │                              │  PROJECTION │                              │  PROJECTION │               
│    ──────   ││    ──────   │                                             │    ──────   │                              │    ──────   │                              │    ──────   │                              │    ──────   │               
│      id     ││  Join Type: │                                             │ CASE  WHEN (│                              │ customer_id │                              │ CASE  WHEN (│                              │ customer_id │               
│  address_id ││     LEFT    │                                             │  (#1 > 1))  │                              │  service_id │                              │  (#1 > 1))  │                              │  service_id │               
│             ││             │                                             │ THEN ("error│                              │customer_type│                              │ THEN ("error│                              │calendar_date│               
│             ││ Conditions: │                                             │ "('More than│                              │service_provi│                              │ "('More than│                              │ ((ss_item_sk│               
│             ││ product_name│                                             │    one row  │                              │     der     │                              │    one row  │                              │   % 2) = 0) │               
│             ││ = product_na│                                             │  returned by│                              │ service_name│                              │  returned by│                              │ product_code│               
│             ││      me     │                                             │  a subquery │                              │calendar_date│                              │  a subquery │                              │             │               
│             ││             │                                             │  used as an │                              │             │                              │  used as an │                              │             │               
│             ││             │                                             │  expression │                              │             │                              │  expression │                              │             │               
│             ││             │                                             │   - scalar  │                              │             │                              │   - scalar  │                              │             │               
│             ││             │                                             │  subqueries │                              │             │                              │  subqueries │                              │             │               
│             ││             │                                             │   can only  │                              │             │                              │   can only  │                              │             │               
│             ││             │                                             │   return a  │                              │             │                              │   return a  │                              │             │               
│             ││             ├─────────────────────────────────────┐       │  single row.│                              │             │                              │  single row.│                              │             │               
│             ││             │                                     │       │   Use "SET  │                              │             │                              │   Use "SET  │                              │             │               
│             ││             │                                     │       │ scalar_subqu│                              │             │                              │ scalar_subqu│                              │             │               
│             ││             │                                     │       │ery_error_on_│                              │             │                              │ery_error_on_│                              │             │               
│             ││             │                                     │       │multiple_rows│                              │             │                              │multiple_rows│                              │             │               
│             ││             │                                     │       │  =false" to │                              │             │                              │  =false" to │                              │             │               
│             ││             │                                     │       │   revert to │                              │             │                              │   revert to │                              │             │               
│             ││             │                                     │       │   previous  │                              │             │                              │   previous  │                              │             │               
│             ││             │                                     │       │  behavior of│                              │             │                              │  behavior of│                              │             │               
│             ││             │                                     │       │  returning a│                              │             │                              │  returning a│                              │             │               
│             ││             │                                     │       │  random row.│                              │             │                              │  random row.│                              │             │               
│             ││             │                                     │       │ ')) ELSE #0 │                              │             │                              │ ')) ELSE #0 │                              │             │               
│             ││             │                                     │       │      END    │                              │             │                              │      END    │                              │             │               
│             ││             │                                     │       │             │                              │             │                              │             │                              │             │               
│ 250,000 rows││7,195,79...  │                                     │       │    1 row    │                              │14,329,2...  │                              │    1 row    │                              │27,504,5...  │               
│   (0.00s)   ││   (2.42s)   │                                     │       │   (0.00s)   │                              │   (0.01s)   │                              │   (0.00s)   │                              │   (0.16s)   │               
└──────┬──────┘└──────┬──────┘                                     │       └──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘               
┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐               
│  PROJECTION ││  PROJECTION │                              │  PROJECTION ││UNGROUPE...  │                              │  HASH_JOIN  │                              │UNGROUPE...  │                              │  HASH_JOIN  │               
│    ──────   ││    ──────   │                              │    ──────   ││    ──────   │                              │    ──────   │                              │    ──────   │                              │    ──────   │               
│      id     ││ customer_id │                              │ product_name││ Aggregates: │                              │  Join Type: │                              │ Aggregates: │                              │  Join Type: │               
│  address_id ││technology_ty│                              │  plan_group ││ "first"(#0) │                              │    INNER    │                              │ "first"(#0) │                              │    INNER    │               
│             ││      pe     │                              │             ││ count_star()│                              │             │                              │ count_star()│                              │             │               
│             ││ location_id │                              │             ││             │                              │ Conditions: │                              │             │                              │ Conditions: │               
│             ││calendar_date│                              │             ││             │                              │ cs_item_sk =│                              │             │                              │ ss_item_sk =│               
│             ││ product_code│                              │             ││             │                              │   i_item_sk ├──────────────────────┐       │             │                              │   i_item_sk ├───────────────
│             ││ product_name│                              │             ││             │                              │             │                      │       │             │                              │             │               
│             ││customer_type│                              │             ││             │                              │             │                      │       │             │                              │             │               
│             ││  service_id │                              │             ││             │                              │             │                      │       │             │                              │             │               
│             ││ speed_class │                              │             ││             │                              │             │                      │       │             │                              │             │               
│             ││             │                              │             ││             │                              │             │                      │       │             │                              │             │               
│ 250,000 rows││7,195,79...  │                              │ 102,000 rows││    1 row    │                              │14,329,2...  │                      │       │    1 row    │                              │27,504,5...  │               
│   (0.00s)   ││   (0.18s)   │                              │   (0.00s)   ││   (0.00s)   │                              │   (0.05s)   │                      │       │   (0.00s)   │                              │   (0.11s)   │               
└──────┬──────┘└──────┬──────┘                              └──────┬──────┘└──────┬──────┘                              └──────┬──────┘                      │       └──────┬──────┘                              └──────┬──────┘               
┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐               
│  TABLE_SCAN ││  PROJECTION │                              │  TABLE_SCAN ││  PROJECTION │                              │  HASH_JOIN  │               │  TABLE_SCAN ││  PROJECTION │                              │  HASH_JOIN  │               
│    ──────   ││    ──────   │                              │    ──────   ││    ──────   │                              │    ──────   │               │    ──────   ││    ──────   │                              │    ──────   │               
│    Table:   ││ customer_id │                              │    Table:   ││      #0     │                              │  Join Type: │               │    Table:   ││      #0     │                              │  Join Type: │               
│customer_addr││ (ws_item_sk │                              │     item    ││             │                              │    INNER    │               │     item    ││             │                              │    INNER    │               
│     ess     ││     % 3)    │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││ location_id │                              │    Type:    ││             │                              │ Conditions: │               │    Type:    ││             │                              │ Conditions: │               
│    Type:    ││calendar_date│                              │  Sequential ││             │                              │cs_sold_date_│               │  Sequential ││             │                              │ss_sold_date_│               
│  Sequential ││ product_code│                              │     Scan    ││             │                              │sk = d_date_s│               │     Scan    ││             │                              │sk = d_date_s│               
│     Scan    ││ product_name│                              │             ││             │                              │      k      │               │             ││             │                              │      k      │               
│             ││  ws_item_sk │                              │ Projections:││             │                              │             │               │ Projections:││             │                              │             │               
│ Projections:││  service_id │                              │i_product_nam││             │                              │             │               │  i_item_sk  ││             │                              │             │               
│ca_address_sk││ speed_class │                              │      e      ││             │                              │             │               │i_product_nam││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │      e      ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             │               │             ││             │                              │             │               
│             ││             │                              │             ││             │                              │             ├───────┐       │             ││             │                              │             ├───────┐       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│             ││             │                              │             ││             │                              │             │       │       │             ││             │                              │             │       │       
│ 250,000 rows││7,195,79...  │                              │ 102,000 rows││    1 row    │                              │14,329,2...  │       │       │ 102,000 rows││    1 row    │                              │27,504,5...  │       │       
│   (0.00s)   ││   (0.04s)   │                              │   (0.00s)   ││   (0.00s)   │                              │   (0.06s)   │       │       │   (0.00s)   ││   (0.00s)   │                              │   (0.12s)   │       │       
└─────────────┘└──────┬──────┘                              └─────────────┘└──────┬──────┘                              └──────┬──────┘       │       └─────────────┘└──────┬──────┘                              └──────┬──────┘       │       
               ┌──────┴──────┐                                             ┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐
               │  HASH_JOIN  │                                             │UNGROUPE...  │                              │  TABLE_SCAN ││  TABLE_SCAN │               │UNGROUPE...  │                              │    FILTER   ││  TABLE_SCAN │
               │    ──────   │                                             │    ──────   │                              │    ──────   ││    ──────   │               │    ──────   │                              │    ──────   ││    ──────   │
               │  Join Type: │                                             │ Aggregates: │                              │    Table:   ││    Table:   │               │ Aggregates: │                              │ ((CASE  WHEN││    Table:   │
               │    INNER    │                                             │   max(#0)   │                              │catalog_sales││   date_dim  │               │   max(#0)   │                              │ (((ss_item_s││   date_dim  │
               │             │                                             │             │                              │             ││             │               │             │                              │ k % 2) = 0))││             │
               │ Conditions: │                                             │             │                              │    Type:    ││    Type:    │               │             │                              │ THEN ('Consu││    Type:    │
               │ ws_item_sk =│                                             │             │                              │  Sequential ││  Sequential │               │             │                              │ mer') ELSE  ││  Sequential │
               │   i_item_sk │                                             │             │                              │     Scan    ││     Scan    │               │             │                              │  'Business' ││     Scan    │
               │             │                                             │             │                              │             ││             │               │             │                              │ END = 'Consu││             │
               │             │                                             │             │                              │ Projections:││ Projections:│               │             │                              │  mer') OR   ││ Projections:│
               │             │                                             │             │                              │  cs_item_sk ││  d_date_sk  │               │             │                              │ (CASE  WHEN ││  d_date_sk  │
               │             │                                             │             │                              │cs_sold_date_││    d_date   │               │             │                              │(((ss_item_sk││    d_date   │
               │             │                                             │             │                              │      sk     ││             │               │             │                              │  % 2) = 0)) ││             │
               │             │                                             │             │                              │cs_bill_custo││   Filters:  │               │             │                              │ THEN ('Consu││   Filters:  │
               │             │                                             │             │                              │    mer_sk   ││  d_date_sk> │               │             │                              │ mer') ELSE  ││  d_date_sk> │
               │             │                                             │             │                              │             ││ =2450815 AND│               │             │                              │  'Business' ││ =2450816 AND│
               │             │                                             │             │                              │             ││  d_date_sk< │               │             │                              │ END = 'Busin││  d_date_sk< │
               │             │                                             │             │                              │             ││   =2452653  │               │             │                              │    ess'))   ││   =2452642  │
               │             │                                             │             │                              │             ││             │               │             │                              │             ││             │
               │             │                                             │             │                              │             ││             │               │             │                              │             ││             │
               │             │                                             │             │                              │             ││             │               │             │                              │             ││             │
               │             ├──────────────────────┐                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │             │                      │                      │             │                              │             ││             │               │             │                              │             ││             │
               │7,195,79...  │                      │                      │    1 row    │                              │14,329,2...  ││  1,839 rows │               │    1 row    │                              │27,504,5...  ││  1,827 rows │
               │   (0.06s)   │                      │                      │   (0.01s)   │                              │   (0.13s)   ││   (0.00s)   │               │   (0.01s)   │                              │   (1.38s)   ││   (0.00s)   │
               └──────┬──────┘                      │                      └──────┬──────┘                              └─────────────┘└─────────────┘               └──────┬──────┘                              └──────┬──────┘└─────────────┘
               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐                                                                           ┌──────┴──────┐                              ┌──────┴──────┐               
               │  HASH_JOIN  │               │  TABLE_SCAN │               │  PROJECTION │                                                                           │  PROJECTION │                              │  TABLE_SCAN │               
               │    ──────   │               │    ──────   │               │    ──────   │                                                                           │    ──────   │                              │    ──────   │               
               │  Join Type: │               │    Table:   │               │calendar_date│                                                                           │calendar_date│                              │    Table:   │               
               │    INNER    │               │     item    │               │             │                                                                           │             │                              │ store_sales │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │ Conditions: │               │    Type:    │               │             │                                                                           │             │                              │    Type:    │               
               │ws_sold_date_│               │  Sequential │               │             │                                                                           │             │                              │  Sequential │               
               │sk = d_date_s│               │     Scan    │               │             │                                                                           │             │                              │     Scan    │               
               │      k      │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │ Projections:│               │             │                                                                           │             │                              │ Projections:│               
               │             │               │  i_item_sk  │               │             │                                                                           │             │                              │  ss_item_sk │               
               │             │               │  i_item_id  │               │             │                                                                           │             │                              │ss_sold_date_│               
               │             │               │i_product_nam│               │             │                                                                           │             │                              │      sk     │               
               │             │               │      e      │               │             │                                                                           │             │                              │ss_customer_s│               
               │             │               │   i_class   │               │             │                                                                           │             │                              │      k      │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             │               │             │               │             │                                                                           │             │                              │             │               
               │             ├───────┐       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │             │       │       │             │               │             │                                                                           │             │                              │             │               
               │7,195,79...  │       │       │ 102,000 rows│               │7,195,79...  │                                                                           │14,329,2...  │                              │27,504,5...  │               
               │   (0.04s)   │       │       │   (0.01s)   │               │   (0.00s)   │                                                                           │   (0.00s)   │                              │   (0.34s)   │               
               └──────┬──────┘       │       └─────────────┘               └──────┬──────┘                                                                           └──────┬──────┘                              └─────────────┘               
               ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐                                                                           ┌──────┴──────┐                                                            
               │    FILTER   ││  TABLE_SCAN │                              │  PROJECTION │                                                                           │  PROJECTION │                                                            
               │    ──────   ││    ──────   │                              │    ──────   │                                                                           │    ──────   │                                                            
               │ ((CASE  WHEN││    Table:   │                              │calendar_date│                                                                           │calendar_date│                                                            
               │ (((ws_item_s││   date_dim  │                              │             │                                                                           │             │                                                            
               │ k % 2) = 0))││             │                              │             │                                                                           │             │                                                            
               │ THEN ('Consu││    Type:    │                              │             │                                                                           │             │                                                            
               │ mer') ELSE  ││  Sequential │                              │             │                                                                           │             │                                                            
               │  'Business' ││     Scan    │                              │             │                                                                           │             │                                                            
               │ END = 'Busin││             │                              │             │                                                                           │             │                                                            
               │  ess') OR   ││ Projections:│                              │             │                                                                           │             │                                                            
               │ (CASE  WHEN ││  d_date_sk  │                              │             │                                                                           │             │                                                            
               │(((ws_item_sk││    d_date   │                              │             │                                                                           │             │                                                            
               │  % 2) = 0)) ││             │                              │             │                                                                           │             │                                                            
               │ THEN ('Consu││   Filters:  │                              │             │                                                                           │             │                                                            
               │ mer') ELSE  ││  d_date_sk> │                              │             │                                                                           │             │                                                            
               │  'Business' ││ =2450816 AND│                              │             │                                                                           │             │                                                            
               │ END = 'Consu││  d_date_sk< │                              │             │                                                                           │             │                                                            
               │    mer'))   ││   =2452642  │                              │             │                                                                           │             │                                                            
               │             ││             │                              │             │                                                                           │             │                                                            
               │7,195,79...  ││  1,827 rows │                              │7,195,79...  │                                                                           │14,329,2...  │                                                            
               │   (0.35s)   ││   (0.00s)   │                              │   (0.00s)   │                                                                           │   (0.00s)   │                                                            
               └──────┬──────┘└─────────────┘                              └──────┬──────┘                                                                           └──────┬──────┘                                                            
               ┌──────┴──────┐                                             ┌──────┴──────┐                                                                           ┌──────┴──────┐                                                            
               │  TABLE_SCAN │                                             │  HASH_JOIN  │                                                                           │  HASH_JOIN  │                                                            
               │    ──────   │                                             │    ──────   │                                                                           │    ──────   │                                                            
               │    Table:   │                                             │  Join Type: │                                                                           │  Join Type: │                                                            
               │  web_sales  │                                             │    INNER    │                                                                           │    INNER    │                                                            
               │             │                                             │             │                                                                           │             │                                                            
               │    Type:    │                                             │ Conditions: │                                                                           │ Conditions: │                                                            
               │  Sequential │                                             │ ws_item_sk =│                                                                           │ cs_item_sk =│                                                            
               │     Scan    │                                             │   i_item_sk │                                                                           │   i_item_sk │                                                            
               │             │                                             │             │                                                                           │             │                                                            
               │ Projections:│                                             │             │                                                                           │             │                                                            
               │  ws_item_sk │                                             │             │                                                                           │             │                                                            
               │ws_sold_date_│                                             │             ├──────────────────────┐                                                    │             ├──────────────────────┐                                     
               │      sk     │                                             │             │                      │                                                    │             │                      │                                     
               │ws_bill_custo│                                             │             │                      │                                                    │             │                      │                                     
               │    mer_sk   │                                             │             │                      │                                                    │             │                      │                                     
               │ws_bill_addr_│                                             │             │                      │                                                    │             │                      │                                     
               │      sk     │                                             │             │                      │                                                    │             │                      │                                     
               │ws_order_numb│                                             │             │                      │                                                    │             │                      │                                     
               │      er     │                                             │             │                      │                                                    │             │                      │                                     
               │             │                                             │             │                      │                                                    │             │                      │                                     
               │7,195,79...  │                                             │7,195,79...  │                      │                                                    │14,329,2...  │                      │                                     
               │   (0.16s)   │                                             │   (0.03s)   │                      │                                                    │   (0.05s)   │                      │                                     
               └─────────────┘                                             └──────┬──────┘                      │                                                    └──────┬──────┘                      │                                     
                                                                           ┌──────┴──────┐               ┌──────┴──────┐                                             ┌──────┴──────┐               ┌──────┴──────┐                              
                                                                           │  HASH_JOIN  │               │  TABLE_SCAN │                                             │  HASH_JOIN  │               │  TABLE_SCAN │                              
                                                                           │    ──────   │               │    ──────   │                                             │    ──────   │               │    ──────   │                              
                                                                           │  Join Type: │               │    Table:   │                                             │  Join Type: │               │    Table:   │                              
                                                                           │    INNER    │               │     item    │                                             │    INNER    │               │     item    │                              
                                                                           │             │               │             │                                             │             │               │             │                              
                                                                           │ Conditions: │               │    Type:    │                                             │ Conditions: │               │    Type:    │                              
                                                                           │ws_sold_date_│               │  Sequential │                                             │cs_sold_date_│               │  Sequential │                              
                                                                           │sk = d_date_s├───────┐       │     Scan    │                                             │sk = d_date_s├───────┐       │     Scan    │                              
                                                                           │      k      │       │       │             │                                             │      k      │       │       │             │                              
                                                                           │             │       │       │ Projections:│                                             │             │       │       │ Projections:│                              
                                                                           │             │       │       │  i_item_sk  │                                             │             │       │       │  i_item_sk  │                              
                                                                           │             │       │       │             │                                             │             │       │       │             │                              
                                                                           │             │       │       │             │                                             │             │       │       │             │                              
                                                                           │7,195,79...  │       │       │ 102,000 rows│                                             │14,329,2...  │       │       │ 102,000 rows│                              
                                                                           │   (0.02s)   │       │       │   (0.00s)   │                                             │   (0.05s)   │       │       │   (0.00s)   │                              
                                                                           └──────┬──────┘       │       └─────────────┘                                             └──────┬──────┘       │       └─────────────┘                              
                                                                           ┌──────┴──────┐┌──────┴──────┐                                                            ┌──────┴──────┐┌──────┴──────┐                                             
                                                                           │  TABLE_SCAN ││  TABLE_SCAN │                                                            │  TABLE_SCAN ││  TABLE_SCAN │                                             
                                                                           │    ──────   ││    ──────   │                                                            │    ──────   ││    ──────   │                                             
                                                                           │    Table:   ││    Table:   │                                                            │    Table:   ││    Table:   │                                             
                                                                           │  web_sales  ││   date_dim  │                                                            │catalog_sales││   date_dim  │                                             
                                                                           │             ││             │                                                            │             ││             │                                             
                                                                           │    Type:    ││    Type:    │                                                            │    Type:    ││    Type:    │                                             
                                                                           │  Sequential ││  Sequential │                                                            │  Sequential ││  Sequential │                                             
                                                                           │     Scan    ││     Scan    │                                                            │     Scan    ││     Scan    │                                             
                                                                           │             ││             │                                                            │             ││             │                                             
                                                                           │ Projections:││ Projections:│                                                            │ Projections:││ Projections:│                                             
                                                                           │  ws_item_sk ││  d_date_sk  │                                                            │  cs_item_sk ││  d_date_sk  │                                             
                                                                           │ws_sold_date_││    d_date   │                                                            │cs_sold_date_││    d_date   │                                             
                                                                           │      sk     ││             │                                                            │      sk     ││             │                                             
                                                                           │             ││   Filters:  │                                                            │             ││   Filters:  │                                             
                                                                           │             ││  d_date_sk> │                                                            │             ││  d_date_sk> │                                             
                                                                           │             ││ =2450816 AND│                                                            │             ││ =2450815 AND│                                             
                                                                           │             ││  d_date_sk< │                                                            │             ││  d_date_sk< │                                             
                                                                           │             ││   =2452642  │                                                            │             ││   =2452653  │                                             
                                                                           │             ││             │                                                            │             ││             │                                             
                                                                           │7,195,79...  ││  1,827 rows │                                                            │14,329,2...  ││  1,839 rows │                                             
                                                                           │   (0.04s)   ││   (0.01s)   │                                                            │   (0.10s)   ││   (0.00s)   │                                             
                                                                           └─────────────┘└─────────────┘                                                            └─────────────┘└─────────────┘                                             
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
