```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates_d1": "SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001",
        "filtered_dates_d2_d3": "SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001",
        "filtered_store_sales": "SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN filtered_dates_d1 ON ss_sold_date_sk = d_date_sk",
        "filtered_store_returns": "SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN filtered_dates_d2_d3 ON sr_returned_date_sk = d_date_sk",
        "filtered_catalog_sales": "SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN filtered_dates_d2_d3 ON cs_sold_date_sk = d_date_sk",
        "main_query": "SELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_net_profit) AS store_sales_profit, SUM(sr_net_loss) AS store_returns_loss, SUM(cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales JOIN filtered_store_returns ON (filtered_store_sales.ss_customer_sk = filtered_store_returns.sr_customer_sk AND filtered_store_sales.ss_item_sk = filtered_store_returns.sr_item_sk AND filtered_store_sales.ss_ticket_number = filtered_store_returns.sr_ticket_number) JOIN filtered_catalog_sales ON (filtered_store_returns.sr_customer_sk = filtered_catalog_sales.cs_bill_customer_sk AND filtered_store_returns.sr_item_sk = filtered_catalog_sales.cs_item_sk) JOIN item ON (filtered_store_sales.ss_item_sk = i_item_sk) JOIN store ON (filtered_store_sales.ss_store_sk = s_store_sk) GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filters into two CTEs: one for d1 (month 4, year 2001) and another for d2/d3 (months 4-10, year 2001). Created filtered CTEs for each fact table (store_sales, store_returns, catalog_sales) by joining with the appropriate date CTE. This reduces the volume of data early in the pipeline, preventing unnecessary scanning of large fact tables before applying date filters. The main query now joins these pre-filtered fact CTEs with dimension tables (item, store), which should significantly reduce join costs and intermediate result sizes."
}
```