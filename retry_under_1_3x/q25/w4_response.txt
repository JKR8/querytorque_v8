```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "d1_filtered": "SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001",
        "d2_filtered": "SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001",
        "d3_filtered": "SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001",
        "filtered_store_sales": "SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN d1_filtered ON ss_sold_date_sk = d1_filtered.d_date_sk",
        "filtered_store_returns": "SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN d2_filtered ON sr_returned_date_sk = d2_filtered.d_date_sk",
        "filtered_catalog_sales": "SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN d3_filtered ON cs_sold_date_sk = d3_filtered.d_date_sk",
        "main_query": "SELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_net_profit) AS store_sales_profit, SUM(sr_net_loss) AS store_returns_loss, SUM(cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales, filtered_store_returns, filtered_catalog_sales, store, item WHERE i_item_sk = ss_item_sk AND s_store_sk = ss_store_sk AND ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same grain",
        "same result rows",
        "same ordering"
      ],
      "expected_speedup": "3.5x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "pushdown",
      "nodes": {
        "filtered_item": "SELECT i_item_sk, i_item_id, i_item_desc FROM item",
        "filtered_store": "SELECT s_store_sk, s_store_id, s_store_name FROM store",
        "main_query": "SELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_net_profit) AS store_sales_profit, SUM(sr_net_loss) AS store_returns_loss, SUM(cs_net_profit) AS catalog_sales_profit FROM (SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN d1_filtered ON ss_sold_date_sk = d1_filtered.d_date_sk) ss, (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN d2_filtered ON sr_returned_date_sk = d2_filtered.d_date_sk) sr, (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN d3_filtered ON cs_sold_date_sk = d3_filtered.d_date_sk) cs, filtered_item i, filtered_store s WHERE i.i_item_sk = ss.ss_item_sk AND s.s_store_sk = ss.ss_store_sk AND ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number AND sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same grain",
        "same result rows"
      ],
      "expected_speedup": "1.2x",
      "risk": "low"
    }
  ],
  "explanation": "Applied date_cte_isolate to create filtered date_dim CTEs (d1_filtered, d2_filtered, d3_filtered) and push date filters early into fact table scans. This reduces the store_sales, store_returns, and catalog_sales rows before joining. Also applied pushdown to materialize filtered dimension tables (item, store) early, though impact is smaller. The main optimization is isolating date filters into CTEs that are joined directly with fact tables, avoiding full table scans with late filtering."
}
```