{
  "timestamp": "20260206_082232",
  "config": {
    "database": "/mnt/d/TPC-DS/tpcds_sf10.duckdb",
    "queries": [
      "q98",
      "q83",
      "q12",
      "q62",
      "q66",
      "q84",
      "q17",
      "q3",
      "q82",
      "q19",
      "q18",
      "q41",
      "q92",
      "q20",
      "q76",
      "q45",
      "q33",
      "q79",
      "q4",
      "q8",
      "q49",
      "q57",
      "q60",
      "q27",
      "q13",
      "q64",
      "q48",
      "q25",
      "q71",
      "q55",
      "q75",
      "q56",
      "q86",
      "q50",
      "q91",
      "q24",
      "q87",
      "q34",
      "q70",
      "q89",
      "q53",
      "q61",
      "q32",
      "q94"
    ],
    "worker_examples": {
      "1": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "2": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "3": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "4": [
        "single_pass_aggregation",
        "or_to_union",
        "intersect_to_exists",
        "union_cte_split"
      ]
    }
  },
  "summary": {
    "total_queries": 44,
    "improved": 0,
    "wins": 0,
    "total_time_minutes": 7.179114874204
  },
  "results": [
    {
      "query_id": "q98",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q98",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home'))\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ss_ext_sales_price) AS itemrevenue, SUM(ss_ext_sales_price) * 100.0000 / SUM(SUM(ss_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST",
          "prompt_tokens": 2885,
          "response_tokens": 398,
          "llm_time_ms": 83786.75818443298
        },
        {
          "worker_id": 1,
          "query_id": "q98",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_item AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), sales_joined AS (SELECT fi.i_item_id, fi.i_item_desc, fi.i_category, fi.i_class, fi.i_current_price, ss.ss_ext_sales_price FROM store_sales AS ss JOIN filtered_date AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_item AS fi ON ss.ss_item_sk = fi.i_item_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ss_ext_sales_price) AS itemrevenue, SUM(ss_ext_sales_price) * 100.0000 / SUM(SUM(ss_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM sales_joined GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST",
          "prompt_tokens": 2722,
          "response_tokens": 417,
          "llm_time_ms": 85107.82885551453
        },
        {
          "worker_id": 4,
          "query_id": "q98",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home'))\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ss_ext_sales_price) AS itemrevenue, SUM(ss_ext_sales_price) * 100.0000 / SUM(SUM(ss_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST",
          "prompt_tokens": 3938,
          "response_tokens": 404,
          "llm_time_ms": 86533.71262550354
        },
        {
          "worker_id": 2,
          "query_id": "q98",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), joined_facts AS (SELECT ss_item_sk, ss_ext_sales_price, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_items ON store_sales.ss_item_sk = filtered_items.i_item_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ss_ext_sales_price) AS itemrevenue, SUM(ss_ext_sales_price) * 100.0000 / SUM(SUM(ss_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM joined_facts GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST",
          "prompt_tokens": 2868,
          "response_tokens": 572,
          "llm_time_ms": 99722.7885723114
        }
      ],
      "original_speedup": 1.26,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676084"
    },
    {
      "query_id": "q83",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q83",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH week_seq_set AS (SELECT DISTINCT d_week_seq FROM date_dim WHERE d_date IN ('2000-06-30', '2000-09-27', '2000-11-17')), relevant_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_week_seq IN (SELECT d_week_seq FROM week_seq_set)), sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns JOIN item ON sr_item_sk = i_item_sk JOIN relevant_dates ON sr_returned_date_sk = d_date_sk GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns JOIN item ON cr_item_sk = i_item_sk JOIN relevant_dates ON cr_returned_date_sk = d_date_sk GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns JOIN item ON wr_item_sk = i_item_sk JOIN relevant_dates ON wr_returned_date_sk = d_date_sk GROUP BY i_item_id)\nSELECT sr_items.item_id, sr_item_qty, (sr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS sr_dev, cr_item_qty, (cr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS cr_dev, wr_item_qty, (wr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM sr_items, cr_items, wr_items WHERE sr_items.item_id = cr_items.item_id AND sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id NULLS FIRST, sr_item_qty NULLS FIRST LIMIT 100",
          "prompt_tokens": 3584,
          "response_tokens": 552,
          "llm_time_ms": 94104.99477386475
        },
        {
          "worker_id": 2,
          "query_id": "q83",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH target_weeks AS (SELECT DISTINCT d_week_seq FROM date_dim WHERE d_date IN ('2000-06-30', '2000-09-27', '2000-11-17')), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_week_seq IN (SELECT d_week_seq FROM target_weeks)), sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns JOIN item ON sr_item_sk = i_item_sk JOIN filtered_dates ON sr_returned_date_sk = d_date_sk GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns JOIN item ON cr_item_sk = i_item_sk JOIN filtered_dates ON cr_returned_date_sk = d_date_sk GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns JOIN item ON wr_item_sk = i_item_sk JOIN filtered_dates ON wr_returned_date_sk = d_date_sk GROUP BY i_item_id)\nSELECT sr_items.item_id, sr_item_qty, (sr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS sr_dev, cr_item_qty, (cr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS cr_dev, wr_item_qty, (wr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM sr_items, cr_items, wr_items WHERE sr_items.item_id = cr_items.item_id AND sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id NULLS FIRST, sr_item_qty NULLS FIRST LIMIT 100",
          "prompt_tokens": 3731,
          "response_tokens": 615,
          "llm_time_ms": 120961.31014823914
        },
        {
          "worker_id": 4,
          "query_id": "q83",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH target_date_sk AS (SELECT d_date_sk FROM date_dim WHERE d_week_seq IN (SELECT d_week_seq FROM date_dim WHERE d_date IN ('2000-06-30', '2000-09-27', '2000-11-17'))), sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns, item, target_date_sk WHERE sr_item_sk = i_item_sk AND sr_returned_date_sk = target_date_sk.d_date_sk GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns, item, target_date_sk WHERE cr_item_sk = i_item_sk AND cr_returned_date_sk = target_date_sk.d_date_sk GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns, item, target_date_sk WHERE wr_item_sk = i_item_sk AND wr_returned_date_sk = target_date_sk.d_date_sk GROUP BY i_item_id)\nSELECT sr_items.item_id, sr_item_qty, (sr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS sr_dev, cr_item_qty, (cr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS cr_dev, wr_item_qty, (wr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM sr_items, cr_items, wr_items WHERE sr_items.item_id = cr_items.item_id AND sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id NULLS FIRST, sr_item_qty NULLS FIRST LIMIT 100",
          "prompt_tokens": 4800,
          "response_tokens": 616,
          "llm_time_ms": 123838.55056762695
        },
        {
          "worker_id": 3,
          "query_id": "q83",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_week_seq IN (SELECT d_week_seq FROM date_dim WHERE d_date IN ('2000-06-30', '2000-09-27', '2000-11-17'))), sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns JOIN item ON sr_item_sk = i_item_sk JOIN filtered_dates ON sr_returned_date_sk = d_date_sk GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns JOIN item ON cr_item_sk = i_item_sk JOIN filtered_dates ON cr_returned_date_sk = d_date_sk GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns JOIN item ON wr_item_sk = i_item_sk JOIN filtered_dates ON wr_returned_date_sk = d_date_sk GROUP BY i_item_id)\nSELECT sr_items.item_id, sr_item_qty, (sr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS sr_dev, cr_item_qty, (cr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS cr_dev, wr_item_qty, (wr_item_qty * 1.0000) / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0000 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM sr_items, cr_items, wr_items WHERE sr_items.item_id = cr_items.item_id AND sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id NULLS FIRST, sr_item_qty NULLS FIRST LIMIT 100",
          "prompt_tokens": 3745,
          "response_tokens": 1765,
          "llm_time_ms": 159727.26106643677
        }
      ],
      "original_speedup": 1.24,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676111"
    },
    {
      "query_id": "q12",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q12",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_item AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), aggregated_sales AS (SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ws_ext_sales_price) AS itemrevenue FROM web_sales JOIN filtered_date ON ws_sold_date_sk = d_date_sk JOIN filtered_item ON ws_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, itemrevenue, itemrevenue * 100.0000 / SUM(itemrevenue) OVER (PARTITION BY i_class) AS revenueratio FROM aggregated_sales ORDER BY i_category, i_class, i_item_id, i_item_desc, revenueratio LIMIT 100",
          "prompt_tokens": 2674,
          "response_tokens": 406,
          "llm_time_ms": 67371.41704559326
        },
        {
          "worker_id": 4,
          "query_id": "q12",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home'))\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ws_ext_sales_price) AS itemrevenue, SUM(ws_ext_sales_price) * 100.0000 / SUM(SUM(ws_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_items ON ws_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category, i_class, i_item_id, i_item_desc, revenueratio LIMIT 100",
          "prompt_tokens": 3890,
          "response_tokens": 392,
          "llm_time_ms": 81945.58477401733
        },
        {
          "worker_id": 3,
          "query_id": "q12",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home'))\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ws_ext_sales_price) AS itemrevenue, SUM(ws_ext_sales_price) * 100.0000 / SUM(SUM(ws_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_items ON ws_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category, i_class, i_item_id, i_item_desc, revenueratio LIMIT 100",
          "prompt_tokens": 2838,
          "response_tokens": 397,
          "llm_time_ms": 85771.53015136719
        },
        {
          "worker_id": 2,
          "query_id": "q12",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), filtered_web_sales AS (SELECT ws_item_sk, ws_ext_sales_price FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ws_ext_sales_price) AS itemrevenue, SUM(ws_ext_sales_price) * 100.0000 / SUM(SUM(ws_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM filtered_web_sales JOIN filtered_items ON ws_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category, i_class, i_item_id, i_item_desc, revenueratio LIMIT 100",
          "prompt_tokens": 2821,
          "response_tokens": 434,
          "llm_time_ms": 146995.31507492065
        }
      ],
      "original_speedup": 1.23,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676115"
    },
    {
      "query_id": "q62",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q62",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), warehouse_substr AS (SELECT w_warehouse_sk, SUBSTRING(w_warehouse_name, 1, 20) AS w_substr FROM warehouse), filtered_web_sales AS (SELECT ws_warehouse_sk, ws_ship_mode_sk, ws_web_site_sk, ws_ship_date_sk, ws_sold_date_sk FROM web_sales JOIN filtered_dates ON ws_ship_date_sk = d_date_sk)\nSELECT ws.w_substr, sm.sm_type, web.web_name, SUM(CASE WHEN (fws.ws_ship_date_sk - fws.ws_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (fws.ws_ship_date_sk - fws.ws_sold_date_sk > 30) AND (fws.ws_ship_date_sk - fws.ws_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (fws.ws_ship_date_sk - fws.ws_sold_date_sk > 60) AND (fws.ws_ship_date_sk - fws.ws_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (fws.ws_ship_date_sk - fws.ws_sold_date_sk > 90) AND (fws.ws_ship_date_sk - fws.ws_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (fws.ws_ship_date_sk - fws.ws_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM filtered_web_sales AS fws JOIN warehouse_substr AS ws ON fws.ws_warehouse_sk = ws.w_warehouse_sk JOIN ship_mode AS sm ON fws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN web_site AS web ON fws.ws_web_site_sk = web.web_site_sk GROUP BY ws.w_substr, sm.sm_type, web.web_name ORDER BY 1 NULLS FIRST, 2 NULLS FIRST, 3 NULLS FIRST LIMIT 100",
          "prompt_tokens": 2896,
          "response_tokens": 552,
          "llm_time_ms": 74780.77983856201
        },
        {
          "worker_id": 1,
          "query_id": "q62",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), warehouse_substr AS (SELECT SUBSTRING(w_warehouse_name, 1, 20) AS w_substr, w_warehouse_sk FROM warehouse)\nSELECT ws.w_substr, sm.sm_type, web.web_name, SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 30) AND (ws_ship_date_sk - ws_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 60) AND (ws_ship_date_sk - ws_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 90) AND (ws_ship_date_sk - ws_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM (SELECT ws.*, ws.ws_ship_date_sk - ws.ws_sold_date_sk AS shipping_days FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_ship_date_sk = fd.d_date_sk) AS ws JOIN warehouse_substr AS ws_sub ON ws.ws_warehouse_sk = ws_sub.w_warehouse_sk JOIN ship_mode AS sm ON ws.ws_ship_mode_sk = sm.sm_ship_mode_sk JOIN web_site AS web ON ws.ws_web_site_sk = web.web_site_sk GROUP BY ws_sub.w_substr, sm.sm_type, web.web_name ORDER BY 1 NULLS FIRST, 2 NULLS FIRST, 3 NULLS FIRST LIMIT 100",
          "prompt_tokens": 2749,
          "response_tokens": 950,
          "llm_time_ms": 94105.86285591125
        },
        {
          "worker_id": 4,
          "query_id": "q62",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1211)\nSELECT w_substr, sm_type, web_name, SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 30) AND (ws_ship_date_sk - ws_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 60) AND (ws_ship_date_sk - ws_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 90) AND (ws_ship_date_sk - ws_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM web_sales JOIN (SELECT SUBSTRING(w_warehouse_name, 1, 20) AS w_substr, * FROM warehouse) AS sq1 ON ws_warehouse_sk = w_warehouse_sk JOIN ship_mode ON ws_ship_mode_sk = sm_ship_mode_sk JOIN web_site ON ws_web_site_sk = web_site_sk JOIN filtered_dates ON ws_ship_date_sk = d_date_sk GROUP BY w_substr, sm_type, web_name ORDER BY 1 NULLS FIRST, 2 NULLS FIRST, 3 NULLS FIRST LIMIT 100",
          "prompt_tokens": 3965,
          "response_tokens": 828,
          "llm_time_ms": 114943.68648529053
        },
        {
          "worker_id": 3,
          "query_id": "q62",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), filtered_sales AS (SELECT ws_ship_date_sk, ws_sold_date_sk, ws_warehouse_sk, ws_ship_mode_sk, ws_web_site_sk FROM web_sales JOIN filtered_dates ON ws_ship_date_sk = d_date_sk), warehouse_substr AS (SELECT w_warehouse_sk, SUBSTRING(w_warehouse_name, 1, 20) AS w_substr FROM warehouse)\nSELECT w_substr, sm_type, web_name, SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 30) AND (ws_ship_date_sk - ws_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 60) AND (ws_ship_date_sk - ws_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 90) AND (ws_ship_date_sk - ws_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (ws_ship_date_sk - ws_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM filtered_sales JOIN warehouse_substr ON ws_warehouse_sk = w_warehouse_sk JOIN ship_mode ON ws_ship_mode_sk = sm_ship_mode_sk JOIN web_site ON ws_web_site_sk = web_site_sk GROUP BY w_substr, sm_type, web_name ORDER BY 1 NULLS FIRST, 2 NULLS FIRST, 3 NULLS FIRST LIMIT 100",
          "prompt_tokens": 2912,
          "response_tokens": 533,
          "llm_time_ms": 118124.63116645813
        }
      ],
      "original_speedup": 1.23,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676119"
    },
    {
      "query_id": "q66",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q66",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dimensions AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 2001), filtered_time AS (SELECT t_time_sk FROM time_dim WHERE t_time BETWEEN 30838 AND 30838 + 28800), filtered_ship_mode AS (SELECT sm_ship_mode_sk FROM ship_mode WHERE sm_carrier IN ('DHL', 'BARIAN')), unified_sales AS (SELECT 'web' AS sales_type, ws_warehouse_sk, ws_ext_sales_price, ws_quantity, ws_net_paid, ws_sold_date_sk, ws_sold_time_sk, ws_ship_mode_sk FROM web_sales UNION ALL SELECT 'catalog' AS sales_type, cs_warehouse_sk, cs_sales_price, cs_quantity, cs_net_paid_inc_tax, cs_sold_date_sk, cs_sold_time_sk, cs_ship_mode_sk FROM catalog_sales), joined_data AS (SELECT sales_type, w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_moy, CASE WHEN sales_type = 'web' THEN ws_ext_sales_price * ws_quantity ELSE cs_sales_price * cs_quantity END AS sales_amount, CASE WHEN sales_type = 'web' THEN ws_net_paid * ws_quantity ELSE cs_net_paid_inc_tax * cs_quantity END AS net_amount FROM unified_sales AS s JOIN filtered_dimensions AS d ON s.ws_sold_date_sk = d.d_date_sk OR s.cs_sold_date_sk = d.d_date_sk JOIN filtered_time AS t ON s.ws_sold_time_sk = t.t_time_sk OR s.cs_sold_time_sk = t.t_time_sk JOIN filtered_ship_mode AS sm ON s.ws_ship_mode_sk = sm.sm_ship_mode_sk OR s.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN warehouse AS w ON s.ws_warehouse_sk = w.w_warehouse_sk OR s.cs_warehouse_sk = w.w_warehouse_sk)\nSELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'DHL,BARIAN' AS ship_carriers, 2001 AS year_, SUM(CASE WHEN d_moy = 1 THEN sales_amount ELSE 0 END) AS jan_sales, SUM(CASE WHEN d_moy = 2 THEN sales_amount ELSE 0 END) AS feb_sales, SUM(CASE WHEN d_moy = 3 THEN sales_amount ELSE 0 END) AS mar_sales, SUM(CASE WHEN d_moy = 4 THEN sales_amount ELSE 0 END) AS apr_sales, SUM(CASE WHEN d_moy = 5 THEN sales_amount ELSE 0 END) AS may_sales, SUM(CASE WHEN d_moy = 6 THEN sales_amount ELSE 0 END) AS jun_sales, SUM(CASE WHEN d_moy = 7 THEN sales_amount ELSE 0 END) AS jul_sales, SUM(CASE WHEN d_moy = 8 THEN sales_amount ELSE 0 END) AS aug_sales, SUM(CASE WHEN d_moy = 9 THEN sales_amount ELSE 0 END) AS sep_sales, SUM(CASE WHEN d_moy = 10 THEN sales_amount ELSE 0 END) AS oct_sales, SUM(CASE WHEN d_moy = 11 THEN sales_amount ELSE 0 END) AS nov_sales, SUM(CASE WHEN d_moy = 12 THEN sales_amount ELSE 0 END) AS dec_sales, SUM(CASE WHEN d_moy = 1 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS jan_sales_per_sq_foot, SUM(CASE WHEN d_moy = 2 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS feb_sales_per_sq_foot, SUM(CASE WHEN d_moy = 3 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS mar_sales_per_sq_foot, SUM(CASE WHEN d_moy = 4 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS apr_sales_per_sq_foot, SUM(CASE WHEN d_moy = 5 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS may_sales_per_sq_foot, SUM(CASE WHEN d_moy = 6 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS jun_sales_per_sq_foot, SUM(CASE WHEN d_moy = 7 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS jul_sales_per_sq_foot, SUM(CASE WHEN d_moy = 8 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS aug_sales_per_sq_foot, SUM(CASE WHEN d_moy = 9 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS sep_sales_per_sq_foot, SUM(CASE WHEN d_moy = 10 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS oct_sales_per_sq_foot, SUM(CASE WHEN d_moy = 11 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS nov_sales_per_sq_foot, SUM(CASE WHEN d_moy = 12 THEN sales_amount / w_warehouse_sq_ft ELSE 0 END) AS dec_sales_per_sq_foot, SUM(CASE WHEN d_moy = 1 THEN net_amount ELSE 0 END) AS jan_net, SUM(CASE WHEN d_moy = 2 THEN net_amount ELSE 0 END) AS feb_net, SUM(CASE WHEN d_moy = 3 THEN net_amount ELSE 0 END) AS mar_net, SUM(CASE WHEN d_moy = 4 THEN net_amount ELSE 0 END) AS apr_net, SUM(CASE WHEN d_moy = 5 THEN net_amount ELSE 0 END) AS may_net, SUM(CASE WHEN d_moy = 6 THEN net_amount ELSE 0 END) AS jun_net, SUM(CASE WHEN d_moy = 7 THEN net_amount ELSE 0 END) AS jul_net, SUM(CASE WHEN d_moy = 8 THEN net_amount ELSE 0 END) AS aug_net, SUM(CASE WHEN d_moy = 9 THEN net_amount ELSE 0 END) AS sep_net, SUM(CASE WHEN d_moy = 10 THEN net_amount ELSE 0 END) AS oct_net, SUM(CASE WHEN d_moy = 11 THEN net_amount ELSE 0 END) AS nov_net, SUM(CASE WHEN d_moy = 12 THEN net_amount ELSE 0 END) AS dec_net FROM joined_data GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country ORDER BY w_warehouse_name NULLS FIRST LIMIT 100",
          "prompt_tokens": 5684,
          "response_tokens": 1634,
          "llm_time_ms": 130314.83054161072
        },
        {
          "worker_id": 1,
          "query_id": "q66",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date_dim AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 2001), filtered_time_dim AS (SELECT t_time_sk FROM time_dim WHERE t_time BETWEEN 30838 AND 30838 + 28800), filtered_ship_mode AS (SELECT sm_ship_mode_sk FROM ship_mode WHERE sm_carrier IN ('DHL', 'BARIAN')), web_sales_aggregated AS (SELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'DHL,BARIAN' AS ship_carriers, d_year AS year_, SUM(CASE WHEN d_moy = 1 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS jan_sales, SUM(CASE WHEN d_moy = 2 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS feb_sales, SUM(CASE WHEN d_moy = 3 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS mar_sales, SUM(CASE WHEN d_moy = 4 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS apr_sales, SUM(CASE WHEN d_moy = 5 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS may_sales, SUM(CASE WHEN d_moy = 6 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS jun_sales, SUM(CASE WHEN d_moy = 7 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS jul_sales, SUM(CASE WHEN d_moy = 8 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS aug_sales, SUM(CASE WHEN d_moy = 9 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS sep_sales, SUM(CASE WHEN d_moy = 10 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS oct_sales, SUM(CASE WHEN d_moy = 11 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS nov_sales, SUM(CASE WHEN d_moy = 12 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS dec_sales, SUM(CASE WHEN d_moy = 1 THEN ws_net_paid * ws_quantity ELSE 0 END) AS jan_net, SUM(CASE WHEN d_moy = 2 THEN ws_net_paid * ws_quantity ELSE 0 END) AS feb_net, SUM(CASE WHEN d_moy = 3 THEN ws_net_paid * ws_quantity ELSE 0 END) AS mar_net, SUM(CASE WHEN d_moy = 4 THEN ws_net_paid * ws_quantity ELSE 0 END) AS apr_net, SUM(CASE WHEN d_moy = 5 THEN ws_net_paid * ws_quantity ELSE 0 END) AS may_net, SUM(CASE WHEN d_moy = 6 THEN ws_net_paid * ws_quantity ELSE 0 END) AS jun_net, SUM(CASE WHEN d_moy = 7 THEN ws_net_paid * ws_quantity ELSE 0 END) AS jul_net, SUM(CASE WHEN d_moy = 8 THEN ws_net_paid * ws_quantity ELSE 0 END) AS aug_net, SUM(CASE WHEN d_moy = 9 THEN ws_net_paid * ws_quantity ELSE 0 END) AS sep_net, SUM(CASE WHEN d_moy = 10 THEN ws_net_paid * ws_quantity ELSE 0 END) AS oct_net, SUM(CASE WHEN d_moy = 11 THEN ws_net_paid * ws_quantity ELSE 0 END) AS nov_net, SUM(CASE WHEN d_moy = 12 THEN ws_net_paid * ws_quantity ELSE 0 END) AS dec_net FROM web_sales JOIN warehouse ON ws_warehouse_sk = w_warehouse_sk JOIN filtered_date_dim ON ws_sold_date_sk = d_date_sk JOIN filtered_time_dim ON ws_sold_time_sk = t_time_sk JOIN filtered_ship_mode ON ws_ship_mode_sk = sm_ship_mode_sk GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year), catalog_sales_aggregated AS (SELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'DHL,BARIAN' AS ship_carriers, d_year AS year_, SUM(CASE WHEN d_moy = 1 THEN cs_sales_price * cs_quantity ELSE 0 END) AS jan_sales, SUM(CASE WHEN d_moy = 2 THEN cs_sales_price * cs_quantity ELSE 0 END) AS feb_sales, SUM(CASE WHEN d_moy = 3 THEN cs_sales_price * cs_quantity ELSE 0 END) AS mar_sales, SUM(CASE WHEN d_moy = 4 THEN cs_sales_price * cs_quantity ELSE 0 END) AS apr_sales, SUM(CASE WHEN d_moy = 5 THEN cs_sales_price * cs_quantity ELSE 0 END) AS may_sales, SUM(CASE WHEN d_moy = 6 THEN cs_sales_price * cs_quantity ELSE 0 END) AS jun_sales, SUM(CASE WHEN d_moy = 7 THEN cs_sales_price * cs_quantity ELSE 0 END) AS jul_sales, SUM(CASE WHEN d_moy = 8 THEN cs_sales_price * cs_quantity ELSE 0 END) AS aug_sales, SUM(CASE WHEN d_moy = 9 THEN cs_sales_price * cs_quantity ELSE 0 END) AS sep_sales, SUM(CASE WHEN d_moy = 10 THEN cs_sales_price * cs_quantity ELSE 0 END) AS oct_sales, SUM(CASE WHEN d_moy = 11 THEN cs_sales_price * cs_quantity ELSE 0 END) AS nov_sales, SUM(CASE WHEN d_moy = 12 THEN cs_sales_price * cs_quantity ELSE 0 END) AS dec_sales, SUM(CASE WHEN d_moy = 1 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS jan_net, SUM(CASE WHEN d_moy = 2 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS feb_net, SUM(CASE WHEN d_moy = 3 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS mar_net, SUM(CASE WHEN d_moy = 4 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS apr_net, SUM(CASE WHEN d_moy = 5 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS may_net, SUM(CASE WHEN d_moy = 6 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS jun_net, SUM(CASE WHEN d_moy = 7 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS jul_net, SUM(CASE WHEN d_moy = 8 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS aug_net, SUM(CASE WHEN d_moy = 9 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS sep_net, SUM(CASE WHEN d_moy = 10 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS oct_net, SUM(CASE WHEN d_moy = 11 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS nov_net, SUM(CASE WHEN d_moy = 12 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS dec_net FROM catalog_sales JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN filtered_date_dim ON cs_sold_date_sk = d_date_sk JOIN filtered_time_dim ON cs_sold_time_sk = t_time_sk JOIN filtered_ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year)\nSELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year_, SUM(jan_sales) AS jan_sales, SUM(feb_sales) AS feb_sales, SUM(mar_sales) AS mar_sales, SUM(apr_sales) AS apr_sales, SUM(may_sales) AS may_sales, SUM(jun_sales) AS jun_sales, SUM(jul_sales) AS jul_sales, SUM(aug_sales) AS aug_sales, SUM(sep_sales) AS sep_sales, SUM(oct_sales) AS oct_sales, SUM(nov_sales) AS nov_sales, SUM(dec_sales) AS dec_sales, SUM(jan_sales / w_warehouse_sq_ft) AS jan_sales_per_sq_foot, SUM(feb_sales / w_warehouse_sq_ft) AS feb_sales_per_sq_foot, SUM(mar_sales / w_warehouse_sq_ft) AS mar_sales_per_sq_foot, SUM(apr_sales / w_warehouse_sq_ft) AS apr_sales_per_sq_foot, SUM(may_sales / w_warehouse_sq_ft) AS may_sales_per_sq_foot, SUM(jun_sales / w_warehouse_sq_ft) AS jun_sales_per_sq_foot, SUM(jul_sales / w_warehouse_sq_ft) AS jul_sales_per_sq_foot, SUM(aug_sales / w_warehouse_sq_ft) AS aug_sales_per_sq_foot, SUM(sep_sales / w_warehouse_sq_ft) AS sep_sales_per_sq_foot, SUM(oct_sales / w_warehouse_sq_ft) AS oct_sales_per_sq_foot, SUM(nov_sales / w_warehouse_sq_ft) AS nov_sales_per_sq_foot, SUM(dec_sales / w_warehouse_sq_ft) AS dec_sales_per_sq_foot, SUM(jan_net) AS jan_net, SUM(feb_net) AS feb_net, SUM(mar_net) AS mar_net, SUM(apr_net) AS apr_net, SUM(may_net) AS may_net, SUM(jun_net) AS jun_net, SUM(jul_net) AS jul_net, SUM(aug_net) AS aug_net, SUM(sep_net) AS sep_net, SUM(oct_net) AS oct_net, SUM(nov_net) AS nov_net, SUM(dec_net) AS dec_net FROM (SELECT * FROM web_sales_aggregated UNION ALL SELECT * FROM catalog_sales_aggregated) AS x GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year_ ORDER BY w_warehouse_name NULLS FIRST LIMIT 100",
          "prompt_tokens": 4467,
          "response_tokens": 1971,
          "llm_time_ms": 157131.47568702698
        },
        {
          "worker_id": 2,
          "query_id": "q66",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date_dim AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 2001), filtered_time_dim AS (SELECT t_time_sk FROM time_dim WHERE t_time BETWEEN 30838 AND 30838 + 28800), filtered_ship_mode AS (SELECT sm_ship_mode_sk FROM ship_mode WHERE sm_carrier IN ('DHL', 'BARIAN')), web_sales_filtered AS (SELECT ws_warehouse_sk, ws_sold_date_sk, ws_sold_time_sk, ws_ship_mode_sk, ws_ext_sales_price, ws_quantity, ws_net_paid FROM web_sales), catalog_sales_filtered AS (SELECT cs_warehouse_sk, cs_sold_date_sk, cs_sold_time_sk, cs_ship_mode_sk, cs_sales_price, cs_quantity, cs_net_paid_inc_tax FROM catalog_sales), web_sales_aggregated AS (SELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, fd.d_year AS year_, SUM(CASE WHEN fd.d_moy = 1 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS jan_sales, SUM(CASE WHEN fd.d_moy = 2 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS feb_sales, SUM(CASE WHEN fd.d_moy = 3 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS mar_sales, SUM(CASE WHEN fd.d_moy = 4 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS apr_sales, SUM(CASE WHEN fd.d_moy = 5 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS may_sales, SUM(CASE WHEN fd.d_moy = 6 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS jun_sales, SUM(CASE WHEN fd.d_moy = 7 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS jul_sales, SUM(CASE WHEN fd.d_moy = 8 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS aug_sales, SUM(CASE WHEN fd.d_moy = 9 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS sep_sales, SUM(CASE WHEN fd.d_moy = 10 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS oct_sales, SUM(CASE WHEN fd.d_moy = 11 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS nov_sales, SUM(CASE WHEN fd.d_moy = 12 THEN ws.ws_ext_sales_price * ws.ws_quantity ELSE 0 END) AS dec_sales, SUM(CASE WHEN fd.d_moy = 1 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS jan_net, SUM(CASE WHEN fd.d_moy = 2 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS feb_net, SUM(CASE WHEN fd.d_moy = 3 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS mar_net, SUM(CASE WHEN fd.d_moy = 4 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS apr_net, SUM(CASE WHEN fd.d_moy = 5 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS may_net, SUM(CASE WHEN fd.d_moy = 6 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS jun_net, SUM(CASE WHEN fd.d_moy = 7 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS jul_net, SUM(CASE WHEN fd.d_moy = 8 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS aug_net, SUM(CASE WHEN fd.d_moy = 9 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS sep_net, SUM(CASE WHEN fd.d_moy = 10 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS oct_net, SUM(CASE WHEN fd.d_moy = 11 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS nov_net, SUM(CASE WHEN fd.d_moy = 12 THEN ws.ws_net_paid * ws.ws_quantity ELSE 0 END) AS dec_net FROM web_sales_filtered AS ws JOIN filtered_date_dim AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_time_dim AS ft ON ws.ws_sold_time_sk = ft.t_time_sk JOIN filtered_ship_mode AS fsm ON ws.ws_ship_mode_sk = fsm.sm_ship_mode_sk JOIN warehouse AS w ON ws.ws_warehouse_sk = w.w_warehouse_sk GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, fd.d_year), catalog_sales_aggregated AS (SELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, fd.d_year AS year_, SUM(CASE WHEN fd.d_moy = 1 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS jan_sales, SUM(CASE WHEN fd.d_moy = 2 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS feb_sales, SUM(CASE WHEN fd.d_moy = 3 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS mar_sales, SUM(CASE WHEN fd.d_moy = 4 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS apr_sales, SUM(CASE WHEN fd.d_moy = 5 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS may_sales, SUM(CASE WHEN fd.d_moy = 6 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS jun_sales, SUM(CASE WHEN fd.d_moy = 7 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS jul_sales, SUM(CASE WHEN fd.d_moy = 8 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS aug_sales, SUM(CASE WHEN fd.d_moy = 9 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS sep_sales, SUM(CASE WHEN fd.d_moy = 10 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS oct_sales, SUM(CASE WHEN fd.d_moy = 11 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS nov_sales, SUM(CASE WHEN fd.d_moy = 12 THEN cs.cs_sales_price * cs.cs_quantity ELSE 0 END) AS dec_sales, SUM(CASE WHEN fd.d_moy = 1 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS jan_net, SUM(CASE WHEN fd.d_moy = 2 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS feb_net, SUM(CASE WHEN fd.d_moy = 3 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS mar_net, SUM(CASE WHEN fd.d_moy = 4 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS apr_net, SUM(CASE WHEN fd.d_moy = 5 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS may_net, SUM(CASE WHEN fd.d_moy = 6 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS jun_net, SUM(CASE WHEN fd.d_moy = 7 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS jul_net, SUM(CASE WHEN fd.d_moy = 8 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS aug_net, SUM(CASE WHEN fd.d_moy = 9 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS sep_net, SUM(CASE WHEN fd.d_moy = 10 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS oct_net, SUM(CASE WHEN fd.d_moy = 11 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS nov_net, SUM(CASE WHEN fd.d_moy = 12 THEN cs.cs_net_paid_inc_tax * cs.cs_quantity ELSE 0 END) AS dec_net FROM catalog_sales_filtered AS cs JOIN filtered_date_dim AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_time_dim AS ft ON cs.cs_sold_time_sk = ft.t_time_sk JOIN filtered_ship_mode AS fsm ON cs.cs_ship_mode_sk = fsm.sm_ship_mode_sk JOIN warehouse AS w ON cs.cs_warehouse_sk = w.w_warehouse_sk GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, fd.d_year)\nSELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'DHL,BARIAN' AS ship_carriers, year_, SUM(jan_sales) AS jan_sales, SUM(feb_sales) AS feb_sales, SUM(mar_sales) AS mar_sales, SUM(apr_sales) AS apr_sales, SUM(may_sales) AS may_sales, SUM(jun_sales) AS jun_sales, SUM(jul_sales) AS jul_sales, SUM(aug_sales) AS aug_sales, SUM(sep_sales) AS sep_sales, SUM(oct_sales) AS oct_sales, SUM(nov_sales) AS nov_sales, SUM(dec_sales) AS dec_sales, SUM(jan_sales / w_warehouse_sq_ft) AS jan_sales_per_sq_foot, SUM(feb_sales / w_warehouse_sq_ft) AS feb_sales_per_sq_foot, SUM(mar_sales / w_warehouse_sq_ft) AS mar_sales_per_sq_foot, SUM(apr_sales / w_warehouse_sq_ft) AS apr_sales_per_sq_foot, SUM(may_sales / w_warehouse_sq_ft) AS may_sales_per_sq_foot, SUM(jun_sales / w_warehouse_sq_ft) AS jun_sales_per_sq_foot, SUM(jul_sales / w_warehouse_sq_ft) AS jul_sales_per_sq_foot, SUM(aug_sales / w_warehouse_sq_ft) AS aug_sales_per_sq_foot, SUM(sep_sales / w_warehouse_sq_ft) AS sep_sales_per_sq_foot, SUM(oct_sales / w_warehouse_sq_ft) AS oct_sales_per_sq_foot, SUM(nov_sales / w_warehouse_sq_ft) AS nov_sales_per_sq_foot, SUM(dec_sales / w_warehouse_sq_ft) AS dec_sales_per_sq_foot, SUM(jan_net) AS jan_net, SUM(feb_net) AS feb_net, SUM(mar_net) AS mar_net, SUM(apr_net) AS apr_net, SUM(may_net) AS may_net, SUM(jun_net) AS jun_net, SUM(jul_net) AS jul_net, SUM(aug_net) AS aug_net, SUM(sep_net) AS sep_net, SUM(oct_net) AS oct_net, SUM(nov_net) AS nov_net, SUM(dec_net) AS dec_net FROM (SELECT * FROM web_sales_aggregated UNION ALL SELECT * FROM catalog_sales_aggregated) AS x GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year_ ORDER BY w_warehouse_name NULLS FIRST LIMIT 100",
          "prompt_tokens": 4614,
          "response_tokens": 2356,
          "llm_time_ms": 161763.97895812988
        },
        {
          "worker_id": 3,
          "query_id": "q66",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 2001), filtered_time AS (SELECT t_time_sk FROM time_dim WHERE t_time BETWEEN 30838 AND 30838 + 28800), filtered_ship_mode AS (SELECT sm_ship_mode_sk FROM ship_mode WHERE sm_carrier IN ('DHL', 'BARIAN')), warehouse_data AS (SELECT w_warehouse_sk, w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country FROM warehouse)\nSELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year_, SUM(jan_sales) AS jan_sales, SUM(feb_sales) AS feb_sales, SUM(mar_sales) AS mar_sales, SUM(apr_sales) AS apr_sales, SUM(may_sales) AS may_sales, SUM(jun_sales) AS jun_sales, SUM(jul_sales) AS jul_sales, SUM(aug_sales) AS aug_sales, SUM(sep_sales) AS sep_sales, SUM(oct_sales) AS oct_sales, SUM(nov_sales) AS nov_sales, SUM(dec_sales) AS dec_sales, SUM(jan_sales / w_warehouse_sq_ft) AS jan_sales_per_sq_foot, SUM(feb_sales / w_warehouse_sq_ft) AS feb_sales_per_sq_foot, SUM(mar_sales / w_warehouse_sq_ft) AS mar_sales_per_sq_foot, SUM(apr_sales / w_warehouse_sq_ft) AS apr_sales_per_sq_foot, SUM(may_sales / w_warehouse_sq_ft) AS may_sales_per_sq_foot, SUM(jun_sales / w_warehouse_sq_ft) AS jun_sales_per_sq_foot, SUM(jul_sales / w_warehouse_sq_ft) AS jul_sales_per_sq_foot, SUM(aug_sales / w_warehouse_sq_ft) AS aug_sales_per_sq_foot, SUM(sep_sales / w_warehouse_sq_ft) AS sep_sales_per_sq_foot, SUM(oct_sales / w_warehouse_sq_ft) AS oct_sales_per_sq_foot, SUM(nov_sales / w_warehouse_sq_ft) AS nov_sales_per_sq_foot, SUM(dec_sales / w_warehouse_sq_ft) AS dec_sales_per_sq_foot, SUM(jan_net) AS jan_net, SUM(feb_net) AS feb_net, SUM(mar_net) AS mar_net, SUM(apr_net) AS apr_net, SUM(may_net) AS may_net, SUM(jun_net) AS jun_net, SUM(jul_net) AS jul_net, SUM(aug_net) AS aug_net, SUM(sep_net) AS sep_net, SUM(oct_net) AS oct_net, SUM(nov_net) AS nov_net, SUM(dec_net) AS dec_net FROM (SELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'DHL,BARIAN' AS ship_carriers, d_year AS year_, SUM(CASE WHEN d_moy = 1 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS jan_sales, SUM(CASE WHEN d_moy = 2 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS feb_sales, SUM(CASE WHEN d_moy = 3 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS mar_sales, SUM(CASE WHEN d_moy = 4 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS apr_sales, SUM(CASE WHEN d_moy = 5 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS may_sales, SUM(CASE WHEN d_moy = 6 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS jun_sales, SUM(CASE WHEN d_moy = 7 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS jul_sales, SUM(CASE WHEN d_moy = 8 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS aug_sales, SUM(CASE WHEN d_moy = 9 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS sep_sales, SUM(CASE WHEN d_moy = 10 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS oct_sales, SUM(CASE WHEN d_moy = 11 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS nov_sales, SUM(CASE WHEN d_moy = 12 THEN ws_ext_sales_price * ws_quantity ELSE 0 END) AS dec_sales, SUM(CASE WHEN d_moy = 1 THEN ws_net_paid * ws_quantity ELSE 0 END) AS jan_net, SUM(CASE WHEN d_moy = 2 THEN ws_net_paid * ws_quantity ELSE 0 END) AS feb_net, SUM(CASE WHEN d_moy = 3 THEN ws_net_paid * ws_quantity ELSE 0 END) AS mar_net, SUM(CASE WHEN d_moy = 4 THEN ws_net_paid * ws_quantity ELSE 0 END) AS apr_net, SUM(CASE WHEN d_moy = 5 THEN ws_net_paid * ws_quantity ELSE 0 END) AS may_net, SUM(CASE WHEN d_moy = 6 THEN ws_net_paid * ws_quantity ELSE 0 END) AS jun_net, SUM(CASE WHEN d_moy = 7 THEN ws_net_paid * ws_quantity ELSE 0 END) AS jul_net, SUM(CASE WHEN d_moy = 8 THEN ws_net_paid * ws_quantity ELSE 0 END) AS aug_net, SUM(CASE WHEN d_moy = 9 THEN ws_net_paid * ws_quantity ELSE 0 END) AS sep_net, SUM(CASE WHEN d_moy = 10 THEN ws_net_paid * ws_quantity ELSE 0 END) AS oct_net, SUM(CASE WHEN d_moy = 11 THEN ws_net_paid * ws_quantity ELSE 0 END) AS nov_net, SUM(CASE WHEN d_moy = 12 THEN ws_net_paid * ws_quantity ELSE 0 END) AS dec_net FROM web_sales JOIN filtered_date ON ws_sold_date_sk = d_date_sk JOIN filtered_time ON ws_sold_time_sk = t_time_sk JOIN filtered_ship_mode ON ws_ship_mode_sk = sm_ship_mode_sk JOIN warehouse_data ON ws_warehouse_sk = w_warehouse_sk GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year UNION ALL SELECT w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, 'DHL,BARIAN' AS ship_carriers, d_year AS year_, SUM(CASE WHEN d_moy = 1 THEN cs_sales_price * cs_quantity ELSE 0 END) AS jan_sales, SUM(CASE WHEN d_moy = 2 THEN cs_sales_price * cs_quantity ELSE 0 END) AS feb_sales, SUM(CASE WHEN d_moy = 3 THEN cs_sales_price * cs_quantity ELSE 0 END) AS mar_sales, SUM(CASE WHEN d_moy = 4 THEN cs_sales_price * cs_quantity ELSE 0 END) AS apr_sales, SUM(CASE WHEN d_moy = 5 THEN cs_sales_price * cs_quantity ELSE 0 END) AS may_sales, SUM(CASE WHEN d_moy = 6 THEN cs_sales_price * cs_quantity ELSE 0 END) AS jun_sales, SUM(CASE WHEN d_moy = 7 THEN cs_sales_price * cs_quantity ELSE 0 END) AS jul_sales, SUM(CASE WHEN d_moy = 8 THEN cs_sales_price * cs_quantity ELSE 0 END) AS aug_sales, SUM(CASE WHEN d_moy = 9 THEN cs_sales_price * cs_quantity ELSE 0 END) AS sep_sales, SUM(CASE WHEN d_moy = 10 THEN cs_sales_price * cs_quantity ELSE 0 END) AS oct_sales, SUM(CASE WHEN d_moy = 11 THEN cs_sales_price * cs_quantity ELSE 0 END) AS nov_sales, SUM(CASE WHEN d_moy = 12 THEN cs_sales_price * cs_quantity ELSE 0 END) AS dec_sales, SUM(CASE WHEN d_moy = 1 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS jan_net, SUM(CASE WHEN d_moy = 2 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS feb_net, SUM(CASE WHEN d_moy = 3 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS mar_net, SUM(CASE WHEN d_moy = 4 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS apr_net, SUM(CASE WHEN d_moy = 5 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS may_net, SUM(CASE WHEN d_moy = 6 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS jun_net, SUM(CASE WHEN d_moy = 7 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS jul_net, SUM(CASE WHEN d_moy = 8 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS aug_net, SUM(CASE WHEN d_moy = 9 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS sep_net, SUM(CASE WHEN d_moy = 10 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS oct_net, SUM(CASE WHEN d_moy = 11 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS nov_net, SUM(CASE WHEN d_moy = 12 THEN cs_net_paid_inc_tax * cs_quantity ELSE 0 END) AS dec_net FROM catalog_sales JOIN filtered_date ON cs_sold_date_sk = d_date_sk JOIN filtered_time ON cs_sold_time_sk = t_time_sk JOIN filtered_ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN warehouse_data ON cs_warehouse_sk = w_warehouse_sk GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, d_year) AS x GROUP BY w_warehouse_name, w_warehouse_sq_ft, w_city, w_county, w_state, w_country, ship_carriers, year_ ORDER BY w_warehouse_name NULLS FIRST LIMIT 100",
          "prompt_tokens": 4631,
          "response_tokens": 2074,
          "llm_time_ms": 218393.84150505066
        }
      ],
      "original_speedup": 1.23,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676122"
    },
    {
      "query_id": "q84",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q84",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Edgewood'), filtered_income_band AS (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 38128 AND ib_upper_bound <= 88128), filtered_household_demographics AS (SELECT hd_demo_sk FROM household_demographics AS hd JOIN filtered_income_band AS ib ON hd.hd_income_band_sk = ib.ib_income_band_sk), filtered_customer AS (SELECT c_customer_id, c_last_name, c_first_name, c_current_cdemo_sk, c_current_hdemo_sk FROM customer AS c JOIN filtered_customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN filtered_household_demographics AS hd ON c.c_current_hdemo_sk = hd.hd_demo_sk), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics AS cd JOIN filtered_customer AS c ON cd.cd_demo_sk = c.c_current_cdemo_sk)\nSELECT c_customer_id AS customer_id, CONCAT(CONCAT(COALESCE(c_last_name, ''), ', '), COALESCE(c_first_name, '')) AS customername FROM filtered_customer AS c JOIN filtered_customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN store_returns AS sr ON sr.sr_cdemo_sk = cd.cd_demo_sk ORDER BY c_customer_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3789,
          "response_tokens": 578,
          "llm_time_ms": 135727.29754447937
        },
        {
          "worker_id": 1,
          "query_id": "q84",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Edgewood'), filtered_income_band AS (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 38128 AND ib_upper_bound <= 38128 + 50000), filtered_household_demographics AS (SELECT hd_demo_sk FROM household_demographics AS hd JOIN filtered_income_band AS fib ON hd.hd_income_band_sk = fib.ib_income_band_sk), filtered_customer AS (SELECT c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_customer_id, c_last_name, c_first_name FROM customer AS c JOIN filtered_customer_address AS fca ON c.c_current_addr_sk = fca.ca_address_sk JOIN filtered_household_demographics AS fhd ON c.c_current_hdemo_sk = fhd.hd_demo_sk), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics AS cd JOIN filtered_customer AS fc ON cd.cd_demo_sk = fc.c_current_cdemo_sk)\nSELECT fc.c_customer_id AS customer_id, CONCAT(CONCAT(COALESCE(fc.c_last_name, ''), ', '), COALESCE(fc.c_first_name, '')) AS customername FROM filtered_customer AS fc JOIN store_returns AS sr ON EXISTS(SELECT 1 FROM filtered_customer_demographics AS fcd WHERE fcd.cd_demo_sk = sr.sr_cdemo_sk) ORDER BY fc.c_customer_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 2572,
          "response_tokens": 1404,
          "llm_time_ms": 148978.37901115417
        },
        {
          "worker_id": 2,
          "query_id": "q84",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Edgewood'), filtered_income_band AS (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 38128 AND ib_upper_bound <= 38128 + 50000), filtered_household_demographics AS (SELECT hd_demo_sk, hd_income_band_sk FROM household_demographics JOIN filtered_income_band ON hd_income_band_sk = ib_income_band_sk), filtered_customers AS (SELECT c_customer_id, c_first_name, c_last_name, c_current_cdemo_sk FROM customer JOIN filtered_customer_address ON c_current_addr_sk = ca_address_sk JOIN filtered_household_demographics ON c_current_hdemo_sk = hd_demo_sk), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics JOIN filtered_customers ON cd_demo_sk = c_current_cdemo_sk)\nSELECT c_customer_id AS customer_id, CONCAT(CONCAT(COALESCE(c_last_name, ''), ', '), COALESCE(c_first_name, '')) AS customername FROM filtered_customers AS c JOIN filtered_customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN store_returns AS sr ON sr.sr_cdemo_sk = cd.cd_demo_sk ORDER BY c_customer_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 2723,
          "response_tokens": 646,
          "llm_time_ms": 159687.0424747467
        },
        {
          "worker_id": 3,
          "query_id": "q84",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Edgewood'), filtered_income AS (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 38128 AND ib_upper_bound <= 38128 + 50000), filtered_household AS (SELECT hd_demo_sk FROM household_demographics AS hd JOIN filtered_income AS ib ON hd.hd_income_band_sk = ib.ib_income_band_sk), filtered_customer AS (SELECT c_customer_id, c_last_name, c_first_name, c_current_cdemo_sk FROM customer AS c JOIN filtered_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN filtered_household AS hh ON c.c_current_hdemo_sk = hh.hd_demo_sk), filtered_demographics AS (SELECT cd_demo_sk FROM customer_demographics AS cd JOIN filtered_customer AS fc ON cd.cd_demo_sk = fc.c_current_cdemo_sk)\nSELECT fc.c_customer_id AS customer_id, CONCAT(CONCAT(COALESCE(fc.c_last_name, ''), ', '), COALESCE(fc.c_first_name, '')) AS customername FROM filtered_customer AS fc JOIN filtered_demographics AS fd ON fc.c_current_cdemo_sk = fd.cd_demo_sk JOIN store_returns AS sr ON fd.cd_demo_sk = sr.sr_cdemo_sk ORDER BY fc.c_customer_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 2736,
          "response_tokens": 694,
          "llm_time_ms": 214429.50201034546
        }
      ],
      "original_speedup": 1.22,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676125"
    },
    {
      "query_id": "q17",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q17",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_dates AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name = '2001Q1'), d2_dates AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')), d3_dates AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')), filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_ticket_number, ss_store_sk, ss_quantity FROM store_sales JOIN d1_dates ON store_sales.ss_sold_date_sk = d1_dates.d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_return_quantity FROM store_returns JOIN d2_dates ON store_returns.sr_returned_date_sk = d2_dates.d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_quantity FROM catalog_sales JOIN d3_dates ON catalog_sales.cs_sold_date_sk = d3_dates.d_date_sk)\nSELECT i.i_item_id, i.i_item_desc, s.s_state, COUNT(fss.ss_quantity) AS store_sales_quantitycount, AVG(fss.ss_quantity) AS store_sales_quantityave, STDDEV_SAMP(fss.ss_quantity) AS store_sales_quantitystdev, STDDEV_SAMP(fss.ss_quantity) / AVG(fss.ss_quantity) AS store_sales_quantitycov, COUNT(fsr.sr_return_quantity) AS store_returns_quantitycount, AVG(fsr.sr_return_quantity) AS store_returns_quantityave, STDDEV_SAMP(fsr.sr_return_quantity) AS store_returns_quantitystdev, STDDEV_SAMP(fsr.sr_return_quantity) / AVG(fsr.sr_return_quantity) AS store_returns_quantitycov, COUNT(fcs.cs_quantity) AS catalog_sales_quantitycount, AVG(fcs.cs_quantity) AS catalog_sales_quantityave, STDDEV_SAMP(fcs.cs_quantity) AS catalog_sales_quantitystdev, STDDEV_SAMP(fcs.cs_quantity) / AVG(fcs.cs_quantity) AS catalog_sales_quantitycov FROM filtered_store_sales AS fss JOIN filtered_store_returns AS fsr ON fss.ss_customer_sk = fsr.sr_customer_sk AND fss.ss_item_sk = fsr.sr_item_sk AND fss.ss_ticket_number = fsr.sr_ticket_number JOIN filtered_catalog_sales AS fcs ON fsr.sr_customer_sk = fcs.cs_bill_customer_sk AND fsr.sr_item_sk = fcs.cs_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk JOIN item AS i ON fss.ss_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_item_desc, s.s_state ORDER BY i.i_item_id NULLS FIRST, i.i_item_desc NULLS FIRST, s.s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 3113,
          "response_tokens": 956,
          "llm_time_ms": 89483.0629825592
        },
        {
          "worker_id": 3,
          "query_id": "q17",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d1 AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name = '2001Q1'), filtered_d2 AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')), filtered_d3 AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')), filtered_store_sales AS (SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_quantity FROM store_sales JOIN filtered_d1 ON ss_sold_date_sk = d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_return_quantity FROM store_returns JOIN filtered_d2 ON sr_returned_date_sk = d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_quantity FROM catalog_sales JOIN filtered_d3 ON cs_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, s_state, COUNT(ss_quantity) AS store_sales_quantitycount, AVG(ss_quantity) AS store_sales_quantityave, STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev, STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov, COUNT(sr_return_quantity) AS store_returns_quantitycount, AVG(sr_return_quantity) AS store_returns_quantityave, STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev, STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov, COUNT(cs_quantity) AS catalog_sales_quantitycount, AVG(cs_quantity) AS catalog_sales_quantityave, STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev, STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov FROM filtered_store_sales JOIN filtered_store_returns ON ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN filtered_catalog_sales ON sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk JOIN item ON i_item_sk = ss_item_sk JOIN store ON s_store_sk = ss_store_sk GROUP BY i_item_id, i_item_desc, s_state ORDER BY i_item_id NULLS FIRST, i_item_desc NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 3137,
          "response_tokens": 784,
          "llm_time_ms": 130772.4494934082
        },
        {
          "worker_id": 4,
          "query_id": "q17",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name = '2001Q1'), d2_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')), d3_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')), filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_ticket_number, ss_store_sk, ss_quantity FROM store_sales WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM d1_filtered)), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_return_quantity FROM store_returns WHERE sr_returned_date_sk IN (SELECT d_date_sk FROM d2_filtered)), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_quantity FROM catalog_sales WHERE cs_sold_date_sk IN (SELECT d_date_sk FROM d3_filtered))\nSELECT i_item_id, i_item_desc, s_state, COUNT(fss.ss_quantity) AS store_sales_quantitycount, AVG(fss.ss_quantity) AS store_sales_quantityave, STDDEV_SAMP(fss.ss_quantity) AS store_sales_quantitystdev, STDDEV_SAMP(fss.ss_quantity) / AVG(fss.ss_quantity) AS store_sales_quantitycov, COUNT(fsr.sr_return_quantity) AS store_returns_quantitycount, AVG(fsr.sr_return_quantity) AS store_returns_quantityave, STDDEV_SAMP(fsr.sr_return_quantity) AS store_returns_quantitystdev, STDDEV_SAMP(fsr.sr_return_quantity) / AVG(fsr.sr_return_quantity) AS store_returns_quantitycov, COUNT(fcs.cs_quantity) AS catalog_sales_quantitycount, AVG(fcs.cs_quantity) AS catalog_sales_quantityave, STDDEV_SAMP(fcs.cs_quantity) AS catalog_sales_quantitystdev, STDDEV_SAMP(fcs.cs_quantity) / AVG(fcs.cs_quantity) AS catalog_sales_quantitycov FROM filtered_store_sales AS fss JOIN item ON fss.ss_item_sk = item.i_item_sk JOIN store ON fss.ss_store_sk = store.s_store_sk JOIN filtered_store_returns AS fsr ON fss.ss_customer_sk = fsr.sr_customer_sk AND fss.ss_item_sk = fsr.sr_item_sk AND fss.ss_ticket_number = fsr.sr_ticket_number JOIN filtered_catalog_sales AS fcs ON fsr.sr_customer_sk = fcs.cs_bill_customer_sk AND fsr.sr_item_sk = fcs.cs_item_sk GROUP BY i_item_id, i_item_desc, s_state ORDER BY i_item_id NULLS FIRST, i_item_desc NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 4187,
          "response_tokens": 765,
          "llm_time_ms": 149866.8828010559
        },
        {
          "worker_id": 1,
          "query_id": "q17",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d1 AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name = '2001Q1'), filtered_d23 AS (SELECT d_date_sk FROM date_dim WHERE d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')), filtered_ss AS (SELECT ss_item_sk, ss_customer_sk, ss_ticket_number, ss_store_sk, ss_quantity FROM store_sales JOIN filtered_d1 ON ss_sold_date_sk = d_date_sk), filtered_sr AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_return_quantity FROM store_returns JOIN filtered_d23 ON sr_returned_date_sk = d_date_sk), filtered_cs AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_quantity FROM catalog_sales JOIN filtered_d23 ON cs_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, s_state, COUNT(ss_quantity) AS store_sales_quantitycount, AVG(ss_quantity) AS store_sales_quantityave, STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev, STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov, COUNT(sr_return_quantity) AS store_returns_quantitycount, AVG(sr_return_quantity) AS store_returns_quantityave, STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev, STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov, COUNT(cs_quantity) AS catalog_sales_quantitycount, AVG(cs_quantity) AS catalog_sales_quantityave, STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev, STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov FROM filtered_ss JOIN filtered_sr ON (ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) JOIN filtered_cs ON (sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk) JOIN store ON ss_store_sk = s_store_sk JOIN item ON ss_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, s_state ORDER BY i_item_id NULLS FIRST, i_item_desc NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 2970,
          "response_tokens": 630,
          "llm_time_ms": 184778.07688713074
        }
      ],
      "original_speedup": 1.19,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676128"
    },
    {
      "query_id": "q3",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q3",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11)\nSELECT dt.d_year, item.i_brand_id AS brand_id, item.i_brand AS brand, SUM(ss_ext_sales_price) AS sum_agg FROM store_sales JOIN filtered_dates AS dt ON store_sales.ss_sold_date_sk = dt.d_date_sk JOIN item ON store_sales.ss_item_sk = item.i_item_sk WHERE item.i_manufact_id = 128 GROUP BY dt.d_year, item.i_brand, item.i_brand_id ORDER BY dt.d_year, sum_agg DESC, brand_id LIMIT 100",
          "prompt_tokens": 2685,
          "response_tokens": 316,
          "llm_time_ms": 72410.25805473328
        },
        {
          "worker_id": 2,
          "query_id": "q3",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manufact_id = 128), joined_facts AS (SELECT fd.d_year, fi.i_brand_id, fi.i_brand, ss_ext_sales_price FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items AS fi ON ss.ss_item_sk = fi.i_item_sk)\nSELECT d_year, i_brand_id AS brand_id, i_brand AS brand, SUM(ss_ext_sales_price) AS sum_agg FROM joined_facts GROUP BY d_year, i_brand, i_brand_id ORDER BY d_year, sum_agg DESC, brand_id LIMIT 100",
          "prompt_tokens": 2668,
          "response_tokens": 357,
          "llm_time_ms": 91915.24004936218
        },
        {
          "worker_id": 4,
          "query_id": "q3",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manufact_id = 128)\nSELECT dt.d_year, item.i_brand_id AS brand_id, item.i_brand AS brand, SUM(ss_ext_sales_price) AS sum_agg FROM store_sales JOIN filtered_dates AS dt ON store_sales.ss_sold_date_sk = dt.d_date_sk JOIN filtered_items AS item ON store_sales.ss_item_sk = item.i_item_sk GROUP BY dt.d_year, item.i_brand, item.i_brand_id ORDER BY dt.d_year, sum_agg DESC, brand_id LIMIT 100",
          "prompt_tokens": 3737,
          "response_tokens": 333,
          "llm_time_ms": 100437.71862983704
        },
        {
          "worker_id": 1,
          "query_id": "q3",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11), filtered_item AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manufact_id = 128)\nSELECT dt.d_year, item.i_brand_id AS brand_id, item.i_brand AS brand, SUM(ss_ext_sales_price) AS sum_agg FROM filtered_date AS dt JOIN store_sales ON dt.d_date_sk = store_sales.ss_sold_date_sk JOIN filtered_item AS item ON store_sales.ss_item_sk = item.i_item_sk GROUP BY dt.d_year, item.i_brand, item.i_brand_id ORDER BY dt.d_year, sum_agg DESC, brand_id LIMIT 100",
          "prompt_tokens": 2521,
          "response_tokens": 285,
          "llm_time_ms": 123799.9587059021
        }
      ],
      "original_speedup": 1.19,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676130"
    },
    {
      "query_id": "q82",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q82",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-05-25' AS DATE) AND CAST('2000-07-24' AS DATE)), filtered_item AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 62 AND 62 + 30 AND i_manufact_id IN (129, 270, 821, 423)), filtered_inventory AS (SELECT inv_item_sk, inv_date_sk FROM inventory WHERE inv_quantity_on_hand BETWEEN 100 AND 500), qualified_inventory AS (SELECT inv_item_sk FROM filtered_inventory AS inv JOIN filtered_date AS d ON inv.inv_date_sk = d.d_date_sk JOIN filtered_item AS i ON inv.inv_item_sk = i.i_item_sk)\nSELECT i_item_id, i_item_desc, i_current_price FROM filtered_item AS i WHERE EXISTS(SELECT 1 FROM qualified_inventory AS qi WHERE qi.inv_item_sk = i.i_item_sk) AND EXISTS(SELECT 1 FROM store_sales AS ss WHERE ss_item_sk = i.i_item_sk) ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 2659,
          "response_tokens": 419,
          "llm_time_ms": 138272.02939987183
        },
        {
          "worker_id": 3,
          "query_id": "q82",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-05-25' AS DATE) AND CAST('2000-07-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 62 AND 92 AND i_manufact_id IN (129, 270, 821, 423)), filtered_inventory AS (SELECT inv_item_sk FROM inventory JOIN filtered_dates ON d_date_sk = inv_date_sk WHERE inv_quantity_on_hand BETWEEN 100 AND 500)\nSELECT i_item_id, i_item_desc, i_current_price FROM filtered_items AS fi JOIN filtered_inventory AS inv ON fi.i_item_sk = inv.inv_item_sk JOIN store_sales AS ss ON fi.i_item_sk = ss.ss_item_sk GROUP BY i_item_id, i_item_desc, i_current_price ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 2823,
          "response_tokens": 620,
          "llm_time_ms": 145944.30923461914
        },
        {
          "worker_id": 4,
          "query_id": "q82",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-05-25' AS DATE) AND CAST('2000-07-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 62 AND 62 + 30 AND i_manufact_id IN (129, 270, 821, 423)), valid_inventory AS (SELECT inv_item_sk FROM inventory JOIN filtered_dates ON d_date_sk = inv_date_sk WHERE inv_quantity_on_hand BETWEEN 100 AND 500)\nSELECT i_item_id, i_item_desc, i_current_price FROM filtered_items AS fi JOIN valid_inventory AS vi ON fi.i_item_sk = vi.inv_item_sk WHERE EXISTS(SELECT 1 FROM store_sales WHERE ss_item_sk = fi.i_item_sk) GROUP BY i_item_id, i_item_desc, i_current_price ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 3875,
          "response_tokens": 668,
          "llm_time_ms": 167068.617105484
        },
        {
          "worker_id": 2,
          "query_id": "q82",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-05-25' AS DATE) AND CAST('2000-07-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 62 AND 92 AND i_manufact_id IN (129, 270, 821, 423)), filtered_inventory AS (SELECT inv_item_sk, inv_date_sk FROM inventory WHERE inv_quantity_on_hand BETWEEN 100 AND 500), inventory_with_dates AS (SELECT fi.inv_item_sk, fi.inv_date_sk FROM filtered_inventory AS fi JOIN filtered_dates AS fd ON fi.inv_date_sk = fd.d_date_sk), qualified_items AS (SELECT i.i_item_sk, i.i_item_id, i.i_item_desc, i.i_current_price FROM filtered_items AS i JOIN inventory_with_dates AS iwd ON i.i_item_sk = iwd.inv_item_sk)\nSELECT qi.i_item_id, qi.i_item_desc, qi.i_current_price FROM qualified_items AS qi JOIN store_sales AS ss ON qi.i_item_sk = ss.ss_item_sk GROUP BY qi.i_item_id, qi.i_item_desc, qi.i_current_price ORDER BY qi.i_item_id LIMIT 100",
          "prompt_tokens": 2806,
          "response_tokens": 698,
          "llm_time_ms": 204127.98857688904
        }
      ],
      "original_speedup": 1.18,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676135"
    },
    {
      "query_id": "q19",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q19",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1998), filtered_item AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_manager_id = 8), filtered_store AS (SELECT s_store_sk, s_zip FROM store), filtered_customer AS (SELECT c_customer_sk, c_current_addr_sk FROM customer), filtered_address AS (SELECT ca_address_sk, ca_zip FROM customer_address), early_join AS (SELECT ss.ss_item_sk, ss.ss_customer_sk, ss.ss_store_sk, ss.ss_ext_sales_price, i.i_brand_id, i.i_brand, i.i_manufact_id, i.i_manufact, ca.ca_zip, s.s_zip FROM store_sales AS ss JOIN filtered_date AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_item AS i ON ss.ss_item_sk = i.i_item_sk JOIN filtered_customer AS c ON ss.ss_customer_sk = c.c_customer_sk JOIN filtered_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk)\nSELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM early_join WHERE SUBSTRING(ca_zip, 1, 5) <> SUBSTRING(s_zip, 1, 5) GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100",
          "prompt_tokens": 2690,
          "response_tokens": 529,
          "llm_time_ms": 91534.05380249023
        },
        {
          "worker_id": 4,
          "query_id": "q19",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1998), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_manager_id = 8), filtered_stores AS (SELECT s_store_sk, SUBSTRING(s_zip, 1, 5) AS s_zip_prefix FROM store), filtered_customer_address AS (SELECT ca_address_sk, SUBSTRING(ca_zip, 1, 5) AS ca_zip_prefix FROM customer_address), joined_customers AS (SELECT c_customer_sk, ca_address_sk, ca_zip_prefix FROM customer JOIN filtered_customer_address ON c_current_addr_sk = ca_address_sk), filtered_sales AS (SELECT ss_ext_sales_price, ss_item_sk, ss_customer_sk, ss_store_sk FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk)\nSELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM filtered_sales JOIN filtered_items ON ss_item_sk = i_item_sk JOIN joined_customers ON ss_customer_sk = c_customer_sk JOIN filtered_stores ON ss_store_sk = s_store_sk WHERE ca_zip_prefix <> s_zip_prefix GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100",
          "prompt_tokens": 3906,
          "response_tokens": 535,
          "llm_time_ms": 105460.24107933044
        },
        {
          "worker_id": 2,
          "query_id": "q19",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1998), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_manager_id = 8), filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_store_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk), filtered_store_sales_with_items AS (SELECT fss.ss_customer_sk, fss.ss_store_sk, fss.ss_ext_sales_price, fi.i_brand_id, fi.i_brand, fi.i_manufact_id, fi.i_manufact FROM filtered_store_sales AS fss JOIN filtered_items AS fi ON fss.ss_item_sk = fi.i_item_sk)\nSELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM filtered_store_sales_with_items AS fss JOIN customer AS c ON fss.ss_customer_sk = c_customer_sk JOIN customer_address AS ca ON c_current_addr_sk = ca_address_sk JOIN store AS s ON fss.ss_store_sk = s_store_sk WHERE SUBSTRING(ca_zip, 1, 5) <> SUBSTRING(s_zip, 1, 5) GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100",
          "prompt_tokens": 2837,
          "response_tokens": 464,
          "llm_time_ms": 124078.17506790161
        },
        {
          "worker_id": 3,
          "query_id": "q19",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1998), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_manager_id = 8), filtered_stores AS (SELECT s_store_sk, s_zip FROM store), filtered_addresses AS (SELECT ca_address_sk, ca_zip FROM customer_address), prejoined_sales AS (SELECT ss_customer_sk, ss_store_sk, ss_ext_sales_price, i_brand_id, i_brand, i_manufact_id, i_manufact FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk)\nSELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM prejoined_sales AS p JOIN customer ON p.ss_customer_sk = c_customer_sk JOIN filtered_addresses ON c_current_addr_sk = ca_address_sk JOIN filtered_stores ON p.ss_store_sk = s_store_sk WHERE SUBSTRING(ca_zip, 1, 5) <> SUBSTRING(s_zip, 1, 5) GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100",
          "prompt_tokens": 2853,
          "response_tokens": 518,
          "llm_time_ms": 129713.71078491211
        }
      ],
      "original_speedup": 1.16,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676138"
    },
    {
      "query_id": "q18",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q18",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998), filtered_cd1 AS (SELECT cd_demo_sk, cd_dep_count FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = 'Unknown'), filtered_customer AS (SELECT c_customer_sk, c_current_cdemo_sk, c_current_addr_sk, c_birth_year FROM customer WHERE c_birth_month IN (1, 6, 8, 9, 12, 2)), filtered_address AS (SELECT ca_address_sk, ca_country, ca_state, ca_county FROM customer_address WHERE ca_state IN ('MS', 'IN', 'ND', 'OK', 'NM', 'VA'))\nSELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6, AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7 FROM catalog_sales JOIN filtered_date ON cs_sold_date_sk = d_date_sk JOIN item ON cs_item_sk = i_item_sk JOIN filtered_cd1 AS cd1 ON cs_bill_cdemo_sk = cd1.cd_demo_sk JOIN filtered_customer ON cs_bill_customer_sk = c_customer_sk JOIN customer_demographics AS cd2 ON filtered_customer.c_current_cdemo_sk = cd2.cd_demo_sk JOIN filtered_address ON filtered_customer.c_current_addr_sk = ca_address_sk GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country NULLS FIRST, ca_state NULLS FIRST, ca_county NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 2860,
          "response_tokens": 574,
          "llm_time_ms": 108157.91749954224
        },
        {
          "worker_id": 2,
          "query_id": "q18",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998), filtered_cd1 AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = 'Unknown'), filtered_customer AS (SELECT c_customer_sk, c_current_cdemo_sk, c_current_addr_sk, c_birth_year FROM customer WHERE c_birth_month IN (1, 6, 8, 9, 12, 2)), filtered_address AS (SELECT ca_address_sk, ca_country, ca_state, ca_county FROM customer_address WHERE ca_state IN ('MS', 'IN', 'ND', 'OK', 'NM', 'VA', 'MS')), prejoined_facts AS (SELECT cs.cs_item_sk, cs.cs_quantity, cs.cs_list_price, cs.cs_coupon_amt, cs.cs_sales_price, cs.cs_net_profit, cs.cs_bill_customer_sk FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_cd1 AS cd1 ON cs.cs_bill_cdemo_sk = cd1.cd_demo_sk)\nSELECT i.i_item_id, fa.ca_country, fa.ca_state, fa.ca_county, AVG(CAST(pjf.cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(pjf.cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(pjf.cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(pjf.cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(pjf.cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(fc.c_birth_year AS DECIMAL(12, 2))) AS agg6, AVG(CAST(cd2.cd_dep_count AS DECIMAL(12, 2))) AS agg7 FROM prejoined_facts AS pjf JOIN filtered_customer AS fc ON pjf.cs_bill_customer_sk = fc.c_customer_sk JOIN filtered_address AS fa ON fc.c_current_addr_sk = fa.ca_address_sk JOIN customer_demographics AS cd2 ON fc.c_current_cdemo_sk = cd2.cd_demo_sk JOIN item AS i ON pjf.cs_item_sk = i.i_item_sk GROUP BY ROLLUP (i.i_item_id, fa.ca_country, fa.ca_state, fa.ca_county) ORDER BY fa.ca_country NULLS FIRST, fa.ca_state NULLS FIRST, fa.ca_county NULLS FIRST, i.i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3006,
          "response_tokens": 647,
          "llm_time_ms": 111488.04354667664
        },
        {
          "worker_id": 3,
          "query_id": "q18",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998), filtered_cd1 AS (SELECT cd_demo_sk, cd_dep_count FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = 'Unknown'), filtered_customer AS (SELECT c_customer_sk, c_current_cdemo_sk, c_current_addr_sk, c_birth_year FROM customer WHERE c_birth_month IN (1, 6, 8, 9, 12, 2)), filtered_address AS (SELECT ca_address_sk, ca_country, ca_state, ca_county FROM customer_address WHERE ca_state IN ('MS', 'IN', 'ND', 'OK', 'NM', 'VA'))\nSELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6, AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7 FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_cd1 AS cd1 ON cs_bill_cdemo_sk = cd1.cd_demo_sk JOIN filtered_customer ON cs_bill_customer_sk = c_customer_sk JOIN filtered_address ON c_current_addr_sk = ca_address_sk JOIN item ON cs_item_sk = i_item_sk JOIN customer_demographics AS cd2 ON c_current_cdemo_sk = cd2.cd_demo_sk GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country NULLS FIRST, ca_state NULLS FIRST, ca_county NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3023,
          "response_tokens": 708,
          "llm_time_ms": 120329.7188282013
        },
        {
          "worker_id": 4,
          "query_id": "q18",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998), filtered_cd1 AS (SELECT cd_demo_sk, cd_dep_count FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = 'Unknown'), filtered_customer AS (SELECT c_customer_sk, c_current_cdemo_sk, c_current_addr_sk, c_birth_year FROM customer WHERE c_birth_month IN (1, 6, 8, 9, 12, 2)), filtered_address AS (SELECT ca_address_sk, ca_country, ca_state, ca_county FROM customer_address WHERE ca_state IN ('MS', 'IN', 'ND', 'OK', 'NM', 'VA', 'MS')), qualified_sales AS (SELECT cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, cs_net_profit, cs_item_sk, cs_bill_customer_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk), qualified_sales_with_cd1 AS (SELECT qs.*, cd1.cd_dep_count FROM qualified_sales AS qs JOIN filtered_cd1 AS cd1 ON cs_bill_cdemo_sk = cd1.cd_demo_sk), qualified_sales_with_customer AS (SELECT qs.*, c.c_current_cdemo_sk, c.c_current_addr_sk, c.c_birth_year FROM qualified_sales_with_cd1 AS qs JOIN filtered_customer AS c ON qs.cs_bill_customer_sk = c.c_customer_sk), qualified_sales_with_address AS (SELECT qs.*, ca.ca_country, ca.ca_state, ca.ca_county FROM qualified_sales_with_customer AS qs JOIN filtered_address AS ca ON qs.c_current_addr_sk = ca.ca_address_sk), full_qualified_sales AS (SELECT qs.*, i.i_item_id FROM qualified_sales_with_address AS qs JOIN item AS i ON qs.cs_item_sk = i.i_item_sk)\nSELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6, AVG(CAST(cd_dep_count AS DECIMAL(12, 2))) AS agg7 FROM full_qualified_sales AS qs JOIN customer_demographics AS cd2 ON qs.c_current_cdemo_sk = cd2.cd_demo_sk GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country NULLS FIRST, ca_state NULLS FIRST, ca_county NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 4079,
          "response_tokens": 877,
          "llm_time_ms": 134482.1662902832
        }
      ],
      "original_speedup": 1.14,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676143"
    },
    {
      "query_id": "q41",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q41",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_items AS (SELECT DISTINCT i_product_name FROM item AS i1 WHERE i_manufact_id BETWEEN 738 AND 778 AND EXISTS(SELECT 1 FROM item WHERE i_manufact = i1.i_manufact AND i_category = 'Women' AND i_color IN ('powder', 'khaki') AND i_units IN ('Ounce', 'Oz') AND i_size IN ('medium', 'extra large') UNION ALL SELECT 1 FROM item WHERE i_manufact = i1.i_manufact AND i_category = 'Women' AND i_color IN ('brown', 'honeydew') AND i_units IN ('Bunch', 'Ton') AND i_size IN ('N/A', 'small') UNION ALL SELECT 1 FROM item WHERE i_manufact = i1.i_manufact AND i_category = 'Men' AND i_color IN ('floral', 'deep') AND i_units IN ('N/A', 'Dozen') AND i_size = 'petite' UNION ALL SELECT 1 FROM item WHERE i_manufact = i1.i_manufact AND i_category = 'Men' AND i_color IN ('light', 'cornflower') AND i_units IN ('Box', 'Pound') AND i_size IN ('medium', 'extra large') UNION ALL SELECT 1 FROM item WHERE i_manufact = i1.i_manufact AND i_category = 'Women' AND i_color IN ('midnight', 'snow') AND i_units IN ('Pallet', 'Gross') AND i_size IN ('medium', 'extra large') UNION ALL SELECT 1 FROM item WHERE i_manufact = i1.i_manufact AND i_category = 'Women' AND i_color IN ('cyan', 'papaya') AND i_units IN ('Cup', 'Dram') AND i_size IN ('N/A', 'small') UNION ALL SELECT 1 FROM item WHERE i_manufact = i1.i_manufact AND i_category = 'Men' AND i_color IN ('orange', 'frosted') AND i_units IN ('Each', 'Tbl') AND i_size = 'petite' UNION ALL SELECT 1 FROM item WHERE i_manufact = i1.i_manufact AND i_category = 'Men' AND i_color IN ('forest', 'ghost') AND i_units IN ('Lb', 'Bundle') AND i_size IN ('medium', 'extra large')) ORDER BY i_product_name LIMIT 100)\nSELECT DISTINCT (i_product_name) FROM item AS i1 WHERE i_manufact_id BETWEEN 738 AND 738 + 40 AND (SELECT COUNT(*) AS item_cnt FROM item WHERE (i_manufact = i1.i_manufact AND ((i_category = 'Women' AND (i_color = 'powder' OR i_color = 'khaki') AND (i_units = 'Ounce' OR i_units = 'Oz') AND (i_size = 'medium' OR i_size = 'extra large')) OR (i_category = 'Women' AND (i_color = 'brown' OR i_color = 'honeydew') AND (i_units = 'Bunch' OR i_units = 'Ton') AND (i_size = 'N/A' OR i_size = 'small')) OR (i_category = 'Men' AND (i_color = 'floral' OR i_color = 'deep') AND (i_units = 'N/A' OR i_units = 'Dozen') AND (i_size = 'petite' OR i_size = 'petite')) OR (i_category = 'Men' AND (i_color = 'light' OR i_color = 'cornflower') AND (i_units = 'Box' OR i_units = 'Pound') AND (i_size = 'medium' OR i_size = 'extra large')))) OR (i_manufact = i1.i_manufact AND ((i_category = 'Women' AND (i_color = 'midnight' OR i_color = 'snow') AND (i_units = 'Pallet' OR i_units = 'Gross') AND (i_size = 'medium' OR i_size = 'extra large')) OR (i_category = 'Women' AND (i_color = 'cyan' OR i_color = 'papaya') AND (i_units = 'Cup' OR i_units = 'Dram') AND (i_size = 'N/A' OR i_size = 'small')) OR (i_category = 'Men' AND (i_color = 'orange' OR i_color = 'frosted') AND (i_units = 'Each' OR i_units = 'Tbl') AND (i_size = 'petite' OR i_size = 'petite')) OR (i_category = 'Men' AND (i_color = 'forest' OR i_color = 'ghost') AND (i_units = 'Lb' OR i_units = 'Bundle') AND (i_size = 'medium' OR i_size = 'extra large'))))) > 0 ORDER BY i_product_name LIMIT 100",
          "prompt_tokens": 4225,
          "response_tokens": 876,
          "llm_time_ms": 149031.8763256073
        },
        {
          "worker_id": 1,
          "query_id": "q41",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH eligible_manufacturers AS (SELECT DISTINCT i_manufact FROM (SELECT i_manufact FROM item WHERE i_category = 'Women' AND i_color IN ('powder', 'khaki') AND i_units IN ('Ounce', 'Oz') AND i_size IN ('medium', 'extra large') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Women' AND i_color IN ('brown', 'honeydew') AND i_units IN ('Bunch', 'Ton') AND i_size IN ('N/A', 'small') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Men' AND i_color IN ('floral', 'deep') AND i_units IN ('N/A', 'Dozen') AND i_size = 'petite' UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Men' AND i_color IN ('light', 'cornflower') AND i_units IN ('Box', 'Pound') AND i_size IN ('medium', 'extra large') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Women' AND i_color IN ('midnight', 'snow') AND i_units IN ('Pallet', 'Gross') AND i_size IN ('medium', 'extra large') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Women' AND i_color IN ('cyan', 'papaya') AND i_units IN ('Cup', 'Dram') AND i_size IN ('N/A', 'small') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Men' AND i_color IN ('orange', 'frosted') AND i_units IN ('Each', 'Tbl') AND i_size = 'petite' UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Men' AND i_color IN ('forest', 'ghost') AND i_units IN ('Lb', 'Bundle') AND i_size IN ('medium', 'extra large')) AS t)\nSELECT DISTINCT i_product_name FROM item AS i1 WHERE i_manufact_id BETWEEN 738 AND 738 + 40 AND EXISTS(SELECT 1 FROM eligible_manufacturers AS em WHERE em.i_manufact = i1.i_manufact) ORDER BY i_product_name LIMIT 100",
          "prompt_tokens": 3010,
          "response_tokens": 593,
          "llm_time_ms": 204712.1922969818
        },
        {
          "worker_id": 2,
          "query_id": "q41",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH manufacturer_items AS (SELECT DISTINCT i1.i_product_name FROM item AS i1 WHERE i1.i_manufact_id BETWEEN 738 AND 738 + 40), matching_items_branch1 AS (SELECT i_manufact FROM item WHERE ((i_category = 'Women' AND i_color IN ('powder', 'khaki') AND i_units IN ('Ounce', 'Oz') AND i_size IN ('medium', 'extra large')) OR (i_category = 'Women' AND i_color IN ('brown', 'honeydew') AND i_units IN ('Bunch', 'Ton') AND i_size IN ('N/A', 'small')) OR (i_category = 'Men' AND i_color IN ('floral', 'deep') AND i_units IN ('N/A', 'Dozen') AND i_size IN ('petite', 'petite')) OR (i_category = 'Men' AND i_color IN ('light', 'cornflower') AND i_units IN ('Box', 'Pound') AND i_size IN ('medium', 'extra large')))), matching_items_branch2 AS (SELECT i_manufact FROM item WHERE ((i_category = 'Women' AND i_color IN ('midnight', 'snow') AND i_units IN ('Pallet', 'Gross') AND i_size IN ('medium', 'extra large')) OR (i_category = 'Women' AND i_color IN ('cyan', 'papaya') AND i_units IN ('Cup', 'Dram') AND i_size IN ('N/A', 'small')) OR (i_category = 'Men' AND i_color IN ('orange', 'frosted') AND i_units IN ('Each', 'Tbl') AND i_size IN ('petite', 'petite')) OR (i_category = 'Men' AND i_color IN ('forest', 'ghost') AND i_units IN ('Lb', 'Bundle') AND i_size IN ('medium', 'extra large')))), matching_manufacturers AS (SELECT DISTINCT i_manufact FROM (SELECT i_manufact FROM matching_items_branch1 UNION ALL SELECT i_manufact FROM matching_items_branch2) AS combined)\nSELECT DISTINCT mi.i_product_name FROM manufacturer_items AS mi JOIN matching_manufacturers AS mm ON mi.i_manufact_id = mm.i_manufact ORDER BY mi.i_product_name LIMIT 100",
          "prompt_tokens": 3156,
          "response_tokens": 710,
          "llm_time_ms": 238734.61151123047
        },
        {
          "worker_id": 3,
          "query_id": "q41",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH eligible_manufacturers AS (SELECT DISTINCT i_manufact FROM (SELECT i_manufact FROM item WHERE i_category = 'Women' AND i_color IN ('powder', 'khaki') AND i_units IN ('Ounce', 'Oz') AND i_size IN ('medium', 'extra large') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Women' AND i_color IN ('brown', 'honeydew') AND i_units IN ('Bunch', 'Ton') AND i_size IN ('N/A', 'small') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Men' AND i_color IN ('floral', 'deep') AND i_units IN ('N/A', 'Dozen') AND i_size IN ('petite') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Men' AND i_color IN ('light', 'cornflower') AND i_units IN ('Box', 'Pound') AND i_size IN ('medium', 'extra large') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Women' AND i_color IN ('midnight', 'snow') AND i_units IN ('Pallet', 'Gross') AND i_size IN ('medium', 'extra large') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Women' AND i_color IN ('cyan', 'papaya') AND i_units IN ('Cup', 'Dram') AND i_size IN ('N/A', 'small') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Men' AND i_color IN ('orange', 'frosted') AND i_units IN ('Each', 'Tbl') AND i_size IN ('petite') UNION ALL SELECT i_manufact FROM item WHERE i_category = 'Men' AND i_color IN ('forest', 'ghost') AND i_units IN ('Lb', 'Bundle') AND i_size IN ('medium', 'extra large')) AS pattern_matches)\nSELECT DISTINCT i_product_name FROM item AS i1 JOIN eligible_manufacturers AS em ON i1.i_manufact = em.i_manufact WHERE i_manufact_id BETWEEN 738 AND 738 + 40 ORDER BY i_product_name LIMIT 100",
          "prompt_tokens": 3172,
          "response_tokens": 754,
          "llm_time_ms": 281952.0206451416
        }
      ],
      "original_speedup": 1.14,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676146"
    },
    {
      "query_id": "q92",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q92",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), item_manufacturer_filtered AS (SELECT i_item_sk FROM item WHERE i_manufact_id = 350), web_sales_with_dates AS (SELECT ws_item_sk, ws_ext_discount_amt FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk), item_avg_discount AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS avg_threshold FROM web_sales_with_dates GROUP BY ws_item_sk)\nSELECT SUM(ws.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales_with_dates AS ws JOIN item_manufacturer_filtered AS i ON ws.ws_item_sk = i.i_item_sk JOIN item_avg_discount AS avg ON ws.ws_item_sk = avg.ws_item_sk WHERE ws.ws_ext_discount_amt > avg.avg_threshold ORDER BY SUM(ws.ws_ext_discount_amt) LIMIT 100",
          "prompt_tokens": 2943,
          "response_tokens": 400,
          "llm_time_ms": 102657.9110622406
        },
        {
          "worker_id": 1,
          "query_id": "q92",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), item_filter AS (SELECT i_item_sk FROM item WHERE i_manufact_id = 350), item_avg_discount AS (SELECT ws_item_sk, AVG(ws_ext_discount_amt) AS avg_discount FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk WHERE ws_item_sk IN (SELECT i_item_sk FROM item_filter) GROUP BY ws_item_sk)\nSELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk JOIN item_filter ON ws_item_sk = i_item_sk JOIN item_avg_discount AS iad ON web_sales.ws_item_sk = iad.ws_item_sk WHERE ws_ext_discount_amt > 1.3 * iad.avg_discount ORDER BY SUM(ws_ext_discount_amt) LIMIT 100",
          "prompt_tokens": 2797,
          "response_tokens": 364,
          "llm_time_ms": 115769.44208145142
        },
        {
          "worker_id": 4,
          "query_id": "q92",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), item_avg_discount AS (SELECT ws_item_sk, AVG(ws_ext_discount_amt) AS avg_discount FROM web_sales JOIN filtered_dates ON d_date_sk = ws_sold_date_sk GROUP BY ws_item_sk)\nSELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN filtered_dates ON d_date_sk = ws_sold_date_sk JOIN item_avg_discount ON web_sales.ws_item_sk = item_avg_discount.ws_item_sk WHERE i_manufact_id = 350 AND ws_ext_discount_amt > 1.3 * item_avg_discount.avg_discount ORDER BY SUM(ws_ext_discount_amt) LIMIT 100",
          "prompt_tokens": 4013,
          "response_tokens": 506,
          "llm_time_ms": 128730.29327392578
        },
        {
          "worker_id": 3,
          "query_id": "q92",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), item_avg_discount AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk GROUP BY ws_item_sk)\nSELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN item_avg_discount ON web_sales.ws_item_sk = item_avg_discount.ws_item_sk WHERE i_manufact_id = 350 AND ws_ext_discount_amt > item_avg_discount.threshold ORDER BY SUM(ws_ext_discount_amt) LIMIT 100",
          "prompt_tokens": 2960,
          "response_tokens": 334,
          "llm_time_ms": 175421.54026031494
        }
      ],
      "original_speedup": 1.14,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676152"
    },
    {
      "query_id": "q20",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q20",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), sales_with_filtered_dates AS (SELECT cs_item_sk, cs_ext_sales_price FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk)\nSELECT i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price, SUM(sf.cs_ext_sales_price) AS itemrevenue, SUM(sf.cs_ext_sales_price) * 100.0000 / SUM(SUM(sf.cs_ext_sales_price)) OVER (PARTITION BY i.i_class) AS revenueratio FROM sales_with_filtered_dates AS sf JOIN filtered_items AS i ON sf.cs_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100",
          "prompt_tokens": 3914,
          "response_tokens": 815,
          "llm_time_ms": 87605.74078559875
        },
        {
          "worker_id": 2,
          "query_id": "q20",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), filtered_sales AS (SELECT cs_ext_sales_price, cs_item_sk FROM catalog_sales JOIN filtered_dates ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk)\nSELECT i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price, SUM(s.cs_ext_sales_price) AS itemrevenue, SUM(s.cs_ext_sales_price) * 100.0000 / SUM(SUM(s.cs_ext_sales_price)) OVER (PARTITION BY i.i_class) AS revenueratio FROM filtered_sales AS s JOIN filtered_items AS i ON s.cs_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price ORDER BY i.i_category NULLS FIRST, i.i_class NULLS FIRST, i.i_item_id NULLS FIRST, i.i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100",
          "prompt_tokens": 2845,
          "response_tokens": 487,
          "llm_time_ms": 91888.45300674438
        },
        {
          "worker_id": 1,
          "query_id": "q20",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_item AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), catalog_sales_joined AS (SELECT cs.cs_ext_sales_price, i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price FROM catalog_sales AS cs JOIN filtered_item AS i ON cs.cs_item_sk = i.i_item_sk JOIN filtered_date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(cs_ext_sales_price) AS itemrevenue, SUM(cs_ext_sales_price) * 100.0000 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM catalog_sales_joined GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100",
          "prompt_tokens": 2698,
          "response_tokens": 432,
          "llm_time_ms": 112811.767578125
        },
        {
          "worker_id": 3,
          "query_id": "q20",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home'))\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(cs_ext_sales_price) AS itemrevenue, SUM(cs_ext_sales_price) * 100.0000 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_items ON cs_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100",
          "prompt_tokens": 2862,
          "response_tokens": 441,
          "llm_time_ms": 153452.00276374817
        }
      ],
      "original_speedup": 1.13,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676155"
    },
    {
      "query_id": "q76",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q76",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year, d_qoy FROM date_dim), store_sales_filtered AS (SELECT 'store' AS channel, 'ss_store_sk' AS col_name, d_year, d_qoy, i_category, ss_ext_sales_price AS ext_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk WHERE ss_store_sk IS NULL), web_sales_filtered AS (SELECT 'web' AS channel, 'ws_ship_customer_sk' AS col_name, d_year, d_qoy, i_category, ws_ext_sales_price AS ext_sales_price FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN item ON ws_item_sk = i_item_sk WHERE ws_ship_customer_sk IS NULL), catalog_sales_filtered AS (SELECT 'catalog' AS channel, 'cs_ship_addr_sk' AS col_name, d_year, d_qoy, i_category, cs_ext_sales_price AS ext_sales_price FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN item ON cs_item_sk = i_item_sk WHERE cs_ship_addr_sk IS NULL)\nSELECT channel, col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ext_sales_price) AS sales_amt FROM (SELECT * FROM store_sales_filtered UNION ALL SELECT * FROM web_sales_filtered UNION ALL SELECT * FROM catalog_sales_filtered) AS foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel NULLS FIRST, col_name NULLS FIRST, d_year NULLS FIRST, d_qoy NULLS FIRST, i_category NULLS FIRST LIMIT 100",
          "prompt_tokens": 3118,
          "response_tokens": 654,
          "llm_time_ms": 152017.83227920532
        },
        {
          "worker_id": 4,
          "query_id": "q76",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_dim_filtered AS (SELECT d_date_sk, d_year, d_qoy FROM date_dim), item_filtered AS (SELECT i_item_sk, i_category FROM item), filtered_store_sales AS (SELECT ss_sold_date_sk, ss_item_sk, ss_ext_sales_price FROM store_sales WHERE ss_store_sk IS NULL), filtered_web_sales AS (SELECT ws_sold_date_sk, ws_item_sk, ws_ext_sales_price FROM web_sales WHERE ws_ship_customer_sk IS NULL), filtered_catalog_sales AS (SELECT cs_sold_date_sk, cs_item_sk, cs_ext_sales_price FROM catalog_sales WHERE cs_ship_addr_sk IS NULL)\nSELECT channel, col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ext_sales_price) AS sales_amt FROM (SELECT 'store' AS channel, 'ss_store_sk' AS col_name, d.d_year, d.d_qoy, i.i_category, ss.ss_ext_sales_price AS ext_sales_price FROM filtered_store_sales AS ss JOIN date_dim_filtered AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN item_filtered AS i ON ss.ss_item_sk = i.i_item_sk UNION ALL SELECT 'web' AS channel, 'ws_ship_customer_sk' AS col_name, d.d_year, d.d_qoy, i.i_category, ws.ws_ext_sales_price AS ext_sales_price FROM filtered_web_sales AS ws JOIN date_dim_filtered AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN item_filtered AS i ON ws.ws_item_sk = i.i_item_sk UNION ALL SELECT 'catalog' AS channel, 'cs_ship_addr_sk' AS col_name, d.d_year, d.d_qoy, i.i_category, cs.cs_ext_sales_price AS ext_sales_price FROM filtered_catalog_sales AS cs JOIN date_dim_filtered AS d ON cs.cs_sold_date_sk = d.d_date_sk JOIN item_filtered AS i ON cs.cs_item_sk = i.i_item_sk) AS foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel NULLS FIRST, col_name NULLS FIRST, d_year NULLS FIRST, d_qoy NULLS FIRST, i_category NULLS FIRST LIMIT 100",
          "prompt_tokens": 4173,
          "response_tokens": 825,
          "llm_time_ms": 163574.01418685913
        },
        {
          "worker_id": 1,
          "query_id": "q76",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year, d_qoy FROM date_dim), store_filtered AS (SELECT ss_ext_sales_price, d_year, d_qoy, i_category, 'store' AS channel, 'ss_store_sk' AS col_name FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk WHERE ss_store_sk IS NULL), web_filtered AS (SELECT ws_ext_sales_price, d_year, d_qoy, i_category, 'web' AS channel, 'ws_ship_customer_sk' AS col_name FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN item ON ws_item_sk = i_item_sk WHERE ws_ship_customer_sk IS NULL), catalog_filtered AS (SELECT cs_ext_sales_price, d_year, d_qoy, i_category, 'catalog' AS channel, 'cs_ship_addr_sk' AS col_name FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN item ON cs_item_sk = i_item_sk WHERE cs_ship_addr_sk IS NULL)\nSELECT channel, col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ext_sales_price) AS sales_amt FROM (SELECT * FROM store_filtered UNION ALL SELECT * FROM web_filtered UNION ALL SELECT * FROM catalog_filtered) AS foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel NULLS FIRST, col_name NULLS FIRST, d_year NULLS FIRST, d_qoy NULLS FIRST, i_category NULLS FIRST LIMIT 100",
          "prompt_tokens": 2955,
          "response_tokens": 1280,
          "llm_time_ms": 177606.58383369446
        },
        {
          "worker_id": 2,
          "query_id": "q76",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH store_filtered AS (SELECT ss_sold_date_sk, ss_item_sk, ss_ext_sales_price, ss_store_sk FROM store_sales WHERE ss_store_sk IS NULL), web_filtered AS (SELECT ws_sold_date_sk, ws_item_sk, ws_ext_sales_price, ws_ship_customer_sk FROM web_sales WHERE ws_ship_customer_sk IS NULL), catalog_filtered AS (SELECT cs_sold_date_sk, cs_item_sk, cs_ext_sales_price, cs_ship_addr_sk FROM catalog_sales WHERE cs_ship_addr_sk IS NULL)\nSELECT channel, col_name, d_year, d_qoy, i_category, COUNT(*) AS sales_cnt, SUM(ext_sales_price) AS sales_amt FROM (SELECT 'store' AS channel, 'ss_store_sk' AS col_name, d.d_year, d.d_qoy, i.i_category, ss.ss_ext_sales_price AS ext_sales_price FROM store_filtered AS ss JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk UNION ALL SELECT 'web' AS channel, 'ws_ship_customer_sk' AS col_name, d.d_year, d.d_qoy, i.i_category, ws.ws_ext_sales_price AS ext_sales_price FROM web_filtered AS ws JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN item AS i ON ws.ws_item_sk = i.i_item_sk UNION ALL SELECT 'catalog' AS channel, 'cs_ship_addr_sk' AS col_name, d.d_year, d.d_qoy, i.i_category, cs.cs_ext_sales_price AS ext_sales_price FROM catalog_filtered AS cs JOIN date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk JOIN item AS i ON cs.cs_item_sk = i.i_item_sk) AS foo GROUP BY channel, col_name, d_year, d_qoy, i_category ORDER BY channel NULLS FIRST, col_name NULLS FIRST, d_year NULLS FIRST, d_qoy NULLS FIRST, i_category NULLS FIRST LIMIT 100",
          "prompt_tokens": 3101,
          "response_tokens": 1620,
          "llm_time_ms": 254387.45164871216
        }
      ],
      "original_speedup": 1.1,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676159"
    },
    {
      "query_id": "q45",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q45",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001), item_list AS (SELECT i_item_id, i_item_sk FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)), zip_branch AS (SELECT ca_zip, ca_city, ws_sales_price FROM web_sales JOIN date_filter ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN item ON ws_item_sk = i_item_sk WHERE SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')), item_branch AS (SELECT ca_zip, ca_city, ws_sales_price FROM web_sales JOIN date_filter ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN item_list ON ws_item_sk = item_list.i_item_sk WHERE NOT SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'))\nSELECT ca_zip, ca_city, SUM(ws_sales_price) FROM (SELECT * FROM zip_branch UNION ALL SELECT * FROM item_branch) AS combined GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100",
          "prompt_tokens": 2963,
          "response_tokens": 765,
          "llm_time_ms": 133910.870552063
        },
        {
          "worker_id": 3,
          "query_id": "q45",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001), filtered_items AS (SELECT i_item_sk FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29))\n(SELECT ca_zip, ca_city, SUM(ws_sales_price) FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN item ON ws_item_sk = i_item_sk WHERE SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') GROUP BY ca_zip, ca_city) UNION ALL (SELECT ca_zip, ca_city, SUM(ws_sales_price) FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN item ON ws_item_sk = i_item_sk JOIN filtered_items ON item.i_item_sk = filtered_items.i_item_sk WHERE NOT SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') GROUP BY ca_zip, ca_city) ORDER BY ca_zip, ca_city LIMIT 100",
          "prompt_tokens": 2980,
          "response_tokens": 468,
          "llm_time_ms": 167949.786901474
        },
        {
          "worker_id": 1,
          "query_id": "q45",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001), zip_filtered_customers AS (SELECT ca_address_sk, ca_zip, ca_city FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')), item_filtered AS (SELECT i_item_sk FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)), branch_zip AS (SELECT ws.ws_sales_price, ca.ca_zip, ca.ca_city FROM web_sales AS ws JOIN date_filtered AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN zip_filtered_customers AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item AS i ON ws.ws_item_sk = i.i_item_sk), branch_item AS (SELECT ws.ws_sales_price, ca.ca_zip, ca.ca_city FROM web_sales AS ws JOIN date_filtered AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item_filtered AS it ON ws.ws_item_sk = it.i_item_sk WHERE NOT SUBSTRING(ca.ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792'))\nSELECT ca_zip, ca_city, SUM(ws_sales_price) FROM (SELECT * FROM branch_zip UNION ALL SELECT * FROM branch_item) AS unioned GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100",
          "prompt_tokens": 2816,
          "response_tokens": 539,
          "llm_time_ms": 193647.02248573303
        },
        {
          "worker_id": 4,
          "query_id": "q45",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001)\nSELECT ca_zip, ca_city, SUM(ws_sales_price) FROM web_sales, customer, customer_address, date_dim, item WHERE ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND (SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') OR i_item_id IN (SELECT i_item_id FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29))) AND ws_sold_date_sk = d_date_sk AND d_qoy = 2 AND d_year = 2001 GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100",
          "prompt_tokens": 4034,
          "response_tokens": 610,
          "llm_time_ms": 217182.81722068787
        }
      ],
      "original_speedup": 1.08,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676162"
    },
    {
      "query_id": "q33",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q33",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), electronics_manufacturers AS (SELECT DISTINCT i_manufact_id, i_item_sk FROM item WHERE i_category IN ('Electronics')), ss AS (SELECT em.i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_date_dim AS fd ON ss_sold_date_sk = fd.d_date_sk JOIN filtered_customer_address AS fca ON ss_addr_sk = fca.ca_address_sk JOIN electronics_manufacturers AS em ON ss_item_sk = em.i_item_sk GROUP BY em.i_manufact_id), ws AS (SELECT em.i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_date_dim AS fd ON ws_sold_date_sk = fd.d_date_sk JOIN filtered_customer_address AS fca ON ws_bill_addr_sk = fca.ca_address_sk JOIN electronics_manufacturers AS em ON ws_item_sk = em.i_item_sk GROUP BY em.i_manufact_id), cs AS (SELECT em.i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales JOIN filtered_date_dim AS fd ON cs_sold_date_sk = fd.d_date_sk JOIN filtered_customer_address AS fca ON cs_bill_addr_sk = fca.ca_address_sk JOIN electronics_manufacturers AS em ON cs_item_sk = em.i_item_sk GROUP BY em.i_manufact_id)\nSELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100",
          "prompt_tokens": 3377,
          "response_tokens": 698,
          "llm_time_ms": 97474.40528869629
        },
        {
          "worker_id": 2,
          "query_id": "q33",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_ca AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT DISTINCT i_manufact_id FROM item WHERE i_category IN ('Electronics')), ss AS (SELECT i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), ss_rewritten AS (SELECT i.i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_ca AS ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_manufact_id IN (SELECT i_manufact_id FROM filtered_items) GROUP BY i.i_manufact_id), ws AS (SELECT i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), ws_rewritten AS (SELECT i.i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_ca AS ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN item AS i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_manufact_id IN (SELECT i_manufact_id FROM filtered_items) GROUP BY i.i_manufact_id), cs AS (SELECT i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id)\nSELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100",
          "prompt_tokens": 3344,
          "response_tokens": 760,
          "llm_time_ms": 165505.04899024963
        },
        {
          "worker_id": 3,
          "query_id": "q33",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_ca AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_item AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Electronics')), ss AS (SELECT i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales INNER JOIN filtered_date ON store_sales.ss_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_ca ON store_sales.ss_addr_sk = filtered_ca.ca_address_sk INNER JOIN filtered_item ON store_sales.ss_item_sk = filtered_item.i_item_sk GROUP BY i_manufact_id), ws AS (SELECT i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales INNER JOIN filtered_date ON web_sales.ws_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_ca ON web_sales.ws_bill_addr_sk = filtered_ca.ca_address_sk INNER JOIN filtered_item ON web_sales.ws_item_sk = filtered_item.i_item_sk GROUP BY i_manufact_id), cs AS (SELECT i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales INNER JOIN filtered_date ON catalog_sales.cs_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_ca ON catalog_sales.cs_bill_addr_sk = filtered_ca.ca_address_sk INNER JOIN filtered_item ON catalog_sales.cs_item_sk = filtered_item.i_item_sk GROUP BY i_manufact_id)\nSELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM ws UNION ALL SELECT * FROM cs) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100",
          "prompt_tokens": 3540,
          "response_tokens": 1009,
          "llm_time_ms": 166769.7970867157
        },
        {
          "worker_id": 4,
          "query_id": "q33",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), electronics_items AS (SELECT i_manufact_id, i_item_sk FROM item WHERE i_category IN ('Electronics')), ss AS (SELECT i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN electronics_items ON ss_item_sk = i_item_sk JOIN filtered_address ON ss_addr_sk = ca_address_sk GROUP BY i_manufact_id), ws AS (SELECT i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN electronics_items ON ws_item_sk = i_item_sk JOIN filtered_address ON ws_bill_addr_sk = ca_address_sk GROUP BY i_manufact_id), cs AS (SELECT i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN electronics_items ON cs_item_sk = i_item_sk JOIN filtered_address ON cs_bill_addr_sk = ca_address_sk GROUP BY i_manufact_id)\nSELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM ws UNION ALL SELECT * FROM cs) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100",
          "prompt_tokens": 4593,
          "response_tokens": 1227,
          "llm_time_ms": 169635.0634098053
        }
      ],
      "original_speedup": 1.05,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676166"
    },
    {
      "query_id": "q79",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q79",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow = 1 AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk, s_city FROM store WHERE s_number_employees BETWEEN 200 AND 295), filtered_sales_branch1 AS (SELECT ss_ticket_number, ss_customer_sk, s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_dep_count = 6 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city), filtered_sales_branch2 AS (SELECT ss_ticket_number, ss_customer_sk, s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_vehicle_count > 2 AND (hd_dep_count <> 6 OR hd_dep_count IS NULL) GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city)\nSELECT c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number, amt, profit FROM (SELECT * FROM filtered_sales_branch1 UNION ALL SELECT * FROM filtered_sales_branch2) AS ms, customer WHERE ss_customer_sk = c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, SUBSTRING(s_city, 1, 30) NULLS FIRST, profit NULLS FIRST, ss_ticket_number LIMIT 100",
          "prompt_tokens": 4041,
          "response_tokens": 667,
          "llm_time_ms": 116366.05882644653
        },
        {
          "worker_id": 2,
          "query_id": "q79",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow = 1 AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk, s_city FROM store WHERE s_number_employees BETWEEN 200 AND 295), filtered_hd_dep AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 6), filtered_hd_vehicle AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_vehicle_count > 2), sales_branch1 AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, fs.s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store AS fs ON ss_store_sk = fs.s_store_sk JOIN filtered_hd_dep AS hd ON ss_hdemo_sk = hd.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, fs.s_city), sales_branch2 AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, fs.s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store AS fs ON ss_store_sk = fs.s_store_sk JOIN filtered_hd_vehicle AS hd ON ss_hdemo_sk = hd.hd_demo_sk LEFT JOIN filtered_hd_dep AS hd2 ON ss_hdemo_sk = hd2.hd_demo_sk WHERE hd2.hd_demo_sk IS NULL GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, fs.s_city), combined_sales AS (SELECT * FROM sales_branch1 UNION ALL SELECT * FROM sales_branch2)\nSELECT c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number, amt, profit FROM combined_sales JOIN customer ON ss_customer_sk = c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, SUBSTRING(s_city, 1, 30) NULLS FIRST, profit NULLS FIRST, ss_ticket_number LIMIT 100",
          "prompt_tokens": 2972,
          "response_tokens": 952,
          "llm_time_ms": 141327.4586200714
        },
        {
          "worker_id": 1,
          "query_id": "q79",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_dow = 1 AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk, s_city FROM store WHERE s_number_employees BETWEEN 200 AND 295), hd_dep_6 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 6), hd_vehicle_gt2 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_vehicle_count > 2), ms_branch1 AS (SELECT ss_ticket_number, ss_customer_sk, fs.s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales AS ss JOIN filtered_date AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS fs ON ss.ss_store_sk = fs.s_store_sk JOIN hd_dep_6 AS h1 ON ss.ss_hdemo_sk = h1.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, fs.s_city), ms_branch2 AS (SELECT ss_ticket_number, ss_customer_sk, fs.s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales AS ss JOIN filtered_date AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS fs ON ss.ss_store_sk = fs.s_store_sk JOIN hd_vehicle_gt2 AS h2 ON ss.ss_hdemo_sk = h2.hd_demo_sk LEFT JOIN hd_dep_6 AS h1 ON ss.ss_hdemo_sk = h1.hd_demo_sk WHERE h1.hd_demo_sk IS NULL GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, fs.s_city), ms_union AS (SELECT * FROM ms_branch1 UNION ALL SELECT * FROM ms_branch2)\nSELECT c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number, amt, profit FROM ms_union AS ms, customer AS c WHERE ms.ss_customer_sk = c.c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, SUBSTRING(s_city, 1, 30) NULLS FIRST, profit NULLS FIRST, ss_ticket_number LIMIT 100",
          "prompt_tokens": 2825,
          "response_tokens": 595,
          "llm_time_ms": 164696.45047187805
        },
        {
          "worker_id": 3,
          "query_id": "q79",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow = 1 AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk, s_city, s_number_employees FROM store WHERE s_number_employees BETWEEN 200 AND 295), branch1_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_dep_count = 6 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city), branch2_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_vehicle_count > 2 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city)\nSELECT c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number, amt, profit FROM (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city, amt, profit FROM branch1_sales UNION ALL SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city, amt, profit FROM branch2_sales) AS ms JOIN customer ON ss_customer_sk = c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, SUBSTRING(s_city, 1, 30) NULLS FIRST, profit NULLS FIRST, ss_ticket_number LIMIT 100",
          "prompt_tokens": 2989,
          "response_tokens": 844,
          "llm_time_ms": 166034.28721427917
        }
      ],
      "original_speedup": 1.05,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676171"
    },
    {
      "query_id": "q4",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q4",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, date_dim WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year), store_year_totals AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, d_year AS dyear, 's' AS sale_type, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total FROM customer JOIN store_sales ON c_customer_sk = ss_customer_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk WHERE d_year IN (2001, 2002) GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, d_year), catalog_year_totals AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, d_year AS dyear, 'c' AS sale_type, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total FROM customer JOIN catalog_sales ON c_customer_sk = cs_bill_customer_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk WHERE d_year IN (2001, 2002) GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, d_year), web_year_totals AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, d_year AS dyear, 'w' AS sale_type, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total FROM customer JOIN web_sales ON c_customer_sk = ws_bill_customer_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk WHERE d_year IN (2001, 2002) GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, d_year), all_year_totals AS (SELECT customer_id, customer_first_name, customer_last_name, customer_preferred_cust_flag, dyear, sale_type, year_total FROM store_year_totals UNION ALL SELECT customer_id, customer_first_name, customer_last_name, customer_preferred_cust_flag, dyear, sale_type, year_total FROM catalog_year_totals UNION ALL SELECT customer_id, customer_first_name, customer_last_name, customer_preferred_cust_flag, dyear, sale_type, year_total FROM web_year_totals)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001 + 1 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2001 + 1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001 + 1 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 4395,
          "response_tokens": 1473,
          "llm_time_ms": 137895.08318901062
        },
        {
          "worker_id": 4,
          "query_id": "q4",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, filtered_dates WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year IN (2001, 2002) GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, filtered_dates WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year IN (2001, 2002) GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, filtered_dates WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year IN (2001, 2002) GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001 + 1 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2001 + 1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001 + 1 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 5617,
          "response_tokens": 1351,
          "llm_time_ms": 210823.6858844757
        },
        {
          "worker_id": 3,
          "query_id": "q4",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, date_dim WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year), year_total_store AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer JOIN store_sales ON c_customer_sk = ss_customer_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year), year_total_catalog AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer JOIN catalog_sales ON c_customer_sk = cs_bill_customer_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year), year_total_web AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer JOIN web_sales ON c_customer_sk = ws_bill_customer_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total_store AS t_s_firstyear, year_total_store AS t_s_secyear, year_total_catalog AS t_c_firstyear, year_total_catalog AS t_c_secyear, year_total_web AS t_w_firstyear, year_total_web AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001 + 1 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2001 + 1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001 + 1 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 4558,
          "response_tokens": 1189,
          "llm_time_ms": 236245.0625896454
        },
        {
          "worker_id": 2,
          "query_id": "q4",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (2001, 2002)), year_total_c AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, fd.d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, filtered_dates AS fd WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = fd.d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, fd.d_year), year_total_w AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, fd.d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, filtered_dates AS fd WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = fd.d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, fd.d_year), year_total AS (SELECT * FROM year_total_s UNION ALL SELECT * FROM year_total_c UNION ALL SELECT * FROM year_total_w), year_total_s AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, fd.d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, filtered_dates AS fd WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = fd.d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, fd.d_year)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2002 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2002 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2002 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 4547,
          "response_tokens": 1332,
          "llm_time_ms": 242127.33459472656
        }
      ],
      "original_speedup": 1.03,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676175"
    },
    {
      "query_id": "q8",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q8",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 1998), zip_list_zips AS (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576')), customer_preferred_zips AS (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip, COUNT(*) AS cnt FROM customer_address JOIN customer ON ca_address_sk = c_current_addr_sk WHERE c_preferred_cust_flag = 'Y' GROUP BY ca_zip HAVING COUNT(*) > 10), filtered_zips AS (SELECT ca_zip FROM zip_list_zips INTERSECT SELECT ca_zip FROM customer_preferred_zips), filtered_stores AS (SELECT s_store_sk, s_store_name, SUBSTRING(s_zip, 1, 2) AS s_zip_prefix FROM store)\nSELECT fs.s_store_name, SUM(ss.ss_net_profit) FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_stores AS fs ON ss.ss_store_sk = fs.s_store_sk JOIN filtered_zips AS fz ON SUBSTRING(fs.s_zip_prefix, 1, 2) = SUBSTRING(fz.ca_zip, 1, 2) GROUP BY fs.s_store_name ORDER BY fs.s_store_name LIMIT 100",
          "prompt_tokens": 3608,
          "response_tokens": 1417,
          "llm_time_ms": 190545.88079452515
        },
        {
          "worker_id": 2,
          "query_id": "q8",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_qoy = 2), zip_intersection AS (SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576') INTERSECT SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip, COUNT(*) AS cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk AND c_preferred_cust_flag = 'Y' GROUP BY ca_zip HAVING COUNT(*) > 10) AS A1) AS A2), filtered_store_sales AS (SELECT ss_store_sk, ss_net_profit FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk)\nSELECT s_store_name, SUM(ss_net_profit) FROM filtered_store_sales JOIN store ON filtered_store_sales.ss_store_sk = store.s_store_sk JOIN zip_intersection AS V1 ON SUBSTRING(store.s_zip, 1, 2) = SUBSTRING(V1.ca_zip, 1, 2) GROUP BY s_store_name ORDER BY s_store_name LIMIT 100",
          "prompt_tokens": 3755,
          "response_tokens": 2439,
          "llm_time_ms": 208585.2439403534
        },
        {
          "worker_id": 3,
          "query_id": "q8",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 1998), filtered_sales AS (SELECT ss_store_sk, ss_net_profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk), zip_subquery AS (SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576') INTERSECT SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip, COUNT(*) AS cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk AND c_preferred_cust_flag = 'Y' GROUP BY ca_zip HAVING COUNT(*) > 10) AS A1) AS A2)\nSELECT s_store_name, SUM(ss_net_profit) FROM filtered_sales JOIN store ON ss_store_sk = s_store_sk CROSS JOIN zip_subquery WHERE SUBSTRING(s_zip, 1, 2) = SUBSTRING(ca_zip, 1, 2) GROUP BY s_store_name ORDER BY s_store_name LIMIT 100",
          "prompt_tokens": 3771,
          "response_tokens": 1310,
          "llm_time_ms": 225204.02908325195
        },
        {
          "worker_id": 4,
          "query_id": "q8",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 1998)\nSELECT s_store_name, SUM(ss_net_profit) FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk WHERE SUBSTRING(s_zip, 1, 2) = SUBSTRING(V1.ca_zip, 1, 2) AND EXISTS(SELECT 1 FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576') AND EXISTS(SELECT 1 FROM customer WHERE ca_address_sk = c_current_addr_sk AND c_preferred_cust_flag = 'Y' HAVING COUNT(*) > 10)) GROUP BY s_store_name ORDER BY s_store_name LIMIT 100",
          "prompt_tokens": 4825,
          "response_tokens": 1216,
          "llm_time_ms": 226653.21373939514
        }
      ],
      "original_speedup": 1.03,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676179"
    },
    {
      "query_id": "q49",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q49",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), web_sales_with_returns AS (SELECT ws.ws_item_sk AS item, ws.ws_quantity, ws.ws_net_paid, wr.wr_return_quantity, wr.wr_return_amt FROM web_sales AS ws LEFT OUTER JOIN web_returns AS wr ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk) JOIN filtered_dates ON ws.ws_sold_date_sk = filtered_dates.d_date_sk WHERE wr.wr_return_amt > 10000 AND ws.ws_net_profit > 1 AND ws.ws_net_paid > 0 AND ws.ws_quantity > 0), catalog_sales_with_returns AS (SELECT cs.cs_item_sk AS item, cs.cs_quantity, cs.cs_net_paid, cr.cr_return_quantity, cr.cr_return_amount FROM catalog_sales AS cs LEFT OUTER JOIN catalog_returns AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) JOIN filtered_dates ON cs.cs_sold_date_sk = filtered_dates.d_date_sk WHERE cr.cr_return_amount > 10000 AND cs.cs_net_profit > 1 AND cs.cs_net_paid > 0 AND cs.cs_quantity > 0), store_sales_with_returns AS (SELECT sts.ss_item_sk AS item, sts.ss_quantity, sts.ss_net_paid, sr.sr_return_quantity, sr.sr_return_amt FROM store_sales AS sts LEFT OUTER JOIN store_returns AS sr ON (sts.ss_ticket_number = sr.sr_ticket_number AND sts.ss_item_sk = sr.sr_item_sk) JOIN filtered_dates ON sts.ss_sold_date_sk = filtered_dates.d_date_sk WHERE sr.sr_return_amt > 10000 AND sts.ss_net_profit > 1 AND sts.ss_net_paid > 0 AND sts.ss_quantity > 0)\nSELECT channel, item, return_ratio, return_rank, currency_rank FROM (SELECT 'web' AS channel, web.item, web.return_ratio, web.return_rank, web.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT item, (CAST(SUM(COALESCE(wr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(wr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM web_sales_with_returns GROUP BY item) AS in_web) AS web WHERE (web.return_rank <= 10 OR web.currency_rank <= 10) UNION SELECT 'catalog' AS channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT item, (CAST(SUM(COALESCE(cr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(cr_return_amount, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM catalog_sales_with_returns GROUP BY item) AS in_cat) AS catalog WHERE (catalog.return_rank <= 10 OR catalog.currency_rank <= 10) UNION SELECT 'store' AS channel, store.item, store.return_ratio, store.return_rank, store.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT item, (CAST(SUM(COALESCE(sr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ss_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(sr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ss_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM store_sales_with_returns GROUP BY item) AS in_store) AS store WHERE (store.return_rank <= 10 OR store.currency_rank <= 10)) AS sq1 ORDER BY 1 NULLS FIRST, 4 NULLS FIRST, 5 NULLS FIRST, 2 NULLS FIRST LIMIT 100",
          "prompt_tokens": 3988,
          "response_tokens": 2208,
          "llm_time_ms": 155679.58688735962
        },
        {
          "worker_id": 4,
          "query_id": "q49",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12)\nSELECT channel, item, return_ratio, return_rank, currency_rank FROM (SELECT 'web' AS channel, web.item, web.return_ratio, web.return_rank, web.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT ws.ws_item_sk AS item, (CAST(SUM(COALESCE(wr.wr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(wr.wr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM web_sales AS ws LEFT OUTER JOIN web_returns AS wr ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk) JOIN filtered_dates ON ws.ws_sold_date_sk = filtered_dates.d_date_sk WHERE wr.wr_return_amt > 10000 AND ws.ws_net_profit > 1 AND ws.ws_net_paid > 0 AND ws.ws_quantity > 0 GROUP BY ws.ws_item_sk) AS in_web) AS web WHERE (web.return_rank <= 10 OR web.currency_rank <= 10) UNION SELECT 'catalog' AS channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT cs.cs_item_sk AS item, (CAST(SUM(COALESCE(cr.cr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(cr.cr_return_amount, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM catalog_sales AS cs LEFT OUTER JOIN catalog_returns AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) JOIN filtered_dates ON cs.cs_sold_date_sk = filtered_dates.d_date_sk WHERE cr.cr_return_amount > 10000 AND cs.cs_net_profit > 1 AND cs.cs_net_paid > 0 AND cs.cs_quantity > 0 GROUP BY cs.cs_item_sk) AS in_cat) AS catalog WHERE (catalog.return_rank <= 10 OR catalog.currency_rank <= 10) UNION SELECT 'store' AS channel, store.item, store.return_ratio, store.return_rank, store.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT sts.ss_item_sk AS item, (CAST(SUM(COALESCE(sr.sr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(sr.sr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM store_sales AS sts LEFT OUTER JOIN store_returns AS sr ON (sts.ss_ticket_number = sr.sr_ticket_number AND sts.ss_item_sk = sr.sr_item_sk) JOIN filtered_dates ON sts.ss_sold_date_sk = filtered_dates.d_date_sk WHERE sr.sr_return_amt > 10000 AND sts.ss_net_profit > 1 AND sts.ss_net_paid > 0 AND sts.ss_quantity > 0 GROUP BY sts.ss_item_sk) AS in_store) AS store WHERE (store.return_rank <= 10 OR store.currency_rank <= 10)) AS sq1 ORDER BY 1 NULLS FIRST, 4 NULLS FIRST, 5 NULLS FIRST, 2 NULLS FIRST LIMIT 100",
          "prompt_tokens": 5056,
          "response_tokens": 1054,
          "llm_time_ms": 165376.71828269958
        },
        {
          "worker_id": 1,
          "query_id": "q49",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH dec_2001_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), web_sales_filtered AS (SELECT ws.ws_item_sk, ws.ws_order_number, ws.ws_quantity, ws.ws_net_paid, wr.wr_return_quantity, wr.wr_return_amt FROM web_sales AS ws LEFT OUTER JOIN web_returns AS wr ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk) WHERE wr.wr_return_amt > 10000 AND ws.ws_net_profit > 1 AND ws.ws_net_paid > 0 AND ws.ws_quantity > 0), catalog_sales_filtered AS (SELECT cs.cs_item_sk, cs.cs_order_number, cs.cs_quantity, cs.cs_net_paid, cr.cr_return_quantity, cr.cr_return_amount FROM catalog_sales AS cs LEFT OUTER JOIN catalog_returns AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) WHERE cr.cr_return_amount > 10000 AND cs.cs_net_profit > 1 AND cs.cs_net_paid > 0 AND cs.cs_quantity > 0), store_sales_filtered AS (SELECT sts.ss_item_sk, sts.ss_ticket_number, sts.ss_quantity, sts.ss_net_paid, sr.sr_return_quantity, sr.sr_return_amt FROM store_sales AS sts LEFT OUTER JOIN store_returns AS sr ON (sts.ss_ticket_number = sr.sr_ticket_number AND sts.ss_item_sk = sr.sr_item_sk) WHERE sr.sr_return_amt > 10000 AND sts.ss_net_profit > 1 AND sts.ss_net_paid > 0 AND sts.ss_quantity > 0)\nSELECT channel, item, return_ratio, return_rank, currency_rank FROM (SELECT 'web' AS channel, web.item, web.return_ratio, web.return_rank, web.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT ws.ws_item_sk AS item, (CAST(SUM(COALESCE(wr.wr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(wr.wr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM web_sales_filtered AS ws JOIN dec_2001_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk GROUP BY ws.ws_item_sk) AS in_web) AS web WHERE (web.return_rank <= 10 OR web.currency_rank <= 10) UNION SELECT 'catalog' AS channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT cs.cs_item_sk AS item, (CAST(SUM(COALESCE(cr.cr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(cr.cr_return_amount, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM catalog_sales_filtered AS cs JOIN dec_2001_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk GROUP BY cs.cs_item_sk) AS in_cat) AS catalog WHERE (catalog.return_rank <= 10 OR catalog.currency_rank <= 10) UNION SELECT 'store' AS channel, store.item, store.return_ratio, store.return_rank, store.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT sts.ss_item_sk AS item, (CAST(SUM(COALESCE(sr.sr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(sr.sr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM store_sales_filtered AS sts JOIN dec_2001_dates AS d ON sts.ss_sold_date_sk = d.d_date_sk GROUP BY sts.ss_item_sk) AS in_store) AS store WHERE (store.return_rank <= 10 OR store.currency_rank <= 10)) AS sq1 ORDER BY 1 NULLS FIRST, 4 NULLS FIRST, 5 NULLS FIRST, 2 NULLS FIRST LIMIT 100",
          "prompt_tokens": 3841,
          "response_tokens": 2374,
          "llm_time_ms": 206514.42646980286
        },
        {
          "worker_id": 3,
          "query_id": "q49",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12)\nSELECT channel, item, return_ratio, return_rank, currency_rank FROM (SELECT 'web' AS channel, web.item, web.return_ratio, web.return_rank, web.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT ws.ws_item_sk AS item, (CAST(SUM(COALESCE(wr.wr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(wr.wr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM web_sales AS ws LEFT OUTER JOIN web_returns AS wr ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk) JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk WHERE wr.wr_return_amt > 10000 AND ws.ws_net_profit > 1 AND ws.ws_net_paid > 0 AND ws.ws_quantity > 0 GROUP BY ws.ws_item_sk) AS in_web) AS web WHERE (web.return_rank <= 10 OR web.currency_rank <= 10) UNION SELECT 'catalog' AS channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT cs.cs_item_sk AS item, (CAST(SUM(COALESCE(cr.cr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(cr.cr_return_amount, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM catalog_sales AS cs LEFT OUTER JOIN catalog_returns AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) JOIN filtered_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk WHERE cr.cr_return_amount > 10000 AND cs.cs_net_profit > 1 AND cs.cs_net_paid > 0 AND cs.cs_quantity > 0 GROUP BY cs.cs_item_sk) AS in_cat) AS catalog WHERE (catalog.return_rank <= 10 OR catalog.currency_rank <= 10) UNION SELECT 'store' AS channel, store.item, store.return_ratio, store.return_rank, store.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT sts.ss_item_sk AS item, (CAST(SUM(COALESCE(sr.sr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(sr.sr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM store_sales AS sts LEFT OUTER JOIN store_returns AS sr ON (sts.ss_ticket_number = sr.sr_ticket_number AND sts.ss_item_sk = sr.sr_item_sk) JOIN filtered_dates AS d ON sts.ss_sold_date_sk = d.d_date_sk WHERE sr.sr_return_amt > 10000 AND sts.ss_net_profit > 1 AND sts.ss_net_paid > 0 AND sts.ss_quantity > 0 GROUP BY sts.ss_item_sk) AS in_store) AS store WHERE (store.return_rank <= 10 OR store.currency_rank <= 10)) AS sq1 ORDER BY 1 NULLS FIRST, 4 NULLS FIRST, 5 NULLS FIRST, 2 NULLS FIRST LIMIT 100",
          "prompt_tokens": 4011,
          "response_tokens": 2905,
          "llm_time_ms": 246076.36737823486
        }
      ],
      "original_speedup": 1.02,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676186"
    },
    {
      "query_id": "q57",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q57",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 OR (d_year = 1998 AND d_moy = 12) OR (d_year = 2000 AND d_moy = 1)), v1 AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, SUM(cs_sales_price) AS sum_sales, AVG(SUM(cs_sales_price)) OVER (PARTITION BY i_category, i_brand, cc_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, cc_name ORDER BY d_year, d_moy) AS rn FROM item, catalog_sales, call_center, filtered_dates WHERE cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND cc_call_center_sk = cs_call_center_sk GROUP BY i_category, i_brand, cc_name, d_year, d_moy), v2 AS (SELECT v1.i_category, v1.i_brand, v1.cc_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.cc_name = v1_lag.cc_name AND v1.cc_name = v1_lead.cc_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales NULLS FIRST, 1, 2, 3, 4, 5, 6, 7, 8, 9 LIMIT 100",
          "prompt_tokens": 3278,
          "response_tokens": 1163,
          "llm_time_ms": 169293.92623901367
        },
        {
          "worker_id": 2,
          "query_id": "q57",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_1999 AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1999), filtered_dates_1998_12 AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1998 AND d_moy = 12), filtered_dates_2000_01 AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 2000 AND d_moy = 1), v1_base AS (SELECT i.i_category, i.i_brand, cc.cc_name, fd.d_year, fd.d_moy, SUM(cs.cs_sales_price) AS sum_sales FROM catalog_sales AS cs JOIN filtered_dates_1999 AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN item AS i ON cs.cs_item_sk = i.i_item_sk JOIN call_center AS cc ON cs.cs_call_center_sk = cc.cc_call_center_sk GROUP BY i.i_category, i.i_brand, cc.cc_name, fd.d_year, fd.d_moy UNION ALL SELECT i.i_category, i.i_brand, cc.cc_name, fd.d_year, fd.d_moy, SUM(cs.cs_sales_price) AS sum_sales FROM catalog_sales AS cs JOIN filtered_dates_1998_12 AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN item AS i ON cs.cs_item_sk = i.i_item_sk JOIN call_center AS cc ON cs.cs_call_center_sk = cc.cc_call_center_sk GROUP BY i.i_category, i.i_brand, cc.cc_name, fd.d_year, fd.d_moy UNION ALL SELECT i.i_category, i.i_brand, cc.cc_name, fd.d_year, fd.d_moy, SUM(cs.cs_sales_price) AS sum_sales FROM catalog_sales AS cs JOIN filtered_dates_2000_01 AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN item AS i ON cs.cs_item_sk = i.i_item_sk JOIN call_center AS cc ON cs.cs_call_center_sk = cc.cc_call_center_sk GROUP BY i.i_category, i.i_brand, cc.cc_name, fd.d_year, fd.d_moy), v1 AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, sum_sales, AVG(sum_sales) OVER (PARTITION BY i_category, i_brand, cc_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, cc_name ORDER BY d_year, d_moy) AS rn FROM v1_base), v2 AS (SELECT v1.i_category, v1.i_brand, v1.cc_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.cc_name = v1_lag.cc_name AND v1.cc_name = v1_lead.cc_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales NULLS FIRST, 1, 2, 3, 4, 5, 6, 7, 8, 9 LIMIT 100",
          "prompt_tokens": 3429,
          "response_tokens": 824,
          "llm_time_ms": 182223.01650047302
        },
        {
          "worker_id": 3,
          "query_id": "q57",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE (d_year = 1999 OR (d_year = 1998 AND d_moy = 12) OR (d_year = 2000 AND d_moy = 1))), filtered_sales AS (SELECT cs_item_sk, cs_call_center_sk, cs_sales_price, d_year, d_moy FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk), v1 AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, SUM(cs_sales_price) AS sum_sales, AVG(SUM(cs_sales_price)) OVER (PARTITION BY i_category, i_brand, cc_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, cc_name ORDER BY d_year, d_moy) AS rn FROM item, filtered_sales, call_center WHERE cs_item_sk = i_item_sk AND cc_call_center_sk = cs_call_center_sk GROUP BY i_category, i_brand, cc_name, d_year, d_moy), v2 AS (SELECT v1.i_category, v1.i_brand, v1.cc_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.cc_name = v1_lag.cc_name AND v1.cc_name = v1_lead.cc_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales NULLS FIRST, 1, 2, 3, 4, 5, 6, 7, 8, 9 LIMIT 100",
          "prompt_tokens": 3442,
          "response_tokens": 970,
          "llm_time_ms": 223937.12449073792
        },
        {
          "worker_id": 4,
          "query_id": "q57",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1999 OR (d_year = 1998 AND d_moy = 12) OR (d_year = 2000 AND d_moy = 1)), v1_base AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, cs_sales_price FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN item ON cs_item_sk = i_item_sk JOIN call_center ON cc_call_center_sk = cs_call_center_sk), v1_aggregated AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, SUM(cs_sales_price) AS sum_sales FROM v1_base GROUP BY i_category, i_brand, cc_name, d_year, d_moy), v1_window AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, sum_sales, AVG(sum_sales) OVER (PARTITION BY i_category, i_brand, cc_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, cc_name ORDER BY d_year, d_moy) AS rn FROM v1_aggregated), v1 AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, SUM(cs_sales_price) AS sum_sales, AVG(SUM(cs_sales_price)) OVER (PARTITION BY i_category, i_brand, cc_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, cc_name ORDER BY d_year, d_moy) AS rn FROM item, catalog_sales, date_dim, call_center WHERE cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND cc_call_center_sk = cs_call_center_sk AND (d_year = 1999 OR (d_year = 1999 - 1 AND d_moy = 12) OR (d_year = 1999 + 1 AND d_moy = 1)) GROUP BY i_category, i_brand, cc_name, d_year, d_moy), v2 AS (SELECT v1.i_category, v1.i_brand, v1.cc_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1_window AS v1 JOIN v1_window AS v1_lag ON v1.i_category = v1_lag.i_category AND v1.i_brand = v1_lag.i_brand AND v1.cc_name = v1_lag.cc_name AND v1.rn = v1_lag.rn + 1 JOIN v1_window AS v1_lead ON v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lead.i_brand AND v1.cc_name = v1_lead.cc_name AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales NULLS FIRST, 1, 2, 3, 4, 5, 6, 7, 8, 9 LIMIT 100",
          "prompt_tokens": 4498,
          "response_tokens": 1230,
          "llm_time_ms": 236081.78567886353
        }
      ],
      "original_speedup": 1.02,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676192"
    },
    {
      "query_id": "q60",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q60",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), ss AS (SELECT i.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ss.ss_addr_sk = fa.ca_address_sk JOIN filtered_items AS i ON ss.ss_item_sk = i.i_item_sk GROUP BY i.i_item_id), cs AS (SELECT i.i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON cs.cs_bill_addr_sk = fa.ca_address_sk JOIN filtered_items AS i ON cs.cs_item_sk = i.i_item_sk GROUP BY i.i_item_id), ws AS (SELECT i.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ws.ws_bill_addr_sk = fa.ca_address_sk JOIN filtered_items AS i ON ws.ws_item_sk = i.i_item_sk GROUP BY i.i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100",
          "prompt_tokens": 3367,
          "response_tokens": 525,
          "llm_time_ms": 75708.66799354553
        },
        {
          "worker_id": 1,
          "query_id": "q60",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), music_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), ss AS (SELECT mi.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ss.ss_addr_sk = fa.ca_address_sk JOIN music_items AS mi ON ss.ss_item_sk = mi.i_item_sk GROUP BY mi.i_item_id), cs AS (SELECT mi.i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON cs.cs_bill_addr_sk = fa.ca_address_sk JOIN music_items AS mi ON cs.cs_item_sk = mi.i_item_sk GROUP BY mi.i_item_id), ws AS (SELECT mi.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ws.ws_bill_addr_sk = fa.ca_address_sk JOIN music_items AS mi ON ws.ws_item_sk = mi.i_item_sk GROUP BY mi.i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100",
          "prompt_tokens": 3220,
          "response_tokens": 820,
          "llm_time_ms": 154153.2883644104
        },
        {
          "worker_id": 3,
          "query_id": "q60",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), music_items AS (SELECT i_item_id, i_item_sk FROM item WHERE i_category = 'Music'), ss AS (SELECT mi.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ss.ss_addr_sk = fa.ca_address_sk JOIN music_items AS mi ON ss.ss_item_sk = mi.i_item_sk GROUP BY mi.i_item_id), ws AS (SELECT mi.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ws.ws_bill_addr_sk = fa.ca_address_sk JOIN music_items AS mi ON ws.ws_item_sk = mi.i_item_sk GROUP BY mi.i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100",
          "prompt_tokens": 3217,
          "response_tokens": 531,
          "llm_time_ms": 111949.10526275635
        },
        {
          "worker_id": 4,
          "query_id": "q60",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), filtered_items AS (SELECT i_item_id, i_item_sk FROM item WHERE i_category = 'Music'), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), ss AS (SELECT i.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items AS i ON ss.ss_item_sk = i.i_item_sk JOIN filtered_address AS fa ON ss.ss_addr_sk = fa.ca_address_sk GROUP BY i.i_item_id), ws AS (SELECT i.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_items AS i ON ws.ws_item_sk = i.i_item_sk JOIN filtered_address AS fa ON ws.ws_bill_addr_sk = fa.ca_address_sk GROUP BY i.i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100",
          "prompt_tokens": 4269,
          "response_tokens": 552,
          "llm_time_ms": 157496.88816070557
        }
      ],
      "original_speedup": 1.02,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676196"
    },
    {
      "query_id": "q27",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q27",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), filtered_store AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'TN'), filtered_cd AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), results AS (SELECT i_item_id, s_state, 0 AS g_state, ss_quantity AS agg1, ss_list_price AS agg2, ss_coupon_amt AS agg3, ss_sales_price AS agg4 FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_cd ON ss_cdemo_sk = cd_demo_sk JOIN item ON ss_item_sk = i_item_sk)\nSELECT i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 FROM (SELECT i_item_id, s_state, 0 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id, s_state UNION ALL SELECT i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id UNION ALL SELECT NULL AS i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results) AS foo ORDER BY i_item_id NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 3048,
          "response_tokens": 509,
          "llm_time_ms": 120891.70336723328
        },
        {
          "worker_id": 4,
          "query_id": "q27",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH single_pass AS (\n  SELECT \n    i_item_id,\n    s_state,\n    GROUPING(i_item_id, s_state) AS grouping_id,\n    AVG(agg1) AS agg1_avg,\n    AVG(agg2) AS agg2_avg,\n    AVG(agg3) AS agg3_avg,\n    AVG(agg4) AS agg4_avg\n  FROM results\n  GROUP BY GROUPING SETS ((i_item_id, s_state), (i_item_id), ())\n)\nSELECT \n  CASE WHEN BIT_AND(grouping_id, 3) = 0 THEN i_item_id ELSE NULL END AS i_item_id,\n  CASE WHEN BIT_AND(grouping_id, 3) = 0 THEN s_state \n       WHEN BIT_AND(grouping_id, 3) = 1 THEN NULL  -- grouping by i_item_id only\n       ELSE NULL END AS s_state,  -- overall aggregate\n  CASE WHEN BIT_AND(grouping_id, 3) = 0 THEN 0 ELSE 1 END AS g_state,\n  agg1_avg AS agg1,\n  agg2_avg AS agg2,\n  agg3_avg AS agg3,\n  agg4_avg AS agg4\nFROM single_pass\nORDER BY i_item_id NULLS FIRST, s_state NULLS FIRST\nLIMIT 100",
          "prompt_tokens": 4100,
          "response_tokens": 887,
          "llm_time_ms": 125792.58584976196
        },
        {
          "worker_id": 2,
          "query_id": "q27",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), filtered_store AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'TN'), results AS (SELECT i.i_item_id, fs.s_state, 0 AS g_state, ss.ss_quantity AS agg1, ss.ss_list_price AS agg2, ss.ss_coupon_amt AS agg3, ss.ss_sales_price AS agg4 FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_customer_demographics AS fcd ON ss.ss_cdemo_sk = fcd.cd_demo_sk JOIN filtered_store AS fs ON ss.ss_store_sk = fs.s_store_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk)\nSELECT i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 FROM (SELECT i_item_id, s_state, 0 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id, s_state UNION ALL SELECT i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id UNION ALL SELECT NULL AS i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results) AS foo ORDER BY i_item_id NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 3031,
          "response_tokens": 575,
          "llm_time_ms": 163470.77894210815
        },
        {
          "worker_id": 1,
          "query_id": "q27",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), filtered_store AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'TN'), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), results AS (SELECT i.i_item_id, s.s_state, 0 AS g_state, ss.ss_quantity AS agg1, ss.ss_list_price AS agg2, ss.ss_coupon_amt AS agg3, ss.ss_sales_price AS agg4 FROM store_sales AS ss JOIN filtered_date_dim AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN filtered_customer_demographics AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk)\nSELECT i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 FROM (SELECT i_item_id, s_state, 0 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id, s_state UNION ALL SELECT i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id UNION ALL SELECT NULL AS i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results) AS foo ORDER BY i_item_id NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 2887,
          "response_tokens": 600,
          "llm_time_ms": 173549.59988594055
        }
      ],
      "original_speedup": 1.02,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676202"
    },
    {
      "query_id": "q13",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q13",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), branch1 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 3 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 100 AND 200), branch2 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 300), branch3 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 250)\nSELECT AVG(ss_quantity) AS avg1, AVG(ss_ext_sales_price) AS avg2, AVG(ss_ext_wholesale_cost) AS avg3, SUM(ss_ext_wholesale_cost) FROM (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2 UNION ALL SELECT * FROM branch3) AS combined",
          "prompt_tokens": 4186,
          "response_tokens": 798,
          "llm_time_ms": 182410.1037979126
        },
        {
          "worker_id": 1,
          "query_id": "q13",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_cte AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), branch1 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON hd.hd_demo_sk = ss.ss_hdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = ss.ss_addr_sk JOIN date_cte AS dc ON ss.ss_sold_date_sk = dc.d_date_sk WHERE cd.cd_marital_status = 'M' AND cd.cd_education_status = 'Advanced Degree' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND hd.hd_dep_count = 3 AND ca.ca_country = 'United States' AND ca.ca_state IN ('TX', 'OH', 'TX') AND ss.ss_net_profit BETWEEN 100 AND 200), branch2 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON hd.hd_demo_sk = ss.ss_hdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = ss.ss_addr_sk JOIN date_cte AS dc ON ss.ss_sold_date_sk = dc.d_date_sk WHERE cd.cd_marital_status = 'S' AND cd.cd_education_status = 'College' AND ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND hd.hd_dep_count = 1 AND ca.ca_country = 'United States' AND ca.ca_state IN ('OR', 'NM', 'KY') AND ss.ss_net_profit BETWEEN 150 AND 300), branch3 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON hd.hd_demo_sk = ss.ss_hdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = ss.ss_addr_sk JOIN date_cte AS dc ON ss.ss_sold_date_sk = dc.d_date_sk WHERE cd.cd_marital_status = 'W' AND cd.cd_education_status = '2 yr Degree' AND ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND hd.hd_dep_count = 1 AND ca.ca_country = 'United States' AND ca.ca_state IN ('VA', 'TX', 'MS') AND ss.ss_net_profit BETWEEN 50 AND 250)\nSELECT AVG(ss_quantity) AS avg1, AVG(ss_ext_sales_price) AS avg2, AVG(ss_ext_wholesale_cost) AS avg3, SUM(ss_ext_wholesale_cost) FROM (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2 UNION ALL SELECT * FROM branch3) AS all_branches",
          "prompt_tokens": 2970,
          "response_tokens": 766,
          "llm_time_ms": 206617.84386634827
        },
        {
          "worker_id": 3,
          "query_id": "q13",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), filtered_stores AS (SELECT s_store_sk FROM store)\nSELECT AVG(ss_quantity) AS avg1, AVG(ss_ext_sales_price) AS avg2, AVG(ss_ext_wholesale_cost) AS avg3, SUM(ss_ext_wholesale_cost) FROM (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') AND ss_net_profit BETWEEN 100 AND 200 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') AND ss_net_profit BETWEEN 150 AND 300 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') AND ss_net_profit BETWEEN 50 AND 250 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') AND ss_net_profit BETWEEN 100 AND 200 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') AND ss_net_profit BETWEEN 150 AND 300 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') AND ss_net_profit BETWEEN 50 AND 250 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') AND ss_net_profit BETWEEN 100 AND 200 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') AND ss_net_profit BETWEEN 150 AND 300 UNION ALL SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') AND ss_net_profit BETWEEN 50 AND 250) AS union_data",
          "prompt_tokens": 3134,
          "response_tokens": 2164,
          "llm_time_ms": 201500.26631355286
        },
        {
          "worker_id": 2,
          "query_id": "q13",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), filtered_store AS (SELECT s_store_sk FROM store), branch1 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'M' AND cd.cd_education_status = 'Advanced Degree' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND hd.hd_dep_count = 3 AND ca.ca_country = 'United States' AND ca.ca_state IN ('TX', 'OH') AND ss.ss_net_profit BETWEEN 100 AND 200), branch2 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'M' AND cd.cd_education_status = 'Advanced Degree' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND hd.hd_dep_count = 3 AND ca.ca_country = 'United States' AND ca.ca_state IN ('OR', 'NM', 'KY') AND ss.ss_net_profit BETWEEN 150 AND 300), branch3 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'M' AND cd.cd_education_status = 'Advanced Degree' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND hd.hd_dep_count = 3 AND ca.ca_country = 'United States' AND ca.ca_state IN ('VA', 'TX', 'MS') AND ss.ss_net_profit BETWEEN 50 AND 250), branch4 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'S' AND cd.cd_education_status = 'College' AND ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND hd.hd_dep_count = 1 AND ca.ca_country = 'United States' AND ca.ca_state IN ('TX', 'OH') AND ss.ss_net_profit BETWEEN 100 AND 200), branch5 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'S' AND cd.cd_education_status = 'College' AND ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND hd.hd_dep_count = 1 AND ca.ca_country = 'United States' AND ca.ca_state IN ('OR', 'NM', 'KY') AND ss.ss_net_profit BETWEEN 150 AND 300), branch6 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'S' AND cd.cd_education_status = 'College' AND ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND hd.hd_dep_count = 1 AND ca.ca_country = 'United States' AND ca.ca_state IN ('VA', 'TX', 'MS') AND ss.ss_net_profit BETWEEN 50 AND 250), branch7 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'W' AND cd.cd_education_status = '2 yr Degree' AND ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND hd.hd_dep_count = 1 AND ca.ca_country = 'United States' AND ca.ca_state IN ('TX', 'OH') AND ss.ss_net_profit BETWEEN 100 AND 200), branch8 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'W' AND cd.cd_education_status = '2 yr Degree' AND ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND hd.hd_dep_count = 1 AND ca.ca_country = 'United States' AND ca.ca_state IN ('OR', 'NM', 'KY') AND ss.ss_net_profit BETWEEN 150 AND 300), branch9 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS s ON s.s_store_sk = ss.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'W' AND cd.cd_education_status = '2 yr Degree' AND ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND hd.hd_dep_count = 1 AND ca.ca_country = 'United States' AND ca.ca_state IN ('VA', 'TX', 'MS') AND ss.ss_net_profit BETWEEN 50 AND 250), union_all AS (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2 UNION ALL SELECT * FROM branch3 UNION ALL SELECT * FROM branch4 UNION ALL SELECT * FROM branch5 UNION ALL SELECT * FROM branch6 UNION ALL SELECT * FROM branch7 UNION ALL SELECT * FROM branch8 UNION ALL SELECT * FROM branch9)\nSELECT AVG(ss_quantity) AS avg1, AVG(ss_ext_sales_price) AS avg2, AVG(ss_ext_wholesale_cost) AS avg3, SUM(ss_ext_wholesale_cost) FROM union_all",
          "prompt_tokens": 3117,
          "response_tokens": 1821,
          "llm_time_ms": 223033.2453250885
        }
      ],
      "original_speedup": 1.01,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676205"
    },
    {
      "query_id": "q64",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q64",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date_1999_2000 AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (1999, 2000)), cs_ui AS (SELECT cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number GROUP BY cs_item_sk HAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)), cross_sales AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales JOIN filtered_date_1999_2000 AS d1 ON ss_sold_date_sk = d1.d_date_sk, store_returns, cs_ui, date_dim AS d2, date_dim AS d3, store, customer, customer_demographics AS cd1, customer_demographics AS cd2, promotion, household_demographics AS hd1, household_demographics AS hd2, customer_address AS ad1, customer_address AS ad2, income_band AS ib1, income_band AS ib2, item WHERE ss_store_sk = s_store_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk = cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk AND ss_item_sk = i_item_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND ss_item_sk = cs_ui.cs_item_sk AND c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk AND c_first_sales_date_sk = d2.d_date_sk AND c_first_shipto_date_sk = d3.d_date_sk AND ss_promo_sk = p_promo_sk AND hd1.hd_income_band_sk = ib1.ib_income_band_sk AND hd2.hd_income_band_sk = ib2.ib_income_band_sk AND cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year)\nSELECT cs1.product_name, cs1.store_name, cs1.store_zip, cs1.b_street_number, cs1.b_street_name, cs1.b_city, cs1.b_zip, cs1.c_street_number, cs1.c_street_name, cs1.c_city, cs1.c_zip, cs1.syear AS cs1syear, cs1.cnt AS cs1cnt, cs1.s1 AS s11, cs1.s2 AS s21, cs1.s3 AS s31, cs2.s1 AS s12, cs2.s2 AS s22, cs2.s3 AS s32, cs2.syear, cs2.cnt FROM cross_sales AS cs1, cross_sales AS cs2 WHERE cs1.item_sk = cs2.item_sk AND cs1.syear = 1999 AND cs2.syear = 1999 + 1 AND cs2.cnt <= cs1.cnt AND cs1.store_name = cs2.store_name AND cs1.store_zip = cs2.store_zip ORDER BY cs1.product_name, cs1.store_name, cs2.cnt, cs1.s1, cs2.s1",
          "prompt_tokens": 3967,
          "response_tokens": 1498,
          "llm_time_ms": 135005.55777549744
        },
        {
          "worker_id": 3,
          "query_id": "q64",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (1999, 2000)), cs_ui AS (SELECT cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number GROUP BY cs_item_sk HAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)), cross_sales AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales JOIN filtered_dates AS d1 ON ss_sold_date_sk = d1.d_date_sk JOIN store_returns ON ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN cs_ui ON ss_item_sk = cs_ui.cs_item_sk JOIN date_dim AS d2 ON c_first_sales_date_sk = d2.d_date_sk JOIN date_dim AS d3 ON c_first_shipto_date_sk = d3.d_date_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_demographics AS cd1 ON ss_cdemo_sk = cd1.cd_demo_sk JOIN customer_demographics AS cd2 ON c_current_cdemo_sk = cd2.cd_demo_sk JOIN promotion ON ss_promo_sk = p_promo_sk JOIN household_demographics AS hd1 ON ss_hdemo_sk = hd1.hd_demo_sk JOIN household_demographics AS hd2 ON c_current_hdemo_sk = hd2.hd_demo_sk JOIN customer_address AS ad1 ON ss_addr_sk = ad1.ca_address_sk JOIN customer_address AS ad2 ON c_current_addr_sk = ad2.ca_address_sk JOIN income_band AS ib1 ON hd1.hd_income_band_sk = ib1.ib_income_band_sk JOIN income_band AS ib2 ON hd2.hd_income_band_sk = ib2.ib_income_band_sk JOIN item ON ss_item_sk = i_item_sk WHERE i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 74 AND i_current_price BETWEEN 65 AND 79 AND cd1.cd_marital_status <> cd2.cd_marital_status GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year)\nSELECT cs1.product_name, cs1.store_name, cs1.store_zip, cs1.b_street_number, cs1.b_street_name, cs1.b_city, cs1.b_zip, cs1.c_street_number, cs1.c_street_name, cs1.c_city, cs1.c_zip, cs1.syear AS cs1syear, cs1.cnt AS cs1cnt, cs1.s1 AS s11, cs1.s2 AS s21, cs1.s3 AS s31, cs2.s1 AS s12, cs2.s2 AS s22, cs2.s3 AS s32, cs2.syear, cs2.cnt FROM cross_sales AS cs1, cross_sales AS cs2 WHERE cs1.item_sk = cs2.item_sk AND cs1.syear = 1999 AND cs2.syear = 2000 AND cs2.cnt <= cs1.cnt AND cs1.store_name = cs2.store_name AND cs1.store_zip = cs2.store_zip ORDER BY cs1.product_name, cs1.store_name, cs2.cnt, cs1.s1, cs2.s1",
          "prompt_tokens": 4123,
          "response_tokens": 1510,
          "llm_time_ms": 140372.962474823
        },
        {
          "worker_id": 2,
          "query_id": "q64",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d1 AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (1999, 2000)), filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk, ss_store_sk, ss_ticket_number, ss_quantity, ss_wholesale_cost, ss_list_price, ss_coupon_amt, d1.d_year AS syear FROM store_sales JOIN filtered_d1 AS d1 ON ss_sold_date_sk = d1.d_date_sk), filtered_items AS (SELECT i_item_sk, i_product_name, i_current_price, i_color FROM item WHERE i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 65 AND 74), cs_ui AS (SELECT cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number GROUP BY cs_item_sk HAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)), filtered_cs_ui AS (SELECT cs_item_sk, sale, refund FROM cs_ui), cross_sales AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, fss.syear AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM filtered_store_sales AS fss JOIN store_returns AS sr ON fss.ss_item_sk = sr.sr_item_sk AND fss.ss_ticket_number = sr.sr_ticket_number JOIN filtered_cs_ui AS cui ON fss.ss_item_sk = cui.cs_item_sk JOIN date_dim AS d2 ON c_first_sales_date_sk = d2.d_date_sk JOIN date_dim AS d3 ON c_first_shipto_date_sk = d3.d_date_sk JOIN store ON fss.ss_store_sk = s_store_sk JOIN customer ON fss.ss_customer_sk = c_customer_sk JOIN customer_demographics AS cd1 ON fss.ss_cdemo_sk = cd1.cd_demo_sk JOIN customer_demographics AS cd2 ON c_current_cdemo_sk = cd2.cd_demo_sk JOIN promotion ON fss.ss_promo_sk = p_promo_sk JOIN household_demographics AS hd1 ON fss.ss_hdemo_sk = hd1.hd_demo_sk JOIN household_demographics AS hd2 ON c_current_hdemo_sk = hd2.hd_demo_sk JOIN customer_address AS ad1 ON fss.ss_addr_sk = ad1.ca_address_sk JOIN customer_address AS ad2 ON c_current_addr_sk = ad2.ca_address_sk JOIN income_band AS ib1 ON hd1.hd_income_band_sk = ib1.ib_income_band_sk JOIN income_band AS ib2 ON hd2.hd_income_band_sk = ib2.ib_income_band_sk JOIN filtered_items AS i ON fss.ss_item_sk = i.i_item_sk WHERE cd1.cd_marital_status <> cd2.cd_marital_status GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, fss.syear, d2.d_year, d3.d_year)\nSELECT cs1.product_name, cs1.store_name, cs1.store_zip, cs1.b_street_number, cs1.b_street_name, cs1.b_city, cs1.b_zip, cs1.c_street_number, cs1.c_street_name, cs1.c_city, cs1.c_zip, cs1.syear AS cs1syear, cs1.cnt AS cs1cnt, cs1.s1 AS s11, cs1.s2 AS s21, cs1.s3 AS s31, cs2.s1 AS s12, cs2.s2 AS s22, cs2.s3 AS s32, cs2.syear, cs2.cnt FROM cross_sales AS cs1, cross_sales AS cs2 WHERE cs1.item_sk = cs2.item_sk AND cs1.syear = 1999 AND cs2.syear = 1999 + 1 AND cs2.cnt <= cs1.cnt AND cs1.store_name = cs2.store_name AND cs1.store_zip = cs2.store_zip ORDER BY cs1.product_name, cs1.store_name, cs2.cnt, cs1.s1, cs2.s1",
          "prompt_tokens": 4110,
          "response_tokens": 1492,
          "llm_time_ms": 162662.6353263855
        },
        {
          "worker_id": 4,
          "query_id": "q64",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH cs_ui AS (SELECT cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number GROUP BY cs_item_sk HAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)), cross_sales_1999 AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales, store_returns, cs_ui, date_dim AS d1, date_dim AS d2, date_dim AS d3, store, customer, customer_demographics AS cd1, customer_demographics AS cd2, promotion, household_demographics AS hd1, household_demographics AS hd2, customer_address AS ad1, customer_address AS ad2, income_band AS ib1, income_band AS ib2, item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk = cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk AND ss_item_sk = i_item_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND ss_item_sk = cs_ui.cs_item_sk AND c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk AND c_first_sales_date_sk = d2.d_date_sk AND c_first_shipto_date_sk = d3.d_date_sk AND ss_promo_sk = p_promo_sk AND hd1.hd_income_band_sk = ib1.ib_income_band_sk AND hd2.hd_income_band_sk = ib2.ib_income_band_sk AND cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 AND d1.d_year = 1999 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year), cross_sales_2000 AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales, store_returns, cs_ui, date_dim AS d1, date_dim AS d2, date_dim AS d3, store, customer, customer_demographics AS cd1, customer_demographics AS cd2, promotion, household_demographics AS hd1, household_demographics AS hd2, customer_address AS ad1, customer_address AS ad2, income_band AS ib1, income_band AS ib2, item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk = cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk AND ss_item_sk = i_item_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND ss_item_sk = cs_ui.cs_item_sk AND c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk AND c_first_sales_date_sk = d2.d_date_sk AND c_first_shipto_date_sk = d3.d_date_sk AND ss_promo_sk = p_promo_sk AND hd1.hd_income_band_sk = ib1.ib_income_band_sk AND hd2.hd_income_band_sk = ib2.ib_income_band_sk AND cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 AND d1.d_year = 2000 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year), cross_sales AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales, store_returns, cs_ui, date_dim AS d1, date_dim AS d2, date_dim AS d3, store, customer, customer_demographics AS cd1, customer_demographics AS cd2, promotion, household_demographics AS hd1, household_demographics AS hd2, customer_address AS ad1, customer_address AS ad2, income_band AS ib1, income_band AS ib2, item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk = cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk AND ss_item_sk = i_item_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND ss_item_sk = cs_ui.cs_item_sk AND c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk AND c_first_sales_date_sk = d2.d_date_sk AND c_first_shipto_date_sk = d3.d_date_sk AND ss_promo_sk = p_promo_sk AND hd1.hd_income_band_sk = ib1.ib_income_band_sk AND hd2.hd_income_band_sk = ib2.ib_income_band_sk AND cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year)\nSELECT cs1.product_name, cs1.store_name, cs1.store_zip, cs1.b_street_number, cs1.b_street_name, cs1.b_city, cs1.b_zip, cs1.c_street_number, cs1.c_street_name, cs1.c_city, cs1.c_zip, cs1.syear AS cs1syear, cs1.cnt AS cs1cnt, cs1.s1 AS s11, cs1.s2 AS s21, cs1.s3 AS s31, cs2.s1 AS s12, cs2.s2 AS s22, cs2.s3 AS s32, cs2.syear, cs2.cnt FROM cross_sales_1999 AS cs1, cross_sales_2000 AS cs2 WHERE cs1.item_sk = cs2.item_sk AND cs2.cnt <= cs1.cnt AND cs1.store_name = cs2.store_name AND cs1.store_zip = cs2.store_zip ORDER BY cs1.product_name, cs1.store_name, cs2.cnt, cs1.s1, cs2.s1",
          "prompt_tokens": 5183,
          "response_tokens": 1439,
          "llm_time_ms": 177938.17734718323
        }
      ],
      "original_speedup": 1.01,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676210"
    },
    {
      "query_id": "q48",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q48",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_store AS (SELECT s_store_sk FROM store), marital_M_degree_4yr AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree'), marital_D_degree_2yr AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree'), marital_S_degree_college AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College'), address_state_group1 AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX')), address_state_group2 AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY')), address_state_group3 AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS')), branch_a1 AS (SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_M_degree_4yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group1 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 0 AND 2000), branch_a2 AS (SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_M_degree_4yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group2 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 150 AND 3000), branch_a3 AS (SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_M_degree_4yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group3 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 50 AND 25000), branch_b1 AS (SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_D_degree_2yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group1 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 0 AND 2000), branch_b2 AS (SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_D_degree_2yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group2 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 3000), branch_b3 AS (SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_D_degree_2yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group3 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 50 AND 25000), branch_c1 AS (SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_S_degree_college ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group1 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 0 AND 2000), branch_c2 AS (SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_S_degree_college ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group2 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 150 AND 3000), branch_c3 AS (SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_S_degree_college ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group3 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 25000)\nSELECT SUM(ss_quantity) FROM (SELECT ss_quantity FROM branch_a1 UNION ALL SELECT ss_quantity FROM branch_a2 UNION ALL SELECT ss_quantity FROM branch_a3 UNION ALL SELECT ss_quantity FROM branch_b1 UNION ALL SELECT ss_quantity FROM branch_b2 UNION ALL SELECT ss_quantity FROM branch_b3 UNION ALL SELECT ss_quantity FROM branch_c1 UNION ALL SELECT ss_quantity FROM branch_c2 UNION ALL SELECT ss_quantity FROM branch_c3) AS t",
          "prompt_tokens": 2900,
          "response_tokens": 1407,
          "llm_time_ms": 142085.66737174988
        },
        {
          "worker_id": 4,
          "query_id": "q48",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_stores AS (SELECT s_store_sk FROM store)\nSELECT SUM(ss_quantity_sum) FROM (SELECT SUM(ss_quantity) AS ss_quantity_sum FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') AND ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT SUM(ss_quantity) AS ss_quantity_sum FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') AND ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT SUM(ss_quantity) AS ss_quantity_sum FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') AND ss_net_profit BETWEEN 50 AND 25000 UNION ALL SELECT SUM(ss_quantity) AS ss_quantity_sum FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') AND ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT SUM(ss_quantity) AS ss_quantity_sum FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') AND ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT SUM(ss_quantity) AS ss_quantity_sum FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') AND ss_net_profit BETWEEN 50 AND 25000 UNION ALL SELECT SUM(ss_quantity) AS ss_quantity_sum FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') AND ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT SUM(ss_quantity) AS ss_quantity_sum FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') AND ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT SUM(ss_quantity) AS ss_quantity_sum FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') AND ss_net_profit BETWEEN 50 AND 25000) AS t",
          "prompt_tokens": 4119,
          "response_tokens": 1356,
          "llm_time_ms": 168610.60309410095
        },
        {
          "worker_id": 3,
          "query_id": "q48",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000)\nSELECT SUM(ss_quantity) FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk, store, customer_demographics, customer_address WHERE s_store_sk = ss_store_sk AND ((cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00) OR (cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 50.00 AND 100.00) OR (cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 150.00 AND 200.00)) AND ((ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') AND ss_net_profit BETWEEN 0 AND 2000) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') AND ss_net_profit BETWEEN 150 AND 3000) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') AND ss_net_profit BETWEEN 50 AND 25000))",
          "prompt_tokens": 3066,
          "response_tokens": 1665,
          "llm_time_ms": 180103.56640815735
        },
        {
          "worker_id": 2,
          "query_id": "q48",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_stores AS (SELECT s_store_sk FROM store) SELECT SUM(ss_quantity) FROM (SELECT ss_quantity FROM store_sales JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 25000) AS union_branches",
          "prompt_tokens": 3050,
          "response_tokens": 1074,
          "llm_time_ms": 279291.3272380829
        }
      ],
      "original_speedup": 1.0,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676213"
    },
    {
      "query_id": "q25",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q25",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), d2_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), d3_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss_customer_sk, ss_item_sk, ss_ticket_number, ss_net_profit, ss_store_sk FROM store_sales JOIN d1_dates ON ss_sold_date_sk = d_date_sk), filtered_store_returns AS (SELECT sr_customer_sk, sr_item_sk, sr_ticket_number, sr_net_loss, sr_returned_date_sk FROM store_returns JOIN d2_dates ON sr_returned_date_sk = d_date_sk), filtered_catalog_sales AS (SELECT cs_bill_customer_sk, cs_item_sk, cs_net_profit, cs_sold_date_sk FROM catalog_sales JOIN d3_dates ON cs_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_net_profit) AS store_sales_profit, SUM(sr_net_loss) AS store_returns_loss, SUM(cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales AS ss JOIN filtered_store_returns AS sr ON (ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number) JOIN filtered_catalog_sales AS cs ON (sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk) JOIN item AS i ON ss.ss_item_sk = i.i_item_sk JOIN store AS s ON ss.ss_store_sk = s.s_store_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
          "prompt_tokens": 2857,
          "response_tokens": 548,
          "llm_time_ms": 79222.38874435425
        },
        {
          "worker_id": 2,
          "query_id": "q25",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), d2_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), d3_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN d1_dates ON store_sales.ss_sold_date_sk = d1_dates.d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN d2_dates ON store_returns.sr_returned_date_sk = d2_dates.d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN d3_dates ON catalog_sales.cs_sold_date_sk = d3_dates.d_date_sk)\nSELECT i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name, SUM(fss.ss_net_profit) AS store_sales_profit, SUM(fsr.sr_net_loss) AS store_returns_loss, SUM(fcs.cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales AS fss JOIN filtered_store_returns AS fsr ON fss.ss_customer_sk = fsr.sr_customer_sk AND fss.ss_item_sk = fsr.sr_item_sk AND fss.ss_ticket_number = fsr.sr_ticket_number JOIN filtered_catalog_sales AS fcs ON fsr.sr_customer_sk = fcs.cs_bill_customer_sk AND fsr.sr_item_sk = fcs.cs_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk JOIN item AS i ON fss.ss_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name ORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name LIMIT 100",
          "prompt_tokens": 3004,
          "response_tokens": 586,
          "llm_time_ms": 79087.7583026886
        },
        {
          "worker_id": 4,
          "query_id": "q25",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), d2_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), d3_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN d1_filtered ON ss_sold_date_sk = d1_filtered.d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN d2_filtered ON sr_returned_date_sk = d2_filtered.d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN d3_filtered ON cs_sold_date_sk = d3_filtered.d_date_sk)\nSELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_net_profit) AS store_sales_profit, SUM(sr_net_loss) AS store_returns_loss, SUM(cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales, filtered_store_returns, filtered_catalog_sales, store, item WHERE i_item_sk = ss_item_sk AND s_store_sk = ss_store_sk AND ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
          "prompt_tokens": 4073,
          "response_tokens": 965,
          "llm_time_ms": 85541.64695739746
        },
        {
          "worker_id": 3,
          "query_id": "q25",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_d1 AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), filtered_dates_d2_d3 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN filtered_dates_d1 ON ss_sold_date_sk = d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN filtered_dates_d2_d3 ON sr_returned_date_sk = d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN filtered_dates_d2_d3 ON cs_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_net_profit) AS store_sales_profit, SUM(sr_net_loss) AS store_returns_loss, SUM(cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales JOIN filtered_store_returns ON (filtered_store_sales.ss_customer_sk = filtered_store_returns.sr_customer_sk AND filtered_store_sales.ss_item_sk = filtered_store_returns.sr_item_sk AND filtered_store_sales.ss_ticket_number = filtered_store_returns.sr_ticket_number) JOIN filtered_catalog_sales ON (filtered_store_returns.sr_customer_sk = filtered_catalog_sales.cs_bill_customer_sk AND filtered_store_returns.sr_item_sk = filtered_catalog_sales.cs_item_sk) JOIN item ON (filtered_store_sales.ss_item_sk = i_item_sk) JOIN store ON (filtered_store_sales.ss_store_sk = s_store_sk) GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
          "prompt_tokens": 3021,
          "response_tokens": 640,
          "llm_time_ms": 162368.2155609131
        }
      ],
      "original_speedup": 0.98,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676219"
    },
    {
      "query_id": "q71",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q71",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999), web_sales_filtered AS (SELECT ws_ext_sales_price AS ext_price, ws_item_sk AS sold_item_sk, ws_sold_time_sk AS time_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk), catalog_sales_filtered AS (SELECT cs_ext_sales_price AS ext_price, cs_item_sk AS sold_item_sk, cs_sold_time_sk AS time_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk), store_sales_filtered AS (SELECT ss_ext_sales_price AS ext_price, ss_item_sk AS sold_item_sk, ss_sold_time_sk AS time_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk)\nSELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM (SELECT * FROM web_sales_filtered UNION ALL SELECT * FROM catalog_sales_filtered UNION ALL SELECT * FROM store_sales_filtered) AS tmp, item, time_dim WHERE sold_item_sk = i_item_sk AND i_manager_id = 1 AND time_sk = t_time_sk AND (t_meal_time = 'breakfast' OR t_meal_time = 'dinner') GROUP BY i_brand, i_brand_id, t_hour, t_minute ORDER BY ext_price DESC NULLS FIRST, i_brand_id NULLS FIRST, t_hour NULLS FIRST",
          "prompt_tokens": 3139,
          "response_tokens": 1001,
          "llm_time_ms": 119261.79814338684
        },
        {
          "worker_id": 4,
          "query_id": "q71",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999), filtered_time AS (SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time = 'breakfast' OR t_meal_time = 'dinner'), unified_sales AS (SELECT ws_ext_sales_price AS ext_price, ws_sold_date_sk AS sold_date_sk, ws_item_sk AS sold_item_sk, ws_sold_time_sk AS time_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk UNION ALL SELECT cs_ext_sales_price AS ext_price, cs_sold_date_sk AS sold_date_sk, cs_item_sk AS sold_item_sk, cs_sold_time_sk AS time_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk UNION ALL SELECT ss_ext_sales_price AS ext_price, ss_sold_date_sk AS sold_date_sk, ss_item_sk AS sold_item_sk, ss_sold_time_sk AS time_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk)\nSELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM unified_sales JOIN item ON sold_item_sk = i_item_sk JOIN filtered_time ON time_sk = t_time_sk WHERE i_manager_id = 1 GROUP BY i_brand, i_brand_id, t_hour, t_minute ORDER BY ext_price DESC NULLS FIRST, i_brand_id NULLS FIRST, t_hour NULLS FIRST",
          "prompt_tokens": 4192,
          "response_tokens": 480,
          "llm_time_ms": 116765.11406898499
        },
        {
          "worker_id": 1,
          "query_id": "q71",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999), time_breakfast AS (SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time = 'breakfast'), time_dinner AS (SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time = 'dinner'), web_sales_union AS (SELECT ws_ext_sales_price AS ext_price, ws_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM web_sales AS ws JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN time_breakfast AS t ON ws.ws_sold_time_sk = t.t_time_sk UNION ALL SELECT ws_ext_sales_price AS ext_price, ws_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM web_sales AS ws JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN time_dinner AS t ON ws.ws_sold_time_sk = t.t_time_sk), catalog_sales_union AS (SELECT cs_ext_sales_price AS ext_price, cs_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM catalog_sales AS cs JOIN date_filter AS df ON cs.cs_sold_date_sk = df.d_date_sk JOIN time_breakfast AS t ON cs.cs_sold_time_sk = t.t_time_sk UNION ALL SELECT cs_ext_sales_price AS ext_price, cs_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM catalog_sales AS cs JOIN date_filter AS df ON cs.cs_sold_date_sk = df.d_date_sk JOIN time_dinner AS t ON cs.cs_sold_time_sk = t.t_time_sk), store_sales_union AS (SELECT ss_ext_sales_price AS ext_price, ss_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM store_sales AS ss JOIN date_filter AS df ON ss.ss_sold_date_sk = df.d_date_sk JOIN time_breakfast AS t ON ss.ss_sold_time_sk = t.t_time_sk UNION ALL SELECT ss_ext_sales_price AS ext_price, ss_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM store_sales AS ss JOIN date_filter AS df ON ss.ss_sold_date_sk = df.d_date_sk JOIN time_dinner AS t ON ss.ss_sold_time_sk = t.t_time_sk), all_sales AS (SELECT ext_price, sold_item_sk, t_hour, t_minute FROM web_sales_union UNION ALL SELECT ext_price, sold_item_sk, t_hour, t_minute FROM catalog_sales_union UNION ALL SELECT ext_price, sold_item_sk, t_hour, t_minute FROM store_sales_union)\nSELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM item AS i JOIN all_sales AS s ON i.i_item_sk = s.sold_item_sk WHERE i.i_manager_id = 1 GROUP BY i_brand, i_brand_id, t_hour, t_minute ORDER BY ext_price DESC NULLS FIRST, i_brand_id NULLS FIRST, t_hour NULLS FIRST",
          "prompt_tokens": 2976,
          "response_tokens": 817,
          "llm_time_ms": 131569.44465637207
        },
        {
          "worker_id": 2,
          "query_id": "q71",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 1), filtered_times AS (SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time IN ('breakfast', 'dinner')), web_sales_with_dates AS (SELECT ws_ext_sales_price AS ext_price, ws_item_sk, ws_sold_time_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk), catalog_sales_with_dates AS (SELECT cs_ext_sales_price AS ext_price, cs_item_sk, cs_sold_time_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk), store_sales_with_dates AS (SELECT ss_ext_sales_price AS ext_price, ss_item_sk, ss_sold_time_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk), combined_sales AS (SELECT ext_price, ws_item_sk AS item_sk, ws_sold_time_sk AS time_sk FROM web_sales_with_dates UNION ALL SELECT ext_price, cs_item_sk, cs_sold_time_sk FROM catalog_sales_with_dates UNION ALL SELECT ext_price, ss_item_sk, ss_sold_time_sk FROM store_sales_with_dates)\nSELECT i.i_brand_id AS brand_id, i.i_brand AS brand, t.t_hour, t.t_minute, SUM(cs.ext_price) AS ext_price FROM combined_sales AS cs JOIN filtered_items AS i ON cs.item_sk = i.i_item_sk JOIN filtered_times AS t ON cs.time_sk = t.t_time_sk GROUP BY i.i_brand, i.i_brand_id, t.t_hour, t.t_minute ORDER BY ext_price DESC NULLS FIRST, i.i_brand_id NULLS FIRST, t.t_hour NULLS FIRST",
          "prompt_tokens": 3123,
          "response_tokens": 741,
          "llm_time_ms": 155638.33737373352
        }
      ],
      "original_speedup": 0.96,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676224"
    },
    {
      "query_id": "q55",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q55",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999), filtered_item AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 28)\nSELECT i_brand_id AS brand_id, i_brand AS brand, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_item ON ss_item_sk = i_item_sk GROUP BY i_brand, i_brand_id ORDER BY ext_price DESC, i_brand_id LIMIT 100",
          "prompt_tokens": 2503,
          "response_tokens": 282,
          "llm_time_ms": 39923.13766479492
        },
        {
          "worker_id": 2,
          "query_id": "q55",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy = 11), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 28), filtered_sales AS (SELECT ss_item_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk)\nSELECT i.brand_id, i.brand, SUM(s.ss_ext_sales_price) AS ext_price FROM filtered_sales AS s JOIN filtered_items AS i ON s.ss_item_sk = i.i_item_sk GROUP BY i.brand_id, i.brand ORDER BY ext_price DESC, i.brand_id LIMIT 100",
          "prompt_tokens": 2650,
          "response_tokens": 350,
          "llm_time_ms": 72141.82186126709
        },
        {
          "worker_id": 3,
          "query_id": "q55",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy = 11), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 28)\nSELECT i_brand_id AS brand_id, i_brand AS brand, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk GROUP BY i_brand, i_brand_id ORDER BY ext_price DESC, i_brand_id LIMIT 100",
          "prompt_tokens": 2666,
          "response_tokens": 309,
          "llm_time_ms": 95092.8041934967
        },
        {
          "worker_id": 4,
          "query_id": "q55",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy = 11)\nSELECT i_brand_id AS brand_id, i_brand AS brand, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk WHERE i_manager_id = 28 GROUP BY i_brand, i_brand_id ORDER BY ext_price DESC, i_brand_id LIMIT 100",
          "prompt_tokens": 3719,
          "response_tokens": 383,
          "llm_time_ms": 121089.27392959595
        }
      ],
      "original_speedup": 0.94,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676229"
    },
    {
      "query_id": "q75",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q75",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Books' AND d_year IN (2001, 2002) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Books' AND d_year IN (2001, 2002) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Books' AND d_year IN (2001, 2002)) AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year_, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr, all_sales AS prev_yr WHERE curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2001 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100",
          "prompt_tokens": 3562,
          "response_tokens": 1609,
          "llm_time_ms": 87459.96403694153
        },
        {
          "worker_id": 1,
          "query_id": "q75",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2001, 2002)), all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d.d_year, i.i_brand_id, i.i_class_id, i.i_category_id, i.i_manufact_id, cs.cs_quantity - COALESCE(cr.cr_return_quantity, 0) AS sales_cnt, cs.cs_ext_sales_price - COALESCE(cr.cr_return_amount, 0.0) AS sales_amt FROM catalog_sales AS cs JOIN item AS i ON i.i_item_sk = cs.cs_item_sk JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk LEFT JOIN catalog_returns AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) WHERE i.i_category = 'Books' UNION ALL SELECT d.d_year, i.i_brand_id, i.i_class_id, i.i_category_id, i.i_manufact_id, ss.ss_quantity - COALESCE(sr.sr_return_quantity, 0) AS sales_cnt, ss.ss_ext_sales_price - COALESCE(sr.sr_return_amt, 0.0) AS sales_amt FROM store_sales AS ss JOIN item AS i ON i.i_item_sk = ss.ss_item_sk JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk LEFT JOIN store_returns AS sr ON (ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk) WHERE i.i_category = 'Books' UNION ALL SELECT d.d_year, i.i_brand_id, i.i_class_id, i.i_category_id, i.i_manufact_id, ws.ws_quantity - COALESCE(wr.wr_return_quantity, 0) AS sales_cnt, ws.ws_ext_sales_price - COALESCE(wr.wr_return_amt, 0.0) AS sales_amt FROM web_sales AS ws JOIN item AS i ON i.i_item_sk = ws.ws_item_sk JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk LEFT JOIN web_returns AS wr ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk) WHERE i.i_category = 'Books') AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year_, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr, all_sales AS prev_yr WHERE curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100",
          "prompt_tokens": 3411,
          "response_tokens": 805,
          "llm_time_ms": 114510.56909561157
        },
        {
          "worker_id": 3,
          "query_id": "q75",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_2002 AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2002), filtered_dates_2001 AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2001), all_sales_2002 AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN filtered_dates_2002 ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Books' UNION ALL SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN filtered_dates_2002 ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Books' UNION ALL SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN filtered_dates_2002 ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Books') AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id), all_sales_2001 AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN filtered_dates_2001 ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Books' UNION ALL SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN filtered_dates_2001 ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Books' UNION ALL SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN filtered_dates_2001 ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Books') AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id), all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Books' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Books' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Books') AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year_, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales_2002 AS curr_yr JOIN all_sales_2001 AS prev_yr ON curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id WHERE CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100",
          "prompt_tokens": 3578,
          "response_tokens": 1182,
          "llm_time_ms": 137402.03952789307
        },
        {
          "worker_id": 4,
          "query_id": "q75",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (2001, 2002)), all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN filtered_dates ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Books' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN filtered_dates ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Books' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN filtered_dates ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Books') AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year_, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr, all_sales AS prev_yr WHERE curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2001 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100",
          "prompt_tokens": 4628,
          "response_tokens": 1012,
          "llm_time_ms": 164109.9135875702
        }
      ],
      "original_speedup": 0.94,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676232"
    },
    {
      "query_id": "q56",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q56",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 2), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), ss AS (SELECT fi.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ss.ss_addr_sk = fa.ca_address_sk JOIN filtered_items AS fi ON ss.ss_item_sk = fi.i_item_sk GROUP BY fi.i_item_id), ws AS (SELECT fi.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ws.ws_bill_addr_sk = fa.ca_address_sk JOIN filtered_items AS fi ON ws.ws_item_sk = fi.i_item_sk GROUP BY fi.i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_moy = 2 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY total_sales NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3132,
          "response_tokens": 511,
          "llm_time_ms": 66344.37918663025
        },
        {
          "worker_id": 4,
          "query_id": "q56",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 2), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_id, i_item_sk FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')), ss AS (SELECT i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 2001 AND d_moy = 2 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_moy = 2 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ws AS (SELECT i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 2001 AND d_moy = 2 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY total_sales NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 4348,
          "response_tokens": 508,
          "llm_time_ms": 103330.69849014282
        },
        {
          "worker_id": 3,
          "query_id": "q56",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 2), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')), ss AS (SELECT i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_addresses ON ss_addr_sk = ca_address_sk JOIN filtered_items ON ss_item_sk = i_item_sk GROUP BY i_item_id), ws AS (SELECT i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_addresses ON ws_bill_addr_sk = ca_address_sk JOIN filtered_items ON ws_item_sk = i_item_sk GROUP BY i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_moy = 2 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY total_sales NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3296,
          "response_tokens": 1329,
          "llm_time_ms": 145754.10413742065
        },
        {
          "worker_id": 2,
          "query_id": "q56",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 2), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')), filtered_store_sales AS (SELECT ss_item_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_addresses ON store_sales.ss_addr_sk = filtered_addresses.ca_address_sk), filtered_web_sales AS (SELECT ws_item_sk, ws_ext_sales_price FROM web_sales JOIN filtered_dates ON web_sales.ws_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_addresses ON web_sales.ws_bill_addr_sk = filtered_addresses.ca_address_sk), ss AS (SELECT filtered_items.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM filtered_store_sales JOIN filtered_items ON filtered_store_sales.ss_item_sk = filtered_items.i_item_sk GROUP BY filtered_items.i_item_id), ws AS (SELECT filtered_items.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM filtered_web_sales JOIN filtered_items ON filtered_web_sales.ws_item_sk = filtered_items.i_item_sk GROUP BY filtered_items.i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_color IN ('slate', 'blanched', 'burnished')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_moy = 2 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY total_sales NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3276,
          "response_tokens": 646,
          "llm_time_ms": 174849.059343338
        }
      ],
      "original_speedup": 0.92,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676237"
    },
    {
      "query_id": "q86",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q86",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1211)\nSELECT SUM(ws_net_paid) AS total_sum, i_category, i_class, GROUPING(i_category) + GROUPING(i_class) AS lochierarchy, RANK() OVER (PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END ORDER BY SUM(ws_net_paid) DESC) AS rank_within_parent FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN item ON i_item_sk = ws_item_sk GROUP BY ROLLUP (i_category, i_class) ORDER BY lochierarchy DESC NULLS FIRST, CASE WHEN GROUPING(i_category) + GROUPING(i_class) = 0 THEN i_category END NULLS FIRST, rank_within_parent NULLS FIRST LIMIT 100",
          "prompt_tokens": 2762,
          "response_tokens": 358,
          "llm_time_ms": 53635.62846183777
        },
        {
          "worker_id": 4,
          "query_id": "q86",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), filtered_sales AS (SELECT ws_net_paid, i_category, i_class FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN item ON i_item_sk = ws_item_sk)\nSELECT SUM(ws_net_paid) AS total_sum, i_category, i_class, GROUPING(i_category) + GROUPING(i_class) AS lochierarchy, RANK() OVER (PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END ORDER BY SUM(ws_net_paid) DESC) AS rank_within_parent FROM filtered_sales GROUP BY ROLLUP (i_category, i_class) ORDER BY lochierarchy DESC NULLS FIRST, CASE WHEN GROUPING(i_category) + GROUPING(i_class) = 0 THEN i_category END NULLS FIRST, rank_within_parent NULLS FIRST LIMIT 100",
          "prompt_tokens": 3815,
          "response_tokens": 499,
          "llm_time_ms": 66617.39993095398
        },
        {
          "worker_id": 2,
          "query_id": "q86",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1211), filtered_web_sales AS (SELECT ws_item_sk, ws_net_paid FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk)\nSELECT SUM(ws_net_paid) AS total_sum, i_category, i_class, GROUPING(i_category) + GROUPING(i_class) AS lochierarchy, RANK() OVER (PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END ORDER BY SUM(ws_net_paid) DESC) AS rank_within_parent FROM filtered_web_sales AS fws JOIN item AS i ON fws.ws_item_sk = i.i_item_sk GROUP BY ROLLUP (i_category, i_class) ORDER BY lochierarchy DESC NULLS FIRST, CASE WHEN GROUPING(i_category) + GROUPING(i_class) = 0 THEN i_category END NULLS FIRST, rank_within_parent NULLS FIRST LIMIT 100",
          "prompt_tokens": 2746,
          "response_tokens": 411,
          "llm_time_ms": 77009.16504859924
        },
        {
          "worker_id": 1,
          "query_id": "q86",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), filtered_sales AS (SELECT ws_item_sk, ws_net_paid FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk), aggregated_sales AS (SELECT i.i_category, i.i_class, SUM(fs.ws_net_paid) AS item_total FROM filtered_sales AS fs JOIN item AS i ON fs.ws_item_sk = i.i_item_sk GROUP BY i.i_category, i.i_class)\nSELECT SUM(item_total) AS total_sum, i_category, i_class, GROUPING(i_category) + GROUPING(i_class) AS lochierarchy, RANK() OVER (PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END ORDER BY SUM(item_total) DESC) AS rank_within_parent FROM aggregated_sales GROUP BY ROLLUP (i_category, i_class) ORDER BY lochierarchy DESC NULLS FIRST, CASE WHEN GROUPING(i_category) + GROUPING(i_class) = 0 THEN i_category END NULLS FIRST, rank_within_parent NULLS FIRST LIMIT 100",
          "prompt_tokens": 2601,
          "response_tokens": 437,
          "llm_time_ms": 155526.66187286377
        }
      ],
      "original_speedup": 0.92,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676240"
    },
    {
      "query_id": "q50",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q50",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d2 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 8), filtered_store_returns AS (SELECT sr_ticket_number, sr_item_sk, sr_customer_sk, sr_returned_date_sk FROM store_returns JOIN filtered_d2 ON sr_returned_date_sk = filtered_d2.d_date_sk), joined_sales_returns AS (SELECT ss_sold_date_sk, ss_store_sk, sr_returned_date_sk FROM store_sales JOIN filtered_store_returns ON store_sales.ss_ticket_number = filtered_store_returns.sr_ticket_number AND store_sales.ss_item_sk = filtered_store_returns.sr_item_sk AND store_sales.ss_customer_sk = filtered_store_returns.sr_customer_sk)\nSELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 30) AND (sr_returned_date_sk - ss_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 60) AND (sr_returned_date_sk - ss_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 90) AND (sr_returned_date_sk - ss_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM joined_sales_returns AS jsr JOIN store AS s ON jsr.ss_store_sk = s.s_store_sk GROUP BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip ORDER BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip LIMIT 100",
          "prompt_tokens": 3083,
          "response_tokens": 638,
          "llm_time_ms": 103998.77524375916
        },
        {
          "worker_id": 1,
          "query_id": "q50",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d2 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 8), filtered_returns AS (SELECT sr_ticket_number, sr_item_sk, sr_customer_sk, sr_returned_date_sk FROM store_returns JOIN filtered_d2 ON sr_returned_date_sk = d_date_sk)\nSELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, SUM(CASE WHEN (fr.sr_returned_date_sk - ss_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (fr.sr_returned_date_sk - ss_sold_date_sk > 30) AND (fr.sr_returned_date_sk - ss_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (fr.sr_returned_date_sk - ss_sold_date_sk > 60) AND (fr.sr_returned_date_sk - ss_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (fr.sr_returned_date_sk - ss_sold_date_sk > 90) AND (fr.sr_returned_date_sk - ss_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (fr.sr_returned_date_sk - ss_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM store_sales JOIN filtered_returns AS fr ON (ss_ticket_number = fr.sr_ticket_number AND ss_item_sk = fr.sr_item_sk AND ss_customer_sk = fr.sr_customer_sk) JOIN store ON (ss_store_sk = s_store_sk) JOIN date_dim AS d1 ON (ss_sold_date_sk = d1.d_date_sk) GROUP BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip ORDER BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip LIMIT 100",
          "prompt_tokens": 2936,
          "response_tokens": 566,
          "llm_time_ms": 109034.01136398315
        },
        {
          "worker_id": 3,
          "query_id": "q50",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d2 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 8), filtered_returns AS (SELECT sr_ticket_number, sr_item_sk, sr_customer_sk, sr_returned_date_sk FROM store_returns JOIN filtered_d2 ON sr_returned_date_sk = d_date_sk)\nSELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 30) AND (sr_returned_date_sk - ss_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 60) AND (sr_returned_date_sk - ss_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 90) AND (sr_returned_date_sk - ss_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM store_sales JOIN filtered_returns ON ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = sr_customer_sk JOIN store ON ss_store_sk = s_store_sk JOIN date_dim AS d1 ON ss_sold_date_sk = d1.d_date_sk GROUP BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip ORDER BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip LIMIT 100",
          "prompt_tokens": 3100,
          "response_tokens": 706,
          "llm_time_ms": 118955.8618068695
        },
        {
          "worker_id": 4,
          "query_id": "q50",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_returns_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 8), filtered_sales AS (SELECT ss_ticket_number, ss_item_sk, ss_customer_sk, ss_sold_date_sk, ss_store_sk FROM store_sales), filtered_returns AS (SELECT sr_ticket_number, sr_item_sk, sr_customer_sk, sr_returned_date_sk FROM store_returns JOIN filtered_returns_date ON sr_returned_date_sk = d_date_sk), joined_data AS (SELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, ss_sold_date_sk, sr_returned_date_sk FROM filtered_sales JOIN filtered_returns ON ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = sr_customer_sk JOIN store ON ss_store_sk = s_store_sk)\nSELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 30) AND (sr_returned_date_sk - ss_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 60) AND (sr_returned_date_sk - ss_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 90) AND (sr_returned_date_sk - ss_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM joined_data GROUP BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip ORDER BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip LIMIT 100",
          "prompt_tokens": 4153,
          "response_tokens": 683,
          "llm_time_ms": 159560.89282035828
        }
      ],
      "original_speedup": 0.91,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676245"
    },
    {
      "query_id": "q91",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q91",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), address_filtered AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7), hd_filtered AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%'), branch_m_unknown AS (SELECT cc_call_center_id, cc_name, cc_manager, 'M' AS cd_marital_status, 'Unknown' AS cd_education_status, SUM(cr_net_loss) AS Returns_Loss FROM call_center JOIN catalog_returns ON cr_call_center_sk = cc_call_center_sk JOIN date_filtered ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN address_filtered ON ca_address_sk = c_current_addr_sk JOIN hd_filtered ON hd_demo_sk = c_current_hdemo_sk WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' GROUP BY cc_call_center_id, cc_name, cc_manager), branch_w_advanced AS (SELECT cc_call_center_id, cc_name, cc_manager, 'W' AS cd_marital_status, 'Advanced Degree' AS cd_education_status, SUM(cr_net_loss) AS Returns_Loss FROM call_center JOIN catalog_returns ON cr_call_center_sk = cc_call_center_sk JOIN date_filtered ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN address_filtered ON ca_address_sk = c_current_addr_sk JOIN hd_filtered ON hd_demo_sk = c_current_hdemo_sk WHERE cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' GROUP BY cc_call_center_id, cc_name, cc_manager)\nSELECT Call_Center, Call_Center_Name, Manager, Returns_Loss FROM (SELECT * FROM branch_m_unknown UNION ALL SELECT * FROM branch_w_advanced) AS combined ORDER BY Returns_Loss DESC",
          "prompt_tokens": 2773,
          "response_tokens": 644,
          "llm_time_ms": 93852.1180152893
        },
        {
          "worker_id": 2,
          "query_id": "q91",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE (cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')), filtered_household_demographics AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%'), filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7), filtered_catalog_returns AS (SELECT cr_call_center_sk, cr_net_loss, cr_returning_customer_sk FROM catalog_returns AS cr JOIN filtered_dates AS fd ON cr.cr_returned_date_sk = fd.d_date_sk)\nSELECT cc.cc_call_center_id AS Call_Center, cc.cc_name AS Call_Center_Name, cc.cc_manager AS Manager, SUM(fcr.cr_net_loss) AS Returns_Loss FROM call_center AS cc JOIN filtered_catalog_returns AS fcr ON cc.cc_call_center_sk = fcr.cr_call_center_sk JOIN customer AS c ON fcr.cr_returning_customer_sk = c.c_customer_sk JOIN filtered_customer_demographics AS cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN filtered_household_demographics AS hd ON c.c_current_hdemo_sk = hd.hd_demo_sk JOIN filtered_customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk GROUP BY cc.cc_call_center_id, cc.cc_name, cc.cc_manager ORDER BY SUM(fcr.cr_net_loss) DESC",
          "prompt_tokens": 2920,
          "response_tokens": 534,
          "llm_time_ms": 111879.62532043457
        },
        {
          "worker_id": 4,
          "query_id": "q91",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), customer_filtered_address AS (SELECT ca_address_sk, ca_gmt_offset FROM customer_address WHERE ca_gmt_offset = -7), customer_filtered_household AS (SELECT hd_demo_sk, hd_buy_potential FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%'), branch1_returns AS (SELECT cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status, cr_net_loss FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_filtered_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Unknown' JOIN customer_filtered_household ON hd_demo_sk = c_current_hdemo_sk JOIN call_center ON cr_call_center_sk = cc_call_center_sk), branch2_returns AS (SELECT cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status, cr_net_loss FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_filtered_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk AND cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' JOIN customer_filtered_household ON hd_demo_sk = c_current_hdemo_sk JOIN call_center ON cr_call_center_sk = cc_call_center_sk)\nSELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM (SELECT * FROM branch1_returns UNION ALL SELECT * FROM branch2_returns) AS all_returns GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC",
          "prompt_tokens": 3989,
          "response_tokens": 1086,
          "llm_time_ms": 108080.70802688599
        },
        {
          "worker_id": 3,
          "query_id": "q91",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7), filtered_household_demographics AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%'), customer_demographics_branch1 AS (SELECT cd_demo_sk, cd_marital_status, cd_education_status FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown'), customer_demographics_branch2 AS (SELECT cd_demo_sk, cd_marital_status, cd_education_status FROM customer_demographics WHERE cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree'), branch1 AS (SELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM call_center JOIN catalog_returns ON cr_call_center_sk = cc_call_center_sk JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_demographics_branch1 ON cd_demo_sk = c_current_cdemo_sk JOIN filtered_household_demographics ON hd_demo_sk = c_current_hdemo_sk JOIN filtered_customer_address ON ca_address_sk = c_current_addr_sk GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status), branch2 AS (SELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM call_center JOIN catalog_returns ON cr_call_center_sk = cc_call_center_sk JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_demographics_branch2 ON cd_demo_sk = c_current_cdemo_sk JOIN filtered_household_demographics ON hd_demo_sk = c_current_hdemo_sk JOIN filtered_customer_address ON ca_address_sk = c_current_addr_sk GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status)\nSELECT Call_Center, Call_Center_Name, Manager, Returns_Loss FROM (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2) AS union_result ORDER BY Returns_Loss DESC",
          "prompt_tokens": 2936,
          "response_tokens": 745,
          "llm_time_ms": 124336.37499809265
        }
      ],
      "original_speedup": 0.89,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676248"
    },
    {
      "query_id": "q24",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q24",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_sales AS (SELECT c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size, SUM(ss_net_paid) AS netpaid FROM store_sales, store_returns, store, item, customer, customer_address WHERE ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = c_customer_sk AND ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND c_current_addr_sk = ca_address_sk AND c_birth_country <> UPPER(ca_country) AND s_zip = ca_zip AND s_market_id = 8 AND i_color = 'peach' GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size), threshold_cte AS (SELECT 0.05 * AVG(netpaid) AS threshold FROM filtered_sales), ssales AS (SELECT c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size, SUM(ss_net_paid) AS netpaid FROM store_sales, store_returns, store, item, customer, customer_address WHERE ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = c_customer_sk AND ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND c_current_addr_sk = ca_address_sk AND c_birth_country <> UPPER(ca_country) AND s_zip = ca_zip AND s_market_id = 8 GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size)\nSELECT c_last_name, c_first_name, s_store_name, SUM(netpaid) AS paid FROM filtered_sales GROUP BY c_last_name, c_first_name, s_store_name HAVING SUM(netpaid) > (SELECT threshold FROM threshold_cte) ORDER BY c_last_name, c_first_name, s_store_name",
          "prompt_tokens": 3235,
          "response_tokens": 577,
          "llm_time_ms": 151520.59054374695
        },
        {
          "worker_id": 3,
          "query_id": "q24",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH ssales_peach AS (SELECT c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size, SUM(ss_net_paid) AS netpaid FROM store_sales, store_returns, store, item, customer, customer_address WHERE ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = c_customer_sk AND ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND c_current_addr_sk = ca_address_sk AND c_birth_country <> UPPER(ca_country) AND s_zip = ca_zip AND s_market_id = 8 AND i_color = 'peach' GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size), overall_avg AS (SELECT 0.05 * AVG(netpaid) AS threshold FROM ssales_peach), ssales AS (SELECT c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size, SUM(ss_net_paid) AS netpaid FROM store_sales, store_returns, store, item, customer, customer_address WHERE ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = c_customer_sk AND ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND c_current_addr_sk = ca_address_sk AND c_birth_country <> UPPER(ca_country) AND s_zip = ca_zip AND s_market_id = 8 GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size)\nSELECT c_last_name, c_first_name, s_store_name, SUM(netpaid) AS paid FROM ssales_peach GROUP BY c_last_name, c_first_name, s_store_name HAVING SUM(netpaid) > (SELECT threshold FROM overall_avg) ORDER BY c_last_name, c_first_name, s_store_name",
          "prompt_tokens": 3252,
          "response_tokens": 437,
          "llm_time_ms": 153294.2111492157
        },
        {
          "worker_id": 4,
          "query_id": "q24",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH total_avg AS (SELECT AVG(ss_net_paid) AS avg_netpaid FROM store_sales, store_returns, store, item, customer, customer_address WHERE ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = c_customer_sk AND ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND c_current_addr_sk = ca_address_sk AND c_birth_country <> UPPER(ca_country) AND s_zip = ca_zip AND s_market_id = 8), filtered_ssales AS (SELECT c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size, SUM(ss_net_paid) AS netpaid FROM store_sales, store_returns, store, item, customer, customer_address WHERE ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = c_customer_sk AND ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND c_current_addr_sk = ca_address_sk AND c_birth_country <> UPPER(ca_country) AND s_zip = ca_zip AND s_market_id = 8 AND i_color = 'peach' GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size), ssales AS (SELECT c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size, SUM(ss_net_paid) AS netpaid FROM store_sales, store_returns, store, item, customer, customer_address WHERE ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = c_customer_sk AND ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND c_current_addr_sk = ca_address_sk AND c_birth_country <> UPPER(ca_country) AND s_zip = ca_zip AND s_market_id = 8 GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size)\nSELECT c_last_name, c_first_name, s_store_name, SUM(netpaid) AS paid FROM filtered_ssales GROUP BY c_last_name, c_first_name, s_store_name HAVING SUM(netpaid) > (SELECT 0.05 * avg_netpaid FROM total_avg) ORDER BY c_last_name, c_first_name, s_store_name",
          "prompt_tokens": 4301,
          "response_tokens": 872,
          "llm_time_ms": 153735.11362075806
        },
        {
          "worker_id": 1,
          "query_id": "q24",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH base_joins AS (SELECT c.c_last_name, c.c_first_name, s.s_store_name, ca.ca_state, s.s_state, i.i_color, i.i_current_price, i.i_manager_id, i.i_units, i.i_size, ss.ss_net_paid FROM store_sales AS ss JOIN store_returns AS sr ON ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk JOIN store AS s ON ss.ss_store_sk = s.s_store_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE s.s_market_id = 8 AND s.s_zip = ca.ca_zip AND c.c_birth_country <> UPPER(ca.ca_country)), ssales_with_color_filter AS (SELECT c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size, SUM(ss_net_paid) AS netpaid FROM base_joins WHERE i_color = 'peach' GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size), ssales_all_colors AS (SELECT c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size, SUM(ss_net_paid) AS netpaid FROM base_joins GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size), ssales AS (SELECT c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size, SUM(ss_net_paid) AS netpaid FROM store_sales, store_returns, store, item, customer, customer_address WHERE ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = c_customer_sk AND ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND c_current_addr_sk = ca_address_sk AND c_birth_country <> UPPER(ca_country) AND s_zip = ca_zip AND s_market_id = 8 GROUP BY c_last_name, c_first_name, s_store_name, ca_state, s_state, i_color, i_current_price, i_manager_id, i_units, i_size)\nSELECT c_last_name, c_first_name, s_store_name, SUM(netpaid) AS paid FROM ssales_with_color_filter GROUP BY c_last_name, c_first_name, s_store_name HAVING SUM(netpaid) > (SELECT 0.05 * AVG(netpaid) FROM ssales_all_colors) ORDER BY c_last_name, c_first_name, s_store_name",
          "prompt_tokens": 3088,
          "response_tokens": 547,
          "llm_time_ms": 177715.2180671692
        }
      ],
      "original_speedup": 0.87,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676254"
    },
    {
      "query_id": "q87",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q87",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), store_sales_set AS (SELECT DISTINCT c.c_last_name, c.c_first_name, fd.d_date FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk), catalog_sales_set AS (SELECT DISTINCT c.c_last_name, c.c_first_name, fd.d_date FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk), web_sales_set AS (SELECT DISTINCT c.c_last_name, c.c_first_name, fd.d_date FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk)\nSELECT COUNT(*) FROM ((SELECT * FROM store_sales_set) EXCEPT (SELECT * FROM catalog_sales_set) EXCEPT (SELECT * FROM web_sales_set)) AS cool_cust",
          "prompt_tokens": 3000,
          "response_tokens": 472,
          "llm_time_ms": 55551.00631713867
        },
        {
          "worker_id": 1,
          "query_id": "q87",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), store_sales_customers AS (SELECT DISTINCT c.c_last_name, c.c_first_name, fd.d_date FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk), catalog_sales_customers AS (SELECT DISTINCT c.c_last_name, c.c_first_name, fd.d_date FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk), web_sales_customers AS (SELECT DISTINCT c.c_last_name, c.c_first_name, fd.d_date FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk)\nSELECT COUNT(*) FROM ((SELECT * FROM store_sales_customers) EXCEPT (SELECT * FROM catalog_sales_customers) EXCEPT (SELECT * FROM web_sales_customers)) AS cool_cust",
          "prompt_tokens": 2853,
          "response_tokens": 1109,
          "llm_time_ms": 84840.96908569336
        },
        {
          "worker_id": 3,
          "query_id": "q87",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1211), store_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk), catalog_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk), web_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk)\nSELECT COUNT(*) FROM ((SELECT * FROM store_customers) EXCEPT (SELECT * FROM catalog_customers) EXCEPT (SELECT * FROM web_customers)) AS cool_cust",
          "prompt_tokens": 3017,
          "response_tokens": 1018,
          "llm_time_ms": 108406.39352798462
        },
        {
          "worker_id": 4,
          "query_id": "q87",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), store_sales_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk), catalog_sales_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN date_filter ON cs_sold_date_sk = d_date_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk), web_sales_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN date_filter ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk)\nSELECT COUNT(*) FROM ((SELECT * FROM store_sales_customers) EXCEPT (SELECT * FROM catalog_sales_customers) EXCEPT (SELECT * FROM web_sales_customers)) AS cool_cust",
          "prompt_tokens": 4064,
          "response_tokens": 1552,
          "llm_time_ms": 216735.178232193
        }
      ],
      "original_speedup": 0.86,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676261"
    },
    {
      "query_id": "q34",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q34",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter_1 AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 3 AND d_year IN (1999, 2000, 2001)), date_filter_2 AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 25 AND 28 AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_county = 'Williamson County'), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE (hd_buy_potential = '>10000' OR hd_buy_potential = 'Unknown') AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), store_sales_branch_1 AS (SELECT ss_ticket_number, ss_customer_sk FROM store_sales JOIN date_filter_1 ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk), store_sales_branch_2 AS (SELECT ss_ticket_number, ss_customer_sk FROM store_sales JOIN date_filter_2 ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk), aggregated_sales AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM (SELECT * FROM store_sales_branch_1 UNION ALL SELECT * FROM store_sales_branch_2) GROUP BY ss_ticket_number, ss_customer_sk)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM aggregated_sales AS dn JOIN customer AS c ON dn.ss_customer_sk = c.c_customer_sk WHERE cnt BETWEEN 15 AND 20 ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, c_salutation NULLS FIRST, c_preferred_cust_flag DESC NULLS FIRST, ss_ticket_number NULLS FIRST",
          "prompt_tokens": 2897,
          "response_tokens": 986,
          "llm_time_ms": 121544.1963672638
        },
        {
          "worker_id": 2,
          "query_id": "q34",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_dom_1_3 AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 3 AND d_year IN (1999, 2000, 2001)), filtered_dates_dom_25_28 AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 25 AND 28 AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_county = 'Williamson County'), filtered_hd_buy_potential_gt10000 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), filtered_hd_buy_potential_unknown AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = 'Unknown' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), store_sales_part1 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_dates_dom_1_3 AS dd1 ON ss.ss_sold_date_sk = dd1.d_date_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN filtered_hd_buy_potential_gt10000 AS hd1 ON ss.ss_hdemo_sk = hd1.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_dates_dom_1_3 AS dd1 ON ss.ss_sold_date_sk = dd1.d_date_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN filtered_hd_buy_potential_unknown AS hd2 ON ss.ss_hdemo_sk = hd2.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk), store_sales_part2 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_dates_dom_25_28 AS dd2 ON ss.ss_sold_date_sk = dd2.d_date_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN filtered_hd_buy_potential_gt10000 AS hd1 ON ss.ss_hdemo_sk = hd1.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_dates_dom_25_28 AS dd2 ON ss.ss_sold_date_sk = dd2.d_date_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN filtered_hd_buy_potential_unknown AS hd2 ON ss.ss_hdemo_sk = hd2.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk), dn AS (SELECT ss_ticket_number, ss_customer_sk, SUM(cnt) AS cnt FROM (SELECT ss_ticket_number, ss_customer_sk, cnt FROM store_sales_part1 UNION ALL SELECT ss_ticket_number, ss_customer_sk, cnt FROM store_sales_part2) AS t GROUP BY ss_ticket_number, ss_customer_sk)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM dn JOIN customer AS c ON dn.ss_customer_sk = c.c_customer_sk WHERE cnt BETWEEN 15 AND 20 ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, c_salutation NULLS FIRST, c_preferred_cust_flag DESC NULLS FIRST, ss_ticket_number NULLS FIRST",
          "prompt_tokens": 3043,
          "response_tokens": 1287,
          "llm_time_ms": 154781.36801719666
        },
        {
          "worker_id": 3,
          "query_id": "q34",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_county = 'Williamson County'), filtered_hh_dom_1_3 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), filtered_hh_dom_25_28 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = 'Unknown' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), filtered_dates_1_3 AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001) AND d_dom BETWEEN 1 AND 3), filtered_dates_25_28 AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001) AND d_dom BETWEEN 25 AND 28), branch_1_3 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_dates_1_3 ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hh_dom_1_3 ON ss_hdemo_sk = hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk), branch_25_28 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_dates_25_28 ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hh_dom_25_28 ON ss_hdemo_sk = hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM (SELECT ss_ticket_number, ss_customer_sk, cnt FROM branch_1_3 UNION ALL SELECT ss_ticket_number, ss_customer_sk, cnt FROM branch_25_28) AS dn JOIN customer ON ss_customer_sk = c_customer_sk WHERE cnt BETWEEN 15 AND 20 ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, c_salutation NULLS FIRST, c_preferred_cust_flag DESC NULLS FIRST, ss_ticket_number NULLS FIRST",
          "prompt_tokens": 3059,
          "response_tokens": 938,
          "llm_time_ms": 153596.7812538147
        },
        {
          "worker_id": 4,
          "query_id": "q34",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001) AND (d_dom BETWEEN 1 AND 3 OR d_dom BETWEEN 25 AND 28)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_county = 'Williamson County'), filtered_hd AS (SELECT hd_demo_sk, hd_buy_potential, hd_dep_count, hd_vehicle_count FROM household_demographics WHERE hd_vehicle_count > 0 AND (hd_buy_potential = '>10000' OR hd_buy_potential = 'Unknown') AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), store_sales_branch1 AS (SELECT ss_ticket_number, ss_customer_sk, 1 AS sales_count FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk WHERE d_dom BETWEEN 1 AND 3 AND hd_buy_potential = '>10000'), store_sales_branch2 AS (SELECT ss_ticket_number, ss_customer_sk, 1 AS sales_count FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk WHERE d_dom BETWEEN 1 AND 3 AND hd_buy_potential = 'Unknown'), store_sales_branch3 AS (SELECT ss_ticket_number, ss_customer_sk, 1 AS sales_count FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk WHERE d_dom BETWEEN 25 AND 28 AND hd_buy_potential = '>10000'), store_sales_branch4 AS (SELECT ss_ticket_number, ss_customer_sk, 1 AS sales_count FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk WHERE d_dom BETWEEN 25 AND 28 AND hd_buy_potential = 'Unknown'), combined_sales AS (SELECT ss_ticket_number, ss_customer_sk, SUM(sales_count) AS cnt FROM (SELECT * FROM store_sales_branch1 UNION ALL SELECT * FROM store_sales_branch2 UNION ALL SELECT * FROM store_sales_branch3 UNION ALL SELECT * FROM store_sales_branch4) AS all_sales GROUP BY ss_ticket_number, ss_customer_sk)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM combined_sales JOIN customer ON ss_customer_sk = c_customer_sk WHERE cnt BETWEEN 15 AND 20 ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, c_salutation NULLS FIRST, c_preferred_cust_flag DESC NULLS FIRST, ss_ticket_number NULLS FIRST",
          "prompt_tokens": 4112,
          "response_tokens": 901,
          "llm_time_ms": 158069.27943229675
        }
      ],
      "original_speedup": 0.8,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676267"
    },
    {
      "query_id": "q70",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q70",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), filtered_sales AS (SELECT ss_store_sk, ss_net_profit, s_state, s_county FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN store ON store_sales.ss_store_sk = store.s_store_sk), top_states AS (SELECT s_state FROM (SELECT s_state, RANK() OVER (ORDER BY SUM(ss_net_profit) DESC) AS ranking FROM filtered_sales GROUP BY s_state) AS ranked_states WHERE ranking <= 5)\nSELECT SUM(ss_net_profit) AS total_sum, s_state, s_county, GROUPING(s_state) + GROUPING(s_county) AS lochierarchy, RANK() OVER (PARTITION BY GROUPING(s_state) + GROUPING(s_county), CASE WHEN GROUPING(s_county) = 0 THEN s_state END ORDER BY SUM(ss_net_profit) DESC) AS rank_within_parent FROM filtered_sales WHERE s_state IN (SELECT s_state FROM top_states) GROUP BY ROLLUP (s_state, s_county) ORDER BY lochierarchy DESC, CASE WHEN GROUPING(s_state) + GROUPING(s_county) = 0 THEN s_state END, rank_within_parent LIMIT 100",
          "prompt_tokens": 2952,
          "response_tokens": 447,
          "llm_time_ms": 99233.86979103088
        },
        {
          "worker_id": 1,
          "query_id": "q70",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), filtered_sales AS (SELECT ss_net_profit, ss_store_sk, ss_sold_date_sk FROM store_sales), sales_with_date AS (SELECT fss.ss_net_profit, fss.ss_store_sk, s.s_state, s.s_county FROM filtered_sales AS fss JOIN date_range AS dr ON fss.ss_sold_date_sk = dr.d_date_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk), state_ranking AS (SELECT s_state, RANK() OVER (ORDER BY SUM(ss_net_profit) DESC) AS ranking FROM sales_with_date GROUP BY s_state), top_states AS (SELECT s_state FROM state_ranking WHERE ranking <= 5)\nSELECT SUM(ss_net_profit) AS total_sum, s_state, s_county, GROUPING(s_state) + GROUPING(s_county) AS lochierarchy, RANK() OVER (PARTITION BY GROUPING(s_state) + GROUPING(s_county), CASE WHEN GROUPING(s_county) = 0 THEN s_state END ORDER BY SUM(ss_net_profit) DESC) AS rank_within_parent FROM sales_with_date WHERE s_state IN (SELECT s_state FROM top_states) GROUP BY ROLLUP (s_state, s_county) ORDER BY lochierarchy DESC, CASE WHEN GROUPING(s_state) + GROUPING(s_county) = 0 THEN s_state END, rank_within_parent LIMIT 100",
          "prompt_tokens": 2805,
          "response_tokens": 980,
          "llm_time_ms": 117553.08866500854
        },
        {
          "worker_id": 3,
          "query_id": "q70",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11)\nSELECT SUM(ss_net_profit) AS total_sum, s_state, s_county, GROUPING(s_state) + GROUPING(s_county) AS lochierarchy, RANK() OVER (PARTITION BY GROUPING(s_state) + GROUPING(s_county), CASE WHEN GROUPING(s_county) = 0 THEN s_state END ORDER BY SUM(ss_net_profit) DESC) AS rank_within_parent FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk JOIN store ON s_store_sk = ss_store_sk WHERE s_state IN (SELECT s_state FROM (SELECT s_state AS s_state, RANK() OVER (PARTITION BY s_state ORDER BY SUM(ss_net_profit) DESC) AS ranking FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk JOIN store ON s_store_sk = ss_store_sk GROUP BY s_state) AS tmp1 WHERE ranking <= 5) GROUP BY ROLLUP (s_state, s_county) ORDER BY lochierarchy DESC, CASE WHEN GROUPING(s_state) + GROUPING(s_county) = 0 THEN s_state END, rank_within_parent LIMIT 100",
          "prompt_tokens": 2969,
          "response_tokens": 760,
          "llm_time_ms": 115943.61710548401
        },
        {
          "worker_id": 4,
          "query_id": "q70",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1211), filtered_sales AS (SELECT ss_net_profit, ss_store_sk, ss_sold_date_sk FROM store_sales), state_ranking AS (SELECT s_state, RANK() OVER (ORDER BY SUM(ss_net_profit) DESC) AS ranking FROM filtered_sales JOIN store ON s_store_sk = ss_store_sk JOIN date_filter ON d_date_sk = ss_sold_date_sk GROUP BY s_state), top_states AS (SELECT s_state FROM state_ranking WHERE ranking <= 5)\nSELECT SUM(ss_net_profit) AS total_sum, s_state, s_county, GROUPING(s_state) + GROUPING(s_county) AS lochierarchy, RANK() OVER (PARTITION BY GROUPING(s_state) + GROUPING(s_county), CASE WHEN GROUPING(s_county) = 0 THEN s_state END ORDER BY SUM(ss_net_profit) DESC) AS rank_within_parent FROM filtered_sales JOIN store ON s_store_sk = ss_store_sk JOIN date_filter ON d_date_sk = ss_sold_date_sk WHERE s_state IN (SELECT s_state FROM top_states) GROUP BY ROLLUP (s_state, s_county) ORDER BY lochierarchy DESC, CASE WHEN GROUPING(s_state) + GROUPING(s_county) = 0 THEN s_state END, rank_within_parent LIMIT 100",
          "prompt_tokens": 4021,
          "response_tokens": 976,
          "llm_time_ms": 164332.65256881714
        }
      ],
      "original_speedup": 0.75,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676272"
    },
    {
      "query_id": "q89",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q89",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), branch1 AS (SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, ss_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk WHERE i_category IN ('Books', 'Electronics', 'Sports') AND i_class IN ('computers', 'stereo', 'football')), branch2 AS (SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, ss_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk WHERE i_category IN ('Men', 'Jewelry', 'Women') AND i_class IN ('shirts', 'birdal', 'dresses')), combined_sales AS (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2)\nSELECT * FROM (SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name) AS avg_monthly_sales FROM combined_sales GROUP BY i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) AS tmp1 WHERE CASE WHEN (avg_monthly_sales <> 0) THEN (ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales) ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales, s_store_name, 1, 2, 3, 5, 6, 7, 8 LIMIT 100",
          "prompt_tokens": 4087,
          "response_tokens": 575,
          "llm_time_ms": 69264.80865478516
        },
        {
          "worker_id": 3,
          "query_id": "q89",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 1999), filtered_sales AS (SELECT ss_item_sk, ss_store_sk, ss_sales_price, d_moy FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk), filtered_items AS (SELECT i_item_sk, i_category, i_class, i_brand FROM item WHERE (i_category IN ('Books', 'Electronics', 'Sports') AND i_class IN ('computers', 'stereo', 'football')) OR (i_category IN ('Men', 'Jewelry', 'Women') AND i_class IN ('shirts', 'birdal', 'dresses')))\nSELECT * FROM (SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name) AS avg_monthly_sales FROM filtered_items JOIN filtered_sales ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk GROUP BY i_category, i_class, i_brand, s_store_name, s_company_name, d_moy) AS tmp1 WHERE CASE WHEN (avg_monthly_sales <> 0) THEN (ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales) ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales, s_store_name, i_category, i_class, i_brand, s_company_name, d_moy, sum_sales, avg_monthly_sales LIMIT 100",
          "prompt_tokens": 3035,
          "response_tokens": 686,
          "llm_time_ms": 107157.32479095459
        },
        {
          "worker_id": 1,
          "query_id": "q89",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), store_filter AS (SELECT s_store_sk, s_store_name, s_company_name FROM store), item_branch1 AS (SELECT i_item_sk, i_category, i_class, i_brand FROM item WHERE i_category IN ('Books', 'Electronics', 'Sports') AND i_class IN ('computers', 'stereo', 'football')), item_branch2 AS (SELECT i_item_sk, i_category, i_class, i_brand FROM item WHERE i_category IN ('Men', 'Jewelry', 'Women') AND i_class IN ('shirts', 'birdal', 'dresses')), branch1_sales AS (SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, SUM(ss_sales_price) AS sum_sales FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN item_branch1 ON ss_item_sk = i_item_sk JOIN store_filter ON ss_store_sk = s_store_sk GROUP BY i_category, i_class, i_brand, s_store_name, s_company_name, d_moy), branch2_sales AS (SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, SUM(ss_sales_price) AS sum_sales FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN item_branch2 ON ss_item_sk = i_item_sk JOIN store_filter ON ss_store_sk = s_store_sk GROUP BY i_category, i_class, i_brand, s_store_name, s_company_name, d_moy), combined_sales AS (SELECT * FROM branch1_sales UNION ALL SELECT * FROM branch2_sales)\nSELECT * FROM (SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum_sales, AVG(sum_sales) OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name) AS avg_monthly_sales FROM combined_sales) AS tmp1 WHERE CASE WHEN (avg_monthly_sales <> 0) THEN (ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales) ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales, s_store_name, 1, 2, 3, 5, 6, 7, 8 LIMIT 100",
          "prompt_tokens": 2871,
          "response_tokens": 635,
          "llm_time_ms": 122769.13928985596
        },
        {
          "worker_id": 2,
          "query_id": "q89",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 1999), filtered_store_sales AS (SELECT ss_item_sk, ss_store_sk, ss_sales_price, d_moy FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk), branch1 AS (SELECT i.i_category, i.i_class, i.i_brand, s.s_store_name, s.s_company_name, fss.d_moy, SUM(fss.ss_sales_price) AS sum_sales, AVG(SUM(fss.ss_sales_price)) OVER (PARTITION BY i.i_category, i.i_brand, s.s_store_name, s.s_company_name) AS avg_monthly_sales FROM filtered_store_sales AS fss JOIN item AS i ON fss.ss_item_sk = i.i_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk WHERE i.i_category IN ('Books', 'Electronics', 'Sports') AND i.i_class IN ('computers', 'stereo', 'football') GROUP BY i.i_category, i.i_class, i.i_brand, s.s_store_name, s.s_company_name, fss.d_moy), branch2 AS (SELECT i.i_category, i.i_class, i.i_brand, s.s_store_name, s.s_company_name, fss.d_moy, SUM(fss.ss_sales_price) AS sum_sales, AVG(SUM(fss.ss_sales_price)) OVER (PARTITION BY i.i_category, i.i_brand, s.s_store_name, s.s_company_name) AS avg_monthly_sales FROM filtered_store_sales AS fss JOIN item AS i ON fss.ss_item_sk = i.i_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk WHERE i.i_category IN ('Men', 'Jewelry', 'Women') AND i.i_class IN ('shirts', 'birdal', 'dresses') GROUP BY i.i_category, i.i_class, i.i_brand, s.s_store_name, s.s_company_name, fss.d_moy)\nSELECT * FROM (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2) AS tmp1 WHERE CASE WHEN (avg_monthly_sales <> 0) THEN (ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales) ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales, s_store_name, 1, 2, 3, 5, 6, 7, 8 LIMIT 100",
          "prompt_tokens": 3018,
          "response_tokens": 650,
          "llm_time_ms": 182618.3159351349
        }
      ],
      "original_speedup": 0.6,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676275"
    },
    {
      "query_id": "q53",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q53",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_qoy FROM date_dim WHERE d_month_seq IN (1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)), filtered_store_sales AS (SELECT ss_item_sk, ss_store_sk, ss_sales_price, d_qoy FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk), item_branch1 AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')), item_branch2 AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')), joined_branch1 AS (SELECT fss.d_qoy, i.i_manufact_id, fss.ss_sales_price, s.s_store_sk FROM filtered_store_sales AS fss JOIN item_branch1 AS i ON fss.ss_item_sk = i.i_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk), joined_branch2 AS (SELECT fss.d_qoy, i.i_manufact_id, fss.ss_sales_price, s.s_store_sk FROM filtered_store_sales AS fss JOIN item_branch2 AS i ON fss.ss_item_sk = i.i_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk), all_sales AS (SELECT d_qoy, i_manufact_id, ss_sales_price FROM joined_branch1 UNION ALL SELECT d_qoy, i_manufact_id, ss_sales_price FROM joined_branch2), grouped_sales AS (SELECT i_manufact_id, d_qoy, SUM(ss_sales_price) AS sum_sales FROM all_sales GROUP BY i_manufact_id, d_qoy), windowed_sales AS (SELECT i_manufact_id, d_qoy, sum_sales, AVG(sum_sales) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM grouped_sales)\nSELECT i_manufact_id, sum_sales, avg_quarterly_sales FROM windowed_sales WHERE CASE WHEN avg_quarterly_sales > 0 THEN ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales ELSE NULL END > 0.1 ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100",
          "prompt_tokens": 3012,
          "response_tokens": 706,
          "llm_time_ms": 102997.78580665588
        },
        {
          "worker_id": 4,
          "query_id": "q53",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_qoy FROM date_dim WHERE d_month_seq IN (1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)), filtered_stores AS (SELECT s_store_sk FROM store), branch1_sales AS (SELECT i.i_manufact_id, d.d_qoy, ss.ss_sales_price FROM store_sales AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk JOIN filtered_stores AS s ON ss.ss_store_sk = s.s_store_sk WHERE i.i_category IN ('Books', 'Children', 'Electronics') AND i.i_class IN ('personal', 'portable', 'reference', 'self-help') AND i.i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')), branch2_sales AS (SELECT i.i_manufact_id, d.d_qoy, ss.ss_sales_price FROM store_sales AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk JOIN filtered_stores AS s ON ss.ss_store_sk = s.s_store_sk WHERE i.i_category IN ('Women', 'Music', 'Men') AND i.i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i.i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')), combined_sales AS (SELECT * FROM branch1_sales UNION ALL SELECT * FROM branch2_sales), grouped_results AS (SELECT i_manufact_id, d_qoy, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM combined_sales GROUP BY i_manufact_id, d_qoy)\nSELECT * FROM grouped_results WHERE CASE WHEN avg_quarterly_sales > 0 THEN ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales ELSE NULL END > 0.1 ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100",
          "prompt_tokens": 4086,
          "response_tokens": 618,
          "llm_time_ms": 113341.10260009766
        },
        {
          "worker_id": 1,
          "query_id": "q53",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_qoy FROM date_dim WHERE d_month_seq IN (1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211))\nSELECT * FROM (SELECT i_manufact_id, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM item, store_sales, filtered_dates, store WHERE ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND ss_store_sk = s_store_sk AND ((i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')) OR (i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1'))) GROUP BY i_manufact_id, d_qoy) AS tmp1 WHERE CASE WHEN avg_quarterly_sales > 0 THEN ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales ELSE NULL END > 0.1 ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100",
          "prompt_tokens": 2866,
          "response_tokens": 1420,
          "llm_time_ms": 135763.63039016724
        },
        {
          "worker_id": 3,
          "query_id": "q53",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_qoy FROM date_dim WHERE d_month_seq IN (1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)), filtered_sales AS (SELECT ss_item_sk, ss_store_sk, ss_sales_price, d_qoy FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk)\nSELECT i_manufact_id, sum_sales, avg_quarterly_sales FROM (SELECT i_manufact_id, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM item JOIN filtered_sales ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk WHERE ((i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')) OR (i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1'))) GROUP BY i_manufact_id, d_qoy) AS tmp1 WHERE CASE WHEN avg_quarterly_sales > 0 THEN ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales ELSE NULL END > 0.1 ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100",
          "prompt_tokens": 3029,
          "response_tokens": 1108,
          "llm_time_ms": 191110.27359962463
        }
      ],
      "original_speedup": 0.51,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676279"
    },
    {
      "query_id": "q61",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q61",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH promo_filtered AS (SELECT p_promo_sk FROM promotion WHERE p_channel_dmail = 'Y' OR p_channel_email = 'Y' OR p_channel_tv = 'Y'), base_sales AS (SELECT ss_ext_sales_price, ss_promo_sk FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN filtered_customer_address ON ca_address_sk = c_current_addr_sk JOIN filtered_item ON ss_item_sk = i_item_sk) SELECT (SELECT SUM(ss_ext_sales_price) FROM base_sales WHERE ss_promo_sk IN (SELECT p_promo_sk FROM promo_filtered)) AS promotions, (SELECT SUM(ss_ext_sales_price) FROM base_sales) AS total, CAST((SELECT SUM(ss_ext_sales_price) FROM base_sales WHERE ss_promo_sk IN (SELECT p_promo_sk FROM promo_filtered)) AS DECIMAL(15, 4)) / CAST((SELECT SUM(ss_ext_sales_price) FROM base_sales) AS DECIMAL(15, 4)) * 100 ORDER BY promotions, total LIMIT 100",
          "prompt_tokens": 3130,
          "response_tokens": 568,
          "llm_time_ms": 72995.85318565369
        },
        {
          "worker_id": 2,
          "query_id": "q61",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_gmt_offset = -5), filtered_items AS (SELECT i_item_sk FROM item WHERE i_category = 'Jewelry'), base_sales AS (SELECT ss_ext_sales_price, ss_promo_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN filtered_items ON ss_item_sk = i_item_sk), promotional_sales AS (SELECT SUM(ss_ext_sales_price) AS promotions FROM base_sales AS bs JOIN customer AS c ON bs.ss_customer_sk = c.c_customer_sk JOIN filtered_addresses AS ca ON ca.ca_address_sk = c.c_current_addr_sk JOIN promotion AS p ON bs.ss_promo_sk = p.p_promo_sk WHERE p_channel_dmail = 'Y' OR p_channel_email = 'Y' OR p_channel_tv = 'Y'), all_sales AS (SELECT SUM(ss_ext_sales_price) AS total FROM base_sales AS bs JOIN customer AS c ON bs.ss_customer_sk = c.c_customer_sk JOIN filtered_addresses AS ca ON ca.ca_address_sk = c.c_current_addr_sk)\nSELECT promotions, total, CAST(promotions AS DECIMAL(15, 4)) / CAST(total AS DECIMAL(15, 4)) * 100 FROM promotional_sales, all_sales ORDER BY promotions, total LIMIT 100",
          "prompt_tokens": 3116,
          "response_tokens": 1008,
          "llm_time_ms": 139777.62150764465
        },
        {
          "worker_id": 1,
          "query_id": "q61",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), item_filter AS (SELECT i_item_sk FROM item WHERE i_category = 'Jewelry'), store_filter AS (SELECT s_store_sk FROM store WHERE s_gmt_offset = -5), address_filter AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), promotion_filter_dmail AS (SELECT p_promo_sk FROM promotion WHERE p_channel_dmail = 'Y'), promotion_filter_email AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'Y'), promotion_filter_tv AS (SELECT p_promo_sk FROM promotion WHERE p_channel_tv = 'Y'), base_sales AS (SELECT ss_ext_sales_price, ss_promo_sk, ss_customer_sk, ss_item_sk, ss_store_sk, ss_sold_date_sk FROM store_sales), promotional_sales AS (SELECT SUM(ss_ext_sales_price) AS promotions FROM base_sales AS bs JOIN date_filter AS df ON bs.ss_sold_date_sk = df.d_date_sk JOIN store_filter AS sf ON bs.ss_store_sk = sf.s_store_sk JOIN item_filter AS itf ON bs.ss_item_sk = itf.i_item_sk JOIN customer AS c ON bs.ss_customer_sk = c.c_customer_sk JOIN address_filter AS af ON c.c_current_addr_sk = af.ca_address_sk WHERE bs.ss_promo_sk IN (SELECT p_promo_sk FROM promotion_filter_dmail UNION SELECT p_promo_sk FROM promotion_filter_email UNION SELECT p_promo_sk FROM promotion_filter_tv)), all_sales AS (SELECT SUM(ss_ext_sales_price) AS total FROM base_sales AS bs JOIN date_filter AS df ON bs.ss_sold_date_sk = df.d_date_sk JOIN store_filter AS sf ON bs.ss_store_sk = sf.s_store_sk JOIN item_filter AS itf ON bs.ss_item_sk = itf.i_item_sk JOIN customer AS c ON bs.ss_customer_sk = c.c_customer_sk JOIN address_filter AS af ON c.c_current_addr_sk = af.ca_address_sk)\nSELECT ps.promotions, als.total, CAST(ps.promotions AS DECIMAL(15, 4)) / CAST(als.total AS DECIMAL(15, 4)) * 100 FROM promotional_sales AS ps CROSS JOIN all_sales AS als ORDER BY ps.promotions, als.total LIMIT 100",
          "prompt_tokens": 2966,
          "response_tokens": 698,
          "llm_time_ms": 189253.22651863098
        },
        {
          "worker_id": 4,
          "query_id": "q61",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), filtered_stores AS (SELECT s_store_sk, s_gmt_offset FROM store WHERE s_gmt_offset = -5), filtered_addresses AS (SELECT ca_address_sk, ca_gmt_offset FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_sk FROM item WHERE i_category = 'Jewelry'), common_sales AS (SELECT ss_ext_sales_price, ss_promo_sk, ss_store_sk, ss_customer_sk, ss_item_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN filtered_addresses ON ss_customer_sk IN (SELECT c_customer_sk FROM customer WHERE c_current_addr_sk = ca_address_sk) JOIN filtered_items ON ss_item_sk = i_item_sk), promotional_sales AS (SELECT SUM(ss_ext_sales_price) AS promotions FROM common_sales AS cs JOIN promotion AS p ON cs.ss_promo_sk = p.p_promo_sk WHERE p_channel_dmail = 'Y' OR p_channel_email = 'Y' OR p_channel_tv = 'Y'), all_sales AS (SELECT SUM(ss_ext_sales_price) AS total FROM common_sales)\nSELECT promotions, total, CAST(promotions AS DECIMAL(15, 4)) / CAST(total AS DECIMAL(15, 4)) * 100 FROM promotional_sales, all_sales ORDER BY promotions, total LIMIT 100",
          "prompt_tokens": 4186,
          "response_tokens": 1029,
          "llm_time_ms": 227984.19332504272
        }
      ],
      "original_speedup": 0.4,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676285"
    },
    {
      "query_id": "q32",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q32",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE))\nSELECT SUM(cs_ext_discount_amt) AS \"excess discount amount\" FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN item ON i_item_sk = cs_item_sk WHERE i_manufact_id = 977 AND cs_ext_discount_amt > (SELECT 1.3 * AVG(cs_ext_discount_amt) FROM catalog_sales AS cs2 JOIN filtered_dates AS fd2 ON cs2.cs_sold_date_sk = fd2.d_date_sk WHERE cs2.cs_item_sk = i_item_sk) LIMIT 100",
          "prompt_tokens": 4067,
          "response_tokens": 716,
          "llm_time_ms": 64008.39877128601
        },
        {
          "worker_id": 3,
          "query_id": "q32",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), item_avg_discount AS (SELECT cs_item_sk, 1.3 * AVG(cs_ext_discount_amt) AS threshold FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk GROUP BY cs_item_sk)\nSELECT SUM(cs_ext_discount_amt) AS \"excess discount amount\" FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN item_avg_discount AS iad ON catalog_sales.cs_item_sk = iad.cs_item_sk WHERE i_manufact_id = 977 AND cs_ext_discount_amt > iad.threshold LIMIT 100",
          "prompt_tokens": 3012,
          "response_tokens": 357,
          "llm_time_ms": 70014.45174217224
        },
        {
          "worker_id": 1,
          "query_id": "q32",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), manufacturer_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id = 977), catalog_sales_filtered AS (SELECT cs_item_sk, cs_ext_discount_amt FROM catalog_sales WHERE cs_sold_date_sk IN (SELECT d_date_sk FROM date_range)), item_avg_discount AS (SELECT cs_item_sk, 1.3 * AVG(cs_ext_discount_amt) AS avg_threshold FROM catalog_sales_filtered GROUP BY cs_item_sk)\nSELECT SUM(cs.cs_ext_discount_amt) AS \"excess discount amount\" FROM catalog_sales_filtered AS cs JOIN manufacturer_items AS mi ON cs.cs_item_sk = mi.i_item_sk JOIN item_avg_discount AS avg ON cs.cs_item_sk = avg.cs_item_sk WHERE cs.cs_ext_discount_amt > avg.avg_threshold LIMIT 100",
          "prompt_tokens": 2848,
          "response_tokens": 361,
          "llm_time_ms": 80717.91815757751
        },
        {
          "worker_id": 2,
          "query_id": "q32",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), filtered_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id = 977), catalog_sales_with_dates AS (SELECT cs_item_sk, cs_ext_discount_amt FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = filtered_dates.d_date_sk), item_avg_discount AS (SELECT cs_item_sk, 1.3 * AVG(cs_ext_discount_amt) AS threshold_avg FROM catalog_sales_with_dates GROUP BY cs_item_sk)\nSELECT SUM(cs.cs_ext_discount_amt) AS \"excess discount amount\" FROM catalog_sales_with_dates AS cs JOIN filtered_items AS i ON cs.cs_item_sk = i.i_item_sk JOIN item_avg_discount AS avgd ON cs.cs_item_sk = avgd.cs_item_sk WHERE cs.cs_ext_discount_amt > avgd.threshold_avg LIMIT 100",
          "prompt_tokens": 2992,
          "response_tokens": 371,
          "llm_time_ms": 89286.5846157074
        }
      ],
      "original_speedup": 0.27,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676288"
    },
    {
      "query_id": "q94",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q94",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-02-01' AND CAST('1999-04-02' AS DATE)), filtered_customer AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'IL'), filtered_website AS (SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'), multi_warehouse_orders AS (SELECT DISTINCT ws_order_number FROM web_sales AS ws2 GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1), returned_orders AS (SELECT DISTINCT wr_order_number FROM web_returns)\nSELECT COUNT(DISTINCT ws_order_number) AS \"order count\", SUM(ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws_net_profit) AS \"total net profit\" FROM web_sales AS ws1 JOIN filtered_date ON ws1.ws_ship_date_sk = filtered_date.d_date_sk JOIN filtered_customer ON ws1.ws_ship_addr_sk = filtered_customer.ca_address_sk JOIN filtered_website ON ws1.ws_web_site_sk = filtered_website.web_site_sk JOIN multi_warehouse_orders AS mwo ON ws1.ws_order_number = mwo.ws_order_number LEFT JOIN returned_orders AS ro ON ws1.ws_order_number = ro.wr_order_number WHERE ro.wr_order_number IS NULL GROUP BY () ORDER BY COUNT(DISTINCT ws_order_number) LIMIT 100",
          "prompt_tokens": 2904,
          "response_tokens": 504,
          "llm_time_ms": 72026.22866630554
        },
        {
          "worker_id": 2,
          "query_id": "q94",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-02-01' AND CAST('1999-04-02' AS DATE)), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'IL'), filtered_website AS (SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'), multi_warehouse_orders AS (SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1), returned_orders AS (SELECT DISTINCT wr_order_number FROM web_returns), filtered_web_sales AS (SELECT ws1.ws_order_number, ws1.ws_ext_ship_cost, ws1.ws_net_profit FROM web_sales AS ws1 JOIN filtered_dates ON ws1.ws_ship_date_sk = filtered_dates.d_date_sk JOIN filtered_address ON ws1.ws_ship_addr_sk = filtered_address.ca_address_sk JOIN filtered_website ON ws1.ws_web_site_sk = filtered_website.web_site_sk)\nSELECT COUNT(DISTINCT fws.ws_order_number) AS \"order count\", SUM(fws.ws_ext_ship_cost) AS \"total shipping cost\", SUM(fws.ws_net_profit) AS \"total net profit\" FROM filtered_web_sales AS fws JOIN multi_warehouse_orders AS mwo ON fws.ws_order_number = mwo.ws_order_number LEFT JOIN returned_orders AS ro ON fws.ws_order_number = ro.wr_order_number WHERE ro.wr_order_number IS NULL ORDER BY COUNT(DISTINCT fws.ws_order_number) LIMIT 100",
          "prompt_tokens": 2888,
          "response_tokens": 577,
          "llm_time_ms": 88959.42664146423
        },
        {
          "worker_id": 1,
          "query_id": "q94",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-02-01' AND CAST('1999-04-02' AS DATE)), filtered_ca AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'IL'), filtered_web_site AS (SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'), multi_warehouse_orders AS (SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1), returned_orders AS (SELECT DISTINCT wr_order_number FROM web_returns), filtered_ws AS (SELECT ws_order_number, ws_ext_ship_cost, ws_net_profit FROM web_sales AS ws1 JOIN date_range AS dr ON ws1.ws_ship_date_sk = dr.d_date_sk JOIN filtered_ca AS ca ON ws1.ws_ship_addr_sk = ca.ca_address_sk JOIN filtered_web_site AS ws ON ws1.ws_web_site_sk = ws.web_site_sk)\nSELECT COUNT(DISTINCT fws.ws_order_number) AS \"order count\", SUM(fws.ws_ext_ship_cost) AS \"total shipping cost\", SUM(fws.ws_net_profit) AS \"total net profit\" FROM filtered_ws AS fws JOIN multi_warehouse_orders AS mwo ON fws.ws_order_number = mwo.ws_order_number LEFT JOIN returned_orders AS ro ON fws.ws_order_number = ro.wr_order_number WHERE ro.wr_order_number IS NULL ORDER BY COUNT(DISTINCT fws.ws_order_number) LIMIT 100",
          "prompt_tokens": 2740,
          "response_tokens": 490,
          "llm_time_ms": 103083.25982093811
        },
        {
          "worker_id": 4,
          "query_id": "q94",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-02-01' AND CAST('1999-04-02' AS DATE)), filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'IL'), filtered_web_site AS (SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'), filtered_web_sales AS (SELECT ws1.ws_order_number, ws1.ws_ext_ship_cost, ws1.ws_net_profit, ws1.ws_warehouse_sk FROM web_sales AS ws1 JOIN filtered_dates ON ws1.ws_ship_date_sk = filtered_dates.d_date_sk JOIN filtered_customer_address ON ws1.ws_ship_addr_sk = filtered_customer_address.ca_address_sk JOIN filtered_web_site ON ws1.ws_web_site_sk = filtered_web_site.web_site_sk), multi_warehouse_orders AS (SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1), orders_with_returns AS (SELECT DISTINCT wr_order_number FROM web_returns)\nSELECT COUNT(DISTINCT fws.ws_order_number) AS \"order count\", SUM(fws.ws_ext_ship_cost) AS \"total shipping cost\", SUM(fws.ws_net_profit) AS \"total net profit\" FROM filtered_web_sales AS fws JOIN multi_warehouse_orders AS mwo ON fws.ws_order_number = mwo.ws_order_number LEFT JOIN orders_with_returns AS owr ON fws.ws_order_number = owr.wr_order_number WHERE owr.wr_order_number IS NULL GROUP BY () ORDER BY COUNT(DISTINCT fws.ws_order_number) LIMIT 100",
          "prompt_tokens": 3957,
          "response_tokens": 1155,
          "llm_time_ms": 156265.8452987671
        }
      ],
      "original_speedup": 0.24,
      "improvement": 0.0,
      "timestamp": "2026-02-06T08:29:43.676293"
    }
  ]
}