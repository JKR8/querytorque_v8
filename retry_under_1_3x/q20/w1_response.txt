```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_date_dim": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)",
        "filtered_item": "SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')",
        "catalog_sales_joined": "SELECT cs.cs_ext_sales_price, i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price FROM catalog_sales cs JOIN filtered_item i ON cs.cs_item_sk = i.i_item_sk JOIN filtered_date_dim d ON cs.cs_sold_date_sk = d.d_date_sk",
        "main_query": "SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(cs_ext_sales_price) AS itemrevenue, SUM(cs_ext_sales_price) * 100.0000 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM catalog_sales_joined GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "output columns unchanged",
        "grain preserved"
      ],
      "expected_speedup": "3.5x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filter into a CTE that selects only 31 date keys (vs scanning 73,049 rows). Also pushed item filter early to reduce dimension table rows from 102,000 to only categories needed. This allows the large catalog_sales table to join with pre-filtered small dimension tables instead of scanning full tables and filtering later."
}
```