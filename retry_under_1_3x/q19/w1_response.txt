```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_date": "SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1998",
        "filtered_item": "SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_manager_id = 8",
        "filtered_store": "SELECT s_store_sk, s_zip FROM store",
        "filtered_customer": "SELECT c_customer_sk, c_current_addr_sk FROM customer",
        "filtered_address": "SELECT ca_address_sk, ca_zip FROM customer_address",
        "early_join": "SELECT ss.ss_item_sk, ss.ss_customer_sk, ss.ss_store_sk, ss.ss_ext_sales_price, i.i_brand_id, i.i_brand, i.i_manufact_id, i.i_manufact, ca.ca_zip, s.s_zip FROM store_sales ss JOIN filtered_date fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_item i ON ss.ss_item_sk = i.i_item_sk JOIN filtered_customer c ON ss.ss_customer_sk = c.c_customer_sk JOIN filtered_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN filtered_store s ON ss.ss_store_sk = s.s_store_sk",
        "main_query": "SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM early_join WHERE SUBSTRING(ca_zip, 1, 5) <> SUBSTRING(s_zip, 1, 5) GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same output columns",
        "same grouping grain",
        "same ordering"
      ],
      "expected_speedup": "3.50x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filter into CTE (reduces from 73,049 to 30 rows early). Isolated item filter into CTE (reduces from 102,000 to 1,836 rows). Pushed all dimension table filters BEFORE joining with large fact table store_sales (345M rows). The zip comparison is deferred until after dimension joins complete. This reduces the fact table join from 6-way to sequential 2-way joins with pre-filtered dimension CTEs, dramatically reducing intermediate result size."
}
```