```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11",
        "customer_filtered_address": "SELECT ca_address_sk, ca_gmt_offset FROM customer_address WHERE ca_gmt_offset = -7",
        "customer_filtered_household": "SELECT hd_demo_sk, hd_buy_potential FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%'",
        "branch1_returns": "SELECT cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status, cr_net_loss FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_filtered_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Unknown' JOIN customer_filtered_household ON hd_demo_sk = c_current_hdemo_sk JOIN call_center ON cr_call_center_sk = cc_call_center_sk",
        "branch2_returns": "SELECT cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status, cr_net_loss FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_filtered_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk AND cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' JOIN customer_filtered_household ON hd_demo_sk = c_current_hdemo_sk JOIN call_center ON cr_call_center_sk = cc_call_center_sk",
        "main_query": "SELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM (SELECT * FROM branch1_returns UNION ALL SELECT * FROM branch2_returns) all_returns GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC"
      },
      "invariants_kept": [
        "output columns unchanged",
        "same grouping keys",
        "same result rows",
        "same ordering by sum"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11",
        "filtered_customer": "SELECT c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk FROM customer",
        "filtered_household": "SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%'",
        "filtered_address": "SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7",
        "joined_data": "SELECT cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status, cr_net_loss FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN filtered_customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN filtered_household ON hd_demo_sk = c_current_hdemo_sk JOIN filtered_address ON ca_address_sk = c_current_addr_sk JOIN call_center ON cr_call_center_sk = cc_call_center_sk WHERE (cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')",
        "main_query": "SELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM joined_data GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC"
      },
      "invariants_kept": [
        "same result values",
        "same column output",
        "same grouping semantics"
      ],
      "expected_speedup": "1.8x",
      "risk": "low"
    }
  ],
  "explanation": "Applied two complementary optimizations: 1) OR_TO_UNION to split the OR condition on customer_demographics into two separate branches, allowing each branch to use more selective indexes and avoid the misestimated filter. 2) DATE_CTE_ISOLATION to extract date_dim filter into a CTE, reducing the date_dim scan from 73,049 rows to 30 rows early in the plan. Both rewrites reduce unnecessary table scans and improve join selectivity."
}
```