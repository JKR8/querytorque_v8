```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9",
        "filtered_items": "SELECT i_item_id, i_item_sk FROM item WHERE i_category = 'Music'",
        "filtered_address": "SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5",
        "ss": "SELECT i.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales ss JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items i ON ss.ss_item_sk = i.i_item_sk JOIN filtered_address fa ON ss.ss_addr_sk = fa.ca_address_sk GROUP BY i.i_item_id",
        "ws": "SELECT i.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales ws JOIN filtered_dates fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_items i ON ws.ws_item_sk = i.i_item_sk JOIN filtered_address fa ON ws.ws_bill_addr_sk = fa.ca_address_sk GROUP BY i.i_item_id"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (i_item_id)",
        "same aggregation semantics"
      ],
      "expected_speedup": "3x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "pushdown",
      "nodes": {
        "main_query": "SELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT i_item_id, total_sales FROM ss UNION ALL SELECT i_item_id, total_sales FROM cs UNION ALL SELECT i_item_id, total_sales FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same ordering and limit",
        "same final aggregation"
      ],
      "expected_speedup": "1.1x",
      "risk": "low"
    }
  ],
  "explanation": "Extracted date_dim, item, and customer_address filters into shared CTEs to avoid redundant scans. The date_dim CTE reduces 73,049 rows to 30 rows early. The item CTE isolates the Music category filter (repeated 6 times in original). The address CTE filters by gmt_offset once. Each fact table (store_sales, web_sales) now joins to these pre-filtered dimension CTEs, reducing join cardinality and eliminating repeated subqueries."
}
```