```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "date_filter": "SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999",
        "time_breakfast": "SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time = 'breakfast'",
        "time_dinner": "SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time = 'dinner'",
        "web_sales_union": "SELECT ws_ext_sales_price AS ext_price, ws_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM web_sales ws JOIN date_filter df ON ws.ws_sold_date_sk = df.d_date_sk JOIN time_breakfast t ON ws.ws_sold_time_sk = t.t_time_sk UNION ALL SELECT ws_ext_sales_price AS ext_price, ws_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM web_sales ws JOIN date_filter df ON ws.ws_sold_date_sk = df.d_date_sk JOIN time_dinner t ON ws.ws_sold_time_sk = t.t_time_sk",
        "catalog_sales_union": "SELECT cs_ext_sales_price AS ext_price, cs_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM catalog_sales cs JOIN date_filter df ON cs.cs_sold_date_sk = df.d_date_sk JOIN time_breakfast t ON cs.cs_sold_time_sk = t.t_time_sk UNION ALL SELECT cs_ext_sales_price AS ext_price, cs_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM catalog_sales cs JOIN date_filter df ON cs.cs_sold_date_sk = df.d_date_sk JOIN time_dinner t ON cs.cs_sold_time_sk = t.t_time_sk",
        "store_sales_union": "SELECT ss_ext_sales_price AS ext_price, ss_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM store_sales ss JOIN date_filter df ON ss.ss_sold_date_sk = df.d_date_sk JOIN time_breakfast t ON ss.ss_sold_time_sk = t.t_time_sk UNION ALL SELECT ss_ext_sales_price AS ext_price, ss_item_sk AS sold_item_sk, t.t_hour, t.t_minute FROM store_sales ss JOIN date_filter df ON ss.ss_sold_date_sk = df.d_date_sk JOIN time_dinner t ON ss.ss_sold_time_sk = t.t_time_sk",
        "all_sales": "SELECT ext_price, sold_item_sk, t_hour, t_minute FROM web_sales_union UNION ALL SELECT ext_price, sold_item_sk, t_hour, t_minute FROM catalog_sales_union UNION ALL SELECT ext_price, sold_item_sk, t_hour, t_minute FROM store_sales_union",
        "main_query": "SELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM item i JOIN all_sales s ON i.i_item_sk = s.sold_item_sk WHERE i.i_manager_id = 1 GROUP BY i_brand, i_brand_id, t_hour, t_minute ORDER BY ext_price DESC NULLS FIRST, i_brand_id NULLS FIRST, t_hour NULLS FIRST"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (brand, brand_id, hour, minute)",
        "same result rows",
        "same ordering semantics"
      ],
      "expected_speedup": "2.5x",
      "risk": "medium"
    }
  ],
  "explanation": "1) OR_TO_UNION: Split OR condition on t_meal_time into separate UNION ALL branches for 'breakfast' and 'dinner', allowing time_dim to be filtered early and potentially using indexes. 2) DATE_CTE_ISOLATE: Created single date_filter CTE for date_dim with d_moy=11 AND d_year=1999, reused across all sales tables to avoid redundant scans. 3) Eliminated late joins by pushing time_dim filter early and materializing t_hour/t_minute in CTEs. This reduces intermediate result sizes and allows better join order optimization."
}
```