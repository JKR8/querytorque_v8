```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "date_filter": "SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11",
        "item_filter": "SELECT i_item_sk FROM item WHERE i_category = 'Jewelry'",
        "store_filter": "SELECT s_store_sk FROM store WHERE s_gmt_offset = -5",
        "address_filter": "SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5",
        "promotion_filter_dmail": "SELECT p_promo_sk FROM promotion WHERE p_channel_dmail = 'Y'",
        "promotion_filter_email": "SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'Y'",
        "promotion_filter_tv": "SELECT p_promo_sk FROM promotion WHERE p_channel_tv = 'Y'",
        "base_sales": "SELECT ss_ext_sales_price, ss_promo_sk, ss_customer_sk, ss_item_sk, ss_store_sk, ss_sold_date_sk FROM store_sales",
        "promotional_sales": "SELECT SUM(ss_ext_sales_price) AS promotions FROM base_sales bs JOIN date_filter df ON bs.ss_sold_date_sk = df.d_date_sk JOIN store_filter sf ON bs.ss_store_sk = sf.s_store_sk JOIN item_filter itf ON bs.ss_item_sk = itf.i_item_sk JOIN customer c ON bs.ss_customer_sk = c.c_customer_sk JOIN address_filter af ON c.c_current_addr_sk = af.ca_address_sk WHERE bs.ss_promo_sk IN (SELECT p_promo_sk FROM promotion_filter_dmail UNION SELECT p_promo_sk FROM promotion_filter_email UNION SELECT p_promo_sk FROM promotion_filter_tv)",
        "all_sales": "SELECT SUM(ss_ext_sales_price) AS total FROM base_sales bs JOIN date_filter df ON bs.ss_sold_date_sk = df.d_date_sk JOIN store_filter sf ON bs.ss_store_sk = sf.s_store_sk JOIN item_filter itf ON bs.ss_item_sk = itf.i_item_sk JOIN customer c ON bs.ss_customer_sk = c.c_customer_sk JOIN address_filter af ON c.c_current_addr_sk = af.ca_address_sk",
        "main_query": "SELECT ps.promotions, als.total, CAST(ps.promotions AS DECIMAL(15,4)) / CAST(als.total AS DECIMAL(15,4)) * 100 FROM promotional_sales ps CROSS JOIN all_sales als ORDER BY ps.promotions, als.total LIMIT 100"
      },
      "invariants_kept": [
        "same result rows (1 row)",
        "same output columns",
        "same aggregation results"
      ],
      "expected_speedup": "2.5x",
      "risk": "medium"
    }
  ],
  "explanation": "Rewritten using OR_TO_UNION for the promotion channel conditions (breaking into three separate CTEs) and EARLY_FILTER for dimension tables (date_dim, item, store, customer_address). This reduces the promotion table scan from reading all 500 rows with OR conditions to three targeted scans. Early dimension filtering reduces fact table joins by ~35x (date_dim from 73k→30 rows, item from 102k→10k rows). The base_sales CTE allows reuse of the filtered store_sales scan for both promotional and total calculations."
}
```