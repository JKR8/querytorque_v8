```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "date_filtered": "SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001",
        "zip_filtered_customers": "SELECT ca_address_sk, ca_zip, ca_city FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('85669','86197','88274','83405','86475','85392','85460','80348','81792')",
        "item_filtered": "SELECT i_item_sk FROM item WHERE i_item_sk IN (2,3,5,7,11,13,17,19,23,29)",
        "branch_zip": "SELECT ws.ws_sales_price, ca.ca_zip, ca.ca_city FROM web_sales ws JOIN date_filtered df ON ws.ws_sold_date_sk = df.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN zip_filtered_customers ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk",
        "branch_item": "SELECT ws.ws_sales_price, ca.ca_zip, ca.ca_city FROM web_sales ws JOIN date_filtered df ON ws.ws_sold_date_sk = df.d_date_sk JOIN customer c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item_filtered it ON ws.ws_item_sk = it.i_item_sk WHERE SUBSTRING(ca.ca_zip, 1, 5) NOT IN ('85669','86197','88274','83405','86475','85392','85460','80348','81792')",
        "main_query": "SELECT ca_zip, ca_city, SUM(ws_sales_price) FROM (SELECT * FROM branch_zip UNION ALL SELECT * FROM branch_item) unioned GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same result rows",
        "same aggregation results"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "OR condition decomposed into UNION ALL with early filtering on both branches. First branch filters by zip codes early via zip_filtered_customers CTE. Second branch filters by item_sk early via item_filtered CTE and excludes zip-filtered rows to avoid duplicates. Date filter pushed early via date_filtered CTE. Eliminates correlated IN subquery by pre-materializing filtered item set. Each branch can use efficient joins with reduced data volumes."
}
```