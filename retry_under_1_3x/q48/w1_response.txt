```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "filtered_date": "SELECT d_date_sk FROM date_dim WHERE d_year = 2000",
        "filtered_store": "SELECT s_store_sk FROM store",
        "marital_M_degree_4yr": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree'",
        "marital_D_degree_2yr": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree'",
        "marital_S_degree_college": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College'",
        "address_state_group1": "SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX')",
        "address_state_group2": "SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY')",
        "address_state_group3": "SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS')",
        "branch_a1": "SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_M_degree_4yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group1 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 0 AND 2000",
        "branch_a2": "SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_M_degree_4yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group2 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 150 AND 3000",
        "branch_a3": "SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_M_degree_4yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group3 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 50 AND 25000",
        "branch_b1": "SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_D_degree_2yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group1 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 0 AND 2000",
        "branch_b2": "SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_D_degree_2yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group2 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 3000",
        "branch_b3": "SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_D_degree_2yr ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group3 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 50 AND 25000",
        "branch_c1": "SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_S_degree_college ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group1 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 0 AND 2000",
        "branch_c2": "SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_S_degree_college ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group2 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 150 AND 3000",
        "branch_c3": "SELECT ss_quantity FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON s_store_sk = ss_store_sk JOIN marital_S_degree_college ON cd_demo_sk = ss_cdemo_sk JOIN address_state_group3 ON ca_address_sk = ss_addr_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 25000",
        "main_query": "SELECT SUM(ss_quantity) FROM (SELECT ss_quantity FROM branch_a1 UNION ALL SELECT ss_quantity FROM branch_a2 UNION ALL SELECT ss_quantity FROM branch_a3 UNION ALL SELECT ss_quantity FROM branch_b1 UNION ALL SELECT ss_quantity FROM branch_b2 UNION ALL SELECT ss_quantity FROM branch_b3 UNION ALL SELECT ss_quantity FROM branch_c1 UNION ALL SELECT ss_quantity FROM branch_c2 UNION ALL SELECT ss_quantity FROM branch_c3) AS t"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation result",
        "same output columns"
      ],
      "expected_speedup": "2.8x",
      "risk": "low"
    }
  ],
  "explanation": "Decomposed the complex OR conditions into 9 disjoint UNION ALL branches. Each branch has specific, non-overlapping conditions from the original OR clauses. Created filtered dimension CTEs for date_dim (d_year=2000), customer_demographics (3 marital/education combos), and customer_address (3 state groups) to push filters early. Each branch joins store_sales with exactly one combination of demographics and address conditions, eliminating the need for the optimizer to evaluate all OR combinations per row. This allows better join order optimization and reduces the scan on store_sales by applying specific range filters early."
}
```