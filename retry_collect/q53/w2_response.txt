```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk, d_qoy FROM date_dim WHERE d_month_seq IN (1200, 1200 + 1, 1200 + 2, 1200 + 3, 1200 + 4, 1200 + 5, 1200 + 6, 1200 + 7, 1200 + 8, 1200 + 9, 1200 + 10, 1200 + 11)",
        "filtered_sales": "SELECT ss_item_sk, ss_sales_price, d_qoy FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk",
        "branch1_items": "SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')",
        "branch2_items": "SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')",
        "union_items": "SELECT * FROM branch1_items UNION ALL SELECT * FROM branch2_items",
        "main_query": "SELECT i_manufact_id, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM union_items ui JOIN filtered_sales fs ON ui.i_item_sk = fs.ss_item_sk GROUP BY i_manufact_id, d_qoy HAVING CASE WHEN AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) > 0 THEN ABS(SUM(ss_sales_price) - AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id)) / AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) ELSE NULL END > 0.1 ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same grouping and aggregation",
        "same window function semantics"
      ],
      "expected_speedup": "3.5x",
      "risk": "low"
    }
  ],
  "explanation": "Applied Date CTE Isolation to filter date_dim early (366 rows vs 73,049) and push filter into CTE. Applied OR_TO_UNION transform by splitting the complex OR condition on item table into two disjoint branches (verified disjoint categories), allowing UNION ALL for efficient branch execution. Removed redundant store table join since store is not used in SELECT/WHERE/GROUP BY. This reduces store_sales scan by filtering early with date dimension and allows better predicate pushdown on item categories."
}
```