{
  "timestamp": "20260205_235909",
  "config": {
    "database": "/mnt/d/TPC-DS/tpcds_sf5.duckdb",
    "queries": [
      "q16",
      "q94",
      "q34",
      "q9",
      "q26",
      "q4",
      "q5",
      "q42",
      "q58",
      "q91",
      "q12",
      "q29",
      "q63",
      "q43",
      "q38",
      "q48",
      "q37",
      "q82",
      "q96",
      "q22",
      "q25",
      "q53",
      "q7",
      "q73",
      "q75"
    ],
    "worker_examples": {
      "1": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "2": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "3": [
        "or_to_union",
        "intersect_to_exists"
      ]
    }
  },
  "summary": {
    "total_queries": 25,
    "improved": 0,
    "fixed": 0,
    "total_time_minutes": 4.928409151236216
  },
  "results": [
    {
      "query_id": "q16",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q16",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-02-01' AND CAST('2002-04-02' AS DATE)), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'GA'), filtered_call_centers AS (SELECT cc_call_center_sk FROM call_center WHERE cc_county = 'Williamson County'), multi_warehouse_orders AS (SELECT cs_order_number FROM catalog_sales GROUP BY cs_order_number HAVING COUNT(DISTINCT cs_warehouse_sk) > 1), non_returned_orders AS (SELECT cr_order_number FROM catalog_returns)\nSELECT COUNT(DISTINCT cs1.cs_order_number) AS \"order count\", SUM(cs1.cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs1.cs_net_profit) AS \"total net profit\" FROM catalog_sales AS cs1 JOIN filtered_dates AS fd ON cs1.cs_ship_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON cs1.cs_ship_addr_sk = fa.ca_address_sk JOIN filtered_call_centers AS fc ON cs1.cs_call_center_sk = fc.cc_call_center_sk JOIN multi_warehouse_orders AS mwo ON cs1.cs_order_number = mwo.cs_order_number LEFT JOIN non_returned_orders AS nro ON cs1.cs_order_number = nro.cr_order_number WHERE nro.cr_order_number IS NULL GROUP BY () ORDER BY COUNT(DISTINCT cs1.cs_order_number) LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 2,
          "query_id": "q16",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-02-01' AND CAST('2002-04-02' AS DATE)), multi_warehouse_orders AS (SELECT DISTINCT cs_order_number FROM catalog_sales GROUP BY cs_order_number HAVING COUNT(DISTINCT cs_warehouse_sk) > 1), returned_orders AS (SELECT DISTINCT cr_order_number FROM catalog_returns)\nSELECT COUNT(DISTINCT cs_order_number) AS \"order count\", SUM(cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs_net_profit) AS \"total net profit\" FROM catalog_sales AS cs1 JOIN filtered_dates ON cs1.cs_ship_date_sk = filtered_dates.d_date_sk JOIN customer_address ON cs1.cs_ship_addr_sk = ca_address_sk JOIN call_center ON cs1.cs_call_center_sk = cc_call_center_sk JOIN multi_warehouse_orders AS mwo ON cs1.cs_order_number = mwo.cs_order_number LEFT JOIN returned_orders AS ro ON cs1.cs_order_number = ro.cr_order_number WHERE ca_state = 'GA' AND cc_county = 'Williamson County' AND ro.cr_order_number IS NULL GROUP BY () ORDER BY COUNT(DISTINCT cs_order_number) LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 3,
          "query_id": "q16",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-02-01' AND CAST('2002-04-02' AS DATE)), filtered_shipments AS (SELECT cs1.cs_order_number, cs1.cs_ext_ship_cost, cs1.cs_net_profit, cs1.cs_ship_addr_sk, cs1.cs_call_center_sk FROM catalog_sales AS cs1 JOIN filtered_dates ON cs1.cs_ship_date_sk = d_date_sk)\nSELECT COUNT(DISTINCT cs_order_number) AS \"order count\", SUM(cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs_net_profit) AS \"total net profit\" FROM filtered_shipments AS fs JOIN customer_address ON fs.cs_ship_addr_sk = ca_address_sk JOIN call_center ON fs.cs_call_center_sk = cc_call_center_sk WHERE ca_state = 'GA' AND cc_county = 'Williamson County' AND EXISTS(SELECT 1 FROM catalog_sales AS cs2 WHERE fs.cs_order_number = cs2.cs_order_number AND fs.cs_ship_addr_sk <> cs2.cs_warehouse_sk) AND NOT EXISTS(SELECT 1 FROM catalog_returns AS cr1 WHERE fs.cs_order_number = cr1.cr_order_number) GROUP BY () ORDER BY COUNT(DISTINCT cs_order_number) LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        }
      ],
      "original_speedup": 0.06,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.299995"
    },
    {
      "query_id": "q94",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q94",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-02-01' AND CAST('1999-04-02' AS DATE)), filtered_ca AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'IL'), filtered_web AS (SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'), multi_warehouse_orders AS (SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1), orders_without_returns AS (SELECT ws_order_number FROM (SELECT DISTINCT ws_order_number FROM web_sales) AS all_orders WHERE NOT ws_order_number IN (SELECT DISTINCT wr_order_number FROM web_returns))\nSELECT COUNT(DISTINCT ws1.ws_order_number) AS \"order count\", SUM(ws1.ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws1.ws_net_profit) AS \"total net profit\" FROM web_sales AS ws1 JOIN filtered_date AS fd ON ws1.ws_ship_date_sk = fd.d_date_sk JOIN filtered_ca AS fca ON ws1.ws_ship_addr_sk = fca.ca_address_sk JOIN filtered_web AS fw ON ws1.ws_web_site_sk = fw.web_site_sk JOIN multi_warehouse_orders AS mwo ON ws1.ws_order_number = mwo.ws_order_number JOIN orders_without_returns AS owr ON ws1.ws_order_number = owr.ws_order_number ORDER BY COUNT(DISTINCT ws1.ws_order_number) LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 2,
          "query_id": "q94",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered_sales AS (SELECT ws_ship_date_sk, ws_ship_addr_sk, ws_web_site_sk, ws_order_number, ws_ext_ship_cost, ws_net_profit, ws_warehouse_sk FROM web_sales JOIN date_dim ON ws_ship_date_sk = d_date_sk WHERE d_date BETWEEN '1999-02-01' AND CAST('1999-04-02' AS DATE)), multi_warehouse_orders AS (SELECT DISTINCT ws_order_number FROM date_filtered_sales AS ws1 WHERE EXISTS(SELECT 1 FROM web_sales AS ws2 WHERE ws1.ws_order_number = ws2.ws_order_number AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)), returned_orders AS (SELECT DISTINCT wr_order_number FROM web_returns), filtered_sales AS (SELECT dfs.ws_order_number, dfs.ws_ext_ship_cost, dfs.ws_net_profit FROM date_filtered_sales AS dfs JOIN customer_address ON dfs.ws_ship_addr_sk = ca_address_sk JOIN web_site ON dfs.ws_web_site_sk = web_site_sk WHERE ca_state = 'IL' AND web_company_name = 'pri')\nSELECT COUNT(DISTINCT fs.ws_order_number) AS \"order count\", SUM(fs.ws_ext_ship_cost) AS \"total shipping cost\", SUM(fs.ws_net_profit) AS \"total net profit\" FROM filtered_sales AS fs JOIN multi_warehouse_orders AS mwo ON fs.ws_order_number = mwo.ws_order_number LEFT JOIN returned_orders AS ro ON fs.ws_order_number = ro.wr_order_number WHERE ro.wr_order_number IS NULL ORDER BY COUNT(DISTINCT fs.ws_order_number) LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 3,
          "query_id": "q94",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-02-01' AND CAST('1999-04-02' AS DATE)), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'IL'), filtered_site AS (SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'), base_sales AS (SELECT ws_order_number, ws_ext_ship_cost, ws_net_profit, ws_warehouse_sk FROM web_sales AS ws1 WHERE ws_ship_date_sk IN (SELECT d_date_sk FROM filtered_dates) AND ws_ship_addr_sk IN (SELECT ca_address_sk FROM filtered_address) AND ws_web_site_sk IN (SELECT web_site_sk FROM filtered_site)), orders_with_multiple_warehouses AS (SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1), orders_with_returns AS (SELECT DISTINCT wr_order_number FROM web_returns)\nSELECT COUNT(DISTINCT ws_order_number) AS \"order count\", SUM(ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws_net_profit) AS \"total net profit\" FROM base_sales WHERE ws_order_number IN (SELECT ws_order_number FROM orders_with_multiple_warehouses) AND NOT ws_order_number IN (SELECT wr_order_number FROM orders_with_returns) ORDER BY COUNT(DISTINCT ws_order_number) LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        }
      ],
      "original_speedup": 0.25,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300013"
    },
    {
      "query_id": "q34",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q34",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_county = 'Williamson County'), date_1_3 AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 3 AND d_year IN (1999, 2000, 2001)), date_25_28 AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 25 AND 28 AND d_year IN (1999, 2000, 2001)), hd_10000 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), hd_unknown AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = 'Unknown' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), union_branches AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN date_1_3 AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN hd_10000 AS h ON ss.ss_hdemo_sk = h.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN date_1_3 AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN hd_unknown AS h ON ss.ss_hdemo_sk = h.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN date_25_28 AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN hd_10000 AS h ON ss.ss_hdemo_sk = h.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN date_25_28 AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN hd_unknown AS h ON ss.ss_hdemo_sk = h.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM (SELECT ss_ticket_number, ss_customer_sk, SUM(cnt) AS cnt FROM union_branches GROUP BY ss_ticket_number, ss_customer_sk HAVING SUM(cnt) BETWEEN 15 AND 20) AS dn JOIN customer AS c ON dn.ss_customer_sk = c.c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, c_salutation NULLS FIRST, c_preferred_cust_flag DESC NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 2,
          "query_id": "q34",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_county = 'Williamson County'), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE (hd_buy_potential = '>10000' OR hd_buy_potential = 'Unknown') AND hd_vehicle_count > 0 AND (CASE WHEN hd_vehicle_count > 0 THEN (hd_dep_count * 1.000) / hd_vehicle_count ELSE NULL END) > 1.2), date_dom_1_3 AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001) AND d_dom BETWEEN 1 AND 3), date_dom_25_28 AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001) AND d_dom BETWEEN 25 AND 28), sales_dom_1_3 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN date_dom_1_3 ON store_sales.ss_sold_date_sk = date_dom_1_3.d_date_sk JOIN filtered_store ON store_sales.ss_store_sk = filtered_store.s_store_sk JOIN filtered_hd ON store_sales.ss_hdemo_sk = filtered_hd.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk HAVING COUNT(*) BETWEEN 15 AND 20), sales_dom_25_28 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN date_dom_25_28 ON store_sales.ss_sold_date_sk = date_dom_25_28.d_date_sk JOIN filtered_store ON store_sales.ss_store_sk = filtered_store.s_store_sk JOIN filtered_hd ON store_sales.ss_hdemo_sk = filtered_hd.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk HAVING COUNT(*) BETWEEN 15 AND 20), combined_sales AS (SELECT ss_ticket_number, ss_customer_sk, cnt FROM sales_dom_1_3 UNION ALL SELECT ss_ticket_number, ss_customer_sk, cnt FROM sales_dom_25_28)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM combined_sales JOIN customer ON ss_customer_sk = c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, c_salutation NULLS FIRST, c_preferred_cust_flag DESC NULLS FIRST, ss_ticket_number NULLS FIRST",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 3,
          "query_id": "q34",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_county = 'Williamson County'), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_vehicle_count > 0 AND (CASE WHEN hd_vehicle_count > 0 THEN (hd_dep_count * 1.000) / hd_vehicle_count ELSE NULL END) > 1.2), sales_branch_1 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk WHERE d_dom BETWEEN 1 AND 3 AND hd_buy_potential = '>10000' GROUP BY ss_ticket_number, ss_customer_sk), sales_branch_2 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk WHERE d_dom BETWEEN 1 AND 3 AND hd_buy_potential = 'Unknown' GROUP BY ss_ticket_number, ss_customer_sk), sales_branch_3 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk WHERE d_dom BETWEEN 25 AND 28 AND hd_buy_potential = '>10000' GROUP BY ss_ticket_number, ss_customer_sk), sales_branch_4 AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk WHERE d_dom BETWEEN 25 AND 28 AND hd_buy_potential = 'Unknown' GROUP BY ss_ticket_number, ss_customer_sk), combined_sales AS (SELECT ss_ticket_number, ss_customer_sk, cnt FROM sales_branch_1 UNION ALL SELECT ss_ticket_number, ss_customer_sk, cnt FROM sales_branch_2 UNION ALL SELECT ss_ticket_number, ss_customer_sk, cnt FROM sales_branch_3 UNION ALL SELECT ss_ticket_number, ss_customer_sk, cnt FROM sales_branch_4)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM combined_sales AS dn, customer WHERE ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20 ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, c_salutation NULLS FIRST, c_preferred_cust_flag DESC NULLS FIRST, ss_ticket_number NULLS FIRST",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        }
      ],
      "original_speedup": 0.32,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300017"
    },
    {
      "query_id": "q9",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q9",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH quantity_1_20_stats AS (SELECT COUNT(*) AS cnt, AVG(ss_ext_discount_amt) AS avg_ext_discount_amt, AVG(ss_net_paid) AS avg_net_paid FROM store_sales WHERE ss_quantity BETWEEN 1 AND 20), quantity_21_40_stats AS (SELECT COUNT(*) AS cnt, AVG(ss_ext_discount_amt) AS avg_ext_discount_amt, AVG(ss_net_paid) AS avg_net_paid FROM store_sales WHERE ss_quantity BETWEEN 21 AND 40), quantity_41_60_stats AS (SELECT COUNT(*) AS cnt, AVG(ss_ext_discount_amt) AS avg_ext_discount_amt, AVG(ss_net_paid) AS avg_net_paid FROM store_sales WHERE ss_quantity BETWEEN 41 AND 60), quantity_61_80_stats AS (SELECT COUNT(*) AS cnt, AVG(ss_ext_discount_amt) AS avg_ext_discount_amt, AVG(ss_net_paid) AS avg_net_paid FROM store_sales WHERE ss_quantity BETWEEN 61 AND 80), quantity_81_100_stats AS (SELECT COUNT(*) AS cnt, AVG(ss_ext_discount_amt) AS avg_ext_discount_amt, AVG(ss_net_paid) AS avg_net_paid FROM store_sales WHERE ss_quantity BETWEEN 81 AND 100)\nSELECT CASE WHEN q1.cnt > 74129 THEN q1.avg_ext_discount_amt ELSE q1.avg_net_paid END AS bucket1, CASE WHEN q2.cnt > 122840 THEN q2.avg_ext_discount_amt ELSE q2.avg_net_paid END AS bucket2, CASE WHEN q3.cnt > 56580 THEN q3.avg_ext_discount_amt ELSE q3.avg_net_paid END AS bucket3, CASE WHEN q4.cnt > 10097 THEN q4.avg_ext_discount_amt ELSE q4.avg_net_paid END AS bucket4, CASE WHEN q5.cnt > 165306 THEN q5.avg_ext_discount_amt ELSE q5.avg_net_paid END AS bucket5 FROM reason CROSS JOIN quantity_1_20_stats AS q1 CROSS JOIN quantity_21_40_stats AS q2 CROSS JOIN quantity_41_60_stats AS q3 CROSS JOIN quantity_61_80_stats AS q4 CROSS JOIN quantity_81_100_stats AS q5 WHERE r_reason_sk = 1",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 2,
          "query_id": "q9",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH store_sales_aggregates AS (SELECT SUM(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN 1 ELSE 0 END) AS cnt1, AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_ext_discount_amt END) AS avg_disc1, AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_net_paid END) AS avg_paid1, SUM(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN 1 ELSE 0 END) AS cnt2, AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_ext_discount_amt END) AS avg_disc2, AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_net_paid END) AS avg_paid2, SUM(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN 1 ELSE 0 END) AS cnt3, AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_ext_discount_amt END) AS avg_disc3, AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_net_paid END) AS avg_paid3, SUM(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN 1 ELSE 0 END) AS cnt4, AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_ext_discount_amt END) AS avg_disc4, AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_net_paid END) AS avg_paid4, SUM(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN 1 ELSE 0 END) AS cnt5, AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_ext_discount_amt END) AS avg_disc5, AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_net_paid END) AS avg_paid5 FROM store_sales)\nSELECT CASE WHEN cnt1 > 74129 THEN avg_disc1 ELSE avg_paid1 END AS bucket1, CASE WHEN cnt2 > 122840 THEN avg_disc2 ELSE avg_paid2 END AS bucket2, CASE WHEN cnt3 > 56580 THEN avg_disc3 ELSE avg_paid3 END AS bucket3, CASE WHEN cnt4 > 10097 THEN avg_disc4 ELSE avg_paid4 END AS bucket4, CASE WHEN cnt5 > 165306 THEN avg_disc5 ELSE avg_paid5 END AS bucket5 FROM store_sales_aggregates CROSS JOIN reason WHERE r_reason_sk = 1",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 3,
          "query_id": "q9",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH quantity_aggregations AS (SELECT CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN 1 WHEN ss_quantity BETWEEN 21 AND 40 THEN 2 WHEN ss_quantity BETWEEN 41 AND 60 THEN 3 WHEN ss_quantity BETWEEN 61 AND 80 THEN 4 WHEN ss_quantity BETWEEN 81 AND 100 THEN 5 END AS bucket, COUNT(*) AS cnt, AVG(ss_ext_discount_amt) AS avg_disc, AVG(ss_net_paid) AS avg_net FROM store_sales WHERE ss_quantity BETWEEN 1 AND 100 GROUP BY CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN 1 WHEN ss_quantity BETWEEN 21 AND 40 THEN 2 WHEN ss_quantity BETWEEN 41 AND 60 THEN 3 WHEN ss_quantity BETWEEN 61 AND 80 THEN 4 WHEN ss_quantity BETWEEN 81 AND 100 THEN 5 END) SELECT CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 1) > 74129 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 1) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 1) END AS bucket1, CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 2) > 122840 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 2) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 2) END AS bucket2, CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 3) > 56580 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 3) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 3) END AS bucket3, CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 4) > 10097 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 4) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 4) END AS bucket4, CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 5) > 165306 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 5) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 5) END AS bucket5 FROM reason WHERE r_reason_sk = 1",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        }
      ],
      "original_speedup": 0.47,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300021"
    },
    {
      "query_id": "q26",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q26",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), filtered_promotions AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'N' OR p_channel_event = 'N'), joined_facts AS (SELECT cs_item_sk, cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_customer_demographics AS fcd ON cs.cs_bill_cdemo_sk = fcd.cd_demo_sk JOIN filtered_promotions AS fp ON cs.cs_promo_sk = fp.p_promo_sk)\nSELECT i_item_id, AVG(cs_quantity) AS agg1, AVG(cs_list_price) AS agg2, AVG(cs_coupon_amt) AS agg3, AVG(cs_sales_price) AS agg4 FROM joined_facts AS jf JOIN item AS i ON jf.cs_item_sk = i.i_item_sk GROUP BY i_item_id ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 2,
          "query_id": "q26",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), customer_filtered AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), promo_email AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'N'), promo_event AS (SELECT p_promo_sk FROM promotion WHERE p_channel_event = 'N')\nSELECT i_item_id, AVG(cs_quantity) AS agg1, AVG(cs_list_price) AS agg2, AVG(cs_coupon_amt) AS agg3, AVG(cs_sales_price) AS agg4 FROM ((SELECT cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, cs_item_sk FROM catalog_sales JOIN date_filtered ON cs_sold_date_sk = d_date_sk JOIN customer_filtered ON cs_bill_cdemo_sk = cd_demo_sk JOIN promo_email ON cs_promo_sk = p_promo_sk) UNION ALL (SELECT cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, cs_item_sk FROM catalog_sales JOIN date_filtered ON cs_sold_date_sk = d_date_sk JOIN customer_filtered ON cs_bill_cdemo_sk = cd_demo_sk JOIN promo_event ON cs_promo_sk = p_promo_sk)) AS sales JOIN item ON cs_item_sk = i_item_sk GROUP BY i_item_id ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 3,
          "query_id": "q26",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), branch_email AS (SELECT cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, i_item_id FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN item ON cs_item_sk = i_item_sk JOIN promotion ON cs_promo_sk = p_promo_sk WHERE p_channel_email = 'N' AND p_channel_event <> 'N'), branch_event AS (SELECT cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, i_item_id FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN item ON cs_item_sk = i_item_sk JOIN promotion ON cs_promo_sk = p_promo_sk WHERE p_channel_event = 'N' AND p_channel_email <> 'N'), branch_both AS (SELECT cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, i_item_id FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN item ON cs_item_sk = i_item_sk JOIN promotion ON cs_promo_sk = p_promo_sk WHERE p_channel_email = 'N' AND p_channel_event = 'N'), combined_sales AS (SELECT * FROM branch_email UNION ALL SELECT * FROM branch_event UNION ALL SELECT * FROM branch_both)\nSELECT i_item_id, AVG(cs_quantity) AS agg1, AVG(cs_list_price) AS agg2, AVG(cs_coupon_amt) AS agg3, AVG(cs_sales_price) AS agg4 FROM combined_sales GROUP BY i_item_id ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        }
      ],
      "original_speedup": 0.6,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300024"
    },
    {
      "query_id": "q4",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q4",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, date_dim WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year), store_year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2001 AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer JOIN store_sales ON c_customer_sk = ss_customer_sk JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE (2001) = 2001 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2002 AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer JOIN store_sales ON c_customer_sk = ss_customer_sk JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE (2002) = 2002 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address), catalog_year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2001 AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer JOIN catalog_sales ON c_customer_sk = cs_bill_customer_sk JOIN date_filter ON cs_sold_date_sk = d_date_sk WHERE (2001) = 2001 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2002 AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer JOIN catalog_sales ON c_customer_sk = cs_bill_customer_sk JOIN date_filter ON cs_sold_date_sk = d_date_sk WHERE (2002) = 2002 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address), web_year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2001 AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer JOIN web_sales ON c_customer_sk = ws_bill_customer_sk JOIN date_filter ON ws_sold_date_sk = d_date_sk WHERE (2001) = 2001 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2002 AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer JOIN web_sales ON c_customer_sk = ws_bill_customer_sk JOIN date_filter ON ws_sold_date_sk = d_date_sk WHERE (2002) = 2002 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM store_year_total AS t_s_firstyear, store_year_total AS t_s_secyear, catalog_year_total AS t_c_firstyear, catalog_year_total AS t_c_secyear, web_year_total AS t_w_firstyear, web_year_total AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2002 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2002 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2002 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / NULLIF(t_c_firstyear.year_total, 0) ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / NULLIF(t_s_firstyear.year_total, 0) ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / NULLIF(t_c_firstyear.year_total, 0) ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / NULLIF(t_w_firstyear.year_total, 0) ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 2,
          "query_id": "q4",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, filtered_dates WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, filtered_dates WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, filtered_dates WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001 + 1 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2001 + 1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001 + 1 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 3,
          "query_id": "q4",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, filtered_dates WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, filtered_dates WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, filtered_dates WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001 + 1 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2001 + 1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001 + 1 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        }
      ],
      "original_speedup": 0.85,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300026"
    },
    {
      "query_id": "q5",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q5",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-06' AS DATE)), wsr_rewritten AS (SELECT web_site_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_sold_date_sk AS date_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, wr_returned_date_sk AS date_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT OUTER JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number) JOIN filtered_dates ON wr_returned_date_sk = d_date_sk) AS salesreturns, web_site WHERE wsr_web_site_sk = web_site_sk GROUP BY web_site_id), ssr_rewritten AS (SELECT s_store_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_sold_date_sk AS date_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk UNION ALL SELECT sr_store_sk AS store_sk, sr_returned_date_sk AS date_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns JOIN filtered_dates ON sr_returned_date_sk = d_date_sk) AS salesreturns, store WHERE store_sk = s_store_sk GROUP BY s_store_id), ssr AS (SELECT s_store_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_sold_date_sk AS date_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM store_sales UNION ALL SELECT sr_store_sk AS store_sk, sr_returned_date_sk AS date_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns) AS salesreturns, date_dim, store WHERE date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-06' AS DATE) AND store_sk = s_store_sk GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT cs_catalog_page_sk AS page_sk, cs_sold_date_sk AS date_sk, cs_ext_sales_price AS sales_price, cs_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM catalog_sales UNION ALL SELECT cr_catalog_page_sk AS page_sk, cr_returned_date_sk AS date_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, cr_return_amount AS return_amt, cr_net_loss AS net_loss FROM catalog_returns) AS salesreturns, date_dim, catalog_page WHERE date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-06' AS DATE) AND page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_sold_date_sk AS date_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM web_sales UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, wr_returned_date_sk AS date_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT OUTER JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number)) AS salesreturns, date_dim, web_site WHERE date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-06' AS DATE) AND wsr_web_site_sk = web_site_sk GROUP BY web_site_id)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, CONCAT('store', s_store_id) AS id, sales, returns_, (profit - profit_loss) AS profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, CONCAT('catalog_page', cp_catalog_page_id) AS id, sales, returns_, (profit - profit_loss) AS profit FROM csr UNION ALL SELECT 'web channel' AS channel, CONCAT('web_site', web_site_id) AS id, sales, returns_, (profit - profit_loss) AS profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST LIMIT 100",
          "prompt_tokens": 0,
          "response_tokens": 0,
          "llm_time_ms": 0
        },
        {
          "worker_id": 1,
          "query_id": "q5",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-06' AS DATE)), ssr AS (SELECT s_store_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_sold_date_sk AS date_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM store_sales UNION ALL SELECT sr_store_sk AS store_sk, sr_returned_date_sk AS date_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns) AS salesreturns JOIN filtered_dates ON salesreturns.date_sk = filtered_dates.d_date_sk JOIN store ON salesreturns.store_sk = store.s_store_sk GROUP BY s_store_id), wsr AS (SELECT web_site_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_sold_date_sk AS date_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM web_sales UNION ALL SELECT ws_web_site_sk AS wsr_web_site_sk, wr_returned_date_sk AS date_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns LEFT OUTER JOIN web_sales ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number)) AS salesreturns JOIN filtered_dates ON salesreturns.date_sk = filtered_dates.d_date_sk JOIN web_site ON salesreturns.wsr_web_site_sk = web_site.web_site_sk GROUP BY web_site_id), csr AS (SELECT cp_catalog_page_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT cs_catalog_page_sk AS page_sk, cs_sold_date_sk AS date_sk, cs_ext_sales_price AS sales_price, cs_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM catalog_sales UNION ALL SELECT cr_catalog_page_sk AS page_sk, cr_returned_date_sk AS date_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, cr_return_amount AS return_amt, cr_net_loss AS net_loss FROM catalog_returns) AS salesreturns JOIN filtered_dates ON salesreturns.date_sk = filtered_dates.d_date_sk JOIN catalog_page ON salesreturns.page_sk = catalog_page.cp_catalog_page_sk GROUP BY cp_catalog_page_id)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, CONCAT('store', s_store_id) AS id, sales, returns_, (profit - profit_loss) AS profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, CONCAT('catalog_page', cp_catalog_page_id) AS id, sales, returns_, (profit - profit_loss) AS profit FROM csr UNION ALL SELECT 'web channel' AS channel, CONCAT('web_site', web_site_id) AS id, sales, returns_, (profit - profit_loss) AS profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST LIMIT 100",
          "prompt_tokens": 4026,
          "response_tokens": 951,
          "llm_time_ms": 133160.4335308075
        },
        {
          "worker_id": 2,
          "query_id": "q5",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-06' AS DATE)), ssr AS (SELECT s_store_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT ss_store_sk AS store_sk, ss_ext_sales_price AS sales_price, ss_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk UNION ALL SELECT sr_store_sk AS store_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, sr_return_amt AS return_amt, sr_net_loss AS net_loss FROM store_returns JOIN filtered_dates ON sr_returned_date_sk = d_date_sk) AS salesreturns JOIN store ON store_sk = s_store_sk GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT cs_catalog_page_sk AS page_sk, cs_ext_sales_price AS sales_price, cs_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk UNION ALL SELECT cr_catalog_page_sk AS page_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, cr_return_amount AS return_amt, cr_net_loss AS net_loss FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk) AS salesreturns JOIN catalog_page ON page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(sales_price) AS sales, SUM(profit) AS profit, SUM(return_amt) AS returns_, SUM(net_loss) AS profit_loss FROM (SELECT ws_web_site_sk AS wsr_web_site_sk, ws_ext_sales_price AS sales_price, ws_net_profit AS profit, CAST(0 AS DECIMAL(7, 2)) AS return_amt, CAST(0 AS DECIMAL(7, 2)) AS net_loss FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk UNION ALL SELECT COALESCE(ws_web_site_sk, wr_web_site_sk) AS wsr_web_site_sk, CAST(0 AS DECIMAL(7, 2)) AS sales_price, CAST(0 AS DECIMAL(7, 2)) AS profit, wr_return_amt AS return_amt, wr_net_loss AS net_loss FROM web_returns AS wr JOIN filtered_dates ON wr_returned_date_sk = d_date_sk LEFT OUTER JOIN web_sales AS ws ON (wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number) JOIN filtered_dates AS ws_date ON ws_sold_date_sk = ws_date.d_date_sk) AS salesreturns JOIN web_site ON wsr_web_site_sk = web_site_sk GROUP BY web_site_id)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, CONCAT('store', s_store_id) AS id, sales, returns_, (profit - profit_loss) AS profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, CONCAT('catalog_page', cp_catalog_page_id) AS id, sales, returns_, (profit - profit_loss) AS profit FROM csr UNION ALL SELECT 'web channel' AS channel, CONCAT('web_site', web_site_id) AS id, sales, returns_, (profit - profit_loss) AS profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST LIMIT 100",
          "prompt_tokens": 4419,
          "response_tokens": 976,
          "llm_time_ms": 190635.0359916687
        }
      ],
      "original_speedup": 0.93,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300029"
    },
    {
      "query_id": "q42",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q42",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11 AND d_year = 2000), filtered_item AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1)\nSELECT fd.d_year, fi.i_category_id, fi.i_category, SUM(ss.ss_ext_sales_price) FROM store_sales AS ss JOIN filtered_date AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_item AS fi ON ss.ss_item_sk = fi.i_item_sk GROUP BY fd.d_year, fi.i_category_id, fi.i_category ORDER BY SUM(ss.ss_ext_sales_price) DESC, fd.d_year, fi.i_category_id, fi.i_category LIMIT 100",
          "prompt_tokens": 2559,
          "response_tokens": 582,
          "llm_time_ms": 92049.48568344116
        },
        {
          "worker_id": 3,
          "query_id": "q42",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11 AND d_year = 2000), filtered_items AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1)\nSELECT dt.d_year, item.i_category_id, item.i_category, SUM(ss_ext_sales_price) FROM store_sales JOIN filtered_dates AS dt ON store_sales.ss_sold_date_sk = dt.d_date_sk JOIN filtered_items AS item ON store_sales.ss_item_sk = item.i_item_sk GROUP BY dt.d_year, item.i_category_id, item.i_category ORDER BY SUM(ss_ext_sales_price) DESC, dt.d_year, item.i_category_id, item.i_category LIMIT 100",
          "prompt_tokens": 1994,
          "response_tokens": 318,
          "llm_time_ms": 102690.99950790405
        },
        {
          "worker_id": 2,
          "query_id": "q42",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000 AND d_moy = 11), filtered_items AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1), filtered_sales AS (SELECT ss_sold_date_sk, ss_item_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk)\nSELECT fd.d_year, fi.i_category_id, fi.i_category, SUM(ss_ext_sales_price) FROM filtered_sales AS fs JOIN filtered_items AS fi ON fs.ss_item_sk = fi.i_item_sk CROSS JOIN filtered_dates AS fd GROUP BY fd.d_year, fi.i_category_id, fi.i_category ORDER BY SUM(ss_ext_sales_price) DESC, fd.d_year, fi.i_category_id, fi.i_category LIMIT 100",
          "prompt_tokens": 2951,
          "response_tokens": 485,
          "llm_time_ms": 116983.17909240723
        }
      ],
      "original_speedup": 0.93,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300031"
    },
    {
      "query_id": "q58",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q58",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH week_sequence_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')), ws_items AS (SELECT i_item_id AS item_id, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales JOIN week_sequence_dates ON ws_sold_date_sk = d_date_sk JOIN item ON ws_item_sk = i_item_sk GROUP BY i_item_id), ss_items AS (SELECT i_item_id AS item_id, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales JOIN week_sequence_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk GROUP BY i_item_id), cs_items AS (SELECT i_item_id AS item_id, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales, item, date_dim WHERE cs_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')) AND cs_sold_date_sk = d_date_sk GROUP BY i_item_id)\nSELECT ss_items.item_id, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY ss_items.item_id NULLS FIRST, ss_item_rev NULLS FIRST LIMIT 100",
          "prompt_tokens": 3452,
          "response_tokens": 1091,
          "llm_time_ms": 130762.54367828369
        },
        {
          "worker_id": 2,
          "query_id": "q58",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH target_week_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')), ws_items AS (SELECT i_item_id AS item_id, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales JOIN item ON ws_item_sk = i_item_sk JOIN target_week_dates AS d ON ws_sold_date_sk = d.d_date_sk GROUP BY i_item_id), ss_items AS (SELECT i_item_id AS item_id, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN target_week_dates AS d ON ss_sold_date_sk = d.d_date_sk GROUP BY i_item_id), cs_items AS (SELECT i_item_id AS item_id, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales, item, date_dim WHERE cs_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')) AND cs_sold_date_sk = d_date_sk GROUP BY i_item_id)\nSELECT ss_items.item_id, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY ss_items.item_id NULLS FIRST, ss_item_rev NULLS FIRST LIMIT 100",
          "prompt_tokens": 3844,
          "response_tokens": 754,
          "llm_time_ms": 170137.41278648376
        },
        {
          "worker_id": 3,
          "query_id": "q58",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH week_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')), ws_items AS (SELECT i_item_id AS item_id, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales JOIN week_dates ON ws_sold_date_sk = d_date_sk JOIN item ON ws_item_sk = i_item_sk GROUP BY i_item_id), ss_items AS (SELECT i_item_id AS item_id, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales JOIN week_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk GROUP BY i_item_id), cs_items AS (SELECT i_item_id AS item_id, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales, item, date_dim WHERE cs_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')) AND cs_sold_date_sk = d_date_sk GROUP BY i_item_id)\nSELECT ss_items.item_id, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY ss_items.item_id NULLS FIRST, ss_item_rev NULLS FIRST LIMIT 100",
          "prompt_tokens": 2885,
          "response_tokens": 905,
          "llm_time_ms": 240239.70484733582
        }
      ],
      "original_speedup": 0.94,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300034"
    },
    {
      "query_id": "q91",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q91",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), filtered_household AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%'), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7), branch_m_unknown AS (SELECT cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status, SUM(cr_net_loss) AS Returns_Loss FROM call_center JOIN catalog_returns ON cr_call_center_sk = cc_call_center_sk JOIN filtered_date ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN filtered_address ON ca_address_sk = c_current_addr_sk JOIN filtered_household ON hd_demo_sk = c_current_hdemo_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown' GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status), branch_w_advanced AS (SELECT cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status, SUM(cr_net_loss) AS Returns_Loss FROM call_center JOIN catalog_returns ON cr_call_center_sk = cc_call_center_sk JOIN filtered_date ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN filtered_address ON ca_address_sk = c_current_addr_sk JOIN filtered_household ON hd_demo_sk = c_current_hdemo_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk WHERE cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree' GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status)\nSELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, Returns_Loss FROM (SELECT cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status, Returns_Loss FROM branch_m_unknown UNION ALL SELECT cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status, Returns_Loss FROM branch_w_advanced) AS combined ORDER BY Returns_Loss DESC",
          "prompt_tokens": 2765,
          "response_tokens": 684,
          "llm_time_ms": 143520.63393592834
        },
        {
          "worker_id": 3,
          "query_id": "q91",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7), filtered_households AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%'), branch_1 AS (SELECT cc_call_center_id, cc_name, cc_manager, cr_net_loss, cd_marital_status, cd_education_status FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN filtered_households ON hd_demo_sk = c_current_hdemo_sk JOIN filtered_addresses ON ca_address_sk = c_current_addr_sk JOIN call_center ON cr_call_center_sk = cc_call_center_sk WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown'), branch_2 AS (SELECT cc_call_center_id, cc_name, cc_manager, cr_net_loss, cd_marital_status, cd_education_status FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN filtered_households ON hd_demo_sk = c_current_hdemo_sk JOIN filtered_addresses ON ca_address_sk = c_current_addr_sk JOIN call_center ON cr_call_center_sk = cc_call_center_sk WHERE cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree'), combined_sales AS (SELECT * FROM branch_1 UNION ALL SELECT * FROM branch_2)\nSELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM combined_sales GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC",
          "prompt_tokens": 2200,
          "response_tokens": 692,
          "llm_time_ms": 146964.16997909546
        },
        {
          "worker_id": 2,
          "query_id": "q91",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 11), filtered_returns AS (SELECT cr_call_center_sk, cr_returning_customer_sk, cr_net_loss FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential LIKE 'Unknown%'), filtered_ca AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -7)\nSELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM call_center JOIN filtered_returns ON cr_call_center_sk = cc_call_center_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN filtered_ca ON ca_address_sk = c_current_addr_sk JOIN filtered_hd ON hd_demo_sk = c_current_hdemo_sk JOIN customer_demographics AS cd ON cd_demo_sk = c_current_cdemo_sk WHERE ((cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')) GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC",
          "prompt_tokens": 3156,
          "response_tokens": 1284,
          "llm_time_ms": 173833.86993408203
        }
      ],
      "original_speedup": 0.94,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300036"
    },
    {
      "query_id": "q12",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q12",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), date_filtered_sales AS (SELECT ws_item_sk, ws_ext_sales_price FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ws_ext_sales_price) AS itemrevenue, SUM(ws_ext_sales_price) * 100.0000 / SUM(SUM(ws_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM date_filtered_sales JOIN filtered_items ON ws_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category, i_class, i_item_id, i_item_desc, revenueratio LIMIT 100",
          "prompt_tokens": 3062,
          "response_tokens": 434,
          "llm_time_ms": 93578.3703327179
        },
        {
          "worker_id": 3,
          "query_id": "q12",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home'))\nSELECT i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price, SUM(ws.ws_ext_sales_price) AS itemrevenue, SUM(ws.ws_ext_sales_price) * 100.0000 / SUM(SUM(ws.ws_ext_sales_price)) OVER (PARTITION BY i.i_class) AS revenueratio FROM web_sales AS ws JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN filtered_items AS i ON ws.ws_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price ORDER BY i.i_category, i.i_class, i.i_item_id, i.i_item_desc, revenueratio LIMIT 100",
          "prompt_tokens": 2106,
          "response_tokens": 392,
          "llm_time_ms": 98393.74852180481
        },
        {
          "worker_id": 1,
          "query_id": "q12",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), filtered_sales AS (SELECT ws_item_sk, ws_ext_sales_price FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk), joined_sales AS (SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, ws_ext_sales_price FROM filtered_sales JOIN filtered_items ON ws_item_sk = i_item_sk), aggregated_sales AS (SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ws_ext_sales_price) AS itemrevenue FROM joined_sales GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, itemrevenue, itemrevenue * 100.0000 / SUM(itemrevenue) OVER (PARTITION BY i_class) AS revenueratio FROM aggregated_sales ORDER BY i_category, i_class, i_item_id, i_item_desc, revenueratio LIMIT 100",
          "prompt_tokens": 2671,
          "response_tokens": 767,
          "llm_time_ms": 175372.220993042
        }
      ],
      "original_speedup": 0.95,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300038"
    },
    {
      "query_id": "q29",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q29",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_d1 AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 9 AND d_year = 1999), filtered_dates_d2 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 9 AND 12 AND d_year = 1999), filtered_dates_d3 AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001)), filtered_store_sales AS (SELECT ss_quantity, ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number FROM store_sales JOIN filtered_dates_d1 ON ss_sold_date_sk = d_date_sk), filtered_store_returns AS (SELECT sr_return_quantity, sr_customer_sk, sr_item_sk, sr_ticket_number FROM store_returns JOIN filtered_dates_d2 ON sr_returned_date_sk = d_date_sk), filtered_catalog_sales AS (SELECT cs_quantity, cs_bill_customer_sk, cs_item_sk FROM catalog_sales JOIN filtered_dates_d3 ON cs_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_quantity) AS store_sales_quantity, SUM(sr_return_quantity) AS store_returns_quantity, SUM(cs_quantity) AS catalog_sales_quantity FROM filtered_store_sales JOIN store ON s_store_sk = ss_store_sk JOIN item ON i_item_sk = ss_item_sk JOIN filtered_store_returns ON (ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) JOIN filtered_catalog_sales ON (sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk) GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
          "prompt_tokens": 2293,
          "response_tokens": 979,
          "llm_time_ms": 121566.09749794006
        },
        {
          "worker_id": 2,
          "query_id": "q29",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 9 AND d_year = 1999), d2_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 9 AND 12 AND d_year = 1999), d3_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001)), filtered_store_sales AS (SELECT ss_customer_sk, ss_item_sk, ss_ticket_number, ss_store_sk, ss_quantity FROM store_sales JOIN d1_dates ON ss_sold_date_sk = d_date_sk), filtered_store_returns AS (SELECT sr_customer_sk, sr_item_sk, sr_ticket_number, sr_return_quantity FROM store_returns JOIN d2_dates ON sr_returned_date_sk = d_date_sk), filtered_catalog_sales AS (SELECT cs_bill_customer_sk, cs_item_sk, cs_quantity FROM catalog_sales JOIN d3_dates ON cs_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_quantity) AS store_sales_quantity, SUM(sr_return_quantity) AS store_returns_quantity, SUM(cs_quantity) AS catalog_sales_quantity FROM filtered_store_sales AS ss JOIN filtered_store_returns AS sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN filtered_catalog_sales AS cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk JOIN store AS s ON ss.ss_store_sk = s.s_store_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
          "prompt_tokens": 3250,
          "response_tokens": 570,
          "llm_time_ms": 125278.75113487244
        },
        {
          "worker_id": 1,
          "query_id": "q29",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 9 AND d_year = 1999), d2_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 9 AND 12 AND d_year = 1999), d3_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001)), filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_ticket_number, ss_store_sk, ss_quantity FROM store_sales JOIN d1_dates ON store_sales.ss_sold_date_sk = d1_dates.d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_return_quantity FROM store_returns JOIN d2_dates ON store_returns.sr_returned_date_sk = d2_dates.d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_quantity FROM catalog_sales JOIN d3_dates ON catalog_sales.cs_sold_date_sk = d3_dates.d_date_sk)\nSELECT i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name, SUM(fss.ss_quantity) AS store_sales_quantity, SUM(fsr.sr_return_quantity) AS store_returns_quantity, SUM(fcs.cs_quantity) AS catalog_sales_quantity FROM filtered_store_sales AS fss JOIN filtered_store_returns AS fsr ON fss.ss_customer_sk = fsr.sr_customer_sk AND fss.ss_item_sk = fsr.sr_item_sk AND fss.ss_ticket_number = fsr.sr_ticket_number JOIN filtered_catalog_sales AS fcs ON fsr.sr_customer_sk = fcs.cs_bill_customer_sk AND fsr.sr_item_sk = fcs.cs_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk JOIN item AS i ON fss.ss_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name ORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name LIMIT 100",
          "prompt_tokens": 2857,
          "response_tokens": 580,
          "llm_time_ms": 159451.92217826843
        }
      ],
      "original_speedup": 0.95,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300041"
    },
    {
      "query_id": "q63",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q63",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_month_seq IN (1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)), first_branch AS (SELECT i_manager_id, d_moy, ss_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk WHERE i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')), second_branch AS (SELECT i_manager_id, d_moy, ss_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk WHERE i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')), combined_sales AS (SELECT * FROM first_branch UNION ALL SELECT * FROM second_branch)\nSELECT i_manager_id, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manager_id) AS avg_monthly_sales FROM combined_sales GROUP BY i_manager_id, d_moy HAVING CASE WHEN AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manager_id) > 0 THEN ABS(SUM(ss_sales_price) - AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manager_id)) / AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manager_id) ELSE NULL END > 0.1 ORDER BY i_manager_id, avg_monthly_sales, sum_sales LIMIT 100",
          "prompt_tokens": 2274,
          "response_tokens": 617,
          "llm_time_ms": 78960.14428138733
        },
        {
          "worker_id": 1,
          "query_id": "q63",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_cte AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_month_seq IN (1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)), filtered_store_sales AS (SELECT ss_item_sk, ss_sold_date_sk, ss_store_sk, ss_sales_price FROM store_sales WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM date_cte))\nSELECT * FROM (SELECT i_manager_id, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manager_id) AS avg_monthly_sales FROM item, filtered_store_sales, date_cte, store WHERE ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND ss_store_sk = s_store_sk AND ((i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')) OR (i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1'))) GROUP BY i_manager_id, d_moy) AS tmp1 WHERE CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY i_manager_id, avg_monthly_sales, sum_sales LIMIT 100",
          "prompt_tokens": 2839,
          "response_tokens": 933,
          "llm_time_ms": 139005.12671470642
        },
        {
          "worker_id": 2,
          "query_id": "q63",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_month_seq IN (1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)), filtered_sales AS (SELECT ss_item_sk, ss_store_sk, ss_sales_price, d_moy FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk)\nSELECT * FROM (SELECT i_manager_id, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manager_id) AS avg_monthly_sales FROM item JOIN filtered_sales ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk WHERE ((i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')) OR (i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1'))) GROUP BY i_manager_id, d_moy) AS tmp1 WHERE CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY i_manager_id, avg_monthly_sales, sum_sales LIMIT 100",
          "prompt_tokens": 3231,
          "response_tokens": 1024,
          "llm_time_ms": 175876.51801109314
        }
      ],
      "original_speedup": 0.95,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300044"
    },
    {
      "query_id": "q43",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q43",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_day_name FROM date_dim WHERE d_year = 2000), filtered_stores AS (SELECT s_store_sk, s_store_name, s_store_id FROM store WHERE s_gmt_offset = -5)\nSELECT s_store_name, s_store_id, SUM(CASE WHEN (d_day_name = 'Sunday') THEN ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN (d_day_name = 'Monday') THEN ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN (d_day_name = 'Tuesday') THEN ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN (d_day_name = 'Wednesday') THEN ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN (d_day_name = 'Thursday') THEN ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN (d_day_name = 'Friday') THEN ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN (d_day_name = 'Saturday') THEN ss_sales_price ELSE NULL END) AS sat_sales FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk GROUP BY s_store_name, s_store_id ORDER BY s_store_name, s_store_id, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales LIMIT 100",
          "prompt_tokens": 3112,
          "response_tokens": 490,
          "llm_time_ms": 66627.9730796814
        },
        {
          "worker_id": 1,
          "query_id": "q43",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_day_name FROM date_dim WHERE d_year = 2000), filtered_store AS (SELECT s_store_sk, s_store_id, s_store_name FROM store WHERE s_gmt_offset = -5), joined_facts AS (SELECT s.s_store_name, s.s_store_id, f.d_day_name, ss.ss_sales_price FROM store_sales AS ss JOIN filtered_date AS f ON ss.ss_sold_date_sk = f.d_date_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk)\nSELECT s_store_name, s_store_id, SUM(CASE WHEN (d_day_name = 'Sunday') THEN ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN (d_day_name = 'Monday') THEN ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN (d_day_name = 'Tuesday') THEN ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN (d_day_name = 'Wednesday') THEN ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN (d_day_name = 'Thursday') THEN ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN (d_day_name = 'Friday') THEN ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN (d_day_name = 'Saturday') THEN ss_sales_price ELSE NULL END) AS sat_sales FROM joined_facts GROUP BY s_store_name, s_store_id ORDER BY s_store_name, s_store_id, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales LIMIT 100",
          "prompt_tokens": 2720,
          "response_tokens": 512,
          "llm_time_ms": 90619.33994293213
        },
        {
          "worker_id": 3,
          "query_id": "q43",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_day_name FROM date_dim WHERE d_year = 2000), filtered_stores AS (SELECT s_store_sk, s_store_id, s_store_name FROM store WHERE s_gmt_offset = -5)\nSELECT s_store_name, s_store_id, SUM(CASE WHEN (d_day_name = 'Sunday') THEN ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN (d_day_name = 'Monday') THEN ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN (d_day_name = 'Tuesday') THEN ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN (d_day_name = 'Wednesday') THEN ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN (d_day_name = 'Thursday') THEN ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN (d_day_name = 'Friday') THEN ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN (d_day_name = 'Saturday') THEN ss_sales_price ELSE NULL END) AS sat_sales FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk GROUP BY s_store_name, s_store_id ORDER BY s_store_name, s_store_id, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales LIMIT 100",
          "prompt_tokens": 2156,
          "response_tokens": 475,
          "llm_time_ms": 190572.90077209473
        }
      ],
      "original_speedup": 0.96,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300047"
    },
    {
      "query_id": "q38",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q38",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11)\nSELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_filter, customer WHERE web_sales.ws_sold_date_sk = date_filter.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND EXISTS(SELECT 1 FROM store_sales, date_filter AS sf, customer AS sc WHERE store_sales.ss_sold_date_sk = sf.d_date_sk AND store_sales.ss_customer_sk = sc.c_customer_sk AND sc.c_last_name = customer.c_last_name AND sc.c_first_name = customer.c_first_name AND sf.d_date = date_filter.d_date) AND EXISTS(SELECT 1 FROM catalog_sales, date_filter AS cf, customer AS cc WHERE catalog_sales.cs_sold_date_sk = cf.d_date_sk AND catalog_sales.cs_bill_customer_sk = cc.c_customer_sk AND cc.c_last_name = customer.c_last_name AND cc.c_first_name = customer.c_first_name AND cf.d_date = date_filter.d_date)) AS hot_cust LIMIT 100",
          "prompt_tokens": 2278,
          "response_tokens": 1174,
          "llm_time_ms": 149488.25311660767
        },
        {
          "worker_id": 1,
          "query_id": "q38",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), store_sales_distinct AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk), catalog_sales_distinct AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM catalog_sales AS cs JOIN filtered_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk), web_sales_distinct AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM web_sales AS ws JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk)\nSELECT COUNT(*) FROM (SELECT c_last_name, c_first_name, d_date FROM store_sales_distinct INTERSECT SELECT c_last_name, c_first_name, d_date FROM catalog_sales_distinct INTERSECT SELECT c_last_name, c_first_name, d_date FROM web_sales_distinct) AS hot_cust LIMIT 100",
          "prompt_tokens": 2842,
          "response_tokens": 779,
          "llm_time_ms": 149686.08045578003
        },
        {
          "worker_id": 2,
          "query_id": "q38",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), store_triples AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk), catalog_triples AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN filtered_dates ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk JOIN customer ON catalog_sales.cs_bill_customer_sk = customer.c_customer_sk), web_triples AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN filtered_dates ON web_sales.ws_sold_date_sk = filtered_dates.d_date_sk JOIN customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk)\nSELECT COUNT(*) FROM (SELECT * FROM store_triples INTERSECT SELECT * FROM catalog_triples INTERSECT SELECT * FROM web_triples) AS hot_cust LIMIT 100",
          "prompt_tokens": 3235,
          "response_tokens": 413,
          "llm_time_ms": 170998.64149093628
        }
      ],
      "original_speedup": 0.96,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300049"
    },
    {
      "query_id": "q48",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q48",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), store_sales_or_branches AS (SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ((ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree') AND ss_sales_price BETWEEN 100.00 AND 150.00) AND (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX')) AND ss_net_profit BETWEEN 0 AND 2000)) UNION ALL SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ((ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree') AND ss_sales_price BETWEEN 100.00 AND 150.00) AND (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY')) AND ss_net_profit BETWEEN 150 AND 3000)) UNION ALL SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ((ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree') AND ss_sales_price BETWEEN 100.00 AND 150.00) AND (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS')) AND ss_net_profit BETWEEN 50 AND 25000)) UNION ALL SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ((ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree') AND ss_sales_price BETWEEN 50.00 AND 100.00) AND (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX')) AND ss_net_profit BETWEEN 0 AND 2000)) UNION ALL SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ((ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree') AND ss_sales_price BETWEEN 50.00 AND 100.00) AND (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY')) AND ss_net_profit BETWEEN 150 AND 3000)) UNION ALL SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ((ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree') AND ss_sales_price BETWEEN 50.00 AND 100.00) AND (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS')) AND ss_net_profit BETWEEN 50 AND 25000)) UNION ALL SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ((ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College') AND ss_sales_price BETWEEN 150.00 AND 200.00) AND (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX')) AND ss_net_profit BETWEEN 0 AND 2000)) UNION ALL SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ((ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College') AND ss_sales_price BETWEEN 150.00 AND 200.00) AND (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY')) AND ss_net_profit BETWEEN 150 AND 3000)) UNION ALL SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ((ss_cdemo_sk IN (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College') AND ss_sales_price BETWEEN 150.00 AND 200.00) AND (ss_addr_sk IN (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS')) AND ss_net_profit BETWEEN 50 AND 25000)))\nSELECT SUM(ss_quantity) FROM store_sales_or_branches AS t JOIN store AS s ON t.ss_store_sk = s.s_store_sk",
          "prompt_tokens": 2902,
          "response_tokens": 1318,
          "llm_time_ms": 148012.3360157013
        },
        {
          "worker_id": 3,
          "query_id": "q48",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), branch_1 AS (SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON s_store_sk = ss_store_sk WHERE cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND ((ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') AND ss_net_profit BETWEEN 0 AND 2000) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') AND ss_net_profit BETWEEN 150 AND 3000) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') AND ss_net_profit BETWEEN 50 AND 25000))), branch_2 AS (SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON s_store_sk = ss_store_sk WHERE cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND ((ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') AND ss_net_profit BETWEEN 0 AND 2000) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') AND ss_net_profit BETWEEN 150 AND 3000) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') AND ss_net_profit BETWEEN 50 AND 25000))), branch_3 AS (SELECT ss_quantity, ss_cdemo_sk, ss_addr_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON s_store_sk = ss_store_sk WHERE cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND ((ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') AND ss_net_profit BETWEEN 0 AND 2000) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') AND ss_net_profit BETWEEN 150 AND 3000) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') AND ss_net_profit BETWEEN 50 AND 25000)))\nSELECT SUM(ss_quantity) FROM (SELECT ss_quantity FROM branch_1 UNION ALL SELECT ss_quantity FROM branch_2 UNION ALL SELECT ss_quantity FROM branch_3) AS t",
          "prompt_tokens": 2337,
          "response_tokens": 1057,
          "llm_time_ms": 231598.67691993713
        },
        {
          "worker_id": 2,
          "query_id": "q48",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), store_sales_filtered AS (SELECT ss_store_sk, ss_quantity, ss_cdemo_sk, ss_sales_price, ss_addr_sk, ss_net_profit FROM store_sales), branch1 AS (SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered AS ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics AS cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address AS ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 0 AND 2000), branch2 AS (SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered AS ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics AS cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address AS ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 150 AND 3000), branch3 AS (SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered AS ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics AS cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address AS ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 50 AND 25000), branch4 AS (SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered AS ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics AS cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address AS ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 0 AND 2000), branch5 AS (SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered AS ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics AS cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address AS ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 3000), branch6 AS (SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered AS ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics AS cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address AS ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 50 AND 25000), branch7 AS (SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered AS ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics AS cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address AS ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 0 AND 2000), branch8 AS (SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered AS ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics AS cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address AS ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 150 AND 3000), branch9 AS (SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered AS ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics AS cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address AS ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 25000)\nSELECT SUM(partial_sum) AS \"SUM(ss_quantity)\" FROM (SELECT partial_sum FROM branch1 UNION ALL SELECT partial_sum FROM branch2 UNION ALL SELECT partial_sum FROM branch3 UNION ALL SELECT partial_sum FROM branch4 UNION ALL SELECT partial_sum FROM branch5 UNION ALL SELECT partial_sum FROM branch6 UNION ALL SELECT partial_sum FROM branch7 UNION ALL SELECT partial_sum FROM branch8 UNION ALL SELECT partial_sum FROM branch9) AS t",
          "prompt_tokens": 3294,
          "response_tokens": 1529,
          "llm_time_ms": 287026.3657569885
        }
      ],
      "original_speedup": 0.96,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300051"
    },
    {
      "query_id": "q37",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q37",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-02-01' AS DATE) AND CAST('2000-04-01' AS DATE)), filtered_inventory AS (SELECT inv_item_sk FROM inventory JOIN filtered_dates ON d_date_sk = inv_date_sk WHERE inv_quantity_on_hand BETWEEN 100 AND 500), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 68 AND 68 + 30 AND i_manufact_id IN (677, 940, 694, 808))\nSELECT i_item_id, i_item_desc, i_current_price FROM filtered_items JOIN filtered_inventory ON inv_item_sk = i_item_sk WHERE EXISTS(SELECT 1 FROM catalog_sales WHERE cs_item_sk = i_item_sk) GROUP BY i_item_id, i_item_desc, i_current_price ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 2113,
          "response_tokens": 361,
          "llm_time_ms": 138754.0943622589
        },
        {
          "worker_id": 1,
          "query_id": "q37",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-02-01' AS DATE) AND CAST('2000-04-01' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 68 AND 98 AND i_manufact_id IN (677, 940, 694, 808)), inventory_with_dates AS (SELECT inv_item_sk FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk WHERE inv_quantity_on_hand BETWEEN 100 AND 500), qualified_items AS (SELECT i_item_id, i_item_desc, i_current_price FROM filtered_items WHERE i_item_sk IN (SELECT inv_item_sk FROM inventory_with_dates) AND i_item_sk IN (SELECT cs_item_sk FROM catalog_sales))\nSELECT i_item_id, i_item_desc, i_current_price FROM qualified_items ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 2676,
          "response_tokens": 368,
          "llm_time_ms": 211785.60137748718
        },
        {
          "worker_id": 2,
          "query_id": "q37",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-02-01' AS DATE) AND CAST('2000-04-01' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 68 AND 68 + 30 AND i_manufact_id IN (677, 940, 694, 808)), qualified_inventory AS (SELECT inv_item_sk FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk WHERE inv_quantity_on_hand BETWEEN 100 AND 500)\nSELECT i_item_id, i_item_desc, i_current_price FROM filtered_items AS fi JOIN qualified_inventory AS qi ON fi.i_item_sk = qi.inv_item_sk WHERE EXISTS(SELECT 1 FROM catalog_sales AS cs WHERE cs.cs_item_sk = fi.i_item_sk) GROUP BY i_item_id, i_item_desc, i_current_price ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 3068,
          "response_tokens": 380,
          "llm_time_ms": 212749.4215965271
        }
      ],
      "original_speedup": 0.97,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300053"
    },
    {
      "query_id": "q82",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q82",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-05-25' AS DATE) AND CAST('2000-07-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 62 AND 92 AND i_manufact_id IN (129, 270, 821, 423)), filtered_inventory AS (SELECT inv_item_sk FROM inventory JOIN filtered_dates ON d_date_sk = inv_date_sk WHERE inv_quantity_on_hand BETWEEN 100 AND 500)\nSELECT i_item_id, i_item_desc, i_current_price FROM filtered_items JOIN filtered_inventory ON i_item_sk = inv_item_sk JOIN store_sales ON i_item_sk = ss_item_sk GROUP BY i_item_id, i_item_desc, i_current_price ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 2116,
          "response_tokens": 492,
          "llm_time_ms": 140115.5619621277
        },
        {
          "worker_id": 1,
          "query_id": "q82",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-05-25' AS DATE) AND CAST('2000-07-24' AS DATE)), filtered_item AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 62 AND 62 + 30 AND i_manufact_id IN (129, 270, 821, 423)), filtered_inventory AS (SELECT inv_item_sk FROM inventory AS inv JOIN filtered_date AS fd ON inv.inv_date_sk = fd.d_date_sk WHERE inv_quantity_on_hand BETWEEN 100 AND 500), items_with_inventory AS (SELECT DISTINCT fi.i_item_sk, fi.i_item_id, fi.i_item_desc, fi.i_current_price FROM filtered_item AS fi JOIN filtered_inventory AS finv ON fi.i_item_sk = finv.inv_item_sk)\nSELECT i_item_id, i_item_desc, i_current_price FROM items_with_inventory AS iwi WHERE EXISTS(SELECT 1 FROM store_sales AS ss WHERE ss.ss_item_sk = iwi.i_item_sk) ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 2680,
          "response_tokens": 522,
          "llm_time_ms": 148135.76245307922
        },
        {
          "worker_id": 2,
          "query_id": "q82",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-05-25' AS DATE) AND CAST('2000-07-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price, i_manufact_id FROM item WHERE i_current_price BETWEEN 62 AND 92 AND i_manufact_id IN (129, 270, 821, 423)), filtered_inventory AS (SELECT inv_item_sk, inv_date_sk FROM inventory WHERE inv_quantity_on_hand BETWEEN 100 AND 500), qualified_inventory AS (SELECT inv_item_sk FROM filtered_inventory AS inv JOIN filtered_dates AS dd ON inv.inv_date_sk = dd.d_date_sk)\nSELECT fi.i_item_id, fi.i_item_desc, fi.i_current_price FROM filtered_items AS fi JOIN qualified_inventory AS qi ON fi.i_item_sk = qi.inv_item_sk WHERE EXISTS(SELECT 1 FROM store_sales AS ss WHERE ss.ss_item_sk = fi.i_item_sk) ORDER BY fi.i_item_id LIMIT 100",
          "prompt_tokens": 3072,
          "response_tokens": 425,
          "llm_time_ms": 157364.44759368896
        }
      ],
      "original_speedup": 0.97,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300055"
    },
    {
      "query_id": "q96",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q96",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_time AS (SELECT t_time_sk FROM time_dim WHERE t_hour = 20 AND t_minute >= 30), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 7), filtered_store AS (SELECT s_store_sk FROM store WHERE s_store_name = 'ese'), filtered_sales AS (SELECT 1 FROM store_sales AS ss JOIN filtered_time AS ft ON ss.ss_sold_time_sk = ft.t_time_sk JOIN filtered_hd AS fhd ON ss.ss_hdemo_sk = fhd.hd_demo_sk JOIN filtered_store AS fs ON ss.ss_store_sk = fs.s_store_sk)\nSELECT COUNT(*) FROM filtered_sales ORDER BY COUNT(*) LIMIT 100",
          "prompt_tokens": 2811,
          "response_tokens": 830,
          "llm_time_ms": 83668.50972175598
        },
        {
          "worker_id": 1,
          "query_id": "q96",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_store_name = 'ese'), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 7), filtered_time AS (SELECT t_time_sk FROM time_dim WHERE t_hour = 20 AND t_minute >= 30), filtered_sales AS (SELECT ss_store_sk, ss_hdemo_sk, ss_sold_time_sk FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk JOIN filtered_time ON ss_sold_time_sk = t_time_sk)\nSELECT COUNT(*) FROM filtered_sales ORDER BY COUNT(*) LIMIT 100",
          "prompt_tokens": 2416,
          "response_tokens": 334,
          "llm_time_ms": 87206.08353614807
        },
        {
          "worker_id": 3,
          "query_id": "q96",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_store_name = 'ese'), filtered_time AS (SELECT t_time_sk FROM time_dim WHERE t_hour = 20 AND t_minute >= 30), filtered_household AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 7), filtered_sales AS (SELECT 1 FROM store_sales WHERE ss_store_sk IN (SELECT s_store_sk FROM filtered_store) AND ss_sold_time_sk IN (SELECT t_time_sk FROM filtered_time) AND ss_hdemo_sk IN (SELECT hd_demo_sk FROM filtered_household))\nSELECT COUNT(*) FROM filtered_sales ORDER BY COUNT(*) LIMIT 100",
          "prompt_tokens": 1852,
          "response_tokens": 490,
          "llm_time_ms": 137593.36018562317
        }
      ],
      "original_speedup": 0.97,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300056"
    },
    {
      "query_id": "q22",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q22",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11)\nSELECT i_product_name, i_brand, i_class, i_category, AVG(inv_quantity_on_hand) AS qoh FROM inventory JOIN filtered_dates ON inv_date_sk = filtered_dates.d_date_sk JOIN item ON inv_item_sk = i_item_sk GROUP BY ROLLUP (i_product_name, i_brand, i_class, i_category) ORDER BY qoh NULLS FIRST, i_product_name NULLS FIRST, i_brand NULLS FIRST, i_class NULLS FIRST, i_category NULLS FIRST LIMIT 100",
          "prompt_tokens": 2916,
          "response_tokens": 316,
          "llm_time_ms": 57643.88608932495
        },
        {
          "worker_id": 3,
          "query_id": "q22",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11)\nSELECT i_product_name, i_brand, i_class, i_category, AVG(inv_quantity_on_hand) AS qoh FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk JOIN item ON inv_item_sk = i_item_sk GROUP BY ROLLUP (i_product_name, i_brand, i_class, i_category) ORDER BY qoh NULLS FIRST, i_product_name NULLS FIRST, i_brand NULLS FIRST, i_class NULLS FIRST, i_category NULLS FIRST LIMIT 100",
          "prompt_tokens": 1960,
          "response_tokens": 538,
          "llm_time_ms": 110708.23764801025
        },
        {
          "worker_id": 1,
          "query_id": "q22",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11)\nSELECT i_product_name, i_brand, i_class, i_category, AVG(inv_quantity_on_hand) AS qoh FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk JOIN item ON inv_item_sk = i_item_sk GROUP BY ROLLUP (i_product_name, i_brand, i_class, i_category) ORDER BY qoh NULLS FIRST, i_product_name NULLS FIRST, i_brand NULLS FIRST, i_class NULLS FIRST, i_category NULLS FIRST LIMIT 100",
          "prompt_tokens": 2524,
          "response_tokens": 330,
          "llm_time_ms": 108406.494140625
        }
      ],
      "original_speedup": 0.98,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300058"
    },
    {
      "query_id": "q25",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q25",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), d2_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), d3_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss_net_profit, ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number FROM store_sales JOIN d1_filtered ON ss_sold_date_sk = d_date_sk), filtered_store_returns AS (SELECT sr_net_loss, sr_customer_sk, sr_item_sk, sr_ticket_number FROM store_returns JOIN d2_filtered ON sr_returned_date_sk = d_date_sk), filtered_catalog_sales AS (SELECT cs_net_profit, cs_bill_customer_sk, cs_item_sk FROM catalog_sales JOIN d3_filtered ON cs_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_net_profit) AS store_sales_profit, SUM(sr_net_loss) AS store_returns_loss, SUM(cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales JOIN item ON i_item_sk = ss_item_sk JOIN store ON s_store_sk = ss_store_sk JOIN filtered_store_returns ON ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN filtered_catalog_sales ON sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
          "prompt_tokens": 2204,
          "response_tokens": 543,
          "llm_time_ms": 97682.81507492065
        },
        {
          "worker_id": 2,
          "query_id": "q25",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), d2_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), d3_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_ticket_number, ss_store_sk, ss_net_profit FROM store_sales JOIN d1_dates ON ss_sold_date_sk = d1_dates.d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN d2_dates ON sr_returned_date_sk = d2_dates.d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN d3_dates ON cs_sold_date_sk = d3_dates.d_date_sk)\nSELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(fss.ss_net_profit) AS store_sales_profit, SUM(fsr.sr_net_loss) AS store_returns_loss, SUM(fcs.cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales AS fss JOIN filtered_store_returns AS fsr ON fss.ss_customer_sk = fsr.sr_customer_sk AND fss.ss_item_sk = fsr.sr_item_sk AND fss.ss_ticket_number = fsr.sr_ticket_number JOIN filtered_catalog_sales AS fcs ON fsr.sr_customer_sk = fcs.cs_bill_customer_sk AND fsr.sr_item_sk = fcs.cs_item_sk JOIN store ON fss.ss_store_sk = store.s_store_sk JOIN item ON fss.ss_item_sk = item.i_item_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
          "prompt_tokens": 3158,
          "response_tokens": 1103,
          "llm_time_ms": 131834.9952697754
        },
        {
          "worker_id": 1,
          "query_id": "q25",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), d2_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), d3_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss.ss_item_sk, ss.ss_customer_sk, ss.ss_ticket_number, ss.ss_store_sk, ss.ss_net_profit FROM store_sales AS ss JOIN d1_filtered AS d1 ON ss.ss_sold_date_sk = d1.d_date_sk), filtered_store_returns AS (SELECT sr.sr_item_sk, sr.sr_customer_sk, sr.sr_ticket_number, sr.sr_net_loss FROM store_returns AS sr JOIN d2_filtered AS d2 ON sr.sr_returned_date_sk = d2.d_date_sk), filtered_catalog_sales AS (SELECT cs.cs_item_sk, cs.cs_bill_customer_sk, cs.cs_net_profit FROM catalog_sales AS cs JOIN d3_filtered AS d3 ON cs.cs_sold_date_sk = d3.d_date_sk)\nSELECT i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name, SUM(fss.ss_net_profit) AS store_sales_profit, SUM(fsr.sr_net_loss) AS store_returns_loss, SUM(fcs.cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales AS fss JOIN filtered_store_returns AS fsr ON fss.ss_item_sk = fsr.sr_item_sk AND fss.ss_customer_sk = fsr.sr_customer_sk AND fss.ss_ticket_number = fsr.sr_ticket_number JOIN filtered_catalog_sales AS fcs ON fsr.sr_item_sk = fcs.cs_item_sk AND fsr.sr_customer_sk = fcs.cs_bill_customer_sk JOIN item AS i ON fss.ss_item_sk = i.i_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk GROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name ORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name LIMIT 100",
          "prompt_tokens": 2768,
          "response_tokens": 594,
          "llm_time_ms": 133465.27647972107
        }
      ],
      "original_speedup": 0.98,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300060"
    },
    {
      "query_id": "q53",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q53",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_qoy FROM date_dim WHERE d_month_seq IN (1200, 1200 + 1, 1200 + 2, 1200 + 3, 1200 + 4, 1200 + 5, 1200 + 6, 1200 + 7, 1200 + 8, 1200 + 9, 1200 + 10, 1200 + 11)), filtered_sales AS (SELECT ss_item_sk, ss_sales_price, d_qoy FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk), branch1_items AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')), branch2_items AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')), union_items AS (SELECT * FROM branch1_items UNION ALL SELECT * FROM branch2_items)\nSELECT i_manufact_id, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM union_items AS ui JOIN filtered_sales AS fs ON ui.i_item_sk = fs.ss_item_sk GROUP BY i_manufact_id, d_qoy HAVING CASE WHEN AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) > 0 THEN ABS(SUM(ss_sales_price) - AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id)) / AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) ELSE NULL END > 0.1 ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100",
          "prompt_tokens": 3253,
          "response_tokens": 630,
          "llm_time_ms": 116805.23753166199
        },
        {
          "worker_id": 1,
          "query_id": "q53",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_qoy FROM date_dim WHERE d_month_seq IN (1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211)), books_children_electronics_items AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9')), women_music_men_items AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1')), all_items AS (SELECT i_item_sk, i_manufact_id FROM books_children_electronics_items UNION ALL SELECT i_item_sk, i_manufact_id FROM women_music_men_items)\nSELECT * FROM (SELECT i_manufact_id, d_qoy, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN all_items ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk GROUP BY i_manufact_id, d_qoy) AS tmp1 WHERE CASE WHEN avg_quarterly_sales > 0 THEN ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales ELSE NULL END > 0.1 ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100",
          "prompt_tokens": 2862,
          "response_tokens": 942,
          "llm_time_ms": 128274.45077896118
        },
        {
          "worker_id": 3,
          "query_id": "q53",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT * FROM filtered_dates), union_branches AS (SELECT i_manufact_id, d_qoy, SUM(ss_sales_price) AS sum_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk WHERE i_category IN ('Books', 'Children', 'Electronics') AND i_class IN ('personal', 'portable', 'reference', 'self-help') AND i_brand IN ('scholaramalgamalg #14', 'scholaramalgamalg #7', 'exportiunivamalg #9', 'scholaramalgamalg #9') GROUP BY i_manufact_id, d_qoy UNION ALL SELECT i_manufact_id, d_qoy, SUM(ss_sales_price) AS sum_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk JOIN store ON ss_store_sk = s_store_sk WHERE i_category IN ('Women', 'Music', 'Men') AND i_class IN ('accessories', 'classical', 'fragrances', 'pants') AND i_brand IN ('amalgimporto #1', 'edu packscholar #1', 'exportiimporto #1', 'importoamalg #1') GROUP BY i_manufact_id, d_qoy) SELECT i_manufact_id, sum_sales, avg_quarterly_sales FROM (SELECT i_manufact_id, d_qoy, sum_sales, AVG(sum_sales) OVER (PARTITION BY i_manufact_id) AS avg_quarterly_sales FROM union_branches) AS tmp1 WHERE CASE WHEN avg_quarterly_sales > 0 THEN ABS(sum_sales - avg_quarterly_sales) / avg_quarterly_sales ELSE NULL END > 0.1 ORDER BY avg_quarterly_sales, sum_sales, i_manufact_id LIMIT 100",
          "prompt_tokens": 2297,
          "response_tokens": 626,
          "llm_time_ms": 187151.5507698059
        }
      ],
      "original_speedup": 0.98,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300061"
    },
    {
      "query_id": "q7",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q7",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_cd AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), email_promo AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'N'), event_promo AS (SELECT p_promo_sk FROM promotion WHERE p_channel_event = 'N'), branch1 AS (SELECT ss_item_sk, ss_quantity, ss_list_price, ss_coupon_amt, ss_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_cd ON ss_cdemo_sk = cd_demo_sk JOIN email_promo ON ss_promo_sk = p_promo_sk), branch2 AS (SELECT ss_item_sk, ss_quantity, ss_list_price, ss_coupon_amt, ss_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_cd ON ss_cdemo_sk = cd_demo_sk JOIN event_promo ON ss_promo_sk = p_promo_sk), combined_sales AS (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2)\nSELECT i_item_id, AVG(ss_quantity) AS agg1, AVG(ss_list_price) AS agg2, AVG(ss_coupon_amt) AS agg3, AVG(ss_sales_price) AS agg4 FROM combined_sales AS s JOIN item AS i ON s.ss_item_sk = i.i_item_sk GROUP BY i_item_id ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 3138,
          "response_tokens": 572,
          "llm_time_ms": 128582.88741111755
        },
        {
          "worker_id": 3,
          "query_id": "q7",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), sales_branch1 AS (SELECT ss_quantity, ss_list_price, ss_coupon_amt, ss_sales_price, i_item_id FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN item ON ss_item_sk = i_item_sk JOIN promotion ON ss_promo_sk = p_promo_sk WHERE p_channel_email = 'N'), sales_branch2 AS (SELECT ss_quantity, ss_list_price, ss_coupon_amt, ss_sales_price, i_item_id FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN item ON ss_item_sk = i_item_sk JOIN promotion ON ss_promo_sk = p_promo_sk WHERE p_channel_event = 'N' AND (p_channel_email <> 'N' OR p_channel_email IS NULL))\nSELECT i_item_id, AVG(ss_quantity) AS agg1, AVG(ss_list_price) AS agg2, AVG(ss_coupon_amt) AS agg3, AVG(ss_sales_price) AS agg4 FROM (SELECT * FROM sales_branch1 UNION ALL SELECT * FROM sales_branch2) AS unioned_sales GROUP BY i_item_id ORDER BY i_item_id LIMIT 100",
          "prompt_tokens": 2182,
          "response_tokens": 875,
          "llm_time_ms": 161039.22629356384
        },
        {
          "worker_id": 1,
          "query_id": "q7",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_cdemo AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), filtered_promo_email AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'N'), filtered_promo_event AS (SELECT p_promo_sk FROM promotion WHERE p_channel_event = 'N')\nSELECT i.i_item_id, AVG(ss.ss_quantity) AS agg1, AVG(ss.ss_list_price) AS agg2, AVG(ss.ss_coupon_amt) AS agg3, AVG(ss.ss_sales_price) AS agg4 FROM store_sales AS ss JOIN filtered_date AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_cdemo AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk WHERE (ss.ss_promo_sk IN (SELECT p_promo_sk FROM filtered_promo_email) OR ss.ss_promo_sk IN (SELECT p_promo_sk FROM filtered_promo_event)) GROUP BY i.i_item_id ORDER BY i.i_item_id LIMIT 100",
          "prompt_tokens": 2746,
          "response_tokens": 1150,
          "llm_time_ms": 182368.16501617432
        }
      ],
      "original_speedup": 0.99,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300062"
    },
    {
      "query_id": "q73",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q73",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 2 AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_county IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')), filtered_hd_unknown AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = 'Unknown' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1), filtered_hd_high AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1), union_aggregate AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN filtered_hd_unknown ON ss_hdemo_sk = hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN filtered_hd_high ON ss_hdemo_sk = hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM (SELECT ss_ticket_number, ss_customer_sk, SUM(cnt) AS cnt FROM union_aggregate GROUP BY ss_ticket_number, ss_customer_sk HAVING SUM(cnt) BETWEEN 1 AND 5) AS dj, customer WHERE ss_customer_sk = c_customer_sk ORDER BY cnt DESC, c_last_name ASC LIMIT 100",
          "prompt_tokens": 2288,
          "response_tokens": 868,
          "llm_time_ms": 170898.27632904053
        },
        {
          "worker_id": 1,
          "query_id": "q73",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 2 AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_county IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')), hd_unknown AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = 'Unknown' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1), hd_10000 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1), unioned_sales AS (SELECT ss_ticket_number, ss_customer_sk FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN hd_unknown ON ss_hdemo_sk = hd_demo_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN hd_10000 ON ss_hdemo_sk = hd_demo_sk), grouped_sales AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM unioned_sales GROUP BY ss_ticket_number, ss_customer_sk)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM grouped_sales JOIN customer ON ss_customer_sk = c_customer_sk WHERE cnt BETWEEN 1 AND 5 ORDER BY cnt DESC, c_last_name ASC",
          "prompt_tokens": 2852,
          "response_tokens": 530,
          "llm_time_ms": 202884.19842720032
        },
        {
          "worker_id": 2,
          "query_id": "q73",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 2 AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_county IN ('Orange County', 'Bronx County', 'Franklin Parish', 'Williamson County')), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential IN ('Unknown', '>10000') AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1), grouped_sales AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_stores ON store_sales.ss_store_sk = filtered_stores.s_store_sk JOIN filtered_hd ON store_sales.ss_hdemo_sk = filtered_hd.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk)\nSELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM grouped_sales JOIN customer ON ss_customer_sk = c_customer_sk WHERE cnt BETWEEN 1 AND 5 ORDER BY cnt DESC, c_last_name ASC",
          "prompt_tokens": 3244,
          "response_tokens": 444,
          "llm_time_ms": 229617.05660820007
        }
      ],
      "original_speedup": 0.99,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300064"
    },
    {
      "query_id": "q75",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q75",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2001, 2002)), filtered_item AS (SELECT i_item_sk, i_brand_id, i_class_id, i_category_id, i_manufact_id FROM item WHERE i_category = 'Books'), all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d.d_year, i.i_brand_id, i.i_class_id, i.i_category_id, i.i_manufact_id, cs.cs_quantity - COALESCE(cr.cr_return_quantity, 0) AS sales_cnt, cs.cs_ext_sales_price - COALESCE(cr.cr_return_amount, 0.0) AS sales_amt FROM catalog_sales AS cs JOIN filtered_item AS i ON i.i_item_sk = cs.cs_item_sk JOIN filtered_date AS d ON d.d_date_sk = cs.cs_sold_date_sk LEFT JOIN catalog_returns AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) UNION ALL SELECT d.d_year, i.i_brand_id, i.i_class_id, i.i_category_id, i.i_manufact_id, ss.ss_quantity - COALESCE(sr.sr_return_quantity, 0) AS sales_cnt, ss.ss_ext_sales_price - COALESCE(sr.sr_return_amt, 0.0) AS sales_amt FROM store_sales AS ss JOIN filtered_item AS i ON i.i_item_sk = ss.ss_item_sk JOIN filtered_date AS d ON d.d_date_sk = ss.ss_sold_date_sk LEFT JOIN store_returns AS sr ON (ss.ss_ticket_number = sr.sr_ticket_number AND ss.ss_item_sk = sr.sr_item_sk) UNION ALL SELECT d.d_year, i.i_brand_id, i.i_class_id, i.i_category_id, i.i_manufact_id, ws.ws_quantity - COALESCE(wr.wr_return_quantity, 0) AS sales_cnt, ws.ws_ext_sales_price - COALESCE(wr.wr_return_amt, 0.0) AS sales_amt FROM web_sales AS ws JOIN filtered_item AS i ON i.i_item_sk = ws.ws_item_sk JOIN filtered_date AS d ON d.d_date_sk = ws.ws_sold_date_sk LEFT JOIN web_returns AS wr ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk)) AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year_, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr JOIN all_sales AS prev_yr ON curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id WHERE curr_yr.d_year = 2002 AND prev_yr.d_year = 2001 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100",
          "prompt_tokens": 3409,
          "response_tokens": 890,
          "llm_time_ms": 115840.56997299194
        },
        {
          "worker_id": 2,
          "query_id": "q75",
          "examples_used": [
            "date_cte_isolate",
            "materialize_cte",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Books' AND d_year IN (2001, 2002) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Books' AND d_year IN (2001, 2002) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Books' AND d_year IN (2001, 2002)) AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year_, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr, all_sales AS prev_yr WHERE curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2001 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100",
          "prompt_tokens": 3799,
          "response_tokens": 755,
          "llm_time_ms": 135443.9296722412
        },
        {
          "worker_id": 3,
          "query_id": "q75",
          "examples_used": [
            "or_to_union",
            "intersect_to_exists"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (2001, 2002)), all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN filtered_dates ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Books' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN filtered_dates ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Books' UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN filtered_dates ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Books') AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year_, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr, all_sales AS prev_yr WHERE curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 2002 AND prev_yr.d_year = 2002 - 1 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100",
          "prompt_tokens": 2838,
          "response_tokens": 1263,
          "llm_time_ms": 155677.79159545898
        }
      ],
      "original_speedup": 0.99,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:04:05.300065"
    }
  ]
}