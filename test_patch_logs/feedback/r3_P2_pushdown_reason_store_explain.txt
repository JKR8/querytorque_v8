                                                                                                                   QUERY PLAN                                                                                                                    
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=65296.94..65297.19 rows=100 width=17) (actual time=371.151..371.912 rows=0 loops=1)
   Buffers: shared hit=808002 read=96735
   CTE customer_total_return
     ->  GroupAggregate  (cost=65271.39..65271.42 rows=1 width=44) (actual time=370.038..370.845 rows=79 loops=1)
           Group Key: store_returns.sr_customer_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk
           Buffers: shared hit=807949 read=96673
           ->  Sort  (cost=65271.39..65271.39 rows=1 width=18) (actual time=370.023..370.787 rows=79 loops=1)
                 Sort Key: store_returns.sr_customer_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk
                 Sort Method: quicksort  Memory: 31kB
                 Buffers: shared hit=807949 read=96673
                 ->  Gather  (cost=1000.87..65271.38 rows=1 width=18) (actual time=24.256..370.647 rows=79 loops=1)
                       Workers Planned: 2
                       Workers Launched: 2
                       Buffers: shared hit=807946 read=96673
                       ->  Nested Loop  (cost=0.87..64271.28 rows=1 width=18) (actual time=18.268..219.648 rows=26 loops=3)
                             Buffers: shared hit=807946 read=96673
                             ->  Nested Loop  (cost=0.72..64270.85 rows=2 width=18) (actual time=3.180..218.581 rows=615 loops=3)
                                   Buffers: shared hit=804276 read=96667
                                   ->  Parallel Index Only Scan using _dta_index_date_dim_6_661577395__k1_k7_k9 on date_dim  (cost=0.29..1677.88 rows=172 width=4) (actual time=0.306..0.546 rows=122 loops=3)
                                         Index Cond: (d_year = 2002)
                                         Heap Fetches: 0
                                         Buffers: shared hit=3 read=281
                                   ->  Index Scan using _dta_index_store_returns_6_1013578649__k1_3_4_10 on store_returns  (cost=0.43..363.90 rows=1 width=22) (actual time=0.371..1.790 rows=5 loops=365)
                                         Index Cond: (sr_returned_date_sk = date_dim.d_date_sk)
                                         Filter: ((sr_reason_sk >= 43) AND (sr_reason_sk <= 46) AND ((sr_return_amt / (sr_return_quantity)::numeric) >= '108'::numeric) AND ((sr_return_amt / (sr_return_quantity)::numeric) <= '167'::numeric))
                                         Rows Removed by Filter: 2869
                                         Buffers: shared hit=804273 read=96386
                             ->  Index Scan using _dta_index_store_6_885578193__k1_2_6 on store store_1  (cost=0.14..0.21 rows=1 width=4) (actual time=0.001..0.001 rows=0 loops=1845)
                                   Index Cond: (s_store_sk = store_returns.sr_store_sk)
                                   Filter: (s_state = ANY ('{IL,KY,TX}'::bpchar[]))
                                   Rows Removed by Filter: 1
                                   Buffers: shared hit=3670 read=6
   ->  Sort  (cost=25.52..25.78 rows=102 width=17) (actual time=371.150..371.153 rows=0 loops=1)
         Sort Key: customer.c_customer_id
         Sort Method: quicksort  Memory: 25kB
         Buffers: shared hit=808002 read=96735
         ->  Nested Loop  (cost=0.85..22.12 rows=102 width=17) (actual time=371.134..371.137 rows=0 loops=1)
               Buffers: shared hit=807999 read=96735
               ->  Nested Loop  (cost=0.85..15.08 rows=1 width=17) (actual time=371.133..371.136 rows=0 loops=1)
                     Buffers: shared hit=807999 read=96735
                     ->  Nested Loop  (cost=0.42..8.51 rows=1 width=21) (actual time=371.133..371.135 rows=0 loops=1)
                           Buffers: shared hit=807999 read=96735
                           ->  CTE Scan on customer_total_return ctr1  (cost=0.00..0.06 rows=1 width=4) (actual time=370.157..370.826 rows=28 loops=1)
                                 Filter: (ctr_total_return > (SubPlan 2))
                                 Rows Removed by Filter: 51
                                 Buffers: shared hit=807949 read=96673
                                 SubPlan 2
                                   ->  Aggregate  (cost=0.03..0.04 rows=1 width=32) (actual time=0.009..0.009 rows=1 loops=79)
                                         ->  CTE Scan on customer_total_return ctr2  (cost=0.00..0.02 rows=1 width=32) (actual time=0.000..0.006 rows=29 loops=79)
                                               Filter: (ctr1.ctr_store_sk = ctr_store_sk)
                                               Rows Removed by Filter: 50
                           ->  Index Scan using _dta_index_customer_6_949578421__k1_k5 on customer  (cost=0.42..8.45 rows=1 width=25) (actual time=0.011..0.011 rows=0 loops=28)
                                 Index Cond: (c_customer_sk = ctr1.ctr_customer_sk)
                                 Filter: ((c_birth_year >= 1965) AND (c_birth_year <= 1971) AND (c_birth_month = 2))
                                 Rows Removed by Filter: 1
                                 Buffers: shared hit=50 read=62
                     ->  Index Scan using customer_demographics_pkey on customer_demographics  (cost=0.43..6.56 rows=1 width=4) (never executed)
                           Index Cond: (cd_demo_sk = customer.c_current_cdemo_sk)
                           Filter: ((cd_marital_status = ANY ('{M,M}'::bpchar[])) AND (cd_education_status = ANY ('{"Advanced Degree",College}'::bpchar[])) AND (cd_gender = 'F'::bpchar))
               ->  Seq Scan on store  (cost=0.00..6.02 rows=102 width=0) (never executed)
 Planning:
   Buffers: shared hit=508 read=82
 Planning Time: 1.696 ms
 Execution Time: 372.029 ms
(64 rows)

