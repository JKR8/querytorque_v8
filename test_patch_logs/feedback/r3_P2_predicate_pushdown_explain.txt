                                                                                                                                  QUERY PLAN                                                                                                                                   
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 Limit  (cost=66630.81..66630.82 rows=1 width=17) (actual time=442.193..442.261 rows=0 loops=1)
   Buffers: shared hit=807108 read=97014
   CTE customer_total_return
     ->  Finalize GroupAggregate  (cost=66608.62..66608.94 rows=3 width=44) (actual time=340.981..341.838 rows=1845 loops=1)
           Group Key: store_returns.sr_customer_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk
           Buffers: shared hit=804010 read=96947
           ->  Gather Merge  (cost=66608.62..66608.87 rows=2 width=44) (actual time=340.973..341.277 rows=1845 loops=1)
                 Workers Planned: 2
                 Workers Launched: 2
                 Buffers: shared hit=804010 read=96947
                 ->  Partial GroupAggregate  (cost=65608.59..65608.62 rows=1 width=44) (actual time=201.552..201.761 rows=615 loops=3)
                       Group Key: store_returns.sr_customer_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk
                       Buffers: shared hit=804010 read=96947
                       ->  Sort  (cost=65608.59..65608.60 rows=1 width=18) (actual time=201.543..201.570 rows=615 loops=3)
                             Sort Key: store_returns.sr_customer_sk, store_returns.sr_store_sk, store_returns.sr_reason_sk
                             Sort Method: quicksort  Memory: 47kB
                             Buffers: shared hit=804010 read=96947
                             Worker 0:  Sort Method: quicksort  Memory: 46kB
                             Worker 1:  Sort Method: quicksort  Memory: 149kB
                             ->  Nested Loop  (cost=0.72..65608.58 rows=1 width=18) (actual time=2.107..201.211 rows=615 loops=3)
                                   Buffers: shared hit=803996 read=96947
                                   ->  Parallel Index Only Scan using _dta_index_date_dim_6_661577395__k1_k7_k9 on date_dim  (cost=0.29..1677.88 rows=172 width=4) (actual time=0.249..0.471 rows=122 loops=3)
                                         Index Cond: (d_year = 2002)
                                         Heap Fetches: 0
                                         Buffers: shared hit=4 read=280
                                   ->  Index Scan using _dta_index_store_returns_6_1013578649__k1_3_4_10 on store_returns  (cost=0.43..371.68 rows=1 width=22) (actual time=0.338..1.647 rows=5 loops=365)
                                         Index Cond: (sr_returned_date_sk = date_dim.d_date_sk)
                                         Filter: ((sr_return_quantity <> 0) AND (sr_reason_sk >= 43) AND (sr_reason_sk <= 46) AND ((sr_return_amt / (sr_return_quantity)::numeric) >= '108'::numeric) AND ((sr_return_amt / (sr_return_quantity)::numeric) <= '167'::numeric))
                                         Rows Removed by Filter: 2869
                                         Buffers: shared hit=803992 read=96667
   ->  Sort  (cost=21.88..21.88 rows=1 width=17) (actual time=442.192..442.194 rows=0 loops=1)
         Sort Key: customer.c_customer_id
         Sort Method: quicksort  Memory: 25kB
         Buffers: shared hit=125719 read=14057
         ->  Nested Loop  (cost=0.85..21.87 rows=1 width=17) (actual time=442.181..442.182 rows=0 loops=1)
               Buffers: shared hit=125716 read=14057
               ->  Nested Loop  (cost=0.42..15.30 rows=1 width=21) (actual time=442.180..442.181 rows=0 loops=1)
                     Buffers: shared hit=125716 read=14057
                     ->  Nested Loop  (cost=0.00..6.85 rows=1 width=4) (actual time=347.083..441.550 rows=28 loops=1)
                           Join Filter: (ctr1.ctr_store_sk = store.s_store_sk)
                           Rows Removed by Join Filter: 5468
                           Buffers: shared hit=125666 read=13995
                           ->  CTE Scan on customer_total_return ctr1  (cost=0.00..0.34 rows=1 width=8) (actual time=342.015..433.952 rows=622 loops=1)
                                 Filter: ((ctr_reason_sk >= 43) AND (ctr_reason_sk <= 46) AND (ctr_total_return > (SubPlan 2)))
                                 Rows Removed by Filter: 1223
                                 Buffers: shared hit=122621 read=13990
                                 SubPlan 2
                                   ->  Aggregate  (cost=0.07..0.09 rows=1 width=32) (actual time=0.050..0.050 rows=1 loops=1845)
                                         ->  CTE Scan on customer_total_return ctr2  (cost=0.00..0.07 rows=1 width=32) (actual time=0.002..0.047 rows=48 loops=1845)
                                               Filter: (ctr1.ctr_store_sk = ctr_store_sk)
                                               Rows Removed by Filter: 1797
                           ->  Seq Scan on store  (cost=0.00..6.40 rows=9 width=4) (actual time=0.001..0.012 rows=9 loops=622)
                                 Filter: (s_state = ANY ('{IL,KY,TX}'::bpchar[]))
                                 Rows Removed by Filter: 91
                                 Buffers: shared hit=3045 read=5
                     ->  Index Scan using _dta_index_customer_6_949578421__k1_k5 on customer  (cost=0.42..8.45 rows=1 width=25) (actual time=0.022..0.022 rows=0 loops=28)
                           Index Cond: (c_customer_sk = ctr1.ctr_customer_sk)
                           Filter: ((c_birth_year >= 1965) AND (c_birth_year <= 1971) AND (c_birth_month = 2))
                           Rows Removed by Filter: 1
                           Buffers: shared hit=50 read=62
               ->  Index Scan using customer_demographics_pkey on customer_demographics  (cost=0.43..6.56 rows=1 width=4) (never executed)
                     Index Cond: (cd_demo_sk = customer.c_current_cdemo_sk)
                     Filter: ((cd_marital_status = ANY ('{M,M}'::bpchar[])) AND (cd_education_status = ANY ('{"Advanced Degree",College}'::bpchar[])) AND (cd_gender = 'F'::bpchar))
 Planning:
   Buffers: shared hit=498 read=83
 Planning Time: 1.022 ms
 Execution Time: 442.390 ms
(67 rows)

