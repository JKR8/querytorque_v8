{
  "query_id": "Q21",
  "started": "2026-02-14T19:33:44.097224",
  "theory": "Query rewrite + clustering + QAS enables 2-4x warehouse downsizing",
  "diagnostics": {
    "clustering_inventory_date": {
      "cluster_by_keys": "LINEAR(INV_DATE_SK)",
      "total_partition_count": 279,
      "total_constant_partition_count": 49,
      "average_overlaps": 1.7133,
      "average_depth": 1.9821,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 34,
        "00002": 216,
        "00003": 29,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0
      },
      "clustering_errors": []
    },
    "clustering_inventory_both": {
      "cluster_by_keys": "LINEAR(INV_DATE_SK, INV_ITEM_SK)",
      "notes": "Clustering key columns contain high cardinality key INV_ITEM_SK which might result in expensive re-clustering. Please refer to https://docs.snowflake.net/manuals/user-guide/tables-clustering-keys.html for more information.",
      "total_partition_count": 279,
      "total_constant_partition_count": 0,
      "average_overlaps": 1.9642,
      "average_depth": 2.147,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 7,
        "00002": 224,
        "00003": 48,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0
      },
      "clustering_errors": []
    },
    "row_count_inventory": 1311525000,
    "row_count_warehouse": 25,
    "row_count_item": 402000,
    "row_count_date_dim": 73049,
    "recent_spills": [
      {
        "query_id": "01c26323-3205-62cc-0000-0002fcfe9bf9",
        "preview": "WITH d_ss AS (SELECT d_date_sk FROM date_dim WHERE d_year = ",
        "warehouse_size": "X-Small",
        "seconds": "184.890000",
        "mb_local": "1766.648437500000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26365-3205-62cc-0000-0002fcfe9f31",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk, d_year FROM date",
        "warehouse_size": "X-Small",
        "seconds": "300.038000",
        "mb_local": "12083.000000000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2630e-3205-62cc-0000-0002fcfe9b69",
        "preview": "WITH d_ss AS (SELECT d_date_sk FROM date_dim WHERE d_year = ",
        "warehouse_size": "X-Small",
        "seconds": "108.733000",
        "mb_local": "125.855468750000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26353-3205-62cc-0000-0002fcfe9d4d",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk FROM date_dim WHE",
        "warehouse_size": "X-Small",
        "seconds": "78.931000",
        "mb_local": "5013.269531250000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2622d-3205-62cc-0000-0002fcfe8d01",
        "preview": "select i_item_id,\n        ca_country,\n        ca_state, \n   ",
        "warehouse_size": "X-Small",
        "seconds": "144.250000",
        "mb_local": "503.187500000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2626b-3205-62cc-0000-0002fcfe945d",
        "preview": "select ss_customer_sk\n            ,sum(act_sales) sumsales\n ",
        "warehouse_size": "X-Small",
        "seconds": "300.116000",
        "mb_local": "3665.000000000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c262d3-3205-62cc-0000-0002fcfe9a0d",
        "preview": "WITH d1 AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 A",
        "warehouse_size": "X-Small",
        "seconds": "95.230000",
        "mb_local": "17911.039062500000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26343-3205-62cc-0000-0002fcfe9d01",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk, d_year, d_qoy, d",
        "warehouse_size": "X-Small",
        "seconds": "300.023000",
        "mb_local": "8819.000000000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2636a-3205-62cc-0000-0002fcfe9f51",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk FROM date_dim WHE",
        "warehouse_size": "X-Small",
        "seconds": "89.558000",
        "mb_local": "6842.195312500000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26316-3205-62cc-0000-0002fcfe9ba5",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk, d_date FROM date",
        "warehouse_size": "X-Small",
        "seconds": "300.000000",
        "mb_local": "5901.070312500000",
        "mb_remote": "0E-12"
      }
    ],
    "warehouse": {
      "name": "COMPUTE_WH",
      "state": "STARTED",
      "type": "STANDARD",
      "size": "X-Small",
      "auto_suspend": "60"
    }
  },
  "explain_plans": {
    "original": "GlobalStats | 283 | 283 | 3684704256\n1 | 0 | Result | WAREHOUSE.W_WAREHOUSE_NAME, ITEM.I_ITEM_ID, SUM(CASE_FLATTENED((DATE_DIM.D_DATE) < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)), SUM(CASE_FLATTENED((DATE_DIM.D_DATE) >= '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))\n1 | 1 | [0] | SortWithLimit | sortKey: [X.W_WAREHOUSE_NAME ASC NULLS LAST, X.I_ITEM_ID ASC NULLS LAST], rowCount: 100\n1 | 2 | [1] | Filter | ((CASE_FLATTENED((SUM(CASE_FLATTENED((DATE_DIM.D_DATE) < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))) > 0, SCALED_ROUND_INT_DIVIDE(SUM(CASE_FLATTENED((DATE_DIM.D_DATE) >= '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)), SUM(CASE_FLATTENED((DATE_DIM.D_DATE) < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))), null)) >= (2 / 3)) AND ((CASE_FLATTENED((SUM(CASE_FLATTENED((DATE_DIM.D_DATE) < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))) > 0, SCALED_ROUND_INT_DIVIDE(SUM(CASE_FLATTENED((DATE_DIM.D_DATE) >= '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)), SUM(CASE_FLATTENED((DATE_DIM.D_DATE) < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))), null)) <= (3 / 2))\n1 | 3 | [2] | Aggregate | aggExprs: [SUM(CASE_FLATTENED((DATE_DIM.D_DATE) < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)).condAggr(0), SUM(CASE_FLATTENED((DATE_DIM.D_DATE) >= '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)).condAggr(1)], groupKeys: [WAREHOUSE.W_WAREHOUSE_NAME, ITEM.I_ITEM_ID]\n1 | 4 | [3] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(INVENTORY.INV_QUANTITY_ON_HAND))))], groupKeys: [IFF((DATE_DIM.D_DATE) < '2002-02-27', 0, IFF((DATE_DIM.D_DATE) >= '2002-02-27', 1, null)), WAREHOUSE.W_WAREHOUSE_NAME, ITEM.I_ITEM_ID]\n1 | 5 | [4] | InnerJoin | joinKey: (WAREHOUSE.W_WAREHOUSE_SK = INVENTORY.INV_WAREHOUSE_SK)\n1 | 6 | [5] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WAREHOUSE | W_WAREHOUSE_SK, W_WAREHOUSE_NAME | 1 | 1 | 7168\n1 | 7 | [5] | Aggregate | aggExprs: [SUM(SUM(SUM(INVENTORY.INV_QUANTITY_ON_HAND)))], groupKeys: [IFF((DATE_DIM.D_DATE) < '2002-02-27', 0, IFF((DATE_DIM.D_DATE) >= '2002-02-27', 1, null)), ITEM.I_ITEM_ID, INVENTORY.INV_WAREHOUSE_SK]\n1 | 8 | [7] | InnerJoin | joinKey: (DATE_DIM.D_DATE_SK = INVENTORY.INV_DATE_SK)\n1 | 9 | [8] | Filter | (DATE_DIM.D_DATE >= '2002-01-28') AND (DATE_DIM.D_DATE <= '2002-03-29')\n1 | 10 | [9] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE_SK, D_DATE | 1 | 1 | 2138624\n1 | 11 | [8] | Aggregate | aggExprs: [SUM(SUM(INVENTORY.INV_QUANTITY_ON_HAND))], groupKeys: [ITEM.I_ITEM_ID, INVENTORY.INV_WAREHOUSE_SK, INVENTORY.INV_DATE_SK]\n1 | 12 | [11] | InnerJoin | joinKey: (ITEM.I_ITEM_SK = INVENTORY.INV_ITEM_SK)\n1 | 13 | [12] | Filter | (ITEM.I_CURRENT_PRICE >= 0.99) AND (ITEM.I_CURRENT_PRICE <= 1.49)\n1 | 14 | [13] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM | I_ITEM_SK, I_ITEM_ID, I_CURRENT_PRICE | 2 | 2 | 23811584\n1 | 15 | [12] | Aggregate | aggExprs: [SUM(INVENTORY.INV_QUANTITY_ON_HAND)], groupKeys: [INVENTORY.INV_WAREHOUSE_SK, INVENTORY.INV_DATE_SK, INVENTORY.INV_ITEM_SK]\n1 | 16 | [15] | JoinFilter | joinKey: (WAREHOUSE.W_WAREHOUSE_SK = INVENTORY.INV_WAREHOUSE_SK)\n1 | 17 | [16] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.INVENTORY | INV_DATE_SK, INV_ITEM_SK, INV_WAREHOUSE_SK, INV_QUANTITY_ON_HAND | 279 | 279 | 3658746880",
    "optimized": "GlobalStats | 283 | 283 | 3684704256\n1 | 0 | Result | WAREHOUSE.W_WAREHOUSE_NAME, ITEM.I_ITEM_ID, SUM(CASE_FLATTENED(DATE_DIM.D_DATE < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)), SUM(CASE_FLATTENED(DATE_DIM.D_DATE >= '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))\n1 | 1 | [0] | SortWithLimit | sortKey: [X.W_WAREHOUSE_NAME ASC NULLS LAST, X.I_ITEM_ID ASC NULLS LAST], rowCount: 100\n1 | 2 | [1] | Filter | ((CASE_FLATTENED((SUM(CASE_FLATTENED(DATE_DIM.D_DATE < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))) > 0, SCALED_ROUND_INT_DIVIDE(SUM(CASE_FLATTENED(DATE_DIM.D_DATE >= '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)), SUM(CASE_FLATTENED(DATE_DIM.D_DATE < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))), null)) >= (2 / 3)) AND ((CASE_FLATTENED((SUM(CASE_FLATTENED(DATE_DIM.D_DATE < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))) > 0, SCALED_ROUND_INT_DIVIDE(SUM(CASE_FLATTENED(DATE_DIM.D_DATE >= '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)), SUM(CASE_FLATTENED(DATE_DIM.D_DATE < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0))), null)) <= (3 / 2))\n1 | 3 | [2] | Aggregate | aggExprs: [SUM(CASE_FLATTENED(DATE_DIM.D_DATE < '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)).condAggr(0), SUM(CASE_FLATTENED(DATE_DIM.D_DATE >= '2002-02-27', INVENTORY.INV_QUANTITY_ON_HAND, 0)).condAggr(1)], groupKeys: [WAREHOUSE.W_WAREHOUSE_NAME, ITEM.I_ITEM_ID]\n1 | 4 | [3] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(INVENTORY.INV_QUANTITY_ON_HAND))))], groupKeys: [IFF(DATE_DIM.D_DATE < '2002-02-27', 0, IFF(DATE_DIM.D_DATE >= '2002-02-27', 1, null)), WAREHOUSE.W_WAREHOUSE_NAME, ITEM.I_ITEM_ID]\n1 | 5 | [4] | InnerJoin | joinKey: (WAREHOUSE.W_WAREHOUSE_SK = INVENTORY.INV_WAREHOUSE_SK)\n1 | 6 | [5] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.WAREHOUSE | W_WAREHOUSE_SK, W_WAREHOUSE_NAME | 1 | 1 | 7168\n1 | 7 | [5] | Aggregate | aggExprs: [SUM(SUM(SUM(INVENTORY.INV_QUANTITY_ON_HAND)))], groupKeys: [IFF(DATE_DIM.D_DATE < '2002-02-27', 0, IFF(DATE_DIM.D_DATE >= '2002-02-27', 1, null)), ITEM.I_ITEM_ID, INVENTORY.INV_WAREHOUSE_SK]\n1 | 8 | [7] | InnerJoin | joinKey: (DATE_DIM.D_DATE_SK = INVENTORY.INV_DATE_SK)\n1 | 9 | [8] | Filter | (DATE_DIM.D_DATE >= '2002-01-28') AND (DATE_DIM.D_DATE <= '2002-03-29')\n1 | 10 | [9] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE_SK, D_DATE | 1 | 1 | 2138624\n1 | 11 | [8] | Aggregate | aggExprs: [SUM(SUM(INVENTORY.INV_QUANTITY_ON_HAND))], groupKeys: [ITEM.I_ITEM_ID, INVENTORY.INV_WAREHOUSE_SK, INVENTORY.INV_DATE_SK]\n1 | 12 | [11] | InnerJoin | joinKey: (ITEM.I_ITEM_SK = INVENTORY.INV_ITEM_SK)\n1 | 13 | [12] | Filter | (ITEM.I_CURRENT_PRICE >= 0.99) AND (ITEM.I_CURRENT_PRICE <= 1.49)\n1 | 14 | [13] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM | I_ITEM_SK, I_ITEM_ID, I_CURRENT_PRICE | 2 | 2 | 23811584\n1 | 15 | [12] | Aggregate | aggExprs: [SUM(INVENTORY.INV_QUANTITY_ON_HAND)], groupKeys: [INVENTORY.INV_WAREHOUSE_SK, INVENTORY.INV_DATE_SK, INVENTORY.INV_ITEM_SK]\n1 | 16 | [15] | JoinFilter | joinKey: (WAREHOUSE.W_WAREHOUSE_SK = INVENTORY.INV_WAREHOUSE_SK)\n1 | 17 | [16] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.INVENTORY | INV_DATE_SK, INV_ITEM_SK, INV_WAREHOUSE_SK, INV_QUANTITY_ON_HAND | 279 | 279 | 3658746880"
  },
  "equivalence": {
    "verified": true,
    "details": {
      "columns_match": true,
      "rows_match": true,
      "checksums_match": true,
      "original_checksum": "795228c014ebe2380f20df61f00e4166",
      "optimized_checksum": "795228c014ebe2380f20df61f00e4166",
      "original_row_count": 100,
      "optimized_row_count": 100,
      "original_columns": [
        "w_warehouse_name",
        "i_item_id",
        "inv_before",
        "inv_after"
      ],
      "optimized_columns": [
        "w_warehouse_name",
        "i_item_id",
        "inv_before",
        "inv_after"
      ],
      "original_time_s": 1.7236,
      "optimized_time_s": 0.6735,
      "original_query_id": "01c26741-3205-631a-0000-0002fcfea099",
      "optimized_query_id": "01c26741-3205-631a-0000-0002fcfea09d",
      "original_sample": [
        "Agricultural measur|AAAAAAAAAAABAAAA|944|1363",
        "Agricultural measur|AAAAAAAAAAADEAAA|2330|2339",
        "Agricultural measur|AAAAAAAAAAAPEAAA|1596|1668",
        "Agricultural measur|AAAAAAAAAABKDAAA|2167|3024",
        "Agricultural measur|AAAAAAAAAACAFAAA|2772|3283"
      ],
      "optimized_sample": [
        "Agricultural measur|AAAAAAAAAAABAAAA|944|1363",
        "Agricultural measur|AAAAAAAAAAADEAAA|2330|2339",
        "Agricultural measur|AAAAAAAAAAAPEAAA|1596|1668",
        "Agricultural measur|AAAAAAAAAABKDAAA|2167|3024",
        "Agricultural measur|AAAAAAAAAACAFAAA|2772|3283"
      ],
      "diffs": null
    }
  },
  "benchmarks": [
    {
      "label": "XSMALL/QAS=OFF/original",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 0.1061,
          "query_id": "01c26741-3205-631a-0000-0002fcfea0b1",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 0.0775,
          "query_id": "01c26741-3205-631a-0000-0002fcfea0b9",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 0.0748,
          "query_id": "01c26741-3205-631a-0000-0002fcfea0c1",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 0.0761,
      "status": "OK",
      "warehouse_size": "XSMALL",
      "qas_enabled": false,
      "variant": "original",
      "config_description": "Baseline: cheapest warehouse, no help"
    },
    {
      "label": "XSMALL/QAS=OFF/optimized",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 0.0819,
          "query_id": "01c26741-3205-631a-0000-0002fcfea0cd",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 0.0826,
          "query_id": "01c26742-3205-631a-0000-0002fcfea0d5",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 0.0841,
          "query_id": "01c26742-3205-631a-0000-0002fcfea0dd",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 0.0834,
      "status": "OK",
      "warehouse_size": "XSMALL",
      "qas_enabled": false,
      "variant": "optimized",
      "config_description": "Baseline: cheapest warehouse, no help"
    },
    {
      "label": "SMALL/QAS=OFF/original",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 0.0859,
          "query_id": "01c26742-3205-631a-0000-0002fcfea0f5",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 0.0762,
          "query_id": "01c26742-3205-631a-0000-0002fcfea0fd",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 0.0866,
          "query_id": "01c26742-3205-631a-0000-0002fcfea105",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 0.0814,
      "status": "OK",
      "warehouse_size": "SMALL",
      "qas_enabled": false,
      "variant": "original",
      "config_description": "Small warehouse"
    },
    {
      "label": "SMALL/QAS=OFF/optimized",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 0.0885,
          "query_id": "01c26742-3205-631a-0000-0002fcfea111",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 0.0978,
          "query_id": "01c26742-3205-631a-0000-0002fcfea119",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 0.0837,
          "query_id": "01c26742-3205-631a-0000-0002fcfea121",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 0.0907,
      "status": "OK",
      "warehouse_size": "SMALL",
      "qas_enabled": false,
      "variant": "optimized",
      "config_description": "Small warehouse"
    },
    {
      "label": "MEDIUM/QAS=OFF/original",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 0.0842,
          "query_id": "01c26742-3205-631a-0000-0002fcfea139",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 0.0863,
          "query_id": "01c26742-3205-631a-0000-0002fcfea141",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 0.0763,
          "query_id": "01c26742-3205-631a-0000-0002fcfea149",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 0.0813,
      "status": "OK",
      "warehouse_size": "MEDIUM",
      "qas_enabled": false,
      "variant": "original",
      "config_description": "Medium warehouse (standard rec for SF10)"
    },
    {
      "label": "MEDIUM/QAS=OFF/optimized",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 0.0948,
          "query_id": "01c26742-3205-631a-0000-0002fcfea155",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 0.0908,
          "query_id": "01c26742-3205-631a-0000-0002fcfea15d",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 0.1104,
          "query_id": "01c26742-3205-631a-0000-0002fcfea165",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 0.1006,
      "status": "OK",
      "warehouse_size": "MEDIUM",
      "qas_enabled": false,
      "variant": "optimized",
      "config_description": "Medium warehouse (standard rec for SF10)"
    }
  ],
  "finished": "2026-02-14T19:34:09.555344"
}