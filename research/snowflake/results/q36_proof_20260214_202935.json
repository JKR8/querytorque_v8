{
  "query_id": "Q36",
  "started": "2026-02-14T20:16:57.868601",
  "theory": "Query rewrite + clustering + QAS enables 2-4x warehouse downsizing",
  "result_cache": "DISABLED",
  "diagnostics": {
    "clustering_store_sales_ss_sold_date_sk": {
      "cluster_by_keys": "LINEAR(SS_SOLD_DATE_SK)",
      "total_partition_count": 72718,
      "total_constant_partition_count": 71078,
      "average_overlaps": 0.0705,
      "average_depth": 1.0521,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 71006,
        "00002": 1660,
        "00003": 6,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0,
        "00064": 46
      },
      "clustering_errors": []
    },
    "clustering_store_sales_ss_sold_date_sk_ss_item_sk": {
      "cluster_by_keys": "LINEAR(SS_SOLD_DATE_SK, SS_ITEM_SK)",
      "total_partition_count": 72718,
      "total_constant_partition_count": 0,
      "average_overlaps": 122.4113,
      "average_depth": 122.5241,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 0,
        "00002": 0,
        "00003": 0,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0,
        "00032": 23543,
        "00064": 23303,
        "00128": 23566,
        "04096": 2306
      },
      "clustering_errors": []
    },
    "clustering_inventory_inv_date_sk": {
      "cluster_by_keys": "LINEAR(INV_DATE_SK)",
      "total_partition_count": 279,
      "total_constant_partition_count": 49,
      "average_overlaps": 1.7133,
      "average_depth": 1.9821,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 34,
        "00002": 216,
        "00003": 29,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0
      },
      "clustering_errors": []
    },
    "clustering_catalog_sales_cs_sold_date_sk": {
      "cluster_by_keys": "LINEAR(CS_SOLD_DATE_SK)",
      "total_partition_count": 54922,
      "total_constant_partition_count": 53265,
      "average_overlaps": 0.0547,
      "average_depth": 1.0307,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 53245,
        "00002": 1669,
        "00003": 8,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0
      },
      "clustering_errors": []
    },
    "clustering_web_sales_ws_sold_date_sk": {
      "cluster_by_keys": "LINEAR(WS_SOLD_DATE_SK)",
      "total_partition_count": 27579,
      "total_constant_partition_count": 25931,
      "average_overlaps": 0.1094,
      "average_depth": 1.0618,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 25905,
        "00002": 1659,
        "00003": 10,
        "00004": 0,
        "00005": 0,
        "00006": 5,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0
      },
      "clustering_errors": []
    },
    "row_count_store_sales": 28800239865,
    "row_count_inventory": 1311525000,
    "row_count_catalog_sales": 14399964710,
    "row_count_web_sales": 7199963324,
    "row_count_warehouse": 25,
    "row_count_item": 402000,
    "row_count_store": 1500,
    "row_count_date_dim": 73049,
    "recent_spills": [
      {
        "query_id": "01c26245-3205-62cc-0000-0002fcfe8fed",
        "preview": "select c_last_name\n       ,c_first_name\n       ,ca_city\n    ",
        "warehouse_size": "X-Small",
        "seconds": "265.208000",
        "mb_local": "96.074218750000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26305-3205-62cc-0000-0002fcfe9afd",
        "preview": "WITH d_ss AS (SELECT d_date_sk FROM date_dim WHERE d_year = ",
        "warehouse_size": "X-Small",
        "seconds": "299.012000",
        "mb_local": "5269.964843750000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26215-3205-62cc-0000-0002fcfe8b49",
        "preview": "with year_total as (\n select c_customer_id customer_id\n     ",
        "warehouse_size": "X-Small",
        "seconds": "299.019000",
        "mb_local": "11759.000000000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2636c-3205-62cc-0000-0002fcfe9f61",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk, d_year FROM date",
        "warehouse_size": "X-Small",
        "seconds": "300.027000",
        "mb_local": "8251.000000000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2622d-3205-62cc-0000-0002fcfe8cf9",
        "preview": "select i_brand_id brand_id, i_brand brand, i_manufact_id, i_",
        "warehouse_size": "X-Small",
        "seconds": "59.159000",
        "mb_local": "437.652343750000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2622d-3205-62cc-0000-0002fcfe8d11",
        "preview": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name",
        "warehouse_size": "X-Small",
        "seconds": "283.009000",
        "mb_local": "15597.082031250000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2636e-3205-62cc-0000-0002fcfe9f69",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk FROM date_dim WHE",
        "warehouse_size": "X-Small",
        "seconds": "248.168000",
        "mb_local": "7182.609375000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c262d3-3205-62cc-0000-0002fcfe9a0d",
        "preview": "WITH d1 AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 A",
        "warehouse_size": "X-Small",
        "seconds": "95.230000",
        "mb_local": "17911.039062500000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26323-3205-62cc-0000-0002fcfe9bf9",
        "preview": "WITH d_ss AS (SELECT d_date_sk FROM date_dim WHERE d_year = ",
        "warehouse_size": "X-Small",
        "seconds": "184.890000",
        "mb_local": "1766.648437500000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c262c7-3205-62cc-0000-0002fcfe9971",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk FROM date_dim WHE",
        "warehouse_size": "X-Small",
        "seconds": "70.468000",
        "mb_local": "3448.859375000000",
        "mb_remote": "0E-12"
      }
    ],
    "warehouse": {
      "name": "COMPUTE_WH",
      "state": "STARTED",
      "type": "STANDARD",
      "size": "X-Small",
      "auto_suspend": "60"
    }
  },
  "explain_plans": {
    "original": "GlobalStats | 72722 | 72722 | 1251950176768\n1 | 0 | Result | (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))), ITEM.I_CATEGORY, ITEM.I_CLASS, (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) ASC NULLS LAST)\n1 | 1 | [0] | SortWithLimit | sortKey: [(GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)) DESC NULLS FIRST, CASE_FLATTENED(((GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS))) = 0, ITEM.I_CATEGORY, null) ASC NULLS LAST, RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(STORE_SALES.SS_NET_PROFIT)) / (SUM(STORE_SALES.SS_EXT_SALES_PRICE)) ASC NULLS LAST) ASC NULLS LAST], rowCount: 100\n1 | 2 | [1] | WindowFunction | RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) ASC NULLS LAST), RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) ASC NULLS LAST)\n1 | 3 | [2] | GroupingSets | SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE)\n1 | 4 | [3] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))))), SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))], groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS]\n1 | 5 | [4] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))), SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))))], groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS]\n1 | 6 | [5] | InnerJoin | joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)\n1 | 7 | [6] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM | I_ITEM_SK, I_CLASS, I_CATEGORY | 2 | 2 | 23811584\n1 | 8 | [6] | Aggregate | aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))), SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))], groupKeys: [STORE_SALES.SS_ITEM_SK]\n1 | 9 | [8] | InnerJoin | joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)\n1 | 10 | [9] | Filter | STORE.S_STATE IN 'SD' IN 'TN' IN 'GA' IN 'SC' IN 'MO' IN 'AL' IN 'MI' IN 'OH'\n1 | 11 | [10] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE | S_STORE_SK, S_STATE | 1 | 1 | 135680\n1 | 12 | [9] | Aggregate | aggExprs: [SUM(SUM(STORE_SALES.SS_NET_PROFIT)), SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))], groupKeys: [STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_STORE_SK]\n1 | 13 | [12] | InnerJoin | joinKey: (D1.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)\n1 | 14 | [13] | Filter | D1.D_YEAR = 2002\n1 | 15 | [14] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D1 | D_DATE_SK, D_YEAR | 1 | 1 | 2138624\n1 | 16 | [13] | Aggregate | aggExprs: [SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE)], groupKeys: [STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_SOLD_DATE_SK]\n1 | 17 | [16] | Filter | (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)\n1 | 18 | [17] | JoinFilter | joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)\n1 | 19 | [18] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES | SS_SOLD_DATE_SK, SS_ITEM_SK, SS_STORE_SK, SS_EXT_SALES_PRICE, SS_NET_PROFIT | 72718 | 72718 | 1251924090880",
    "optimized": "GlobalStats | 72722 | 72722 | 1251950176768\n1 | 0 | Result | UNION_ALL((BASE_AGG.SUM_NET_PROFIT) / (BASE_AGG.SUM_SALES_PRICE), SCALED_ROUND_INT_DIVIDE(SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE)), SCALED_ROUND_INT_DIVIDE(SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE))), UNION_ALL(BASE_AGG.I_CATEGORY, BASE_AGG.I_CATEGORY, null), UNION_ALL(BASE_AGG.I_CLASS, null, null), ROLLUP_LEVELS.LOCHIERARCHY, RANK() OVER (PARTITION BY ROLLUP_LEVELS.LOCHIERARCHY, CASE_FLATTENED(ROLLUP_LEVELS.G_CLASS = 0, UNION_ALL(BASE_AGG.I_CATEGORY, BASE_AGG.I_CATEGORY, null), null) ORDER BY UNION_ALL((BASE_AGG.SUM_NET_PROFIT) / (BASE_AGG.SUM_SALES_PRICE), SCALED_ROUND_INT_DIVIDE(SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE)), SCALED_ROUND_INT_DIVIDE(SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE))) ASC NULLS LAST)\n1 | 1 | [0] | SortWithLimit | sortKey: [ROLLUP_LEVELS.LOCHIERARCHY DESC NULLS FIRST, CASE_FLATTENED(ROLLUP_LEVELS.LOCHIERARCHY = 0, ROLLUP_LEVELS.I_CATEGORY, null) ASC NULLS LAST, RANK() OVER (PARTITION BY ROLLUP_LEVELS.LOCHIERARCHY, CASE_FLATTENED(ROLLUP_LEVELS.G_CLASS = 0, ROLLUP_LEVELS.I_CATEGORY, null) ORDER BY ROLLUP_LEVELS.GROSS_MARGIN ASC NULLS LAST) ASC NULLS LAST], rowCount: 100\n1 | 2 | [1] | WindowFunction | RANK() OVER (PARTITION BY ROLLUP_LEVELS.LOCHIERARCHY, CASE_FLATTENED(ROLLUP_LEVELS.G_CLASS = 0, UNION_ALL(BASE_AGG.I_CATEGORY, BASE_AGG.I_CATEGORY, null), null) ORDER BY UNION_ALL((BASE_AGG.SUM_NET_PROFIT) / (BASE_AGG.SUM_SALES_PRICE), SCALED_ROUND_INT_DIVIDE(SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE)), SCALED_ROUND_INT_DIVIDE(SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE))) ASC NULLS LAST), RANK() OVER (PARTITION BY ROLLUP_LEVELS.LOCHIERARCHY, CASE_FLATTENED(ROLLUP_LEVELS.G_CLASS = 0, UNION_ALL(BASE_AGG.I_CATEGORY, BASE_AGG.I_CATEGORY, null), null) ORDER BY UNION_ALL((BASE_AGG.SUM_NET_PROFIT) / (BASE_AGG.SUM_SALES_PRICE), SCALED_ROUND_INT_DIVIDE(SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE)), SCALED_ROUND_INT_DIVIDE(SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE))) ASC NULLS LAST)\n1 | 3 | [2] | UnionAll\n1 | 4 | [3] | WithReference\n1 | 5 | [4, 23, 25] | WithClause | BASE_AGG\n1 | 6 | [5] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(SUM(SS.SS_NET_PROFIT))))), SUM(SUM(SUM(SUM(SUM(SS.SS_EXT_SALES_PRICE)))))], groupKeys: [I.I_CATEGORY, I.I_CLASS]\n1 | 7 | [6] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(SS.SS_NET_PROFIT)))), SUM(SUM(SUM(SUM(SS.SS_EXT_SALES_PRICE))))], groupKeys: [I.I_CATEGORY, I.I_CLASS]\n1 | 8 | [7] | InnerJoin | joinKey: (I.I_ITEM_SK = SS.SS_ITEM_SK)\n1 | 9 | [8] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM | I | I_ITEM_SK, I_CLASS, I_CATEGORY | 2 | 2 | 23811584\n1 | 10 | [8] | Aggregate | aggExprs: [SUM(SUM(SUM(SS.SS_NET_PROFIT))), SUM(SUM(SUM(SS.SS_EXT_SALES_PRICE)))], groupKeys: [SS.SS_ITEM_SK]\n1 | 11 | [10] | InnerJoin | joinKey: (STORE.S_STORE_SK = SS.SS_STORE_SK)\n1 | 12 | [11] | Filter | STORE.S_STATE IN 'SD' IN 'TN' IN 'GA' IN 'SC' IN 'MO' IN 'AL' IN 'MI' IN 'OH'\n1 | 13 | [12] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE | S_STORE_SK, S_STATE | 1 | 1 | 135680\n1 | 14 | [11] | Aggregate | aggExprs: [SUM(SUM(SS.SS_NET_PROFIT)), SUM(SUM(SS.SS_EXT_SALES_PRICE))], groupKeys: [SS.SS_ITEM_SK, SS.SS_STORE_SK]\n1 | 15 | [14] | InnerJoin | joinKey: (DATE_DIM.D_DATE_SK = SS.SS_SOLD_DATE_SK)\n1 | 16 | [15] | Filter | DATE_DIM.D_YEAR = 2002\n1 | 17 | [16] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE_SK, D_YEAR | 1 | 1 | 2138624\n1 | 18 | [15] | Aggregate | aggExprs: [SUM(SS.SS_NET_PROFIT), SUM(SS.SS_EXT_SALES_PRICE)], groupKeys: [SS.SS_ITEM_SK, SS.SS_STORE_SK, SS.SS_SOLD_DATE_SK]\n1 | 19 | [18] | Filter | (SS.SS_STORE_SK IS NOT NULL) AND (SS.SS_SOLD_DATE_SK IS NOT NULL)\n1 | 20 | [19] | JoinFilter | joinKey: (I.I_ITEM_SK = SS.SS_ITEM_SK)\n1 | 21 | [20] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES | SS | SS_SOLD_DATE_SK, SS_ITEM_SK, SS_STORE_SK, SS_EXT_SALES_PRICE, SS_NET_PROFIT | 72718 | 72718 | 1251924090880\n1 | 22 | [3] | Aggregate | aggExprs: [SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE)], groupKeys: [BASE_AGG.I_CATEGORY]\n1 | 23 | [22] | WithReference\n1 | 24 | [3] | Aggregate | aggExprs: [SUM(BASE_AGG.SUM_NET_PROFIT), SUM(BASE_AGG.SUM_SALES_PRICE)]\n1 | 25 | [24] | WithReference"
  },
  "equivalence": {
    "verified": true,
    "details": {
      "columns_match": true,
      "rows_match": true,
      "checksums_match": true,
      "original_checksum": "730bb61757092fc05a4f527296f7dd20",
      "optimized_checksum": "730bb61757092fc05a4f527296f7dd20",
      "original_row_count": 100,
      "optimized_row_count": 100,
      "original_columns": [
        "gross_margin",
        "i_category",
        "i_class",
        "lochierarchy",
        "rank_within_parent"
      ],
      "optimized_columns": [
        "gross_margin",
        "i_category",
        "i_class",
        "lochierarchy",
        "rank_within_parent"
      ],
      "original_time_s": 20.4346,
      "optimized_time_s": 17.0004,
      "original_query_id": "01c2676d-3205-631a-0000-0002fcfea571",
      "optimized_query_id": "01c2676d-3205-631a-0000-0002fcfea575",
      "original_sample": [
        "-0.43189476|Jewelry|rings|0|17",
        "-0.43223561|Electronics|dvd/vcr players|0|17",
        "-0.43226716|Jewelry|semi-precious|0|16",
        "-0.43231208|Home|NULL|0|17",
        "-0.43233678|Jewelry|costume|0|15"
      ],
      "optimized_sample": [
        "-0.43189476|Jewelry|rings|0|17",
        "-0.43223561|Electronics|dvd/vcr players|0|17",
        "-0.43226716|Jewelry|semi-precious|0|16",
        "-0.43231208|Home|NULL|0|17",
        "-0.43233678|Jewelry|costume|0|15"
      ],
      "diffs": null
    }
  },
  "benchmarks": [
    {
      "label": "XSMALL/QAS=OFF/original",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 72.373,
          "query_id": "01c2676d-3205-631a-0000-0002fcfea589",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 68.532,
          "query_id": "01c2676f-3205-631a-0000-0002fcfea591",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 63.7461,
          "query_id": "01c26770-3205-631a-0000-0002fcfea599",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 66.139,
      "status": "OK",
      "warehouse_size": "XSMALL",
      "qas_enabled": false,
      "variant": "original",
      "config_description": "Baseline: cheapest warehouse, no help"
    },
    {
      "label": "XSMALL/QAS=OFF/optimized",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 62.4264,
          "query_id": "01c26771-3205-631a-0000-0002fcfea5a5",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 64.1398,
          "query_id": "01c26772-3205-631a-0000-0002fcfea5ad",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 62.6395,
          "query_id": "01c26773-3205-631a-0000-0002fcfea5b5",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 63.3896,
      "status": "OK",
      "warehouse_size": "XSMALL",
      "qas_enabled": false,
      "variant": "optimized",
      "config_description": "Baseline: cheapest warehouse, no help"
    },
    {
      "label": "SMALL/QAS=OFF/original",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 37.2983,
          "query_id": "01c26774-3205-631a-0000-0002fcfea5cd",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 33.8052,
          "query_id": "01c26775-3205-631a-0000-0002fcfea5d5",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 32.514,
          "query_id": "01c26775-3205-631a-0000-0002fcfea5dd",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 33.1596,
      "status": "OK",
      "warehouse_size": "SMALL",
      "qas_enabled": false,
      "variant": "original",
      "config_description": "Small warehouse"
    },
    {
      "label": "SMALL/QAS=OFF/optimized",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 32.1893,
          "query_id": "01c26776-3205-631a-0000-0002fcfea5e9",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 32.4257,
          "query_id": "01c26776-3205-631a-0000-0002fcfea5f1",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 31.2333,
          "query_id": "01c26777-3205-631a-0000-0002fcfea5f9",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 31.8295,
      "status": "OK",
      "warehouse_size": "SMALL",
      "qas_enabled": false,
      "variant": "optimized",
      "config_description": "Small warehouse"
    },
    {
      "label": "MEDIUM/QAS=OFF/original",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 18.138,
          "query_id": "01c26777-3205-631a-0000-0002fcfea611",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 15.9725,
          "query_id": "01c26778-3205-631a-0000-0002fcfea619",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 15.1674,
          "query_id": "01c26778-3205-631a-0000-0002fcfea621",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 15.57,
      "status": "OK",
      "warehouse_size": "MEDIUM",
      "qas_enabled": false,
      "variant": "original",
      "config_description": "Medium warehouse (standard rec for SF10)"
    },
    {
      "label": "MEDIUM/QAS=OFF/optimized",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 14.7558,
          "query_id": "01c26778-3205-631a-0000-0002fcfea62d",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 13.9655,
          "query_id": "01c26779-3205-631a-0000-0002fcfea635",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 13.8119,
          "query_id": "01c26779-3205-631a-0000-0002fcfea63d",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 13.8887,
      "status": "OK",
      "warehouse_size": "MEDIUM",
      "qas_enabled": false,
      "variant": "optimized",
      "config_description": "Medium warehouse (standard rec for SF10)"
    }
  ],
  "finished": "2026-02-14T20:29:35.106772"
}