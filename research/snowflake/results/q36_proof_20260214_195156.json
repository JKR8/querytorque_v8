{
  "query_id": "Q36",
  "started": "2026-02-14T19:39:25.771385",
  "theory": "Query rewrite + clustering + QAS enables 2-4x warehouse downsizing",
  "result_cache": "DISABLED",
  "diagnostics": {
    "clustering_store_sales_ss_sold_date_sk": {
      "cluster_by_keys": "LINEAR(SS_SOLD_DATE_SK)",
      "total_partition_count": 72718,
      "total_constant_partition_count": 71078,
      "average_overlaps": 0.0705,
      "average_depth": 1.0521,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 71006,
        "00002": 1660,
        "00003": 6,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0,
        "00064": 46
      },
      "clustering_errors": []
    },
    "clustering_store_sales_ss_sold_date_sk_ss_item_sk": {
      "cluster_by_keys": "LINEAR(SS_SOLD_DATE_SK, SS_ITEM_SK)",
      "total_partition_count": 72718,
      "total_constant_partition_count": 0,
      "average_overlaps": 122.4113,
      "average_depth": 122.5241,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 0,
        "00002": 0,
        "00003": 0,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0,
        "00032": 23543,
        "00064": 23303,
        "00128": 23566,
        "04096": 2306
      },
      "clustering_errors": []
    },
    "clustering_inventory_inv_date_sk": {
      "cluster_by_keys": "LINEAR(INV_DATE_SK)",
      "total_partition_count": 279,
      "total_constant_partition_count": 49,
      "average_overlaps": 1.7133,
      "average_depth": 1.9821,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 34,
        "00002": 216,
        "00003": 29,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0
      },
      "clustering_errors": []
    },
    "clustering_catalog_sales_cs_sold_date_sk": {
      "cluster_by_keys": "LINEAR(CS_SOLD_DATE_SK)",
      "total_partition_count": 54922,
      "total_constant_partition_count": 53265,
      "average_overlaps": 0.0547,
      "average_depth": 1.0307,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 53245,
        "00002": 1669,
        "00003": 8,
        "00004": 0,
        "00005": 0,
        "00006": 0,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0
      },
      "clustering_errors": []
    },
    "clustering_web_sales_ws_sold_date_sk": {
      "cluster_by_keys": "LINEAR(WS_SOLD_DATE_SK)",
      "total_partition_count": 27579,
      "total_constant_partition_count": 25931,
      "average_overlaps": 0.1094,
      "average_depth": 1.0618,
      "partition_depth_histogram": {
        "00000": 0,
        "00001": 25905,
        "00002": 1659,
        "00003": 10,
        "00004": 0,
        "00005": 0,
        "00006": 5,
        "00007": 0,
        "00008": 0,
        "00009": 0,
        "00010": 0,
        "00011": 0,
        "00012": 0,
        "00013": 0,
        "00014": 0,
        "00015": 0,
        "00016": 0
      },
      "clustering_errors": []
    },
    "row_count_store_sales": 28800239865,
    "row_count_inventory": 1311525000,
    "row_count_catalog_sales": 14399964710,
    "row_count_web_sales": 7199963324,
    "row_count_warehouse": 25,
    "row_count_item": 402000,
    "row_count_store": 1500,
    "row_count_date_dim": 73049,
    "recent_spills": [
      {
        "query_id": "01c26343-3205-62cc-0000-0002fcfe9d01",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk, d_year, d_qoy, d",
        "warehouse_size": "X-Small",
        "seconds": "300.023000",
        "mb_local": "8819.000000000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26261-3205-62cc-0000-0002fcfe933d",
        "preview": "with customer_total_return as\n (select cr_returning_customer",
        "warehouse_size": "X-Small",
        "seconds": "300.028000",
        "mb_local": "2463.000000000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2631b-3205-62cc-0000-0002fcfe9bbd",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk FROM date_dim WHE",
        "warehouse_size": "X-Small",
        "seconds": "300.002000",
        "mb_local": "21453.000000000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26281-3205-62cc-0000-0002fcfe974d",
        "preview": "with customer_total_return as\n (select wr_returning_customer",
        "warehouse_size": "X-Small",
        "seconds": "130.473000",
        "mb_local": "2016.808593750000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26355-3205-62cc-0000-0002fcfe9df5",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk, d_date\n    FROM ",
        "warehouse_size": "X-Small",
        "seconds": "133.453000",
        "mb_local": "34.851562500000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26365-3205-62cc-0000-0002fcfe9f31",
        "preview": "WITH date_filter AS (\n    SELECT d_date_sk, d_year FROM date",
        "warehouse_size": "X-Small",
        "seconds": "300.038000",
        "mb_local": "12083.000000000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2627f-3205-62cc-0000-0002fcfe9649",
        "preview": "",
        "warehouse_size": "X-Small",
        "seconds": "19.904000",
        "mb_local": "0.080908775391",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26305-3205-62cc-0000-0002fcfe9afd",
        "preview": "WITH d_ss AS (SELECT d_date_sk FROM date_dim WHERE d_year = ",
        "warehouse_size": "X-Small",
        "seconds": "299.012000",
        "mb_local": "5269.964843750000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c26326-3205-62cc-0000-0002fcfe9c11",
        "preview": "WITH d_ss AS (SELECT d_date_sk FROM date_dim WHERE d_year = ",
        "warehouse_size": "X-Small",
        "seconds": "145.462000",
        "mb_local": "708.609375000000",
        "mb_remote": "0E-12"
      },
      {
        "query_id": "01c2626b-3205-62cc-0000-0002fcfe945d",
        "preview": "select ss_customer_sk\n            ,sum(act_sales) sumsales\n ",
        "warehouse_size": "X-Small",
        "seconds": "300.116000",
        "mb_local": "3665.000000000000",
        "mb_remote": "0E-12"
      }
    ],
    "warehouse": {
      "name": "COMPUTE_WH",
      "state": "STARTED",
      "type": "STANDARD",
      "size": "X-Small",
      "auto_suspend": "60"
    }
  },
  "explain_plans": {
    "original": "GlobalStats | 72722 | 72722 | 1251950176768\n1 | 0 | Result | (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))), ITEM.I_CATEGORY, ITEM.I_CLASS, (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) ASC NULLS LAST)\n1 | 1 | [0] | SortWithLimit | sortKey: [(GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)) DESC NULLS FIRST, CASE_FLATTENED(((GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS))) = 0, ITEM.I_CATEGORY, null) ASC NULLS LAST, RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(STORE_SALES.SS_NET_PROFIT)) / (SUM(STORE_SALES.SS_EXT_SALES_PRICE)) ASC NULLS LAST) ASC NULLS LAST], rowCount: 100\n1 | 2 | [1] | WindowFunction | RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) ASC NULLS LAST), RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) ASC NULLS LAST)\n1 | 3 | [2] | GroupingSets | SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE)\n1 | 4 | [3] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))))), SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))], groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS]\n1 | 5 | [4] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))), SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))))], groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS]\n1 | 6 | [5] | InnerJoin | joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)\n1 | 7 | [6] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM | I_ITEM_SK, I_CLASS, I_CATEGORY | 2 | 2 | 23811584\n1 | 8 | [6] | Aggregate | aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))), SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))], groupKeys: [STORE_SALES.SS_ITEM_SK]\n1 | 9 | [8] | InnerJoin | joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)\n1 | 10 | [9] | Filter | STORE.S_STATE IN 'SD' IN 'TN' IN 'GA' IN 'SC' IN 'MO' IN 'AL' IN 'MI' IN 'OH'\n1 | 11 | [10] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE | S_STORE_SK, S_STATE | 1 | 1 | 135680\n1 | 12 | [9] | Aggregate | aggExprs: [SUM(SUM(STORE_SALES.SS_NET_PROFIT)), SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))], groupKeys: [STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_STORE_SK]\n1 | 13 | [12] | InnerJoin | joinKey: (D1.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)\n1 | 14 | [13] | Filter | D1.D_YEAR = 2002\n1 | 15 | [14] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D1 | D_DATE_SK, D_YEAR | 1 | 1 | 2138624\n1 | 16 | [13] | Aggregate | aggExprs: [SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE)], groupKeys: [STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_SOLD_DATE_SK]\n1 | 17 | [16] | Filter | (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)\n1 | 18 | [17] | JoinFilter | joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)\n1 | 19 | [18] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES | SS_SOLD_DATE_SK, SS_ITEM_SK, SS_STORE_SK, SS_EXT_SALES_PRICE, SS_NET_PROFIT | 72718 | 72718 | 1251924090880",
    "optimized": "GlobalStats | 72722 | 72722 | 1251950176768\n1 | 0 | Result | (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))), ITEM.I_CATEGORY, ITEM.I_CLASS, (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) ASC NULLS LAST)\n1 | 1 | [0] | SortWithLimit | sortKey: [(GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)) DESC NULLS FIRST, CASE_FLATTENED(((GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS))) = 0, ITEM.I_CATEGORY, null) ASC NULLS LAST, RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(STORE_SALES.SS_NET_PROFIT)) / (SUM(STORE_SALES.SS_EXT_SALES_PRICE)) ASC NULLS LAST) ASC NULLS LAST], rowCount: 100\n1 | 2 | [1] | WindowFunction | RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) ASC NULLS LAST), RANK() OVER (PARTITION BY (GROUPING_ID(ITEM.I_CATEGORY)) + (GROUPING_ID(ITEM.I_CLASS)), CASE_FLATTENED((GROUPING_ID(ITEM.I_CLASS)) = 0, ITEM.I_CATEGORY, null) ORDER BY (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))))) / (SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))) ASC NULLS LAST)\n1 | 3 | [2] | GroupingSets | SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE), SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE)\n1 | 4 | [3] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))))), SUM(SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))))], groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS]\n1 | 5 | [4] | Aggregate | aggExprs: [SUM(SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT)))), SUM(SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))))], groupKeys: [ITEM.I_CATEGORY, ITEM.I_CLASS]\n1 | 6 | [5] | InnerJoin | joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)\n1 | 7 | [6] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.ITEM | I_ITEM_SK, I_CLASS, I_CATEGORY | 2 | 2 | 23811584\n1 | 8 | [6] | Aggregate | aggExprs: [SUM(SUM(SUM(STORE_SALES.SS_NET_PROFIT))), SUM(SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE)))], groupKeys: [STORE_SALES.SS_ITEM_SK]\n1 | 9 | [8] | InnerJoin | joinKey: (STORE.S_STORE_SK = STORE_SALES.SS_STORE_SK)\n1 | 10 | [9] | Filter | STORE.S_STATE IN 'SD' IN 'TN' IN 'GA' IN 'SC' IN 'MO' IN 'AL' IN 'MI' IN 'OH'\n1 | 11 | [10] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE | S_STORE_SK, S_STATE | 1 | 1 | 135680\n1 | 12 | [9] | Aggregate | aggExprs: [SUM(SUM(STORE_SALES.SS_NET_PROFIT)), SUM(SUM(STORE_SALES.SS_EXT_SALES_PRICE))], groupKeys: [STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_STORE_SK]\n1 | 13 | [12] | InnerJoin | joinKey: (DATE_DIM.D_DATE_SK = STORE_SALES.SS_SOLD_DATE_SK)\n1 | 14 | [13] | Filter | DATE_DIM.D_YEAR = 2002\n1 | 15 | [14] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.DATE_DIM | D_DATE_SK, D_YEAR | 1 | 1 | 2138624\n1 | 16 | [13] | Aggregate | aggExprs: [SUM(STORE_SALES.SS_NET_PROFIT), SUM(STORE_SALES.SS_EXT_SALES_PRICE)], groupKeys: [STORE_SALES.SS_ITEM_SK, STORE_SALES.SS_STORE_SK, STORE_SALES.SS_SOLD_DATE_SK]\n1 | 17 | [16] | Filter | (STORE_SALES.SS_STORE_SK IS NOT NULL) AND (STORE_SALES.SS_SOLD_DATE_SK IS NOT NULL)\n1 | 18 | [17] | JoinFilter | joinKey: (ITEM.I_ITEM_SK = STORE_SALES.SS_ITEM_SK)\n1 | 19 | [18] | TableScan | SNOWFLAKE_SAMPLE_DATA.TPCDS_SF10TCL.STORE_SALES | SS_SOLD_DATE_SK, SS_ITEM_SK, SS_STORE_SK, SS_EXT_SALES_PRICE, SS_NET_PROFIT | 72718 | 72718 | 1251924090880"
  },
  "equivalence": {
    "verified": true,
    "details": {
      "columns_match": true,
      "rows_match": true,
      "checksums_match": true,
      "original_checksum": "730bb61757092fc05a4f527296f7dd20",
      "optimized_checksum": "730bb61757092fc05a4f527296f7dd20",
      "original_row_count": 100,
      "optimized_row_count": 100,
      "original_columns": [
        "gross_margin",
        "i_category",
        "i_class",
        "lochierarchy",
        "rank_within_parent"
      ],
      "optimized_columns": [
        "gross_margin",
        "i_category",
        "i_class",
        "lochierarchy",
        "rank_within_parent"
      ],
      "original_time_s": 20.3941,
      "optimized_time_s": 17.9048,
      "original_query_id": "01c26747-3205-631a-0000-0002fcfea42d",
      "optimized_query_id": "01c26748-3205-631a-0000-0002fcfea431",
      "original_sample": [
        "-0.43189476|Jewelry|rings|0|17",
        "-0.43223561|Electronics|dvd/vcr players|0|17",
        "-0.43226716|Jewelry|semi-precious|0|16",
        "-0.43231208|Home|NULL|0|17",
        "-0.43233678|Jewelry|costume|0|15"
      ],
      "optimized_sample": [
        "-0.43189476|Jewelry|rings|0|17",
        "-0.43223561|Electronics|dvd/vcr players|0|17",
        "-0.43226716|Jewelry|semi-precious|0|16",
        "-0.43231208|Home|NULL|0|17",
        "-0.43233678|Jewelry|costume|0|15"
      ],
      "diffs": null
    }
  },
  "benchmarks": [
    {
      "label": "XSMALL/QAS=OFF/original",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 68.9024,
          "query_id": "01c26748-3205-631a-0000-0002fcfea445",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 67.2873,
          "query_id": "01c26749-3205-631a-0000-0002fcfea44d",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 64.7622,
          "query_id": "01c2674a-3205-631a-0000-0002fcfea455",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 66.0248,
      "status": "OK",
      "warehouse_size": "XSMALL",
      "qas_enabled": false,
      "variant": "original",
      "config_description": "Baseline: cheapest warehouse, no help"
    },
    {
      "label": "XSMALL/QAS=OFF/optimized",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 63.549,
          "query_id": "01c2674b-3205-631a-0000-0002fcfea461",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 62.4076,
          "query_id": "01c2674c-3205-631a-0000-0002fcfea469",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 62.7122,
          "query_id": "01c2674d-3205-631a-0000-0002fcfea471",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 62.5599,
      "status": "OK",
      "warehouse_size": "XSMALL",
      "qas_enabled": false,
      "variant": "optimized",
      "config_description": "Baseline: cheapest warehouse, no help"
    },
    {
      "label": "SMALL/QAS=OFF/original",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 35.2441,
          "query_id": "01c2674e-3205-631a-0000-0002fcfea489",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 33.676,
          "query_id": "01c2674f-3205-631a-0000-0002fcfea491",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 31.9863,
          "query_id": "01c26750-3205-631a-0000-0002fcfea499",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 32.8312,
      "status": "OK",
      "warehouse_size": "SMALL",
      "qas_enabled": false,
      "variant": "original",
      "config_description": "Small warehouse"
    },
    {
      "label": "SMALL/QAS=OFF/optimized",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 31.7464,
          "query_id": "01c26750-3205-631a-0000-0002fcfea4a5",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 31.6721,
          "query_id": "01c26751-3205-631a-0000-0002fcfea4ad",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 31.5931,
          "query_id": "01c26751-3205-631a-0000-0002fcfea4b5",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 31.6326,
      "status": "OK",
      "warehouse_size": "SMALL",
      "qas_enabled": false,
      "variant": "optimized",
      "config_description": "Small warehouse"
    },
    {
      "label": "MEDIUM/QAS=OFF/original",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 17.9626,
          "query_id": "01c26752-3205-631a-0000-0002fcfea4cd",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 16.2721,
          "query_id": "01c26752-3205-631a-0000-0002fcfea4d5",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 15.1944,
          "query_id": "01c26752-3205-631a-0000-0002fcfea4dd",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 15.7332,
      "status": "OK",
      "warehouse_size": "MEDIUM",
      "qas_enabled": false,
      "variant": "original",
      "config_description": "Medium warehouse (standard rec for SF10)"
    },
    {
      "label": "MEDIUM/QAS=OFF/optimized",
      "runs": [
        {
          "run": 1,
          "tag": "warmup",
          "elapsed_s": 14.2704,
          "query_id": "01c26753-3205-631a-0000-0002fcfea4e9",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 2,
          "tag": "measure-1",
          "elapsed_s": 14.2494,
          "query_id": "01c26753-3205-631a-0000-0002fcfea4f1",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        },
        {
          "run": 3,
          "tag": "measure-2",
          "elapsed_s": 13.9286,
          "query_id": "01c26753-3205-631a-0000-0002fcfea4f9",
          "row_count": 100,
          "status": "OK",
          "error": null,
          "metrics": {
            "error": "000904 (42000): SQL compilation error: error line 5 at position 16\ninvalid identifier 'BYTES_SPILLED_TO_LOCAL_STORAGE'"
          }
        }
      ],
      "avg_time_s": 14.089,
      "status": "OK",
      "warehouse_size": "MEDIUM",
      "qas_enabled": false,
      "variant": "optimized",
      "config_description": "Medium warehouse (standard rec for SF10)"
    }
  ],
  "finished": "2026-02-14T19:51:56.775036"
}