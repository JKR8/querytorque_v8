{
  "query_id": "query_32",
  "model": "qwen/qwen3-coder",
  "model_key": "qwen3-coder",
  "elapsed_s": 14.13,
  "prompt_chars": 6703,
  "response": "WITH item_filter AS (\n    SELECT i_item_sk\n    FROM item\n    WHERE i_manufact_id = 29\n),\ndate_range AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_date BETWEEN '1999-01-07' AND (CAST('1999-01-07' AS DATE) + INTERVAL '90 DAY')\n),\ncatalog_sales_filtered AS (\n    SELECT cs_item_sk, cs_ext_discount_amt\n    FROM catalog_sales\n    WHERE EXISTS (SELECT 1 FROM date_range WHERE d_date_sk = cs_sold_date_sk)\n),\nthresholds AS (\n    SELECT cs_item_sk, 1.3 * AVG(cs_ext_discount_amt) AS threshold\n    FROM catalog_sales_filtered\n    GROUP BY cs_item_sk\n),\nouter_query AS (\n    SELECT cs_ext_discount_amt\n    FROM catalog_sales cs\n    JOIN item_filter if ON cs.cs_item_sk = if.i_item_sk\n    JOIN date_range dr ON cs.cs_sold_date_sk = dr.d_date_sk\n    JOIN thresholds t ON cs.cs_item_sk = t.cs_item_sk\n    WHERE cs.cs_ext_discount_amt > t.threshold\n)\nSELECT SUM(cs_ext_discount_amt) AS \"excess discount amount\"\nFROM outer_query\nLIMIT 100;",
  "original_sql": "-- start query 32 in stream 0 using template query32.tpl\nselect sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 29\nand i_item_sk = cs_item_sk \nand d_date between '1999-01-07' and \n        (cast('1999-01-07' as date) + INTERVAL '90 DAY')\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-01-07' and\n                             (cast('1999-01-07' as date) + INTERVAL '90 DAY')\n          and d_date_sk = cs_sold_date_sk \n      )\n LIMIT 100;\n\n-- end query 32 in stream 0 using template query32.tpl\n",
  "usage": "CompletionUsage(completion_tokens=266, prompt_tokens=2002, total_tokens=2268, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0), cost=0.0007665, is_byok=False, cost_details={'upstream_inference_cost': 0.0007665, 'upstream_inference_prompt_cost': 0.0005005, 'upstream_inference_completions_cost': 0.000266})",
  "status": "OK"
}