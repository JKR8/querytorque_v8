{
  "query_id": "query_92",
  "model": "qwen/qwen3-coder",
  "model_key": "qwen3-coder",
  "elapsed_s": 2.54,
  "prompt_chars": 6736,
  "response": "WITH shared_scan AS (\n  SELECT ws_item_sk, ws_ext_discount_amt\n  FROM web_sales\n  JOIN date_dim ON d_date_sk = ws_sold_date_sk\n  WHERE d_date BETWEEN '2002-02-26' AND (CAST('2002-02-26' AS DATE) + INTERVAL '90 DAY')\n),\nthresholds AS (\n  SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold\n  FROM shared_scan\n  GROUP BY ws_item_sk\n),\nouter_query AS (\n  SELECT s.ws_ext_discount_amt\n  FROM shared_scan s\n  JOIN item i ON i.i_item_sk = s.ws_item_sk\n  JOIN thresholds t ON s.ws_item_sk = t.ws_item_sk\n  WHERE i.i_manufact_id = 320\n    AND s.ws_ext_discount_amt > t.threshold\n)\nSELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\"\nFROM outer_query\nORDER BY SUM(ws_ext_discount_amt)\nLIMIT 100;",
  "original_sql": "-- start query 92 in stream 0 using template query92.tpl\nselect \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 320\nand i_item_sk = ws_item_sk \nand d_date between '2002-02-26' and \n        (cast('2002-02-26' as date) + INTERVAL '90 DAY')\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '2002-02-26' and\n                             (cast('2002-02-26' as date) + INTERVAL '90 DAY')\n          and d_date_sk = ws_sold_date_sk \n      ) \norder by sum(ws_ext_discount_amt)\n LIMIT 100;\n\n-- end query 92 in stream 0 using template query92.tpl\n",
  "usage": "CompletionUsage(completion_tokens=220, prompt_tokens=2014, total_tokens=2234, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=64), cost=0.000650408, is_byok=False, cost_details={'upstream_inference_cost': 0.000650408, 'upstream_inference_prompt_cost': 0.000430408, 'upstream_inference_completions_cost': 0.00022})",
  "status": "OK"
}