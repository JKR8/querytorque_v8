{
  "query_id": "query_30",
  "model": "qwen/qwen3-coder",
  "model_key": "qwen3-coder",
  "elapsed_s": 4.26,
  "prompt_chars": 7204,
  "response": "WITH customer_total_return AS (\n  SELECT wr_returning_customer_sk AS ctr_customer_sk,\n         ca_state AS ctr_state,\n         SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns\n  JOIN date_dim ON wr_returned_date_sk = d_date_sk\n  JOIN customer_address ON wr_returning_addr_sk = ca_address_sk\n  WHERE d_year = 2002\n  GROUP BY wr_returning_customer_sk, ca_state\n),\nstate_avg_return AS (\n  SELECT ctr_state,\n         AVG(ctr_total_return) * 1.2 AS threshold\n  FROM customer_total_return\n  GROUP BY ctr_state\n)\nSELECT c_customer_id,\n       c_salutation,\n       c_first_name,\n       c_last_name,\n       c_preferred_cust_flag,\n       c_birth_day,\n       c_birth_month,\n       c_birth_year,\n       c_birth_country,\n       c_login,\n       c_email_address,\n       c_last_review_date,\n       ctr1.ctr_total_return\nFROM customer_total_return ctr1\nJOIN state_avg_return sar ON ctr1.ctr_state = sar.ctr_state\nJOIN customer_address ON ca_address_sk = c_current_addr_sk\nJOIN customer ON ctr1.ctr_customer_sk = c_customer_sk\nWHERE ctr1.ctr_total_return > sar.threshold\n  AND ca_state = 'IN'\nORDER BY c_customer_id,\n         c_salutation,\n         c_first_name,\n         c_last_name,\n         c_preferred_cust_flag,\n         c_birth_day,\n         c_birth_month,\n         c_birth_year,\n         c_birth_country,\n         c_login,\n         c_email_address,\n         c_last_review_date,\n         ctr_total_return\nLIMIT 100;",
  "original_sql": "-- start query 30 in stream 0 using template query30.tpl\nwith customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year =2002\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'IN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n                  ,c_last_review_date,ctr_total_return\n LIMIT 100;\n\n-- end query 30 in stream 0 using template query30.tpl\n",
  "usage": "CompletionUsage(completion_tokens=348, prompt_tokens=2084, total_tokens=2432, completion_tokens_details=CompletionTokensDetails(accepted_prediction_tokens=None, audio_tokens=0, reasoning_tokens=0, rejected_prediction_tokens=None), prompt_tokens_details=PromptTokensDetails(audio_tokens=0, cached_tokens=0), cost=0.0010776, is_byok=False, cost_details={'upstream_inference_cost': 0.0010776, 'upstream_inference_prompt_cost': 0.0006252, 'upstream_inference_completions_cost': 0.0004524})",
  "status": "OK"
}