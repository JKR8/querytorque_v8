[
  {
    "strike_id": "s1",
    "strategy": "Decorrelation + Date Consolidation + Explicit Joins",
    "based_on": ["p01", "p02", "p03", "p04", "p05", "p06"],
    "confidence": 0.9,
    "sql": "WITH date_filter AS (\n  SELECT d_date_sk\n  FROM date_dim\n  WHERE d_year = 2002\n    AND d_moy BETWEEN 10 AND 12\n),\nstore_customers AS (\n  SELECT DISTINCT ss_customer_sk\n  FROM store_sales\n  JOIN date_filter ON ss_sold_date_sk = d_date_sk\n  WHERE ss_list_price BETWEEN 80 AND 169\n),\nweb_customers AS (\n  SELECT DISTINCT ws_bill_customer_sk\n  FROM web_sales\n  JOIN date_filter ON ws_sold_date_sk = d_date_sk\n  WHERE ws_list_price BETWEEN 80 AND 169\n),\ncatalog_customers AS (\n  SELECT DISTINCT cs_ship_customer_sk\n  FROM catalog_sales\n  JOIN date_filter ON cs_sold_date_sk = d_date_sk\n  WHERE cs_list_price BETWEEN 80 AND 169\n)\nSELECT \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) cnt1,\n  cd_purchase_estimate,\n  COUNT(*) cnt2,\n  cd_credit_rating,\n  COUNT(*) cnt3\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics cd ON cd_demo_sk = c.c_current_cdemo_sk\nJOIN store_customers sc ON c.c_customer_sk = sc.ss_customer_sk\nLEFT JOIN web_customers wc ON c.c_customer_sk = wc.ws_bill_customer_sk\nLEFT JOIN catalog_customers cc ON c.c_customer_sk = cc.cs_ship_customer_sk\nWHERE ca.ca_state IN ('CO','NC','TX')\n  AND cd.cd_marital_status IN ('S', 'M', 'U')\n  AND cd.cd_education_status IN ('Primary', 'College')\n  AND wc.ws_bill_customer_sk IS NULL\n  AND cc.cs_ship_customer_sk IS NULL\nGROUP BY cd_gender,\n         cd_marital_status,\n         cd_education_status,\n         cd_purchase_estimate,\n         cd_credit_rating\nORDER BY cd_gender,\n         cd_marital_status,\n         cd_education_status,\n         cd_purchase_estimate,\n         cd_credit_rating\nLIMIT 100;"
  },
  {
    "strike_id": "s2",
    "strategy": "Date Consolidation + Anti-Join Decorrelation + State Filter Pushdown",
    "based_on": ["p01", "p02", "p03", "p04", "p06"],
    "confidence": 0.85,
    "sql": "WITH date_filter AS (\n  SELECT d_date_sk\n  FROM date_dim\n  WHERE d_year = 2002\n    AND d_moy BETWEEN 10 AND 12\n)\nSELECT \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) cnt1,\n  cd_purchase_estimate,\n  COUNT(*) cnt2,\n  cd_credit_rating,\n  COUNT(*) cnt3\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics cd ON cd_demo_sk = c.c_current_cdemo_sk\nWHERE ca.ca_state IN ('CO','NC','TX')\n  AND cd.cd_marital_status IN ('S', 'M', 'U')\n  AND cd.cd_education_status IN ('Primary', 'College')\n  AND EXISTS (\n    SELECT 1\n    FROM store_sales\n    JOIN date_filter ON ss_sold_date_sk = d_date_sk\n    WHERE ss_customer_sk = c.c_customer_sk\n      AND ss_list_price BETWEEN 80 AND 169\n  )\n  AND NOT EXISTS (\n    SELECT 1\n    FROM web_sales\n    JOIN date_filter ON ws_sold_date_sk = d_date_sk\n    WHERE ws_bill_customer_sk = c.c_customer_sk\n      AND ws_list_price BETWEEN 80 AND 169\n  )\n  AND NOT EXISTS (\n    SELECT 1\n    FROM catalog_sales\n    JOIN date_filter ON cs_sold_date_sk = d_date_sk\n    WHERE cs_ship_customer_sk = c.c_customer_sk\n      AND cs_list_price BETWEEN 80 AND 169\n  )\nGROUP BY cd_gender,\n         cd_marital_status,\n         cd_education_status,\n         cd_purchase_estimate,\n         cd_credit_rating\nORDER BY cd_gender,\n         cd_marital_status,\n         cd_education_status,\n         cd_purchase_estimate,\n         cd_credit_rating\nLIMIT 100;"
  }
]