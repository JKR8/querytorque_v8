```json
{
  "hypothesis": "The bottleneck is caused by repeated scans of the same fact tables (store_sales, web_sales, catalog_sales) and date_dim with overlapping filters across 3 correlated subqueries. Each NOT EXISTS subquery re-scans the same tables with identical date and price filters, leading to redundant I/O and CPU. The Nested Loop Anti joins indicate PostgreSQL is executing the NOT EXISTS per-row, which is inefficient for large outer inputs.",
  "probes": [
    {
      "probe_id": "p01",
      "transform_id": "materialize_web_sales_not_exists",
      "family": "B",
      "target": "Convert the NOT EXISTS (web_sales, date_dim) correlated subquery into a MATERIALIZED CTE: SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND ws_list_price BETWEEN 80 AND 169. Then replace NOT EXISTS with LEFT JOIN cte ON c_customer_sk = ws_bill_customer_sk WHERE ws_bill_customer_sk IS NULL",
      "confidence": 0.95,
      "recommended_examples": ["early_filter_decorrelate"]
    },
    {
      "probe_id": "p02",
      "transform_id": "materialize_catalog_sales_not_exists",
      "family": "B",
      "target": "Convert the NOT EXISTS (catalog_sales, date_dim) correlated subquery into a MATERIALIZED CTE: SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND cs_list_price BETWEEN 80 AND 169. Then replace NOT EXISTS with LEFT JOIN cte ON c_customer_sk = cs_ship_customer_sk WHERE cs_ship_customer_sk IS NULL",
      "confidence": 0.95,
      "recommended_examples": ["early_filter_decorrelate"]
    },
    {
      "probe_id": "p03",
      "transform_id": "materialize_store_sales_exists",
      "family": "B",
      "target": "Convert the EXISTS (store_sales, date_dim) correlated subquery into a MATERIALIZED CTE: SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND ss_list_price BETWEEN 80 AND 169. Then replace EXISTS with INNER JOIN cte ON c_customer_sk = ss_customer_sk",
      "confidence": 0.90,
      "recommended_examples": ["early_filter_decorrelate"]
    },
    {
      "probe_id": "p04",
      "transform_id": "date_consolidation",
      "family": "E",
      "target": "Extract the shared date_dim filter (d_year=2002, d_moy BETWEEN 10 AND 12) into a single MATERIALIZED CTE: SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12. Join all 3 fact tables (store_sales, web_sales, catalog_sales) through this CTE instead of scanning date_dim multiple times.",
      "confidence": 0.85,
      "recommended_examples": ["pg_date_consolidation"]
    },
    {
      "probe_id": "p05",
      "transform_id": "explicit_join_conversion",
      "family": "F",
      "target": "Replace comma join customer,customer_address,customer_demographics with explicit INNER JOIN chain: FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON cd.cd_demo_sk = c.c_current_cdemo_sk",
      "confidence": 0.80,
      "recommended_examples": ["pg_date_cte_explicit_join"]
    },
    {
      "probe_id": "p06",
      "transform_id": "prefetch_ca_state_filter",
      "family": "E",
      "target": "Materialize the customer_address filter (ca_state IN ('CO','NC','TX')) into a CTE: SELECT ca_address_sk FROM customer_address WHERE ca_state IN ('CO','NC','TX'). Join this CTE in the main query.",
      "confidence": 0.75,
      "recommended_examples": ["pg_dimension_prefetch_star"]
    },
    {
      "probe_id": "p07",
      "transform_id": "prefetch_cd_filters",
      "family": "E",
      "target": "Materialize the customer_demographics filters (cd_marital_status in ('S', 'M', 'U') and cd_education_status in ('Primary', 'College')) into a CTE: SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status IN ('S','M','U') AND cd_education_status IN ('Primary','College'). Join this CTE in the main query.",
      "confidence": 0.75,
      "recommended_examples": ["pg_dimension_prefetch_star"]
    },
    {
      "probe_id": "p08",
      "transform_id": "aggregate_before_join",
      "family": "C",
      "target": "Aggregate the store_sales CTE before joining with customer: SELECT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND ss_list_price BETWEEN 80 AND 169 GROUP BY ss_customer_sk. Then join this aggregated CTE with customer.",
      "confidence": 0.70,
      "recommended_examples": []
    },
    {
      "probe_id": "p09",
      "transform_id": "aggregate_web_sales_before_join",
      "family": "C",
      "target": "Aggregate the web_sales CTE before joining with customer: SELECT ws_bill_customer_sk FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND ws_list_price BETWEEN 80 AND 169 GROUP BY ws_bill_customer_sk. Then use this aggregated CTE for the anti-join.",
      "confidence": 0.70,
      "recommended_examples": []
    },
    {
      "probe_id": "p10",
      "transform_id": "aggregate_catalog_sales_before_join",
      "family": "C",
      "target": "Aggregate the catalog_sales CTE before joining with customer: SELECT cs_ship_customer_sk FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND cs_list_price BETWEEN 80 AND 169 GROUP BY cs_ship_customer_sk. Then use this aggregated CTE for the anti-join.",
      "confidence": 0.70,
      "recommended_examples": []
    },
    {
      "probe_id": "p11",
      "transform_id": "single_pass_customer_prefetch",
      "family": "E",
      "target": "Materialize the customer + customer_address join with state filter into a CTE: SELECT c_customer_sk, c_current_cdemo_sk FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE ca_state IN ('CO','NC','TX'). Use this CTE in the main query.",
      "confidence": 0.65,
      "recommended_examples": ["pg_self_join_decomposition"]
    },
    {
      "probe_id": "p12",
      "transform_id": "replace_exists_with_semi_join_cte",
      "family": "D",
      "target": "Replace the EXISTS (store_sales) subquery with a CTE that is joined via semi-join: SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND ss_list_price BETWEEN 80 AND 169. Then INNER JOIN this CTE with customer.",
      "confidence": 0.65,
      "recommended_examples": []
    },
    {
      "probe_id": "p13",
      "transform_id": "replace_not_exists_with_anti_join_cte",
      "family": "D",
      "target": "Replace the NOT EXISTS (web_sales) subquery with a CTE that is joined via anti-join: SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND ws_list_price BETWEEN 80 AND 169. Then LEFT JOIN this CTE and filter WHERE ws_bill_customer_sk IS NULL.",
      "confidence": 0.65,
      "recommended_examples": []
    },
    {
      "probe_id": "p14",
      "transform_id": "replace_not_exists_catalog_with_anti_join_cte",
      "family": "D",
      "target": "Replace the NOT EXISTS (catalog_sales) subquery with a CTE that is joined via anti-join: SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year = 2002 AND d_moy BETWEEN 10 AND 12 AND cs_list_price BETWEEN 80 AND 169. Then LEFT JOIN this CTE and filter WHERE cs_ship_customer_sk IS NULL.",
      "confidence": 0.65,
      "recommended_examples": []
    }
  ],
  "dropped": [
    {
      "transform_id": "materialize_cte",
      "reason": "No CTEs in original query to materialize"
    },
    {
      "transform_id": "inline_decorrelate_materialized",
      "reason": "This is a correlated EXISTS/NOT EXISTS pattern, not a scalar subquery with aggregate"
    },
    {
      "transform_id": "materialized_dimension_fact_prefilter",
      "reason": "No non-equi joins present in the query"
    }
  ]
}
```