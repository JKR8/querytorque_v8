{
  "stats": {
    "total_iterations": 15,
    "tree_size": 16,
    "successful_expansions": 15,
    "failed_expansions": 0,
    "validation_calls": 15,
    "root_visits": 15,
    "total_attempts": 15
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 72382,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0805,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.5,
      "output_sql": "/* start query 67 in stream 0 using template query67.tpl */\nWITH sales_aggregation AS (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    SUM(COALESCE(ss_sales_price * ss_quantity, 0)) AS sumsales\n  FROM store_sales, date_dim, store, item\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND ss_store_sk = s_store_sk\n    AND d_month_seq BETWEEN 1206 AND 1206 + 11\n  GROUP BY\n    ROLLUP (\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id\n    )\n)\nSELECT\n  *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n  FROM sales_aggregation\n) AS dw2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 58367,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9968,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT *\nFROM (\n    SELECT i_category\n          ,i_class\n          ,i_brand\n          ,i_product_name\n          ,d_year\n          ,d_qoy\n          ,d_moy\n          ,s_store_id\n          ,sumsales\n          ,RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) rk\n    FROM (\n        SELECT i_category\n              ,i_class\n              ,i_brand\n              ,i_product_name\n              ,d_year\n              ,d_qoy\n              ,d_moy\n              ,s_store_id\n              ,SUM(COALESCE(ss_sales_price*ss_quantity,0)) sumsales\n        FROM store_sales\n        JOIN date_dim ON ss_sold_date_sk = d_date_sk\n        JOIN store ON ss_store_sk = s_store_sk\n        JOIN item ON ss_item_sk = i_item_sk\n        WHERE d_month_seq BETWEEN 1206 AND 1206+11\n        GROUP BY ROLLUP(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id)\n    ) dw1\n) dw2\nWHERE rk <= 100\nORDER BY i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nLIMIT 100;"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "opt_agg",
      "duration_ms": 28952,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.0,
      "output_sql": "/* start query 67 in stream 0 using template query67.tpl */\nSELECT\n  *\nFROM derived_2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 101397,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9602,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.2,
      "output_sql": "select *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from (select i_category\n                  ,i_class\n                  ,i_brand\n                  ,i_product_name\n                  ,d_year\n                  ,d_qoy\n                  ,d_moy\n                  ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales\n                ,date_dim\n                ,store\n                ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1206 and 1206+11\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\n LIMIT 100;"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 27,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0012,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.5,
      "output_sql": "-- start query 67 in stream 0 using template query67.tpl\nselect *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from (select i_category\n                  ,i_class\n                  ,i_brand\n                  ,i_product_name\n                  ,d_year\n                  ,d_qoy\n                  ,d_moy\n                  ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales\n                ,date_dim\n                ,store\n                ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1206 and 1206+11\n       group by  rollup(i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id))dw1) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\n LIMIT 100;\n\n-- end query 67 in stream 0 using template query67.tpl\n"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 28252,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8871,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.2,
      "output_sql": "/* start query 67 in stream 0 using template query67.tpl */\nSELECT\n  *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n  FROM (\n    SELECT\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id,\n      SUM(COALESCE(ss_sales_price * ss_quantity, 0)) AS sumsales\n    FROM store_sales, date_dim, store, item\n    WHERE\n      ss_sold_date_sk = d_date_sk\n      AND ss_item_sk = i_item_sk\n      AND ss_store_sk = s_store_sk\n      AND d_month_seq BETWEEN 1206 AND 1206 + 11\n    GROUP BY\n      ROLLUP (\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id\n      )\n  ) AS dw1\n) AS dw2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 81034,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9295,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.2,
      "output_sql": "/* start query 67 in stream 0 using template query67.tpl */\nSELECT\n  *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n  FROM (\n    SELECT\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id,\n      SUM(COALESCE(ss_sales_price * ss_quantity, 0)) AS sumsales\n    FROM date_dim, store_sales, item, store\n    WHERE\n      ss_sold_date_sk = d_date_sk\n      AND ss_item_sk = i_item_sk\n      AND ss_store_sk = s_store_sk\n      AND d_month_seq BETWEEN 1206 AND 1206 + 11\n    GROUP BY\n      ROLLUP (\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id\n      )\n  ) AS dw1\n) AS dw2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "opt_window",
      "duration_ms": 31315,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.0,
      "output_sql": "/* start query 67 in stream 0 using template query67.tpl */\nSELECT\n  *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (\n      PARTITION BY i_category\n      ORDER BY sumsales DESC\n      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n    ) AS rk\n  FROM derived_1\n) AS dw2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 21719,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0795,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.5,
      "output_sql": "/* start query 67 in stream 0 using template query67.tpl */\nSELECT\n  *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n  FROM (\n    SELECT\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id,\n      SUM(COALESCE(ss_sales_price * ss_quantity, 0)) AS sumsales\n    FROM store_sales, date_dim, store, item\n    WHERE\n      ss_sold_date_sk = d_date_sk\n      AND ss_item_sk = i_item_sk\n      AND ss_store_sk = s_store_sk\n      AND d_month_seq BETWEEN 1206 AND 1206 + 11\n    GROUP BY\n      ROLLUP (\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id\n      )\n  ) AS dw1\n) AS dw2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [
        "materialize_cte"
      ],
      "transform_id": "opt_agg",
      "duration_ms": 29123,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 3.6434,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "/* start query 67 in stream 0 using template query67.tpl */\nWITH sales_aggregation AS (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    SUM(COALESCE(ss_sales_price * ss_quantity, 0)) AS sumsales,\n    RANK() OVER (\n      PARTITION BY i_category\n      ORDER BY SUM(COALESCE(ss_sales_price * ss_quantity, 0)) DESC\n    ) AS rk\n  FROM store_sales, date_dim, store, item\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND ss_store_sk = s_store_sk\n    AND d_month_seq BETWEEN 1206 AND 1206 + 11\n  GROUP BY\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id\n)\nSELECT\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nFROM sales_aggregation\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [
        "multi_push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 43166,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1628,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1628,
      "output_sql": "/* start query 67 in stream 0 using template query67.tpl */\nSELECT\n  *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n  FROM (\n    SELECT\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id,\n      SUM(COALESCE(ss_sales_price * ss_quantity, 0)) AS sumsales\n    FROM date_dim, store_sales, item, store\n    WHERE\n      ss_sold_date_sk = d_date_sk\n      AND ss_item_sk = i_item_sk\n      AND ss_store_sk = s_store_sk\n      AND d_month_seq BETWEEN 1206 AND 1206 + 11\n    GROUP BY\n      ROLLUP (\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id\n      )\n  ) AS dw1\n) AS dw2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "remove_redundant"
      ],
      "transform_id": "opt_window",
      "duration_ms": 19025,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "/* start query 67 in stream 0 using template query67.tpl */\nSELECT\n  *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n  FROM derived_1\n) AS dw2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "flatten_subq"
      ],
      "transform_id": "opt_window",
      "duration_ms": 21251,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  *\nFROM derived_2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 40995,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9955,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n  FROM (\n    SELECT\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id,\n      SUM(COALESCE(ss_sales_price * ss_quantity, 0)) AS sumsales\n    FROM date_dim\n    JOIN store_sales\n      ON ss_sold_date_sk = d_date_sk\n    JOIN store\n      ON ss_store_sk = s_store_sk\n    JOIN item\n      ON ss_item_sk = i_item_sk\n    WHERE\n      d_month_seq BETWEEN 1206 AND 1206 + 11\n    GROUP BY\n      ROLLUP (\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id\n      )\n  ) AS dw1\n) AS dw2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    },
    {
      "iteration": 15,
      "parent_path": [
        "inline_cte"
      ],
      "transform_id": "push_pred",
      "duration_ms": 92545,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9549,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  *\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    i_brand,\n    i_product_name,\n    d_year,\n    d_qoy,\n    d_moy,\n    s_store_id,\n    sumsales,\n    RANK() OVER (PARTITION BY i_category ORDER BY sumsales DESC) AS rk\n  FROM (\n    SELECT\n      i_category,\n      i_class,\n      i_brand,\n      i_product_name,\n      d_year,\n      d_qoy,\n      d_moy,\n      s_store_id,\n      SUM(COALESCE(ss_sales_price * ss_quantity, 0)) AS sumsales\n    FROM store_sales\n    JOIN date_dim ON ss_sold_date_sk = d_date_sk AND d_month_seq BETWEEN 1206 AND 1206 + 11\n    JOIN store ON ss_store_sk = s_store_sk\n    JOIN item ON ss_item_sk = i_item_sk\n    GROUP BY\n      ROLLUP (\n        i_category,\n        i_class,\n        i_brand,\n        i_product_name,\n        d_year,\n        d_qoy,\n        d_moy,\n        s_store_id\n      )\n  ) AS dw1\n) AS dw2\nWHERE\n  rk <= 100\nORDER BY\n  i_category,\n  i_class,\n  i_brand,\n  i_product_name,\n  d_year,\n  d_qoy,\n  d_moy,\n  s_store_id,\n  sumsales,\n  rk\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "status": "untried"
        },
        {
          "transform_id": "opt_agg",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "status": "untried"
        },
        {
          "transform_id": "opt_agg",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "opt_agg",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 2.596,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0805
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 2.296,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9968
        },
        {
          "transform_id": "opt_agg",
          "uct_score": 2.096,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 2.296,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9602
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.596,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0012
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.296,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8871
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 2.296,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9295
        },
        {
          "transform_id": "opt_window",
          "uct_score": 2.096,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.596,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0795
        }
      ],
      "selected": "materialize_cte",
      "reason": "uct_best"
    },
    {
      "node_path": [
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "status": "untried"
        },
        {
          "transform_id": "opt_agg",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.7672,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0805
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 2.3456,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9968
        },
        {
          "transform_id": "opt_agg",
          "uct_score": 2.1456,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 2.3456,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9602
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.6456,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0012
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.3456,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8871
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 2.3456,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9295
        },
        {
          "transform_id": "opt_window",
          "uct_score": 2.1456,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.6456,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0795
        }
      ],
      "selected": "multi_push_pred",
      "reason": "uct_best"
    },
    {
      "node_path": [
        "multi_push_pred"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "status": "untried"
        },
        {
          "transform_id": "opt_agg",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.7983,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0805
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 2.3896,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9968
        },
        {
          "transform_id": "opt_agg",
          "uct_score": 2.1896,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 2.3896,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9602
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.3797,
          "visits": 2,
          "avg_reward": 0.8314,
          "is_valid": true,
          "speedup": 1.0012
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.3896,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8871
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 2.3896,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9295
        },
        {
          "transform_id": "opt_window",
          "uct_score": 2.1896,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.6896,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0795
        }
      ],
      "selected": "remove_redundant",
      "reason": "uct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "status": "untried"
        },
        {
          "transform_id": "opt_agg",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.8261,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0805
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 2.429,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9968
        },
        {
          "transform_id": "opt_agg",
          "uct_score": 2.229,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 2.429,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9602
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.4075,
          "visits": 2,
          "avg_reward": 0.8314,
          "is_valid": true,
          "speedup": 1.0012
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.429,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8871
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 2.429,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9295
        },
        {
          "transform_id": "opt_window",
          "uct_score": 2.229,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.8261,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0795
        }
      ],
      "selected": "flatten_subq",
      "reason": "uct_best"
    },
    {
      "node_path": [
        "flatten_subq"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "opt_agg",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.8513,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0805
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.7013,
          "visits": 2,
          "avg_reward": 0.1,
          "is_valid": true,
          "speedup": 0.9968
        },
        {
          "transform_id": "opt_agg",
          "uct_score": 2.2646,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 2.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9602
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.4327,
          "visits": 2,
          "avg_reward": 0.8314,
          "is_valid": true,
          "speedup": 1.0012
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8871
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 2.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9295
        },
        {
          "transform_id": "opt_window",
          "uct_score": 2.2646,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.8513,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0795
        }
      ],
      "selected": "push_pred",
      "reason": "uct_best"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "status": "untried"
        },
        {
          "transform_id": "opt_agg",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "untried_available"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.8743,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0805
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.7243,
          "visits": 2,
          "avg_reward": 0.1,
          "is_valid": true,
          "speedup": 0.9968
        },
        {
          "transform_id": "opt_agg",
          "uct_score": 2.2971,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.8243,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9602
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.4557,
          "visits": 2,
          "avg_reward": 0.8314,
          "is_valid": true,
          "speedup": 1.0012
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.4971,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8871
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 2.4971,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9295
        },
        {
          "transform_id": "opt_window",
          "uct_score": 2.2971,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.8743,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0795
        }
      ],
      "selected": "inline_cte",
      "reason": "uct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "status": "untried"
        },
        {
          "transform_id": "opt_agg",
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "status": "untried"
        },
        {
          "transform_id": "opt_window",
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "untried_available"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 15,
    "avg_reward": 0.2575,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.25,
        "is_valid": true,
        "speedup": 1.0805,
        "error": null,
        "children": {
          "opt_agg": {
            "transforms": [
              "materialize_cte",
              "opt_agg"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 3.6434,
            "error": null
          }
        }
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.1,
        "is_valid": true,
        "speedup": 0.9968,
        "error": null,
        "children": {
          "opt_window": {
            "transforms": [
              "flatten_subq",
              "opt_window"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "opt_agg": {
        "transforms": [
          "opt_agg"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9602,
        "error": null,
        "children": {
          "reorder_join": {
            "transforms": [
              "push_pred",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9955,
            "error": null
          }
        }
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.8314,
        "is_valid": true,
        "speedup": 1.0012,
        "error": null,
        "children": {
          "reorder_join": {
            "transforms": [
              "multi_push_pred",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 1.1628,
            "is_valid": true,
            "speedup": 1.1628,
            "error": null
          }
        }
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.8871,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "inline_cte",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9549,
            "error": null
          }
        }
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9295,
        "error": null
      },
      "opt_window": {
        "transforms": [
          "opt_window"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.25,
        "is_valid": true,
        "speedup": 1.0795,
        "error": null,
        "children": {
          "opt_window": {
            "transforms": [
              "remove_redundant",
              "opt_window"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      }
    }
  }
}