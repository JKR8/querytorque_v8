{
  "stats": {
    "total_iterations": 14,
    "tree_size": 15,
    "successful_expansions": 14,
    "failed_expansions": 0,
    "validation_calls": 14,
    "llm_ranking_calls": 17,
    "root_visits": 14,
    "total_attempts": 14
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 145599,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2128,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 1.2128,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n)\nSELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / sun_sales2, 2),\n  ROUND(mon_sales1 / mon_sales2, 2),\n  ROUND(tue_sales1 / tue_sales2, 2),\n  ROUND(wed_sales1 / wed_sales2, 2),\n  ROUND(thu_sales1 / thu_sales2, 2),\n  ROUND(fri_sales1 / fri_sales2, 2),\n  ROUND(sat_sales1 / sat_sales2, 2)\nFROM (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq1,\n    sun_sales AS sun_sales1,\n    mon_sales AS mon_sales1,\n    tue_sales AS tue_sales1,\n    wed_sales AS wed_sales1,\n    thu_sales AS thu_sales1,\n    fri_sales AS fri_sales1,\n    sat_sales AS sat_sales1\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998\n) AS y, (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq2,\n    sun_sales AS sun_sales2,\n    mon_sales AS mon_sales2,\n    tue_sales AS tue_sales2,\n    wed_sales AS wed_sales2,\n    thu_sales AS thu_sales2,\n    fri_sales AS fri_sales2,\n    sat_sales AS sat_sales2\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998 + 1\n) AS z\nWHERE\n  d_week_seq1 = d_week_seq2 - 53\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 2,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "date_cte_isolate",
      "duration_ms": 58830,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk,\n    d_week_seq,\n    d_year\n  FROM date_dim\n  WHERE\n    d_year IN (1998, 1999)\n), wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, filtered_dates\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n)\nSELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / sun_sales2, 2),\n  ROUND(mon_sales1 / mon_sales2, 2),\n  ROUND(tue_sales1 / tue_sales2, 2),\n  ROUND(wed_sales1 / wed_sales2, 2),\n  ROUND(thu_sales1 / thu_sales2, 2),\n  ROUND(fri_sales1 / fri_sales2, 2),\n  ROUND(sat_sales1 / sat_sales2, 2)\nFROM (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq1,\n    sun_sales AS sun_sales1,\n    mon_sales AS mon_sales1,\n    tue_sales AS tue_sales1,\n    wed_sales AS wed_sales1,\n    thu_sales AS thu_sales1,\n    fri_sales AS fri_sales1,\n    sat_sales AS sat_sales1\n  FROM wswscs, filtered_dates\n  WHERE\n    filtered_dates.d_week_seq = wswscs.d_week_seq AND d_year = 1998\n) AS y, (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq2,\n    sun_sales AS sun_sales2,\n    mon_sales AS mon_sales2,\n    tue_sales AS tue_sales2,\n    wed_sales AS wed_sales2,\n    thu_sales AS thu_sales2,\n    fri_sales AS fri_sales2,\n    sat_sales AS sat_sales2\n  FROM wswscs, filtered_dates\n  WHERE\n    filtered_dates.d_week_seq = wswscs.d_week_seq AND d_year = 1999\n) AS z\nWHERE\n  d_week_seq1 = d_week_seq2 - 53\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 37725,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.178,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 1.178,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM date_dim, wscs\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n)\nSELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / sun_sales2, 2),\n  ROUND(mon_sales1 / mon_sales2, 2),\n  ROUND(tue_sales1 / tue_sales2, 2),\n  ROUND(wed_sales1 / wed_sales2, 2),\n  ROUND(thu_sales1 / thu_sales2, 2),\n  ROUND(fri_sales1 / fri_sales2, 2),\n  ROUND(sat_sales1 / sat_sales2, 2)\nFROM (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq1,\n    sun_sales AS sun_sales1,\n    mon_sales AS mon_sales1,\n    tue_sales AS tue_sales1,\n    wed_sales AS wed_sales1,\n    thu_sales AS thu_sales1,\n    fri_sales AS fri_sales1,\n    sat_sales AS sat_sales1\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998\n) AS y, (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq2,\n    sun_sales AS sun_sales2,\n    mon_sales AS mon_sales2,\n    tue_sales AS tue_sales2,\n    wed_sales AS wed_sales2,\n    thu_sales AS thu_sales2,\n    fri_sales AS fri_sales2,\n    sat_sales AS sat_sales2\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998 + 1\n) AS z\nWHERE\n  d_week_seq1 = d_week_seq2 - 53\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 58729,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.0963,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.0,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n), combined_years AS (\n  SELECT\n    wswscs.d_week_seq,\n    SUM(CASE WHEN d_year = 1998 THEN sun_sales ELSE NULL END) AS sun_sales1,\n    SUM(CASE WHEN d_year = 1998 THEN mon_sales ELSE NULL END) AS mon_sales1,\n    SUM(CASE WHEN d_year = 1998 THEN tue_sales ELSE NULL END) AS tue_sales1,\n    SUM(CASE WHEN d_year = 1998 THEN wed_sales ELSE NULL END) AS wed_sales1,\n    SUM(CASE WHEN d_year = 1998 THEN thu_sales ELSE NULL END) AS thu_sales1,\n    SUM(CASE WHEN d_year = 1998 THEN fri_sales ELSE NULL END) AS fri_sales1,\n    SUM(CASE WHEN d_year = 1998 THEN sat_sales ELSE NULL END) AS sat_sales1,\n    SUM(CASE WHEN d_year = 1999 THEN sun_sales ELSE NULL END) AS sun_sales2,\n    SUM(CASE WHEN d_year = 1999 THEN mon_sales ELSE NULL END) AS mon_sales2,\n    SUM(CASE WHEN d_year = 1999 THEN tue_sales ELSE NULL END) AS tue_sales2,\n    SUM(CASE WHEN d_year = 1999 THEN wed_sales ELSE NULL END) AS wed_sales2,\n    SUM(CASE WHEN d_year = 1999 THEN thu_sales ELSE NULL END) AS thu_sales2,\n    SUM(CASE WHEN d_year = 1999 THEN fri_sales ELSE NULL END) AS fri_sales2,\n    SUM(CASE WHEN d_year = 1999 THEN sat_sales ELSE NULL END) AS sat_sales2\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year IN (1998, 1999)\n  GROUP BY\n    wswscs.d_week_seq\n)\nSELECT\n  d_week_seq AS d_week_seq1,\n  ROUND(sun_sales1 / sun_sales2, 2),\n  ROUND(mon_sales1 / mon_sales2, 2),\n  ROUND(tue_sales1 / tue_sales2, 2),\n  ROUND(wed_sales1 / wed_sales2, 2),\n  ROUND(thu_sales1 / thu_sales2, 2),\n  ROUND(fri_sales1 / fri_sales2, 2),\n  ROUND(sat_sales1 / sat_sales2, 2)\nFROM combined_years\nWHERE\n  NOT sun_sales2 IS NULL\n  AND NOT mon_sales2 IS NULL\n  AND NOT tue_sales2 IS NULL\n  AND NOT wed_sales2 IS NULL\n  AND NOT thu_sales2 IS NULL\n  AND NOT fri_sales2 IS NULL\n  AND NOT sat_sales2 IS NULL\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 39146,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n), yearly_sales AS (\n  SELECT\n    wswscs.d_week_seq,\n    d_year,\n    sun_sales,\n    mon_sales,\n    tue_sales,\n    wed_sales,\n    thu_sales,\n    fri_sales,\n    sat_sales\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq\n)\nSELECT\n  y.d_week_seq AS d_week_seq1,\n  ROUND(y.sun_sales / z.sun_sales, 2),\n  ROUND(y.mon_sales / z.mon_sales, 2),\n  ROUND(y.tue_sales / z.tue_sales, 2),\n  ROUND(y.wed_sales / z.wed_sales, 2),\n  ROUND(y.thu_sales / z.thu_sales, 2),\n  ROUND(y.fri_sales / z.fri_sales, 2),\n  ROUND(y.sat_sales / z.sat_sales, 2)\nFROM (\n  SELECT\n    d_week_seq AS d_week_seq1,\n    sun_sales AS sun_sales,\n    mon_sales AS mon_sales,\n    tue_sales AS tue_sales,\n    wed_sales AS wed_sales,\n    thu_sales AS thu_sales,\n    fri_sales AS fri_sales,\n    sat_sales AS sat_sales\n  FROM yearly_sales\n  WHERE\n    d_year = 1998\n) AS y, (\n  SELECT\n    d_week_seq AS d_week_seq2,\n    sun_sales AS sun_sales,\n    mon_sales AS mon_sales,\n    tue_sales AS tue_sales,\n    wed_sales AS wed_sales,\n    thu_sales AS thu_sales,\n    fri_sales AS fri_sales,\n    sat_sales AS sat_sales\n  FROM yearly_sales\n  WHERE\n    d_year = 1999\n) AS z\nWHERE\n  d_week_seq1 = d_week_seq2 - 53\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 104545,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.3769,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 1.3769,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n), year_pairs AS (\n  SELECT\n    y.d_week_seq1,\n    y.sun_sales1,\n    y.mon_sales1,\n    y.tue_sales1,\n    y.wed_sales1,\n    y.thu_sales1,\n    y.fri_sales1,\n    y.sat_sales1,\n    z.d_week_seq2,\n    z.sun_sales2,\n    z.mon_sales2,\n    z.tue_sales2,\n    z.wed_sales2,\n    z.thu_sales2,\n    z.fri_sales2,\n    z.sat_sales2\n  FROM (\n    SELECT\n      wswscs.d_week_seq AS d_week_seq1,\n      sun_sales AS sun_sales1,\n      mon_sales AS mon_sales1,\n      tue_sales AS tue_sales1,\n      wed_sales AS wed_sales1,\n      thu_sales AS thu_sales1,\n      fri_sales AS fri_sales1,\n      sat_sales AS sat_sales1\n    FROM wswscs, date_dim\n    WHERE\n      date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998\n  ) AS y\n  CROSS JOIN (\n    SELECT\n      wswscs.d_week_seq AS d_week_seq2,\n      sun_sales AS sun_sales2,\n      mon_sales AS mon_sales2,\n      tue_sales AS tue_sales2,\n      wed_sales AS wed_sales2,\n      thu_sales AS thu_sales2,\n      fri_sales AS fri_sales2,\n      sat_sales AS sat_sales2\n    FROM wswscs, date_dim\n    WHERE\n      date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1999\n  ) AS z\n  WHERE\n    d_week_seq1 = d_week_seq2 - 53\n)\nSELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / sun_sales2, 2),\n  ROUND(mon_sales1 / mon_sales2, 2),\n  ROUND(tue_sales1 / tue_sales2, 2),\n  ROUND(wed_sales1 / wed_sales2, 2),\n  ROUND(thu_sales1 / thu_sales2, 2),\n  ROUND(fri_sales1 / fri_sales2, 2),\n  ROUND(sat_sales1 / sat_sales2, 2)\nFROM year_pairs\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 37551,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.974,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.2,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n)\nSELECT\n  y.d_week_seq AS d_week_seq1,\n  ROUND(y.sun_sales / z.sun_sales, 2),\n  ROUND(y.mon_sales / z.mon_sales, 2),\n  ROUND(y.tue_sales / z.tue_sales, 2),\n  ROUND(y.wed_sales / z.wed_sales, 2),\n  ROUND(y.thu_sales / z.thu_sales, 2),\n  ROUND(y.fri_sales / z.fri_sales, 2),\n  ROUND(y.sat_sales / z.sat_sales, 2)\nFROM (\n  SELECT\n    w1.d_week_seq,\n    w1.sun_sales,\n    w1.mon_sales,\n    w1.tue_sales,\n    w1.wed_sales,\n    w1.thu_sales,\n    w1.fri_sales,\n    w1.sat_sales,\n    d1.d_year\n  FROM wswscs AS w1\n  JOIN date_dim AS d1\n    ON d1.d_week_seq = w1.d_week_seq\n  WHERE\n    d1.d_year IN (1998, 1999)\n) AS y\nJOIN (\n  SELECT\n    w2.d_week_seq,\n    w2.sun_sales,\n    w2.mon_sales,\n    w2.tue_sales,\n    w2.wed_sales,\n    w2.thu_sales,\n    w2.fri_sales,\n    w2.sat_sales,\n    d2.d_year\n  FROM wswscs AS w2\n  JOIN date_dim AS d2\n    ON d2.d_week_seq = w2.d_week_seq\n  WHERE\n    d2.d_year IN (1998, 1999)\n) AS z\n  ON y.d_week_seq = z.d_week_seq - 53\nWHERE\n  y.d_year = 1998 AND z.d_year = 1999\nORDER BY\n  y.d_week_seq"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 44460,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9872,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.2,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n)\nSELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / sun_sales2, 2),\n  ROUND(mon_sales1 / mon_sales2, 2),\n  ROUND(tue_sales1 / tue_sales2, 2),\n  ROUND(wed_sales1 / wed_sales2, 2),\n  ROUND(thu_sales1 / thu_sales2, 2),\n  ROUND(fri_sales1 / fri_sales2, 2),\n  ROUND(sat_sales1 / sat_sales2, 2)\nFROM (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq1,\n    sun_sales AS sun_sales1,\n    mon_sales AS mon_sales1,\n    tue_sales AS tue_sales1,\n    wed_sales AS wed_sales1,\n    thu_sales AS thu_sales1,\n    fri_sales AS fri_sales1,\n    sat_sales AS sat_sales1\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998\n) AS y, (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq2,\n    sun_sales AS sun_sales2,\n    mon_sales AS mon_sales2,\n    tue_sales AS tue_sales2,\n    wed_sales AS wed_sales2,\n    thu_sales AS thu_sales2,\n    fri_sales AS fri_sales2,\n    sat_sales AS sat_sales2\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998 + 1\n) AS z\nWHERE\n  d_week_seq1 = d_week_seq2 - 53\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 88386,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0385,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.5,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    WHERE\n      ws_sold_date_sk IN (\n        SELECT\n          d_date_sk\n        FROM date_dim\n        WHERE\n          NOT d_date_sk IS NULL\n      )\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n    WHERE\n      cs_sold_date_sk IN (\n        SELECT\n          d_date_sk\n        FROM date_dim\n        WHERE\n          NOT d_date_sk IS NULL\n      )\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n)\nSELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / sun_sales2, 2),\n  ROUND(mon_sales1 / mon_sales2, 2),\n  ROUND(tue_sales1 / tue_sales2, 2),\n  ROUND(wed_sales1 / wed_sales2, 2),\n  ROUND(thu_sales1 / thu_sales2, 2),\n  ROUND(fri_sales1 / fri_sales2, 2),\n  ROUND(sat_sales1 / sat_sales2, 2)\nFROM (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq1,\n    sun_sales AS sun_sales1,\n    mon_sales AS mon_sales1,\n    tue_sales AS tue_sales1,\n    wed_sales AS wed_sales1,\n    thu_sales AS thu_sales1,\n    fri_sales AS fri_sales1,\n    sat_sales AS sat_sales1\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998\n) AS y, (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq2,\n    sun_sales AS sun_sales2,\n    mon_sales AS mon_sales2,\n    tue_sales AS tue_sales2,\n    wed_sales AS wed_sales2,\n    thu_sales AS thu_sales2,\n    fri_sales AS fri_sales2,\n    sat_sales AS sat_sales2\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998 + 1\n) AS z\nWHERE\n  d_week_seq1 = d_week_seq2 - 53\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 23711,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.0,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM derived_1\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n)\nSELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / sun_sales2, 2),\n  ROUND(mon_sales1 / mon_sales2, 2),\n  ROUND(tue_sales1 / tue_sales2, 2),\n  ROUND(wed_sales1 / wed_sales2, 2),\n  ROUND(thu_sales1 / thu_sales2, 2),\n  ROUND(fri_sales1 / fri_sales2, 2),\n  ROUND(sat_sales1 / sat_sales2, 2)\nFROM (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq1,\n    sun_sales AS sun_sales1,\n    mon_sales AS mon_sales1,\n    tue_sales AS tue_sales1,\n    wed_sales AS wed_sales1,\n    thu_sales AS thu_sales1,\n    fri_sales AS fri_sales1,\n    sat_sales AS sat_sales1\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998\n) AS y, (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq2,\n    sun_sales AS sun_sales2,\n    mon_sales AS mon_sales2,\n    tue_sales AS tue_sales2,\n    wed_sales AS wed_sales2,\n    thu_sales AS thu_sales2,\n    fri_sales AS fri_sales2,\n    sat_sales AS sat_sales2\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998 + 1\n) AS z\nWHERE\n  d_week_seq1 = d_week_seq2 - 53\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 33161,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.8747,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.0,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs_year AS (\n  SELECT\n    d_week_seq,\n    d_year,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq,\n    d_year\n)\nSELECT\n  y.d_week_seq AS d_week_seq1,\n  ROUND(y.sun_sales / z.sun_sales, 2),\n  ROUND(y.mon_sales / z.mon_sales, 2),\n  ROUND(y.tue_sales / z.tue_sales, 2),\n  ROUND(y.wed_sales / z.wed_sales, 2),\n  ROUND(y.thu_sales / z.thu_sales, 2),\n  ROUND(y.fri_sales / z.fri_sales, 2),\n  ROUND(y.sat_sales / z.sat_sales, 2)\nFROM wswscs_year AS y, wswscs_year AS z\nWHERE\n  y.d_year = 1998 AND z.d_year = 1999 AND y.d_week_seq = z.d_week_seq - 53\nORDER BY\n  y.d_week_seq"
    },
    {
      "iteration": 12,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 56652,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 11,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk,\n    d_week_seq\n  FROM date_dim\n  WHERE\n    d_year IN (1998, 1999)\n), wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, filtered_dates\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n)\nSELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / sun_sales2, 2),\n  ROUND(mon_sales1 / mon_sales2, 2),\n  ROUND(tue_sales1 / tue_sales2, 2),\n  ROUND(wed_sales1 / wed_sales2, 2),\n  ROUND(thu_sales1 / thu_sales2, 2),\n  ROUND(fri_sales1 / fri_sales2, 2),\n  ROUND(sat_sales1 / sat_sales2, 2)\nFROM (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq1,\n    sun_sales AS sun_sales1,\n    mon_sales AS mon_sales1,\n    tue_sales AS tue_sales1,\n    wed_sales AS wed_sales1,\n    thu_sales AS thu_sales1,\n    fri_sales AS fri_sales1,\n    sat_sales AS sat_sales1\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1998\n) AS y, (\n  SELECT\n    wswscs.d_week_seq AS d_week_seq2,\n    sun_sales AS sun_sales2,\n    mon_sales AS mon_sales2,\n    tue_sales AS tue_sales2,\n    wed_sales AS wed_sales2,\n    thu_sales AS thu_sales2,\n    fri_sales AS fri_sales2,\n    sat_sales AS sat_sales2\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND d_year = 1999\n) AS z\nWHERE\n  d_week_seq1 = d_week_seq2 - 53\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 13,
      "parent_path": [
        "or_to_union"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 80399,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH wscs AS (\n  SELECT\n    sold_date_sk,\n    sales_price\n  FROM (\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_ext_sales_price AS sales_price\n    FROM web_sales\n    UNION ALL\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_ext_sales_price AS sales_price\n    FROM catalog_sales\n  )\n), wswscs AS (\n  SELECT\n    d_week_seq,\n    SUM(CASE WHEN (\n      d_day_name = 'Sunday'\n    ) THEN sales_price ELSE NULL END) AS sun_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Monday'\n    ) THEN sales_price ELSE NULL END) AS mon_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Tuesday'\n    ) THEN sales_price ELSE NULL END) AS tue_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Wednesday'\n    ) THEN sales_price ELSE NULL END) AS wed_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Thursday'\n    ) THEN sales_price ELSE NULL END) AS thu_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Friday'\n    ) THEN sales_price ELSE NULL END) AS fri_sales,\n    SUM(CASE WHEN (\n      d_day_name = 'Saturday'\n    ) THEN sales_price ELSE NULL END) AS sat_sales\n  FROM wscs, date_dim\n  WHERE\n    d_date_sk = sold_date_sk\n  GROUP BY\n    d_week_seq\n), combined_years AS (\n  SELECT\n    wswscs.d_week_seq,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1998 AND d_day_name = 'Sunday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS sun_sales_1998,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1998 AND d_day_name = 'Monday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS mon_sales_1998,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1998 AND d_day_name = 'Tuesday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS tue_sales_1998,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1998 AND d_day_name = 'Wednesday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS wed_sales_1998,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1998 AND d_day_name = 'Thursday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS thu_sales_1998,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1998 AND d_day_name = 'Friday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS fri_sales_1998,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1998 AND d_day_name = 'Saturday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS sat_sales_1998,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1999 AND d_day_name = 'Sunday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS sun_sales_1999,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1999 AND d_day_name = 'Monday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS mon_sales_1999,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1999 AND d_day_name = 'Tuesday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS tue_sales_1999,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1999 AND d_day_name = 'Wednesday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS wed_sales_1999,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1999 AND d_day_name = 'Thursday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS thu_sales_1999,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1999 AND d_day_name = 'Friday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS fri_sales_1999,\n    SUM(\n      CASE\n        WHEN date_dim.d_year = 1999 AND d_day_name = 'Saturday'\n        THEN sales_price\n        ELSE NULL\n      END\n    ) AS sat_sales_1999\n  FROM wswscs, date_dim\n  WHERE\n    date_dim.d_week_seq = wswscs.d_week_seq AND date_dim.d_year IN (1998, 1999)\n  GROUP BY\n    wswscs.d_week_seq\n), year_pairs AS (\n  SELECT\n    y.d_week_seq AS d_week_seq1,\n    y.sun_sales_1998 AS sun_sales1,\n    y.mon_sales_1998 AS mon_sales1,\n    y.tue_sales_1998 AS tue_sales1,\n    y.wed_sales_1998 AS wed_sales1,\n    y.thu_sales_1998 AS thu_sales1,\n    y.fri_sales_1998 AS fri_sales1,\n    y.sat_sales_1998 AS sat_sales1,\n    z.d_week_seq AS d_week_seq2,\n    z.sun_sales_1999 AS sun_sales2,\n    z.mon_sales_1999 AS mon_sales2,\n    z.tue_sales_1999 AS tue_sales2,\n    z.wed_sales_1999 AS wed_sales2,\n    z.thu_sales_1999 AS thu_sales2,\n    z.fri_sales_1999 AS fri_sales2,\n    z.sat_sales_1999 AS sat_sales2\n  FROM combined_years AS y\n  CROSS JOIN combined_years AS z\n  WHERE\n    y.d_week_seq = z.d_week_seq - 53\n)\nSELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / NULLIF(sun_sales2, 0), 2),\n  ROUND(mon_sales1 / NULLIF(mon_sales2, 0), 2),\n  ROUND(tue_sales1 / NULLIF(tue_sales2, 0), 2),\n  ROUND(wed_sales1 / NULLIF(wed_sales2, 0), 2),\n  ROUND(thu_sales1 / NULLIF(thu_sales2, 0), 2),\n  ROUND(fri_sales1 / NULLIF(fri_sales2, 0), 2),\n  ROUND(sat_sales1 / NULLIF(sat_sales2, 0), 2)\nFROM year_pairs\nORDER BY\n  d_week_seq1"
    },
    {
      "iteration": 14,
      "parent_path": [
        "reorder_join"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 47452,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  d_week_seq1,\n  ROUND(sun_sales1 / NULLIF(sun_sales2, 0), 2),\n  ROUND(mon_sales1 / NULLIF(mon_sales2, 0), 2),\n  ROUND(tue_sales1 / NULLIF(tue_sales2, 0), 2),\n  ROUND(wed_sales1 / NULLIF(wed_sales2, 0), 2),\n  ROUND(thu_sales1 / NULLIF(thu_sales2, 0), 2),\n  ROUND(fri_sales1 / NULLIF(fri_sales2, 0), 2),\n  ROUND(sat_sales1 / NULLIF(sat_sales2, 0), 2)\nFROM combined_years\nWHERE\n  d_week_seq1 = d_week_seq2 - 53\n  AND NOT d_week_seq1 IS NULL\n  AND NOT d_week_seq2 IS NULL\nORDER BY\n  d_week_seq1"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.2628,
          "visits": 1,
          "avg_reward": 1.2128,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7007,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6642,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2069,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7397,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.278,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.681,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2153,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7697,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.3005,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4177,
          "visits": 1,
          "avg_reward": 1.3769,
          "is_valid": true,
          "speedup": 1.3769,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7828,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.3103,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.974,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.421,
          "visits": 1,
          "avg_reward": 1.3769,
          "is_valid": true,
          "speedup": 1.3769,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.795,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.3195,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9872,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.974,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.424,
          "visits": 1,
          "avg_reward": 1.3769,
          "is_valid": true,
          "speedup": 1.3769,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9064,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.478,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.15,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9872,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.974,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0385,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4269,
          "visits": 1,
          "avg_reward": 1.3769,
          "is_valid": true,
          "speedup": 1.3769,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.1335,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.6524,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3162,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3581,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9872,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.974,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0385,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4296,
          "visits": 1,
          "avg_reward": 1.3769,
          "is_valid": true,
          "speedup": 1.3769,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1106,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8275,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.3439,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4975,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9872,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.974,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5553,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0385,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4322,
          "visits": 1,
          "avg_reward": 1.3769,
          "is_valid": true,
          "speedup": 1.3769,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.8747,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 2.4249,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8292,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963,
          "status": "tried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8164,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.4929,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.6918,
          "visits": 1,
          "avg_reward": 1.3769,
          "is_valid": true,
          "speedup": 1.3769
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.974
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9872
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0385
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.8747
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "or_to_union"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8249,
          "visits": 2,
          "avg_reward": 0.6064,
          "is_valid": true,
          "speedup": 1.2128
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.5058,
          "visits": 1,
          "avg_reward": 1.178,
          "is_valid": true,
          "speedup": 1.178
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0963
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.907,
          "visits": 2,
          "avg_reward": 0.6885,
          "is_valid": true,
          "speedup": 1.3769
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.974
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9872
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0385
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.8747
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 14,
    "avg_reward": 0.3334,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.6064,
        "is_valid": true,
        "speedup": 1.2128,
        "error": null,
        "children": {
          "date_cte_isolate": {
            "transforms": [
              "push_pred",
              "date_cte_isolate"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.589,
        "is_valid": true,
        "speedup": 1.178,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "reorder_join",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 1.0963,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.6885,
        "is_valid": true,
        "speedup": 1.3769,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "or_to_union",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.974,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9872,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0385,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 1.8747,
        "error": null
      },
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      }
    }
  }
}