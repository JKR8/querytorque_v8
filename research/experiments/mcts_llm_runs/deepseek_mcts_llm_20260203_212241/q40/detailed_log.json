{
  "stats": {
    "total_iterations": 20,
    "tree_size": 21,
    "successful_expansions": 20,
    "failed_expansions": 0,
    "validation_calls": 20,
    "llm_ranking_calls": 31,
    "root_visits": 20,
    "total_attempts": 20
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 23902,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n)\nSELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  ), warehouse, item, filtered_dates\nWHERE\n  i_current_price BETWEEN 0.99 AND 1.49\n  AND i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 25482,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0398,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM (\n  SELECT\n    *\n  FROM catalog_sales\n) AS catalog_sales\nLEFT OUTER JOIN (\n  SELECT\n    *\n  FROM catalog_returns\n) AS catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  ), (\n  SELECT\n    *\n  FROM warehouse\n) AS warehouse, (\n  SELECT\n    *\n  FROM item\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n) AS item, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n) AS date_dim\nWHERE\n  i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 25543,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0472,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.5,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM item, date_dim, warehouse, catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  )\nWHERE\n  i_current_price BETWEEN 0.99 AND 1.49\n  AND i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\n  AND d_date BETWEEN (\n    CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n  ) AND (\n    CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n  )\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 39336,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.0,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(CASE WHEN period = 'before' THEN sales_amount ELSE 0 END) AS sales_before,\n  SUM(CASE WHEN period = 'after' THEN sales_amount ELSE 0 END) AS sales_after\nFROM combined_cte\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 39537,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0455,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.5,
      "output_sql": "SELECT \n   w_state\n  ,i_item_id\n  ,SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)) \n        THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_before\n  ,SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)) \n        THEN cs_sales_price - COALESCE(cr_refunded_cash,0) ELSE 0 END) AS sales_after\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns ON cs_order_number = cr_order_number \n                               AND cs_item_sk = cr_item_sk\nINNER JOIN item ON i_item_sk = cs_item_sk\nINNER JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk\nINNER JOIN date_dim ON cs_sold_date_sk = d_date_sk\nWHERE i_current_price BETWEEN 0.99 AND 1.49\n  AND d_date BETWEEN (CAST('2001-04-02' AS DATE) - INTERVAL 30 DAY)\n                  AND (CAST('2001-04-02' AS DATE) + INTERVAL 30 DAY)\nGROUP BY w_state, i_item_id\nORDER BY w_state, i_item_id\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 26045,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9895,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.2,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN d_date < CAST('2001-04-02' AS DATE)\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN d_date >= CAST('2001-04-02' AS DATE)\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  ), warehouse, item, date_dim\nWHERE\n  i_current_price BETWEEN 0.99 AND 1.49\n  AND i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\n  AND d_date BETWEEN CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY AND CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 27794,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0902,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.5,
      "output_sql": "WITH sales_data AS (\n  SELECT\n    w_state,\n    i_item_id,\n    cs_sales_price - COALESCE(cr_refunded_cash, 0) AS net_sales,\n    d_date\n  FROM catalog_sales\n  LEFT OUTER JOIN catalog_returns\n    ON (\n      cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n    ), warehouse, item, date_dim\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = cs_item_sk\n    AND cs_warehouse_sk = w_warehouse_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n)\nSELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN net_sales\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN net_sales\n      ELSE 0\n    END\n  ) AS sales_after\nFROM sales_data\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 43219,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0799,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.5,
      "output_sql": "WITH sales_data AS (\n    SELECT \n        w_state,\n        i_item_id,\n        cs_sales_price,\n        COALESCE(cr_refunded_cash, 0) AS refunded_cash,\n        d_date\n    FROM catalog_sales \n    LEFT OUTER JOIN catalog_returns ON \n        cs_order_number = cr_order_number \n        AND cs_item_sk = cr_item_sk\n    JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk\n    JOIN item ON i_item_sk = cs_item_sk\n    JOIN date_dim ON cs_sold_date_sk = d_date_sk\n    WHERE i_current_price BETWEEN 0.99 AND 1.49\n      AND d_date BETWEEN (CAST('2001-04-02' AS DATE) - INTERVAL 30 DAY)\n                     AND (CAST('2001-04-02' AS DATE) + INTERVAL 30 DAY)\n)\nSELECT \n    w_state,\n    i_item_id,\n    SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)) \n             THEN cs_sales_price - refunded_cash ELSE 0 END) AS sales_before,\n    SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)) \n             THEN cs_sales_price - refunded_cash ELSE 0 END) AS sales_after\nFROM sales_data\nGROUP BY w_state, i_item_id\nORDER BY w_state, i_item_id\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 14,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9431,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.2,
      "output_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2001-04-02' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2001-04-02' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number \n        and cs_item_sk = cr_item_sk)\n  ,warehouse \n  ,item\n  ,date_dim\n where\n     i_current_price between 0.99 and 1.49\n and i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk \n and cs_sold_date_sk    = d_date_sk\n and d_date between (cast ('2001-04-02' as date) - INTERVAL 30 DAY)\n                and (cast ('2001-04-02' as date) + INTERVAL 30 DAY) \n group by\n    w_state,i_item_id\n order by w_state,i_item_id\n LIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 17814,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.171,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 1.171,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  ), warehouse, item, date_dim\nWHERE\n  i_current_price BETWEEN 0.99 AND 1.49\n  AND i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\n  AND d_date BETWEEN (\n    CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n  ) AND (\n    CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n  )\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 22744,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0522,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.5,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        d_date < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        d_date >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  ), warehouse, item, date_dim\nWHERE\n  i_current_price BETWEEN 0.99 AND 1.49\n  AND i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\n  AND d_date BETWEEN (\n    CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n  ) AND (\n    CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n  )\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "inline_cte"
      ],
      "transform_id": "push_pred",
      "duration_ms": 27420,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0157,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  ), warehouse, (\n  SELECT\n    *\n  FROM item\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n) AS item, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n) AS date_dim\nWHERE\n  i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 27430,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8292,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN d_date < CAST('2001-04-02' AS DATE)\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN d_date >= CAST('2001-04-02' AS DATE)\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  ), warehouse, (\n  SELECT\n    *\n  FROM item\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n) AS item, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_date BETWEEN CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY AND CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n) AS date_dim\nWHERE\n  i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "inline_cte"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 27502,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0419,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.5,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN d_date < CAST('2001-04-02' AS DATE)\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN d_date >= CAST('2001-04-02' AS DATE)\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  ), warehouse, item, date_dim\nWHERE\n  i_current_price BETWEEN 0.99 AND 1.49\n  AND i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\n  AND d_date BETWEEN CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY AND CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 15,
      "parent_path": [
        "inline_cte",
        "push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 28532,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8601,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM (\n  SELECT\n    *\n  FROM item\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n) AS item, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n) AS date_dim, warehouse, catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  )\nWHERE\n  i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 16,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 29035,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0697,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM (\n  SELECT\n    *\n  FROM warehouse\n) AS warehouse, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n) AS date_dim, (\n  SELECT\n    *\n  FROM item\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n) AS item, (\n  SELECT\n    *\n  FROM catalog_sales\n) AS catalog_sales\nLEFT OUTER JOIN (\n  SELECT\n    *\n  FROM catalog_returns\n) AS catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  )\nWHERE\n  i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 17,
      "parent_path": [
        "reorder_join"
      ],
      "transform_id": "push_pred",
      "duration_ms": 23563,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2023,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.2023,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM (\n  SELECT\n    *\n  FROM item\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n) AS item, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n) AS date_dim, warehouse, catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  )\nWHERE\n  i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 18,
      "parent_path": [
        "reorder_join",
        "push_pred"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 22777,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM derived_1 AS item, derived_2 AS date_dim, warehouse, catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON (\n    cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n  )\nWHERE\n  i_item_sk = cs_item_sk\n  AND cs_warehouse_sk = w_warehouse_sk\n  AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 19,
      "parent_path": [
        "flatten_subq"
      ],
      "transform_id": "push_pred",
      "duration_ms": 22326,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8999,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  w_state,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n      )\n      THEN cs_sales_price - COALESCE(cr_refunded_cash, 0)\n      ELSE 0\n    END\n  ) AS sales_after\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns\n  ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\nINNER JOIN (\n  SELECT\n    *\n  FROM item\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n) AS item\n  ON i_item_sk = cs_item_sk\nINNER JOIN warehouse\n  ON cs_warehouse_sk = w_warehouse_sk\nINNER JOIN (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n) AS date_dim\n  ON cs_sold_date_sk = d_date_sk\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 20,
      "parent_path": [
        "materialize_cte"
      ],
      "transform_id": "or_to_union",
      "duration_ms": 79953,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8219,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH sales_data_before AS (\n  SELECT\n    w_state,\n    i_item_id,\n    cs_sales_price - COALESCE(cr_refunded_cash, 0) AS net_sales,\n    d_date\n  FROM catalog_sales\n  LEFT OUTER JOIN catalog_returns\n    ON (\n      cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n    ), warehouse, item, date_dim\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = cs_item_sk\n    AND cs_warehouse_sk = w_warehouse_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n    AND CAST(d_date AS DATE) < CAST('2001-04-02' AS DATE)\n), sales_data_after AS (\n  SELECT\n    w_state,\n    i_item_id,\n    cs_sales_price - COALESCE(cr_refunded_cash, 0) AS net_sales,\n    d_date\n  FROM catalog_sales\n  LEFT OUTER JOIN catalog_returns\n    ON (\n      cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk\n    ), warehouse, item, date_dim\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = cs_item_sk\n    AND cs_warehouse_sk = w_warehouse_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN (\n      CAST('2001-04-02' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2001-04-02' AS DATE) + INTERVAL '30' DAY\n    )\n    AND CAST(d_date AS DATE) >= CAST('2001-04-02' AS DATE)\n), sales_data_combined AS (\n  SELECT\n    *\n  FROM sales_data_before\n  UNION ALL\n  SELECT\n    *\n  FROM sales_data_after\n)\nSELECT\n  w_state,\n  i_item_id,\n  SUM(net_sales) AS sales_before,\n  0 AS sales_after\nFROM sales_data_before\nGROUP BY\n  w_state,\n  i_item_id\nUNION ALL\nSELECT\n  w_state,\n  i_item_id,\n  0 AS sales_before,\n  SUM(net_sales) AS sales_after\nFROM sales_data_after\nGROUP BY\n  w_state,\n  i_item_id\nORDER BY\n  w_state,\n  i_item_id\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0167,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5236,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5289,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5289,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6118,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7449,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6225,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6323,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5657,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7828,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.95,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.2906,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9743,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8162,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.3291,
          "visits": 1,
          "avg_reward": 1.171,
          "is_valid": true,
          "speedup": 1.171,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4725,
          "visits": 1,
          "avg_reward": 1.171,
          "is_valid": true,
          "speedup": 1.171
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0522
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0577,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.0196,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8464,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1732,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5577,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.4124,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5577,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5577,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.066,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.874,
          "visits": 2,
          "avg_reward": 0.8355,
          "is_valid": true,
          "speedup": 1.171
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5577,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0522
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4185,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.054,
          "visits": 2,
          "avg_reward": 0.8355,
          "is_valid": true,
          "speedup": 1.171
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0522
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0157,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4268,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8938,
          "visits": 3,
          "avg_reward": 0.7237,
          "is_valid": true,
          "speedup": 1.171
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0522
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6732,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0157,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6732,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0419,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "inline_cte",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4347,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5521,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7336,
          "visits": 4,
          "avg_reward": 0.5928,
          "is_valid": true,
          "speedup": 1.171
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0522
        }
      ],
      "selected": "push_pred",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.7424,
          "visits": 2,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0472
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4424,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7382,
          "visits": 4,
          "avg_reward": 0.5928,
          "is_valid": true,
          "speedup": 1.171
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0522
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.7499,
          "visits": 2,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.1011,
          "visits": 2,
          "avg_reward": 0.8512,
          "is_valid": true,
          "speedup": 1.0472
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4499,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7427,
          "visits": 4,
          "avg_reward": 0.5928,
          "is_valid": true,
          "speedup": 1.171
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0522
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.3438,
          "visits": 1,
          "avg_reward": 1.2023,
          "is_valid": true,
          "speedup": 1.2023,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "reorder_join",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.7571,
          "visits": 2,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7603,
          "visits": 3,
          "avg_reward": 0.5674,
          "is_valid": true,
          "speedup": 1.0472
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0455
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4571,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.747,
          "visits": 4,
          "avg_reward": 0.5928,
          "is_valid": true,
          "speedup": 1.171
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0522
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "flatten_subq"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.7642,
          "visits": 2,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0398
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7656,
          "visits": 3,
          "avg_reward": 0.5674,
          "is_valid": true,
          "speedup": 1.0472
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6142,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0455
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4642,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9895
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8963,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0902
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8963,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0799
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9431
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7513,
          "visits": 4,
          "avg_reward": 0.5928,
          "is_valid": true,
          "speedup": 1.171
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8963,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0522
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 20,
    "avg_reward": 0.4037,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0398,
        "error": null,
        "children": {
          "reorder_join": {
            "transforms": [
              "push_pred",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.5,
            "is_valid": true,
            "speedup": 1.0697,
            "error": null
          }
        }
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 3,
        "avg_reward": 0.5674,
        "is_valid": true,
        "speedup": 1.0472,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "reorder_join",
              "push_pred"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.6012,
            "is_valid": true,
            "speedup": 1.2023,
            "error": null,
            "children": {
              "consolidate_scans": {
                "transforms": [
                  "reorder_join",
                  "push_pred",
                  "consolidate_scans"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.0,
                "is_valid": false,
                "speedup": 0,
                "error": null
              }
            }
          }
        }
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.35,
        "is_valid": true,
        "speedup": 1.0455,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "flatten_subq",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.8999,
            "error": null
          }
        }
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9895,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "consolidate_scans",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.8292,
            "error": null
          }
        }
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.35,
        "is_valid": true,
        "speedup": 1.0902,
        "error": null,
        "children": {
          "or_to_union": {
            "transforms": [
              "materialize_cte",
              "or_to_union"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.8219,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0799,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9431,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 4,
        "avg_reward": 0.5928,
        "is_valid": true,
        "speedup": 1.171,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "inline_cte",
              "push_pred"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.35,
            "is_valid": true,
            "speedup": 1.0157,
            "error": null,
            "children": {
              "reorder_join": {
                "transforms": [
                  "inline_cte",
                  "push_pred",
                  "reorder_join"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.8601,
                "error": null
              }
            }
          },
          "consolidate_scans": {
            "transforms": [
              "inline_cte",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.5,
            "is_valid": true,
            "speedup": 1.0419,
            "error": null
          }
        }
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0522,
        "error": null
      }
    }
  }
}