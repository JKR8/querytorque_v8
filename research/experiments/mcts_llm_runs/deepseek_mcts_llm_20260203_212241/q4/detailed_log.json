{
  "stats": {
    "total_iterations": 13,
    "tree_size": 14,
    "successful_expansions": 13,
    "failed_expansions": 0,
    "validation_calls": 13,
    "llm_ranking_calls": 15,
    "root_visits": 13,
    "total_attempts": 13
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 87377,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7839,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.2,
      "output_sql": "WITH year_total AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt\n        ) + ss_ext_sales_price\n      ) / 2\n    ) AS year_total,\n    's' AS sale_type\n  FROM customer, store_sales, date_dim\n  WHERE\n    c_customer_sk = ss_customer_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year IN (1999, 2000)\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt\n          ) + cs_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'c' AS sale_type\n  FROM customer, catalog_sales, date_dim\n  WHERE\n    c_customer_sk = cs_bill_customer_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year IN (1999, 2000)\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt\n          ) + ws_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'w' AS sale_type\n  FROM customer, web_sales, date_dim\n  WHERE\n    c_customer_sk = ws_bill_customer_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year IN (1999, 2000)\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nFROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear\nWHERE\n  t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 1999\n  AND t_s_secyear.dyear = 1999 + 1\n  AND t_c_firstyear.dyear = 1999\n  AND t_c_secyear.dyear = 1999 + 1\n  AND t_w_firstyear.dyear = 1999\n  AND t_w_secyear.dyear = 1999 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_c_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_s_firstyear.year_total > 0\n    THEN t_s_secyear.year_total / t_s_firstyear.year_total\n    ELSE NULL\n  END\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_w_firstyear.year_total > 0\n    THEN t_w_secyear.year_total / t_w_firstyear.year_total\n    ELSE NULL\n  END\nORDER BY\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 79300,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0318,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk,\n    d_year\n  FROM date_dim\n  WHERE\n    d_year IN (1999, 2000)\n), year_total AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt\n        ) + ss_ext_sales_price\n      ) / 2\n    ) AS year_total,\n    's' AS sale_type\n  FROM customer, store_sales, filtered_dates\n  WHERE\n    c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt\n          ) + cs_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'c' AS sale_type\n  FROM customer, catalog_sales, filtered_dates\n  WHERE\n    c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt\n          ) + ws_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'w' AS sale_type\n  FROM customer, web_sales, filtered_dates\n  WHERE\n    c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nFROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear\nWHERE\n  t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 1999\n  AND t_s_secyear.dyear = 1999 + 1\n  AND t_c_firstyear.dyear = 1999\n  AND t_c_secyear.dyear = 1999 + 1\n  AND t_w_firstyear.dyear = 1999\n  AND t_w_secyear.dyear = 1999 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_c_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_s_firstyear.year_total > 0\n    THEN t_s_secyear.year_total / t_s_firstyear.year_total\n    ELSE NULL\n  END\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_w_firstyear.year_total > 0\n    THEN t_w_secyear.year_total / t_w_firstyear.year_total\n    ELSE NULL\n  END\nORDER BY\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 54072,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 0.0754,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.0,
      "output_sql": "WITH year_total AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      CASE\n        WHEN NOT ss_customer_sk IS NULL\n        THEN (\n          (\n            ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt\n          ) + ss_ext_sales_price\n        ) / 2\n      END\n    ) AS year_total_s,\n    SUM(\n      CASE\n        WHEN NOT cs_bill_customer_sk IS NULL\n        THEN (\n          (\n            cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt\n          ) + cs_ext_sales_price\n        ) / 2\n      END\n    ) AS year_total_c,\n    SUM(\n      CASE\n        WHEN NOT ws_bill_customer_sk IS NULL\n        THEN (\n          (\n            ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt\n          ) + ws_ext_sales_price\n        ) / 2\n      END\n    ) AS year_total_w\n  FROM customer\n  LEFT JOIN store_sales\n    ON c_customer_sk = ss_customer_sk AND NOT ss_sold_date_sk IS NULL\n  LEFT JOIN catalog_sales\n    ON c_customer_sk = cs_bill_customer_sk AND NOT cs_sold_date_sk IS NULL\n  LEFT JOIN web_sales\n    ON c_customer_sk = ws_bill_customer_sk AND NOT ws_sold_date_sk IS NULL\n  INNER JOIN date_dim\n    ON (\n      ss_sold_date_sk = d_date_sk\n      OR cs_sold_date_sk = d_date_sk\n      OR ws_sold_date_sk = d_date_sk\n    )\n  WHERE\n    d_year IN (1999, 2000)\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nFROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear\nWHERE\n  t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.dyear = 1999\n  AND t_s_secyear.dyear = 2000\n  AND t_c_firstyear.dyear = 1999\n  AND t_c_secyear.dyear = 2000\n  AND t_w_firstyear.dyear = 1999\n  AND t_w_secyear.dyear = 2000\n  AND t_s_firstyear.year_total_s > 0\n  AND t_c_firstyear.year_total_c > 0\n  AND t_w_firstyear.year_total_w > 0\n  AND CASE\n    WHEN t_c_firstyear.year_total_c > 0\n    THEN t_c_secyear.year_total_c / t_c_firstyear.year_total_c\n    ELSE NULL\n  END > CASE\n    WHEN t_s_firstyear.year_total_s > 0\n    THEN t_s_secyear.year_total_s / t_s_firstyear.year_total_s\n    ELSE NULL\n  END\n  AND CASE\n    WHEN t_c_firstyear.year_total_c > 0\n    THEN t_c_secyear.year_total_c / t_c_firstyear.year_total_c\n    ELSE NULL\n  END > CASE\n    WHEN t_w_firstyear.year_total_w > 0\n    THEN t_w_secyear.year_total_w / t_w_firstyear.year_total_w\n    ELSE NULL\n  END\nORDER BY\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 78423,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.6084,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.2,
      "output_sql": "WITH year_total_s AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt\n        ) + ss_ext_sales_price\n      ) / 2\n    ) AS year_total,\n    's' AS sale_type\n  FROM customer, store_sales, date_dim\n  WHERE\n    c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n), year_total_c AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt\n          ) + cs_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'c' AS sale_type\n  FROM customer, catalog_sales, date_dim\n  WHERE\n    c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n), year_total_w AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt\n          ) + ws_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'w' AS sale_type\n  FROM customer, web_sales, date_dim\n  WHERE\n    c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n), year_total AS (\n  SELECT\n    *\n  FROM year_total_s\n  UNION ALL\n  SELECT\n    *\n  FROM year_total_c\n  UNION ALL\n  SELECT\n    *\n  FROM year_total_w\n)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nFROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear\nWHERE\n  t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 1999\n  AND t_s_secyear.dyear = 1999 + 1\n  AND t_c_firstyear.dyear = 1999\n  AND t_c_secyear.dyear = 1999 + 1\n  AND t_w_firstyear.dyear = 1999\n  AND t_w_secyear.dyear = 1999 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_c_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_s_firstyear.year_total > 0\n    THEN t_s_secyear.year_total / t_s_firstyear.year_total\n    ELSE NULL\n  END\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_w_firstyear.year_total > 0\n    THEN t_w_secyear.year_total / t_w_firstyear.year_total\n    ELSE NULL\n  END\nORDER BY\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 46414,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0926,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.5,
      "output_sql": "WITH year_total AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt\n        ) + ss_ext_sales_price\n      ) / 2\n    ) AS year_total,\n    's' AS sale_type\n  FROM date_dim\n  JOIN store_sales\n    ON ss_sold_date_sk = d_date_sk\n  JOIN customer\n    ON c_customer_sk = ss_customer_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt\n          ) + cs_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'c' AS sale_type\n  FROM date_dim\n  JOIN catalog_sales\n    ON cs_sold_date_sk = d_date_sk\n  JOIN customer\n    ON c_customer_sk = cs_bill_customer_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt\n          ) + ws_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'w' AS sale_type\n  FROM date_dim\n  JOIN web_sales\n    ON ws_sold_date_sk = d_date_sk\n  JOIN customer\n    ON c_customer_sk = ws_bill_customer_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nFROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear\nWHERE\n  t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 1999\n  AND t_s_secyear.dyear = 1999 + 1\n  AND t_c_firstyear.dyear = 1999\n  AND t_c_secyear.dyear = 1999 + 1\n  AND t_w_firstyear.dyear = 1999\n  AND t_w_secyear.dyear = 1999 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_c_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_s_firstyear.year_total > 0\n    THEN t_s_secyear.year_total / t_s_firstyear.year_total\n    ELSE NULL\n  END\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_w_firstyear.year_total > 0\n    THEN t_w_secyear.year_total / t_w_firstyear.year_total\n    ELSE NULL\n  END\nORDER BY\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 36260,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.0,
      "output_sql": "WITH year_aggregates AS (\n  SELECT\n    customer_id,\n    customer_first_name,\n    customer_last_name,\n    customer_birth_country,\n    sale_type,\n    dyear,\n    SUM(year_total) AS total_amount\n  FROM year_total\n  GROUP BY\n    customer_id,\n    customer_first_name,\n    customer_last_name,\n    customer_birth_country,\n    sale_type,\n    dyear\n)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nFROM year_aggregates AS t_s_firstyear, year_aggregates AS t_s_secyear, year_aggregates AS t_c_firstyear, year_aggregates AS t_c_secyear, year_aggregates AS t_w_firstyear, year_aggregates AS t_w_secyear\nWHERE\n  t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 1999\n  AND t_s_secyear.dyear = 1999 + 1\n  AND t_c_firstyear.dyear = 1999\n  AND t_c_secyear.dyear = 1999 + 1\n  AND t_w_firstyear.dyear = 1999\n  AND t_w_secyear.dyear = 1999 + 1\n  AND t_s_firstyear.total_amount > 0\n  AND t_c_firstyear.total_amount > 0\n  AND t_w_firstyear.total_amount > 0\n  AND CASE\n    WHEN t_c_firstyear.total_amount > 0\n    THEN t_c_secyear.total_amount / t_c_firstyear.total_amount\n    ELSE NULL\n  END > CASE\n    WHEN t_s_firstyear.total_amount > 0\n    THEN t_s_secyear.total_amount / t_s_firstyear.total_amount\n    ELSE NULL\n  END\n  AND CASE\n    WHEN t_c_firstyear.total_amount > 0\n    THEN t_c_secyear.total_amount / t_c_firstyear.total_amount\n    ELSE NULL\n  END > CASE\n    WHEN t_w_firstyear.total_amount > 0\n    THEN t_w_secyear.total_amount / t_w_firstyear.total_amount\n    ELSE NULL\n  END\nORDER BY\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 176,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7192,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.2,
      "output_sql": "with year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_birth_country\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1999\n   and t_s_secyear.dyear = 1999+1\n   and t_c_firstyear.dyear =  1999\n   and t_c_secyear.dyear =  1999+1\n   and t_w_firstyear.dyear = 1999\n   and t_w_secyear.dyear = 1999+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_birth_country\n LIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 78330,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9653,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.2,
      "output_sql": "WITH year_total AS (\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total,\n        's' AS sale_type\n    FROM \n        customer,\n        store_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ss_customer_sk\n        AND ss_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total,\n        'c' AS sale_type\n    FROM \n        customer,\n        catalog_sales,\n        date_dim\n    WHERE \n        c_customer_sk = cs_bill_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total,\n        'w' AS sale_type\n    FROM \n        customer,\n        web_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n)\nSELECT \n    t_s_secyear.customer_id,\n    t_s_secyear.customer_first_name,\n    t_s_secyear.customer_last_name,\n    t_s_secyear.customer_birth_country\nFROM \n    year_total t_s_firstyear,\n    year_total t_s_secyear,\n    year_total t_c_firstyear,\n    year_total t_c_secyear,\n    year_total t_w_firstyear,\n    year_total t_w_secyear\nWHERE \n    t_s_secyear.customer_id = t_s_firstyear.customer_id\n    AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n    AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n    AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n    AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n    AND t_s_firstyear.sale_type = 's'\n    AND t_c_firstyear.sale_type = 'c'\n    AND t_w_firstyear.sale_type = 'w'\n    AND t_s_secyear.sale_type = 's'\n    AND t_c_secyear.sale_type = 'c'\n    AND t_w_secyear.sale_type = 'w'\n    AND t_s_firstyear.dyear = 1999\n    AND t_s_secyear.dyear = 1999 + 1\n    AND t_c_firstyear.dyear = 1999\n    AND t_c_secyear.dyear = 1999 + 1\n    AND t_w_firstyear.dyear = 1999\n    AND t_w_secyear.dyear = 1999 + 1\n    AND t_s_firstyear.year_total > 0\n    AND t_c_firstyear.year_total > 0\n    AND t_w_firstyear.year_total > 0\n    AND CASE \n        WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total \n        ELSE NULL \n    END > CASE \n        WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total \n        ELSE NULL \n    END\n    AND CASE \n        WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total \n        ELSE NULL \n    END > CASE \n        WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total \n        ELSE NULL \n    END\nORDER BY \n    t_s_secyear.customer_id,\n    t_s_secyear.customer_first_name,\n    t_s_secyear.customer_last_name,\n    t_s_secyear.customer_birth_country\nLIMIT 100;"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 81339,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0231,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.5,
      "output_sql": "WITH year_total AS (\n    SELECT c_customer_id customer_id,\n           c_first_name customer_first_name,\n           c_last_name customer_last_name,\n           c_preferred_cust_flag customer_preferred_cust_flag,\n           c_birth_country customer_birth_country,\n           c_login customer_login,\n           c_email_address customer_email_address,\n           d_year dyear,\n           SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) year_total,\n           's' sale_type\n    FROM customer,\n         store_sales,\n         date_dim\n    WHERE c_customer_sk = ss_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n    GROUP BY c_customer_id,\n             c_first_name,\n             c_last_name,\n             c_preferred_cust_flag,\n             c_birth_country,\n             c_login,\n             c_email_address,\n             d_year\n    UNION ALL\n    SELECT c_customer_id customer_id,\n           c_first_name customer_first_name,\n           c_last_name customer_last_name,\n           c_preferred_cust_flag customer_preferred_cust_flag,\n           c_birth_country customer_birth_country,\n           c_login customer_login,\n           c_email_address customer_email_address,\n           d_year dyear,\n           SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) year_total,\n           'c' sale_type\n    FROM customer,\n         catalog_sales,\n         date_dim\n    WHERE c_customer_sk = cs_bill_customer_sk\n      AND cs_sold_date_sk = d_date_sk\n    GROUP BY c_customer_id,\n             c_first_name,\n             c_last_name,\n             c_preferred_cust_flag,\n             c_birth_country,\n             c_login,\n             c_email_address,\n             d_year\n    UNION ALL\n    SELECT c_customer_id customer_id,\n           c_first_name customer_first_name,\n           c_last_name customer_last_name,\n           c_preferred_cust_flag customer_preferred_cust_flag,\n           c_birth_country customer_birth_country,\n           c_login customer_login,\n           c_email_address customer_email_address,\n           d_year dyear,\n           SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) year_total,\n           'w' sale_type\n    FROM customer,\n         web_sales,\n         date_dim\n    WHERE c_customer_sk = ws_bill_customer_sk\n      AND ws_sold_date_sk = d_date_sk\n    GROUP BY c_customer_id,\n             c_first_name,\n             c_last_name,\n             c_preferred_cust_flag,\n             c_birth_country,\n             c_login,\n             c_email_address,\n             d_year\n)\nSELECT t_s_secyear.customer_id,\n       t_s_secyear.customer_first_name,\n       t_s_secyear.customer_last_name,\n       t_s_secyear.customer_birth_country\nFROM year_total t_s_firstyear\n         INNER JOIN year_total t_s_secyear\n                    ON t_s_secyear.customer_id = t_s_firstyear.customer_id\n         INNER JOIN year_total t_c_firstyear\n                    ON t_s_firstyear.customer_id = t_c_firstyear.customer_id\n         INNER JOIN year_total t_c_secyear\n                    ON t_s_firstyear.customer_id = t_c_secyear.customer_id\n         INNER JOIN year_total t_w_firstyear\n                    ON t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         INNER JOIN year_total t_w_secyear\n                    ON t_s_firstyear.customer_id = t_w_secyear.customer_id\nWHERE t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 1999\n  AND t_s_secyear.dyear = 1999 + 1\n  AND t_c_firstyear.dyear = 1999\n  AND t_c_secyear.dyear = 1999 + 1\n  AND t_w_firstyear.dyear = 1999\n  AND t_w_secyear.dyear = 1999 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_c_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE\n          WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total\n          ELSE NULL END > CASE\n                              WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total\n                              ELSE NULL END\n  AND CASE\n          WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total\n          ELSE NULL END > CASE\n                              WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total\n                              ELSE NULL END\nORDER BY t_s_secyear.customer_id,\n         t_s_secyear.customer_first_name,\n         t_s_secyear.customer_last_name,\n         t_s_secyear.customer_birth_country\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 30477,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0621,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.5,
      "output_sql": "WITH year_total AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt\n        ) + ss_ext_sales_price\n      ) / 2\n    ) AS year_total,\n    's' AS sale_type\n  FROM customer, store_sales, date_dim\n  WHERE\n    c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt\n        ) + cs_ext_sales_price\n      ) / 2\n    ) AS year_total,\n    'c' AS sale_type\n  FROM customer, catalog_sales, date_dim\n  WHERE\n    c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt\n        ) + ws_ext_sales_price\n      ) / 2\n    ) AS year_total,\n    'w' AS sale_type\n  FROM customer, web_sales, date_dim\n  WHERE\n    c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nFROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear\nWHERE\n  t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 1999\n  AND t_s_secyear.dyear = 1999 + 1\n  AND t_c_firstyear.dyear = 1999\n  AND t_c_secyear.dyear = 1999 + 1\n  AND t_w_firstyear.dyear = 1999\n  AND t_w_secyear.dyear = 1999 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_c_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_s_firstyear.year_total > 0\n    THEN t_s_secyear.year_total / t_s_firstyear.year_total\n    ELSE NULL\n  END\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_w_firstyear.year_total > 0\n    THEN t_w_secyear.year_total / t_w_firstyear.year_total\n    ELSE NULL\n  END\nORDER BY\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 170744,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9378,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.2,
      "output_sql": "SELECT \n    t_s_secyear.customer_id,\n    t_s_secyear.customer_first_name,\n    t_s_secyear.customer_last_name,\n    t_s_secyear.customer_birth_country\nFROM (\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total,\n        's' AS sale_type\n    FROM \n        customer,\n        store_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ss_customer_sk\n        AND ss_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total,\n        'c' AS sale_type\n    FROM \n        customer,\n        catalog_sales,\n        date_dim\n    WHERE \n        c_customer_sk = cs_bill_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total,\n        'w' AS sale_type\n    FROM \n        customer,\n        web_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n) t_s_firstyear,\n(\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total,\n        's' AS sale_type\n    FROM \n        customer,\n        store_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ss_customer_sk\n        AND ss_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total,\n        'c' AS sale_type\n    FROM \n        customer,\n        catalog_sales,\n        date_dim\n    WHERE \n        c_customer_sk = cs_bill_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total,\n        'w' AS sale_type\n    FROM \n        customer,\n        web_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n) t_s_secyear,\n(\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total,\n        's' AS sale_type\n    FROM \n        customer,\n        store_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ss_customer_sk\n        AND ss_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total,\n        'c' AS sale_type\n    FROM \n        customer,\n        catalog_sales,\n        date_dim\n    WHERE \n        c_customer_sk = cs_bill_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total,\n        'w' AS sale_type\n    FROM \n        customer,\n        web_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n) t_c_firstyear,\n(\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total,\n        's' AS sale_type\n    FROM \n        customer,\n        store_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ss_customer_sk\n        AND ss_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total,\n        'c' AS sale_type\n    FROM \n        customer,\n        catalog_sales,\n        date_dim\n    WHERE \n        c_customer_sk = cs_bill_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total,\n        'w' AS sale_type\n    FROM \n        customer,\n        web_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n) t_c_secyear,\n(\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total,\n        's' AS sale_type\n    FROM \n        customer,\n        store_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ss_customer_sk\n        AND ss_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total,\n        'c' AS sale_type\n    FROM \n        customer,\n        catalog_sales,\n        date_dim\n    WHERE \n        c_customer_sk = cs_bill_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total,\n        'w' AS sale_type\n    FROM \n        customer,\n        web_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n) t_w_firstyear,\n(\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total,\n        's' AS sale_type\n    FROM \n        customer,\n        store_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ss_customer_sk\n        AND ss_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total,\n        'c' AS sale_type\n    FROM \n        customer,\n        catalog_sales,\n        date_dim\n    WHERE \n        c_customer_sk = cs_bill_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n    UNION ALL\n    SELECT \n        c_customer_id AS customer_id,\n        c_first_name AS customer_first_name,\n        c_last_name AS customer_last_name,\n        c_preferred_cust_flag AS customer_preferred_cust_flag,\n        c_birth_country AS customer_birth_country,\n        c_login AS customer_login,\n        c_email_address AS customer_email_address,\n        d_year AS dyear,\n        SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total,\n        'w' AS sale_type\n    FROM \n        customer,\n        web_sales,\n        date_dim\n    WHERE \n        c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n    GROUP BY \n        c_customer_id,\n        c_first_name,\n        c_last_name,\n        c_preferred_cust_flag,\n        c_birth_country,\n        c_login,\n        c_email_address,\n        d_year\n) t_w_secyear\nWHERE \n    t_s_secyear.customer_id = t_s_firstyear.customer_id\n    AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n    AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n    AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n    AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n    AND t_s_firstyear.sale_type = 's'\n    AND t_c_firstyear.sale_type = 'c'\n    AND t_w_firstyear.sale_type = 'w'\n    AND t_s_secyear.sale_type = 's'\n    AND t_c_secyear.sale_type = 'c'\n    AND t_w_secyear.sale_type = 'w'\n    AND t_s_firstyear.dyear = 1999\n    AND t_s_secyear.dyear = 1999 + 1\n    AND t_c_firstyear.dyear = 1999\n    AND t_c_secyear.dyear = 1999 + 1\n    AND t_w_firstyear.dyear = 1999\n    AND t_w_secyear.dyear = 1999 + 1\n    AND t_s_firstyear.year_total > 0\n    AND t_c_firstyear.year_total > 0\n    AND t_w_firstyear.year_total > 0\n    AND CASE \n        WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total \n        ELSE NULL \n    END > CASE \n        WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total \n        ELSE NULL \n    END\n    AND CASE \n        WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total \n        ELSE NULL \n    END > CASE \n        WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total \n        ELSE NULL \n    END\nORDER BY \n    t_s_secyear.customer_id,\n    t_s_secyear.customer_first_name,\n    t_s_secyear.customer_last_name,\n    t_s_secyear.customer_birth_country\nLIMIT 100;"
    },
    {
      "iteration": 12,
      "parent_path": [
        "date_cte_isolate"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 69887,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk,\n    d_year\n  FROM date_dim\n  WHERE\n    d_year IN (1999, 2000)\n), year_total AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    sale_type,\n    SUM(\n      CASE sale_type\n        WHEN 's'\n        THEN (\n          (\n            ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt\n          ) + ss_ext_sales_price\n        ) / 2\n        WHEN 'c'\n        THEN (\n          (\n            (\n              cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt\n            ) + cs_ext_sales_price\n          ) / 2\n        )\n        WHEN 'w'\n        THEN (\n          (\n            (\n              ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt\n            ) + ws_ext_sales_price\n          ) / 2\n        )\n      END\n    ) AS year_total\n  FROM (\n    SELECT\n      customer.*,\n      's' AS sale_type,\n      ss_ext_list_price,\n      ss_ext_wholesale_cost,\n      ss_ext_discount_amt,\n      ss_ext_sales_price,\n      d_date_sk,\n      d_year\n    FROM customer, store_sales, filtered_dates\n    WHERE\n      c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk\n    UNION ALL\n    SELECT\n      customer.*,\n      'c' AS sale_type,\n      cs_ext_list_price,\n      cs_ext_wholesale_cost,\n      cs_ext_discount_amt,\n      cs_ext_sales_price,\n      d_date_sk,\n      d_year\n    FROM customer, catalog_sales, filtered_dates\n    WHERE\n      c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk\n    UNION ALL\n    SELECT\n      customer.*,\n      'w' AS sale_type,\n      ws_ext_list_price,\n      ws_ext_wholesale_cost,\n      ws_ext_discount_amt,\n      ws_ext_sales_price,\n      d_date_sk,\n      d_year\n    FROM customer, web_sales, filtered_dates\n    WHERE\n      c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk\n  ) AS combined_sales\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year,\n    sale_type\n), combined_year_total AS (\n  SELECT\n    customer_id,\n    customer_first_name,\n    customer_last_name,\n    customer_birth_country,\n    MAX(CASE WHEN sale_type = 's' AND dyear = 1999 THEN year_total END) AS s_firstyear,\n    MAX(CASE WHEN sale_type = 's' AND dyear = 2000 THEN year_total END) AS s_secyear,\n    MAX(CASE WHEN sale_type = 'c' AND dyear = 1999 THEN year_total END) AS c_firstyear,\n    MAX(CASE WHEN sale_type = 'c' AND dyear = 2000 THEN year_total END) AS c_secyear,\n    MAX(CASE WHEN sale_type = 'w' AND dyear = 1999 THEN year_total END) AS w_firstyear,\n    MAX(CASE WHEN sale_type = 'w' AND dyear = 2000 THEN year_total END) AS w_secyear\n  FROM year_total\n  WHERE\n    dyear IN (1999, 2000)\n  GROUP BY\n    customer_id,\n    customer_first_name,\n    customer_last_name,\n    customer_birth_country\n)\nSELECT\n  customer_id,\n  customer_first_name,\n  customer_last_name,\n  customer_birth_country\nFROM combined_year_total\nWHERE\n  s_firstyear > 0\n  AND c_firstyear > 0\n  AND w_firstyear > 0\n  AND CASE WHEN c_firstyear > 0 THEN c_secyear / c_firstyear ELSE NULL END > CASE WHEN s_firstyear > 0 THEN s_secyear / s_firstyear ELSE NULL END\n  AND CASE WHEN c_firstyear > 0 THEN c_secyear / c_firstyear ELSE NULL END > CASE WHEN w_firstyear > 0 THEN w_secyear / w_firstyear ELSE NULL END\nORDER BY\n  customer_id,\n  customer_first_name,\n  customer_last_name,\n  customer_birth_country\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "reorder_join"
      ],
      "transform_id": "push_pred",
      "duration_ms": 40421,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0003,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "WITH year_total AS (\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt\n        ) + ss_ext_sales_price\n      ) / 2\n    ) AS year_total,\n    's' AS sale_type\n  FROM date_dim\n  JOIN store_sales\n    ON ss_sold_date_sk = d_date_sk\n  JOIN customer\n    ON c_customer_sk = ss_customer_sk\n  WHERE\n    d_year IN (1999, 2000)\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt\n          ) + cs_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'c' AS sale_type\n  FROM date_dim\n  JOIN catalog_sales\n    ON cs_sold_date_sk = d_date_sk\n  JOIN customer\n    ON c_customer_sk = cs_bill_customer_sk\n  WHERE\n    d_year IN (1999, 2000)\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n  UNION ALL\n  SELECT\n    c_customer_id AS customer_id,\n    c_first_name AS customer_first_name,\n    c_last_name AS customer_last_name,\n    c_preferred_cust_flag AS customer_preferred_cust_flag,\n    c_birth_country AS customer_birth_country,\n    c_login AS customer_login,\n    c_email_address AS customer_email_address,\n    d_year AS dyear,\n    SUM(\n      (\n        (\n          (\n            ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt\n          ) + ws_ext_sales_price\n        ) / 2\n      )\n    ) AS year_total,\n    'w' AS sale_type\n  FROM date_dim\n  JOIN web_sales\n    ON ws_sold_date_sk = d_date_sk\n  JOIN customer\n    ON c_customer_sk = ws_bill_customer_sk\n  WHERE\n    d_year IN (1999, 2000)\n  GROUP BY\n    c_customer_id,\n    c_first_name,\n    c_last_name,\n    c_preferred_cust_flag,\n    c_birth_country,\n    c_login,\n    c_email_address,\n    d_year\n)\nSELECT\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nFROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear\nWHERE\n  t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 1999\n  AND t_s_secyear.dyear = 1999 + 1\n  AND t_c_firstyear.dyear = 1999\n  AND t_c_secyear.dyear = 1999 + 1\n  AND t_w_firstyear.dyear = 1999\n  AND t_w_secyear.dyear = 1999 + 1\n  AND t_s_firstyear.year_total > 0\n  AND t_c_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_s_firstyear.year_total > 0\n    THEN t_s_secyear.year_total / t_s_firstyear.year_total\n    ELSE NULL\n  END\n  AND CASE\n    WHEN t_c_firstyear.year_total > 0\n    THEN t_c_secyear.year_total / t_c_firstyear.year_total\n    ELSE NULL\n  END > CASE\n    WHEN t_w_firstyear.year_total > 0\n    THEN t_w_secyear.year_total / t_w_firstyear.year_total\n    ELSE NULL\n  END\nORDER BY\n  t_s_secyear.customer_id,\n  t_s_secyear.customer_first_name,\n  t_s_secyear.customer_last_name,\n  t_s_secyear.customer_birth_country\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2167,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5236,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5289,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6084,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6118,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0926,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6084,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3225,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0926,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6084,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6323,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0926,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7192,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6084,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4828,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0926,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7192,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6084,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0926,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.35,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0231,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7192,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6084,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9906,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9743,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0926,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5162,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6581,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0231,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0621,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7192,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6084,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0318
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6084
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0926
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7192
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9653
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0231
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0621
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9378
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "date_cte_isolate"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7839
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4599,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0318
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.0754
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6084
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0926
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7192
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9653
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0231
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0621
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9378
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 13,
    "avg_reward": 0.2692,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.7839,
        "error": null
      },
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.25,
        "is_valid": true,
        "speedup": 1.0318,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "date_cte_isolate",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0.0754,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.6084,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0926,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "reorder_join",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.5,
            "is_valid": true,
            "speedup": 1.0003,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.7192,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9653,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0231,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0621,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9378,
        "error": null
      }
    }
  }
}