{
  "stats": {
    "total_iterations": 18,
    "tree_size": 17,
    "successful_expansions": 16,
    "failed_expansions": 0,
    "validation_calls": 16,
    "llm_ranking_calls": 27,
    "root_visits": 18,
    "total_attempts": 16
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 91377,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.0,
      "output_sql": "SELECT\n  SUM(ss_quantity)\nFROM combined_cte AS ss, store, customer_demographics, customer_address, date_dim\nWHERE\n  s_store_sk = ss.ss_store_sk\n  AND ss.ss_sold_date_sk = d_date_sk\n  AND d_year = 1999\n  AND (\n    (\n      cd_demo_sk = ss.ss_cdemo_sk\n      AND cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss.ss_sales_price BETWEEN 100.00 AND 150.00\n    )\n    OR (\n      cd_demo_sk = ss.ss_cdemo_sk\n      AND cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss.ss_sales_price BETWEEN 50.00 AND 100.00\n    )\n    OR (\n      cd_demo_sk = ss.ss_cdemo_sk\n      AND cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss.ss_sales_price BETWEEN 150.00 AND 200.00\n    )\n  )\n  AND (\n    (\n      ss.ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss.ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      ss.ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss.ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      ss.ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss.ss_net_profit BETWEEN 50 AND 25000\n    )\n  )"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 26030,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  SUM(ss_quantity)\nFROM store_sales, store, customer_demographics, customer_address, filtered_dates\nWHERE\n  s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND (\n    (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n    )\n  )\n  AND (\n    (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n    )\n  )"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 44112,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.328,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 1.328,
      "output_sql": "WITH store_sales_consolidated AS (\n  SELECT\n    ss_store_sk,\n    ss_sold_date_sk,\n    ss_quantity,\n    CASE\n      WHEN cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n      THEN 1\n      WHEN cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n      THEN 2\n      WHEN cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n      THEN 3\n      ELSE 0\n    END AS cd_condition_id, /* Customer demographics conditions */\n    CASE\n      WHEN ca_country = 'United States'\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n      THEN 1\n      WHEN ca_country = 'United States'\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n      THEN 2\n      WHEN ca_country = 'United States'\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n      THEN 3\n      ELSE 0\n    END AS ca_condition_id /* Customer address conditions */\n  FROM store_sales\n  LEFT JOIN customer_demographics\n    ON ss_cdemo_sk = cd_demo_sk\n  LEFT JOIN customer_address\n    ON ss_addr_sk = ca_address_sk\n  WHERE\n    ss_sales_price BETWEEN 50.00 AND 200.00 AND ss_net_profit BETWEEN 0 AND 25000\n)\nSELECT\n  SUM(ss_quantity) AS total_quantity\nFROM store_sales_consolidated AS ssc\nJOIN store\n  ON s_store_sk = ss_store_sk\nJOIN date_dim\n  ON ss_sold_date_sk = d_date_sk\nWHERE\n  d_year = 1999 AND cd_condition_id > 0 AND ca_condition_id > 0"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 56016,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.019,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.5,
      "output_sql": "SELECT SUM(ss_quantity)\nFROM store_sales\nJOIN store ON s_store_sk = ss_store_sk\nJOIN date_dim ON ss_sold_date_sk = d_date_sk\nJOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\nJOIN customer_address ON ss_addr_sk = ca_address_sk\nWHERE d_year = 1999\n  AND ca_country = 'United States'\n  AND (\n    (\n      cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n    )\n    OR (\n      cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n    )\n    OR (\n      cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n    )\n  )"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 32276,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2869,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 1.2869,
      "output_sql": "SELECT\n  SUM(ss_quantity)\nFROM store_sales, store, customer_demographics, customer_address, date_dim\nWHERE\n  s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND d_year = 1999\n  AND (\n    (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n    )\n  )\n  AND (\n    (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n    )\n  )"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 29024,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0708,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.5,
      "output_sql": "SELECT\n  SUM(ss_quantity)\nFROM date_dim, store, customer_demographics, customer_address, store_sales\nWHERE\n  s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND d_year = 1999\n  AND (\n    (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n    )\n  )\n  AND (\n    (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n    )\n  )"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 12,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0044,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.5,
      "output_sql": "select sum (ss_quantity)\n from store_sales, store, customer_demographics, customer_address, date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 1999\n and  \n (\n  (\n   cd_demo_sk = ss_cdemo_sk\n   and \n   cd_marital_status = 'U'\n   and \n   cd_education_status = 'Primary'\n   and \n   ss_sales_price between 100.00 and 150.00  \n   )\n or\n  (\n  cd_demo_sk = ss_cdemo_sk\n   and \n   cd_marital_status = 'W'\n   and \n   cd_education_status = 'College'\n   and \n   ss_sales_price between 50.00 and 100.00   \n  )\n or \n (\n  cd_demo_sk = ss_cdemo_sk\n  and \n   cd_marital_status = 'D'\n   and \n   cd_education_status = '2 yr Degree'\n   and \n   ss_sales_price between 150.00 and 200.00  \n )\n )\n and\n (\n  (\n  ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('MD', 'MN', 'IA')\n  and ss_net_profit between 0 and 2000  \n  )\n or\n  (ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('VA', 'IL', 'TX')\n  and ss_net_profit between 150 and 3000 \n  )\n or\n  (ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('MI', 'WI', 'IN')\n  and ss_net_profit between 50 and 25000 \n  )\n )"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 25131,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.0,
      "output_sql": "SELECT\n  SUM(ss_quantity)\nFROM store_sales\nJOIN store\n  ON s_store_sk = ss_store_sk\nJOIN filtered_dates\n  ON ss_sold_date_sk = d_date_sk\nJOIN customer_demographics_filtered AS cdf\n  ON cd_demo_sk = ss_cdemo_sk\nJOIN customer_address_filtered AS caf\n  ON ss_addr_sk = ca_address_sk\nWHERE\n  (\n    (\n      caf.ca_state IN ('MD', 'MN', 'IA') AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      caf.ca_state IN ('VA', 'IL', 'TX') AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      caf.ca_state IN ('MI', 'WI', 'IN') AND ss_net_profit BETWEEN 50 AND 25000\n    )\n  )\n  AND (\n    (\n      ss_sales_price BETWEEN 100.00 AND 150.00\n    )\n    OR (\n      ss_sales_price BETWEEN 50.00 AND 100.00\n    )\n    OR (\n      ss_sales_price BETWEEN 150.00 AND 200.00\n    )\n  )"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 21557,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0616,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.5,
      "output_sql": "SELECT\n  SUM(ss_quantity)\nFROM store_sales, store, customer_demographics, customer_address, date_dim\nWHERE\n  s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND d_year = 1999\n  AND (\n    (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n    )\n  )\n  AND (\n    (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n    )\n  )"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 21493,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.6548,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 1.6548,
      "output_sql": "SELECT\n  SUM(ss_quantity)\nFROM store_sales, store, customer_demographics, customer_address, date_dim\nWHERE\n  s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND d_year = 1999\n  AND cd_demo_sk = ss_cdemo_sk\n  AND (\n    (\n      cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n    )\n    OR (\n      cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n    )\n    OR (\n      cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n    )\n  )\n  AND ss_addr_sk = ca_address_sk\n  AND ca_country = 'United States'\n  AND (\n    (\n      ca_state IN ('MD', 'MN', 'IA') AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      ca_state IN ('VA', 'IL', 'TX') AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      ca_state IN ('MI', 'WI', 'IN') AND ss_net_profit BETWEEN 50 AND 25000\n    )\n  )"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 38196,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 0.5348,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.0,
      "output_sql": "WITH filtered_sales AS (\n  SELECT\n    ss_store_sk,\n    ss_cdemo_sk,\n    ss_addr_sk,\n    ss_quantity,\n    ss_sales_price,\n    ss_net_profit\n  FROM store_sales\n  JOIN date_dim\n    ON ss_sold_date_sk = d_date_sk\n  WHERE\n    d_year = 1999\n), sales_agg AS (\n  SELECT\n    ss_store_sk,\n    ss_cdemo_sk,\n    ss_addr_sk,\n    SUM(ss_quantity) AS total_quantity\n  FROM filtered_sales\n  GROUP BY\n    ss_store_sk,\n    ss_cdemo_sk,\n    ss_addr_sk\n)\nSELECT\n  SUM(sa.total_quantity)\nFROM sales_agg AS sa\nJOIN store AS s\n  ON s.s_store_sk = sa.ss_store_sk\nJOIN customer_demographics AS cd\n  ON cd.cd_demo_sk = sa.ss_cdemo_sk\nJOIN customer_address AS ca\n  ON ca.ca_address_sk = sa.ss_addr_sk\nWHERE\n  (\n    (\n      cd.cd_marital_status = 'U'\n      AND cd.cd_education_status = 'Primary'\n      AND EXISTS(\n        SELECT\n          1\n        FROM filtered_sales AS fs\n        WHERE\n          fs.ss_cdemo_sk = cd.cd_demo_sk AND fs.ss_sales_price BETWEEN 100.00 AND 150.00\n      )\n    )\n    OR (\n      cd.cd_marital_status = 'W'\n      AND cd.cd_education_status = 'College'\n      AND EXISTS(\n        SELECT\n          1\n        FROM filtered_sales AS fs\n        WHERE\n          fs.ss_cdemo_sk = cd.cd_demo_sk AND fs.ss_sales_price BETWEEN 50.00 AND 100.00\n      )\n    )\n    OR (\n      cd.cd_marital_status = 'D'\n      AND cd.cd_education_status = '2 yr Degree'\n      AND EXISTS(\n        SELECT\n          1\n        FROM filtered_sales AS fs\n        WHERE\n          fs.ss_cdemo_sk = cd.cd_demo_sk AND fs.ss_sales_price BETWEEN 150.00 AND 200.00\n      )\n    )\n  )\n  AND (\n    (\n      ca.ca_country = 'United States'\n      AND ca.ca_state IN ('MD', 'MN', 'IA')\n      AND EXISTS(\n        SELECT\n          1\n        FROM filtered_sales AS fs\n        WHERE\n          fs.ss_addr_sk = ca.ca_address_sk AND fs.ss_net_profit BETWEEN 0 AND 2000\n      )\n    )\n    OR (\n      ca.ca_country = 'United States'\n      AND ca.ca_state IN ('VA', 'IL', 'TX')\n      AND EXISTS(\n        SELECT\n          1\n        FROM filtered_sales AS fs\n        WHERE\n          fs.ss_addr_sk = ca.ca_address_sk AND fs.ss_net_profit BETWEEN 150 AND 3000\n      )\n    )\n    OR (\n      ca.ca_country = 'United States'\n      AND ca.ca_state IN ('MI', 'WI', 'IN')\n      AND EXISTS(\n        SELECT\n          1\n        FROM filtered_sales AS fs\n        WHERE\n          fs.ss_addr_sk = ca.ca_address_sk AND fs.ss_net_profit BETWEEN 50 AND 25000\n      )\n    )\n  )"
    },
    {
      "iteration": 12,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 31629,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2897,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.2897,
      "output_sql": "SELECT\n  SUM(ss_quantity)\nFROM date_dim, customer_demographics, customer_address, store, store_sales\nWHERE\n  s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND d_year = 1999\n  AND (\n    (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n    )\n    OR (\n      cd_demo_sk = ss_cdemo_sk\n      AND cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n    )\n  )\n  AND (\n    (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n    )\n    OR (\n      ss_addr_sk = ca_address_sk\n      AND ca_country = 'United States'\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n    )\n  )"
    },
    {
      "iteration": 13,
      "parent_path": [
        "remove_redundant"
      ],
      "transform_id": "or_to_union",
      "duration_ms": 55169,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  SUM(sum_quantity)\nFROM combined_cte"
    },
    {
      "iteration": 14,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 62946,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1775,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1775,
      "output_sql": "WITH store_sales_consolidated AS (\n  SELECT\n    ss_store_sk,\n    ss_sold_date_sk,\n    ss_quantity,\n    CASE\n      WHEN cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n      THEN 1\n      WHEN cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n      THEN 2\n      WHEN cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n      THEN 3\n      ELSE 0\n    END AS cd_condition_id, /* Customer demographics conditions */\n    CASE\n      WHEN ca_country = 'United States'\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n      THEN 1\n      WHEN ca_country = 'United States'\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n      THEN 2\n      WHEN ca_country = 'United States'\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n      THEN 3\n      ELSE 0\n    END AS ca_condition_id /* Customer address conditions */\n  FROM store_sales\n  LEFT JOIN customer_demographics\n    ON ss_cdemo_sk = cd_demo_sk\n  LEFT JOIN customer_address\n    ON ss_addr_sk = ca_address_sk\n  WHERE\n    ss_sales_price BETWEEN 50.00 AND 200.00\n    AND ss_net_profit BETWEEN 0 AND 25000\n    AND (\n      (\n        cd_marital_status = 'U'\n        AND cd_education_status = 'Primary'\n        AND ss_sales_price BETWEEN 100.00 AND 150.00\n      )\n      OR (\n        cd_marital_status = 'W'\n        AND cd_education_status = 'College'\n        AND ss_sales_price BETWEEN 50.00 AND 100.00\n      )\n      OR (\n        cd_marital_status = 'D'\n        AND cd_education_status = '2 yr Degree'\n        AND ss_sales_price BETWEEN 150.00 AND 200.00\n      )\n    )\n    AND (\n      (\n        ca_country = 'United States'\n        AND ca_state IN ('MD', 'MN', 'IA')\n        AND ss_net_profit BETWEEN 0 AND 2000\n      )\n      OR (\n        ca_country = 'United States'\n        AND ca_state IN ('VA', 'IL', 'TX')\n        AND ss_net_profit BETWEEN 150 AND 3000\n      )\n      OR (\n        ca_country = 'United States'\n        AND ca_state IN ('MI', 'WI', 'IN')\n        AND ss_net_profit BETWEEN 50 AND 25000\n      )\n    )\n)\nSELECT\n  SUM(ss_quantity) AS total_quantity\nFROM store_sales_consolidated AS ssc\nJOIN store\n  ON s_store_sk = ss_store_sk\nJOIN date_dim\n  ON ss_sold_date_sk = d_date_sk\nWHERE\n  d_year = 1999"
    },
    {
      "iteration": 15,
      "parent_path": [
        "push_pred",
        "reorder_join"
      ],
      "transform_id": "materialize_cte",
      "duration_ms": 76140,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  SUM(ss_quantity)\nFROM date_dim, store, store_sales, customer_demographics_filter AS cdf, customer_address_filter AS caf\nWHERE\n  s_store_sk = ss_store_sk\n  AND ss_sold_date_sk = d_date_sk\n  AND d_year = 1999\n  AND ss_cdemo_sk = cdf.cd_demo_sk\n  AND ss_addr_sk = caf.ca_address_sk\n  AND (\n    (\n      cdf.cd_demo_sk = ss_cdemo_sk\n      AND (\n        (\n          cd_marital_status = 'U'\n          AND cd_education_status = 'Primary'\n          AND ss_sales_price BETWEEN 100.00 AND 150.00\n        )\n        OR (\n          cd_marital_status = 'W'\n          AND cd_education_status = 'College'\n          AND ss_sales_price BETWEEN 50.00 AND 100.00\n        )\n        OR (\n          cd_marital_status = 'D'\n          AND cd_education_status = '2 yr Degree'\n          AND ss_sales_price BETWEEN 150.00 AND 200.00\n        )\n      )\n    )\n    AND (\n      (\n        caf.ca_address_sk = ss_addr_sk\n        AND (\n          (\n            ca_state IN ('MD', 'MN', 'IA') AND ss_net_profit BETWEEN 0 AND 2000\n          )\n          OR (\n            ca_state IN ('VA', 'IL', 'TX') AND ss_net_profit BETWEEN 150 AND 3000\n          )\n          OR (\n            ca_state IN ('MI', 'WI', 'IN') AND ss_net_profit BETWEEN 50 AND 25000\n          )\n        )\n      )\n    )\n  )"
    },
    {
      "iteration": 16,
      "parent_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 67873,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.5007,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.5007,
      "output_sql": "WITH store_sales_consolidated AS (\n  SELECT\n    ss_store_sk,\n    ss_sold_date_sk,\n    ss_quantity,\n    CASE\n      WHEN cd_marital_status = 'U'\n      AND cd_education_status = 'Primary'\n      AND ss_sales_price BETWEEN 100.00 AND 150.00\n      THEN 1\n      WHEN cd_marital_status = 'W'\n      AND cd_education_status = 'College'\n      AND ss_sales_price BETWEEN 50.00 AND 100.00\n      THEN 2\n      WHEN cd_marital_status = 'D'\n      AND cd_education_status = '2 yr Degree'\n      AND ss_sales_price BETWEEN 150.00 AND 200.00\n      THEN 3\n      ELSE 0\n    END AS cd_condition_id, /* Customer demographics conditions */\n    CASE\n      WHEN ca_country = 'United States'\n      AND ca_state IN ('MD', 'MN', 'IA')\n      AND ss_net_profit BETWEEN 0 AND 2000\n      THEN 1\n      WHEN ca_country = 'United States'\n      AND ca_state IN ('VA', 'IL', 'TX')\n      AND ss_net_profit BETWEEN 150 AND 3000\n      THEN 2\n      WHEN ca_country = 'United States'\n      AND ca_state IN ('MI', 'WI', 'IN')\n      AND ss_net_profit BETWEEN 50 AND 25000\n      THEN 3\n      ELSE 0\n    END AS ca_condition_id /* Customer address conditions */\n  FROM customer_demographics\n  JOIN store_sales\n    ON ss_cdemo_sk = cd_demo_sk\n  JOIN customer_address\n    ON ss_addr_sk = ca_address_sk\n  WHERE\n    ss_sales_price BETWEEN 50.00 AND 200.00\n    AND ss_net_profit BETWEEN 0 AND 25000\n    AND (\n      (\n        cd_marital_status = 'U'\n        AND cd_education_status = 'Primary'\n        AND ss_sales_price BETWEEN 100.00 AND 150.00\n      )\n      OR (\n        cd_marital_status = 'W'\n        AND cd_education_status = 'College'\n        AND ss_sales_price BETWEEN 50.00 AND 100.00\n      )\n      OR (\n        cd_marital_status = 'D'\n        AND cd_education_status = '2 yr Degree'\n        AND ss_sales_price BETWEEN 150.00 AND 200.00\n      )\n    )\n    AND (\n      (\n        ca_country = 'United States'\n        AND ca_state IN ('MD', 'MN', 'IA')\n        AND ss_net_profit BETWEEN 0 AND 2000\n      )\n      OR (\n        ca_country = 'United States'\n        AND ca_state IN ('VA', 'IL', 'TX')\n        AND ss_net_profit BETWEEN 150 AND 3000\n      )\n      OR (\n        ca_country = 'United States'\n        AND ca_state IN ('MI', 'WI', 'IN')\n        AND ss_net_profit BETWEEN 50 AND 25000\n      )\n    )\n)\nSELECT\n  SUM(ss_quantity) AS total_quantity\nFROM date_dim\nJOIN store_sales_consolidated AS ssc\n  ON ss_sold_date_sk = d_date_sk\nJOIN store\n  ON s_store_sk = ss_store_sk\nWHERE\n  d_year = 1999"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0167,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3569,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3614,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.5105,
          "visits": 1,
          "avg_reward": 1.2869,
          "is_valid": true,
          "speedup": 1.2869,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3653,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.5318,
          "visits": 1,
          "avg_reward": 1.2869,
          "is_valid": true,
          "speedup": 1.2869,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6225,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3689,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.5515,
          "visits": 1,
          "avg_reward": 1.2869,
          "is_valid": true,
          "speedup": 1.2869,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6323,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3721,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.7112,
          "visits": 1,
          "avg_reward": 1.2869,
          "is_valid": true,
          "speedup": 1.2869,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7828,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3752,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.7369,
          "visits": 1,
          "avg_reward": 1.2869,
          "is_valid": true,
          "speedup": 1.2869,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.15,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0616,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.378,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 2.0775,
          "visits": 1,
          "avg_reward": 1.2869,
          "is_valid": true,
          "speedup": 1.2869,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9743,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3162,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6581,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0616,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.7075,
          "visits": 1,
          "avg_reward": 1.6548,
          "is_valid": true,
          "speedup": 1.6548,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3807,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1608,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8292,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3833,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5553,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.7844,
          "visits": 1,
          "avg_reward": 1.2869,
          "is_valid": true,
          "speedup": 1.2869
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8317,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5553,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1658,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5553,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0616
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.7101,
          "visits": 1,
          "avg_reward": 1.6548,
          "is_valid": true,
          "speedup": 1.6548
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.5348
        }
      ],
      "selected": "push_pred",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.6429,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.4982,
          "visits": 2,
          "avg_reward": 1.2883,
          "is_valid": true,
          "speedup": 1.2869
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0616
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.9698,
          "visits": 1,
          "avg_reward": 1.6548,
          "is_valid": true,
          "speedup": 1.6548
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.5348
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.6558,
          "visits": 1,
          "avg_reward": 1.328,
          "is_valid": true,
          "speedup": 1.328
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.5068,
          "visits": 2,
          "avg_reward": 1.2883,
          "is_valid": true,
          "speedup": 1.2869
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0616
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.0459,
          "visits": 2,
          "avg_reward": 0.8274,
          "is_valid": true,
          "speedup": 1.6548
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.5348
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "or_to_union",
          "uct_score": 1.3096,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0624,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2944,
          "visits": 2,
          "avg_reward": 1.2528,
          "is_valid": true,
          "speedup": 1.328
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5624,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.9119,
          "visits": 2,
          "avg_reward": 1.2883,
          "is_valid": true,
          "speedup": 1.2869
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.0612,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5624,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3742,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6871,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0616
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.869,
          "visits": 2,
          "avg_reward": 0.8274,
          "is_valid": true,
          "speedup": 1.6548
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0624,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.5348
        }
      ],
      "selected": "push_pred",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 1.6432,
          "visits": 1,
          "avg_reward": 1.2897,
          "is_valid": true,
          "speedup": 1.2897,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred",
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.4875,
          "visits": 2,
          "avg_reward": 1.2528,
          "is_valid": true,
          "speedup": 1.328
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.0349,
          "visits": 3,
          "avg_reward": 0.8589,
          "is_valid": true,
          "speedup": 1.2869
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0616
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.0621,
          "visits": 2,
          "avg_reward": 0.8274,
          "is_valid": true,
          "speedup": 1.6548
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.5348
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.319,
          "visits": 1,
          "avg_reward": 1.1775,
          "is_valid": true,
          "speedup": 1.1775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.5172,
          "visits": 3,
          "avg_reward": 1.3354,
          "is_valid": true,
          "speedup": 1.328
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.0407,
          "visits": 3,
          "avg_reward": 0.8589,
          "is_valid": true,
          "speedup": 1.2869
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0616
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.0698,
          "visits": 2,
          "avg_reward": 0.8274,
          "is_valid": true,
          "speedup": 1.6548
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.5348
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.4546,
          "visits": 2,
          "avg_reward": 1.3391,
          "is_valid": true,
          "speedup": 1.1775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 1.6578,
          "visits": 1,
          "avg_reward": 1.5007,
          "is_valid": true,
          "speedup": 1.5007,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred",
        "reorder_join"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.1515,
          "visits": 4,
          "avg_reward": 1.0016,
          "is_valid": true,
          "speedup": 1.328
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.019
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.0463,
          "visits": 3,
          "avg_reward": 0.8589,
          "is_valid": true,
          "speedup": 1.2869
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0708
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0044
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0616
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.0773,
          "visits": 2,
          "avg_reward": 0.8274,
          "is_valid": true,
          "speedup": 1.6548
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.5348
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9927,
          "visits": 3,
          "avg_reward": 0.8927,
          "is_valid": true,
          "speedup": 1.1775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8786,
          "visits": 2,
          "avg_reward": 0.7503,
          "is_valid": true,
          "speedup": 1.5007,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred",
        "reorder_join"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 18,
    "avg_reward": 0.5688,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 5,
        "avg_reward": 0.8012,
        "is_valid": true,
        "speedup": 1.328,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "consolidate_scans",
              "push_pred"
            ],
            "depth": 2,
            "visits": 4,
            "avg_reward": 0.6695,
            "is_valid": true,
            "speedup": 1.1775,
            "error": null,
            "children": {
              "reorder_join": {
                "transforms": [
                  "consolidate_scans",
                  "push_pred",
                  "reorder_join"
                ],
                "depth": 3,
                "visits": 3,
                "avg_reward": 0.5002,
                "is_valid": true,
                "speedup": 1.5007,
                "error": null
              }
            }
          }
        }
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.019,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 3,
        "avg_reward": 0.8589,
        "is_valid": true,
        "speedup": 1.2869,
        "error": null,
        "children": {
          "reorder_join": {
            "transforms": [
              "push_pred",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.6448,
            "is_valid": true,
            "speedup": 1.2897,
            "error": null,
            "children": {
              "materialize_cte": {
                "transforms": [
                  "push_pred",
                  "reorder_join",
                  "materialize_cte"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.0,
                "is_valid": false,
                "speedup": 0,
                "error": null
              }
            }
          }
        }
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0708,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0044,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0616,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.8274,
        "is_valid": true,
        "speedup": 1.6548,
        "error": null,
        "children": {
          "or_to_union": {
            "transforms": [
              "remove_redundant",
              "or_to_union"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0.5348,
        "error": null
      }
    }
  }
}