{
  "stats": {
    "total_iterations": 15,
    "tree_size": 15,
    "successful_expansions": 14,
    "failed_expansions": 0,
    "validation_calls": 14,
    "llm_ranking_calls": 22,
    "root_visits": 15,
    "total_attempts": 14
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 52064,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.0,
      "output_sql": "SELECT\n  *\nFROM (\n  SELECT\n    w_warehouse_name,\n    i_item_id,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_before,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_after\n  FROM inventory, warehouse, item, filtered_dates AS fd\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = inv_item_sk\n    AND inv_warehouse_sk = w_warehouse_sk\n    AND inv_date_sk = fd.d_date_sk\n  GROUP BY\n    w_warehouse_name,\n    i_item_id\n) AS x\nWHERE\n  (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 57973,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9195,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT *\nFROM (\n    SELECT w_warehouse_name,\n           i_item_id,\n           SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) AS inv_before,\n           SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) AS inv_after\n    FROM (\n        SELECT inv_quantity_on_hand, inv_item_sk, inv_warehouse_sk, inv_date_sk\n        FROM inventory\n        WHERE inv_date_sk IN (\n            SELECT d_date_sk\n            FROM date_dim\n            WHERE d_date BETWEEN (CAST('2002-02-27' AS DATE) - INTERVAL 30 DAY)\n                             AND (CAST('2002-02-27' AS DATE) + INTERVAL 30 DAY)\n        )\n    ) inventory,\n    warehouse,\n    (\n        SELECT i_item_id, i_item_sk\n        FROM item\n        WHERE i_current_price BETWEEN 0.99 AND 1.49\n    ) item,\n    (\n        SELECT d_date_sk, d_date\n        FROM date_dim\n        WHERE d_date BETWEEN (CAST('2002-02-27' AS DATE) - INTERVAL 30 DAY)\n                         AND (CAST('2002-02-27' AS DATE) + INTERVAL 30 DAY)\n    ) date_dim\n    WHERE i_item_sk = inv_item_sk\n      AND inv_warehouse_sk = w_warehouse_sk\n      AND inv_date_sk = d_date_sk\n    GROUP BY w_warehouse_name, i_item_id\n) x\nWHERE (CASE WHEN inv_before > 0 \n            THEN inv_after / inv_before \n            ELSE NULL\n       END) BETWEEN 2.0/3.0 AND 3.0/2.0\nORDER BY w_warehouse_name,\n         i_item_id\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 25991,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0888,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.5,
      "output_sql": "SELECT\n  *\nFROM (\n  SELECT\n    w_warehouse_name,\n    i_item_id,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_before,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_after\n  FROM inventory, warehouse, item, date_dim\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = inv_item_sk\n    AND inv_warehouse_sk = w_warehouse_sk\n    AND inv_date_sk = d_date_sk\n    AND d_date BETWEEN (\n      CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY\n    )\n  GROUP BY\n    w_warehouse_name,\n    i_item_id\n) AS x\nWHERE\n  (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 69251,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.0,
      "output_sql": "WITH branch1 AS (\n    SELECT w_warehouse_name,\n           i_item_id,\n           SUM(CASE WHEN (cast(d_date as date) < cast ('2002-02-27' as date)) THEN inv_quantity_on_hand ELSE 0 END) as inv_before,\n           SUM(CASE WHEN (cast(d_date as date) >= cast ('2002-02-27' as date)) THEN inv_quantity_on_hand ELSE 0 END) as inv_after\n    FROM inventory, warehouse, item, date_dim\n    WHERE i_current_price between 0.99 and 1.49\n      AND i_item_sk = inv_item_sk\n      AND inv_warehouse_sk = w_warehouse_sk\n      AND inv_date_sk = d_date_sk\n      AND d_date between (cast ('2002-02-27' as date) - INTERVAL 30 DAY)\n                      and (cast ('2002-02-27' as date) + INTERVAL 30 DAY)\n      AND (inv_after / inv_before) between 2.0/3.0 and 3.0/2.0\n      AND inv_before > 0\n    GROUP BY w_warehouse_name, i_item_id\n),\nbranch2 AS (\n    SELECT w_warehouse_name,\n           i_item_id,\n           SUM(CASE WHEN (cast(d_date as date) < cast ('2002-02-27' as date)) THEN inv_quantity_on_hand ELSE 0 END) as inv_before,\n           SUM(CASE WHEN (cast(d_date as date) >= cast ('2002-02-27' as date)) THEN inv_quantity_on_hand ELSE 0 END) as inv_after\n    FROM inventory, warehouse, item, date_dim\n    WHERE i_current_price between 0.99 and 1.49\n      AND i_item_sk = inv_item_sk\n      AND inv_warehouse_sk = w_warehouse_sk\n      AND inv_date_sk = d_date_sk\n      AND d_date between (cast ('2002-02-27' as date) - INTERVAL 30 DAY)\n                      and (cast ('2002-02-27' as date) + INTERVAL 30 DAY)\n      AND inv_before <= 0\n    GROUP BY w_warehouse_name, i_item_id\n)\nSELECT * FROM (\n    SELECT * FROM branch1\n    UNION ALL\n    SELECT * FROM branch2\n) x\nWHERE (CASE WHEN inv_before > 0 \n            THEN inv_after / inv_before \n            ELSE NULL\n       END) between 2.0/3.0 and 3.0/2.0\nORDER BY w_warehouse_name, i_item_id\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 25424,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7072,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.2,
      "output_sql": "SELECT\n  w_warehouse_name,\n  i_item_id,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n      )\n      THEN inv_quantity_on_hand\n      ELSE 0\n    END\n  ) AS inv_before,\n  SUM(\n    CASE\n      WHEN (\n        CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n      )\n      THEN inv_quantity_on_hand\n      ELSE 0\n    END\n  ) AS inv_after\nFROM inventory, warehouse, item, date_dim\nWHERE\n  i_current_price BETWEEN 0.99 AND 1.49\n  AND i_item_sk = inv_item_sk\n  AND inv_warehouse_sk = w_warehouse_sk\n  AND inv_date_sk = d_date_sk\n  AND d_date BETWEEN (\n    CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY\n  ) AND (\n    CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY\n  )\nGROUP BY\n  w_warehouse_name,\n  i_item_id\nHAVING\n  (\n    CASE\n      WHEN SUM(\n        CASE\n          WHEN (\n            CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n          )\n          THEN inv_quantity_on_hand\n          ELSE 0\n        END\n      ) > 0\n      THEN SUM(\n        CASE\n          WHEN (\n            CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n          )\n          THEN inv_quantity_on_hand\n          ELSE 0\n        END\n      ) / SUM(\n        CASE\n          WHEN (\n            CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n          )\n          THEN inv_quantity_on_hand\n          ELSE 0\n        END\n      )\n      ELSE NULL\n    END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 43070,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0108,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.5,
      "output_sql": "SELECT\n  w_warehouse_name,\n  i_item_id,\n  inv_before,\n  inv_after\nFROM (\n  SELECT\n    w_warehouse_name,\n    i_item_id,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_before,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_after\n  FROM inventory, warehouse, item, date_dim\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = inv_item_sk\n    AND inv_warehouse_sk = w_warehouse_sk\n    AND inv_date_sk = d_date_sk\n    AND d_date BETWEEN (\n      CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY\n    )\n  GROUP BY\n    w_warehouse_name,\n    i_item_id\n) AS x\nWHERE\n  (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 87,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.4263,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 1.4263,
      "output_sql": "select *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2002-02-27' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2002-02-27' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between (cast ('2002-02-27' as date) - INTERVAL 30 DAY)\n                    and (cast ('2002-02-27' as date) + INTERVAL 30 DAY)\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n LIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 28805,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.5449,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.2,
      "output_sql": "WITH inventory_summary AS (\n  SELECT\n    w_warehouse_name,\n    i_item_id,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_before,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_after\n  FROM inventory, warehouse, item, date_dim\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = inv_item_sk\n    AND inv_warehouse_sk = w_warehouse_sk\n    AND inv_date_sk = d_date_sk\n    AND d_date BETWEEN (\n      CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY\n    )\n  GROUP BY\n    w_warehouse_name,\n    i_item_id\n)\nSELECT\n  *\nFROM inventory_summary\nWHERE\n  (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 20016,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.0,
      "output_sql": "SELECT\n  *\nFROM derived_1\nWHERE\n  (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 28278,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.0,
      "output_sql": "SELECT\n  w_warehouse_name,\n  i_item_id,\n  inv_before,\n  inv_after\nFROM inventory_summary\nWHERE\n  (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 23668,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.6172,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.2,
      "output_sql": "SELECT\n  *\nFROM (\n  SELECT\n    w_warehouse_name,\n    i_item_id,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_before,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_after\n  FROM inventory, warehouse, item, date_dim\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = inv_item_sk\n    AND inv_warehouse_sk = w_warehouse_sk\n    AND inv_date_sk = d_date_sk\n    AND d_date BETWEEN (\n      CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY\n    )\n  GROUP BY\n    w_warehouse_name,\n    i_item_id\n) AS x\nWHERE\n  (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "or_to_union",
      "duration_ms": 73584,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 0.547,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH base_data AS (\n    SELECT\n        w_warehouse_name,\n        i_item_id,\n        inv_quantity_on_hand,\n        d_date\n    FROM inventory, warehouse, item, date_dim\n    WHERE i_current_price BETWEEN 0.99 AND 1.49\n      AND i_item_sk = inv_item_sk\n      AND inv_warehouse_sk = w_warehouse_sk\n      AND inv_date_sk = d_date_sk\n      AND d_date BETWEEN (CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY)\n                      AND (CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY)\n),\nbefore_period AS (\n    SELECT\n        w_warehouse_name,\n        i_item_id,\n        SUM(inv_quantity_on_hand) AS inv_before,\n        0 AS inv_after\n    FROM base_data\n    WHERE CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n    GROUP BY w_warehouse_name, i_item_id\n),\nafter_period AS (\n    SELECT\n        w_warehouse_name,\n        i_item_id,\n        0 AS inv_before,\n        SUM(inv_quantity_on_hand) AS inv_after\n    FROM base_data\n    WHERE CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n    GROUP BY w_warehouse_name, i_item_id\n),\ncombined AS (\n    SELECT\n        COALESCE(b.w_warehouse_name, a.w_warehouse_name) AS w_warehouse_name,\n        COALESCE(b.i_item_id, a.i_item_id) AS i_item_id,\n        COALESCE(b.inv_before, 0) AS inv_before,\n        COALESCE(a.inv_after, 0) AS inv_after\n    FROM before_period b\n    FULL OUTER JOIN after_period a\n        ON b.w_warehouse_name = a.w_warehouse_name\n        AND b.i_item_id = a.i_item_id\n)\nSELECT\n    w_warehouse_name,\n    i_item_id,\n    inv_before,\n    inv_after\nFROM combined\nWHERE (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY w_warehouse_name, i_item_id\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "multi_push_pred"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 40258,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2225,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.2225,
      "output_sql": "SELECT\n  w_warehouse_name,\n  i_item_id,\n  inv_before,\n  inv_after\nFROM (\n  SELECT\n    w_warehouse_name,\n    i_item_id,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_before,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_after\n  FROM inventory, warehouse, item, date_dim\n  WHERE\n    i_current_price BETWEEN 0.99 AND 1.49\n    AND i_item_sk = inv_item_sk\n    AND inv_warehouse_sk = w_warehouse_sk\n    AND inv_date_sk = d_date_sk\n    AND d_date BETWEEN (\n      CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY\n    )\n  GROUP BY\n    w_warehouse_name,\n    i_item_id\n) AS x\nWHERE\n  (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "multi_push_pred",
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 55204,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1285,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1285,
      "output_sql": "SELECT\n  w_warehouse_name,\n  i_item_id,\n  inv_before,\n  inv_after\nFROM (\n  SELECT\n    w_warehouse_name,\n    i_item_id,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_before,\n    SUM(\n      CASE\n        WHEN (\n          CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)\n        )\n        THEN inv_quantity_on_hand\n        ELSE 0\n      END\n    ) AS inv_after\n  FROM inventory\n  JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk\n  JOIN item ON i_item_sk = inv_item_sk\n    AND i_current_price BETWEEN 0.99 AND 1.49\n  JOIN date_dim ON inv_date_sk = d_date_sk\n    AND d_date BETWEEN (\n      CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY\n    ) AND (\n      CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY\n    )\n  GROUP BY\n    w_warehouse_name,\n    i_item_id\n) AS x\nWHERE\n  (\n    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END\n  ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0\nORDER BY\n  w_warehouse_name,\n  i_item_id\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0167,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5289,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6118,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3225,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0108,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6323,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4704,
          "visits": 1,
          "avg_reward": 1.4263,
          "is_valid": true,
          "speedup": 1.4263,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0108,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4828,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5449,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4734,
          "visits": 1,
          "avg_reward": 1.4263,
          "is_valid": true,
          "speedup": 1.4263,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0108,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.35,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5449,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4763,
          "visits": 1,
          "avg_reward": 1.4263,
          "is_valid": true,
          "speedup": 1.4263,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0108,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6743,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8162,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3581,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5449,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7906,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.479,
          "visits": 1,
          "avg_reward": 1.4263,
          "is_valid": true,
          "speedup": 1.4263,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0108,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4975,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5317,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6658,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.6608,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0108
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4815,
          "visits": 1,
          "avg_reward": 1.4263,
          "is_valid": true,
          "speedup": 1.4263
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.0292,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5449
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6172
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4599,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0108
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.7412,
          "visits": 1,
          "avg_reward": 1.4263,
          "is_valid": true,
          "speedup": 1.4263
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5449
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6172
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "multi_push_pred"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4685,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0108
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.5429,
          "visits": 2,
          "avg_reward": 1.3244,
          "is_valid": true,
          "speedup": 1.4263
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5449
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6172
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "multi_push_pred"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.7175,
          "visits": 1,
          "avg_reward": 1.2225,
          "is_valid": true,
          "speedup": 1.2225,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "multi_push_pred",
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9195
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0888
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7072
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4768,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0108
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4292,
          "visits": 3,
          "avg_reward": 1.2591,
          "is_valid": true,
          "speedup": 1.4263
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5449
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6172
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "multi_push_pred"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.5797,
          "visits": 2,
          "avg_reward": 1.1755,
          "is_valid": true,
          "speedup": 1.2225,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "multi_push_pred",
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.2857,
          "visits": 1,
          "avg_reward": 1.1285,
          "is_valid": true,
          "speedup": 1.1285,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "multi_push_pred",
        "consolidate_scans",
        "push_pred"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 15,
    "avg_reward": 0.3718,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9195,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0888,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.7072,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.25,
        "is_valid": true,
        "speedup": 1.0108,
        "error": null,
        "children": {
          "or_to_union": {
            "transforms": [
              "consolidate_scans",
              "or_to_union"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0.547,
            "error": null
          }
        }
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 4,
        "avg_reward": 0.9443,
        "is_valid": true,
        "speedup": 1.4263,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "multi_push_pred",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 3,
            "avg_reward": 0.7837,
            "is_valid": true,
            "speedup": 1.2225,
            "error": null,
            "children": {
              "push_pred": {
                "transforms": [
                  "multi_push_pred",
                  "consolidate_scans",
                  "push_pred"
                ],
                "depth": 3,
                "visits": 2,
                "avg_reward": 0.5643,
                "is_valid": true,
                "speedup": 1.1285,
                "error": null
              }
            }
          }
        }
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.5449,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.6172,
        "error": null
      }
    }
  }
}