{
  "stats": {
    "total_iterations": 9,
    "tree_size": 10,
    "successful_expansions": 9,
    "failed_expansions": 0,
    "validation_calls": 9,
    "llm_ranking_calls": 10,
    "root_visits": 9,
    "total_attempts": 9
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 31458,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.8962,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 1.8962,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk,\n    d_month_seq\n  FROM date_dim\n  WHERE\n    d_year = 1998 AND d_moy = 5\n), my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM (\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_bill_customer_sk AS customer_sk,\n      cs_item_sk AS item_sk\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_bill_customer_sk AS customer_sk,\n      ws_item_sk AS item_sk\n    FROM web_sales\n  ) AS cs_or_ws_sales, item, filtered_dates, customer\n  WHERE\n    sold_date_sk = d_date_sk\n    AND item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND i_class = 'maternity'\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n), my_revenue AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_ext_sales_price) AS revenue\n  FROM my_customers, store_sales, customer_address, store, filtered_dates\n  WHERE\n    c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN (\n      SELECT DISTINCT\n        d_month_seq + 1\n      FROM filtered_dates\n    ) AND (\n      SELECT DISTINCT\n        d_month_seq + 3\n      FROM filtered_dates\n    )\n  GROUP BY\n    c_customer_sk\n), segments AS (\n  SELECT\n    CAST((\n      revenue / 50\n    ) AS INT) AS segment\n  FROM my_revenue\n)\nSELECT\n  segment,\n  COUNT(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY\n  segment\nORDER BY\n  segment,\n  num_customers\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [
        "date_cte_isolate"
      ],
      "transform_id": "push_pred",
      "duration_ms": 32292,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk,\n    d_month_seq\n  FROM date_dim\n  WHERE\n    d_year = 1998 AND d_moy = 5\n), my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM (\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_bill_customer_sk AS customer_sk,\n      cs_item_sk AS item_sk\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_bill_customer_sk AS customer_sk,\n      ws_item_sk AS item_sk\n    FROM web_sales\n  ) AS cs_or_ws_sales, item, filtered_dates, customer\n  WHERE\n    sold_date_sk = d_date_sk\n    AND item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND i_class = 'maternity'\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n), my_revenue AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_ext_sales_price) AS revenue\n  FROM my_customers, store_sales, customer_address, store, filtered_dates\n  WHERE\n    c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN (\n      SELECT\n        d_month_seq + 1\n      FROM filtered_dates\n    ) AND (\n      SELECT\n        d_month_seq + 3\n      FROM filtered_dates\n    )\n  GROUP BY\n    c_customer_sk\n), segments AS (\n  SELECT\n    CAST((\n      revenue / 50\n    ) AS INT) AS segment\n  FROM my_revenue\n)\nSELECT\n  segment,\n  COUNT(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY\n  segment\nORDER BY\n  segment,\n  num_customers\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 46343,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.0,
      "output_sql": "WITH month_seq_values AS (\n  SELECT DISTINCT\n    d_month_seq\n  FROM date_dim\n  WHERE\n    d_year = 1998 AND d_moy = 5\n), my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM (\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_bill_customer_sk AS customer_sk,\n      cs_item_sk AS item_sk\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_bill_customer_sk AS customer_sk,\n      ws_item_sk AS item_sk\n    FROM web_sales\n  ) AS cs_or_ws_sales, item, date_dim, customer\n  WHERE\n    sold_date_sk = d_date_sk\n    AND item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND i_class = 'maternity'\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n    AND d_moy = 5\n    AND d_year = 1998\n), my_revenue AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_ext_sales_price) AS revenue\n  FROM my_customers, store_sales, customer_address, store, date_dim, month_seq_values\n  WHERE\n    c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN (\n      SELECT\n        d_month_seq + 1\n      FROM month_seq_values\n    ) AND (\n      SELECT\n        d_month_seq + 3\n      FROM month_seq_values\n    )\n  GROUP BY\n    c_customer_sk\n), segments AS (\n  SELECT\n    CAST((\n      revenue / 50\n    ) AS INT) AS segment\n  FROM my_revenue\n)\nSELECT\n  segment,\n  COUNT(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY\n  segment\nORDER BY\n  segment,\n  num_customers\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 29747,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.046,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.5,
      "output_sql": "WITH branch1_cte AS (\n  SELECT\n    cs_sold_date_sk AS sold_date_sk,\n    cs_bill_customer_sk AS customer_sk,\n    cs_item_sk AS item_sk\n  FROM catalog_sales\n), branch2_cte AS (\n  SELECT\n    ws_sold_date_sk AS sold_date_sk,\n    ws_bill_customer_sk AS customer_sk,\n    ws_item_sk AS item_sk\n  FROM web_sales\n), cs_or_ws_sales AS (\n  SELECT\n    sold_date_sk,\n    customer_sk,\n    item_sk\n  FROM branch1_cte\n  UNION ALL\n  SELECT\n    sold_date_sk,\n    customer_sk,\n    item_sk\n  FROM branch2_cte\n), my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM cs_or_ws_sales, item, date_dim, customer\n  WHERE\n    sold_date_sk = d_date_sk\n    AND item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND i_class = 'maternity'\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n    AND d_moy = 5\n    AND d_year = 1998\n), my_revenue AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_ext_sales_price) AS revenue\n  FROM my_customers, store_sales, customer_address, store, date_dim\n  WHERE\n    c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN (\n      SELECT DISTINCT\n        d_month_seq + 1\n      FROM date_dim\n      WHERE\n        d_year = 1998 AND d_moy = 5\n    ) AND (\n      SELECT DISTINCT\n        d_month_seq + 3\n      FROM date_dim\n      WHERE\n        d_year = 1998 AND d_moy = 5\n    )\n  GROUP BY\n    c_customer_sk\n), segments AS (\n  SELECT\n    CAST((\n      revenue / 50\n    ) AS INT) AS segment\n  FROM my_revenue\n)\nSELECT\n  segment,\n  COUNT(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY\n  segment\nORDER BY\n  segment,\n  num_customers\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 53461,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7501,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.2,
      "output_sql": "WITH combined_date_dim AS (\n  SELECT\n    d_date_sk,\n    d_month_seq,\n    CASE WHEN d_moy = 5 AND d_year = 1998 THEN d_date_sk END AS base_date_sk,\n    CASE WHEN d_moy = 5 AND d_year = 1998 THEN d_month_seq + 1 END AS lower_bound,\n    CASE WHEN d_moy = 5 AND d_year = 1998 THEN d_month_seq + 3 END AS upper_bound\n  FROM date_dim\n  WHERE\n    (\n      d_moy = 5 AND d_year = 1998\n    )\n    OR d_month_seq BETWEEN (\n      SELECT\n        MIN(d_month_seq + 1)\n      FROM date_dim\n      WHERE\n        d_moy = 5 AND d_year = 1998\n    ) AND (\n      SELECT\n        MAX(d_month_seq + 3)\n      FROM date_dim\n      WHERE\n        d_moy = 5 AND d_year = 1998\n    )\n), my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM (\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_bill_customer_sk AS customer_sk,\n      cs_item_sk AS item_sk\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_bill_customer_sk AS customer_sk,\n      ws_item_sk AS item_sk\n    FROM web_sales\n  ) AS cs_or_ws_sales, item, customer, combined_date_dim\n  WHERE\n    sold_date_sk = base_date_sk\n    AND item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND i_class = 'maternity'\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n    AND NOT base_date_sk IS NULL\n), my_revenue AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_ext_sales_price) AS revenue\n  FROM my_customers, store_sales, customer_address, store, combined_date_dim\n  WHERE\n    c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN (\n      SELECT\n        MIN(lower_bound)\n      FROM combined_date_dim\n      WHERE\n        NOT lower_bound IS NULL\n    ) AND (\n      SELECT\n        MAX(upper_bound)\n      FROM combined_date_dim\n      WHERE\n        NOT upper_bound IS NULL\n    )\n  GROUP BY\n    c_customer_sk\n), segments AS (\n  SELECT\n    CAST((\n      revenue / 50\n    ) AS INT) AS segment\n  FROM my_revenue\n)\nSELECT\n  segment,\n  COUNT(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY\n  segment\nORDER BY\n  segment,\n  num_customers\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 29573,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1329,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 1.1329,
      "output_sql": "WITH my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM item, date_dim, (\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_bill_customer_sk AS customer_sk,\n      cs_item_sk AS item_sk\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_bill_customer_sk AS customer_sk,\n      ws_item_sk AS item_sk\n    FROM web_sales\n  ) AS cs_or_ws_sales, customer\n  WHERE\n    i_category = 'Women'\n    AND i_class = 'maternity'\n    AND d_moy = 5\n    AND d_year = 1998\n    AND item_sk = i_item_sk\n    AND sold_date_sk = d_date_sk\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n), my_revenue AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_ext_sales_price) AS revenue\n  FROM my_customers, date_dim, store_sales, customer_address, store\n  WHERE\n    c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN (\n      SELECT DISTINCT\n        d_month_seq + 1\n      FROM date_dim\n      WHERE\n        d_year = 1998 AND d_moy = 5\n    ) AND (\n      SELECT DISTINCT\n        d_month_seq + 3\n      FROM date_dim\n      WHERE\n        d_year = 1998 AND d_moy = 5\n    )\n  GROUP BY\n    c_customer_sk\n), segments AS (\n  SELECT\n    CAST((\n      revenue / 50\n    ) AS INT) AS segment\n  FROM my_revenue\n)\nSELECT\n  segment,\n  COUNT(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY\n  segment\nORDER BY\n  segment,\n  num_customers\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 71654,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1355,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 1.1355,
      "output_sql": "WITH my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM (\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_bill_customer_sk AS customer_sk,\n      cs_item_sk AS item_sk\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_bill_customer_sk AS customer_sk,\n      ws_item_sk AS item_sk\n    FROM web_sales\n  ) AS cs_or_ws_sales, item, date_dim, customer\n  WHERE\n    sold_date_sk = d_date_sk\n    AND item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND i_class = 'maternity'\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n    AND d_moy = 5\n    AND d_year = 1998\n    AND NOT c_current_addr_sk IS NULL\n), my_revenue AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_ext_sales_price) AS revenue\n  FROM my_customers, store_sales, customer_address, store, date_dim\n  WHERE\n    c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN (\n      SELECT DISTINCT\n        d_month_seq + 1\n      FROM date_dim\n      WHERE\n        d_year = 1998 AND d_moy = 5\n    ) AND (\n      SELECT DISTINCT\n        d_month_seq + 3\n      FROM date_dim\n      WHERE\n        d_year = 1998 AND d_moy = 5\n    )\n  GROUP BY\n    c_customer_sk\n), segments AS (\n  SELECT\n    CAST((\n      revenue / 50\n    ) AS INT) AS segment\n  FROM my_revenue\n)\nSELECT\n  segment,\n  COUNT(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY\n  segment\nORDER BY\n  segment,\n  num_customers\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 37628,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.7069,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 1.7069,
      "output_sql": "WITH my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM (\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_bill_customer_sk AS customer_sk,\n      cs_item_sk AS item_sk\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_bill_customer_sk AS customer_sk,\n      ws_item_sk AS item_sk\n    FROM web_sales\n  ) AS cs_or_ws_sales, item, date_dim, customer\n  WHERE\n    sold_date_sk = d_date_sk\n    AND item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND i_class = 'maternity'\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n    AND d_moy = 5\n    AND d_year = 1998\n), my_revenue AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_ext_sales_price) AS revenue\n  FROM my_customers, store_sales, customer_address, store, date_dim\n  CROSS JOIN (\n    SELECT\n      d_month_seq + 1 AS month_seq_start\n    FROM date_dim\n    WHERE\n      d_year = 1998 AND d_moy = 5\n    LIMIT 1\n  ) AS start_date\n  CROSS JOIN (\n    SELECT\n      d_month_seq + 3 AS month_seq_end\n    FROM date_dim\n    WHERE\n      d_year = 1998 AND d_moy = 5\n    LIMIT 1\n  ) AS end_date\n  WHERE\n    c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN month_seq_start AND month_seq_end\n  GROUP BY\n    c_customer_sk\n), segments AS (\n  SELECT\n    CAST((\n      revenue / 50\n    ) AS INT) AS segment\n  FROM my_revenue\n)\nSELECT\n  segment,\n  COUNT(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY\n  segment\nORDER BY\n  segment,\n  num_customers\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 26581,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2354,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 1.2354,
      "output_sql": "WITH base_month_seq AS (\n  SELECT DISTINCT\n    d_month_seq\n  FROM date_dim\n  WHERE\n    d_year = 1998 AND d_moy = 5\n), my_customers AS (\n  SELECT DISTINCT\n    c_customer_sk,\n    c_current_addr_sk\n  FROM (\n    SELECT\n      cs_sold_date_sk AS sold_date_sk,\n      cs_bill_customer_sk AS customer_sk,\n      cs_item_sk AS item_sk\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      ws_sold_date_sk AS sold_date_sk,\n      ws_bill_customer_sk AS customer_sk,\n      ws_item_sk AS item_sk\n    FROM web_sales\n  ) AS cs_or_ws_sales, item, date_dim, customer\n  WHERE\n    sold_date_sk = d_date_sk\n    AND item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND i_class = 'maternity'\n    AND c_customer_sk = cs_or_ws_sales.customer_sk\n    AND d_moy = 5\n    AND d_year = 1998\n), my_revenue AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_ext_sales_price) AS revenue\n  FROM my_customers, store_sales, customer_address, store, date_dim\n  WHERE\n    c_current_addr_sk = ca_address_sk\n    AND ca_county = s_county\n    AND ca_state = s_state\n    AND ss_sold_date_sk = d_date_sk\n    AND c_customer_sk = ss_customer_sk\n    AND d_month_seq BETWEEN (\n      SELECT\n        d_month_seq + 1\n      FROM base_month_seq\n    ) AND (\n      SELECT\n        d_month_seq + 3\n      FROM base_month_seq\n    )\n  GROUP BY\n    c_customer_sk\n), segments AS (\n  SELECT\n    CAST((\n      revenue / 50\n    ) AS INT) AS segment\n  FROM my_revenue\n)\nSELECT\n  segment,\n  COUNT(*) AS num_customers,\n  segment * 50 AS segment_base\nFROM segments\nGROUP BY\n  segment\nORDER BY\n  segment,\n  num_customers\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.9129,
          "visits": 1,
          "avg_reward": 1.8962,
          "is_valid": true,
          "speedup": 1.8962,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "date_cte_isolate"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9638,
          "visits": 2,
          "avg_reward": 0.9481,
          "is_valid": true,
          "speedup": 1.8962,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9674,
          "visits": 2,
          "avg_reward": 0.9481,
          "is_valid": true,
          "speedup": 1.8962,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.046,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9703,
          "visits": 2,
          "avg_reward": 0.9481,
          "is_valid": true,
          "speedup": 1.8962,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.046,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.973,
          "visits": 2,
          "avg_reward": 0.9481,
          "is_valid": true,
          "speedup": 1.8962,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7501,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2646,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.1738,
          "visits": 1,
          "avg_reward": 1.1329,
          "is_valid": true,
          "speedup": 1.1329,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.046,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9753,
          "visits": 2,
          "avg_reward": 0.9481,
          "is_valid": true,
          "speedup": 1.8962,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7501,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5657,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2652,
          "visits": 1,
          "avg_reward": 1.1329,
          "is_valid": true,
          "speedup": 1.1329,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.1796,
          "visits": 1,
          "avg_reward": 1.1355,
          "is_valid": true,
          "speedup": 1.1355,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.046,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9775,
          "visits": 2,
          "avg_reward": 0.9481,
          "is_valid": true,
          "speedup": 1.8962,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7501,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2744,
          "visits": 1,
          "avg_reward": 1.1329,
          "is_valid": true,
          "speedup": 1.1329,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.754,
          "visits": 1,
          "avg_reward": 1.7069,
          "is_valid": true,
          "speedup": 1.7069,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.1826,
          "visits": 1,
          "avg_reward": 1.1355,
          "is_valid": true,
          "speedup": 1.1355,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.046,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9795,
          "visits": 2,
          "avg_reward": 0.9481,
          "is_valid": true,
          "speedup": 1.8962,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7501,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 9,
    "avg_reward": 0.8674,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.9481,
        "is_valid": true,
        "speedup": 1.8962,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "date_cte_isolate",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.046,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.7501,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.1329,
        "is_valid": true,
        "speedup": 1.1329,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.1355,
        "is_valid": true,
        "speedup": 1.1355,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.7069,
        "is_valid": true,
        "speedup": 1.7069,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.2354,
        "is_valid": true,
        "speedup": 1.2354,
        "error": null
      }
    }
  }
}