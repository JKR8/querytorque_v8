{
  "stats": {
    "total_iterations": 20,
    "tree_size": 20,
    "successful_expansions": 19,
    "failed_expansions": 0,
    "validation_calls": 19,
    "llm_ranking_calls": 35,
    "root_visits": 20,
    "total_attempts": 19
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 39763,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year = 2000 AND d_qoy IN (1, 2, 3)\n), ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, filtered_dates AS fd, customer_address\n  WHERE\n    ss_sold_date_sk = fd.d_date_sk AND ss_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ws AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, filtered_dates AS fd, customer_address\n  WHERE\n    ws_sold_date_sk = fd.d_date_sk AND ws_bill_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 79710,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8159,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH combined AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(CASE WHEN source = 'store' THEN sales END) AS store_sales,\n    SUM(CASE WHEN source = 'web' THEN sales END) AS web_sales\n  FROM (\n    SELECT\n      ca_county,\n      d_qoy,\n      d_year,\n      'store' AS source,\n      ss_ext_sales_price AS sales\n    FROM store_sales, date_dim, customer_address\n    WHERE\n      ss_sold_date_sk = d_date_sk\n      AND ss_addr_sk = ca_address_sk\n      AND d_year = 2000\n      AND d_qoy IN (1, 2, 3)\n    UNION ALL\n    SELECT\n      ca_county,\n      d_qoy,\n      d_year,\n      'web' AS source,\n      ws_ext_sales_price AS sales\n    FROM web_sales, date_dim, customer_address\n    WHERE\n      ws_sold_date_sk = d_date_sk\n      AND ws_bill_addr_sk = ca_address_sk\n      AND d_year = 2000\n      AND d_qoy IN (1, 2, 3)\n  ) AS combined_sales\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  q1.ca_county,\n  q1.d_year,\n  q2.web_sales / NULLIF(q1.web_sales, 0) AS web_q1_q2_increase,\n  q2.store_sales / NULLIF(q1.store_sales, 0) AS store_q1_q2_increase,\n  q3.web_sales / NULLIF(q2.web_sales, 0) AS web_q2_q3_increase,\n  q3.store_sales / NULLIF(q2.store_sales, 0) AS store_q2_q3_increase\nFROM combined AS q1\nJOIN combined AS q2\n  ON q1.ca_county = q2.ca_county AND q1.d_year = q2.d_year\nJOIN combined AS q3\n  ON q1.ca_county = q3.ca_county AND q1.d_year = q3.d_year\nWHERE\n  q1.d_qoy = 1\n  AND q2.d_qoy = 2\n  AND q3.d_qoy = 3\n  AND q1.d_year = 2000\n  AND q2.d_year = 2000\n  AND q3.d_year = 2000\n  AND (\n    q2.web_sales / NULLIF(q1.web_sales, 0)\n  ) > (\n    q2.store_sales / NULLIF(q1.store_sales, 0)\n  )\n  AND (\n    q3.web_sales / NULLIF(q2.web_sales, 0)\n  ) > (\n    q3.store_sales / NULLIF(q2.store_sales, 0)\n  )\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 25038,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.948,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.2,
      "output_sql": "WITH ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, date_dim, customer_address\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_addr_sk = ca_address_sk\n    AND d_qoy IN (1, 2, 3)\n    AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ws AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk\n    AND ws_bill_addr_sk = ca_address_sk\n    AND d_qoy IN (1, 2, 3)\n    AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 23609,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0712,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.5,
      "output_sql": "WITH ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM date_dim, customer_address, store_sales\n  WHERE\n    ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ws AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM date_dim, customer_address, web_sales\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 37860,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "WITH ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, date_dim, customer_address\n  WHERE\n    ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ws AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ss_q1_2000 AS (\n  SELECT\n    ca_county,\n    store_sales\n  FROM ss\n  WHERE\n    d_qoy = 1 AND d_year = 2000\n), ss_q2_2000 AS (\n  SELECT\n    ca_county,\n    store_sales\n  FROM ss\n  WHERE\n    d_qoy = 2 AND d_year = 2000\n), ss_q3_2000 AS (\n  SELECT\n    ca_county,\n    store_sales\n  FROM ss\n  WHERE\n    d_qoy = 3 AND d_year = 2000\n), ws_q1_2000 AS (\n  SELECT\n    ca_county,\n    web_sales\n  FROM ws\n  WHERE\n    d_qoy = 1 AND d_year = 2000\n), ws_q2_2000 AS (\n  SELECT\n    ca_county,\n    web_sales\n  FROM ws\n  WHERE\n    d_qoy = 2 AND d_year = 2000\n), ws_q3_2000 AS (\n  SELECT\n    ca_county,\n    web_sales\n  FROM ws\n  WHERE\n    d_qoy = 3 AND d_year = 2000\n)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss_q1_2000 AS ss1, ss_q2_2000 AS ss2, ss_q3_2000 AS ss3, ws_q1_2000 AS ws1, ws_q2_2000 AS ws2, ws_q3_2000 AS ws3\nWHERE\n  ss1.ca_county = ss2.ca_county\n  AND ss2.ca_county = ss3.ca_county\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.ca_county = ws2.ca_county\n  AND ws1.ca_county = ws3.ca_county\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 65213,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8283,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.2,
      "output_sql": "WITH ss_q1 AS (\n  SELECT\n    ca_county,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, date_dim, customer_address\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_addr_sk = ca_address_sk\n    AND d_qoy = 1\n    AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_year\n), ss_q2 AS (\n  SELECT\n    ca_county,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, date_dim, customer_address\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_addr_sk = ca_address_sk\n    AND d_qoy = 2\n    AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_year\n), ss_q3 AS (\n  SELECT\n    ca_county,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, date_dim, customer_address\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_addr_sk = ca_address_sk\n    AND d_qoy = 3\n    AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_year\n), ws_q1 AS (\n  SELECT\n    ca_county,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk\n    AND ws_bill_addr_sk = ca_address_sk\n    AND d_qoy = 1\n    AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_year\n), ws_q2 AS (\n  SELECT\n    ca_county,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk\n    AND ws_bill_addr_sk = ca_address_sk\n    AND d_qoy = 2\n    AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_year\n), ws_q3 AS (\n  SELECT\n    ca_county,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk\n    AND ws_bill_addr_sk = ca_address_sk\n    AND d_qoy = 3\n    AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_year\n), combined_ss AS (\n  SELECT\n    ca_county,\n    d_year,\n    1 AS quarter,\n    store_sales\n  FROM ss_q1\n  UNION ALL\n  SELECT\n    ca_county,\n    d_year,\n    2 AS quarter,\n    store_sales\n  FROM ss_q2\n  UNION ALL\n  SELECT\n    ca_county,\n    d_year,\n    3 AS quarter,\n    store_sales\n  FROM ss_q3\n), combined_ws AS (\n  SELECT\n    ca_county,\n    d_year,\n    1 AS quarter,\n    web_sales\n  FROM ws_q1\n  UNION ALL\n  SELECT\n    ca_county,\n    d_year,\n    2 AS quarter,\n    web_sales\n  FROM ws_q2\n  UNION ALL\n  SELECT\n    ca_county,\n    d_year,\n    3 AS quarter,\n    web_sales\n  FROM ws_q3\n)\nSELECT\n  s1.ca_county,\n  s1.d_year,\n  w2.web_sales / NULLIF(w1.web_sales, 0) AS web_q1_q2_increase,\n  s2.store_sales / NULLIF(s1.store_sales, 0) AS store_q1_q2_increase,\n  w3.web_sales / NULLIF(w2.web_sales, 0) AS web_q2_q3_increase,\n  s3.store_sales / NULLIF(s2.store_sales, 0) AS store_q2_q3_increase\nFROM combined_ss AS s1\nJOIN combined_ss AS s2\n  ON s1.ca_county = s2.ca_county\n  AND s1.d_year = s2.d_year\n  AND s1.quarter = 1\n  AND s2.quarter = 2\nJOIN combined_ss AS s3\n  ON s2.ca_county = s3.ca_county AND s2.d_year = s3.d_year AND s3.quarter = 3\nJOIN combined_ws AS w1\n  ON s1.ca_county = w1.ca_county AND s1.d_year = w1.d_year AND w1.quarter = 1\nJOIN combined_ws AS w2\n  ON w1.ca_county = w2.ca_county AND w1.d_year = w2.d_year AND w2.quarter = 2\nJOIN combined_ws AS w3\n  ON w1.ca_county = w3.ca_county AND w1.d_year = w3.d_year AND w3.quarter = 3\nWHERE\n  w2.web_sales / NULLIF(w1.web_sales, 0) > s2.store_sales / NULLIF(s1.store_sales, 0)\n  AND w3.web_sales / NULLIF(w2.web_sales, 0) > s3.store_sales / NULLIF(s2.store_sales, 0)\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 54966,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9141,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.2,
      "output_sql": "with ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       inner join ss ss2 on ss1.ca_county = ss2.ca_county\n       inner join ss ss3 on ss2.ca_county = ss3.ca_county\n       inner join ws ws1 on ss1.ca_county = ws1.ca_county\n       inner join ws ws2 on ws1.ca_county = ws2.ca_county\n       inner join ws ws3 on ws1.ca_county = ws3.ca_county\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 2000\n    and ss2.d_qoy = 2\n    and ss2.d_year = 2000\n    and ss3.d_qoy = 3\n    and ss3.d_year = 2000\n    and ws1.d_qoy = 1\n    and ws1.d_year = 2000\n    and ws2.d_qoy = 2\n    and ws2.d_year = 2000\n    and ws3.d_qoy = 3\n    and ws3.d_year =2000\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by web_q1_q2_increase"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 28247,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0387,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.5,
      "output_sql": "WITH ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, date_dim, customer_address\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_addr_sk = ca_address_sk\n    AND d_year = 2000\n    AND d_qoy IN (1, 2, 3)\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ws AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk\n    AND ws_bill_addr_sk = ca_address_sk\n    AND d_year = 2000\n    AND d_qoy IN (1, 2, 3)\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 38766,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9436,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.2,
      "output_sql": "WITH ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, date_dim, customer_address\n  WHERE\n    ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss AS ss1, ss AS ss2, ss AS ss3, (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n) AS ws1, (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n) AS ws2, (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n) AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 58198,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9456,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.2,
      "output_sql": "WITH ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, date_dim, customer_address\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_addr_sk = ca_address_sk\n    AND d_year = 2000\n    AND d_qoy IN (1, 2, 3)\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ws AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk\n    AND ws_bill_addr_sk = ca_address_sk\n    AND d_year = 2000\n    AND d_qoy IN (1, 2, 3)\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), quarter_ratios AS (\n  SELECT\n    s1.ca_county,\n    s1.d_year,\n    CASE WHEN s1.store_sales > 0 THEN s2.store_sales / s1.store_sales ELSE NULL END AS store_q1_q2_increase,\n    CASE WHEN s2.store_sales > 0 THEN s3.store_sales / s2.store_sales ELSE NULL END AS store_q2_q3_increase,\n    CASE WHEN w1.web_sales > 0 THEN w2.web_sales / w1.web_sales ELSE NULL END AS web_q1_q2_increase,\n    CASE WHEN w2.web_sales > 0 THEN w3.web_sales / w2.web_sales ELSE NULL END AS web_q2_q3_increase\n  FROM (\n    SELECT\n      *\n    FROM ss\n    WHERE\n      d_qoy = 1\n  ) AS s1\n  JOIN (\n    SELECT\n      *\n    FROM ss\n    WHERE\n      d_qoy = 2\n  ) AS s2\n    ON s1.ca_county = s2.ca_county AND s1.d_year = s2.d_year\n  JOIN (\n    SELECT\n      *\n    FROM ss\n    WHERE\n      d_qoy = 3\n  ) AS s3\n    ON s1.ca_county = s3.ca_county AND s1.d_year = s3.d_year\n  JOIN (\n    SELECT\n      *\n    FROM ws\n    WHERE\n      d_qoy = 1\n  ) AS w1\n    ON s1.ca_county = w1.ca_county AND s1.d_year = w1.d_year\n  JOIN (\n    SELECT\n      *\n    FROM ws\n    WHERE\n      d_qoy = 2\n  ) AS w2\n    ON s1.ca_county = w2.ca_county AND s1.d_year = w2.d_year\n  JOIN (\n    SELECT\n      *\n    FROM ws\n    WHERE\n      d_qoy = 3\n  ) AS w3\n    ON s1.ca_county = w3.ca_county AND s1.d_year = w3.d_year\n)\nSELECT\n  ca_county,\n  d_year,\n  web_q1_q2_increase,\n  store_q1_q2_increase,\n  web_q2_q3_increase,\n  store_q2_q3_increase\nFROM quarter_ratios\nWHERE\n  web_q1_q2_increase > store_q1_q2_increase\n  AND web_q2_q3_increase > store_q2_q3_increase\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 59402,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.0,
      "output_sql": "SELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 12,
      "parent_path": [
        "reorder_join"
      ],
      "transform_id": "push_pred",
      "duration_ms": 23022,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1977,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1977,
      "output_sql": "WITH ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM date_dim, customer_address, store_sales\n  WHERE\n    ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ws AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM date_dim, customer_address, web_sales\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 13,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 122187,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0958,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "WITH combined AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(CASE WHEN source = 'store' THEN sales END) AS store_sales,\n    SUM(CASE WHEN source = 'web' THEN sales END) AS web_sales\n  FROM (\n    SELECT\n      ca_county,\n      d_qoy,\n      d_year,\n      'store' AS source,\n      ss_ext_sales_price AS sales\n    FROM store_sales, date_dim, customer_address\n    WHERE\n      ss_sold_date_sk = d_date_sk\n      AND ss_addr_sk = ca_address_sk\n      AND d_year = 2000\n      AND d_qoy IN (1, 2, 3)\n    UNION ALL\n    SELECT\n      ca_county,\n      d_qoy,\n      d_year,\n      'web' AS source,\n      ws_ext_sales_price AS sales\n    FROM web_sales, date_dim, customer_address\n    WHERE\n      ws_sold_date_sk = d_date_sk\n      AND ws_bill_addr_sk = ca_address_sk\n      AND d_year = 2000\n      AND d_qoy IN (1, 2, 3)\n  ) AS combined_sales\n  WHERE\n    d_qoy IN (1, 2, 3) AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  q1.ca_county,\n  q1.d_year,\n  q2.web_sales / NULLIF(q1.web_sales, 0) AS web_q1_q2_increase,\n  q2.store_sales / NULLIF(q1.store_sales, 0) AS store_q1_q2_increase,\n  q3.web_sales / NULLIF(q2.web_sales, 0) AS web_q2_q3_increase,\n  q3.store_sales / NULLIF(q2.store_sales, 0) AS store_q2_q3_increase\nFROM combined AS q1\nJOIN combined AS q2\n  ON q1.ca_county = q2.ca_county AND q1.d_year = q2.d_year\nJOIN combined AS q3\n  ON q1.ca_county = q3.ca_county AND q1.d_year = q3.d_year\nWHERE\n  q1.d_qoy = 1\n  AND q2.d_qoy = 2\n  AND q3.d_qoy = 3\n  AND q1.d_year = 2000\n  AND q2.d_year = 2000\n  AND q3.d_year = 2000\n  AND (\n    q2.web_sales / NULLIF(q1.web_sales, 0)\n  ) > (\n    q2.store_sales / NULLIF(q1.store_sales, 0)\n  )\n  AND (\n    q3.web_sales / NULLIF(q2.web_sales, 0)\n  ) > (\n    q3.store_sales / NULLIF(q2.store_sales, 0)\n  )\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 14,
      "parent_path": [
        "reorder_join",
        "push_pred"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 38715,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH combined AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(CASE WHEN NOT ss.ss_ext_sales_price IS NULL THEN ss_ext_sales_price ELSE 0 END) AS store_sales,\n    SUM(CASE WHEN NOT ws.ws_ext_sales_price IS NULL THEN ws_ext_sales_price ELSE 0 END) AS web_sales\n  FROM date_dim\n  JOIN customer_address\n    ON 1 = 1\n  LEFT JOIN store_sales\n    ON ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk\n  LEFT JOIN web_sales\n    ON ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk\n  WHERE\n    d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  c1.ca_county,\n  c1.d_year,\n  c2.web_sales / NULLIF(c1.web_sales, 0) AS web_q1_q2_increase,\n  c2.store_sales / NULLIF(c1.store_sales, 0) AS store_q1_q2_increase,\n  c3.web_sales / NULLIF(c2.web_sales, 0) AS web_q2_q3_increase,\n  c3.store_sales / NULLIF(c2.store_sales, 0) AS store_q2_q3_increase\nFROM combined AS c1, combined AS c2, combined AS c3\nWHERE\n  c1.d_qoy = 1\n  AND c1.d_year = 2000\n  AND c1.ca_county = c2.ca_county\n  AND c2.d_qoy = 2\n  AND c2.d_year = 2000\n  AND c2.ca_county = c3.ca_county\n  AND c3.d_qoy = 3\n  AND c3.d_year = 2000\n  AND CASE WHEN c1.web_sales > 0 THEN c2.web_sales / c1.web_sales ELSE NULL END > CASE WHEN c1.store_sales > 0 THEN c2.store_sales / c1.store_sales ELSE NULL END\n  AND CASE WHEN c2.web_sales > 0 THEN c3.web_sales / c2.web_sales ELSE NULL END > CASE WHEN c2.store_sales > 0 THEN c3.store_sales / c2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 15,
      "parent_path": [
        "multi_push_pred"
      ],
      "transform_id": "push_pred",
      "duration_ms": 116751,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.846,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM store_sales, date_dim, customer_address\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_addr_sk = ca_address_sk\n    AND d_year = 2000\n    AND d_qoy IN (1, 2, 3)\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ws AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM web_sales, date_dim, customer_address\n  WHERE\n    ws_sold_date_sk = d_date_sk\n    AND ws_bill_addr_sk = ca_address_sk\n    AND d_year = 2000\n    AND d_qoy IN (1, 2, 3)\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 16,
      "parent_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 20857,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1273,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1273,
      "output_sql": "WITH combined AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(CASE WHEN source = 'store' THEN sales END) AS store_sales,\n    SUM(CASE WHEN source = 'web' THEN sales END) AS web_sales\n  FROM (\n    SELECT\n      ca_county,\n      d_qoy,\n      d_year,\n      'store' AS source,\n      ss_ext_sales_price AS sales\n    FROM store_sales, date_dim, customer_address\n    WHERE\n      ss_sold_date_sk = d_date_sk\n      AND ss_addr_sk = ca_address_sk\n      AND d_year = 2000\n      AND d_qoy IN (1, 2, 3)\n    UNION ALL\n    SELECT\n      ca_county,\n      d_qoy,\n      d_year,\n      'web' AS source,\n      ws_ext_sales_price AS sales\n    FROM web_sales, date_dim, customer_address\n    WHERE\n      ws_sold_date_sk = d_date_sk\n      AND ws_bill_addr_sk = ca_address_sk\n      AND d_year = 2000\n      AND d_qoy IN (1, 2, 3)\n  ) AS combined_sales\n  WHERE\n    d_qoy IN (1, 2, 3) AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  q1.ca_county,\n  q1.d_year,\n  q2.web_sales / NULLIF(q1.web_sales, 0) AS web_q1_q2_increase,\n  q2.store_sales / NULLIF(q1.store_sales, 0) AS store_q1_q2_increase,\n  q3.web_sales / NULLIF(q2.web_sales, 0) AS web_q2_q3_increase,\n  q3.store_sales / NULLIF(q2.store_sales, 0) AS store_q2_q3_increase\nFROM combined AS q1\nJOIN combined AS q2\n  ON q1.ca_county = q2.ca_county AND q1.d_year = q2.d_year\nJOIN combined AS q3\n  ON q1.ca_county = q3.ca_county AND q1.d_year = q3.d_year\nWHERE\n  q1.d_qoy = 1\n  AND q2.d_qoy = 2\n  AND q3.d_qoy = 3\n  AND q1.d_year = 2000\n  AND q2.d_year = 2000\n  AND q3.d_year = 2000\n  AND (\n    q2.web_sales / NULLIF(q1.web_sales, 0)\n  ) > (\n    q2.store_sales / NULLIF(q1.store_sales, 0)\n  )\n  AND (\n    q3.web_sales / NULLIF(q2.web_sales, 0)\n  ) > (\n    q3.store_sales / NULLIF(q2.store_sales, 0)\n  )\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 18,
      "parent_path": [
        "reorder_join",
        "push_pred"
      ],
      "transform_id": "materialize_cte",
      "duration_ms": 56528,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9971,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.2,
      "output_sql": "WITH ss AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM date_dim, customer_address, store_sales\n  WHERE\n    ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n), ws AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM date_dim, customer_address, web_sales\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 19,
      "parent_path": [
        "reorder_join",
        "push_pred"
      ],
      "transform_id": "inline_cte",
      "duration_ms": 68048,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7089,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.2,
      "output_sql": "SELECT\n  ss1.ca_county,\n  ss1.d_year,\n  ws2.web_sales / ws1.web_sales AS web_q1_q2_increase,\n  ss2.store_sales / ss1.store_sales AS store_q1_q2_increase,\n  ws3.web_sales / ws2.web_sales AS web_q2_q3_increase,\n  ss3.store_sales / ss2.store_sales AS store_q2_q3_increase\nFROM (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM date_dim, customer_address, store_sales\n  WHERE\n    ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n) AS ss1,\n(\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM date_dim, customer_address, store_sales\n  WHERE\n    ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n) AS ss2,\n(\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ss_ext_sales_price) AS store_sales\n  FROM date_dim, customer_address, store_sales\n  WHERE\n    ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n) AS ss3,\n(\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM date_dim, customer_address, web_sales\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n) AS ws1,\n(\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM date_dim, customer_address, web_sales\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n) AS ws2,\n(\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(ws_ext_sales_price) AS web_sales\n  FROM date_dim, customer_address, web_sales\n  WHERE\n    ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_year = 2000\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n) AS ws3\nWHERE\n  ss1.d_qoy = 1\n  AND ss1.d_year = 2000\n  AND ss1.ca_county = ss2.ca_county\n  AND ss2.d_qoy = 2\n  AND ss2.d_year = 2000\n  AND ss2.ca_county = ss3.ca_county\n  AND ss3.d_qoy = 3\n  AND ss3.d_year = 2000\n  AND ss1.ca_county = ws1.ca_county\n  AND ws1.d_qoy = 1\n  AND ws1.d_year = 2000\n  AND ws1.ca_county = ws2.ca_county\n  AND ws2.d_qoy = 2\n  AND ws2.d_year = 2000\n  AND ws1.ca_county = ws3.ca_county\n  AND ws3.d_qoy = 3\n  AND ws3.d_year = 2000\n  AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END\n  AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END\nORDER BY\n  web_q1_q2_increase"
    },
    {
      "iteration": 20,
      "parent_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "transform_id": "remove_redundant",
      "duration_ms": 40183,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.5383,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 1.5383,
      "output_sql": "WITH combined AS (\n  SELECT\n    ca_county,\n    d_qoy,\n    d_year,\n    SUM(CASE WHEN source = 'store' THEN sales END) AS store_sales,\n    SUM(CASE WHEN source = 'web' THEN sales END) AS web_sales\n  FROM (\n    SELECT\n      ca_county,\n      d_qoy,\n      d_year,\n      'store' AS source,\n      ss_ext_sales_price AS sales\n    FROM store_sales, date_dim, customer_address\n    WHERE\n      ss_sold_date_sk = d_date_sk\n      AND ss_addr_sk = ca_address_sk\n      AND d_year = 2000\n      AND d_qoy IN (1, 2, 3)\n    UNION ALL\n    SELECT\n      ca_county,\n      d_qoy,\n      d_year,\n      'web' AS source,\n      ws_ext_sales_price AS sales\n    FROM web_sales, date_dim, customer_address\n    WHERE\n      ws_sold_date_sk = d_date_sk\n      AND ws_bill_addr_sk = ca_address_sk\n      AND d_year = 2000\n      AND d_qoy IN (1, 2, 3)\n  ) AS combined_sales\n  GROUP BY\n    ca_county,\n    d_qoy,\n    d_year\n)\nSELECT\n  q1.ca_county,\n  q1.d_year,\n  q2.web_sales / NULLIF(q1.web_sales, 0) AS web_q1_q2_increase,\n  q2.store_sales / NULLIF(q1.store_sales, 0) AS store_q1_q2_increase,\n  q3.web_sales / NULLIF(q2.web_sales, 0) AS web_q2_q3_increase,\n  q3.store_sales / NULLIF(q2.store_sales, 0) AS store_q2_q3_increase\nFROM combined AS q1\nJOIN combined AS q2\n  ON q1.ca_county = q2.ca_county AND q1.d_year = q2.d_year\nJOIN combined AS q3\n  ON q1.ca_county = q3.ca_county AND q1.d_year = q3.d_year\nWHERE\n  q1.d_qoy = 1\n  AND q2.d_qoy = 2\n  AND q3.d_qoy = 3\n  AND (\n    q2.web_sales / NULLIF(q1.web_sales, 0)\n  ) > (\n    q2.store_sales / NULLIF(q1.store_sales, 0)\n  )\n  AND (\n    q3.web_sales / NULLIF(q2.web_sales, 0)\n  ) > (\n    q3.store_sales / NULLIF(q2.store_sales, 0)\n  )\nORDER BY\n  web_q1_q2_increase"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0167,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2866,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0712,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0712,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4449,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6225,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0712,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6323,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0712,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6243,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7828,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0712,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0387,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0712,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.15,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0387,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9906,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9743,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0712,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3162,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3581,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0387,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0712
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0387
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.866,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.4124,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8159
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5464,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9643,
          "visits": 2,
          "avg_reward": 0.8489,
          "is_valid": true,
          "speedup": 1.0712
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5196,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2577,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2577,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5577,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0387
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2577,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2577,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0577,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.5685,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 0.8159
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.0674,
          "visits": 2,
          "avg_reward": 0.8489,
          "is_valid": true,
          "speedup": 1.0712
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0387
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.3392,
          "visits": 1,
          "avg_reward": 1.1977,
          "is_valid": true,
          "speedup": 1.1977,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "reorder_join",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.5768,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 0.8159
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.736,
          "visits": 3,
          "avg_reward": 0.5659,
          "is_valid": true,
          "speedup": 1.0712
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0387
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "multi_push_pred"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0645,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2537,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 0.8159
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5873,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8564,
          "visits": 3,
          "avg_reward": 0.5659,
          "is_valid": true,
          "speedup": 1.0712
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.9682,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2645,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2645,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.393,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0387
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3936,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2645,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0645,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0958,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7909,
          "visits": 3,
          "avg_reward": 0.6091,
          "is_valid": true,
          "speedup": 0.8159
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7477,
          "visits": 3,
          "avg_reward": 0.5659,
          "is_valid": true,
          "speedup": 1.0712
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5924,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0387
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9291,
          "visits": 2,
          "avg_reward": 0.8136,
          "is_valid": true,
          "speedup": 1.0958,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2844,
          "visits": 1,
          "avg_reward": 1.1273,
          "is_valid": true,
          "speedup": 1.1273,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred",
        "reorder_join"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6067,
          "visits": 4,
          "avg_reward": 0.4568,
          "is_valid": true,
          "speedup": 0.8159
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7533,
          "visits": 3,
          "avg_reward": 0.5659,
          "is_valid": true,
          "speedup": 1.0712
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5999,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0387
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7143,
          "visits": 2,
          "avg_reward": 0.5989,
          "is_valid": true,
          "speedup": 1.1977,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "reorder_join",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1571,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6111,
          "visits": 4,
          "avg_reward": 0.4568,
          "is_valid": true,
          "speedup": 0.8159
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6287,
          "visits": 4,
          "avg_reward": 0.4744,
          "is_valid": true,
          "speedup": 1.0712
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.6071,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0387
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5659,
          "visits": 3,
          "avg_reward": 0.4659,
          "is_valid": true,
          "speedup": 1.1977,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "reorder_join",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3925,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9971,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1925,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6153,
          "visits": 4,
          "avg_reward": 0.4568,
          "is_valid": true,
          "speedup": 0.8159
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.948
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5516,
          "visits": 5,
          "avg_reward": 0.4195,
          "is_valid": true,
          "speedup": 1.0712
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8283
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9141
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.6142,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0387
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9436
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9456
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6424,
          "visits": 3,
          "avg_reward": 0.5424,
          "is_valid": true,
          "speedup": 1.0958,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7368,
          "visits": 2,
          "avg_reward": 0.5636,
          "is_valid": true,
          "speedup": 1.1273,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 20,
    "avg_reward": 0.3582,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 5,
        "avg_reward": 0.6731,
        "is_valid": true,
        "speedup": 0.8159,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "consolidate_scans",
              "push_pred"
            ],
            "depth": 2,
            "visits": 4,
            "avg_reward": 0.7914,
            "is_valid": true,
            "speedup": 1.0958,
            "error": null,
            "children": {
              "reorder_join": {
                "transforms": [
                  "consolidate_scans",
                  "push_pred",
                  "reorder_join"
                ],
                "depth": 3,
                "visits": 2,
                "avg_reward": 0.5636,
                "is_valid": true,
                "speedup": 1.1273,
                "error": null
              },
              "remove_redundant": {
                "transforms": [
                  "consolidate_scans",
                  "push_pred",
                  "remove_redundant"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 1.5383,
                "is_valid": true,
                "speedup": 1.5383,
                "error": null
              }
            }
          }
        }
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.948,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 5,
        "avg_reward": 0.4195,
        "is_valid": true,
        "speedup": 1.0712,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "reorder_join",
              "push_pred"
            ],
            "depth": 2,
            "visits": 4,
            "avg_reward": 0.3994,
            "is_valid": true,
            "speedup": 1.1977,
            "error": null,
            "children": {
              "consolidate_scans": {
                "transforms": [
                  "reorder_join",
                  "push_pred",
                  "consolidate_scans"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.0,
                "is_valid": false,
                "speedup": 0,
                "error": null
              },
              "materialize_cte": {
                "transforms": [
                  "reorder_join",
                  "push_pred",
                  "materialize_cte"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.9971,
                "error": null
              },
              "inline_cte": {
                "transforms": [
                  "reorder_join",
                  "push_pred",
                  "inline_cte"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.7089,
                "error": null
              }
            }
          }
        }
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.8283,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9141,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.35,
        "is_valid": true,
        "speedup": 1.0387,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "multi_push_pred",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.846,
            "error": null
          }
        }
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9436,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9456,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      }
    }
  }
}