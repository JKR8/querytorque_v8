{
  "stats": {
    "total_iterations": 20,
    "tree_size": 18,
    "successful_expansions": 17,
    "failed_expansions": 0,
    "validation_calls": 17,
    "llm_ranking_calls": 35,
    "root_visits": 20,
    "total_attempts": 17
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 43671,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates_wide AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year IN (2000, 2001, 2002, 2003)\n), filtered_dates_may_2000 AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year = 2000 AND d_moy = 5\n), frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    i_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM store_sales, filtered_dates_wide, item\n  WHERE\n    ss_sold_date_sk = d_date_sk AND ss_item_sk = i_item_sk\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    i_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, filtered_dates_wide\n    WHERE\n      ss_customer_sk = c_customer_sk AND ss_sold_date_sk = d_date_sk\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM store_sales, customer\n  WHERE\n    ss_customer_sk = c_customer_sk\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        *\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, filtered_dates_may_2000\n  WHERE\n    cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, filtered_dates_may_2000\n  WHERE\n    ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 23527,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1892,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1892,
      "output_sql": "WITH frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    i_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, item\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    i_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, date_dim\n    WHERE\n      ss_customer_sk = c_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM store_sales, customer, date_dim\n  WHERE\n    ss_customer_sk = c_customer_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        *\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "flatten_subq",
      "duration_ms": 20037,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0346,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "WITH frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    i_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, item\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    i_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, date_dim\n    WHERE\n      ss_customer_sk = c_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM store_sales, customer, date_dim\n  WHERE\n    ss_customer_sk = c_customer_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        *\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 42764,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.0,
      "output_sql": "WITH frequent_ss_items AS (\n  SELECT\n    *\n  FROM frequent_ss_items_2000\n  UNION ALL\n  SELECT\n    *\n  FROM frequent_ss_items_2001\n  UNION ALL\n  SELECT\n    *\n  FROM frequent_ss_items_2002\n  UNION ALL\n  SELECT\n    *\n  FROM frequent_ss_items_2003\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, date_dim\n    WHERE\n      ss_customer_sk = c_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM store_sales, customer\n  WHERE\n    ss_customer_sk = c_customer_sk\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        *\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 37310,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0276,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.5,
      "output_sql": "WITH frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    i_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM date_dim, item, store_sales\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    i_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, date_dim\n    WHERE\n      ss_customer_sk = c_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM customer, store_sales\n  WHERE\n    ss_customer_sk = c_customer_sk\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        *\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 59279,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1472,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 1.1472,
      "output_sql": "WITH combined_store_sales AS (\n  SELECT\n    ss_item_sk,\n    ss_customer_sk,\n    d_date,\n    d_year,\n    i_item_desc,\n    ss_quantity,\n    ss_sales_price,\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN 1 ELSE 0 END AS is_frequent_period,\n    CASE\n      WHEN d_year IN (2000, 2001, 2002, 2003)\n      THEN ss_quantity * ss_sales_price\n      ELSE 0\n    END AS csales_value,\n    ss_quantity * ss_sales_price AS ssales_value\n  FROM store_sales\n  LEFT JOIN date_dim\n    ON ss_sold_date_sk = d_date_sk\n  LEFT JOIN item\n    ON ss_item_sk = i_item_sk\n  LEFT JOIN customer\n    ON ss_customer_sk = c_customer_sk\n  WHERE\n    d_year IN (2000, 2001, 2002, 2003) OR d_year IS NULL\n), frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    ss_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM combined_store_sales\n  WHERE\n    is_frequent_period = 1\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    ss_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), customer_sales AS (\n  SELECT\n    ss_customer_sk,\n    SUM(csales_value) AS csales,\n    SUM(ssales_value) AS ssales\n  FROM combined_store_sales\n  GROUP BY\n    ss_customer_sk\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM customer_sales\n), best_ss_customer AS (\n  SELECT\n    ss_customer_sk AS c_customer_sk,\n    ssales\n  FROM customer_sales\n  WHERE\n    ssales > (\n      95 / 100.0\n    ) * (\n      SELECT\n        tpcds_cmax\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 35199,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9793,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.2,
      "output_sql": "WITH frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    i_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, item\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    i_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, date_dim\n    WHERE\n      ss_customer_sk = c_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM store_sales, customer\n  WHERE\n    ss_customer_sk = c_customer_sk\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        *\n      FROM max_store_sales\n    )\n), frequent_item_sk AS (\n  SELECT\n    item_sk\n  FROM frequent_ss_items\n), best_customer_sk AS (\n  SELECT\n    c_customer_sk\n  FROM best_ss_customer\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_item_sk\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_customer_sk\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_item_sk\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_customer_sk\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 35209,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2213,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 1.2213,
      "output_sql": "WITH frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    i_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, item\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    i_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, date_dim\n    WHERE\n      ss_customer_sk = c_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM store_sales, customer\n  WHERE\n    ss_customer_sk = c_customer_sk\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        tpcds_cmax\n      FROM max_store_sales\n    )\n), precomputed_frequent_items AS (\n  SELECT DISTINCT\n    item_sk\n  FROM frequent_ss_items\n), precomputed_best_customers AS (\n  SELECT DISTINCT\n    c_customer_sk\n  FROM best_ss_customer\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM precomputed_frequent_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM precomputed_best_customers\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM precomputed_frequent_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM precomputed_best_customers\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 45759,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.0,
      "output_sql": "WITH frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    i_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, item\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    AND i_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    ) /* Pushed predicate */\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    i_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, date_dim\n    WHERE\n      ss_customer_sk = c_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM store_sales, customer\n  WHERE\n    ss_customer_sk = c_customer_sk\n    AND c_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    ) /* Pushed predicate */\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        *\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 127834,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1181,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 1.1181,
      "output_sql": "WITH frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    i_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, item\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    i_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, date_dim\n    WHERE\n      ss_customer_sk = c_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM store_sales, customer\n  WHERE\n    ss_customer_sk = c_customer_sk\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        *\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 33119,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8426,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.2,
      "output_sql": "WITH frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    i_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, item\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n    AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    i_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM (\n    SELECT\n      c_customer_sk,\n      SUM(ss_quantity * ss_sales_price) AS csales\n    FROM store_sales, customer, date_dim\n    WHERE\n      ss_customer_sk = c_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3)\n    GROUP BY\n      c_customer_sk\n  )\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS ssales\n  FROM store_sales, customer\n  WHERE\n    ss_customer_sk = c_customer_sk\n  GROUP BY\n    c_customer_sk\n  HAVING\n    SUM(ss_quantity * ss_sales_price) > (\n      95 / 100.0\n    ) * (\n      SELECT\n        *\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "materialize_cte",
      "duration_ms": 37545,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 2.4523,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 2.4523,
      "output_sql": "WITH combined_store_sales AS (\n  SELECT\n    ss_item_sk,\n    ss_customer_sk,\n    d_date,\n    d_year,\n    i_item_desc,\n    ss_quantity,\n    ss_sales_price,\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN 1 ELSE 0 END AS is_frequent_period,\n    CASE\n      WHEN d_year IN (2000, 2001, 2002, 2003)\n      THEN ss_quantity * ss_sales_price\n      ELSE 0\n    END AS csales_value,\n    ss_quantity * ss_sales_price AS ssales_value\n  FROM store_sales\n  LEFT JOIN date_dim\n    ON ss_sold_date_sk = d_date_sk\n  LEFT JOIN item\n    ON ss_item_sk = i_item_sk\n  LEFT JOIN customer\n    ON ss_customer_sk = c_customer_sk\n  WHERE\n    d_year IN (2000, 2001, 2002, 2003) OR d_year IS NULL\n), frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    ss_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM combined_store_sales\n  WHERE\n    is_frequent_period = 1\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    ss_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), customer_sales AS (\n  SELECT\n    ss_customer_sk,\n    SUM(csales_value) AS csales,\n    SUM(ssales_value) AS ssales\n  FROM combined_store_sales\n  GROUP BY\n    ss_customer_sk\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM customer_sales\n), best_ss_customer AS (\n  SELECT\n    ss_customer_sk AS c_customer_sk,\n    ssales\n  FROM customer_sales\n  WHERE\n    ssales > (\n      95 / 100.0\n    ) * (\n      SELECT\n        tpcds_cmax\n      FROM max_store_sales\n    )\n), frequent_item_sk AS (\n  SELECT\n    item_sk\n  FROM frequent_ss_items\n), best_customer_sk AS (\n  SELECT\n    c_customer_sk\n  FROM best_ss_customer\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_item_sk\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_customer_sk\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_item_sk\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_customer_sk\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "consolidate_scans",
        "materialize_cte"
      ],
      "transform_id": "flatten_subq",
      "duration_ms": 45280,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2334,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.2334,
      "output_sql": "WITH combined_store_sales AS (\n  SELECT\n    ss_item_sk,\n    ss_customer_sk,\n    d_date,\n    d_year,\n    i_item_desc,\n    ss_quantity,\n    ss_sales_price,\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN 1 ELSE 0 END AS is_frequent_period,\n    CASE\n      WHEN d_year IN (2000, 2001, 2002, 2003)\n      THEN ss_quantity * ss_sales_price\n      ELSE 0\n    END AS csales_value,\n    ss_quantity * ss_sales_price AS ssales_value\n  FROM store_sales\n  LEFT JOIN date_dim\n    ON ss_sold_date_sk = d_date_sk\n  LEFT JOIN item\n    ON ss_item_sk = i_item_sk\n  LEFT JOIN customer\n    ON ss_customer_sk = c_customer_sk\n  WHERE\n    d_year IN (2000, 2001, 2002, 2003) OR d_year IS NULL\n), frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    ss_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM combined_store_sales\n  WHERE\n    is_frequent_period = 1\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    ss_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), customer_sales AS (\n  SELECT\n    ss_customer_sk,\n    SUM(csales_value) AS csales,\n    SUM(ssales_value) AS ssales\n  FROM combined_store_sales\n  GROUP BY\n    ss_customer_sk\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM customer_sales\n), best_ss_customer AS (\n  SELECT\n    ss_customer_sk AS c_customer_sk,\n    ssales\n  FROM customer_sales\n  CROSS JOIN max_store_sales\n  WHERE\n    ssales > (\n      95 / 100.0\n    ) * tpcds_cmax\n), frequent_item_sk AS (\n  SELECT\n    item_sk\n  FROM frequent_ss_items\n), best_customer_sk AS (\n  SELECT\n    c_customer_sk\n  FROM best_ss_customer\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales\n  INNER JOIN date_dim\n    ON cs_sold_date_sk = d_date_sk\n  INNER JOIN frequent_item_sk\n    ON cs_item_sk = frequent_item_sk.item_sk\n  INNER JOIN best_customer_sk\n    ON cs_bill_customer_sk = best_customer_sk.c_customer_sk\n  WHERE\n    d_year = 2000 AND d_moy = 5\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales\n  INNER JOIN date_dim\n    ON ws_sold_date_sk = d_date_sk\n  INNER JOIN frequent_item_sk\n    ON ws_item_sk = frequent_item_sk.item_sk\n  INNER JOIN best_customer_sk\n    ON ws_bill_customer_sk = best_customer_sk.c_customer_sk\n  WHERE\n    d_year = 2000 AND d_moy = 5\n)\nLIMIT 100"
    },
    {
      "iteration": 15,
      "parent_path": [
        "correlated_to_cte"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 68809,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0101,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "WITH combined_store_sales AS (\n  SELECT\n    ss.ss_item_sk,\n    ss.ss_customer_sk,\n    ss.ss_quantity,\n    ss.ss_sales_price,\n    ss.ss_sold_date_sk,\n    i.i_item_desc,\n    d.d_date,\n    d.d_year,\n    c.c_customer_sk\n  FROM store_sales AS ss\n  LEFT JOIN date_dim AS d\n    ON ss.ss_sold_date_sk = d.d_date_sk\n  LEFT JOIN item AS i\n    ON ss.ss_item_sk = i.i_item_sk\n  LEFT JOIN customer AS c\n    ON ss.ss_customer_sk = c.c_customer_sk\n), combined_aggregates AS (\n  SELECT\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN SUBSTRING(i_item_desc, 1, 30) END AS itemdesc,\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN ss_item_sk END AS item_sk,\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN d_date END AS solddate,\n    COUNT(CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN 1 END) AS cnt_frequent,\n    c_customer_sk,\n    SUM(\n      CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN ss_quantity * ss_sales_price END\n    ) AS csales,\n    SUM(ss_quantity * ss_sales_price) AS total_ssales\n  FROM combined_store_sales\n  GROUP BY\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN SUBSTRING(i_item_desc, 1, 30) END,\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN ss_item_sk END,\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN d_date END,\n    c_customer_sk\n), frequent_ss_items AS (\n  SELECT\n    itemdesc,\n    item_sk,\n    solddate,\n    cnt_frequent AS cnt\n  FROM combined_aggregates\n  WHERE\n    cnt_frequent > 4\n    AND NOT item_sk IS NULL\n    AND NOT solddate IS NULL\n    AND NOT itemdesc IS NULL\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM combined_aggregates\n  WHERE\n    NOT csales IS NULL\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    total_ssales AS ssales\n  FROM combined_aggregates\n  WHERE\n    NOT c_customer_sk IS NULL\n    AND total_ssales > (\n      95 / 100.0\n    ) * (\n      SELECT\n        tpcds_cmax\n      FROM max_store_sales\n    )\n), precomputed_frequent_items AS (\n  SELECT DISTINCT\n    item_sk\n  FROM frequent_ss_items\n), precomputed_best_customers AS (\n  SELECT DISTINCT\n    c_customer_sk\n  FROM best_ss_customer\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM precomputed_frequent_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM precomputed_best_customers\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM precomputed_frequent_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM precomputed_best_customers\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 16,
      "parent_path": [
        "inline_cte"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 54434,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9043,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH combined_store_sales AS (\n  SELECT\n    ss_item_sk,\n    ss_customer_sk,\n    d_date,\n    d_year,\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    ss_quantity,\n    ss_sales_price,\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN 1 ELSE 0 END AS is_frequent_period,\n    CASE WHEN d_year IN (2000, 2001, 2002, 2003) THEN 1 ELSE 0 END AS is_max_period\n  FROM store_sales\n  LEFT JOIN date_dim\n    ON ss_sold_date_sk = d_date_sk\n  LEFT JOIN item\n    ON ss_item_sk = i_item_sk\n  LEFT JOIN customer\n    ON ss_customer_sk = c_customer_sk\n), aggregated AS (\n  SELECT\n    itemdesc,\n    ss_item_sk AS item_sk,\n    d_date AS solddate,\n    SUM(is_frequent_period) AS cnt,\n    ss_customer_sk,\n    SUM(CASE WHEN is_max_period = 1 THEN ss_quantity * ss_sales_price ELSE 0 END) AS csales,\n    SUM(ss_quantity * ss_sales_price) AS total_sales\n  FROM combined_store_sales\n  GROUP BY\n    itemdesc,\n    ss_item_sk,\n    d_date,\n    ss_customer_sk\n), frequent_ss_items AS (\n  SELECT\n    itemdesc,\n    item_sk,\n    solddate,\n    cnt\n  FROM aggregated\n  WHERE\n    cnt > 4\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM aggregated\n  WHERE\n    csales > 0\n), best_ss_customer AS (\n  SELECT\n    ss_customer_sk AS c_customer_sk,\n    total_sales AS ssales\n  FROM aggregated\n  WHERE\n    total_sales > (\n      95 / 100.0\n    ) * (\n      SELECT\n        tpcds_cmax\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 18,
      "parent_path": [
        "correlated_to_cte",
        "consolidate_scans"
      ],
      "transform_id": "or_to_union",
      "duration_ms": 74247,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2314,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.2314,
      "output_sql": "WITH combined_store_sales AS (\n  SELECT\n    ss.ss_item_sk,\n    ss.ss_customer_sk,\n    ss.ss_quantity,\n    ss.ss_sales_price,\n    ss.ss_sold_date_sk,\n    i.i_item_desc,\n    d.d_date,\n    d.d_year,\n    c.c_customer_sk\n  FROM store_sales AS ss\n  LEFT JOIN date_dim AS d\n    ON ss.ss_sold_date_sk = d.d_date_sk\n  LEFT JOIN item AS i\n    ON ss.ss_item_sk = i.i_item_sk\n  LEFT JOIN customer AS c\n    ON ss.ss_customer_sk = c.c_customer_sk\n), branch_2000 AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    ss_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt_frequent,\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS csales,\n    SUM(ss_quantity * ss_sales_price) AS total_ssales\n  FROM combined_store_sales\n  WHERE\n    d_year = 2000\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    ss_item_sk,\n    d_date,\n    c_customer_sk\n), branch_2001 AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    ss_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt_frequent,\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS csales,\n    SUM(ss_quantity * ss_sales_price) AS total_ssales\n  FROM combined_store_sales\n  WHERE\n    d_year = 2001\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    ss_item_sk,\n    d_date,\n    c_customer_sk\n), branch_2002 AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    ss_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt_frequent,\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS csales,\n    SUM(ss_quantity * ss_sales_price) AS total_ssales\n  FROM combined_store_sales\n  WHERE\n    d_year = 2002\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    ss_item_sk,\n    d_date,\n    c_customer_sk\n), branch_2003 AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    ss_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt_frequent,\n    c_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS csales,\n    SUM(ss_quantity * ss_sales_price) AS total_ssales\n  FROM combined_store_sales\n  WHERE\n    d_year = 2003\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    ss_item_sk,\n    d_date,\n    c_customer_sk\n), combined_aggregates AS (\n  SELECT\n    *\n  FROM branch_2000\n  UNION ALL\n  SELECT\n    *\n  FROM branch_2001\n  UNION ALL\n  SELECT\n    *\n  FROM branch_2002\n  UNION ALL\n  SELECT\n    *\n  FROM branch_2003\n), frequent_ss_items AS (\n  SELECT\n    itemdesc,\n    item_sk,\n    solddate,\n    cnt_frequent AS cnt\n  FROM combined_aggregates\n  WHERE\n    cnt_frequent > 4\n    AND NOT item_sk IS NULL\n    AND NOT solddate IS NULL\n    AND NOT itemdesc IS NULL\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM combined_aggregates\n  WHERE\n    NOT csales IS NULL\n), best_ss_customer AS (\n  SELECT\n    c_customer_sk,\n    total_ssales AS ssales\n  FROM combined_aggregates\n  WHERE\n    NOT c_customer_sk IS NULL\n    AND total_ssales > (\n      95 / 100.0\n    ) * (\n      SELECT\n        tpcds_cmax\n      FROM max_store_sales\n    )\n), precomputed_frequent_items AS (\n  SELECT DISTINCT\n    item_sk\n  FROM frequent_ss_items\n), precomputed_best_customers AS (\n  SELECT DISTINCT\n    c_customer_sk\n  FROM best_ss_customer\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM precomputed_frequent_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM precomputed_best_customers\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM precomputed_frequent_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM precomputed_best_customers\n    )\n)\nLIMIT 100"
    },
    {
      "iteration": 20,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 54601,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.5781,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 1.5781,
      "output_sql": "WITH combined_store_sales AS (\n  SELECT\n    ss.ss_item_sk,\n    ss.ss_customer_sk,\n    d.d_date,\n    i.i_item_desc,\n    ss.ss_quantity,\n    ss.ss_sales_price,\n    d.d_year\n  FROM store_sales AS ss\n  JOIN date_dim AS d\n    ON ss.ss_sold_date_sk = d.d_date_sk\n  LEFT JOIN item AS i\n    ON ss.ss_item_sk = i.i_item_sk\n  LEFT JOIN customer AS c\n    ON ss.ss_customer_sk = c.c_customer_sk\n  WHERE\n    d.d_year IN (2000, 2001, 2002, 2003)\n), frequent_ss_items AS (\n  SELECT\n    SUBSTRING(i_item_desc, 1, 30) AS itemdesc,\n    ss_item_sk AS item_sk,\n    d_date AS solddate,\n    COUNT(*) AS cnt\n  FROM combined_store_sales\n  WHERE\n    NOT i_item_desc IS NULL\n  GROUP BY\n    SUBSTRING(i_item_desc, 1, 30),\n    ss_item_sk,\n    d_date\n  HAVING\n    COUNT(*) > 4\n), customer_sales AS (\n  SELECT\n    ss_customer_sk,\n    SUM(ss_quantity * ss_sales_price) AS csales\n  FROM combined_store_sales\n  GROUP BY\n    ss_customer_sk\n), max_store_sales AS (\n  SELECT\n    MAX(csales) AS tpcds_cmax\n  FROM customer_sales\n), best_ss_customer AS (\n  SELECT\n    ss_customer_sk AS c_customer_sk,\n    csales AS ssales\n  FROM customer_sales\n  WHERE\n    csales > (\n      95 / 100.0\n    ) * (\n      SELECT\n        tpcds_cmax\n      FROM max_store_sales\n    )\n)\nSELECT\n  SUM(sales)\nFROM (\n  SELECT\n    cs_quantity * cs_list_price AS sales\n  FROM catalog_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND cs_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n  UNION ALL\n  SELECT\n    ws_quantity * ws_list_price AS sales\n  FROM web_sales, date_dim\n  WHERE\n    d_year = 2000\n    AND d_moy = 5\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk IN (\n      SELECT\n        item_sk\n      FROM frequent_ss_items\n    )\n    AND ws_bill_customer_sk IN (\n      SELECT\n        c_customer_sk\n      FROM best_ss_customer\n    )\n)\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0167,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.2128,
          "visits": 1,
          "avg_reward": 1.1892,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8639,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9779,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9937,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6118,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.0079,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6225,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.188,
          "visits": 1,
          "avg_reward": 1.1472,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.021,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6323,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.1912,
          "visits": 1,
          "avg_reward": 1.1472,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.0332,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.2684,
          "visits": 1,
          "avg_reward": 1.2213,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.1943,
          "visits": 1,
          "avg_reward": 1.1472,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.1446,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.35,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.2713,
          "visits": 1,
          "avg_reward": 1.2213,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.1972,
          "visits": 1,
          "avg_reward": 1.1472,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.0554,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6581,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6743,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.1708,
          "visits": 1,
          "avg_reward": 1.1181,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1106,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.274,
          "visits": 1,
          "avg_reward": 1.2213,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.9377,
          "visits": 1,
          "avg_reward": 1.1472,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.0657,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6658,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.0292,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.1734,
          "visits": 1,
          "avg_reward": 1.1181,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0392,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8426,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.2766,
          "visits": 1,
          "avg_reward": 1.2213,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 2.308,
          "visits": 1,
          "avg_reward": 1.1472,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.0546,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.433,
          "visits": 1,
          "avg_reward": 1.1181,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6556,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8426,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.5362,
          "visits": 1,
          "avg_reward": 1.2213,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 2.0097,
          "visits": 2,
          "avg_reward": 1.7997,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 2.5937,
          "visits": 1,
          "avg_reward": 2.4523,
          "is_valid": true,
          "speedup": 2.4523,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.085,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6803,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2601,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.1782,
          "visits": 1,
          "avg_reward": 1.1181,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2601,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8426,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0601,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.9014,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.7621,
          "visits": 1,
          "avg_reward": 1.2213,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0601,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 2.2419,
          "visits": 3,
          "avg_reward": 1.611,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.9583,
          "visits": 2,
          "avg_reward": 1.8429,
          "is_valid": true,
          "speedup": 2.4523,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.3906,
          "visits": 1,
          "avg_reward": 1.2334,
          "is_valid": true,
          "speedup": 1.2334,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "materialize_cte",
        "flatten_subq"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.0941,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6871,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2624,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.1805,
          "visits": 1,
          "avg_reward": 1.1181,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1291,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2624,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8426,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0624,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.9354,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.7825,
          "visits": 1,
          "avg_reward": 1.2213,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0624,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.732,
          "visits": 4,
          "avg_reward": 1.2082,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "correlated_to_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.0793,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5521,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4702,
          "visits": 1,
          "avg_reward": 1.1181,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7273,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5521,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8426,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.0954,
          "visits": 2,
          "avg_reward": 0.8606,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3491,
          "visits": 4,
          "avg_reward": 1.2082,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.087,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.9015,
          "visits": 2,
          "avg_reward": 0.6591,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7497,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8426,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1031,
          "visits": 2,
          "avg_reward": 0.8606,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3537,
          "visits": 4,
          "avg_reward": 1.2082,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.3286,
          "visits": 3,
          "avg_reward": 1.2286,
          "is_valid": true,
          "speedup": 2.4523,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.745,
          "visits": 2,
          "avg_reward": 0.6167,
          "is_valid": true,
          "speedup": 1.2334,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "materialize_cte",
        "flatten_subq"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.0945,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.9089,
          "visits": 2,
          "avg_reward": 0.6591,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7714,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8426,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1105,
          "visits": 2,
          "avg_reward": 0.8606,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.0915,
          "visits": 5,
          "avg_reward": 0.9666,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "correlated_to_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.995,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0101,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "correlated_to_cte",
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.1017,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.9162,
          "visits": 2,
          "avg_reward": 0.6591,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7925,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8426,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1771,
          "visits": 3,
          "avg_reward": 0.9842,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.0951,
          "visits": 5,
          "avg_reward": 0.9666,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "correlated_to_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2699,
          "visits": 2,
          "avg_reward": 0.8657,
          "is_valid": true,
          "speedup": 1.0101,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "correlated_to_cte",
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.2668,
          "visits": 1,
          "avg_reward": 1.2314,
          "is_valid": true,
          "speedup": 1.2314,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "correlated_to_cte",
        "consolidate_scans",
        "or_to_union"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.1088,
          "visits": 2,
          "avg_reward": 0.8446,
          "is_valid": true,
          "speedup": 1.1892,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8963,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0276,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9793,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.9232,
          "visits": 2,
          "avg_reward": 0.6591,
          "is_valid": true,
          "speedup": 1.1181,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8131,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8426,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8967,
          "visits": 4,
          "avg_reward": 0.7382,
          "is_valid": true,
          "speedup": 1.2213,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.0987,
          "visits": 5,
          "avg_reward": 0.9666,
          "is_valid": true,
          "speedup": 1.1472,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5283,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0346,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 20,
    "avg_reward": 0.6636,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 3,
        "avg_reward": 1.0891,
        "is_valid": true,
        "speedup": 1.1892,
        "error": null,
        "children": {
          "flatten_subq": {
            "transforms": [
              "push_pred",
              "flatten_subq"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.5,
            "is_valid": true,
            "speedup": 1.0346,
            "error": null
          },
          "consolidate_scans": {
            "transforms": [
              "push_pred",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 1.5781,
            "is_valid": true,
            "speedup": 1.5781,
            "error": null
          }
        }
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0276,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 5,
        "avg_reward": 0.9666,
        "is_valid": true,
        "speedup": 1.1472,
        "error": null,
        "children": {
          "materialize_cte": {
            "transforms": [
              "consolidate_scans",
              "materialize_cte"
            ],
            "depth": 2,
            "visits": 4,
            "avg_reward": 0.9214,
            "is_valid": true,
            "speedup": 2.4523,
            "error": null,
            "children": {
              "flatten_subq": {
                "transforms": [
                  "consolidate_scans",
                  "materialize_cte",
                  "flatten_subq"
                ],
                "depth": 3,
                "visits": 3,
                "avg_reward": 0.4111,
                "is_valid": true,
                "speedup": 1.2334,
                "error": null
              }
            }
          }
        }
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9793,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 4,
        "avg_reward": 0.7382,
        "is_valid": true,
        "speedup": 1.2213,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "correlated_to_cte",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 3,
            "avg_reward": 0.5771,
            "is_valid": true,
            "speedup": 1.0101,
            "error": null,
            "children": {
              "or_to_union": {
                "transforms": [
                  "correlated_to_cte",
                  "consolidate_scans",
                  "or_to_union"
                ],
                "depth": 3,
                "visits": 2,
                "avg_reward": 0.6157,
                "is_valid": true,
                "speedup": 1.2314,
                "error": null
              }
            }
          }
        }
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.6591,
        "is_valid": true,
        "speedup": 1.1181,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "inline_cte",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9043,
            "error": null
          }
        }
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.8426,
        "error": null
      }
    }
  }
}