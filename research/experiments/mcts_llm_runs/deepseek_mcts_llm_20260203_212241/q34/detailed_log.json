{
  "stats": {
    "total_iterations": 10,
    "tree_size": 11,
    "successful_expansions": 10,
    "failed_expansions": 0,
    "validation_calls": 10,
    "llm_ranking_calls": 11,
    "root_visits": 10,
    "total_attempts": 10
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 35182,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.0,
      "output_sql": "SELECT\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag,\n  ss_ticket_number,\n  cnt\nFROM (\n  SELECT\n    *\n  FROM branch1_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch2_cte\n) AS dn, customer\nWHERE\n  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20\nORDER BY\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag DESC,\n  ss_ticket_number"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 34904,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.3342,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.3342,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    (\n      d_dom BETWEEN 1 AND 3 OR d_dom BETWEEN 25 AND 28\n    )\n    AND d_year IN (1998, 1999, 2000)\n)\nSELECT\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag,\n  ss_ticket_number,\n  cnt\nFROM (\n  SELECT\n    ss_ticket_number,\n    ss_customer_sk,\n    COUNT(*) AS cnt\n  FROM store_sales, filtered_dates, store, household_demographics\n  WHERE\n    store_sales.ss_sold_date_sk = filtered_dates.d_date_sk\n    AND store_sales.ss_store_sk = store.s_store_sk\n    AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    AND (\n      household_demographics.hd_buy_potential = '1001-5000'\n      OR household_demographics.hd_buy_potential = '0-500'\n    )\n    AND household_demographics.hd_vehicle_count > 0\n    AND (\n      CASE\n        WHEN household_demographics.hd_vehicle_count > 0\n        THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n        ELSE NULL\n      END\n    ) > 1.2\n    AND store.s_county IN (\n      'Ziebach County',\n      'Daviess County',\n      'Walker County',\n      'Richland County',\n      'Barrow County',\n      'Franklin Parish',\n      'Williamson County',\n      'Luce County'\n    )\n  GROUP BY\n    ss_ticket_number,\n    ss_customer_sk\n) AS dn, customer\nWHERE\n  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20\nORDER BY\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag DESC,\n  ss_ticket_number"
    },
    {
      "iteration": 3,
      "parent_path": [
        "date_cte_isolate"
      ],
      "transform_id": "push_pred",
      "duration_ms": 24572,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9685,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    (\n      d_dom BETWEEN 1 AND 3 OR d_dom BETWEEN 25 AND 28\n    )\n    AND d_year IN (1998, 1999, 2000)\n)\nSELECT\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag,\n  ss_ticket_number,\n  cnt\nFROM (\n  SELECT\n    ss_ticket_number,\n    ss_customer_sk,\n    COUNT(*) AS cnt\n  FROM store_sales, filtered_dates, store, household_demographics\n  WHERE\n    store_sales.ss_sold_date_sk = filtered_dates.d_date_sk\n    AND store_sales.ss_store_sk = store.s_store_sk\n    AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    AND (\n      household_demographics.hd_buy_potential = '1001-5000'\n      OR household_demographics.hd_buy_potential = '0-500'\n    )\n    AND household_demographics.hd_vehicle_count > 0\n    AND (\n      CASE\n        WHEN household_demographics.hd_vehicle_count > 0\n        THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n        ELSE NULL\n      END\n    ) > 1.2\n    AND store.s_county IN (\n      'Ziebach County',\n      'Daviess County',\n      'Walker County',\n      'Richland County',\n      'Barrow County',\n      'Franklin Parish',\n      'Williamson County',\n      'Luce County'\n    )\n  GROUP BY\n    ss_ticket_number,\n    ss_customer_sk\n) AS dn, customer\nWHERE\n  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20\nORDER BY\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag DESC,\n  ss_ticket_number"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 24842,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.159,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 1.159,
      "output_sql": "SELECT\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag,\n  ss_ticket_number,\n  cnt\nFROM (\n  SELECT\n    ss_ticket_number,\n    ss_customer_sk,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, store, household_demographics\n  WHERE\n    store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    AND store_sales.ss_store_sk = store.s_store_sk\n    AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    AND (\n      date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28\n    )\n    AND (\n      household_demographics.hd_buy_potential = '1001-5000'\n      OR household_demographics.hd_buy_potential = '0-500'\n    )\n    AND household_demographics.hd_vehicle_count > 0\n    AND (\n      CASE\n        WHEN household_demographics.hd_vehicle_count > 0\n        THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n        ELSE NULL\n      END\n    ) > 1.2\n    AND date_dim.d_year IN (1998, 1998 + 1, 1998 + 2)\n    AND store.s_county IN (\n      'Ziebach County',\n      'Daviess County',\n      'Walker County',\n      'Richland County',\n      'Barrow County',\n      'Franklin Parish',\n      'Williamson County',\n      'Luce County'\n    )\n  GROUP BY\n    ss_ticket_number,\n    ss_customer_sk\n) AS dn, customer\nWHERE\n  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20\nORDER BY\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag DESC,\n  ss_ticket_number"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 30969,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "SELECT\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag,\n  ss_ticket_number,\n  cnt\nFROM consolidated_scan, customer\nWHERE\n  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20\nORDER BY\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag DESC,\n  ss_ticket_number"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 52218,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0063,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.5,
      "output_sql": "SELECT c_last_name,\n       c_first_name,\n       c_salutation,\n       c_preferred_cust_flag,\n       ss_ticket_number,\n       cnt\nFROM (\n    SELECT ss_ticket_number,\n           ss_customer_sk,\n           COUNT(*) AS cnt\n    FROM store_sales\n    JOIN date_dim ON store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    JOIN store ON store_sales.ss_store_sk = store.s_store_sk\n    JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    WHERE (date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28)\n      AND (household_demographics.hd_buy_potential = '1001-5000' OR household_demographics.hd_buy_potential = '0-500')\n      AND household_demographics.hd_vehicle_count > 0\n      AND (CASE \n             WHEN household_demographics.hd_vehicle_count > 0 \n             THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count \n             ELSE NULL \n           END) > 1.2\n      AND date_dim.d_year IN (1998, 1999, 2000)\n      AND store.s_county IN ('Ziebach County', 'Daviess County', 'Walker County', 'Richland County',\n                             'Barrow County', 'Franklin Parish', 'Williamson County', 'Luce County')\n    GROUP BY ss_ticket_number, ss_customer_sk\n) dn\nJOIN customer ON dn.ss_customer_sk = customer.c_customer_sk\nWHERE cnt BETWEEN 15 AND 20\nORDER BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC, ss_ticket_number"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 29442,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.0,
      "output_sql": "SELECT\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag,\n  ss_ticket_number,\n  cnt\nFROM derived_cte, customer\nWHERE\n  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20\nORDER BY\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag DESC,\n  ss_ticket_number"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 26,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9635,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.2,
      "output_sql": "select c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '1001-5000' or\n         household_demographics.hd_buy_potential = '0-500')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (1998,1998+1,1998+2)\n    and store.s_county in ('Ziebach County','Daviess County','Walker County','Richland County',\n                           'Barrow County','Franklin Parish','Williamson County','Luce County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 35633,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8896,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.2,
      "output_sql": "WITH store_sales_summary AS (\n  SELECT\n    ss_ticket_number,\n    ss_customer_sk,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, store, household_demographics\n  WHERE\n    store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    AND store_sales.ss_store_sk = store.s_store_sk\n    AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    AND (\n      date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28\n    )\n    AND (\n      household_demographics.hd_buy_potential = '1001-5000'\n      OR household_demographics.hd_buy_potential = '0-500'\n    )\n    AND household_demographics.hd_vehicle_count > 0\n    AND (\n      CASE\n        WHEN household_demographics.hd_vehicle_count > 0\n        THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n        ELSE NULL\n      END\n    ) > 1.2\n    AND date_dim.d_year IN (1998, 1998 + 1, 1998 + 2)\n    AND store.s_county IN (\n      'Ziebach County',\n      'Daviess County',\n      'Walker County',\n      'Richland County',\n      'Barrow County',\n      'Franklin Parish',\n      'Williamson County',\n      'Luce County'\n    )\n  GROUP BY\n    ss_ticket_number,\n    ss_customer_sk\n)\nSELECT\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag,\n  ss_ticket_number,\n  cnt\nFROM store_sales_summary, customer\nWHERE\n  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20\nORDER BY\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag DESC,\n  ss_ticket_number"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 39382,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9025,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.2,
      "output_sql": "SELECT\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag,\n  ss_ticket_number,\n  cnt\nFROM (\n  SELECT\n    ss_ticket_number,\n    ss_customer_sk,\n    COUNT(*) AS cnt\n  FROM store_sales, date_dim, store, household_demographics\n  WHERE\n    store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    AND store_sales.ss_store_sk = store.s_store_sk\n    AND store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    AND (\n      date_dim.d_dom BETWEEN 1 AND 3 OR date_dim.d_dom BETWEEN 25 AND 28\n    )\n    AND (\n      household_demographics.hd_buy_potential = '1001-5000'\n      OR household_demographics.hd_buy_potential = '0-500'\n    )\n    AND household_demographics.hd_vehicle_count > 0\n    AND (\n      CASE\n        WHEN household_demographics.hd_vehicle_count > 0\n        THEN household_demographics.hd_dep_count / household_demographics.hd_vehicle_count\n        ELSE NULL\n      END\n    ) > 1.2\n    AND date_dim.d_year IN (1998, 1998 + 1, 1998 + 2)\n    AND store.s_county IN (\n      'Ziebach County',\n      'Daviess County',\n      'Walker County',\n      'Richland County',\n      'Barrow County',\n      'Franklin Parish',\n      'Williamson County',\n      'Luce County'\n    )\n  GROUP BY\n    ss_ticket_number,\n    ss_customer_sk\n) AS dn, customer\nWHERE\n  ss_customer_sk = c_customer_sk AND cnt BETWEEN 15 AND 20\nORDER BY\n  c_last_name,\n  c_first_name,\n  c_salutation,\n  c_preferred_cust_flag DESC,\n  ss_ticket_number"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0167,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.3578,
          "visits": 1,
          "avg_reward": 1.3342,
          "is_valid": true,
          "speedup": 1.3342,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "date_cte_isolate"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7864,
          "visits": 2,
          "avg_reward": 0.7671,
          "is_valid": true,
          "speedup": 1.3342,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.1923,
          "visits": 1,
          "avg_reward": 1.159,
          "is_valid": true,
          "speedup": 1.159,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7893,
          "visits": 2,
          "avg_reward": 0.7671,
          "is_valid": true,
          "speedup": 1.3342,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.1963,
          "visits": 1,
          "avg_reward": 1.159,
          "is_valid": true,
          "speedup": 1.159,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.792,
          "visits": 2,
          "avg_reward": 0.7671,
          "is_valid": true,
          "speedup": 1.3342,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.1998,
          "visits": 1,
          "avg_reward": 1.159,
          "is_valid": true,
          "speedup": 1.159,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2646,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0063,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7943,
          "visits": 2,
          "avg_reward": 0.7671,
          "is_valid": true,
          "speedup": 1.3342,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2031,
          "visits": 1,
          "avg_reward": 1.159,
          "is_valid": true,
          "speedup": 1.159,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0063,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5657,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7965,
          "visits": 2,
          "avg_reward": 0.7671,
          "is_valid": true,
          "speedup": 1.3342,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.3004,
          "visits": 1,
          "avg_reward": 1.159,
          "is_valid": true,
          "speedup": 1.159,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0063,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9635,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7985,
          "visits": 2,
          "avg_reward": 0.7671,
          "is_valid": true,
          "speedup": 1.3342,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9487,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.459,
          "visits": 1,
          "avg_reward": 1.159,
          "is_valid": true,
          "speedup": 1.159,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.35,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8896,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0063,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9635,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8004,
          "visits": 2,
          "avg_reward": 0.7671,
          "is_valid": true,
          "speedup": 1.3342,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 10,
    "avg_reward": 0.3793,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.7671,
        "is_valid": true,
        "speedup": 1.3342,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "date_cte_isolate",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9685,
            "error": null
          }
        }
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.159,
        "is_valid": true,
        "speedup": 1.159,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0063,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9635,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.8896,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9025,
        "error": null
      }
    }
  }
}