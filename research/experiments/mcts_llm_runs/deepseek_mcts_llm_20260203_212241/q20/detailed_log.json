{
  "stats": {
    "total_iterations": 20,
    "tree_size": 21,
    "successful_expansions": 20,
    "failed_expansions": 0,
    "validation_calls": 20,
    "llm_ranking_calls": 32,
    "root_visits": 20,
    "total_attempts": 20
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 20597,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0174,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.5,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM (\n  SELECT\n    cs_item_sk,\n    cs_sold_date_sk,\n    cs_ext_sales_price\n  FROM catalog_sales\n) AS cs, (\n  SELECT\n    i_item_sk,\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price\n  FROM item\n  WHERE\n    i_category IN ('Shoes', 'Books', 'Women')\n) AS i, (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n      CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n    )\n) AS d\nWHERE\n  cs.cs_item_sk = i.i_item_sk AND cs.cs_sold_date_sk = d.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 14604,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM catalog_sales, item, filtered_dates\nWHERE\n  cs_item_sk = i_item_sk\n  AND i_category IN ('Shoes', 'Books', 'Women')\n  AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 20213,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9885,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM item\nINNER JOIN catalog_sales\n  ON cs_item_sk = i_item_sk\nINNER JOIN date_dim\n  ON cs_sold_date_sk = d_date_sk\nWHERE\n  i_category IN ('Shoes', 'Books', 'Women')\n  AND d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n    CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n  )\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 40120,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.3991,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 1.3991,
      "output_sql": "WITH shoes_cte AS (\n  SELECT\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    cs_ext_sales_price,\n    cs_sold_date_sk\n  FROM catalog_sales, item, date_dim\n  WHERE\n    cs_item_sk = i_item_sk\n    AND i_category = 'Shoes'\n    AND cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n      CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n    )\n), books_cte AS (\n  SELECT\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    cs_ext_sales_price,\n    cs_sold_date_sk\n  FROM catalog_sales, item, date_dim\n  WHERE\n    cs_item_sk = i_item_sk\n    AND i_category = 'Books'\n    AND cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n      CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n    )\n), women_cte AS (\n  SELECT\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    cs_ext_sales_price,\n    cs_sold_date_sk\n  FROM catalog_sales, item, date_dim\n  WHERE\n    cs_item_sk = i_item_sk\n    AND i_category = 'Women'\n    AND cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n      CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n    )\n), combined_cte AS (\n  SELECT\n    *\n  FROM shoes_cte\n  UNION ALL\n  SELECT\n    *\n  FROM books_cte\n  UNION ALL\n  SELECT\n    *\n  FROM women_cte\n)\nSELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM combined_cte\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 28867,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "SELECT\n  cs.i_item_id,\n  cs.i_item_desc,\n  cs.i_category,\n  cs.i_class,\n  cs.i_current_price,\n  cs.category_class_sales AS itemrevenue,\n  cs.category_class_sales * 100 / ct.total_class_sales AS revenueratio\nFROM category_sales AS cs\nJOIN class_totals AS ct\n  ON cs.i_class = ct.i_class\nORDER BY\n  cs.i_category,\n  cs.i_class,\n  cs.i_item_id,\n  cs.i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 33941,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0998,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.5,
      "output_sql": "SELECT i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,SUM(cs_ext_sales_price) AS itemrevenue \n       ,SUM(cs_ext_sales_price)*100/SUM(SUM(cs_ext_sales_price)) OVER\n           (PARTITION BY i_class) AS revenueratio\nFROM catalog_sales\nJOIN item ON cs_item_sk = i_item_sk\nJOIN date_dim ON cs_sold_date_sk = d_date_sk\nWHERE i_category IN ('Shoes', 'Books', 'Women')\n  AND d_date BETWEEN CAST('2002-01-26' AS DATE) \n                 AND (CAST('2002-01-26' AS DATE) + INTERVAL 30 DAY)\nGROUP BY i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\nORDER BY i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n         ,revenueratio\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 15499,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM filtered_catalog_sales, item\nWHERE\n  cs_item_sk = i_item_sk AND i_category IN ('Shoes', 'Books', 'Women')\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [
        "or_to_union"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 28429,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1269,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1269,
      "output_sql": "WITH combined_scan AS (\n  SELECT\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    cs_ext_sales_price,\n    cs_sold_date_sk\n  FROM catalog_sales, item, date_dim\n  WHERE\n    cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n      CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n    )\n    AND i_category IN ('Shoes', 'Books', 'Women')\n)\nSELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM combined_scan\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 16,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.116,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 1.116,
      "output_sql": "select i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Books', 'Women')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('2002-01-26' as date) \n \t\t\t\tand (cast('2002-01-26' as date) + INTERVAL 30 DAY)\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n         ,revenueratio\n LIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 14168,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1018,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 1.1018,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM catalog_sales, item, date_dim\nWHERE\n  cs_item_sk = i_item_sk\n  AND i_category IN ('Shoes', 'Books', 'Women')\n  AND cs_sold_date_sk = d_date_sk\n  AND d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n    CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n  )\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 16053,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0503,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.5,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  100.0 * SUM(cs_ext_sales_price) / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM catalog_sales, item, date_dim\nWHERE\n  cs_item_sk = i_item_sk\n  AND i_category IN ('Shoes', 'Books', 'Women')\n  AND cs_sold_date_sk = d_date_sk\n  AND d_date BETWEEN CAST('2002-01-26' AS DATE) AND CAST('2002-02-25' AS DATE)\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 40438,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 2.3528,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 11,
      "reward": 2.3528,
      "output_sql": "WITH filtered_sales AS (\n    SELECT cs_item_sk, cs_ext_sales_price\n    FROM catalog_sales, date_dim\n    WHERE cs_sold_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2002-01-26' AS DATE) \n                     AND (CAST('2002-01-26' AS DATE) + INTERVAL 30 DAY)\n),\nitem_sales AS (\n    SELECT i_item_id,\n           i_item_desc,\n           i_category,\n           i_class,\n           i_current_price,\n           SUM(cs_ext_sales_price) AS itemrevenue\n    FROM filtered_sales, item\n    WHERE cs_item_sk = i_item_sk\n      AND i_category IN ('Shoes', 'Books', 'Women')\n    GROUP BY i_item_id,\n             i_item_desc,\n             i_category,\n             i_class,\n             i_current_price\n),\nclass_totals AS (\n    SELECT i_class,\n           SUM(itemrevenue) AS class_total\n    FROM item_sales\n    GROUP BY i_class\n)\nSELECT i_item_id,\n       i_item_desc,\n       i_category,\n       i_class,\n       i_current_price,\n       itemrevenue,\n       itemrevenue * 100 / class_total AS revenueratio\nFROM item_sales\nJOIN class_totals USING (i_class)\nORDER BY i_category,\n         i_class,\n         i_item_id,\n         i_item_desc,\n         revenueratio\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "correlated_to_cte"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 60584,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0278,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "WITH combined_aggregates AS (\n  SELECT\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    SUM(cs_ext_sales_price) AS itemrevenue,\n    SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS class_total\n  FROM (\n    SELECT\n      cs_item_sk,\n      cs_ext_sales_price\n    FROM catalog_sales, date_dim\n    WHERE\n      cs_sold_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n        CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n      )\n  ) AS filtered_sales, item\n  WHERE\n    cs_item_sk = i_item_sk AND i_category IN ('Shoes', 'Books', 'Women')\n  GROUP BY\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price\n)\nSELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  itemrevenue,\n  itemrevenue * 100 / class_total AS revenueratio\nFROM combined_aggregates\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "correlated_to_cte",
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 19324,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9716,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH combined_aggregates AS (\n  SELECT\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    SUM(cs_ext_sales_price) AS itemrevenue,\n    SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS class_total\n  FROM (\n    SELECT\n      cs_item_sk,\n      cs_ext_sales_price\n    FROM catalog_sales, date_dim\n    WHERE\n      cs_sold_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n        CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n      )\n  ) AS filtered_sales, item\n  WHERE\n    cs_item_sk = i_item_sk AND i_category IN ('Shoes', 'Books', 'Women')\n  GROUP BY\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price\n)\nSELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  itemrevenue,\n  itemrevenue * 100 / class_total AS revenueratio\nFROM combined_aggregates\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 15,
      "parent_path": [
        "or_to_union",
        "consolidate_scans"
      ],
      "transform_id": "date_cte_isolate",
      "duration_ms": 28005,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7802,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n      CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n    )\n), combined_scan AS (\n  SELECT\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    cs_ext_sales_price,\n    cs_sold_date_sk\n  FROM catalog_sales, item, filtered_dates\n  WHERE\n    cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND i_category IN ('Shoes', 'Books', 'Women')\n)\nSELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM combined_scan\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 16,
      "parent_path": [
        "multi_push_pred"
      ],
      "transform_id": "push_pred",
      "duration_ms": 19714,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8112,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM (\n  SELECT\n    cs_item_sk,\n    cs_sold_date_sk,\n    cs_ext_sales_price\n  FROM catalog_sales\n) AS cs, (\n  SELECT\n    i_item_sk,\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price\n  FROM item\n  WHERE\n    i_category IN ('Shoes', 'Books', 'Women')\n) AS i, (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n      CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n    )\n) AS d\nWHERE\n  cs.cs_item_sk = i.i_item_sk AND cs.cs_sold_date_sk = d.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 17,
      "parent_path": [
        "or_to_union",
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 43668,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9265,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.2,
      "output_sql": "WITH combined_scan AS (\n  SELECT\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price,\n    cs_ext_sales_price,\n    cs_sold_date_sk\n  FROM (\n    SELECT\n      cs_item_sk,\n      cs_ext_sales_price,\n      cs_sold_date_sk\n    FROM catalog_sales\n  ) AS cs, (\n    SELECT\n      i_item_sk,\n      i_item_id,\n      i_item_desc,\n      i_category,\n      i_class,\n      i_current_price\n    FROM item\n    WHERE\n      i_category IN ('Shoes', 'Books', 'Women')\n  ) AS i, (\n    SELECT\n      d_date_sk\n    FROM date_dim\n    WHERE\n      d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n        CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n      )\n  ) AS d\n  WHERE\n    cs.cs_item_sk = i.i_item_sk AND cs.cs_sold_date_sk = d.d_date_sk\n)\nSELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM combined_scan\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 18,
      "parent_path": [
        "correlated_to_cte"
      ],
      "transform_id": "materialize_cte",
      "duration_ms": 56281,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1421,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 1.1421,
      "output_sql": "WITH filtered_sales AS (\n    SELECT cs_item_sk, cs_ext_sales_price\n    FROM catalog_sales, date_dim\n    WHERE cs_sold_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2002-01-26' AS DATE) \n                     AND (CAST('2002-01-26' AS DATE) + INTERVAL 30 DAY)\n),\nitem_sales AS (\n    SELECT i_item_id,\n           i_item_desc,\n           i_category,\n           i_class,\n           i_current_price,\n           SUM(cs_ext_sales_price) AS itemrevenue\n    FROM filtered_sales, item\n    WHERE cs_item_sk = i_item_sk\n      AND i_category IN ('Shoes', 'Books', 'Women')\n    GROUP BY i_item_id,\n             i_item_desc,\n             i_category,\n             i_class,\n             i_current_price\n),\nclass_totals AS (\n    SELECT i_class,\n           SUM(itemrevenue) AS class_total\n    FROM item_sales\n    GROUP BY i_class\n)\nSELECT i_item_id,\n       i_item_desc,\n       i_category,\n       i_class,\n       i_current_price,\n       itemrevenue,\n       itemrevenue * 100 / class_total AS revenueratio\nFROM item_sales\nJOIN class_totals USING (i_class)\nORDER BY i_category,\n         i_class,\n         i_item_id,\n         i_item_desc,\n         revenueratio\nLIMIT 100"
    },
    {
      "iteration": 19,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 23623,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9328,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n      CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n    )\n) AS d, (\n  SELECT\n    i_item_sk,\n    i_item_id,\n    i_item_desc,\n    i_category,\n    i_class,\n    i_current_price\n  FROM item\n  WHERE\n    i_category IN ('Shoes', 'Books', 'Women')\n) AS i, (\n  SELECT\n    cs_item_sk,\n    cs_sold_date_sk,\n    cs_ext_sales_price\n  FROM catalog_sales\n) AS cs\nWHERE\n  cs.cs_item_sk = i.i_item_sk AND cs.cs_sold_date_sk = d.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    },
    {
      "iteration": 20,
      "parent_path": [
        "inline_cte"
      ],
      "transform_id": "push_pred",
      "duration_ms": 20253,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9028,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price,\n  SUM(cs_ext_sales_price) AS itemrevenue,\n  SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio\nFROM catalog_sales, (\n  SELECT\n    *\n  FROM item\n  WHERE\n    i_category IN ('Shoes', 'Books', 'Women')\n) AS item, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_date BETWEEN CAST('2002-01-26' AS DATE) AND (\n      CAST('2002-01-26' AS DATE) + INTERVAL '30' DAY\n    )\n) AS date_dim\nWHERE\n  cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  i_category,\n  i_class,\n  i_current_price\nORDER BY\n  i_category,\n  i_class,\n  i_item_id,\n  i_item_desc,\n  revenueratio\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5236,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5289,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4324,
          "visits": 1,
          "avg_reward": 1.3991,
          "is_valid": true,
          "speedup": 1.3991,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6118,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4364,
          "visits": 1,
          "avg_reward": 1.3991,
          "is_valid": true,
          "speedup": 1.3991,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6225,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4399,
          "visits": 1,
          "avg_reward": 1.3991,
          "is_valid": true,
          "speedup": 1.3991,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7405,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4405,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2405,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7405,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.6396,
          "visits": 1,
          "avg_reward": 1.3991,
          "is_valid": true,
          "speedup": 1.3991,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2405,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2405,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "or_to_union"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.2944,
          "visits": 2,
          "avg_reward": 1.263,
          "is_valid": true,
          "speedup": 1.3991,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.95,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.15,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.166,
          "visits": 1,
          "avg_reward": 1.116,
          "is_valid": true,
          "speedup": 1.116,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.2963,
          "visits": 2,
          "avg_reward": 1.263,
          "is_valid": true,
          "speedup": 1.3991,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.2906,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6743,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3162,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.2599,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.1687,
          "visits": 1,
          "avg_reward": 1.116,
          "is_valid": true,
          "speedup": 1.116,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.2981,
          "visits": 2,
          "avg_reward": 1.263,
          "is_valid": true,
          "speedup": 1.3991,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1106,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.3292,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6975,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3317,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.2676,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5553,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5553,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0503,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.1713,
          "visits": 1,
          "avg_reward": 1.116,
          "is_valid": true,
          "speedup": 1.116,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.2999,
          "visits": 2,
          "avg_reward": 1.263,
          "is_valid": true,
          "speedup": 1.3991,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 2.4249,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.366,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.2124,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7196,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.3015,
          "visits": 2,
          "avg_reward": 1.263,
          "is_valid": true,
          "speedup": 1.3991
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5577,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.1737,
          "visits": 1,
          "avg_reward": 1.116,
          "is_valid": true,
          "speedup": 1.116
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.275,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5577,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0503
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 2.4105,
          "visits": 1,
          "avg_reward": 2.3528,
          "is_valid": true,
          "speedup": 2.3528
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "correlated_to_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.4014,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.2619,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.3031,
          "visits": 2,
          "avg_reward": 1.263,
          "is_valid": true,
          "speedup": 1.3991
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0601,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5601,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3606,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.1761,
          "visits": 1,
          "avg_reward": 1.116,
          "is_valid": true,
          "speedup": 1.116
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.2821,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5601,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0503
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.4665,
          "visits": 2,
          "avg_reward": 1.4264,
          "is_valid": true,
          "speedup": 2.3528
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "correlated_to_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.995,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0278,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "correlated_to_cte",
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4898,
          "visits": 2,
          "avg_reward": 1.263,
          "is_valid": true,
          "speedup": 1.3991
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4562,
          "visits": 1,
          "avg_reward": 1.116,
          "is_valid": true,
          "speedup": 1.116
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.442,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0503
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1877,
          "visits": 3,
          "avg_reward": 1.0176,
          "is_valid": true,
          "speedup": 2.3528
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "or_to_union"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.6219,
          "visits": 1,
          "avg_reward": 1.1269,
          "is_valid": true,
          "speedup": 1.1269,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "or_to_union",
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5521,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.0847,
          "visits": 3,
          "avg_reward": 0.9087,
          "is_valid": true,
          "speedup": 1.3991
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4681,
          "visits": 1,
          "avg_reward": 1.116,
          "is_valid": true,
          "speedup": 1.116
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4539,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0503
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1936,
          "visits": 3,
          "avg_reward": 1.0176,
          "is_valid": true,
          "speedup": 2.3528
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "multi_push_pred"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.1,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.0,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.6087,
          "visits": 3,
          "avg_reward": 0.9087,
          "is_valid": true,
          "speedup": 1.3991
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0667,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5667,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7024,
          "visits": 2,
          "avg_reward": 0.658,
          "is_valid": true,
          "speedup": 1.116
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.1685,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5667,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0503
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.0509,
          "visits": 3,
          "avg_reward": 1.0176,
          "is_valid": true,
          "speedup": 2.3528
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "or_to_union"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.0676,
          "visits": 2,
          "avg_reward": 0.6635,
          "is_valid": true,
          "speedup": 1.1269,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "or_to_union",
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3571,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7802,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9123,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.0308,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4062,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.3087,
          "visits": 4,
          "avg_reward": 0.7315,
          "is_valid": true,
          "speedup": 1.3991
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0687,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5687,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0687,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7038,
          "visits": 2,
          "avg_reward": 0.658,
          "is_valid": true,
          "speedup": 1.116
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.1705,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5687,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0503
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.3268,
          "visits": 3,
          "avg_reward": 1.0176,
          "is_valid": true,
          "speedup": 2.3528
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "correlated_to_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7541,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0278,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.5607,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0174
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.4849,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8364,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.7598,
          "visits": 4,
          "avg_reward": 0.7315,
          "is_valid": true,
          "speedup": 1.3991
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0707,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5707,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4243,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7051,
          "visits": 2,
          "avg_reward": 0.658,
          "is_valid": true,
          "speedup": 1.116
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.3139,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5707,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0503
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.077,
          "visits": 4,
          "avg_reward": 1.0487,
          "is_valid": true,
          "speedup": 2.3528
        }
      ],
      "selected": "push_pred",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6142,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0174
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9885
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.89,
          "visits": 4,
          "avg_reward": 0.7315,
          "is_valid": true,
          "speedup": 1.3991
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8963,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0998
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.9222,
          "visits": 2,
          "avg_reward": 0.658,
          "is_valid": true,
          "speedup": 1.116
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4981,
          "visits": 1,
          "avg_reward": 1.1018,
          "is_valid": true,
          "speedup": 1.1018
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8963,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0503
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.2072,
          "visits": 4,
          "avg_reward": 1.0487,
          "is_valid": true,
          "speedup": 2.3528
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 20,
    "avg_reward": 0.5819,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.35,
        "is_valid": true,
        "speedup": 1.0174,
        "error": null,
        "children": {
          "reorder_join": {
            "transforms": [
              "push_pred",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9328,
            "error": null
          }
        }
      },
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9885,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 4,
        "avg_reward": 0.7315,
        "is_valid": true,
        "speedup": 1.3991,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "or_to_union",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 3,
            "avg_reward": 0.509,
            "is_valid": true,
            "speedup": 1.1269,
            "error": null,
            "children": {
              "date_cte_isolate": {
                "transforms": [
                  "or_to_union",
                  "consolidate_scans",
                  "date_cte_isolate"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.7802,
                "error": null
              },
              "push_pred": {
                "transforms": [
                  "or_to_union",
                  "consolidate_scans",
                  "push_pred"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.9265,
                "error": null
              }
            }
          }
        }
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0998,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.658,
        "is_valid": true,
        "speedup": 1.116,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "multi_push_pred",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.8112,
            "error": null
          }
        }
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.6509,
        "is_valid": true,
        "speedup": 1.1018,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "inline_cte",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9028,
            "error": null
          }
        }
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0503,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 4,
        "avg_reward": 1.0487,
        "is_valid": true,
        "speedup": 2.3528,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "correlated_to_cte",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.35,
            "is_valid": true,
            "speedup": 1.0278,
            "error": null,
            "children": {
              "push_pred": {
                "transforms": [
                  "correlated_to_cte",
                  "consolidate_scans",
                  "push_pred"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.9716,
                "error": null
              }
            }
          },
          "materialize_cte": {
            "transforms": [
              "correlated_to_cte",
              "materialize_cte"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 1.1421,
            "is_valid": true,
            "speedup": 1.1421,
            "error": null
          }
        }
      }
    }
  }
}