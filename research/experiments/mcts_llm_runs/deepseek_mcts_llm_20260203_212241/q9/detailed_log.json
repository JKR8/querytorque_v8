{
  "stats": {
    "total_iterations": 17,
    "tree_size": 18,
    "successful_expansions": 17,
    "failed_expansions": 0,
    "validation_calls": 17,
    "llm_ranking_calls": 26,
    "root_visits": 17,
    "total_attempts": 17
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 61103,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0211,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.5,
      "output_sql": "select case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 2972190\n            then (select avg(ss_ext_sales_price) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 4505785\n            then (select avg(ss_ext_sales_price)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 1575726\n            then (select avg(ss_ext_sales_price)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 3188917\n            then (select avg(ss_ext_sales_price)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 3525216\n            then (select avg(ss_ext_sales_price)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 46861,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.2937,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH store_sales_agg AS (\n  SELECT\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END AS bucket,\n    COUNT(*) AS cnt,\n    SUM(ss_ext_sales_price) AS sum_ext_sales_price,\n    SUM(ss_net_profit) AS sum_net_profit,\n    COUNT(ss_ext_sales_price) AS cnt_ext_sales_price,\n    COUNT(ss_net_profit) AS cnt_net_profit\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 1 AND 100\n  GROUP BY\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END\n)\nSELECT\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    ) > 2972190\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    ) > 4505785\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    ) > 1575726\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    ) > 3188917\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    ) > 3525216\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 23573,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.0,
      "output_sql": "SELECT\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_1_20\n    ) > 2972190\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_1_20\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_1_20\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_21_40\n    ) > 4505785\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_21_40\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_21_40\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_41_60\n    ) > 1575726\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_41_60\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_41_60\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_61_80\n    ) > 3188917\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_61_80\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_61_80\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_81_100\n    ) > 3525216\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_81_100\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_81_100\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 58233,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.0,
      "output_sql": "SELECT\n  CASE\n    WHEN (\n      SELECT\n        row_count\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 1\n    ) > 2972190\n    THEN (\n      SELECT\n        avg_ext_sales_price\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 1\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 1\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        row_count\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 2\n    ) > 4505785\n    THEN (\n      SELECT\n        avg_ext_sales_price\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 2\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 2\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        row_count\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 3\n    ) > 1575726\n    THEN (\n      SELECT\n        avg_ext_sales_price\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 3\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 3\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        row_count\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 4\n    ) > 3188917\n    THEN (\n      SELECT\n        avg_ext_sales_price\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 4\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 4\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        row_count\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 5\n    ) > 3525216\n    THEN (\n      SELECT\n        avg_ext_sales_price\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 5\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM aggregated_metrics_cte\n      WHERE\n        quantity_bucket = 5\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 42867,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.5304,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.2,
      "output_sql": "SELECT\n  CASE\n    WHEN agg_counts.count_1_20 > 2972190\n    THEN agg_avgs.avg_ext_price_1_20\n    ELSE agg_avgs.avg_net_profit_1_20\n  END AS bucket1,\n  CASE\n    WHEN agg_counts.count_21_40 > 4505785\n    THEN agg_avgs.avg_ext_price_21_40\n    ELSE agg_avgs.avg_net_profit_21_40\n  END AS bucket2,\n  CASE\n    WHEN agg_counts.count_41_60 > 1575726\n    THEN agg_avgs.avg_ext_price_41_60\n    ELSE agg_avgs.avg_net_profit_41_60\n  END AS bucket3,\n  CASE\n    WHEN agg_counts.count_61_80 > 3188917\n    THEN agg_avgs.avg_ext_price_61_80\n    ELSE agg_avgs.avg_net_profit_61_80\n  END AS bucket4,\n  CASE\n    WHEN agg_counts.count_81_100 > 3525216\n    THEN agg_avgs.avg_ext_price_81_100\n    ELSE agg_avgs.avg_net_profit_81_100\n  END AS bucket5\nFROM reason\nCROSS JOIN (\n  SELECT\n    COUNT(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN 1 END) AS count_1_20,\n    COUNT(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN 1 END) AS count_21_40,\n    COUNT(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN 1 END) AS count_41_60,\n    COUNT(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN 1 END) AS count_61_80,\n    COUNT(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN 1 END) AS count_81_100\n  FROM store_sales\n) AS agg_counts\nCROSS JOIN (\n  SELECT\n    AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_ext_sales_price END) AS avg_ext_price_1_20,\n    AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_net_profit END) AS avg_net_profit_1_20,\n    AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_ext_sales_price END) AS avg_ext_price_21_40,\n    AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_net_profit END) AS avg_net_profit_21_40,\n    AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_ext_sales_price END) AS avg_ext_price_41_60,\n    AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_net_profit END) AS avg_net_profit_41_60,\n    AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_ext_sales_price END) AS avg_ext_price_61_80,\n    AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_net_profit END) AS avg_net_profit_61_80,\n    AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_ext_sales_price END) AS avg_ext_price_81_100,\n    AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_net_profit END) AS avg_net_profit_81_100\n  FROM store_sales\n) AS agg_avgs\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 6,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 75068,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.2138,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH store_sales_agg AS (\n  SELECT\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END AS bucket,\n    COUNT(*) AS cnt,\n    SUM(ss_ext_sales_price) AS sum_ext_sales_price,\n    SUM(ss_net_profit) AS sum_net_profit,\n    COUNT(ss_ext_sales_price) AS cnt_ext_sales_price,\n    COUNT(ss_net_profit) AS cnt_net_profit\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 1 AND 100\n  GROUP BY\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END\n)\nSELECT\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    ) > 2972190\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    ) > 4505785\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    ) > 1575726\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    ) > 3188917\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    ) > 3525216\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 30370,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.0,
      "output_sql": "SELECT\n  CASE\n    WHEN (\n      SELECT\n        *\n      FROM subquery_1\n    ) > 2972190\n    THEN (\n      SELECT\n        *\n      FROM subquery_2\n    )\n    ELSE (\n      SELECT\n        *\n      FROM subquery_3\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        *\n      FROM subquery_4\n    ) > 4505785\n    THEN (\n      SELECT\n        *\n      FROM subquery_5\n    )\n    ELSE (\n      SELECT\n        *\n      FROM subquery_6\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        *\n      FROM subquery_7\n    ) > 1575726\n    THEN (\n      SELECT\n        *\n      FROM subquery_8\n    )\n    ELSE (\n      SELECT\n        *\n      FROM subquery_9\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        *\n      FROM subquery_10\n    ) > 3188917\n    THEN (\n      SELECT\n        *\n      FROM subquery_11\n    )\n    ELSE (\n      SELECT\n        *\n      FROM subquery_12\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        *\n      FROM subquery_13\n    ) > 3525216\n    THEN (\n      SELECT\n        *\n      FROM subquery_14\n    )\n    ELSE (\n      SELECT\n        *\n      FROM subquery_15\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 36352,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.3169,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.2,
      "output_sql": "WITH quantity_buckets AS (\n  SELECT\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n    END AS bucket,\n    ss_ext_sales_price,\n    ss_net_profit\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 1 AND 100\n), bucket_aggs AS (\n  SELECT\n    bucket,\n    COUNT(*) AS cnt,\n    AVG(ss_ext_sales_price) AS avg_ext_price,\n    AVG(ss_net_profit) AS avg_net_profit\n  FROM quantity_buckets\n  WHERE\n    NOT bucket IS NULL\n  GROUP BY\n    bucket\n)\nSELECT\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_aggs\n      WHERE\n        bucket = 1\n    ) > 2972190\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_aggs\n      WHERE\n        bucket = 1\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_aggs\n      WHERE\n        bucket = 1\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_aggs\n      WHERE\n        bucket = 2\n    ) > 4505785\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_aggs\n      WHERE\n        bucket = 2\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_aggs\n      WHERE\n        bucket = 2\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_aggs\n      WHERE\n        bucket = 3\n    ) > 1575726\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_aggs\n      WHERE\n        bucket = 3\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_aggs\n      WHERE\n        bucket = 3\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_aggs\n      WHERE\n        bucket = 4\n    ) > 3188917\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_aggs\n      WHERE\n        bucket = 4\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_aggs\n      WHERE\n        bucket = 4\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_aggs\n      WHERE\n        bucket = 5\n    ) > 3525216\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_aggs\n      WHERE\n        bucket = 5\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_aggs\n      WHERE\n        bucket = 5\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 34507,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1308,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 1.1308,
      "output_sql": "SELECT\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 1 AND 20\n    ) > 2972190\n    THEN (\n      SELECT\n        AVG(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 1 AND 20\n    )\n    ELSE (\n      SELECT\n        AVG(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 1 AND 20\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 21 AND 40\n    ) > 4505785\n    THEN (\n      SELECT\n        AVG(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 21 AND 40\n    )\n    ELSE (\n      SELECT\n        AVG(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 21 AND 40\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 41 AND 60\n    ) > 1575726\n    THEN (\n      SELECT\n        AVG(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 41 AND 60\n    )\n    ELSE (\n      SELECT\n        AVG(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 41 AND 60\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 61 AND 80\n    ) > 3188917\n    THEN (\n      SELECT\n        AVG(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 61 AND 80\n    )\n    ELSE (\n      SELECT\n        AVG(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 61 AND 80\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 81 AND 100\n    ) > 3525216\n    THEN (\n      SELECT\n        AVG(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 81 AND 100\n    )\n    ELSE (\n      SELECT\n        AVG(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 81 AND 100\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 10,
      "parent_path": [
        "inline_cte"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 40985,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  CASE\n    WHEN (\n      SELECT\n        count_1_20\n      FROM store_sales_aggregates\n    ) > 2972190\n    THEN (\n      SELECT\n        avg_ext_price_1_20\n      FROM store_sales_aggregates\n    )\n    ELSE (\n      SELECT\n        avg_net_profit_1_20\n      FROM store_sales_aggregates\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        count_21_40\n      FROM store_sales_aggregates\n    ) > 4505785\n    THEN (\n      SELECT\n        avg_ext_price_21_40\n      FROM store_sales_aggregates\n    )\n    ELSE (\n      SELECT\n        avg_net_profit_21_40\n      FROM store_sales_aggregates\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        count_41_60\n      FROM store_sales_aggregates\n    ) > 1575726\n    THEN (\n      SELECT\n        avg_ext_price_41_60\n      FROM store_sales_aggregates\n    )\n    ELSE (\n      SELECT\n        avg_net_profit_41_60\n      FROM store_sales_aggregates\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        count_61_80\n      FROM store_sales_aggregates\n    ) > 3188917\n    THEN (\n      SELECT\n        avg_ext_price_61_80\n      FROM store_sales_aggregates\n    )\n    ELSE (\n      SELECT\n        avg_net_profit_61_80\n      FROM store_sales_aggregates\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        count_81_100\n      FROM store_sales_aggregates\n    ) > 3525216\n    THEN (\n      SELECT\n        avg_ext_price_81_100\n      FROM store_sales_aggregates\n    )\n    ELSE (\n      SELECT\n        avg_net_profit_81_100\n      FROM store_sales_aggregates\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 11,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "multi_push_pred",
      "duration_ms": 121,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.3934,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.2,
      "output_sql": "WITH store_sales_agg AS (\n  SELECT\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END AS bucket,\n    COUNT(*) AS cnt,\n    SUM(ss_ext_sales_price) AS sum_ext_sales_price,\n    SUM(ss_net_profit) AS sum_net_profit,\n    COUNT(ss_ext_sales_price) AS cnt_ext_sales_price,\n    COUNT(ss_net_profit) AS cnt_net_profit\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 1 AND 100\n  GROUP BY\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END\n)\nSELECT\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    ) > 2972190\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    ) > 4505785\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    ) > 1575726\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    ) > 3188917\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    ) > 3525216\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 12,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 41225,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.3282,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH store_sales_agg AS (\n  SELECT\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n    END AS bucket,\n    COUNT(*) AS cnt,\n    SUM(ss_ext_sales_price) AS sum_ext_sales_price,\n    SUM(ss_net_profit) AS sum_net_profit,\n    COUNT(ss_ext_sales_price) AS cnt_ext_sales_price,\n    COUNT(ss_net_profit) AS cnt_net_profit\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 1 AND 100\n  GROUP BY\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n    END\n)\nSELECT\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    ) > 2972190\n    THEN (\n      SELECT\n        sum_ext_sales_price / NULLIF(cnt_ext_sales_price, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / NULLIF(cnt_net_profit, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    ) > 4505785\n    THEN (\n      SELECT\n        sum_ext_sales_price / NULLIF(cnt_ext_sales_price, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / NULLIF(cnt_net_profit, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    ) > 1575726\n    THEN (\n      SELECT\n        sum_ext_sales_price / NULLIF(cnt_ext_sales_price, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / NULLIF(cnt_net_profit, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    ) > 3188917\n    THEN (\n      SELECT\n        sum_ext_sales_price / NULLIF(cnt_ext_sales_price, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / NULLIF(cnt_net_profit, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    ) > 3525216\n    THEN (\n      SELECT\n        sum_ext_sales_price / NULLIF(cnt_ext_sales_price, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / NULLIF(cnt_net_profit, 0)\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 13,
      "parent_path": [
        "materialize_cte"
      ],
      "transform_id": "date_cte_isolate",
      "duration_ms": 48826,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year = 2001 AND d_qoy = 1\n)\nSELECT\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_1_20\n      JOIN filtered_dates\n        ON bucket_1_20.d_date_sk = filtered_dates.d_date_sk\n    ) > 2972190\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_1_20\n      JOIN filtered_dates\n        ON bucket_1_20.d_date_sk = filtered_dates.d_date_sk\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_1_20\n      JOIN filtered_dates\n        ON bucket_1_20.d_date_sk = filtered_dates.d_date_sk\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_21_40\n      JOIN filtered_dates\n        ON bucket_21_40.d_date_sk = filtered_dates.d_date_sk\n    ) > 4505785\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_21_40\n      JOIN filtered_dates\n        ON bucket_21_40.d_date_sk = filtered_dates.d_date_sk\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_21_40\n      JOIN filtered_dates\n        ON bucket_21_40.d_date_sk = filtered_dates.d_date_sk\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_41_60\n      JOIN filtered_dates\n        ON bucket_41_60.d_date_sk = filtered_dates.d_date_sk\n    ) > 1575726\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_41_60\n      JOIN filtered_dates\n        ON bucket_41_60.d_date_sk = filtered_dates.d_date_sk\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_41_60\n      JOIN filtered_dates\n        ON bucket_41_60.d_date_sk = filtered_dates.d_date_sk\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_61_80\n      JOIN filtered_dates\n        ON bucket_61_80.d_date_sk = filtered_dates.d_date_sk\n    ) > 3188917\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_61_80\n      JOIN filtered_dates\n        ON bucket_61_80.d_date_sk = filtered_dates.d_date_sk\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_61_80\n      JOIN filtered_dates\n        ON bucket_61_80.d_date_sk = filtered_dates.d_date_sk\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM bucket_81_100\n      JOIN filtered_dates\n        ON bucket_81_100.d_date_sk = filtered_dates.d_date_sk\n    ) > 3525216\n    THEN (\n      SELECT\n        avg_ext_price\n      FROM bucket_81_100\n      JOIN filtered_dates\n        ON bucket_81_100.d_date_sk = filtered_dates.d_date_sk\n    )\n    ELSE (\n      SELECT\n        avg_net_profit\n      FROM bucket_81_100\n      JOIN filtered_dates\n        ON bucket_81_100.d_date_sk = filtered_dates.d_date_sk\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 14,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 117184,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0635,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.5,
      "output_sql": "WITH store_sales_agg AS (\n  SELECT\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END AS bucket,\n    COUNT(*) AS cnt,\n    SUM(ss_ext_sales_price) AS sum_ext_sales_price,\n    SUM(ss_net_profit) AS sum_net_profit,\n    COUNT(ss_ext_sales_price) AS cnt_ext_sales_price,\n    COUNT(ss_net_profit) AS cnt_net_profit\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 1 AND 100\n  GROUP BY\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END\n)\nSELECT\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*) AS cnt\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 1 AND 20\n    ) > 2972190\n    THEN (\n      SELECT\n        SUM(ss_ext_sales_price) / COUNT(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 1 AND 20\n    )\n    ELSE (\n      SELECT\n        SUM(ss_net_profit) / COUNT(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 1 AND 20\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*) AS cnt\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 21 AND 40\n    ) > 4505785\n    THEN (\n      SELECT\n        SUM(ss_ext_sales_price) / COUNT(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 21 AND 40\n    )\n    ELSE (\n      SELECT\n        SUM(ss_net_profit) / COUNT(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 21 AND 40\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*) AS cnt\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 41 AND 60\n    ) > 1575726\n    THEN (\n      SELECT\n        SUM(ss_ext_sales_price) / COUNT(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 41 AND 60\n    )\n    ELSE (\n      SELECT\n        SUM(ss_net_profit) / COUNT(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 41 AND 60\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*) AS cnt\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 61 AND 80\n    ) > 3188917\n    THEN (\n      SELECT\n        SUM(ss_ext_sales_price) / COUNT(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 61 AND 80\n    )\n    ELSE (\n      SELECT\n        SUM(ss_net_profit) / COUNT(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 61 AND 80\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        COUNT(*) AS cnt\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 81 AND 100\n    ) > 3525216\n    THEN (\n      SELECT\n        SUM(ss_ext_sales_price) / COUNT(ss_ext_sales_price)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 81 AND 100\n    )\n    ELSE (\n      SELECT\n        SUM(ss_net_profit) / COUNT(ss_net_profit)\n      FROM store_sales\n      WHERE\n        ss_quantity BETWEEN 81 AND 100\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 15,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 53357,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7894,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 14,
      "reward": 0.2,
      "output_sql": "select case when (select count(*) \n                  from store_sales \n                  where ss_quantity between 1 and 20) > 2972190\n            then (select avg(ss_ext_sales_price) \n                  from store_sales \n                  where ss_quantity between 1 and 20) \n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 1 and 20) end bucket1 ,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 21 and 40) > 4505785\n            then (select avg(ss_ext_sales_price)\n                  from store_sales\n                  where ss_quantity between 21 and 40) \n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 21 and 40) end bucket2,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 41 and 60) > 1575726\n            then (select avg(ss_ext_sales_price)\n                  from store_sales\n                  where ss_quantity between 41 and 60)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 41 and 60) end bucket3,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 61 and 80) > 3188917\n            then (select avg(ss_ext_sales_price)\n                  from store_sales\n                  where ss_quantity between 61 and 80)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 61 and 80) end bucket4,\n       case when (select count(*)\n                  from store_sales\n                  where ss_quantity between 81 and 100) > 3525216\n            then (select avg(ss_ext_sales_price)\n                  from store_sales\n                  where ss_quantity between 81 and 100)\n            else (select avg(ss_net_profit)\n                  from store_sales\n                  where ss_quantity between 81 and 100) end bucket5\nfrom reason\nwhere r_reason_sk = 1"
    },
    {
      "iteration": 16,
      "parent_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "transform_id": "materialize_cte",
      "duration_ms": 46315,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.2936,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH store_sales_agg AS (\n  SELECT\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END AS bucket,\n    COUNT(*) AS cnt,\n    SUM(ss_ext_sales_price) AS sum_ext_sales_price,\n    SUM(ss_net_profit) AS sum_net_profit,\n    COUNT(ss_ext_sales_price) AS cnt_ext_sales_price,\n    COUNT(ss_net_profit) AS cnt_net_profit\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 1 AND 100\n  GROUP BY\n    CASE\n      WHEN ss_quantity BETWEEN 1 AND 20\n      THEN 1\n      WHEN ss_quantity BETWEEN 21 AND 40\n      THEN 2\n      WHEN ss_quantity BETWEEN 41 AND 60\n      THEN 3\n      WHEN ss_quantity BETWEEN 61 AND 80\n      THEN 4\n      WHEN ss_quantity BETWEEN 81 AND 100\n      THEN 5\n      ELSE 0\n    END\n)\nSELECT\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    ) > 2972190\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 1\n    )\n  END AS bucket1,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    ) > 4505785\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 2\n    )\n  END AS bucket2,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    ) > 1575726\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 3\n    )\n  END AS bucket3,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    ) > 3188917\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 4\n    )\n  END AS bucket4,\n  CASE\n    WHEN (\n      SELECT\n        cnt\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    ) > 3525216\n    THEN (\n      SELECT\n        sum_ext_sales_price / cnt_ext_sales_price\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n    ELSE (\n      SELECT\n        sum_net_profit / cnt_net_profit\n      FROM store_sales_agg\n      WHERE\n        bucket = 5\n    )\n  END AS bucket5\nFROM reason\nWHERE\n  r_reason_sk = 1"
    },
    {
      "iteration": 17,
      "parent_path": [
        "flatten_subq"
      ],
      "transform_id": "push_pred",
      "duration_ms": 80345,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.4095,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  CASE\n    WHEN agg_counts.count_1_20 > 2972190\n    THEN agg_avgs.avg_ext_price_1_20\n    ELSE agg_avgs.avg_net_profit_1_20\n  END AS bucket1,\n  CASE\n    WHEN agg_counts.count_21_40 > 4505785\n    THEN agg_avgs.avg_ext_price_21_40\n    ELSE agg_avgs.avg_net_profit_21_40\n  END AS bucket2,\n  CASE\n    WHEN agg_counts.count_41_60 > 1575726\n    THEN agg_avgs.avg_ext_price_41_60\n    ELSE agg_avgs.avg_net_profit_41_60\n  END AS bucket3,\n  CASE\n    WHEN agg_counts.count_61_80 > 3188917\n    THEN agg_avgs.avg_ext_price_61_80\n    ELSE agg_avgs.avg_net_profit_61_80\n  END AS bucket4,\n  CASE\n    WHEN agg_counts.count_81_100 > 3525216\n    THEN agg_avgs.avg_ext_price_81_100\n    ELSE agg_avgs.avg_net_profit_81_100\n  END AS bucket5\nFROM (\n  SELECT *\n  FROM reason\n  WHERE r_reason_sk = 1\n) AS reason\nCROSS JOIN (\n  SELECT\n    COUNT(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN 1 END) AS count_1_20,\n    COUNT(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN 1 END) AS count_21_40,\n    COUNT(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN 1 END) AS count_41_60,\n    COUNT(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN 1 END) AS count_61_80,\n    COUNT(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN 1 END) AS count_81_100\n  FROM store_sales\n) AS agg_counts\nCROSS JOIN (\n  SELECT\n    AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_ext_sales_price END) AS avg_ext_price_1_20,\n    AVG(CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN ss_net_profit END) AS avg_net_profit_1_20,\n    AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_ext_sales_price END) AS avg_ext_price_21_40,\n    AVG(CASE WHEN ss_quantity BETWEEN 21 AND 40 THEN ss_net_profit END) AS avg_net_profit_21_40,\n    AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_ext_sales_price END) AS avg_ext_price_41_60,\n    AVG(CASE WHEN ss_quantity BETWEEN 41 AND 60 THEN ss_net_profit END) AS avg_net_profit_41_60,\n    AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_ext_sales_price END) AS avg_ext_price_61_80,\n    AVG(CASE WHEN ss_quantity BETWEEN 61 AND 80 THEN ss_net_profit END) AS avg_net_profit_61_80,\n    AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_ext_sales_price END) AS avg_ext_price_81_100,\n    AVG(CASE WHEN ss_quantity BETWEEN 81 AND 100 THEN ss_net_profit END) AS avg_net_profit_81_100\n  FROM store_sales\n) AS agg_avgs"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5167,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5236,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.695,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6732,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8062,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.559,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5354,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9826,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7449,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2646,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7715,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7646,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6614,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8173,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7828,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3169,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.86,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3162,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.75,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.1808,
          "visits": 1,
          "avg_reward": 1.1308,
          "is_valid": true,
          "speedup": 1.1308,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3169,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1106,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7906,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6006,
          "visits": 2,
          "avg_reward": 0.5654,
          "is_valid": true,
          "speedup": 1.1308,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3317,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4743,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3169,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.6633,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9379,
          "visits": 2,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3414,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2138,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8317,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4975,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6023,
          "visits": 2,
          "avg_reward": 0.5654,
          "is_valid": true,
          "speedup": 1.1308,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8292,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1155,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3169,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1155,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7804,
          "visits": 3,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6964,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7211,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.866,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6809,
          "visits": 2,
          "avg_reward": 0.5654,
          "is_valid": true,
          "speedup": 1.1308,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2577,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0577,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1202,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2577,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3169,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1202,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8062,
          "visits": 3,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5904,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3742,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6009,
          "visits": 2,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6055,
          "visits": 2,
          "avg_reward": 0.5654,
          "is_valid": true,
          "speedup": 1.1308,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0601,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0601,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2601,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3169,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.831,
          "visits": 3,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3732,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2138,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3732,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3934,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9736,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.1619,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2494,
          "visits": 2,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6901,
          "visits": 2,
          "avg_reward": 0.5654,
          "is_valid": true,
          "speedup": 1.1308,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2624,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0624,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1291,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0624,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2624,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3169,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1291,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7988,
          "visits": 4,
          "avg_reward": 0.275,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7373,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5873,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7894,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6455,
          "visits": 2,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6945,
          "visits": 2,
          "avg_reward": 0.5654,
          "is_valid": true,
          "speedup": 1.1308,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2645,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0645,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0645,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2645,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3169,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8172,
          "visits": 4,
          "avg_reward": 0.275,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0635,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2138,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3934,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6167,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0211,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7894,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6667,
          "visits": 2,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6099,
          "visits": 2,
          "avg_reward": 0.5654,
          "is_valid": true,
          "speedup": 1.1308,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5304,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0667,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1374,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0667,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2667,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3169,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1374,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7267,
          "visits": 5,
          "avg_reward": 0.26,
          "is_valid": true,
          "speedup": 0.2937,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "flatten_subq"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 17,
    "avg_reward": 0.2312,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.35,
        "is_valid": true,
        "speedup": 1.0211,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "push_pred",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.3282,
            "error": null
          }
        }
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 5,
        "avg_reward": 0.26,
        "is_valid": true,
        "speedup": 0.2937,
        "error": null,
        "children": {
          "reorder_join": {
            "transforms": [
              "consolidate_scans",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.2138,
            "error": null
          },
          "multi_push_pred": {
            "transforms": [
              "consolidate_scans",
              "multi_push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.3934,
            "error": null
          },
          "push_pred": {
            "transforms": [
              "consolidate_scans",
              "push_pred"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.35,
            "is_valid": true,
            "speedup": 1.0635,
            "error": null,
            "children": {
              "materialize_cte": {
                "transforms": [
                  "consolidate_scans",
                  "push_pred",
                  "materialize_cte"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.2936,
                "error": null
              }
            }
          }
        }
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null,
        "children": {
          "date_cte_isolate": {
            "transforms": [
              "materialize_cte",
              "date_cte_isolate"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.5304,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "flatten_subq",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.4095,
            "error": null
          }
        }
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.3169,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.5654,
        "is_valid": true,
        "speedup": 1.1308,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "inline_cte",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.7894,
        "error": null
      }
    }
  }
}