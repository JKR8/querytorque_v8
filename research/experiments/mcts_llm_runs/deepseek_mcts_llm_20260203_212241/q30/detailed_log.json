{
  "stats": {
    "total_iterations": 16,
    "tree_size": 17,
    "successful_expansions": 16,
    "failed_expansions": 0,
    "validation_calls": 16,
    "llm_ranking_calls": 21,
    "root_visits": 16,
    "total_attempts": 16
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 28667,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0344,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.5,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year = 2002\n), customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, filtered_dates, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > (\n    SELECT\n      AVG(ctr_total_return) * 1.2\n    FROM customer_total_return AS ctr2\n    WHERE\n      ctr1.ctr_state = ctr2.ctr_state\n  )\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 25089,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1275,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1275,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n), state_avg_return AS (\n  SELECT\n    ctr_state,\n    AVG(ctr_total_return) * 1.2 AS state_avg_threshold\n  FROM customer_total_return\n  GROUP BY\n    ctr_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer, state_avg_return AS sar\nWHERE\n  ctr1.ctr_total_return > sar.state_avg_threshold\n  AND ctr1.ctr_state = sar.ctr_state\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 27042,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 0.8979,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.0,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return,\n    AVG(SUM(wr_return_amt)) OVER (PARTITION BY ca_state) * 1.2 AS ctr_state_avg_1_2\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > ctr1.ctr_state_avg_1_2\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 78199,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.5775,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.0,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n    AND ca_state = 'IN'\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > (\n    SELECT\n      AVG(ctr_total_return) * 1.2\n    FROM customer_total_return AS ctr2\n    WHERE\n      ctr1.ctr_state = ctr2.ctr_state\n  )\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 64579,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 0.9317,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "WITH branch1_cte AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n    AND ca_state = 'IN'\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n), branch2_cte AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n    AND ca_state = 'OH'\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n), customer_total_return AS (\n  SELECT\n    *\n  FROM branch1_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch2_cte\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > (\n    SELECT\n      AVG(ctr_total_return) * 1.2\n    FROM customer_total_return AS ctr2\n    WHERE\n      ctr1.ctr_state = ctr2.ctr_state\n  )\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 30462,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.985,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.2,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM date_dim, customer_address, web_returns\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_address, customer, customer_total_return AS ctr1\nWHERE\n  ctr1.ctr_total_return > (\n    SELECT\n      AVG(ctr_total_return) * 1.2\n    FROM customer_total_return AS ctr2\n    WHERE\n      ctr1.ctr_state = ctr2.ctr_state\n  )\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 49728,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 0.9465,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.0,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return,\n    COUNT(CASE WHEN ca_state = 'IN' THEN wr_return_amt END) AS ctr_count_in_state\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > (\n    SELECT\n      AVG(ctr_total_return) * 1.2\n    FROM customer_total_return AS ctr2\n    WHERE\n      ctr1.ctr_state = ctr2.ctr_state\n  )\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\n  AND ctr1.ctr_count_in_state > 0\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 24288,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.345,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 1.345,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n), state_avg_return AS (\n  SELECT\n    ctr_state,\n    AVG(ctr_total_return) * 1.2 AS state_avg_threshold\n  FROM customer_total_return\n  GROUP BY\n    ctr_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer, state_avg_return AS sar\nWHERE\n  ctr1.ctr_total_return > sar.state_avg_threshold\n  AND ctr1.ctr_state = sar.ctr_state\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 51745,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.0,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n    AND ca_state = 'IN'\n    AND wr_returning_customer_sk = c_customer_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > (\n    SELECT\n      AVG(ctr_total_return) * 1.2\n    FROM customer_total_return AS ctr2\n    WHERE\n      ctr1.ctr_state = ctr2.ctr_state\n  )\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 46188,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9712,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.2,
      "output_sql": "SELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n) AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > (\n    SELECT\n      AVG(ctr_total_return) * 1.2\n    FROM (\n      SELECT\n        wr_returning_customer_sk AS ctr_customer_sk,\n        ca_state AS ctr_state,\n        SUM(wr_return_amt) AS ctr_total_return\n      FROM web_returns, date_dim, customer_address\n      WHERE\n        wr_returned_date_sk = d_date_sk\n        AND d_year = 2002\n        AND wr_returning_addr_sk = ca_address_sk\n      GROUP BY\n        wr_returning_customer_sk,\n        ca_state\n    ) AS ctr2\n    WHERE\n      ctr1.ctr_state = ctr2.ctr_state\n  )\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 22550,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0376,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.5,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > (\n    SELECT\n      AVG(ctr_total_return) * 1.2\n    FROM customer_total_return AS ctr2\n    WHERE\n      ctr1.ctr_state = ctr2.ctr_state\n  )\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "materialize_cte"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 44137,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.1412,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return,\n    AVG(SUM(wr_return_amt)) OVER (PARTITION BY ca_state) * 1.2 AS state_avg_threshold\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > ctr1.state_avg_threshold\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "correlated_to_cte"
      ],
      "transform_id": "push_pred",
      "duration_ms": 34253,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.2963,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n    AND ca_state = 'IN'\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n), state_avg_return AS (\n  SELECT\n    ctr_state,\n    AVG(ctr_total_return) * 1.2 AS state_avg_threshold\n  FROM customer_total_return\n  GROUP BY\n    ctr_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer, state_avg_return AS sar\nWHERE\n  ctr1.ctr_total_return > sar.state_avg_threshold\n  AND ctr1.ctr_state = sar.ctr_state\n  AND ca_address_sk = c_current_addr_sk\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "materialize_cte"
      ],
      "transform_id": "push_pred",
      "duration_ms": 64476,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.2978,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.0,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n    AND ca_state = 'IN'\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n), state_avg_return AS (\n  SELECT\n    ctr_state,\n    AVG(ctr_total_return) * 1.2 AS state_avg_threshold\n  FROM customer_total_return\n  GROUP BY\n    ctr_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer, state_avg_return AS sar\nWHERE\n  ctr1.ctr_total_return > sar.state_avg_threshold\n  AND ctr1.ctr_state = sar.ctr_state\n  AND ca_address_sk = c_current_addr_sk\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 15,
      "parent_path": [
        "date_cte_isolate"
      ],
      "transform_id": "correlated_to_cte",
      "duration_ms": 25574,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1891,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1891,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year = 2002\n), customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return\n  FROM web_returns, filtered_dates, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk AND wr_returning_addr_sk = ca_address_sk\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n), state_avg_threshold AS (\n  SELECT\n    ctr_state,\n    AVG(ctr_total_return) * 1.2 AS avg_threshold\n  FROM customer_total_return\n  GROUP BY\n    ctr_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer, state_avg_threshold\nWHERE\n  ctr1.ctr_total_return > state_avg_threshold.avg_threshold\n  AND ctr1.ctr_state = state_avg_threshold.ctr_state\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    },
    {
      "iteration": 16,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 33286,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.0336,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH customer_total_return AS (\n  SELECT\n    wr_returning_customer_sk AS ctr_customer_sk,\n    ca_state AS ctr_state,\n    SUM(wr_return_amt) AS ctr_total_return,\n    COUNT(CASE WHEN ca_state = 'IN' THEN wr_return_amt END) AS ctr_count_in_state\n  FROM web_returns, date_dim, customer_address\n  WHERE\n    wr_returned_date_sk = d_date_sk\n    AND d_year = 2002\n    AND wr_returning_addr_sk = ca_address_sk\n    AND ca_state = 'IN'\n  GROUP BY\n    wr_returning_customer_sk,\n    ca_state\n)\nSELECT\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nFROM customer_total_return AS ctr1, customer_address, customer\nWHERE\n  ctr1.ctr_total_return > (\n    SELECT\n      AVG(ctr_total_return) * 1.2\n    FROM customer_total_return AS ctr2\n    WHERE\n      ctr1.ctr_state = ctr2.ctr_state AND ctr2.ctr_state = 'IN'\n  )\n  AND ca_address_sk = c_current_addr_sk\n  AND ca_state = 'IN'\n  AND ctr1.ctr_customer_sk = c_customer_sk\n  AND ctr1.ctr_count_in_state > 0\nORDER BY\n  c_customer_id,\n  c_salutation,\n  c_first_name,\n  c_last_name,\n  c_preferred_cust_flag,\n  c_birth_day,\n  c_birth_month,\n  c_birth_year,\n  c_birth_country,\n  c_login,\n  c_email_address,\n  c_last_review_date_sk,\n  ctr_total_return\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5167,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1511,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5236,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1564,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5289,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1608,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1648,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1225,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1683,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2646,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3323,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1716,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9465,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3414,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.3922,
          "visits": 1,
          "avg_reward": 1.345,
          "is_valid": true,
          "speedup": 1.345,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1747,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9465,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.45,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.495,
          "visits": 1,
          "avg_reward": 1.345,
          "is_valid": true,
          "speedup": 1.345,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1775,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9465,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7906,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6743,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.6613,
          "visits": 1,
          "avg_reward": 1.345,
          "is_valid": true,
          "speedup": 1.345,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3581,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9712,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1802,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9465,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.429,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9465
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.6466,
          "visits": 1,
          "avg_reward": 1.345,
          "is_valid": true,
          "speedup": 1.345
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9712
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0376
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.4424,
          "visits": 1,
          "avg_reward": 1.1275,
          "is_valid": true,
          "speedup": 1.1275
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9465
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8825,
          "visits": 2,
          "avg_reward": 0.6725,
          "is_valid": true,
          "speedup": 1.345
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9712
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0376
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "correlated_to_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7823,
          "visits": 2,
          "avg_reward": 0.5638,
          "is_valid": true,
          "speedup": 1.1275
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9465
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.891,
          "visits": 2,
          "avg_reward": 0.6725,
          "is_valid": true,
          "speedup": 1.345
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9712
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0376
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1414,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.1412,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0344
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7905,
          "visits": 2,
          "avg_reward": 0.5638,
          "is_valid": true,
          "speedup": 1.1275
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9465
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6184,
          "visits": 3,
          "avg_reward": 0.4483,
          "is_valid": true,
          "speedup": 1.345
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9712
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0376
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "date_cte_isolate"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8876,
          "visits": 2,
          "avg_reward": 0.8445,
          "is_valid": true,
          "speedup": 1.0344
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.6068,
          "visits": 2,
          "avg_reward": 0.5638,
          "is_valid": true,
          "speedup": 1.1275
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0645,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.8979
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.3873,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.5775
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5809,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9317
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3936,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.985
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.3555,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.9465
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.9325,
          "visits": 3,
          "avg_reward": 0.4483,
          "is_valid": true,
          "speedup": 1.345
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0645,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2645,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9712
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5645,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0376
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 16,
    "avg_reward": 0.3164,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.8445,
        "is_valid": true,
        "speedup": 1.0344,
        "error": null,
        "children": {
          "correlated_to_cte": {
            "transforms": [
              "date_cte_isolate",
              "correlated_to_cte"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 1.1891,
            "is_valid": true,
            "speedup": 1.1891,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.5638,
        "is_valid": true,
        "speedup": 1.1275,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "correlated_to_cte",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 1.2963,
            "error": null
          }
        }
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0.8979,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 1.5775,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0.9317,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.985,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0.9465,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "consolidate_scans",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 1.0336,
            "error": null
          }
        }
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 3,
        "avg_reward": 0.4483,
        "is_valid": true,
        "speedup": 1.345,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "materialize_cte",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 1.1412,
            "error": null
          },
          "push_pred": {
            "transforms": [
              "materialize_cte",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 1.2978,
            "error": null
          }
        }
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9712,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0376,
        "error": null
      }
    }
  }
}