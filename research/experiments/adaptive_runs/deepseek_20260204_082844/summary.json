{
  "timestamp": "20260204_082844",
  "provider": "deepseek",
  "model": "adaptive_rewriter",
  "max_iterations": 5,
  "target_speedup": 2.0,
  "sample_db": "/mnt/d/TPC-DS/tpcds_sf100_sampled_1pct.duckdb",
  "full_db": "/mnt/d/TPC-DS/tpcds_sf100.duckdb",
  "queries": [
    1,
    2,
    3,
    4,
    5,
    6,
    7,
    8,
    9,
    10
  ],
  "total_time_minutes": 32.16384645,
  "passed": 6,
  "failed": 2,
  "errors": 0,
  "no_improvement": 2,
  "avg_speedup": 1.5042710902777097,
  "results": [
    {
      "query": 1,
      "status": "pass",
      "sample_speedup": 1.3200390317880943,
      "full_speedup": 2.6687008963285908,
      "original_ms": 255.72221166718614,
      "optimized_ms": 95.82273233354499,
      "attempts": 6,
      "successful_attempts": 6,
      "elapsed_s": 150.61259031295776,
      "rewrites": {
        "nodes": [
          "customer_total_return",
          "store_avg_return",
          "main_query"
        ]
      },
      "attempt_history": [
        {
          "num": 1,
          "strategy": "decorrelate",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "customer_total_return",
            "store_avg_return",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.2182238018751295
        },
        {
          "num": 2,
          "strategy": "decorrelate",
          "changes": [
            "customer_total_return output columns unchanged",
            "main_query output columns unchanged",
            "same result rows and ordering",
            "same grouping and aggregation semantics"
          ],
          "nodes_rewritten": [
            "customer_total_return",
            "store_avg_return",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.2417145639514724
        },
        {
          "num": 3,
          "strategy": "decorrelate",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation semantics"
          ],
          "nodes_rewritten": [
            "customer_total_return",
            "store_avg_return",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.2245102892183777
        },
        {
          "num": 4,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation semantics"
          ],
          "nodes_rewritten": [
            "customer_total_return_sd",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.0630289890986107
        },
        {
          "num": 5,
          "strategy": "decorrelate",
          "changes": [
            "output_columns",
            "grain",
            "required_predicates",
            "correlation logic preserved via join"
          ],
          "nodes_rewritten": [
            "customer_total_return",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.1848208110714888
        },
        {
          "num": 6,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation",
            "customer_total_return output columns unchanged",
            "store_avg_return output columns unchanged"
          ],
          "nodes_rewritten": [
            "customer_total_return",
            "store_avg_return",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.3200390317880943
        }
      ]
    },
    {
      "query": 2,
      "status": "pass",
      "sample_speedup": 1.015671479908695,
      "full_speedup": 1.001227143704111,
      "original_ms": 1052.4474416667242,
      "optimized_ms": 1051.1575203336179,
      "attempts": 6,
      "successful_attempts": 2,
      "elapsed_s": 178.6751856803894,
      "rewrites": {
        "nodes": [
          "wswscs"
        ]
      },
      "attempt_history": [
        {
          "num": 1,
          "strategy": "pushdown",
          "changes": [
            "output columns unchanged",
            "grain unchanged (d_week_seq)",
            "required predicate (d_date_sk = sold_date_sk) preserved",
            "main_query semantics preserved"
          ],
          "nodes_rewritten": [
            "wswscs"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 2,
          "strategy": "early_filter",
          "changes": [
            "same result rows",
            "same output columns",
            "same grain (d_week_seq)",
            "same aggregation logic"
          ],
          "nodes_rewritten": [
            "filtered_dates_1998",
            "filtered_dates_1999",
            "wscs",
            "wswscs_1998",
            "wswscs_1999",
            "main_query"
          ],
          "result": "invalid",
          "speedup": 0.0
        },
        {
          "num": 3,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same aggregation logic",
            "same output columns",
            "same grain (d_week_seq)"
          ],
          "nodes_rewritten": [
            "wswscs"
          ],
          "result": "success",
          "speedup": 1.0134085448730576
        },
        {
          "num": 4,
          "strategy": "early_filter",
          "changes": [
            "same result rows",
            "same output columns",
            "same grain (d_week_seq)",
            "same aggregation logic"
          ],
          "nodes_rewritten": [
            "wscs",
            "wswscs_1998",
            "wswscs_1999",
            "main_query"
          ],
          "result": "invalid",
          "speedup": 0.0
        },
        {
          "num": 5,
          "strategy": "pushdown",
          "changes": [
            "output_columns",
            "grain",
            "required_predicates"
          ],
          "nodes_rewritten": [
            "wswscs"
          ],
          "result": "success",
          "speedup": 1.015671479908695
        },
        {
          "num": 6,
          "strategy": "pushdown",
          "changes": [
            "output columns unchanged",
            "grain unchanged (d_week_seq)",
            "required predicate (d_date_sk = sold_date_sk) preserved",
            "same aggregation logic"
          ],
          "nodes_rewritten": [
            "wswscs"
          ],
          "result": "no_change",
          "speedup": 1.0
        }
      ]
    },
    {
      "query": 3,
      "status": "no_improvement",
      "sample_speedup": 1.0,
      "attempts": 3,
      "elapsed_s": 18.454076051712036,
      "attempt_history": [
        {
          "num": 1,
          "strategy": "early_filter",
          "changes": [
            "same result rows",
            "same output columns",
            "same grouping and aggregation",
            "same ordering and limit"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "filtered_sales",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0,
          "error": "Query is 0.00x slower"
        },
        {
          "num": 2,
          "strategy": "early_filter",
          "changes": [
            "same result rows",
            "same output columns",
            "same grouping and aggregation",
            "same ordering and limit"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "filtered_items",
            "filtered_sales",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0,
          "error": "Speedup 0.82x < 1.0x minimum"
        },
        {
          "num": 3,
          "strategy": "early_filter",
          "changes": [
            "same result rows",
            "same output columns",
            "same grouping and aggregation",
            "same ordering and limit"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "filtered_items",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0,
          "error": "Speedup 0.95x < 1.0x minimum"
        }
      ]
    },
    {
      "query": 4,
      "status": "regression",
      "sample_speedup": 1.0716981300116535,
      "full_speedup": 0.9772563213547834,
      "original_ms": 10591.520847666592,
      "optimized_ms": 10838.01722866671,
      "attempts": 6,
      "successful_attempts": 4,
      "elapsed_s": 304.9490752220154,
      "rewrites": {
        "nodes": [
          "year_total",
          "main_query"
        ]
      },
      "attempt_history": [
        {
          "num": 1,
          "strategy": "pushdown",
          "changes": [
            "year_total output columns unchanged",
            "year_total grain unchanged",
            "main_query semantics preserved",
            "required_predicates preserved"
          ],
          "nodes_rewritten": [
            "year_total"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 2,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same output columns",
            "same grain",
            "required_predicates preserved"
          ],
          "nodes_rewritten": [
            "year_total"
          ],
          "result": "success",
          "speedup": 1.010577711647842
        },
        {
          "num": 3,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same output columns",
            "same grain",
            "required_predicates preserved"
          ],
          "nodes_rewritten": [
            "year_total"
          ],
          "result": "success",
          "speedup": 1.012034630108643
        },
        {
          "num": 4,
          "strategy": "semantic_rewrite",
          "changes": [
            "same result rows",
            "same output columns",
            "same grain",
            "required_predicates preserved"
          ],
          "nodes_rewritten": [
            "year_total",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.0716981300116535
        },
        {
          "num": 5,
          "strategy": "pushdown",
          "changes": [
            "Output columns unchanged",
            "Grain unchanged",
            "All required predicates preserved",
            "Union structure preserved"
          ],
          "nodes_rewritten": [
            "year_total"
          ],
          "result": "success",
          "speedup": 1.0181686157333067
        },
        {
          "num": 6,
          "strategy": "semantic_rewrite",
          "changes": [
            "same result rows",
            "same output columns",
            "same grain",
            "required_predicates preserved"
          ],
          "nodes_rewritten": [
            "year_total",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        }
      ]
    },
    {
      "query": 5,
      "status": "regression",
      "sample_speedup": 1.0407353566338535,
      "full_speedup": 0.9982887134901667,
      "original_ms": 1285.8501003332397,
      "optimized_ms": 1288.0543303326704,
      "attempts": 5,
      "successful_attempts": 1,
      "elapsed_s": 232.46483659744263,
      "rewrites": {
        "nodes": [
          "ssr",
          "csr"
        ]
      },
      "attempt_history": [
        {
          "num": 1,
          "strategy": "pushdown",
          "changes": [
            "ssr output columns unchanged",
            "csr output columns unchanged",
            "same grouping and aggregation",
            "same result rows"
          ],
          "nodes_rewritten": [
            "ssr",
            "csr"
          ],
          "result": "success",
          "speedup": 1.0407353566338535
        },
        {
          "num": 2,
          "strategy": "early_filter",
          "changes": [
            "same result rows",
            "same output columns",
            "same grouping semantics",
            "same date filter logic"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "ssr",
            "csr",
            "wsr",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 3,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same output columns",
            "same grouping semantics",
            "same date filter logic"
          ],
          "nodes_rewritten": [
            "ssr",
            "csr"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 4,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same output columns",
            "same grouping semantics",
            "same ordering",
            "same rollup behavior"
          ],
          "nodes_rewritten": [
            "ssr",
            "csr",
            "wsr",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 6,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same output columns",
            "same grouping and aggregation",
            "same date filter logic"
          ],
          "nodes_rewritten": [
            "ssr",
            "csr",
            "wsr"
          ],
          "result": "no_change",
          "speedup": 1.0
        }
      ]
    },
    {
      "query": 6,
      "status": "pass",
      "sample_speedup": 1.2564259829230124,
      "full_speedup": 1.1846683614902875,
      "original_ms": 366.37448399960704,
      "optimized_ms": 309.26333133326506,
      "attempts": 6,
      "successful_attempts": 4,
      "elapsed_s": 58.95470476150513,
      "rewrites": {
        "nodes": [
          "target_month",
          "category_avg_price",
          "filtered_dates",
          "filtered_sales",
          "main_query"
        ]
      },
      "attempt_history": [
        {
          "num": 1,
          "strategy": "decorrelate",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "target_month",
            "category_avg_price",
            "filtered_dates",
            "filtered_sales",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 2,
          "strategy": "decorrelate",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "target_month",
            "category_avg_price",
            "filtered_dates",
            "filtered_sales",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.2564259829230124
        },
        {
          "num": 3,
          "strategy": "decorrelate",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "target_month",
            "category_avg_prices",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.2315825366379411
        },
        {
          "num": 4,
          "strategy": "decorrelate",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "target_month",
            "category_avg_prices",
            "filtered_dates",
            "filtered_sales",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.168877137451001
        },
        {
          "num": 5,
          "strategy": "decorrelate",
          "changes": [
            "output_columns: state, cnt",
            "grain: ca_state",
            "required_predicates: i.i_current_price > 1.2 * avg price filter, d.d_month_seq = filtered month sequence, s.ss_item_sk = i.i_item_sk"
          ],
          "nodes_rewritten": [
            "main_query"
          ],
          "result": "success",
          "speedup": 1.2323910548248707
        },
        {
          "num": 6,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "category_avg_price",
            "filtered_dates",
            "main_query"
          ],
          "result": "invalid",
          "speedup": 0.0
        }
      ]
    },
    {
      "query": 7,
      "status": "pass",
      "sample_speedup": 1.0926014907271226,
      "full_speedup": 1.0001723268806035,
      "original_ms": 725.7576336666413,
      "optimized_ms": 725.6325876663444,
      "attempts": 6,
      "successful_attempts": 3,
      "elapsed_s": 67.39342546463013,
      "rewrites": {
        "nodes": [
          "filtered_promotions",
          "filtered_dates",
          "filtered_customer_demographics",
          "main_query"
        ]
      },
      "attempt_history": [
        {
          "num": 1,
          "strategy": "or_to_union",
          "changes": [
            "output columns unchanged",
            "same rows after aggregation",
            "same ordering",
            "same grouping"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "filtered_sales",
            "filtered_promotions_email",
            "filtered_promotions_event",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 2,
          "strategy": "early_filter",
          "changes": [
            "same result rows",
            "same output columns",
            "same grouping",
            "same ordering"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "filtered_sales",
            "filtered_customer_demographics",
            "filtered_promotions",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 3,
          "strategy": "early_filter",
          "changes": [
            "same result rows",
            "same output columns",
            "same aggregation",
            "same grouping"
          ],
          "nodes_rewritten": [
            "filtered_promotions",
            "filtered_dates",
            "filtered_customer_demographics",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.0926014907271226
        },
        {
          "num": 4,
          "strategy": "semantic_rewrite",
          "changes": [
            "same result rows",
            "same output columns",
            "same ordering",
            "same aggregation values"
          ],
          "nodes_rewritten": [
            "sales_aggregated",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.0513169381264944
        },
        {
          "num": 5,
          "strategy": "or_to_union",
          "changes": [
            "output_columns",
            "grain",
            "required_predicates",
            "semantic equivalence of OR condition"
          ],
          "nodes_rewritten": [
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 6,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same output columns",
            "same grouping and aggregation",
            "same ordering"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "filtered_promotions",
            "filtered_customer_demographics",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.0010474188088372
        }
      ]
    },
    {
      "query": 8,
      "status": "pass",
      "sample_speedup": 1.1308076447865736,
      "full_speedup": 1.0605298165115127,
      "original_ms": 763.9397406665012,
      "optimized_ms": 720.337824333304,
      "attempts": 6,
      "successful_attempts": 3,
      "elapsed_s": 345.7334065437317,
      "rewrites": {
        "nodes": [
          "filtered_dates",
          "zip_candidates",
          "preferred_customer_zips",
          "final_zips",
          "filtered_sales",
          "main_query"
        ]
      },
      "attempt_history": [
        {
          "num": 1,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "filtered_stores",
            "filtered_sales",
            "zip_subquery",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.0819435466837586
        },
        {
          "num": 2,
          "strategy": "semantic_rewrite",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "zip_candidates",
            "preferred_customer_zips",
            "final_zips",
            "filtered_sales",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.1308076447865736
        },
        {
          "num": 3,
          "strategy": "semantic_rewrite",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "zip_candidates",
            "preferred_customer_zips",
            "final_zips",
            "filtered_sales",
            "main_query"
          ],
          "result": "invalid",
          "speedup": 0.0
        },
        {
          "num": 4,
          "strategy": "semantic_rewrite",
          "changes": [
            "same result rows",
            "same column output",
            "same grouping and aggregation",
            "same ordering"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "zip_prefixes",
            "filtered_sales",
            "filtered_stores",
            "main_query"
          ],
          "result": "invalid",
          "speedup": 0.0
        },
        {
          "num": 5,
          "strategy": "pushdown",
          "changes": [
            "output_columns",
            "grain",
            "required_predicates",
            "join relationships"
          ],
          "nodes_rewritten": [
            "main_query"
          ],
          "result": "success",
          "speedup": 1.0088249119668926
        },
        {
          "num": 6,
          "strategy": "unknown",
          "changes": [],
          "nodes_rewritten": [],
          "result": "no_change",
          "speedup": 1.0
        }
      ]
    },
    {
      "query": 9,
      "status": "pass",
      "sample_speedup": 1.8382267593103903,
      "full_speedup": 2.110327996751152,
      "original_ms": 2623.0649386667815,
      "optimized_ms": 1242.9655213336446,
      "attempts": 5,
      "successful_attempts": 1,
      "elapsed_s": 180.2603678703308,
      "rewrites": {
        "nodes": [
          "quantity_range_1",
          "quantity_range_2",
          "quantity_range_3",
          "quantity_range_4",
          "quantity_range_5",
          "main_query"
        ]
      },
      "attempt_history": [
        {
          "num": 1,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same aggregation results",
            "same output columns"
          ],
          "nodes_rewritten": [
            "quantity_range_1",
            "quantity_range_2",
            "quantity_range_3",
            "quantity_range_4",
            "quantity_range_5",
            "main_query"
          ],
          "result": "success",
          "speedup": 1.8382267593103903
        },
        {
          "num": 2,
          "strategy": "semantic_rewrite",
          "changes": [
            "output columns unchanged",
            "same result rows",
            "same aggregation results",
            "required predicate r_reason_sk = 1 preserved"
          ],
          "nodes_rewritten": [
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 3,
          "strategy": "semantic_rewrite",
          "changes": [
            "same result rows",
            "same aggregation results",
            "same output columns",
            "required predicate r_reason_sk = 1 preserved"
          ],
          "nodes_rewritten": [
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 4,
          "strategy": "pushdown",
          "changes": [
            "same result rows",
            "same aggregation results",
            "same output columns",
            "required predicate r_reason_sk = 1 preserved"
          ],
          "nodes_rewritten": [
            "store_sales_aggregates",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        },
        {
          "num": 6,
          "strategy": "semantic_rewrite",
          "changes": [
            "same result rows",
            "same aggregation results",
            "same output columns",
            "required predicate r_reason_sk = 1 preserved"
          ],
          "nodes_rewritten": [
            "quantity_range_1",
            "quantity_range_2",
            "quantity_range_3",
            "quantity_range_4",
            "quantity_range_5",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0
        }
      ]
    },
    {
      "query": 10,
      "status": "no_improvement",
      "sample_speedup": 1.0,
      "attempts": 3,
      "elapsed_s": 150.75622415542603,
      "attempt_history": [
        {
          "num": 1,
          "strategy": "or_to_union",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "filtered_dates",
            "store_sales_customers",
            "web_sales_customers",
            "catalog_sales_customers",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0,
          "error": "Speedup 0.88x < 1.0x minimum"
        },
        {
          "num": 2,
          "strategy": "early_filter",
          "changes": [
            "same result rows",
            "same ordering",
            "same column output",
            "same grouping and aggregation"
          ],
          "nodes_rewritten": [
            "target_dates",
            "store_sales_customers",
            "web_sales_customers",
            "catalog_sales_customers",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0,
          "error": "Speedup 0.98x < 1.0x minimum"
        },
        {
          "num": 3,
          "strategy": "decorrelate",
          "changes": [
            "same result rows",
            "same aggregation",
            "same ordering"
          ],
          "nodes_rewritten": [
            "store_sales_customers",
            "web_sales_customers",
            "catalog_sales_customers",
            "main_query"
          ],
          "result": "regression",
          "speedup": 0.0,
          "error": "Speedup 0.97x < 1.0x minimum"
        }
      ]
    }
  ]
}