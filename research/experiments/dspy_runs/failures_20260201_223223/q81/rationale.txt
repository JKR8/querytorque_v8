[After 2 attempts] Used a different strategy: 1) Added `materialized` hint to the CTE to force DuckDB to compute and store the CTE result once, avoiding repeated scans of base tables in the subquery. 2) Reordered the FROM clause to start with `customer_address` and applied the `ca_state = 'CA'` filter immediately in the WHERE clause, reducing the rows joined early without altering the CTE's logic. This ensures the subquery still computes per-state averages correctly (using all states from the CTE) while the outer query efficiently filters to CA customers. This addresses the previous failure by not pushing the state filter into the CTE, and leverages DuckDB's materialization and join reordering.