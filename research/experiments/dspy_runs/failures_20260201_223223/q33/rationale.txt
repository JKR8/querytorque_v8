1. **Added a materialized CTE for filtered manufacturers**: Created `filtered_manufacturers` CTE with `MATERIALIZED` hint to pre-compute the list of `i_manufact_id` values from `item` where `i_category='Home'`. This avoids repeating the same subquery three times (once in each of ss, cs, ws CTEs), reducing redundant scans of the `item` table. DuckDB's optimizer can materialize this CTE once and reuse the result, improving performance.

2. **Maintained original structure**: The query structure remains identical—same CTEs, JOINs, UNION ALL, grouping, and ordering—as required by constraints. No new WHERE conditions were added, and no restructuring was done.

3. **Expected performance improvement**: By materializing the filtered manufacturer list, we reduce repeated filtering on the `item` table (which had both filtered and unfiltered scans in the row estimates). This should lower the cost of the sequential scans and hash joins, especially since the `item` table has over 200,000 rows. The DB-specific hint confirms DuckDB benefits from explicit CTE materialization for repeated scans.