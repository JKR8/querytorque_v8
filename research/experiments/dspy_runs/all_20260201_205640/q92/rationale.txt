[After 2 attempts] Used a different approach from the failed CTE: created an inline derived table (subquery) to pre-compute the 1.3*average discount per item for the date range, with explicit table aliases (ws_inner, d_inner) to avoid ambiguity. All column references in the main query are fully qualified with table aliases (ws., i., d., item_avg.) to prevent the binder error. This strategy still eliminates the correlated subquery, which should improve performance by computing the averages once per item rather than for each row. The derived table is joined on ws_item_sk, and the filtering on item and date is applied in the main WHERE clause. This is syntactically correct and uses a different structure than the failed attempt.