1. **Created filtered CTEs for dimension tables**: 
   - `date_range` pre-filters date_dim to only 31 relevant rows instead of scanning entire table
   - `filtered_item` pre-filters items with i_current_price > 50 to ~11,429 rows
   - `filtered_promotion` pre-filters promotions with p_channel_tv = 'N' to reduce scans

2. **Filter pushdown**: By joining with these filtered CTEs early, we significantly reduce the size of fact table joins before aggregation, especially for store_sales (59,415 rows) and catalog_sales (31,569 rows).

3. **Reduced redundant work**: The promotion table is now scanned only once instead of three times with the same filter condition.

4. **Improved join selectivity**: The filtered dimension tables (date_range with 31 rows, filtered_item with ~11,429 rows) create smaller intermediate results before joining with large fact tables.

5. **Maintained semantics**: All business logic remains identical - same date range, same price filter, same promotion filter, same aggregation logic.

These optimizations should reduce I/O operations, decrease memory usage for hash joins, and improve overall query performance by reducing the volume of data processed in the most expensive operations (sequential scans of large fact tables).