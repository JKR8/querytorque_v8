1. **Early filtering**: Moved item and date_dim filters directly into the UNION ALL subqueries, reducing the rows joined with customer table from potentially millions to only those matching the category/class/date criteria.

2. **Pre-computed constants**: Created a `date_constants` CTE to compute the month_seq range once, avoiding repeated execution of identical subqueries in the `my_revenue` CTE.

3. **Simplified join structure**: Changed the Cartesian product style joins (comma-separated FROM clause) to explicit INNER JOIN syntax with proper join conditions, giving the optimizer clearer relationship information.

4. **Predicate pushdown**: Applied filters on item (category='Women', class='maternity') and date_dim (d_moy=5, d_year=1998) directly in the sales subqueries rather than after joining with customer.

5. **Reduced intermediate result size**: The `filtered_sales` CTE now only includes relevant sales records before joining with customer, which should significantly reduce the number of rows processed in subsequent operations.

These changes should reduce the cost of scanning large tables by applying filters earlier in the execution plan, minimize repeated computations, and provide the optimizer with better information for join ordering decisions.