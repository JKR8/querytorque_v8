1. **Early date filtering**: Created a `date_filter` CTE to apply the highly selective date conditions (d_qoy=2 AND d_year=2000) first, reducing the web_sales join early.

2. **OR to UNION ALL transformation**: Split the OR condition into two separate query branches using UNION ALL. This allows each branch to use optimal join paths and predicate pushdown without the optimizer being confused by OR conditions.

3. **Materialized item filter**: Created a `filtered_items` CTE for the small item subquery (only 10 specific i_item_sk values), making the second branch more efficient.

4. **Join order optimization**: By starting with date-filtered web_sales, we reduce the intermediate result size before joining with larger tables like customer and customer_address.

5. **Eliminated redundant scans**: The original query scanned the item table twice (once in main query, once in subquery). The optimized version references the filtered_items CTE in the second branch.

These changes should significantly reduce the cost of sequential scans and hash joins by applying the most restrictive filters earliest in the execution plan, while maintaining identical semantics.