1. **Pre-filtered dimension tables**: Created CTEs for filtered date_dim, time_dim, and ship_mode to reduce join sizes early. This prevents full table scans on dimension tables and reduces the amount of data joined with large fact tables.

2. **Constant expression optimization**: Moved the constant 'GREAT EASTERN,LATVIAN' string concatenation to the final SELECT instead of computing it in each subquery, reducing redundant computation.

3. **Maintained UNION ALL structure**: Preserved the efficient UNION ALL approach which avoids duplicate elimination overhead since web and catalog sales are distinct sets.

4. **Early aggregation**: Each sales channel is aggregated separately before the final union, reducing data volume for the final aggregation.

5. **Join order optimization**: By filtering dimensions first, the joins with large fact tables (web_sales, catalog_sales) work with smaller dimension sets, potentially allowing more efficient join strategies.

These changes should reduce I/O and CPU costs by minimizing the amount of data processed in joins and aggregations, particularly beneficial given the large row counts in web_sales and catalog_sales tables.