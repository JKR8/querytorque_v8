[After 3 attempts] Applied a different strategy from the failed attempt: Instead of using a CTE with IN subqueries, I moved the date_dim JOIN and date filter directly into each subquery of the UNION ALL. This allows the optimizer to push the date predicate earlier and reduce the number of rows scanned from the large fact tables (store_sales, store_returns, catalog_sales, etc.) before performing the UNION. For the web channel, I maintained the original LEFT OUTER JOIN logic between web_returns and web_sales but added the date_dim JOIN on wr_returned_date_sk with the filter. This approach should reduce the cost of sequential scans by filtering rows earlier based on the date range, while avoiding the syntax error of the previous attempt.