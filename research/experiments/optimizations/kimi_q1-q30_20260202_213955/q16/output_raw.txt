 ```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "decorrelate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-4-01' AND (CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY)",
        "filtered_addresses": "SELECT ca_address_sk FROM customer_address WHERE ca_state = 'WV'",
        "filtered_call_centers": "SELECT cc_call_center_sk FROM call_center WHERE cc_county IN ('Ziebach County', 'Luce County', 'Richland County', 'Daviess County', 'Barrow County')",
        "multi_warehouse_orders": "SELECT cs_order_number FROM catalog_sales GROUP BY cs_order_number HAVING COUNT(DISTINCT cs_warehouse_sk) > 1",
        "returned_orders": "SELECT DISTINCT cr_order_number FROM catalog_returns",
        "filtered_sales": "SELECT cs.cs_order_number, cs.cs_ext_ship_cost, cs.cs_net_profit FROM catalog_sales cs JOIN filtered_dates fd ON cs.cs_ship_date_sk = fd.d_date_sk JOIN filtered_addresses fa ON cs.cs_ship_addr_sk = fa.ca_address_sk JOIN filtered_call_centers fcc ON cs.cs_call_center_sk = fcc.cc_call_center_sk JOIN multi_warehouse_orders mwo ON cs.cs_order_number = mwo.cs_order_number LEFT JOIN returned_orders ro ON cs.cs_order_number = ro.cr_order_number WHERE ro.cr_order_number IS NULL",
        "main_query": "SELECT COUNT(DISTINCT cs_order_number) AS \"order count\", SUM(cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs_net_profit) AS \"total net profit\" FROM filtered_sales ORDER BY COUNT(DISTINCT cs_order_number) LIMIT 100"
      },
      "invariants_kept": [
        "output columns unchanged",
        "same aggregation results",
        "same date range filtering",
        "same state and county filtering",
        "same multi-warehouse order detection (EXISTS logic)",
        "same no-return order filtering (NOT EXISTS logic)"
      ],
      "expected_speedup": "3.5x",
      "risk": "low"
    }
  ],
  "explanation": "Decorrelated both EXISTS and NOT EXISTS subqueries into joins. The EXISTS (same order, different warehouse) was converted to a join with a pre-computed set of order_numbers having COUNT(DISTINCT warehouse) > 1. The NOT EXISTS (no returns) was converted to an anti-join via LEFT JOIN with returned_orders WHERE IS NULL. Additionally, pushed down filters on date_dim, customer_address, and call_center into early CTEs to reduce the input size to the main catalog_sales scan. This eliminates correlated subquery execution and enables hash joins throughout."
}
```