{
  "query_num": 48,
  "status": "success",
  "original_sql": "-- start query 48 in stream 0 using template query48.tpl\nselect sum (ss_quantity)\n from store_sales, store, customer_demographics, customer_address, date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 1999\n and  \n (\n  (\n   cd_demo_sk = ss_cdemo_sk\n   and \n   cd_marital_status = 'U'\n   and \n   cd_education_status = 'Primary'\n   and \n   ss_sales_price between 100.00 and 150.00  \n   )\n or\n  (\n  cd_demo_sk = ss_cdemo_sk\n   and \n   cd_marital_status = 'W'\n   and \n   cd_education_status = 'College'\n   and \n   ss_sales_price between 50.00 and 100.00   \n  )\n or \n (\n  cd_demo_sk = ss_cdemo_sk\n  and \n   cd_marital_status = 'D'\n   and \n   cd_education_status = '2 yr Degree'\n   and \n   ss_sales_price between 150.00 and 200.00  \n )\n )\n and\n (\n  (\n  ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('MD', 'MN', 'IA')\n  and ss_net_profit between 0 and 2000  \n  )\n or\n  (ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('VA', 'IL', 'TX')\n  and ss_net_profit between 150 and 3000 \n  )\n or\n  (ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('MI', 'WI', 'IN')\n  and ss_net_profit between 50 and 25000 \n  )\n )\n;\n\n-- end query 48 in stream 0 using template query48.tpl\n",
  "optimized_sql": "-- start query 48 in stream 0 using template query48.tpl\nselect sum (ss_quantity)\n from store_sales, store, customer_demographics, customer_address, date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 1999\n and  \n (\n  (\n   cd_demo_sk = ss_cdemo_sk\n   and \n   cd_marital_status = 'U'\n   and \n   cd_education_status = 'Primary'\n   and \n   ss_sales_price between 100.00 and 150.00  \n   )\n or\n  (\n  cd_demo_sk = ss_cdemo_sk\n   and \n   cd_marital_status = 'W'\n   and \n   cd_education_status = 'College'\n   and \n   ss_sales_price between 50.00 and 100.00   \n  )\n or \n (\n  cd_demo_sk = ss_cdemo_sk\n  and \n   cd_marital_status = 'D'\n   and \n   cd_education_status = '2 yr Degree'\n   and \n   ss_sales_price between 150.00 and 200.00  \n )\n )\n and\n (\n  (\n  ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('MD', 'MN', 'IA')\n  and ss_net_profit between 0 and 2000  \n  )\n or\n  (ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('VA', 'IL', 'TX')\n  and ss_net_profit between 150 and 3000 \n  )\n or\n  (ss_addr_sk = ca_address_sk\n  and\n  ca_country = 'United States'\n  and\n  ca_state in ('MI', 'WI', 'IN')\n  and ss_net_profit between 50 and 25000 \n  )\n )\n;\n\n-- end query 48 in stream 0 using template query48.tpl\n",
  "raw_response": " ```json\n{\n  \"rewrite_sets\": [\n    {\n      \"id\": \"rs_01\",\n      \"transform\": \"or_to_union\",\n      \"nodes\": {\n        \"filtered_dates\": \"SELECT d_date_sk FROM date_dim WHERE d_year = 1999\",\n        \"filtered_sales\": \"SELECT ss.ss_quantity FROM store_sales ss JOIN store s ON s.s_store_sk = ss.ss_store_sk JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_demographics cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'U' AND cd.cd_education_status = 'Primary' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('MD', 'MN', 'IA') AND ss.ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT ss.ss_quantity FROM store_sales ss JOIN store s ON s.s_store_sk = ss.ss_store_sk JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_demographics cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'U' AND cd.cd_education_status = 'Primary' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('VA', 'IL', 'TX') AND ss.ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT ss.ss_quantity FROM store_sales ss JOIN store s ON s.s_store_sk = ss.ss_store_sk JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_demographics cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'U' AND cd.cd_education_status = 'Primary' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('MI', 'WI', 'IN') AND ss.ss_net_profit BETWEEN 50 AND 25000 UNION ALL SELECT ss.ss_quantity FROM store_sales ss JOIN store s ON s.s_store_sk = ss.ss_store_sk JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_demographics cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE cd.cd_marital_status = 'W' AND cd.cd_education_status = 'College' AND ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('MD', 'MN', 'IA') AND ss.ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT ss.ss_quantity FROM store_sales ss JOIN store s ON s.s_store_sk = ss.ss_store_sk JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_demographics cd ON cd.cd_demo_sk = ss.ss_cdemo_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk",
  "error": null,
  "latency_ms": 129293.20176100009,
  "tokens_in": 1710,
  "tokens_out": 8192
}