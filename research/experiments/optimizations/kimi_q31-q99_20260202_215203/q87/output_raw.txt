 ```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "early_filter",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1184 AND 1184 + 11",
        "store_branch": "SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk",
        "catalog_branch": "SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk",
        "web_branch": "SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk",
        "main_query": "SELECT COUNT(*) FROM ((SELECT * FROM store_branch) EXCEPT (SELECT * FROM catalog_branch) EXCEPT (SELECT * FROM web_branch)) AS cool_cust"
      },
      "invariants_kept": [
        "same result count",
        "same set difference semantics",
        "same column output",
        "preserved date range filter"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Applied early_filter to pre-filter date_dim once instead of scanning it three times (once per EXCEPT branch). The date_dim filter d_month_seq BETWEEN 1184 AND 1195 is computed once in the filtered_dates CTE, reducing the input size for all three subsequent joins against store_sales, catalog_sales, and web_sales. This eliminates redundant I/O and predicate evaluation on the dimension table."
}
```