 ```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "decorrelate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-2-01' AND (CAST('2000-2-01' AS DATE) + INTERVAL '60' DAY)",
        "filtered_addresses": "SELECT ca_address_sk FROM customer_address WHERE ca_state = 'OK'",
        "filtered_sites": "SELECT web_site_sk FROM web_site WHERE web_company_name = 'pri'",
        "multi_warehouse_orders": "SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1",
        "orders_with_returns": "SELECT DISTINCT wr_order_number FROM web_returns",
        "main_query": "SELECT COUNT(DISTINCT ws1.ws_order_number) AS \"order count\", SUM(ws1.ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws1.ws_net_profit) AS \"total net profit\" FROM web_sales AS ws1 JOIN filtered_dates ON ws1.ws_ship_date_sk = filtered_dates.d_date_sk JOIN filtered_addresses ON ws1.ws_ship_addr_sk = filtered_addresses.ca_address_sk JOIN filtered_sites ON ws1.ws_web_site_sk = filtered_sites.web_site_sk JOIN multi_warehouse_orders mwo ON ws1.ws_order_number = mwo.ws_order_number LEFT JOIN orders_with_returns owr ON ws1.ws_order_number = owr.wr_order_number WHERE owr.wr_order_number IS NULL ORDER BY COUNT(DISTINCT ws1.ws_order_number) LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation results",
        "same ordering",
        "required predicates preserved via early filters",
        "correlated EXISTS converted to semi-join",
        "correlated NOT EXISTS converted to anti-join"
      ],
      "expected_speedup": "3.5x",
      "risk": "low"
    }
  ],
  "explanation": "Eliminated correlated subqueries by pre-computing: (1) orders with multiple warehouses using GROUP BY/HAVING, and (2) orders with returns using DISTINCT scan. Converted EXISTS to inner join and NOT EXISTS to left join with IS NULL check. Pushed down filters on date_dim, customer_address, and web_site into early CTEs to reduce input size before joins."
}
```