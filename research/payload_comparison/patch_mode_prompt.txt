============================================================
PATCH MODE RESPONSE FORMAT (from v7)
============================================================

Use this when asking LLM to fix specific issues with surgical edits
rather than full query rewrites.

## Response Format

Return JSON with patches to apply:

```json
{
  "patches": [
    {
      "issue_id": "SQL-XXX",
      "search": "exact text to find in original SQL",
      "replace": "replacement text",
      "line_hint": 0,
      "description": "What was fixed"
    }
  ],
  "explanation": "Brief explanation of changes"
}
```

## Example

```json
{
  "patches": [
    {
      "issue_id": "SQL-JOIN-001",
      "search": "FROM customers, orders\nWHERE customers.id = orders.customer_id",
      "replace": "FROM customers\nINNER JOIN orders ON customers.id = orders.customer_id\nWHERE 1=1",
      "description": "Convert comma join to explicit INNER JOIN"
    },
    {
      "issue_id": "SQL-SEL-001",
      "search": "SELECT *",
      "replace": "SELECT id, name, email",
      "description": "Replace SELECT * with explicit columns"
    }
  ],
  "explanation": "Converted implicit joins to explicit INNER JOINs and replaced SELECT *"
}
```

## Rules

1. search_must_be_EXACT_text_from_original_sql_including_whitespace_and_newlines
2. copy_search_text_character_for_character_from_input_sql
3. each_patch_fixes_one_issue
4. patches_applied_in_order
5. return_valid_json_only_no_markdown

## Forbidden Patterns in Replacements

- SELECT * - NEVER introduce SELECT * in patches
- CROSS JOIN - NEVER introduce unless in original
- Removing columns - preserve all columns in SELECT clauses
- Changing column aliases - preserve original alias names

## Critical Warning

If the original SQL has explicit columns (like 'select col1, col2'),
you MUST preserve those exact columns. NEVER replace explicit columns
with SELECT *. This will cause validation to fail.

============================================================
WHEN TO USE PATCH MODE vs FULL REWRITE
============================================================

PATCH MODE - good for:
- Converting comma joins to explicit JOINs
- Replacing SELECT * with explicit columns
- Adding table aliases
- Fixing implicit type conversions
- Small localized fixes

FULL REWRITE - good for:
- Predicate pushdown (structural change)
- Correlated subquery elimination
- CTE restructuring
- Join reordering
- Major query restructuring
