{
  "source": "session_iteration_00_fan_out_worker_01",
  "original_path": "/mnt/c/Users/jakc9/Documents/QueryTorque_V8/packages/qt-sql/qt_sql/benchmarks/postgres_dsb/queries/query092_multi.sql",
  "optimized_path": "/mnt/c/Users/jakc9/Documents/QueryTorque_V8/packages/qt-sql/qt_sql/benchmarks/postgres_dsb/swarm_sessions/query092_multi/iteration_00_fan_out/worker_01/optimized.sql",
  "validation": {
    "worker_id": 1,
    "strategy": "conservative_join_restructure",
    "examples_used": [
      "pg_date_cte_explicit_join",
      "early_filter_decorrelate",
      "FILTER_SUB_QUERY_TO_JOIN"
    ],
    "optimized_sql": "WITH filtered_dates AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_date BETWEEN '1998-03-13' AND CAST('1998-03-13' AS DATE) + INTERVAL '90 DAY'\n),\nfiltered_items AS (\n    SELECT i_item_sk\n    FROM item\n    WHERE i_manufact_id BETWEEN 341 AND 540 \n       OR i_category IN ('Home', 'Men', 'Music')\n),\nitem_avg_discount AS (\n    SELECT \n        ws_item_sk,\n        1.3 * AVG(ws_ext_discount_amt) AS avg_discount\n    FROM web_sales\n    JOIN filtered_dates ON d_date_sk = ws_sold_date_sk\n    WHERE ws_wholesale_cost BETWEEN 26 AND 46\n      AND ws_sales_price / ws_list_price BETWEEN 34 * 0.01 AND 49 * 0.01\n    GROUP BY ws_item_sk\n)\nSELECT\n    SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\"\nFROM web_sales\nJOIN filtered_items ON i_item_sk = ws_item_sk\nJOIN filtered_dates ON d_date_sk = ws_sold_date_sk\nLEFT JOIN item_avg_discount ON web_sales.ws_item_sk = item_avg_discount.ws_item_sk\nWHERE ws_wholesale_cost BETWEEN 26 AND 46\n  AND ws_ext_discount_amt > item_avg_discount.avg_discount\nGROUP BY ()\nORDER BY SUM(ws_ext_discount_amt)\nLIMIT 100",
    "speedup": 7.757501882436931,
    "status": "WIN",
    "transforms": [
      "decorrelate",
      "date_cte_isolate",
      "dimension_cte_isolate"
    ],
    "hint": "Convert implicit joins to explicit joins for better optimizer control, isolate selective date filters early, and transform the correlated subquery into a join to enable more efficient execution plans.",
    "error_message": null,
    "error_messages": [],
    "error_category": null
  }
}