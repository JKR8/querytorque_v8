{
  "source": "session_iteration_00_fan_out_worker_02",
  "original_path": "/mnt/c/Users/jakc9/Documents/QueryTorque_V8/packages/qt-sql/qt_sql/benchmarks/duckdb_tpcds/queries/query_35.sql",
  "optimized_path": "/mnt/c/Users/jakc9/Documents/QueryTorque_V8/packages/qt-sql/qt_sql/benchmarks/duckdb_tpcds/swarm_sessions/q35/iteration_00_fan_out/worker_02/optimized.sql",
  "validation": {
    "worker_id": 2,
    "strategy": "moderate_date_dimension_isolation",
    "examples_used": [
      "date_cte_isolate",
      "multi_dimension_prefetch",
      "materialize_cte"
    ],
    "optimized_sql": "WITH filtered_dates AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_year = 2001\n      AND d_qoy < 4\n),\nstore_customers AS (\n    SELECT DISTINCT ss_customer_sk\n    FROM store_sales\n    JOIN filtered_dates ON ss_sold_date_sk = d_date_sk\n),\nweb_customers AS (\n    SELECT DISTINCT ws_bill_customer_sk\n    FROM web_sales\n    JOIN filtered_dates ON ws_sold_date_sk = d_date_sk\n),\ncatalog_customers AS (\n    SELECT DISTINCT cs_ship_customer_sk\n    FROM catalog_sales\n    JOIN filtered_dates ON cs_sold_date_sk = d_date_sk\n)\nSELECT\n    ca.ca_state,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_dep_count,\n    COUNT(*) AS cnt1,\n    MAX(cd.cd_dep_count),\n    SUM(cd.cd_dep_count),\n    MAX(cd.cd_dep_count),\n    cd.cd_dep_employed_count,\n    COUNT(*) AS cnt2,\n    MAX(cd.cd_dep_employed_count),\n    SUM(cd.cd_dep_employed_count),\n    MAX(cd.cd_dep_employed_count),\n    cd.cd_dep_college_count,\n    COUNT(*) AS cnt3,\n    MAX(cd.cd_dep_college_count),\n    SUM(cd.cd_dep_college_count),\n    MAX(cd.cd_dep_college_count)\nFROM customer c\nJOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics cd ON cd.cd_demo_sk = c.c_current_cdemo_sk\nWHERE EXISTS (SELECT 1 FROM store_customers sc WHERE sc.ss_customer_sk = c.c_customer_sk)\n  AND (EXISTS (SELECT 1 FROM web_customers wc WHERE wc.ws_bill_customer_sk = c.c_customer_sk)\n       OR EXISTS (SELECT 1 FROM catalog_customers cc WHERE cc.cs_ship_customer_sk = c.c_customer_sk))\nGROUP BY\n    ca.ca_state,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_dep_count,\n    cd.cd_dep_employed_count,\n    cd.cd_dep_college_count\nORDER BY\n    ca.ca_state,\n    cd.cd_gender,\n    cd.cd_marital_status,\n    cd.cd_dep_count,\n    cd.cd_dep_employed_count,\n    cd.cd_dep_college_count\nLIMIT 100;",
    "speedup": 0.0,
    "status": "ERROR",
    "transforms": [
      "date_cte_isolate"
    ],
    "hint": "Isolate shared date dimension filtering into CTEs and pre-filter multiple dimension tables separately to optimize join order.",
    "error_message": "IO Error: Cannot open database \"/mnt/d/TPC-DS/tpcds_sf10.duckdb\" in read-only mode: database does not exist",
    "error_messages": [
      "IO Error: Cannot open database \"/mnt/d/TPC-DS/tpcds_sf10.duckdb\" in read-only mode: database does not exist"
    ],
    "error_category": "execution"
  }
}