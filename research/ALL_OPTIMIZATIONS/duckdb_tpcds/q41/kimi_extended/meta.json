{
  "source": "kimi_extended",
  "original_path": "/mnt/c/Users/jakc9/Documents/QueryTorque_V8/packages/qt-sql/qt_sql/benchmarks/duckdb_tpcds/queries/query_41.sql",
  "optimized_path": "/mnt/c/Users/jakc9/Documents/QueryTorque_V8/research/archive/benchmark_results/CONSOLIDATED_BENCHMARKS/kimi_q31-q99_optimization/q41/output_optimized.sql",
  "validation": {
    "query_num": 41,
    "status": "success",
    "original_sql": "-- start query 41 in stream 0 using template query41.tpl\nselect distinct(i_product_name)\n from item i1\n where i_manufact_id between 748 and 748+40 \n   and (select count(*) as item_cnt\n        from item\n        where (i_manufact = i1.i_manufact and\n        ((i_category = 'Women' and \n        (i_color = 'gainsboro' or i_color = 'aquamarine') and \n        (i_units = 'Ounce' or i_units = 'Dozen') and\n        (i_size = 'medium' or i_size = 'economy')\n        ) or\n        (i_category = 'Women' and\n        (i_color = 'chiffon' or i_color = 'violet') and\n        (i_units = 'Ton' or i_units = 'Pound') and\n        (i_size = 'extra large' or i_size = 'small')\n        ) or\n        (i_category = 'Men' and\n        (i_color = 'chartreuse' or i_color = 'blue') and\n        (i_units = 'Each' or i_units = 'Oz') and\n        (i_size = 'N/A' or i_size = 'large')\n        ) or\n        (i_category = 'Men' and\n        (i_color = 'tan' or i_color = 'dodger') and\n        (i_units = 'Bunch' or i_units = 'Tsp') and\n        (i_size = 'medium' or i_size = 'economy')\n        ))) or\n       (i_manufact = i1.i_manufact and\n        ((i_category = 'Women' and \n        (i_color = 'blanched' or i_color = 'tomato') and \n        (i_units = 'Tbl' or i_units = 'Case') and\n        (i_size = 'medium' or i_size = 'economy')\n        ) or\n        (i_category = 'Women' and\n        (i_color = 'almond' or i_color = 'lime') and\n        (i_units = 'Box' or i_units = 'Dram') and\n        (i_size = 'extra large' or i_size = 'small')\n        ) or\n        (i_category = 'Men' and\n        (i_color = 'peru' or i_color = 'saddle') and\n        (i_units = 'Pallet' or i_units = 'Gram') and\n        (i_size = 'N/A' or i_size = 'large')\n        ) or\n        (i_category = 'Men' and\n        (i_color = 'indian' or i_color = 'spring') and\n        (i_units = 'Unknown' or i_units = 'Carton') and\n        (i_size = 'medium' or i_size = 'economy')\n        )))) > 0\n order by i_product_name\n LIMIT 100;\n\n-- end query 41 in stream 0 using template query41.tpl\n",
    "optimized_sql": "-- start query 41 in stream 0 using template query41.tpl\nselect distinct(i_product_name)\n from item i1\n where i_manufact_id between 748 and 748+40 \n   and (select count(*) as item_cnt\n        from item\n        where (i_manufact = i1.i_manufact and\n        ((i_category = 'Women' and \n        (i_color = 'gainsboro' or i_color = 'aquamarine') and \n        (i_units = 'Ounce' or i_units = 'Dozen') and\n        (i_size = 'medium' or i_size = 'economy')\n        ) or\n        (i_category = 'Women' and\n        (i_color = 'chiffon' or i_color = 'violet') and\n        (i_units = 'Ton' or i_units = 'Pound') and\n        (i_size = 'extra large' or i_size = 'small')\n        ) or\n        (i_category = 'Men' and\n        (i_color = 'chartreuse' or i_color = 'blue') and\n        (i_units = 'Each' or i_units = 'Oz') and\n        (i_size = 'N/A' or i_size = 'large')\n        ) or\n        (i_category = 'Men' and\n        (i_color = 'tan' or i_color = 'dodger') and\n        (i_units = 'Bunch' or i_units = 'Tsp') and\n        (i_size = 'medium' or i_size = 'economy')\n        ))) or\n       (i_manufact = i1.i_manufact and\n        ((i_category = 'Women' and \n        (i_color = 'blanched' or i_color = 'tomato') and \n        (i_units = 'Tbl' or i_units = 'Case') and\n        (i_size = 'medium' or i_size = 'economy')\n        ) or\n        (i_category = 'Women' and\n        (i_color = 'almond' or i_color = 'lime') and\n        (i_units = 'Box' or i_units = 'Dram') and\n        (i_size = 'extra large' or i_size = 'small')\n        ) or\n        (i_category = 'Men' and\n        (i_color = 'peru' or i_color = 'saddle') and\n        (i_units = 'Pallet' or i_units = 'Gram') and\n        (i_size = 'N/A' or i_size = 'large')\n        ) or\n        (i_category = 'Men' and\n        (i_color = 'indian' or i_color = 'spring') and\n        (i_units = 'Unknown' or i_units = 'Carton') and\n        (i_size = 'medium' or i_size = 'economy')\n        )))) > 0\n order by i_product_name\n LIMIT 100;\n\n-- end query 41 in stream 0 using template query41.tpl\n",
    "raw_response": "```json\n{\n  \"rewrite_sets\": [\n    {\n      \"id\": \"rs_01\",\n      \"transform\": \"or_to_union\",\n      \"nodes\": {\n        \"branch_1\": \"SELECT DISTINCT i_product_name FROM item AS i1 WHERE i_manufact_id BETWEEN 748 AND 788 AND (SELECT COUNT(*) FROM item WHERE i_manufact = i1.i_manufact AND ((i_category = 'Women' AND (i_color = 'gainsboro' OR i_color = 'aquamarine') AND (i_units = 'Ounce' OR i_units = 'Dozen') AND (i_size = 'medium' OR i_size = 'economy')) OR (i_category = 'Women' AND (i_color = 'chiffon' OR i_color = 'violet') AND (i_units = 'Ton' OR i_units = 'Pound') AND (i_size = 'extra large' OR i_size = 'small')) OR (i_category = 'Men' AND (i_color = 'chartreuse' OR i_color = 'blue') AND (i_units = 'Each' OR i_units = 'Oz') AND (i_size = 'N/A' OR i_size = 'large')) OR (i_category = 'Men' AND (i_color = 'tan' OR i_color = 'dodger') AND (i_units = 'Bunch' OR i_units = 'Tsp') AND (i_size = 'medium' OR i_size = 'economy')))) > 0\",\n        \"branch_2\": \"SELECT DISTINCT i_product_name FROM item AS i1 WHERE i_manufact_id BETWEEN 748 AND 788 AND (SELECT COUNT(*) FROM item WHERE i_manufact = i1.i_manufact AND ((i_category = 'Women' AND (i_color = 'blanched' OR i_color = 'tomato') AND (i_units = 'Tbl' OR i_units = 'Case') AND (i_size = 'medium' OR i_size = 'economy')) OR (i_category = 'Women' AND (i_color = 'almond' OR i_color = 'lime') AND (i_units = 'Box' OR i_units = 'Dram') AND (i_size = 'extra large' OR i_size = 'small')) OR (i_category = 'Men' AND (i_color = 'peru' OR i_color = 'saddle') AND (i_units = 'Pallet' OR i_units = 'Gram') AND (i_size = 'N/A' OR i_size = 'large')) OR (i_category = 'Men' AND (i_color = 'indian' OR i_color = 'spring') AND (i_units = 'Unknown' OR i_units = 'Carton') AND (i_size = 'medium' OR i_size = 'economy')))) > 0\",\n        \"main_query\": \"SELECT i_product_name FROM branch_1 UNION SELECT i_product_name FROM branch_2 ORDER BY i_product_name LIMIT 100\"\n      },\n      \"invariants_ke",
    "error": null,
    "latency_ms": 174147.6031179991,
    "tokens_in": 1940,
    "tokens_out": 8192
  }
}