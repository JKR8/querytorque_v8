WITH date_filter AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), store_sales_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk), catalog_sales_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN date_filter ON cs_sold_date_sk = d_date_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk), web_sales_customers AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN date_filter ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk)
SELECT COUNT(*) FROM ((SELECT * FROM store_sales_customers) EXCEPT (SELECT * FROM catalog_sales_customers) EXCEPT (SELECT * FROM web_sales_customers)) AS cool_cust