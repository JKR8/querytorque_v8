[
  {
    "query_id": "query001_multi_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sr_reason_sk as ctr_reason_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\nand sr_return_amt / sr_return_quantity between 115 and 174\ngroup by sr_customer_sk\n,sr_store_sk, sr_reason_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n,customer_demographics\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk\n)\nand ctr1.ctr_reason_sk BETWEEN 17 AND 20\nand s_store_sk = ctr1.ctr_store_sk\nand s_state IN ('IA', 'KY', 'NE')\nand ctr1.ctr_customer_sk = c_customer_sk\nand c_current_cdemo_sk = cd_demo_sk\nand cd_marital_status IN ('S', 'S')\nand cd_education_status IN ('4 yr Degree', '4 yr Degree')\nand cd_gender = 'M'\nand c_birth_month = 4\nand c_birth_year BETWEEN 1987 AND 1993\norder by c_customer_id\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 AND sr_return_amt / sr_return_quantity BETWEEN 115 AND 174 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), store_avg_return AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_return FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return AS ctr1 INNER JOIN store_avg_return AS sar ON ctr1.ctr_store_sk = sar.ctr_store_sk, store, customer, customer_demographics WHERE ctr1.ctr_total_return > sar.avg_return AND ctr1.ctr_reason_sk BETWEEN 17 AND 20 AND s_store_sk = ctr1.ctr_store_sk AND s_state IN ('IA', 'KY', 'NE') AND ctr1.ctr_customer_sk = c_customer_sk AND c_current_cdemo_sk = cd_demo_sk AND cd_marital_status IN ('S', 'S') AND cd_education_status IN ('4 yr Degree', '4 yr Degree') AND cd_gender = 'M' AND c_birth_month = 4 AND c_birth_year BETWEEN 1987 AND 1993 ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "patch_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query001_multi_i2",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sr_reason_sk as ctr_reason_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\nand sr_return_amt / sr_return_quantity between 115 and 174\ngroup by sr_customer_sk\n,sr_store_sk, sr_reason_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n,customer_demographics\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk\n)\nand ctr1.ctr_reason_sk BETWEEN 17 AND 20\nand s_store_sk = ctr1.ctr_store_sk\nand s_state IN ('IA', 'KY', 'NE')\nand ctr1.ctr_customer_sk = c_customer_sk\nand c_current_cdemo_sk = cd_demo_sk\nand cd_marital_status IN ('S', 'S')\nand cd_education_status IN ('4 yr Degree', '4 yr Degree')\nand cd_gender = 'M'\nand c_birth_month = 4\nand c_birth_year BETWEEN 1987 AND 1993\norder by c_customer_id\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 AND sr_return_amt / sr_return_quantity BETWEEN 115 AND 174 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), avg_return_by_store AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS threshold FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return AS ctr1 INNER JOIN store ON s_store_sk = ctr1.ctr_store_sk INNER JOIN customer ON ctr1.ctr_customer_sk = c_customer_sk INNER JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk INNER JOIN avg_return_by_store ON ctr1.ctr_store_sk = avg_return_by_store.ctr_store_sk WHERE ctr1.ctr_total_return > avg_return_by_store.threshold AND ctr1.ctr_reason_sk BETWEEN 17 AND 20 AND s_state IN ('IA', 'KY', 'NE') AND cd_marital_status IN ('S', 'S') AND cd_education_status IN ('4 yr Degree', '4 yr Degree') AND cd_gender = 'M' AND c_birth_month = 4 AND c_birth_year BETWEEN 1987 AND 1993 ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "patch_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query001_multi_i2",
    "patch_id": "syn_w1",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sr_reason_sk as ctr_reason_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\nand sr_return_amt / sr_return_quantity between 115 and 174\ngroup by sr_customer_sk\n,sr_store_sk, sr_reason_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n,customer_demographics\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk\n)\nand ctr1.ctr_reason_sk BETWEEN 17 AND 20\nand s_store_sk = ctr1.ctr_store_sk\nand s_state IN ('IA', 'KY', 'NE')\nand ctr1.ctr_customer_sk = c_customer_sk\nand c_current_cdemo_sk = cd_demo_sk\nand cd_marital_status IN ('S', 'S')\nand cd_education_status IN ('4 yr Degree', '4 yr Degree')\nand cd_gender = 'M'\nand c_birth_month = 4\nand c_birth_year BETWEEN 1987 AND 1993\norder by c_customer_id\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 AND sr_return_amt / sr_return_quantity BETWEEN 115 AND 174 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), store_avg_return AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_return FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return AS ctr1 INNER JOIN store_avg_return AS sar ON ctr1.ctr_store_sk = sar.ctr_store_sk, store, customer, customer_demographics WHERE ctr1.ctr_total_return > sar.avg_return AND ctr1.ctr_reason_sk BETWEEN 17 AND 20 AND s_store_sk = ctr1.ctr_store_sk AND s_state IN ('IA', 'KY', 'NE') AND ctr1.ctr_customer_sk = c_customer_sk AND c_current_cdemo_sk = cd_demo_sk AND cd_marital_status IN ('S', 'S') AND cd_education_status IN ('4 yr Degree', '4 yr Degree') AND cd_gender = 'M' AND c_birth_month = 4 AND c_birth_year BETWEEN 1987 AND 1993 ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "patch_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query001_multi_i2",
    "patch_id": "syn_w2",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sr_reason_sk as ctr_reason_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\nand sr_return_amt / sr_return_quantity between 115 and 174\ngroup by sr_customer_sk\n,sr_store_sk, sr_reason_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n,customer_demographics\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk\n)\nand ctr1.ctr_reason_sk BETWEEN 17 AND 20\nand s_store_sk = ctr1.ctr_store_sk\nand s_state IN ('IA', 'KY', 'NE')\nand ctr1.ctr_customer_sk = c_customer_sk\nand c_current_cdemo_sk = cd_demo_sk\nand cd_marital_status IN ('S', 'S')\nand cd_education_status IN ('4 yr Degree', '4 yr Degree')\nand cd_gender = 'M'\nand c_birth_month = 4\nand c_birth_year BETWEEN 1987 AND 1993\norder by c_customer_id\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 AND sr_return_amt / sr_return_quantity BETWEEN 115 AND 174 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), store_avg_return AS (SELECT ctr_store_sk, AVG(ctr_total_return) * 1.2 AS avg_return FROM customer_total_return GROUP BY ctr_store_sk) SELECT c_customer_id FROM customer_total_return AS ctr1 INNER JOIN store_avg_return AS sar ON ctr1.ctr_store_sk = sar.ctr_store_sk, store, customer, customer_demographics WHERE ctr1.ctr_total_return > sar.avg_return AND ctr1.ctr_reason_sk BETWEEN 17 AND 20 AND s_store_sk = ctr1.ctr_store_sk AND s_state IN ('IA', 'KY', 'NE') AND ctr1.ctr_customer_sk = c_customer_sk AND c_current_cdemo_sk = cd_demo_sk AND cd_marital_status IN ('S', 'S') AND cd_education_status IN ('4 yr Degree', '4 yr Degree') AND cd_gender = 'M' AND c_birth_month = 4 AND c_birth_year BETWEEN 1987 AND 1993 ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "patch_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query001_multi_i2",
    "patch_id": "t2",
    "iteration": 1,
    "original_sql": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sr_reason_sk as ctr_reason_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\nand sr_return_amt / sr_return_quantity between 115 and 174\ngroup by sr_customer_sk\n,sr_store_sk, sr_reason_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n,customer_demographics\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk\n)\nand ctr1.ctr_reason_sk BETWEEN 17 AND 20\nand s_store_sk = ctr1.ctr_store_sk\nand s_state IN ('IA', 'KY', 'NE')\nand ctr1.ctr_customer_sk = c_customer_sk\nand c_current_cdemo_sk = cd_demo_sk\nand cd_marital_status IN ('S', 'S')\nand cd_education_status IN ('4 yr Degree', '4 yr Degree')\nand cd_gender = 'M'\nand c_birth_month = 4\nand c_birth_year BETWEEN 1987 AND 1993\norder by c_customer_id\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 AND sr_return_amt / sr_return_quantity BETWEEN 115 AND 174 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_state IN ('IA', 'KY', 'NE')) SELECT c_customer_id FROM customer_total_return AS ctr1, store, customer, customer_demographics WHERE ctr1.ctr_total_return > (SELECT AVG(ctr_total_return) * 1.2 FROM customer_total_return AS ctr2 WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk) AND ctr1.ctr_reason_sk BETWEEN 17 AND 20 AND s_store_sk = ctr1.ctr_store_sk AND s_state IN ('IA', 'KY', 'NE') AND ctr1.ctr_customer_sk = c_customer_sk AND c_current_cdemo_sk = cd_demo_sk AND cd_marital_status IN ('S', 'S') AND cd_education_status IN ('4 yr Degree', '4 yr Degree') AND cd_gender = 'M' AND c_birth_month = 4 AND c_birth_year BETWEEN 1987 AND 1993 ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "patch_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query001_multi_i2",
    "patch_id": "t3",
    "iteration": 1,
    "original_sql": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sr_reason_sk as ctr_reason_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\nand sr_return_amt / sr_return_quantity between 115 and 174\ngroup by sr_customer_sk\n,sr_store_sk, sr_reason_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n,customer_demographics\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk\n)\nand ctr1.ctr_reason_sk BETWEEN 17 AND 20\nand s_store_sk = ctr1.ctr_store_sk\nand s_state IN ('IA', 'KY', 'NE')\nand ctr1.ctr_customer_sk = c_customer_sk\nand c_current_cdemo_sk = cd_demo_sk\nand cd_marital_status IN ('S', 'S')\nand cd_education_status IN ('4 yr Degree', '4 yr Degree')\nand cd_gender = 'M'\nand c_birth_month = 4\nand c_birth_year BETWEEN 1987 AND 1993\norder by c_customer_id\nlimit 100;",
    "patch_sql": "WITH filtered_store_returns AS (SELECT sr_customer_sk, sr_store_sk, sr_reason_sk, SR_RETURN_AMT_INC_TAX FROM store_returns JOIN date_dim ON sr_returned_date_sk = d_date_sk WHERE d_year = 2000 AND sr_return_amt / sr_return_quantity BETWEEN 115 AND 174), customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM filtered_store_returns GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), filtered_customer_total_return AS (SELECT * FROM customer_total_return WHERE ctr_reason_sk BETWEEN 17 AND 20) SELECT c_customer_id FROM filtered_customer_total_return AS ctr1 JOIN store ON s_store_sk = ctr1.ctr_store_sk JOIN customer ON ctr1.ctr_customer_sk = c_customer_sk JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE ctr1.ctr_total_return > (SELECT AVG(ctr_total_return) * 1.2 FROM customer_total_return AS ctr2 WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk) AND s_state IN ('IA', 'KY', 'NE') AND cd_marital_status IN ('S', 'S') AND cd_education_status IN ('4 yr Degree', '4 yr Degree') AND cd_gender = 'M' AND c_birth_month = 4 AND c_birth_year BETWEEN 1987 AND 1993 ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "patch_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query001_multi_i2",
    "patch_id": "fix_t4_error",
    "iteration": 2,
    "original_sql": "with customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sr_reason_sk as ctr_reason_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\nand sr_return_amt / sr_return_quantity between 115 and 174\ngroup by sr_customer_sk\n,sr_store_sk, sr_reason_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n,customer_demographics\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk\n)\nand ctr1.ctr_reason_sk BETWEEN 17 AND 20\nand s_store_sk = ctr1.ctr_store_sk\nand s_state IN ('IA', 'KY', 'NE')\nand ctr1.ctr_customer_sk = c_customer_sk\nand c_current_cdemo_sk = cd_demo_sk\nand cd_marital_status IN ('S', 'S')\nand cd_education_status IN ('4 yr Degree', '4 yr Degree')\nand cd_gender = 'M'\nand c_birth_month = 4\nand c_birth_year BETWEEN 1987 AND 1993\norder by c_customer_id\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT sr_customer_sk AS ctr_customer_sk, sr_store_sk AS ctr_store_sk, sr_reason_sk AS ctr_reason_sk, SUM(SR_RETURN_AMT_INC_TAX) AS ctr_total_return FROM store_returns, date_dim WHERE sr_returned_date_sk = d_date_sk AND d_year = 2000 AND sr_return_amt / sr_return_quantity BETWEEN 115 AND 174 GROUP BY sr_customer_sk, sr_store_sk, sr_reason_sk), customer_demographics_filtered AS (SELECT cd_demo_sk, cd_marital_status, cd_education_status, cd_gender FROM customer_demographics WHERE cd_marital_status IN ('S', 'S') AND cd_education_status IN ('4 yr Degree', '4 yr Degree') AND cd_gender = 'M'), store_filtered AS (SELECT s_store_sk, s_state FROM store WHERE s_state IN ('IA', 'KY', 'NE')) SELECT c_customer_id FROM customer_total_return AS ctr1, store_filtered AS s, customer AS c, customer_demographics_filtered AS cd WHERE ctr1.ctr_total_return > (SELECT AVG(ctr_total_return) * 1.2 FROM customer_total_return AS ctr2 WHERE ctr1.ctr_store_sk = ctr2.ctr_store_sk) AND ctr1.ctr_reason_sk BETWEEN 17 AND 20 AND s.s_store_sk = ctr1.ctr_store_sk AND ctr1.ctr_customer_sk = c.c_customer_sk AND c.c_current_cdemo_sk = cd.cd_demo_sk AND c.c_birth_month = 4 AND c.c_birth_year BETWEEN 1987 AND 1993 ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "patch_cksum": "8a292c0d31736e969e19ef31c6cd69bc",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query010_multi_i1",
    "patch_id": "t3",
    "iteration": 0,
    "original_sql": "select \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Grays Harbor County','Kootenai County','Pike County','Thomas County','Uinta County') and\n  c.c_birth_month in (1, 5) and\n  cd_demo_sk = c.c_current_cdemo_sk\n  and cd_marital_status in ('U', 'U', 'M')\n  and cd_education_status in ('College', 'Primary', '2 yr Degree')\n  and cd_gender = 'M' and\n  exists (select *\n          from store_sales,date_dim, item\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 8 and 8+3 and\n                ss_item_sk = i_item_sk and\n                i_category in ('Children', 'Electronics', 'Music')\n                and ss_sales_price / ss_list_price BETWEEN 20 * 0.01 AND 30 * 0.01\n                and i_manager_id BETWEEN 66 and 75\n                ) and\n   (exists (select *\n            from web_sales,date_dim, item\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 8 ANd 8+3 and\n                  ws_item_sk = i_item_sk and\n                  i_category in ('Children', 'Electronics', 'Music')\n                  and i_manager_id BETWEEN 66 and 75\n                  and ws_sales_price / ws_list_price BETWEEN 20 * 0.01 AND 30 * 0.01\n                  ) or\n    exists (select *\n            from catalog_sales,date_dim, item\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 8 and 8+3 and\n                  cs_item_sk = i_item_sk and\n                  i_category in ('Children', 'Electronics', 'Music')\n                  and i_manager_id BETWEEN 66 and 75\n                  and cs_sales_price / cs_list_price BETWEEN 20 * 0.01 AND 30 * 0.01\n                  ))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100;",
    "patch_sql": "WITH filtered_customers AS (SELECT c_customer_sk, c_current_cdemo_sk FROM customer JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE ca_county IN ('Grays Harbor County', 'Kootenai County', 'Pike County', 'Thomas County', 'Uinta County') AND c_birth_month IN (1, 5)) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM filtered_customers AS c JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE cd_marital_status IN ('U', 'U', 'M') AND cd_education_status IN ('College', 'Primary', '2 yr Degree') AND cd_gender = 'M' AND EXISTS(SELECT * FROM store_sales, date_dim, item WHERE c.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1999 AND d_moy BETWEEN 8 AND 8 + 3 AND ss_item_sk = i_item_sk AND i_category IN ('Children', 'Electronics', 'Music') AND ss_sales_price / ss_list_price BETWEEN 20 * 0.01 AND 30 * 0.01 AND i_manager_id BETWEEN 66 AND 75) AND (EXISTS(SELECT * FROM web_sales, date_dim, item WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1999 AND d_moy BETWEEN 8 AND 8 + 3 AND ws_item_sk = i_item_sk AND i_category IN ('Children', 'Electronics', 'Music') AND i_manager_id BETWEEN 66 AND 75 AND ws_sales_price / ws_list_price BETWEEN 20 * 0.01 AND 30 * 0.01) OR EXISTS(SELECT * FROM catalog_sales, date_dim, item WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1999 AND d_moy BETWEEN 8 AND 8 + 3 AND cs_item_sk = i_item_sk AND i_category IN ('Children', 'Electronics', 'Music') AND i_manager_id BETWEEN 66 AND 75 AND cs_sales_price / cs_list_price BETWEEN 20 * 0.01 AND 30 * 0.01)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "13c239a64ca5b7309e334e38e19c9dac",
    "patch_cksum": "13c239a64ca5b7309e334e38e19c9dac",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query010_multi_i1",
    "patch_id": "t4",
    "iteration": 2,
    "original_sql": "select \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Grays Harbor County','Kootenai County','Pike County','Thomas County','Uinta County') and\n  c.c_birth_month in (1, 5) and\n  cd_demo_sk = c.c_current_cdemo_sk\n  and cd_marital_status in ('U', 'U', 'M')\n  and cd_education_status in ('College', 'Primary', '2 yr Degree')\n  and cd_gender = 'M' and\n  exists (select *\n          from store_sales,date_dim, item\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 8 and 8+3 and\n                ss_item_sk = i_item_sk and\n                i_category in ('Children', 'Electronics', 'Music')\n                and ss_sales_price / ss_list_price BETWEEN 20 * 0.01 AND 30 * 0.01\n                and i_manager_id BETWEEN 66 and 75\n                ) and\n   (exists (select *\n            from web_sales,date_dim, item\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 8 ANd 8+3 and\n                  ws_item_sk = i_item_sk and\n                  i_category in ('Children', 'Electronics', 'Music')\n                  and i_manager_id BETWEEN 66 and 75\n                  and ws_sales_price / ws_list_price BETWEEN 20 * 0.01 AND 30 * 0.01\n                  ) or\n    exists (select *\n            from catalog_sales,date_dim, item\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 8 and 8+3 and\n                  cs_item_sk = i_item_sk and\n                  i_category in ('Children', 'Electronics', 'Music')\n                  and i_manager_id BETWEEN 66 and 75\n                  and cs_sales_price / cs_list_price BETWEEN 20 * 0.01 AND 30 * 0.01\n                  ))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100;",
    "patch_sql": "WITH filtered_customers AS (SELECT c.c_customer_sk, c.c_current_cdemo_sk FROM customer AS c INNER JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk WHERE ca.ca_county IN ('Grays Harbor County', 'Kootenai County', 'Pike County', 'Thomas County', 'Uinta County') AND c.c_birth_month IN (1, 5)) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM filtered_customers AS fc INNER JOIN customer_demographics AS cd ON fc.c_current_cdemo_sk = cd.cd_demo_sk WHERE cd.cd_marital_status IN ('U', 'M') AND cd.cd_education_status IN ('College', 'Primary', '2 yr Degree') AND cd.cd_gender = 'M' AND EXISTS(SELECT * FROM store_sales, date_dim, item WHERE fc.c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1999 AND d_moy BETWEEN 8 AND 8 + 3 AND ss_item_sk = i_item_sk AND i_category IN ('Children', 'Electronics', 'Music') AND ss_sales_price / ss_list_price BETWEEN 20 * 0.01 AND 30 * 0.01 AND i_manager_id BETWEEN 66 AND 75) AND (EXISTS(SELECT * FROM web_sales, date_dim, item WHERE fc.c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1999 AND d_moy BETWEEN 8 AND 8 + 3 AND ws_item_sk = i_item_sk AND i_category IN ('Children', 'Electronics', 'Music') AND i_manager_id BETWEEN 66 AND 75 AND ws_sales_price / ws_list_price BETWEEN 20 * 0.01 AND 30 * 0.01) OR EXISTS(SELECT * FROM catalog_sales, date_dim, item WHERE fc.c_customer_sk = cs_ship_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1999 AND d_moy BETWEEN 8 AND 8 + 3 AND cs_item_sk = i_item_sk AND i_category IN ('Children', 'Electronics', 'Music') AND i_manager_id BETWEEN 66 AND 75 AND cs_sales_price / cs_list_price BETWEEN 20 * 0.01 AND 30 * 0.01)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "13c239a64ca5b7309e334e38e19c9dac",
    "patch_cksum": "13c239a64ca5b7309e334e38e19c9dac",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query010_multi_i2",
    "patch_id": "S0",
    "iteration": 1,
    "original_sql": "select \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Alameda County','Lexington city','Pender County','Petroleum County','Walworth County') and\n  c.c_birth_month in (4, 5) and\n  cd_demo_sk = c.c_current_cdemo_sk\n  and cd_marital_status in ('U', 'S', 'U')\n  and cd_education_status in ('College', 'Secondary', 'College')\n  and cd_gender = 'M' and\n  exists (select *\n          from store_sales,date_dim, item\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 5 and 5+3 and\n                ss_item_sk = i_item_sk and\n                i_category in ('Children', 'Home', 'Women')\n                and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01\n                and i_manager_id BETWEEN 91 and 100\n                ) and\n   (exists (select *\n            from web_sales,date_dim, item\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 5 ANd 5+3 and\n                  ws_item_sk = i_item_sk and\n                  i_category in ('Children', 'Home', 'Women')\n                  and i_manager_id BETWEEN 91 and 100\n                  and ws_sales_price / ws_list_price BETWEEN 65 * 0.01 AND 75 * 0.01\n                  ) or\n    exists (select *\n            from catalog_sales,date_dim, item\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 5 and 5+3 and\n                  cs_item_sk = i_item_sk and\n                  i_category in ('Children', 'Home', 'Women')\n                  and i_manager_id BETWEEN 91 and 100\n                  and cs_sales_price / cs_list_price BETWEEN 65 * 0.01 AND 75 * 0.01\n                  ))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy BETWEEN 5 AND 5 + 3), filtered_items AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Home', 'Women') AND i_manager_id BETWEEN 91 AND 100), valid_store_sales AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk WHERE ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01), valid_web_or_catalog_sales AS (SELECT DISTINCT ws_bill_customer_sk AS customer_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_items ON ws_item_sk = i_item_sk WHERE ws_sales_price / ws_list_price BETWEEN 65 * 0.01 AND 75 * 0.01 UNION SELECT DISTINCT cs_ship_customer_sk AS customer_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_items ON cs_item_sk = i_item_sk WHERE cs_sales_price / cs_list_price BETWEEN 65 * 0.01 AND 75 * 0.01) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_county IN ('Alameda County', 'Lexington city', 'Pender County', 'Petroleum County', 'Walworth County') AND c.c_birth_month IN (4, 5) AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('U', 'S', 'U') AND cd_education_status IN ('College', 'Secondary', 'College') AND cd_gender = 'M' AND EXISTS(SELECT 1 FROM valid_store_sales AS vss WHERE vss.ss_customer_sk = c.c_customer_sk) AND (EXISTS(SELECT 1 FROM valid_web_or_catalog_sales AS vwcs WHERE vwcs.customer_sk = c.c_customer_sk)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "0e0af79bcaf053bebe336db57953ae57",
    "patch_cksum": "0e0af79bcaf053bebe336db57953ae57",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query010_multi_i2",
    "patch_id": "S0",
    "iteration": 1,
    "original_sql": "select \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Alameda County','Lexington city','Pender County','Petroleum County','Walworth County') and\n  c.c_birth_month in (4, 5) and\n  cd_demo_sk = c.c_current_cdemo_sk\n  and cd_marital_status in ('U', 'S', 'U')\n  and cd_education_status in ('College', 'Secondary', 'College')\n  and cd_gender = 'M' and\n  exists (select *\n          from store_sales,date_dim, item\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 5 and 5+3 and\n                ss_item_sk = i_item_sk and\n                i_category in ('Children', 'Home', 'Women')\n                and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01\n                and i_manager_id BETWEEN 91 and 100\n                ) and\n   (exists (select *\n            from web_sales,date_dim, item\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 5 ANd 5+3 and\n                  ws_item_sk = i_item_sk and\n                  i_category in ('Children', 'Home', 'Women')\n                  and i_manager_id BETWEEN 91 and 100\n                  and ws_sales_price / ws_list_price BETWEEN 65 * 0.01 AND 75 * 0.01\n                  ) or\n    exists (select *\n            from catalog_sales,date_dim, item\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 5 and 5+3 and\n                  cs_item_sk = i_item_sk and\n                  i_category in ('Children', 'Home', 'Women')\n                  and i_manager_id BETWEEN 91 and 100\n                  and cs_sales_price / cs_list_price BETWEEN 65 * 0.01 AND 75 * 0.01\n                  ))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy BETWEEN 5 AND 5 + 3), filtered_items AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Home', 'Women') AND i_manager_id BETWEEN 91 AND 100), valid_store_sales AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk WHERE ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01), valid_web_or_catalog_sales AS (SELECT DISTINCT ws_bill_customer_sk AS customer_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_items ON ws_item_sk = i_item_sk WHERE ws_sales_price / ws_list_price BETWEEN 65 * 0.01 AND 75 * 0.01 UNION SELECT DISTINCT cs_ship_customer_sk AS customer_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_items ON cs_item_sk = i_item_sk WHERE cs_sales_price / cs_list_price BETWEEN 65 * 0.01 AND 75 * 0.01) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_county IN ('Alameda County', 'Lexington city', 'Pender County', 'Petroleum County', 'Walworth County') AND c.c_birth_month IN (4, 5) AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('U', 'S', 'U') AND cd_education_status IN ('College', 'Secondary', 'College') AND cd_gender = 'M' AND EXISTS(SELECT 1 FROM valid_store_sales AS vss WHERE vss.ss_customer_sk = c.c_customer_sk) AND (EXISTS(SELECT 1 FROM valid_web_or_catalog_sales AS vwcs WHERE vwcs.customer_sk = c.c_customer_sk)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "0e0af79bcaf053bebe336db57953ae57",
    "patch_cksum": "0e0af79bcaf053bebe336db57953ae57",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query010_multi_i2",
    "patch_id": "S0",
    "iteration": 1,
    "original_sql": "select \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Alameda County','Lexington city','Pender County','Petroleum County','Walworth County') and\n  c.c_birth_month in (4, 5) and\n  cd_demo_sk = c.c_current_cdemo_sk\n  and cd_marital_status in ('U', 'S', 'U')\n  and cd_education_status in ('College', 'Secondary', 'College')\n  and cd_gender = 'M' and\n  exists (select *\n          from store_sales,date_dim, item\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 5 and 5+3 and\n                ss_item_sk = i_item_sk and\n                i_category in ('Children', 'Home', 'Women')\n                and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01\n                and i_manager_id BETWEEN 91 and 100\n                ) and\n   (exists (select *\n            from web_sales,date_dim, item\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 5 ANd 5+3 and\n                  ws_item_sk = i_item_sk and\n                  i_category in ('Children', 'Home', 'Women')\n                  and i_manager_id BETWEEN 91 and 100\n                  and ws_sales_price / ws_list_price BETWEEN 65 * 0.01 AND 75 * 0.01\n                  ) or\n    exists (select *\n            from catalog_sales,date_dim, item\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 5 and 5+3 and\n                  cs_item_sk = i_item_sk and\n                  i_category in ('Children', 'Home', 'Women')\n                  and i_manager_id BETWEEN 91 and 100\n                  and cs_sales_price / cs_list_price BETWEEN 65 * 0.01 AND 75 * 0.01\n                  ))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy BETWEEN 5 AND 5 + 3), filtered_items AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Home', 'Women') AND i_manager_id BETWEEN 91 AND 100), valid_store_sales AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk WHERE ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 75 * 0.01), valid_web_or_catalog_sales AS (SELECT DISTINCT ws_bill_customer_sk AS customer_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_items ON ws_item_sk = i_item_sk WHERE ws_sales_price / ws_list_price BETWEEN 65 * 0.01 AND 75 * 0.01 UNION SELECT DISTINCT cs_ship_customer_sk AS customer_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_items ON cs_item_sk = i_item_sk WHERE cs_sales_price / cs_list_price BETWEEN 65 * 0.01 AND 75 * 0.01) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM customer AS c, customer_address AS ca, customer_demographics WHERE c.c_current_addr_sk = ca.ca_address_sk AND ca_county IN ('Alameda County', 'Lexington city', 'Pender County', 'Petroleum County', 'Walworth County') AND c.c_birth_month IN (4, 5) AND cd_demo_sk = c.c_current_cdemo_sk AND cd_marital_status IN ('U', 'S', 'U') AND cd_education_status IN ('College', 'Secondary', 'College') AND cd_gender = 'M' AND EXISTS(SELECT 1 FROM valid_store_sales AS vss WHERE vss.ss_customer_sk = c.c_customer_sk) AND (EXISTS(SELECT 1 FROM valid_web_or_catalog_sales AS vwcs WHERE vwcs.customer_sk = c.c_customer_sk)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "0e0af79bcaf053bebe336db57953ae57",
    "patch_cksum": "0e0af79bcaf053bebe336db57953ae57",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query013_agg_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select avg(ss_quantity)\n,avg(ss_ext_sales_price)\n,avg(ss_ext_wholesale_cost)\n,sum(ss_ext_wholesale_cost)\nfrom store_sales\n   ,store\n   ,customer_demographics\n   ,household_demographics\n   ,customer_address\n   ,date_dim\nwhere s_store_sk = ss_store_sk\nand  ss_sold_date_sk = d_date_sk and d_year = 2001\nand((ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'M'\nand cd_education_status = '2 yr Degree'\nand ss_sales_price between 100.00 and 150.00\nand hd_dep_count = 3\n   )or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'U'\nand cd_education_status = 'College'\nand ss_sales_price between 50.00 and 100.00\nand hd_dep_count = 1\n   ) or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'S'\nand cd_education_status = 'Unknown'\nand ss_sales_price between 150.00 and 200.00\nand hd_dep_count = 1\n   ))\nand((ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('CO', 'NC', 'TX')\nand ss_net_profit between 100 and 200\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('AR', 'NY', 'TX')\nand ss_net_profit between 150 and 300\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('IA', 'IL', 'NC')\nand ss_net_profit between 50 and 250\n   ))\n;",
    "patch_sql": "WITH valid_demo AS (SELECT cd_demo_sk, hd_demo_sk FROM customer_demographics, household_demographics WHERE ((cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND hd_dep_count = 3) OR (cd_marital_status = 'U' AND cd_education_status = 'College' AND hd_dep_count = 1) OR (cd_marital_status = 'S' AND cd_education_status = 'Unknown' AND hd_dep_count = 1))), valid_addr AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ((ca_state IN ('CO', 'NC', 'TX')) OR (ca_state IN ('AR', 'NY', 'TX')) OR (ca_state IN ('IA', 'IL', 'NC')))) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM store_sales JOIN store ON s_store_sk = ss_store_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN valid_demo ON ss_cdemo_sk = valid_demo.cd_demo_sk AND ss_hdemo_sk = valid_demo.hd_demo_sk JOIN valid_addr ON ss_addr_sk = valid_addr.ca_address_sk WHERE d_year = 2001 AND ((ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 100 AND 200) OR (ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 300) OR (ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 250));",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 275542bcad9f56dce5055ced8bc67d5a vs a8d26fed",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "6336644b43b99b679b57e516dafd9d44",
    "patch_cksum": "6336644b43b99b679b57e516dafd9d44",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query013_agg_i1",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "select avg(ss_quantity)\n,avg(ss_ext_sales_price)\n,avg(ss_ext_wholesale_cost)\n,sum(ss_ext_wholesale_cost)\nfrom store_sales\n   ,store\n   ,customer_demographics\n   ,household_demographics\n   ,customer_address\n   ,date_dim\nwhere s_store_sk = ss_store_sk\nand  ss_sold_date_sk = d_date_sk and d_year = 2001\nand((ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'M'\nand cd_education_status = '2 yr Degree'\nand ss_sales_price between 100.00 and 150.00\nand hd_dep_count = 3\n   )or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'U'\nand cd_education_status = 'College'\nand ss_sales_price between 50.00 and 100.00\nand hd_dep_count = 1\n   ) or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'S'\nand cd_education_status = 'Unknown'\nand ss_sales_price between 150.00 and 200.00\nand hd_dep_count = 1\n   ))\nand((ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('CO', 'NC', 'TX')\nand ss_net_profit between 100 and 200\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('AR', 'NY', 'TX')\nand ss_net_profit between 150 and 300\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('IA', 'IL', 'NC')\nand ss_net_profit between 50 and 250\n   ))\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM store_sales JOIN store ON s_store_sk = ss_store_sk JOIN filtered_dates ON ss_sold_date_sk = filtered_dates.d_date_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON hd_demo_sk = ss_hdemo_sk JOIN customer_address ON ca_address_sk = ss_addr_sk WHERE ((ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'U' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'Unknown' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'NC', 'TX') AND ss_net_profit BETWEEN 100 AND 200) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('AR', 'NY', 'TX') AND ss_net_profit BETWEEN 150 AND 300) OR (ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('IA', 'IL', 'NC') AND ss_net_profit BETWEEN 50 AND 250));",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "6336644b43b99b679b57e516dafd9d44",
    "patch_cksum": "6336644b43b99b679b57e516dafd9d44",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query013_agg_i1",
    "patch_id": "syn_w2",
    "iteration": 0,
    "original_sql": "select avg(ss_quantity)\n,avg(ss_ext_sales_price)\n,avg(ss_ext_wholesale_cost)\n,sum(ss_ext_wholesale_cost)\nfrom store_sales\n   ,store\n   ,customer_demographics\n   ,household_demographics\n   ,customer_address\n   ,date_dim\nwhere s_store_sk = ss_store_sk\nand  ss_sold_date_sk = d_date_sk and d_year = 2001\nand((ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'M'\nand cd_education_status = '2 yr Degree'\nand ss_sales_price between 100.00 and 150.00\nand hd_dep_count = 3\n   )or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'U'\nand cd_education_status = 'College'\nand ss_sales_price between 50.00 and 100.00\nand hd_dep_count = 1\n   ) or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'S'\nand cd_education_status = 'Unknown'\nand ss_sales_price between 150.00 and 200.00\nand hd_dep_count = 1\n   ))\nand((ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('CO', 'NC', 'TX')\nand ss_net_profit between 100 and 200\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('AR', 'NY', 'TX')\nand ss_net_profit between 150 and 300\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('IA', 'IL', 'NC')\nand ss_net_profit between 50 and 250\n   ))\n;",
    "patch_sql": "WITH valid_demo AS (SELECT cd_demo_sk, hd_demo_sk FROM customer_demographics, household_demographics WHERE (cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND hd_dep_count = 3) OR (cd_marital_status = 'U' AND cd_education_status = 'College' AND hd_dep_count = 1) OR (cd_marital_status = 'S' AND cd_education_status = 'Unknown' AND hd_dep_count = 1)), valid_addr AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND (ca_state IN ('CO', 'NC', 'TX') OR ca_state IN ('AR', 'NY', 'TX') OR ca_state IN ('IA', 'IL', 'NC'))) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM store_sales JOIN store ON s_store_sk = ss_store_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN valid_demo ON ss_cdemo_sk = valid_demo.cd_demo_sk AND ss_hdemo_sk = valid_demo.hd_demo_sk JOIN valid_addr ON ss_addr_sk = valid_addr.ca_address_sk WHERE d_year = 2001 AND ((ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 100 AND 200) OR (ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 300) OR (ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 250));",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 275542bcad9f56dce5055ced8bc67d5a vs a8d26fed",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "6336644b43b99b679b57e516dafd9d44",
    "patch_cksum": "6336644b43b99b679b57e516dafd9d44",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query013_agg_i1",
    "patch_id": "syn_w3",
    "iteration": 0,
    "original_sql": "select avg(ss_quantity)\n,avg(ss_ext_sales_price)\n,avg(ss_ext_wholesale_cost)\n,sum(ss_ext_wholesale_cost)\nfrom store_sales\n   ,store\n   ,customer_demographics\n   ,household_demographics\n   ,customer_address\n   ,date_dim\nwhere s_store_sk = ss_store_sk\nand  ss_sold_date_sk = d_date_sk and d_year = 2001\nand((ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'M'\nand cd_education_status = '2 yr Degree'\nand ss_sales_price between 100.00 and 150.00\nand hd_dep_count = 3\n   )or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'U'\nand cd_education_status = 'College'\nand ss_sales_price between 50.00 and 100.00\nand hd_dep_count = 1\n   ) or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'S'\nand cd_education_status = 'Unknown'\nand ss_sales_price between 150.00 and 200.00\nand hd_dep_count = 1\n   ))\nand((ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('CO', 'NC', 'TX')\nand ss_net_profit between 100 and 200\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('AR', 'NY', 'TX')\nand ss_net_profit between 150 and 300\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('IA', 'IL', 'NC')\nand ss_net_profit between 50 and 250\n   ))\n;",
    "patch_sql": "WITH valid_demo AS (SELECT cd_demo_sk, hd_demo_sk FROM customer_demographics, household_demographics WHERE ((cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND hd_dep_count = 3) OR (cd_marital_status = 'U' AND cd_education_status = 'College' AND hd_dep_count = 1) OR (cd_marital_status = 'S' AND cd_education_status = 'Unknown' AND hd_dep_count = 1))), valid_addr AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ((ca_state IN ('CO', 'NC', 'TX')) OR (ca_state IN ('AR', 'NY', 'TX')) OR (ca_state IN ('IA', 'IL', 'NC')))) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM store_sales JOIN store ON s_store_sk = ss_store_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN valid_demo ON ss_cdemo_sk = valid_demo.cd_demo_sk AND ss_hdemo_sk = valid_demo.hd_demo_sk JOIN valid_addr ON ss_addr_sk = valid_addr.ca_address_sk WHERE d_year = 2001 AND ((ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 100 AND 200) OR (ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 300) OR (ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 250));",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 275542bcad9f56dce5055ced8bc67d5a vs a8d26fed",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "6336644b43b99b679b57e516dafd9d44",
    "patch_cksum": "6336644b43b99b679b57e516dafd9d44",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query013_agg_i1",
    "patch_id": "t3",
    "iteration": 2,
    "original_sql": "select avg(ss_quantity)\n,avg(ss_ext_sales_price)\n,avg(ss_ext_wholesale_cost)\n,sum(ss_ext_wholesale_cost)\nfrom store_sales\n   ,store\n   ,customer_demographics\n   ,household_demographics\n   ,customer_address\n   ,date_dim\nwhere s_store_sk = ss_store_sk\nand  ss_sold_date_sk = d_date_sk and d_year = 2001\nand((ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'M'\nand cd_education_status = '2 yr Degree'\nand ss_sales_price between 100.00 and 150.00\nand hd_dep_count = 3\n   )or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'U'\nand cd_education_status = 'College'\nand ss_sales_price between 50.00 and 100.00\nand hd_dep_count = 1\n   ) or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'S'\nand cd_education_status = 'Unknown'\nand ss_sales_price between 150.00 and 200.00\nand hd_dep_count = 1\n   ))\nand((ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('CO', 'NC', 'TX')\nand ss_net_profit between 100 and 200\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('AR', 'NY', 'TX')\nand ss_net_profit between 150 and 300\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('IA', 'IL', 'NC')\nand ss_net_profit between 50 and 250\n   ))\n;",
    "patch_sql": "WITH filtered_store_sales AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_sold_date_sk, ss_store_sk, ss_hdemo_sk, ss_cdemo_sk, ss_addr_sk, ss_sales_price, ss_net_profit FROM store_sales WHERE EXISTS(SELECT 1 FROM date_dim WHERE d_date_sk = ss_sold_date_sk AND d_year = 2001)), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM filtered_store_sales AS ss INNER JOIN store AS s ON s.s_store_sk = ss.ss_store_sk INNER JOIN filtered_dates AS d ON d.d_date_sk = ss.ss_sold_date_sk INNER JOIN household_demographics AS hd ON hd.hd_demo_sk = ss.ss_hdemo_sk INNER JOIN customer_demographics AS cd ON cd.cd_demo_sk = ss.ss_cdemo_sk INNER JOIN customer_address AS ca ON ca.ca_address_sk = ss.ss_addr_sk WHERE ((hd.hd_demo_sk = ss.ss_hdemo_sk AND cd.cd_demo_sk = ss.ss_cdemo_sk AND cd.cd_marital_status = 'M' AND cd.cd_education_status = '2 yr Degree' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND hd.hd_dep_count = 3) OR (hd.hd_demo_sk = ss.ss_hdemo_sk AND cd.cd_demo_sk = ss.ss_cdemo_sk AND cd.cd_marital_status = 'U' AND cd.cd_education_status = 'College' AND ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND hd.hd_dep_count = 1) OR (hd.hd_demo_sk = ss.ss_hdemo_sk AND cd.cd_demo_sk = ss.ss_cdemo_sk AND cd.cd_marital_status = 'S' AND cd.cd_education_status = 'Unknown' AND ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND hd.hd_dep_count = 1)) AND ((ca.ca_address_sk = ss.ss_addr_sk AND ca.ca_country = 'United States' AND ca.ca_state IN ('CO', 'NC', 'TX') AND ss.ss_net_profit BETWEEN 100 AND 200) OR (ca.ca_address_sk = ss.ss_addr_sk AND ca.ca_country = 'United States' AND ca.ca_state IN ('AR', 'NY', 'TX') AND ss.ss_net_profit BETWEEN 150 AND 300) OR (ca.ca_address_sk = ss.ss_addr_sk AND ca.ca_country = 'United States' AND ca.ca_state IN ('IA', 'IL', 'NC') AND ss.ss_net_profit BETWEEN 50 AND 250));",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "6336644b43b99b679b57e516dafd9d44",
    "patch_cksum": "6336644b43b99b679b57e516dafd9d44",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query013_agg_i2",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select avg(ss_quantity)\n,avg(ss_ext_sales_price)\n,avg(ss_ext_wholesale_cost)\n,sum(ss_ext_wholesale_cost)\nfrom store_sales\n   ,store\n   ,customer_demographics\n   ,household_demographics\n   ,customer_address\n   ,date_dim\nwhere s_store_sk = ss_store_sk\nand  ss_sold_date_sk = d_date_sk and d_year = 2001\nand((ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'M'\nand cd_education_status = '2 yr Degree'\nand ss_sales_price between 100.00 and 150.00\nand hd_dep_count = 3\n   )or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'S'\nand cd_education_status = 'Primary'\nand ss_sales_price between 50.00 and 100.00\nand hd_dep_count = 1\n   ) or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'W'\nand cd_education_status = 'Primary'\nand ss_sales_price between 150.00 and 200.00\nand hd_dep_count = 1\n   ))\nand((ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('GA', 'KY', 'SD')\nand ss_net_profit between 100 and 200\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('AR', 'IN', 'VA')\nand ss_net_profit between 150 and 300\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('KS', 'OH', 'SD')\nand ss_net_profit between 50 and 250\n   ))\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN household_demographics ON hd_demo_sk = ss_hdemo_sk JOIN customer_address ON ca_address_sk = ss_addr_sk WHERE ((cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (cd_marital_status = 'S' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (cd_marital_status = 'W' AND cd_education_status = 'Primary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD') AND ss_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'IN', 'VA') AND ss_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'SD') AND ss_net_profit BETWEEN 50 AND 250));",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "d8dcb348cadbc577e1aa4a5b837ced3f",
    "patch_cksum": "d8dcb348cadbc577e1aa4a5b837ced3f",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query013_agg_i2",
    "patch_id": "t3",
    "iteration": 1,
    "original_sql": "select avg(ss_quantity)\n,avg(ss_ext_sales_price)\n,avg(ss_ext_wholesale_cost)\n,sum(ss_ext_wholesale_cost)\nfrom store_sales\n   ,store\n   ,customer_demographics\n   ,household_demographics\n   ,customer_address\n   ,date_dim\nwhere s_store_sk = ss_store_sk\nand  ss_sold_date_sk = d_date_sk and d_year = 2001\nand((ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'M'\nand cd_education_status = '2 yr Degree'\nand ss_sales_price between 100.00 and 150.00\nand hd_dep_count = 3\n   )or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'S'\nand cd_education_status = 'Primary'\nand ss_sales_price between 50.00 and 100.00\nand hd_dep_count = 1\n   ) or\n   (ss_hdemo_sk=hd_demo_sk\nand cd_demo_sk = ss_cdemo_sk\nand cd_marital_status = 'W'\nand cd_education_status = 'Primary'\nand ss_sales_price between 150.00 and 200.00\nand hd_dep_count = 1\n   ))\nand((ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('GA', 'KY', 'SD')\nand ss_net_profit between 100 and 200\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('AR', 'IN', 'VA')\nand ss_net_profit between 150 and 300\n   ) or\n   (ss_addr_sk = ca_address_sk\nand ca_country = 'United States'\nand ca_state in ('KS', 'OH', 'SD')\nand ss_net_profit between 50 and 250\n   ))\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), sales_branches AS (SELECT ss_store_sk, ss_hdemo_sk, ss_cdemo_sk, ss_addr_sk, ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_net_profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk WHERE ((NOT ss_hdemo_sk IS NULL AND NOT ss_cdemo_sk IS NULL AND EXISTS(SELECT 1 FROM household_demographics, customer_demographics WHERE hd_demo_sk = ss_hdemo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '2 yr Degree' AND hd_dep_count = 3) AND ss_sales_price BETWEEN 100.00 AND 150.00) OR (NOT ss_hdemo_sk IS NULL AND NOT ss_cdemo_sk IS NULL AND EXISTS(SELECT 1 FROM household_demographics, customer_demographics WHERE hd_demo_sk = ss_hdemo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'Primary' AND hd_dep_count = 1) AND ss_sales_price BETWEEN 50.00 AND 100.00) OR (NOT ss_hdemo_sk IS NULL AND NOT ss_cdemo_sk IS NULL AND EXISTS(SELECT 1 FROM household_demographics, customer_demographics WHERE hd_demo_sk = ss_hdemo_sk AND cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'W' AND cd_education_status = 'Primary' AND hd_dep_count = 1) AND ss_sales_price BETWEEN 150.00 AND 200.00)) AND ((NOT ss_addr_sk IS NULL AND EXISTS(SELECT 1 FROM customer_address WHERE ca_address_sk = ss_addr_sk AND ca_country = 'United States' AND ca_state IN ('GA', 'KY', 'SD')) AND ss_net_profit BETWEEN 100 AND 200) OR (NOT ss_addr_sk IS NULL AND EXISTS(SELECT 1 FROM customer_address WHERE ca_address_sk = ss_addr_sk AND ca_country = 'United States' AND ca_state IN ('AR', 'IN', 'VA')) AND ss_net_profit BETWEEN 150 AND 300) OR (NOT ss_addr_sk IS NULL AND EXISTS(SELECT 1 FROM customer_address WHERE ca_address_sk = ss_addr_sk AND ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'SD')) AND ss_net_profit BETWEEN 50 AND 250))) SELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost) FROM sales_branches JOIN store ON ss_store_sk = s_store_sk WHERE TRUE;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "d8dcb348cadbc577e1aa4a5b837ced3f",
    "patch_cksum": "d8dcb348cadbc577e1aa4a5b837ced3f",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query013_spj_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select min(ss_quantity)\n       ,min(ss_ext_sales_price)\n       ,min(ss_ext_wholesale_cost)\n       ,min(ss_ext_wholesale_cost)\n from store_sales\n     ,store\n     ,customer_demographics\n     ,household_demographics\n     ,customer_address\n     ,date_dim\n where s_store_sk = ss_store_sk\n and  ss_sold_date_sk = d_date_sk and d_year = 2001\n and((ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'M'\n  and cd_education_status = '2 yr Degree'\n  and ss_sales_price between 100.00 and 150.00\n  and hd_dep_count = 3\n     )or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'S'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 50.00 and 100.00\n  and hd_dep_count = 1\n     ) or\n     (ss_hdemo_sk=hd_demo_sk\n  and cd_demo_sk = ss_cdemo_sk\n  and cd_marital_status = 'W'\n  and cd_education_status = 'Primary'\n  and ss_sales_price between 150.00 and 200.00\n  and hd_dep_count = 1\n     ))\n and((ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('GA', 'KY', 'SD')\n  and ss_net_profit between 100 and 200\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('AR', 'IN', 'VA')\n  and ss_net_profit between 150 and 300\n     ) or\n     (ss_addr_sk = ca_address_sk\n  and ca_country = 'United States'\n  and ca_state in ('KS', 'OH', 'SD')\n  and ss_net_profit between 50 and 250\n     ))\n;",
    "patch_sql": "WITH prefetch_demo AS (SELECT cd_demo_sk FROM customer_demographics WHERE (cd_marital_status = 'M' AND cd_education_status = '2 yr Degree') OR (cd_marital_status = 'S' AND cd_education_status = 'Primary') OR (cd_marital_status = 'W' AND cd_education_status = 'Primary')), prefetch_addr AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ((ca_state IN ('GA', 'KY', 'SD')) OR (ca_state IN ('AR', 'IN', 'VA')) OR (ca_state IN ('KS', 'OH', 'SD')))) SELECT MIN(ss_quantity), MIN(ss_ext_sales_price), MIN(ss_ext_wholesale_cost), MIN(ss_ext_wholesale_cost) FROM store_sales JOIN store ON s_store_sk = ss_store_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN prefetch_demo ON cd_demo_sk = ss_cdemo_sk JOIN prefetch_addr ON ss_addr_sk = ca_address_sk WHERE d_year = 2001 AND ((ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((ss_net_profit BETWEEN 100 AND 200) OR (ss_net_profit BETWEEN 150 AND 300) OR (ss_net_profit BETWEEN 50 AND 250));",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 5744d10483ec10b066200cd385872de5 vs 3025a908",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "fa3c07e65d5665ed7bf4854364bcc152",
    "patch_cksum": "fa3c07e65d5665ed7bf4854364bcc152",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query014_multi_i1",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "with  cross_items as\n (select i_item_sk ss_item_sk\n from item,\n (select iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,item iss\n     ,date_dim d1\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n   and i_category IN ('Electronics', 'Jewelry', 'Men')\n   and i_manager_id BETWEEN 91 and 100\n   and ss_wholesale_cost BETWEEN 35 AND 55\nintersect\n select ics.i_brand_id\n     ,ics.i_class_id\n     ,ics.i_category_id\n from catalog_sales\n     ,item ics\n     ,date_dim d2\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n   and i_category IN ('Electronics', 'Jewelry', 'Men')\n   and i_manager_id BETWEEN 91 and 100\n   and cs_wholesale_cost BETWEEN 35 AND 55\nintersect\n select iws.i_brand_id\n     ,iws.i_class_id\n     ,iws.i_category_id\n from web_sales\n     ,item iws\n     ,date_dim d3\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and ws_wholesale_cost BETWEEN 35 AND 55\n   and d3.d_year between 1999 AND 1999 + 2) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n      and i_category IN ('Electronics', 'Jewelry', 'Men')\n      and i_manager_id BETWEEN 91 and 100\n),\n avg_sales as\n(select avg(quantity*list_price) average_sales\n  from (select ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 1999 + 2\n         and ss_wholesale_cost BETWEEN 35 AND 55\n       union all\n       select cs_quantity quantity\n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1999 and 1999 + 2\n         and cs_wholesale_cost BETWEEN 35 AND 55\n       union all\n       select ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n        and ws_wholesale_cost BETWEEN 35 AND 55\n         and d_year between 1999 and 1999 + 2) x)\n  select  this_year.channel ty_channel\n                           ,this_year.i_brand_id ty_brand\n                           ,this_year.i_class_id ty_class\n                           ,this_year.i_category_id ty_category\n                           ,this_year.sales ty_sales\n                           ,this_year.number_sales ty_number_sales\n                           ,last_year.channel ly_channel\n                           ,last_year.i_brand_id ly_brand\n                           ,last_year.i_class_id ly_class\n                           ,last_year.i_category_id ly_category\n                           ,last_year.sales ly_sales\n                           ,last_year.number_sales ly_number_sales\n from\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk in (select ss_item_sk from cross_items)\n   and ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_week_seq = (select d_week_seq\n                     from date_dim\n                     where d_year = 1999 + 1\n                       and d_moy = 12\n                       and d_dom = 20)\n   and i_category IN ('Electronics', 'Jewelry', 'Men')\n   and i_manager_id BETWEEN 91 and 100\n   and ss_wholesale_cost BETWEEN 35 AND 55\n group by i_brand_id,i_class_id,i_category_id\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\n (select 'store' channel, i_brand_id,i_class_id\n        ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales\n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk in (select ss_item_sk from cross_items)\n   and ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_week_seq = (select d_week_seq\n                     from date_dim\n                     where d_year = 1999\n                       and d_moy = 12\n                       and d_dom = 20)\n   and i_category IN ('Electronics', 'Jewelry', 'Men')\n   and ss_wholesale_cost BETWEEN 35 AND 55\n   and i_manager_id BETWEEN 91 and 100\ngroup by i_brand_id,i_class_id,i_category_id\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\n where this_year.i_brand_id= last_year.i_brand_id\n   and this_year.i_class_id = last_year.i_class_id\n   and this_year.i_category_id = last_year.i_category_id\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\n limit 100;",
    "patch_sql": "WITH cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item, (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales, item AS iss, date_dim AS d1 WHERE ss_item_sk = iss.i_item_sk AND ss_sold_date_sk = d1.d_date_sk AND d1.d_year BETWEEN 1999 AND 1999 + 2 AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales, item AS ics, date_dim AS d2 WHERE cs_item_sk = ics.i_item_sk AND cs_sold_date_sk = d2.d_date_sk AND d2.d_year BETWEEN 1999 AND 1999 + 2 AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND cs_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales, item AS iws, date_dim AS d3 WHERE ws_item_sk = iws.i_item_sk AND ws_sold_date_sk = d3.d_date_sk AND ws_wholesale_cost BETWEEN 35 AND 55 AND d3.d_year BETWEEN 1999 AND 1999 + 2) AS x WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 AND ss_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 AND cs_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales, date_dim WHERE ws_sold_date_sk = d_date_sk AND ws_wholesale_cost BETWEEN 35 AND 55 AND d_year BETWEEN 1999 AND 1999 + 2) AS x), store_agg AS (SELECT SUM(ss_quantity * ss_list_price) AS sum_sales, COUNT(*) AS cnt FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 2001 AND ss_wholesale_cost BETWEEN 35 AND 55), catalog_agg AS (SELECT SUM(cs_quantity * cs_list_price) AS sum_sales, COUNT(*) AS cnt FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 2001 AND cs_wholesale_cost BETWEEN 35 AND 55), web_agg AS (SELECT SUM(ws_quantity * ws_list_price) AS sum_sales, COUNT(*) AS cnt FROM web_sales, date_dim WHERE ws_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 2001 AND ws_wholesale_cost BETWEEN 35 AND 55) SELECT this_year.channel AS ty_channel, this_year.i_brand_id AS ty_brand, this_year.i_class_id AS ty_class, this_year.i_category_id AS ty_category, this_year.sales AS ty_sales, this_year.number_sales AS ty_number_sales, last_year.channel AS ly_channel, last_year.i_brand_id AS ly_brand, last_year.i_class_id AS ly_class, last_year.i_category_id AS ly_category, last_year.sales AS ly_sales, last_year.number_sales AS ly_number_sales FROM (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales, item, date_dim WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 20) AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS this_year, (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales, item, date_dim WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 20) AND i_category IN ('Electronics', 'Jewelry', 'Men') AND ss_wholesale_cost BETWEEN 35 AND 55 AND i_manager_id BETWEEN 91 AND 100 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS last_year WHERE this_year.i_brand_id = last_year.i_brand_id AND this_year.i_class_id = last_year.i_class_id AND this_year.i_category_id = last_year.i_category_id ORDER BY this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query014_multi_i1",
    "patch_id": "novel_1",
    "iteration": 1,
    "original_sql": "with  cross_items as\n (select i_item_sk ss_item_sk\n from item,\n (select iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,item iss\n     ,date_dim d1\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n   and i_category IN ('Electronics', 'Jewelry', 'Men')\n   and i_manager_id BETWEEN 91 and 100\n   and ss_wholesale_cost BETWEEN 35 AND 55\nintersect\n select ics.i_brand_id\n     ,ics.i_class_id\n     ,ics.i_category_id\n from catalog_sales\n     ,item ics\n     ,date_dim d2\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n   and i_category IN ('Electronics', 'Jewelry', 'Men')\n   and i_manager_id BETWEEN 91 and 100\n   and cs_wholesale_cost BETWEEN 35 AND 55\nintersect\n select iws.i_brand_id\n     ,iws.i_class_id\n     ,iws.i_category_id\n from web_sales\n     ,item iws\n     ,date_dim d3\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and ws_wholesale_cost BETWEEN 35 AND 55\n   and d3.d_year between 1999 AND 1999 + 2) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n      and i_category IN ('Electronics', 'Jewelry', 'Men')\n      and i_manager_id BETWEEN 91 and 100\n),\n avg_sales as\n(select avg(quantity*list_price) average_sales\n  from (select ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 1999 + 2\n         and ss_wholesale_cost BETWEEN 35 AND 55\n       union all\n       select cs_quantity quantity\n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1999 and 1999 + 2\n         and cs_wholesale_cost BETWEEN 35 AND 55\n       union all\n       select ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n        and ws_wholesale_cost BETWEEN 35 AND 55\n         and d_year between 1999 and 1999 + 2) x)\n  select  this_year.channel ty_channel\n                           ,this_year.i_brand_id ty_brand\n                           ,this_year.i_class_id ty_class\n                           ,this_year.i_category_id ty_category\n                           ,this_year.sales ty_sales\n                           ,this_year.number_sales ty_number_sales\n                           ,last_year.channel ly_channel\n                           ,last_year.i_brand_id ly_brand\n                           ,last_year.i_class_id ly_class\n                           ,last_year.i_category_id ly_category\n                           ,last_year.sales ly_sales\n                           ,last_year.number_sales ly_number_sales\n from\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk in (select ss_item_sk from cross_items)\n   and ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_week_seq = (select d_week_seq\n                     from date_dim\n                     where d_year = 1999 + 1\n                       and d_moy = 12\n                       and d_dom = 20)\n   and i_category IN ('Electronics', 'Jewelry', 'Men')\n   and i_manager_id BETWEEN 91 and 100\n   and ss_wholesale_cost BETWEEN 35 AND 55\n group by i_brand_id,i_class_id,i_category_id\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\n (select 'store' channel, i_brand_id,i_class_id\n        ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales\n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk in (select ss_item_sk from cross_items)\n   and ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_week_seq = (select d_week_seq\n                     from date_dim\n                     where d_year = 1999\n                       and d_moy = 12\n                       and d_dom = 20)\n   and i_category IN ('Electronics', 'Jewelry', 'Men')\n   and ss_wholesale_cost BETWEEN 35 AND 55\n   and i_manager_id BETWEEN 91 and 100\ngroup by i_brand_id,i_class_id,i_category_id\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\n where this_year.i_brand_id= last_year.i_brand_id\n   and this_year.i_class_id = last_year.i_class_id\n   and this_year.i_category_id = last_year.i_category_id\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\n limit 100;",
    "patch_sql": "WITH cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item JOIN (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales JOIN item AS iss ON ss_item_sk = iss.i_item_sk JOIN date_dim AS d1 ON ss_sold_date_sk = d1.d_date_sk WHERE d1.d_year BETWEEN 1999 AND 1999 + 2 AND iss.i_category IN ('Electronics', 'Jewelry', 'Men') AND iss.i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales JOIN item AS ics ON cs_item_sk = ics.i_item_sk JOIN date_dim AS d2 ON cs_sold_date_sk = d2.d_date_sk WHERE d2.d_year BETWEEN 1999 AND 1999 + 2 AND ics.i_category IN ('Electronics', 'Jewelry', 'Men') AND ics.i_manager_id BETWEEN 91 AND 100 AND cs_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales JOIN item AS iws ON ws_item_sk = iws.i_item_sk JOIN date_dim AS d3 ON ws_sold_date_sk = d3.d_date_sk WHERE d3.d_year BETWEEN 1999 AND 1999 + 2 AND iws.i_category IN ('Electronics', 'Jewelry', 'Men') AND iws.i_manager_id BETWEEN 91 AND 100 AND ws_wholesale_cost BETWEEN 35 AND 55) AS x ON i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id WHERE i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND ss_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT cs_quantity, cs_list_price FROM catalog_sales JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND cs_wholesale_cost BETWEEN 35 AND 55 UNION ALL SELECT ws_quantity, ws_list_price FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1999 AND 1999 + 2 AND ws_wholesale_cost BETWEEN 35 AND 55) AS x) SELECT this_year.channel AS ty_channel, this_year.i_brand_id AS ty_brand, this_year.i_class_id AS ty_class, this_year.i_category_id AS ty_category, this_year.sales AS ty_sales, this_year.number_sales AS ty_number_sales, last_year.channel AS ly_channel, last_year.i_brand_id AS ly_brand, last_year.i_class_id AS ly_class, last_year.i_category_id AS ly_category, last_year.sales AS ly_sales, last_year.number_sales AS ly_number_sales FROM (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 20) AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS this_year, (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 20) AND i_category IN ('Electronics', 'Jewelry', 'Men') AND i_manager_id BETWEEN 91 AND 100 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS last_year WHERE this_year.i_brand_id = last_year.i_brand_id AND this_year.i_class_id = last_year.i_class_id AND this_year.i_category_id = last_year.i_category_id ORDER BY this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query014_multi_i2",
    "patch_id": "t2",
    "iteration": 1,
    "original_sql": "with  cross_items as\n (select i_item_sk ss_item_sk\n from item,\n (select iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,item iss\n     ,date_dim d1\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n   and i_category IN ('Electronics', 'Shoes', 'Sports')\n   and i_manager_id BETWEEN 42 and 51\n   and ss_wholesale_cost BETWEEN 76 AND 96\nintersect\n select ics.i_brand_id\n     ,ics.i_class_id\n     ,ics.i_category_id\n from catalog_sales\n     ,item ics\n     ,date_dim d2\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n   and i_category IN ('Electronics', 'Shoes', 'Sports')\n   and i_manager_id BETWEEN 42 and 51\n   and cs_wholesale_cost BETWEEN 76 AND 96\nintersect\n select iws.i_brand_id\n     ,iws.i_class_id\n     ,iws.i_category_id\n from web_sales\n     ,item iws\n     ,date_dim d3\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and ws_wholesale_cost BETWEEN 76 AND 96\n   and d3.d_year between 1999 AND 1999 + 2) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n      and i_category IN ('Electronics', 'Shoes', 'Sports')\n      and i_manager_id BETWEEN 42 and 51\n),\n avg_sales as\n(select avg(quantity*list_price) average_sales\n  from (select ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 1999 + 2\n         and ss_wholesale_cost BETWEEN 76 AND 96\n       union all\n       select cs_quantity quantity\n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1999 and 1999 + 2\n         and cs_wholesale_cost BETWEEN 76 AND 96\n       union all\n       select ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n        and ws_wholesale_cost BETWEEN 76 AND 96\n         and d_year between 1999 and 1999 + 2) x)\n  select  this_year.channel ty_channel\n                           ,this_year.i_brand_id ty_brand\n                           ,this_year.i_class_id ty_class\n                           ,this_year.i_category_id ty_category\n                           ,this_year.sales ty_sales\n                           ,this_year.number_sales ty_number_sales\n                           ,last_year.channel ly_channel\n                           ,last_year.i_brand_id ly_brand\n                           ,last_year.i_class_id ly_class\n                           ,last_year.i_category_id ly_category\n                           ,last_year.sales ly_sales\n                           ,last_year.number_sales ly_number_sales\n from\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk in (select ss_item_sk from cross_items)\n   and ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_week_seq = (select d_week_seq\n                     from date_dim\n                     where d_year = 1999 + 1\n                       and d_moy = 12\n                       and d_dom = 12)\n   and i_category IN ('Electronics', 'Shoes', 'Sports')\n   and i_manager_id BETWEEN 42 and 51\n   and ss_wholesale_cost BETWEEN 76 AND 96\n group by i_brand_id,i_class_id,i_category_id\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\n (select 'store' channel, i_brand_id,i_class_id\n        ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales\n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk in (select ss_item_sk from cross_items)\n   and ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_week_seq = (select d_week_seq\n                     from date_dim\n                     where d_year = 1999\n                       and d_moy = 12\n                       and d_dom = 12)\n   and i_category IN ('Electronics', 'Shoes', 'Sports')\n   and ss_wholesale_cost BETWEEN 76 AND 96\n   and i_manager_id BETWEEN 42 and 51\ngroup by i_brand_id,i_class_id,i_category_id\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\n where this_year.i_brand_id= last_year.i_brand_id\n   and this_year.i_class_id = last_year.i_class_id\n   and this_year.i_category_id = last_year.i_category_id\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\n limit 100;",
    "patch_sql": "WITH cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item, (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales, item AS iss, date_dim AS d1 WHERE ss_item_sk = iss.i_item_sk AND ss_sold_date_sk = d1.d_date_sk AND d1.d_year BETWEEN 1999 AND 1999 + 2 AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales, item AS ics, date_dim AS d2 WHERE cs_item_sk = ics.i_item_sk AND cs_sold_date_sk = d2.d_date_sk AND d2.d_year BETWEEN 1999 AND 1999 + 2 AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales, item AS iws, date_dim AS d3 WHERE ws_item_sk = iws.i_item_sk AND ws_sold_date_sk = d3.d_date_sk AND ws_wholesale_cost BETWEEN 76 AND 96 AND d3.d_year BETWEEN 1999 AND 1999 + 2) AS x WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 AND ss_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 AND cs_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales, date_dim WHERE ws_sold_date_sk = d_date_sk AND ws_wholesale_cost BETWEEN 76 AND 96 AND d_year BETWEEN 1999 AND 1999 + 2) AS x) SELECT this_year.channel AS ty_channel, this_year.i_brand_id AS ty_brand, this_year.i_class_id AS ty_class, this_year.i_category_id AS ty_category, this_year.sales AS ty_sales, this_year.number_sales AS ty_number_sales, last_year.channel AS ly_channel, last_year.i_brand_id AS ly_brand, last_year.i_class_id AS ly_class, last_year.i_category_id AS ly_category, last_year.sales AS ly_sales, last_year.number_sales AS ly_number_sales FROM (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales, item, date_dim WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 12) AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51 AND ss_wholesale_cost BETWEEN 76 AND 96 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS this_year, (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales, item, date_dim WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 12) AND i_category IN ('Electronics', 'Shoes', 'Sports') AND ss_wholesale_cost BETWEEN 76 AND 96 AND i_manager_id BETWEEN 42 AND 51 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) AS last_year WHERE this_year.i_brand_id = last_year.i_brand_id AND this_year.i_class_id = last_year.i_class_id AND this_year.i_category_id = last_year.i_category_id ORDER BY this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "9925cb9230f85e0c6f81d9b9cf3e45c6",
    "patch_cksum": "9925cb9230f85e0c6f81d9b9cf3e45c6",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query014_multi_i2",
    "patch_id": "t2",
    "iteration": 2,
    "original_sql": "with  cross_items as\n (select i_item_sk ss_item_sk\n from item,\n (select iss.i_brand_id brand_id\n     ,iss.i_class_id class_id\n     ,iss.i_category_id category_id\n from store_sales\n     ,item iss\n     ,date_dim d1\n where ss_item_sk = iss.i_item_sk\n   and ss_sold_date_sk = d1.d_date_sk\n   and d1.d_year between 1999 AND 1999 + 2\n   and i_category IN ('Electronics', 'Shoes', 'Sports')\n   and i_manager_id BETWEEN 42 and 51\n   and ss_wholesale_cost BETWEEN 76 AND 96\nintersect\n select ics.i_brand_id\n     ,ics.i_class_id\n     ,ics.i_category_id\n from catalog_sales\n     ,item ics\n     ,date_dim d2\n where cs_item_sk = ics.i_item_sk\n   and cs_sold_date_sk = d2.d_date_sk\n   and d2.d_year between 1999 AND 1999 + 2\n   and i_category IN ('Electronics', 'Shoes', 'Sports')\n   and i_manager_id BETWEEN 42 and 51\n   and cs_wholesale_cost BETWEEN 76 AND 96\nintersect\n select iws.i_brand_id\n     ,iws.i_class_id\n     ,iws.i_category_id\n from web_sales\n     ,item iws\n     ,date_dim d3\n where ws_item_sk = iws.i_item_sk\n   and ws_sold_date_sk = d3.d_date_sk\n   and ws_wholesale_cost BETWEEN 76 AND 96\n   and d3.d_year between 1999 AND 1999 + 2) x\n where i_brand_id = brand_id\n      and i_class_id = class_id\n      and i_category_id = category_id\n      and i_category IN ('Electronics', 'Shoes', 'Sports')\n      and i_manager_id BETWEEN 42 and 51\n),\n avg_sales as\n(select avg(quantity*list_price) average_sales\n  from (select ss_quantity quantity\n             ,ss_list_price list_price\n       from store_sales\n           ,date_dim\n       where ss_sold_date_sk = d_date_sk\n         and d_year between 1999 and 1999 + 2\n         and ss_wholesale_cost BETWEEN 76 AND 96\n       union all\n       select cs_quantity quantity\n             ,cs_list_price list_price\n       from catalog_sales\n           ,date_dim\n       where cs_sold_date_sk = d_date_sk\n         and d_year between 1999 and 1999 + 2\n         and cs_wholesale_cost BETWEEN 76 AND 96\n       union all\n       select ws_quantity quantity\n             ,ws_list_price list_price\n       from web_sales\n           ,date_dim\n       where ws_sold_date_sk = d_date_sk\n        and ws_wholesale_cost BETWEEN 76 AND 96\n         and d_year between 1999 and 1999 + 2) x)\n  select  this_year.channel ty_channel\n                           ,this_year.i_brand_id ty_brand\n                           ,this_year.i_class_id ty_class\n                           ,this_year.i_category_id ty_category\n                           ,this_year.sales ty_sales\n                           ,this_year.number_sales ty_number_sales\n                           ,last_year.channel ly_channel\n                           ,last_year.i_brand_id ly_brand\n                           ,last_year.i_class_id ly_class\n                           ,last_year.i_category_id ly_category\n                           ,last_year.sales ly_sales\n                           ,last_year.number_sales ly_number_sales\n from\n (select 'store' channel, i_brand_id,i_class_id,i_category_id\n        ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales\n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk in (select ss_item_sk from cross_items)\n   and ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_week_seq = (select d_week_seq\n                     from date_dim\n                     where d_year = 1999 + 1\n                       and d_moy = 12\n                       and d_dom = 12)\n   and i_category IN ('Electronics', 'Shoes', 'Sports')\n   and i_manager_id BETWEEN 42 and 51\n   and ss_wholesale_cost BETWEEN 76 AND 96\n group by i_brand_id,i_class_id,i_category_id\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,\n (select 'store' channel, i_brand_id,i_class_id\n        ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales\n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk in (select ss_item_sk from cross_items)\n   and ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_week_seq = (select d_week_seq\n                     from date_dim\n                     where d_year = 1999\n                       and d_moy = 12\n                       and d_dom = 12)\n   and i_category IN ('Electronics', 'Shoes', 'Sports')\n   and ss_wholesale_cost BETWEEN 76 AND 96\n   and i_manager_id BETWEEN 42 and 51\ngroup by i_brand_id,i_class_id,i_category_id\n having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year\n where this_year.i_brand_id= last_year.i_brand_id\n   and this_year.i_class_id = last_year.i_class_id\n   and this_year.i_category_id = last_year.i_category_id\n order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id\n limit 100;",
    "patch_sql": "WITH cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item, (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales, item AS iss, date_dim AS d1 WHERE ss_item_sk = iss.i_item_sk AND ss_sold_date_sk = d1.d_date_sk AND d1.d_year BETWEEN 1999 AND 1999 + 2 AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51 AND ss_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales, item AS ics, date_dim AS d2 WHERE cs_item_sk = ics.i_item_sk AND cs_sold_date_sk = d2.d_date_sk AND d2.d_year BETWEEN 1999 AND 1999 + 2 AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51 AND cs_wholesale_cost BETWEEN 76 AND 96 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales, item AS iws, date_dim AS d3 WHERE ws_item_sk = iws.i_item_sk AND ws_sold_date_sk = d3.d_date_sk AND ws_wholesale_cost BETWEEN 76 AND 96 AND d3.d_year BETWEEN 1999 AND 1999 + 2) AS x WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 AND ss_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 AND cs_wholesale_cost BETWEEN 76 AND 96 UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales, date_dim WHERE ws_sold_date_sk = d_date_sk AND ws_wholesale_cost BETWEEN 76 AND 96 AND d_year BETWEEN 1999 AND 1999 + 2) AS x), this_year_sorted AS (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales INNER JOIN item ON ss_item_sk = i_item_sk INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 12) AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51 AND ss_wholesale_cost BETWEEN 76 AND 96 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)), last_year_sorted AS (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales INNER JOIN item ON ss_item_sk = i_item_sk INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 12) AND i_category IN ('Electronics', 'Shoes', 'Sports') AND i_manager_id BETWEEN 42 AND 51 AND ss_wholesale_cost BETWEEN 76 AND 96 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales)) SELECT this_year_sorted.channel AS ty_channel, this_year_sorted.i_brand_id AS ty_brand, this_year_sorted.i_class_id AS ty_class, this_year_sorted.i_category_id AS ty_category, this_year_sorted.sales AS ty_sales, this_year_sorted.number_sales AS ty_number_sales, last_year_sorted.channel AS ly_channel, last_year_sorted.i_brand_id AS ly_brand, last_year_sorted.i_class_id AS ly_class, last_year_sorted.i_category_id AS ly_category, last_year_sorted.sales AS ly_sales, last_year_sorted.number_sales AS ly_number_sales FROM this_year_sorted JOIN last_year_sorted ON this_year_sorted.i_brand_id = last_year_sorted.i_brand_id AND this_year_sorted.i_class_id = last_year_sorted.i_class_id AND this_year_sorted.i_category_id = last_year_sorted.i_category_id ORDER BY this_year_sorted.channel, this_year_sorted.i_brand_id, this_year_sorted.i_class_id, this_year_sorted.i_category_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "9925cb9230f85e0c6f81d9b9cf3e45c6",
    "patch_cksum": "9925cb9230f85e0c6f81d9b9cf3e45c6",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query018_agg_i1",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select  i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\n        avg( cast(c_birth_year as decimal(12,2))) agg6\nfrom catalog_sales, customer_demographics, customer, customer_address, date_dim, item\nwhere cs_sold_date_sk = d_date_sk and\n      cs_item_sk = i_item_sk and\n      cs_bill_cdemo_sk = cd_demo_sk and\n      cs_bill_customer_sk = c_customer_sk and\n      cd_gender = 'F' and\n      cd_education_status = 'College' and\n      c_current_addr_sk = ca_address_sk and\n      d_year = 1998 and\n      c_birth_month = 2 and\n      ca_state in ('AR', 'NY', 'TX')\n      and cs_wholesale_cost BETWEEN 41 AND 46\n      AND i_category = 'Sports'\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state,\n        ca_county,\n\ti_item_id\n limit 100;",
    "patch_sql": "WITH filtered_customers AS (SELECT c_customer_sk, c_current_addr_sk, c_birth_month, c_birth_year FROM customer WHERE c_birth_month = 2), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998), filtered_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = 'College') SELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN item ON cs_item_sk = i_item_sk JOIN filtered_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN filtered_customers ON cs_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE ca_state IN ('AR', 'NY', 'TX') AND cs_wholesale_cost BETWEEN 41 AND 46 AND i_category = 'Sports' GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query018_agg_i1",
    "patch_id": "t2",
    "iteration": 1,
    "original_sql": "select  i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\n        avg( cast(c_birth_year as decimal(12,2))) agg6\nfrom catalog_sales, customer_demographics, customer, customer_address, date_dim, item\nwhere cs_sold_date_sk = d_date_sk and\n      cs_item_sk = i_item_sk and\n      cs_bill_cdemo_sk = cd_demo_sk and\n      cs_bill_customer_sk = c_customer_sk and\n      cd_gender = 'F' and\n      cd_education_status = 'College' and\n      c_current_addr_sk = ca_address_sk and\n      d_year = 1998 and\n      c_birth_month = 2 and\n      ca_state in ('AR', 'NY', 'TX')\n      and cs_wholesale_cost BETWEEN 41 AND 46\n      AND i_category = 'Sports'\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state,\n        ca_county,\n\ti_item_id\n limit 100;",
    "patch_sql": "WITH filtered_customers AS (SELECT c_customer_sk, c_current_addr_sk, c_birth_year FROM customer WHERE c_birth_month = 2), filtered_addresses AS (SELECT ca_address_sk, ca_country, ca_state, ca_county FROM customer_address WHERE ca_state IN ('AR', 'NY', 'TX')), customer_address_prejoin AS (SELECT fc.c_customer_sk, fc.c_birth_year, fa.ca_country, fa.ca_state, fa.ca_county FROM filtered_customers AS fc JOIN filtered_addresses AS fa ON fc.c_current_addr_sk = fa.ca_address_sk) SELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM catalog_sales, customer_demographics, customer_address_prejoin, date_dim, item WHERE cs_sold_date_sk = d_date_sk AND cs_item_sk = i_item_sk AND cs_bill_cdemo_sk = cd_demo_sk AND cs_bill_customer_sk = c_customer_sk AND cd_gender = 'F' AND cd_education_status = 'College' AND d_year = 1998 AND cs_wholesale_cost BETWEEN 41 AND 46 AND i_category = 'Sports' GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query018_agg_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select  i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\n        avg( cast(c_birth_year as decimal(12,2))) agg6\nfrom catalog_sales, customer_demographics, customer, customer_address, date_dim, item\nwhere cs_sold_date_sk = d_date_sk and\n      cs_item_sk = i_item_sk and\n      cs_bill_cdemo_sk = cd_demo_sk and\n      cs_bill_customer_sk = c_customer_sk and\n      cd_gender = 'F' and\n      cd_education_status = '4 yr Degree' and\n      c_current_addr_sk = ca_address_sk and\n      d_year = 1999 and\n      c_birth_month = 12 and\n      ca_state in ('AR', 'IN', 'VA')\n      and cs_wholesale_cost BETWEEN 5 AND 10\n      AND i_category = 'Music'\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state,\n        ca_county,\n\ti_item_id\n limit 100;",
    "patch_sql": "WITH filtered_date AS (SELECT * FROM date_dim WHERE d_year = 1999), filtered_item AS (SELECT * FROM item WHERE i_category = 'Music'), filtered_demo AS (SELECT * FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = '4 yr Degree'), filtered_addr AS (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'IN', 'VA')) SELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM catalog_sales INNER JOIN filtered_date ON cs_sold_date_sk = d_date_sk INNER JOIN filtered_item ON cs_item_sk = i_item_sk INNER JOIN filtered_demo ON cs_bill_cdemo_sk = cd_demo_sk INNER JOIN customer ON cs_bill_customer_sk = c_customer_sk INNER JOIN filtered_addr ON c_current_addr_sk = ca_address_sk WHERE cs_wholesale_cost BETWEEN 5 AND 10 AND c_birth_month = 12 GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query018_agg_i2",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "select  i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\n        avg( cast(c_birth_year as decimal(12,2))) agg6\nfrom catalog_sales, customer_demographics, customer, customer_address, date_dim, item\nwhere cs_sold_date_sk = d_date_sk and\n      cs_item_sk = i_item_sk and\n      cs_bill_cdemo_sk = cd_demo_sk and\n      cs_bill_customer_sk = c_customer_sk and\n      cd_gender = 'F' and\n      cd_education_status = '4 yr Degree' and\n      c_current_addr_sk = ca_address_sk and\n      d_year = 1999 and\n      c_birth_month = 12 and\n      ca_state in ('AR', 'IN', 'VA')\n      and cs_wholesale_cost BETWEEN 5 AND 10\n      AND i_category = 'Music'\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state,\n        ca_county,\n\ti_item_id\n limit 100;",
    "patch_sql": "WITH prefiltered_demo AS (SELECT * FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = '4 yr Degree'), prefiltered_addr AS (SELECT * FROM customer_address WHERE ca_state IN ('AR', 'IN', 'VA')) SELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM catalog_sales, prefiltered_demo, customer, prefiltered_addr, date_dim, item WHERE cs_sold_date_sk = d_date_sk AND cs_item_sk = i_item_sk AND cs_bill_cdemo_sk = cd_demo_sk AND cs_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND d_year = 1999 AND c_birth_month = 12 AND cs_wholesale_cost BETWEEN 5 AND 10 AND i_category = 'Music' GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query018_agg_i2",
    "patch_id": "t3",
    "iteration": 0,
    "original_sql": "select  i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\n        avg( cast(c_birth_year as decimal(12,2))) agg6\nfrom catalog_sales, customer_demographics, customer, customer_address, date_dim, item\nwhere cs_sold_date_sk = d_date_sk and\n      cs_item_sk = i_item_sk and\n      cs_bill_cdemo_sk = cd_demo_sk and\n      cs_bill_customer_sk = c_customer_sk and\n      cd_gender = 'F' and\n      cd_education_status = '4 yr Degree' and\n      c_current_addr_sk = ca_address_sk and\n      d_year = 1999 and\n      c_birth_month = 12 and\n      ca_state in ('AR', 'IN', 'VA')\n      and cs_wholesale_cost BETWEEN 5 AND 10\n      AND i_category = 'Music'\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state,\n        ca_county,\n\ti_item_id\n limit 100;",
    "patch_sql": "WITH cust_with_addr AS (SELECT c_customer_sk, ca_address_sk, ca_country, ca_state, ca_county, c_birth_year FROM customer INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE ca_state IN ('AR', 'IN', 'VA') AND c_birth_month = 12) SELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM catalog_sales INNER JOIN date_dim ON cs_sold_date_sk = d_date_sk INNER JOIN item ON cs_item_sk = i_item_sk INNER JOIN customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk INNER JOIN cust_with_addr ON cs_bill_customer_sk = c_customer_sk WHERE d_year = 1999 AND cd_gender = 'F' AND cd_education_status = '4 yr Degree' AND cs_wholesale_cost BETWEEN 5 AND 10 AND i_category = 'Music' GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query018_agg_i2",
    "patch_id": "syn_w2",
    "iteration": 0,
    "original_sql": "select  i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\n        avg( cast(c_birth_year as decimal(12,2))) agg6\nfrom catalog_sales, customer_demographics, customer, customer_address, date_dim, item\nwhere cs_sold_date_sk = d_date_sk and\n      cs_item_sk = i_item_sk and\n      cs_bill_cdemo_sk = cd_demo_sk and\n      cs_bill_customer_sk = c_customer_sk and\n      cd_gender = 'F' and\n      cd_education_status = '4 yr Degree' and\n      c_current_addr_sk = ca_address_sk and\n      d_year = 1999 and\n      c_birth_month = 12 and\n      ca_state in ('AR', 'IN', 'VA')\n      and cs_wholesale_cost BETWEEN 5 AND 10\n      AND i_category = 'Music'\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state,\n        ca_county,\n\ti_item_id\n limit 100;",
    "patch_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), filtered_item AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), filtered_demo AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = '4 yr Degree'), filtered_addr AS (SELECT ca_address_sk, ca_country, ca_state, ca_county FROM customer_address WHERE ca_state IN ('AR', 'IN', 'VA')) SELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM catalog_sales INNER JOIN filtered_date ON cs_sold_date_sk = d_date_sk INNER JOIN filtered_item ON cs_item_sk = i_item_sk INNER JOIN filtered_demo ON cs_bill_cdemo_sk = cd_demo_sk INNER JOIN customer ON cs_bill_customer_sk = c_customer_sk INNER JOIN filtered_addr ON c_current_addr_sk = ca_address_sk WHERE cs_wholesale_cost BETWEEN 5 AND 10 AND c_birth_month = 12 GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query018_agg_i2",
    "patch_id": "t2",
    "iteration": 2,
    "original_sql": "select  i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\n        avg( cast(c_birth_year as decimal(12,2))) agg6\nfrom catalog_sales, customer_demographics, customer, customer_address, date_dim, item\nwhere cs_sold_date_sk = d_date_sk and\n      cs_item_sk = i_item_sk and\n      cs_bill_cdemo_sk = cd_demo_sk and\n      cs_bill_customer_sk = c_customer_sk and\n      cd_gender = 'F' and\n      cd_education_status = '4 yr Degree' and\n      c_current_addr_sk = ca_address_sk and\n      d_year = 1999 and\n      c_birth_month = 12 and\n      ca_state in ('AR', 'IN', 'VA')\n      and cs_wholesale_cost BETWEEN 5 AND 10\n      AND i_category = 'Music'\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state,\n        ca_county,\n\ti_item_id\n limit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), filtered_customers AS (SELECT c_customer_sk, c_current_addr_sk, c_birth_month, c_birth_year FROM customer WHERE c_birth_month = 12), filtered_addresses AS (SELECT ca_address_sk, ca_country, ca_state, ca_county FROM customer_address WHERE ca_state IN ('AR', 'IN', 'VA')), filtered_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = '4 yr Degree') SELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_items ON cs_item_sk = i_item_sk JOIN filtered_customers ON cs_bill_customer_sk = c_customer_sk JOIN filtered_addresses ON c_current_addr_sk = ca_address_sk JOIN filtered_demographics ON cs_bill_cdemo_sk = cd_demo_sk WHERE cs_wholesale_cost BETWEEN 5 AND 10 GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query018_agg_i2",
    "patch_id": "t3",
    "iteration": 2,
    "original_sql": "select  i_item_id,\n        ca_country,\n        ca_state,\n        ca_county,\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\n        avg( cast(c_birth_year as decimal(12,2))) agg6\nfrom catalog_sales, customer_demographics, customer, customer_address, date_dim, item\nwhere cs_sold_date_sk = d_date_sk and\n      cs_item_sk = i_item_sk and\n      cs_bill_cdemo_sk = cd_demo_sk and\n      cs_bill_customer_sk = c_customer_sk and\n      cd_gender = 'F' and\n      cd_education_status = '4 yr Degree' and\n      c_current_addr_sk = ca_address_sk and\n      d_year = 1999 and\n      c_birth_month = 12 and\n      ca_state in ('AR', 'IN', 'VA')\n      and cs_wholesale_cost BETWEEN 5 AND 10\n      AND i_category = 'Music'\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state,\n        ca_county,\n\ti_item_id\n limit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), filtered_customers AS (SELECT c_customer_sk, ca_country, ca_state, ca_county, c_birth_year FROM customer INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE c_birth_month = 12 AND ca_state IN ('AR', 'IN', 'VA')), filtered_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_education_status = '4 yr Degree') SELECT i_item_id, ca_country, ca_state, ca_county, AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1, AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2, AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3, AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4, AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5, AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6 FROM catalog_sales INNER JOIN filtered_dates ON cs_sold_date_sk = d_date_sk INNER JOIN filtered_items ON cs_item_sk = i_item_sk INNER JOIN filtered_customers ON cs_bill_customer_sk = c_customer_sk INNER JOIN filtered_demographics ON cs_bill_cdemo_sk = cd_demo_sk WHERE cs_wholesale_cost BETWEEN 5 AND 10 GROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county) ORDER BY ca_country, ca_state, ca_county, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query019_agg_i1",
    "patch_id": "syn_w1",
    "iteration": 0,
    "original_sql": "select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n  from date_dim, store_sales, item,customer,customer_address,store\n  where  d_date_sk = ss_sold_date_sk\n    and ss_item_sk = i_item_sk\n    and ss_customer_sk = c_customer_sk\n    and c_current_addr_sk = ca_address_sk\n    and ss_store_sk = s_store_sk\n    AND i_category  = 'Jewelry'\n    and d_year=2002\n    and d_moy = 4\n    and substring(ca_zip,1,5) <> substring(s_zip,1,5)\n    and ca_state  = 'IL'\n    and c_birth_month = 1\n    and ss_wholesale_cost BETWEEN 35 AND 55\n group by i_brand\n      ,i_brand_id\n      ,i_manufact_id\n      ,i_manufact\n order by ext_price desc\n         ,i_brand\n         ,i_brand_id\n         ,i_manufact_id\n         ,i_manufact\nlimit 100 ;",
    "patch_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy = 4), filtered_item AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_category = 'Jewelry'), filtered_ca AS (SELECT ca_address_sk, ca_zip FROM customer_address WHERE ca_state = 'IL'), filtered_customer AS (SELECT c_customer_sk, c_current_addr_sk, c_birth_month FROM customer WHERE c_birth_month = 1) SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_item ON ss_item_sk = i_item_sk JOIN filtered_customer ON ss_customer_sk = c_customer_sk JOIN filtered_ca ON c_current_addr_sk = ca_address_sk JOIN store ON ss_store_sk = s_store_sk WHERE ss_wholesale_cost BETWEEN 35 AND 55 AND SUBSTRING(ca_zip FROM 1 FOR 5) <> SUBSTRING(s_zip FROM 1 FOR 5) GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "13a8178d4026c543f3c14de9e1be92d8",
    "patch_cksum": "13a8178d4026c543f3c14de9e1be92d8",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query019_agg_i1",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n  from date_dim, store_sales, item,customer,customer_address,store\n  where  d_date_sk = ss_sold_date_sk\n    and ss_item_sk = i_item_sk\n    and ss_customer_sk = c_customer_sk\n    and c_current_addr_sk = ca_address_sk\n    and ss_store_sk = s_store_sk\n    AND i_category  = 'Jewelry'\n    and d_year=2002\n    and d_moy = 4\n    and substring(ca_zip,1,5) <> substring(s_zip,1,5)\n    and ca_state  = 'IL'\n    and c_birth_month = 1\n    and ss_wholesale_cost BETWEEN 35 AND 55\n group by i_brand\n      ,i_brand_id\n      ,i_manufact_id\n      ,i_manufact\n order by ext_price desc\n         ,i_brand\n         ,i_brand_id\n         ,i_manufact_id\n         ,i_manufact\nlimit 100 ;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy = 4), filtered_geo_pairs AS (SELECT ca_address_sk, s_store_sk FROM customer_address, store WHERE ca_state = 'IL' AND SUBSTRING(ca_zip FROM 1 FOR 5) <> SUBSTRING(s_zip FROM 1 FOR 5)), filtered_sales AS (SELECT ss_ext_sales_price, ss_item_sk, ss_customer_sk, ss_store_sk FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk WHERE ss_wholesale_cost BETWEEN 35 AND 55) SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM filtered_sales AS fs JOIN item AS i ON fs.ss_item_sk = i.i_item_sk JOIN customer AS c ON fs.ss_customer_sk = c.c_customer_sk JOIN filtered_geo_pairs AS fg ON c.c_current_addr_sk = fg.ca_address_sk AND fs.ss_store_sk = fg.s_store_sk WHERE i_category = 'Jewelry' AND c_birth_month = 1 GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "13a8178d4026c543f3c14de9e1be92d8",
    "patch_cksum": "13a8178d4026c543f3c14de9e1be92d8",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query019_agg_i1",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n  from date_dim, store_sales, item,customer,customer_address,store\n  where  d_date_sk = ss_sold_date_sk\n    and ss_item_sk = i_item_sk\n    and ss_customer_sk = c_customer_sk\n    and c_current_addr_sk = ca_address_sk\n    and ss_store_sk = s_store_sk\n    AND i_category  = 'Jewelry'\n    and d_year=2002\n    and d_moy = 4\n    and substring(ca_zip,1,5) <> substring(s_zip,1,5)\n    and ca_state  = 'IL'\n    and c_birth_month = 1\n    and ss_wholesale_cost BETWEEN 35 AND 55\n group by i_brand\n      ,i_brand_id\n      ,i_manufact_id\n      ,i_manufact\n order by ext_price desc\n         ,i_brand\n         ,i_brand_id\n         ,i_manufact_id\n         ,i_manufact\nlimit 100 ;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy = 4), filtered_geo_pairs AS (SELECT ca_address_sk, s_store_sk FROM customer_address, store WHERE ca_state = 'IL' AND SUBSTRING(ca_zip FROM 1 FOR 5) <> SUBSTRING(s_zip FROM 1 FOR 5)), filtered_sales AS (SELECT ss_ext_sales_price, ss_item_sk, ss_customer_sk, ss_store_sk FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk WHERE ss_wholesale_cost BETWEEN 35 AND 55) SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM filtered_sales AS fs JOIN item AS i ON fs.ss_item_sk = i.i_item_sk JOIN customer AS c ON fs.ss_customer_sk = c.c_customer_sk JOIN filtered_geo_pairs AS fg ON c.c_current_addr_sk = fg.ca_address_sk AND fs.ss_store_sk = fg.s_store_sk WHERE i_category = 'Jewelry' AND c_birth_month = 1 GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "13a8178d4026c543f3c14de9e1be92d8",
    "patch_cksum": "13a8178d4026c543f3c14de9e1be92d8",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query019_agg_i1",
    "patch_id": "t5",
    "iteration": 2,
    "original_sql": "select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n  from date_dim, store_sales, item,customer,customer_address,store\n  where  d_date_sk = ss_sold_date_sk\n    and ss_item_sk = i_item_sk\n    and ss_customer_sk = c_customer_sk\n    and c_current_addr_sk = ca_address_sk\n    and ss_store_sk = s_store_sk\n    AND i_category  = 'Jewelry'\n    and d_year=2002\n    and d_moy = 4\n    and substring(ca_zip,1,5) <> substring(s_zip,1,5)\n    and ca_state  = 'IL'\n    and c_birth_month = 1\n    and ss_wholesale_cost BETWEEN 35 AND 55\n group by i_brand\n      ,i_brand_id\n      ,i_manufact_id\n      ,i_manufact\n order by ext_price desc\n         ,i_brand\n         ,i_brand_id\n         ,i_manufact_id\n         ,i_manufact\nlimit 100 ;",
    "patch_sql": "WITH filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_category = 'Jewelry'), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy = 4) SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_items ON ss_item_sk = i_item_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN store ON ss_store_sk = s_store_sk WHERE SUBSTRING(ca_zip FROM 1 FOR 5) <> SUBSTRING(s_zip FROM 1 FOR 5) AND ca_state = 'IL' AND c_birth_month = 1 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "13a8178d4026c543f3c14de9e1be92d8",
    "patch_cksum": "13a8178d4026c543f3c14de9e1be92d8",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query019_agg_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n  from date_dim, store_sales, item,customer,customer_address,store\n  where  d_date_sk = ss_sold_date_sk\n    and ss_item_sk = i_item_sk\n    and ss_customer_sk = c_customer_sk\n    and c_current_addr_sk = ca_address_sk\n    and ss_store_sk = s_store_sk\n    AND i_category  = 'Shoes'\n    and d_year=1999\n    and d_moy = 2\n    and substring(ca_zip,1,5) <> substring(s_zip,1,5)\n    and ca_state  = 'KS'\n    and c_birth_month = 2\n    and ss_wholesale_cost BETWEEN 76 AND 96\n group by i_brand\n      ,i_brand_id\n      ,i_manufact_id\n      ,i_manufact\n order by ext_price desc\n         ,i_brand\n         ,i_brand_id\n         ,i_manufact_id\n         ,i_manufact\nlimit 100 ;",
    "patch_sql": "WITH pre_item AS (SELECT * FROM item WHERE i_category = 'Shoes'), pre_customer AS (SELECT * FROM customer WHERE c_birth_month = 2), pre_ca AS (SELECT * FROM customer_address WHERE ca_state = 'KS') SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN date_dim ON d_date_sk = ss_sold_date_sk JOIN pre_item ON ss_item_sk = i_item_sk JOIN pre_customer ON ss_customer_sk = c_customer_sk JOIN pre_ca ON c_current_addr_sk = ca_address_sk JOIN store ON ss_store_sk = s_store_sk WHERE d_year = 1999 AND d_moy = 2 AND ss_wholesale_cost BETWEEN 76 AND 96 AND SUBSTRING(ca_zip FROM 1 FOR 5) <> SUBSTRING(s_zip FROM 1 FOR 5) GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query019_agg_i2",
    "patch_id": "t6",
    "iteration": 2,
    "original_sql": "select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,\n \tsum(ss_ext_sales_price) ext_price\n  from date_dim, store_sales, item,customer,customer_address,store\n  where  d_date_sk = ss_sold_date_sk\n    and ss_item_sk = i_item_sk\n    and ss_customer_sk = c_customer_sk\n    and c_current_addr_sk = ca_address_sk\n    and ss_store_sk = s_store_sk\n    AND i_category  = 'Shoes'\n    and d_year=1999\n    and d_moy = 2\n    and substring(ca_zip,1,5) <> substring(s_zip,1,5)\n    and ca_state  = 'KS'\n    and c_birth_month = 2\n    and ss_wholesale_cost BETWEEN 76 AND 96\n group by i_brand\n      ,i_brand_id\n      ,i_manufact_id\n      ,i_manufact\n order by ext_price desc\n         ,i_brand\n         ,i_brand_id\n         ,i_manufact_id\n         ,i_manufact\nlimit 100 ;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy = 2), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_category = 'Shoes'), filtered_customers AS (SELECT c_customer_sk, c_current_addr_sk, c_birth_month FROM customer WHERE c_birth_month = 2), filtered_addresses AS (SELECT ca_address_sk, ca_zip, ca_state FROM customer_address WHERE ca_state = 'KS'), filtered_stores AS (SELECT s_store_sk, s_zip FROM store) SELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk JOIN filtered_customers ON ss_customer_sk = c_customer_sk JOIN filtered_addresses ON c_current_addr_sk = ca_address_sk JOIN filtered_stores ON ss_store_sk = s_store_sk WHERE SUBSTRING(ca_zip FROM 1 FOR 5) <> SUBSTRING(s_zip FROM 1 FOR 5) AND ss_wholesale_cost BETWEEN 76 AND 96 GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query023_multi_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "with frequent_ss_items as\n (select substring(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt\n  from store_sales\n      ,date_dim\n      ,item\n  where ss_sold_date_sk = d_date_sk\n    and ss_item_sk = i_item_sk\n    and d_year = 1998\n    and i_manager_id BETWEEN 81 and 100\n     AND i_category IN ('Children', 'Men', 'Sports')\n  group by substring(i_item_desc,1,30),i_item_sk,d_date\n  having count(*) >4),\n max_store_sales as\n (select max(csales) tpcds_cmax\n  from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales\n        from store_sales\n            ,customer\n            ,date_dim\n        where ss_customer_sk = c_customer_sk\n         and ss_sold_date_sk = d_date_sk\n         and d_year = 1998\n         and ss_wholesale_cost BETWEEN 11 AND 21\n        group by c_customer_sk) tmp1),\n best_ss_customer as\n (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales\n  from store_sales\n      ,customer\n  where ss_customer_sk = c_customer_sk\n  and c_birth_year BETWEEN 1934 AND 1940\n  group by c_customer_sk\n  having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select\n  *\nfrom\n max_store_sales))\n  select  sum(sales)\n from (select cs_quantity*cs_list_price sales\n       from catalog_sales\n           ,date_dim\n       where d_year = 1998\n         and d_moy = 10\n         and cs_sold_date_sk = d_date_sk\n         and cs_item_sk in (select item_sk from frequent_ss_items)\n         and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n         and cs_wholesale_cost BETWEEN 11 AND 21\n      union all\n      select ws_quantity*ws_list_price sales\n       from web_sales\n           ,date_dim\n       where d_year = 1998\n         and d_moy = 10\n         and ws_sold_date_sk = d_date_sk\n         and ws_item_sk in (select item_sk from frequent_ss_items)\n         and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)\n         and ws_wholesale_cost BETWEEN 11 AND 21) tmp2\n limit 100;",
    "patch_sql": "WITH frequent_ss_items AS (SELECT SUBSTRING(i_item_desc FROM 1 FOR 30) AS itemdesc, i_item_sk AS item_sk, d_date AS solddate, COUNT(*) AS cnt FROM store_sales, date_dim, item WHERE ss_sold_date_sk = d_date_sk AND ss_item_sk = i_item_sk AND d_year = 1998 AND i_manager_id BETWEEN 81 AND 100 AND i_category IN ('Children', 'Men', 'Sports') GROUP BY SUBSTRING(i_item_desc FROM 1 FOR 30), i_item_sk, d_date HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM store_sales, customer, date_dim WHERE ss_customer_sk = c_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND ss_wholesale_cost BETWEEN 11 AND 21 GROUP BY c_customer_sk) AS tmp1), best_ss_customer AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM store_sales, customer WHERE ss_customer_sk = c_customer_sk AND c_birth_year BETWEEN 1934 AND 1940 GROUP BY c_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (95 / 100.0) * (SELECT * FROM max_store_sales)) SELECT SUM(sales) FROM (SELECT cs_quantity * cs_list_price AS sales FROM catalog_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND cs_sold_date_sk = d_date_sk AND cs_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND cs_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND cs_wholesale_cost BETWEEN 11 AND 21 UNION ALL SELECT ws_quantity * ws_list_price AS sales FROM web_sales, date_dim WHERE d_year = 1998 AND d_moy = 10 AND ws_sold_date_sk = d_date_sk AND ws_item_sk IN (SELECT item_sk FROM frequent_ss_items) AND ws_bill_customer_sk IN (SELECT c_customer_sk FROM best_ss_customer) AND ws_wholesale_cost BETWEEN 11 AND 21) AS tmp2 LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "244156d9d9c13b8409dc226330c8d647",
    "patch_cksum": "244156d9d9c13b8409dc226330c8d647",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query025_agg_i1",
    "patch_id": "t2_rescue",
    "iteration": 1,
    "original_sql": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,max(ss_net_profit) as store_sales_profit\n ,max(sr_net_loss) as store_returns_loss\n ,max(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 3\n and d1.d_year = 1999\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy               between 3 and  3 + 2\n and d2.d_year              = 1999\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy               between 3 and  3 + 2\n and d3.d_year              = 1999\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100;",
    "patch_sql": "WITH date_range_d2 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 3 AND 3 + 2 AND d_year = 1999), date_range_d3 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 3 AND 3 + 2 AND d_year = 1999) SELECT i_item_id, i_item_desc, s_store_id, s_store_name, MAX(ss_net_profit) AS store_sales_profit, MAX(sr_net_loss) AS store_returns_loss, MAX(cs_net_profit) AS catalog_sales_profit FROM store_sales, store_returns, catalog_sales, date_dim AS d1, store, item, date_range_d2, date_range_d3 WHERE d1.d_moy = 3 AND d1.d_year = 1999 AND d1.d_date_sk = ss_sold_date_sk AND i_item_sk = ss_item_sk AND s_store_sk = ss_store_sk AND ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND sr_returned_date_sk IN (SELECT d_date_sk FROM date_range_d2) AND sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk AND cs_sold_date_sk IN (SELECT d_date_sk FROM date_range_d3) GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "8867a21cb93a79e606251c144bc9e97c",
    "patch_cksum": "8867a21cb93a79e606251c144bc9e97c",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query025_agg_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,stddev_samp(ss_net_profit) as store_sales_profit\n ,stddev_samp(sr_net_loss) as store_returns_loss\n ,stddev_samp(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 2\n and d1.d_year = 2000\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy               between 2 and  2 + 2\n and d2.d_year              = 2000\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy               between 2 and  2 + 2\n and d3.d_year              = 2000\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100;",
    "patch_sql": "SELECT i_item_id, i_item_desc, s_store_id, s_store_name, STDDEV_SAMP(ss_net_profit) AS store_sales_profit, STDDEV_SAMP(sr_net_loss) AS store_returns_loss, STDDEV_SAMP(cs_net_profit) AS catalog_sales_profit FROM date_dim AS d1 INNER JOIN store_sales ON (d1.d_date_sk = ss_sold_date_sk) INNER JOIN store ON (s_store_sk = ss_store_sk) INNER JOIN item ON (i_item_sk = ss_item_sk) INNER JOIN store_returns ON (ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) INNER JOIN date_dim AS d2 ON (sr_returned_date_sk = d2.d_date_sk) INNER JOIN catalog_sales ON (sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk) INNER JOIN date_dim AS d3 ON (cs_sold_date_sk = d3.d_date_sk) WHERE d1.d_moy = 2 AND d1.d_year = 2000 AND d2.d_moy BETWEEN 2 AND 4 AND d2.d_year = 2000 AND d3.d_moy BETWEEN 2 AND 4 AND d3.d_year = 2000 GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "a3e1e90d5100b6c77bba5ebb98e52a85",
    "patch_cksum": "a3e1e90d5100b6c77bba5ebb98e52a85",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query025_agg_i2",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,stddev_samp(ss_net_profit) as store_sales_profit\n ,stddev_samp(sr_net_loss) as store_returns_loss\n ,stddev_samp(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 2\n and d1.d_year = 2000\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy               between 2 and  2 + 2\n and d2.d_year              = 2000\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy               between 2 and  2 + 2\n and d3.d_year              = 2000\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_moy, d_year FROM date_dim WHERE (d_moy = 2 AND d_year = 2000) OR (d_moy BETWEEN 2 AND 4 AND d_year = 2000)) SELECT i_item_id, i_item_desc, s_store_id, s_store_name, STDDEV_SAMP(ss_net_profit) AS store_sales_profit, STDDEV_SAMP(sr_net_loss) AS store_returns_loss, STDDEV_SAMP(cs_net_profit) AS catalog_sales_profit FROM store_sales INNER JOIN filtered_dates AS d1 ON d1.d_date_sk = ss_sold_date_sk INNER JOIN store ON s_store_sk = ss_store_sk INNER JOIN item ON i_item_sk = ss_item_sk INNER JOIN store_returns ON ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number INNER JOIN filtered_dates AS d2 ON sr_returned_date_sk = d2.d_date_sk INNER JOIN catalog_sales ON sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk INNER JOIN filtered_dates AS d3 ON cs_sold_date_sk = d3.d_date_sk WHERE d1.d_moy = 2 AND d1.d_year = 2000 GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "a3e1e90d5100b6c77bba5ebb98e52a85",
    "patch_cksum": "a3e1e90d5100b6c77bba5ebb98e52a85",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query025_agg_i2",
    "patch_id": "t2",
    "iteration": 1,
    "original_sql": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,stddev_samp(ss_net_profit) as store_sales_profit\n ,stddev_samp(sr_net_loss) as store_returns_loss\n ,stddev_samp(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 2\n and d1.d_year = 2000\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy               between 2 and  2 + 2\n and d2.d_year              = 2000\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy               between 2 and  2 + 2\n and d3.d_year              = 2000\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 2 AND d_year = 2000), preagg_store_sales AS (SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk) SELECT i_item_id, i_item_desc, s_store_id, s_store_name, STDDEV_SAMP(ss_net_profit) AS store_sales_profit, STDDEV_SAMP(sr_net_loss) AS store_returns_loss, STDDEV_SAMP(cs_net_profit) AS catalog_sales_profit FROM preagg_store_sales AS ss JOIN store_returns AS sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN catalog_sales AS cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk JOIN date_dim AS d2 ON sr.sr_returned_date_sk = d2.d_date_sk JOIN date_dim AS d3 ON cs.cs_sold_date_sk = d3.d_date_sk JOIN store ON ss.ss_store_sk = s_store_sk JOIN item ON ss.ss_item_sk = i_item_sk WHERE d2.d_moy BETWEEN 2 AND 4 AND d2.d_year = 2000 AND d3.d_moy BETWEEN 2 AND 4 AND d3.d_year = 2000 GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "a3e1e90d5100b6c77bba5ebb98e52a85",
    "patch_cksum": "a3e1e90d5100b6c77bba5ebb98e52a85",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query025_agg_i2",
    "patch_id": "S0",
    "iteration": 1,
    "original_sql": "select \n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n ,stddev_samp(ss_net_profit) as store_sales_profit\n ,stddev_samp(sr_net_loss) as store_returns_loss\n ,stddev_samp(cs_net_profit) as catalog_sales_profit\n from\n store_sales\n ,store_returns\n ,catalog_sales\n ,date_dim d1\n ,date_dim d2\n ,date_dim d3\n ,store\n ,item\n where\n d1.d_moy = 2\n and d1.d_year = 2000\n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk = ss_item_sk\n and s_store_sk = ss_store_sk\n and ss_customer_sk = sr_customer_sk\n and ss_item_sk = sr_item_sk\n and ss_ticket_number = sr_ticket_number\n and sr_returned_date_sk = d2.d_date_sk\n and d2.d_moy               between 2 and  2 + 2\n and d2.d_year              = 2000\n and sr_customer_sk = cs_bill_customer_sk\n and sr_item_sk = cs_item_sk\n and cs_sold_date_sk = d3.d_date_sk\n and d3.d_moy               between 2 and  2 + 2\n and d3.d_year              = 2000\n group by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n order by\n i_item_id\n ,i_item_desc\n ,s_store_id\n ,s_store_name\n limit 100;",
    "patch_sql": "WITH d1 AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 2 AND d_year = 2000), d2 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 2 AND 4 AND d_year = 2000), d3 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 2 AND 4 AND d_year = 2000) SELECT i_item_id, i_item_desc, s_store_id, s_store_name, STDDEV_SAMP(ss_net_profit) AS store_sales_profit, STDDEV_SAMP(sr_net_loss) AS store_returns_loss, STDDEV_SAMP(cs_net_profit) AS catalog_sales_profit FROM store_sales JOIN d1 ON d1.d_date_sk = ss_sold_date_sk JOIN item ON i_item_sk = ss_item_sk JOIN store ON s_store_sk = ss_store_sk JOIN store_returns ON ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN d2 ON sr_returned_date_sk = d2.d_date_sk JOIN catalog_sales ON sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk JOIN d3 ON cs_sold_date_sk = d3.d_date_sk WHERE TRUE GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "a3e1e90d5100b6c77bba5ebb98e52a85",
    "patch_cksum": "a3e1e90d5100b6c77bba5ebb98e52a85",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query027_agg_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select  i_item_id,\n        s_state, grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nfrom store_sales, customer_demographics, date_dim, store, item\nwhere ss_sold_date_sk = d_date_sk and\n      ss_item_sk = i_item_sk and\n      ss_store_sk = s_store_sk and\n      ss_cdemo_sk = cd_demo_sk and\n      cd_gender = 'F' and\n      cd_marital_status = 'M' and\n      cd_education_status = 'Primary' and\n      d_year = 2002 and\n      s_state = 'IA' and\n     i_category  = 'Sports'\n group by rollup (i_item_id, s_state)\n order by i_item_id\n         ,s_state\n limit 100;",
    "patch_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), filtered_store AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'IA'), filtered_item AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Sports'), filtered_cd AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'M' AND cd_education_status = 'Primary') SELECT i_item_id, s_state, GROUPING(s_state) AS g_state, AVG(ss_quantity) AS agg1, AVG(ss_list_price) AS agg2, AVG(ss_coupon_amt) AS agg3, AVG(ss_sales_price) AS agg4 FROM store_sales INNER JOIN filtered_date ON ss_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_store ON ss_store_sk = filtered_store.s_store_sk INNER JOIN filtered_item ON ss_item_sk = filtered_item.i_item_sk INNER JOIN filtered_cd ON ss_cdemo_sk = filtered_cd.cd_demo_sk WHERE TRUE GROUP BY ROLLUP (i_item_id, s_state) ORDER BY i_item_id, s_state LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query027_agg_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select  i_item_id,\n        s_state, grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nfrom store_sales, customer_demographics, date_dim, store, item\nwhere ss_sold_date_sk = d_date_sk and\n      ss_item_sk = i_item_sk and\n      ss_store_sk = s_store_sk and\n      ss_cdemo_sk = cd_demo_sk and\n      cd_gender = 'M' and\n      cd_marital_status = 'W' and\n      cd_education_status = 'Secondary' and\n      d_year = 1999 and\n      s_state = 'OH' and\n     i_category  = 'Music'\n group by rollup (i_item_id, s_state)\n order by i_item_id\n         ,s_state\n limit 100;",
    "patch_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), filtered_cd AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'W' AND cd_education_status = 'Secondary'), pre_agg AS (SELECT ss_item_sk, ss_store_sk, AVG(ss_quantity) AS avg_ss_quantity, AVG(ss_list_price) AS avg_ss_list_price, AVG(ss_coupon_amt) AS avg_ss_coupon_amt, AVG(ss_sales_price) AS avg_ss_sales_price FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk JOIN filtered_cd ON ss_cdemo_sk = cd_demo_sk GROUP BY ss_item_sk, ss_store_sk), filtered_store AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'OH'), filtered_item AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music') SELECT i_item_id, s_state, GROUPING(s_state) AS g_state, AVG(avg_ss_quantity) AS agg1, AVG(avg_ss_list_price) AS agg2, AVG(avg_ss_coupon_amt) AS agg3, AVG(avg_ss_sales_price) AS agg4 FROM pre_agg JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_item ON ss_item_sk = i_item_sk GROUP BY ROLLUP (i_item_id, s_state) ORDER BY i_item_id, s_state LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "1cd5c576f6460ec50491af544fd0066a",
    "patch_cksum": "1cd5c576f6460ec50491af544fd0066a",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query027_agg_i2",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "select  i_item_id,\n        s_state, grouping(s_state) g_state,\n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4\nfrom store_sales, customer_demographics, date_dim, store, item\nwhere ss_sold_date_sk = d_date_sk and\n      ss_item_sk = i_item_sk and\n      ss_store_sk = s_store_sk and\n      ss_cdemo_sk = cd_demo_sk and\n      cd_gender = 'M' and\n      cd_marital_status = 'W' and\n      cd_education_status = 'Secondary' and\n      d_year = 1999 and\n      s_state = 'OH' and\n     i_category  = 'Music'\n group by rollup (i_item_id, s_state)\n order by i_item_id\n         ,s_state\n limit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999), filtered_stores AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'OH'), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), filtered_customers AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'W' AND cd_education_status = 'Secondary') SELECT i_item_id, s_state, GROUPING(s_state) AS g_state, AVG(ss_quantity) AS agg1, AVG(ss_list_price) AS agg2, AVG(ss_coupon_amt) AS agg3, AVG(ss_sales_price) AS agg4 FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN filtered_items ON ss_item_sk = i_item_sk JOIN filtered_customers ON ss_cdemo_sk = cd_demo_sk WHERE TRUE GROUP BY ROLLUP (i_item_id, s_state) ORDER BY i_item_id, s_state LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "1cd5c576f6460ec50491af544fd0066a",
    "patch_cksum": "1cd5c576f6460ec50491af544fd0066a",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query030_multi_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state\n,wr_reason_sk as ctr_reason_sk\n,sum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n     ,item\n where wr_returned_date_sk = d_date_sk\n   and d_year =1999\n   and wr_returning_addr_sk = ca_address_sk\n   and wr_item_sk = i_item_sk\n   and i_manager_id BETWEEN 42 and 51\n   and wr_return_amt / wr_return_quantity between 193 and 222\n group by wr_returning_customer_sk\n         ,ca_state, wr_reason_sk)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,c_last_review_date_sk,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state in ('CA', 'MI', 'SD', 'VA')\n       and ctr1.ctr_customer_sk = c_customer_sk\n       and ctr1.ctr_reason_sk in (22, 23)\n      and c_birth_year BETWEEN 1945 AND 1951\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n                  ,c_last_review_date_sk,ctr_total_return\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT wr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, wr_reason_sk AS ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM web_returns, date_dim, customer_address, item WHERE wr_returned_date_sk = d_date_sk AND d_year = 1999 AND wr_returning_addr_sk = ca_address_sk AND wr_item_sk = i_item_sk AND i_manager_id BETWEEN 42 AND 51 AND wr_return_amt / wr_return_quantity BETWEEN 193 AND 222 GROUP BY wr_returning_customer_sk, ca_state, wr_reason_sk), state_averages AS (SELECT ctr_state, AVG(ctr_total_return) AS avg_return FROM customer_total_return GROUP BY ctr_state) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return FROM customer_total_return AS ctr1, customer_address, customer, state_averages AS sa WHERE ctr1.ctr_total_return > sa.avg_return * 1.2 AND ctr1.ctr_state = sa.ctr_state AND ca_address_sk = c_current_addr_sk AND ca_state IN ('CA', 'MI', 'SD', 'VA') AND ctr1.ctr_customer_sk = c_customer_sk AND ctr1.ctr_reason_sk IN (22, 23) AND c_birth_year BETWEEN 1945 AND 1951 ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query030_multi_i1",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state\n,wr_reason_sk as ctr_reason_sk\n,sum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n     ,item\n where wr_returned_date_sk = d_date_sk\n   and d_year =1999\n   and wr_returning_addr_sk = ca_address_sk\n   and wr_item_sk = i_item_sk\n   and i_manager_id BETWEEN 42 and 51\n   and wr_return_amt / wr_return_quantity between 193 and 222\n group by wr_returning_customer_sk\n         ,ca_state, wr_reason_sk)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,c_last_review_date_sk,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state in ('CA', 'MI', 'SD', 'VA')\n       and ctr1.ctr_customer_sk = c_customer_sk\n       and ctr1.ctr_reason_sk in (22, 23)\n      and c_birth_year BETWEEN 1945 AND 1951\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n                  ,c_last_review_date_sk,ctr_total_return\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT wr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, wr_reason_sk AS ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM web_returns, date_dim, customer_address, item WHERE wr_returned_date_sk = d_date_sk AND d_year = 1999 AND wr_returning_addr_sk = ca_address_sk AND wr_item_sk = i_item_sk AND i_manager_id BETWEEN 42 AND 51 AND wr_return_amt / wr_return_quantity BETWEEN 193 AND 222 AND wr_reason_sk IN (22, 23) GROUP BY wr_returning_customer_sk, ca_state, wr_reason_sk) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return FROM customer_total_return AS ctr1, customer_address, customer WHERE ctr1.ctr_total_return > (SELECT AVG(ctr_total_return) * 1.2 FROM customer_total_return AS ctr2 WHERE ctr1.ctr_state = ctr2.ctr_state) AND ca_address_sk = c_current_addr_sk AND ca_state IN ('CA', 'MI', 'SD', 'VA') AND ctr1.ctr_customer_sk = c_customer_sk AND ctr1.ctr_reason_sk IN (22, 23) AND c_birth_year BETWEEN 1945 AND 1951 ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query030_multi_i1",
    "patch_id": "syn_w2",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state\n,wr_reason_sk as ctr_reason_sk\n,sum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n     ,item\n where wr_returned_date_sk = d_date_sk\n   and d_year =1999\n   and wr_returning_addr_sk = ca_address_sk\n   and wr_item_sk = i_item_sk\n   and i_manager_id BETWEEN 42 and 51\n   and wr_return_amt / wr_return_quantity between 193 and 222\n group by wr_returning_customer_sk\n         ,ca_state, wr_reason_sk)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,c_last_review_date_sk,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state in ('CA', 'MI', 'SD', 'VA')\n       and ctr1.ctr_customer_sk = c_customer_sk\n       and ctr1.ctr_reason_sk in (22, 23)\n      and c_birth_year BETWEEN 1945 AND 1951\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n                  ,c_last_review_date_sk,ctr_total_return\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT wr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, wr_reason_sk AS ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM web_returns, date_dim, customer_address, item WHERE wr_returned_date_sk = d_date_sk AND d_year = 1999 AND wr_returning_addr_sk = ca_address_sk AND wr_item_sk = i_item_sk AND i_manager_id BETWEEN 42 AND 51 AND wr_return_amt / wr_return_quantity BETWEEN 193 AND 222 GROUP BY wr_returning_customer_sk, ca_state, wr_reason_sk), state_averages AS (SELECT ctr_state, AVG(ctr_total_return) AS avg_return FROM customer_total_return GROUP BY ctr_state) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return FROM customer_total_return AS ctr1, customer_address, customer, state_averages AS sa WHERE ctr1.ctr_total_return > sa.avg_return * 1.2 AND ctr1.ctr_state = sa.ctr_state AND ca_address_sk = c_current_addr_sk AND ca_state IN ('CA', 'MI', 'SD', 'VA') AND ctr1.ctr_customer_sk = c_customer_sk AND ctr1.ctr_reason_sk IN (22, 23) AND c_birth_year BETWEEN 1945 AND 1951 ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query030_multi_i1",
    "patch_id": "syn_w3",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state\n,wr_reason_sk as ctr_reason_sk\n,sum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n     ,item\n where wr_returned_date_sk = d_date_sk\n   and d_year =1999\n   and wr_returning_addr_sk = ca_address_sk\n   and wr_item_sk = i_item_sk\n   and i_manager_id BETWEEN 42 and 51\n   and wr_return_amt / wr_return_quantity between 193 and 222\n group by wr_returning_customer_sk\n         ,ca_state, wr_reason_sk)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,c_last_review_date_sk,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state in ('CA', 'MI', 'SD', 'VA')\n       and ctr1.ctr_customer_sk = c_customer_sk\n       and ctr1.ctr_reason_sk in (22, 23)\n      and c_birth_year BETWEEN 1945 AND 1951\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n                  ,c_last_review_date_sk,ctr_total_return\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT wr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, wr_reason_sk AS ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM web_returns, date_dim, customer_address, item WHERE wr_returned_date_sk = d_date_sk AND d_year = 1999 AND wr_returning_addr_sk = ca_address_sk AND wr_item_sk = i_item_sk AND i_manager_id BETWEEN 42 AND 51 AND wr_return_amt / wr_return_quantity BETWEEN 193 AND 222 GROUP BY wr_returning_customer_sk, ca_state, wr_reason_sk), state_averages AS (SELECT ctr_state, AVG(ctr_total_return) AS avg_return FROM customer_total_return GROUP BY ctr_state) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return FROM customer_total_return AS ctr1, customer_address, customer, state_averages AS sa WHERE ctr1.ctr_total_return > sa.avg_return * 1.2 AND ctr1.ctr_state = sa.ctr_state AND ca_address_sk = c_current_addr_sk AND ca_state IN ('CA', 'MI', 'SD', 'VA') AND ctr1.ctr_customer_sk = c_customer_sk AND ctr1.ctr_reason_sk IN (22, 23) AND c_birth_year BETWEEN 1945 AND 1951 ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query030_multi_i1",
    "patch_id": "t2",
    "iteration": 1,
    "original_sql": "with customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state\n,wr_reason_sk as ctr_reason_sk\n,sum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n     ,item\n where wr_returned_date_sk = d_date_sk\n   and d_year =1999\n   and wr_returning_addr_sk = ca_address_sk\n   and wr_item_sk = i_item_sk\n   and i_manager_id BETWEEN 42 and 51\n   and wr_return_amt / wr_return_quantity between 193 and 222\n group by wr_returning_customer_sk\n         ,ca_state, wr_reason_sk)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,c_last_review_date_sk,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state in ('CA', 'MI', 'SD', 'VA')\n       and ctr1.ctr_customer_sk = c_customer_sk\n       and ctr1.ctr_reason_sk in (22, 23)\n      and c_birth_year BETWEEN 1945 AND 1951\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n                  ,c_last_review_date_sk,ctr_total_return\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT wr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, wr_reason_sk AS ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM web_returns, date_dim, customer_address, item WHERE wr_returned_date_sk = d_date_sk AND d_year = 1999 AND wr_returning_addr_sk = ca_address_sk AND wr_item_sk = i_item_sk AND i_manager_id BETWEEN 42 AND 51 AND wr_return_amt / wr_return_quantity BETWEEN 193 AND 222 AND ca_state IN ('CA', 'MI', 'SD', 'VA') GROUP BY wr_returning_customer_sk, ca_state, wr_reason_sk) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return FROM customer_total_return AS ctr1, customer_address, customer WHERE ctr1.ctr_total_return > (SELECT AVG(ctr_total_return) * 1.2 FROM customer_total_return AS ctr2 WHERE ctr1.ctr_state = ctr2.ctr_state) AND ca_address_sk = c_current_addr_sk AND ca_state IN ('CA', 'MI', 'SD', 'VA') AND ctr1.ctr_customer_sk = c_customer_sk AND ctr1.ctr_reason_sk IN (22, 23) AND c_birth_year BETWEEN 1945 AND 1951 ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query030_multi_i2",
    "patch_id": "t2",
    "iteration": 2,
    "original_sql": "with customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n ,ca_state as ctr_state\n,wr_reason_sk as ctr_reason_sk\n,sum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n     ,item\n where wr_returned_date_sk = d_date_sk\n   and d_year =2002\n   and wr_returning_addr_sk = ca_address_sk\n   and wr_item_sk = i_item_sk\n   and i_manager_id BETWEEN 68 and 77\n   and wr_return_amt / wr_return_quantity between 242 and 271\n group by wr_returning_customer_sk\n         ,ca_state, wr_reason_sk)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,c_last_review_date_sk,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2\n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state in ('OK', 'SC', 'TX', 'WI')\n       and ctr1.ctr_customer_sk = c_customer_sk\n       and ctr1.ctr_reason_sk in (20, 36)\n      and c_birth_year BETWEEN 1985 AND 1991\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n                  ,c_last_review_date_sk,ctr_total_return\nlimit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT wr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, wr_reason_sk AS ctr_reason_sk, SUM(wr_return_amt) AS ctr_total_return FROM web_returns, date_dim, customer_address, item WHERE wr_returned_date_sk = d_date_sk AND d_year = 2002 AND wr_returning_addr_sk = ca_address_sk AND wr_item_sk = i_item_sk AND i_manager_id BETWEEN 68 AND 77 AND wr_return_amt / wr_return_quantity BETWEEN 242 AND 271 GROUP BY wr_returning_customer_sk, ca_state, wr_reason_sk), state_thresholds AS (SELECT ctr_state, AVG(ctr_total_return) * 1.2 AS avg_threshold FROM customer_total_return GROUP BY ctr_state) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return FROM customer_total_return AS ctr1, customer_address, customer, state_thresholds AS st WHERE ctr1.ctr_total_return > st.avg_threshold AND st.ctr_state = ctr1.ctr_state AND ca_address_sk = c_current_addr_sk AND ca_state IN ('OK', 'SC', 'TX', 'WI') AND ctr1.ctr_customer_sk = c_customer_sk AND ctr1.ctr_reason_sk IN (20, 36) AND c_birth_year BETWEEN 1985 AND 1991 ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address, c_last_review_date_sk, ctr_total_return LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query031_multi_i1",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "with ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address, item\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n  and ss_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ss_list_price between 86 and 100\n  and ca_state in ('IA','IL')\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address, item\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n  and ws_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ws_list_price between 86 and 100\n  and ca_state in ('IA','IL')\ngroup by ca_county,d_qoy, d_year)\n select\n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.d_year;",
    "patch_sql": "WITH ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND ss_item_sk = i_item_sk AND i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ss_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') AND d_year = 1998 AND d_qoy IN (1, 2, 3) GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address, item WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ws_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') AND d_year = 1998 AND d_qoy IN (1, 2, 3) GROUP BY ca_county, d_qoy, d_year) SELECT ss1.ca_county, ss1.d_year, ws2.web_sales / ws1.web_sales AS web_q1_q2_increase, ss2.store_sales / ss1.store_sales AS store_q1_q2_increase, ws3.web_sales / ws2.web_sales AS web_q2_q3_increase, ss3.store_sales / ss2.store_sales AS store_q2_q3_increase FROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3 WHERE ss1.d_qoy = 1 AND ss1.d_year = 1998 AND ss1.ca_county = ss2.ca_county AND ss2.d_qoy = 2 AND ss2.d_year = 1998 AND ss2.ca_county = ss3.ca_county AND ss3.d_qoy = 3 AND ss3.d_year = 1998 AND ss1.ca_county = ws1.ca_county AND ws1.d_qoy = 1 AND ws1.d_year = 1998 AND ws1.ca_county = ws2.ca_county AND ws2.d_qoy = 2 AND ws2.d_year = 1998 AND ws1.ca_county = ws3.ca_county AND ws3.d_qoy = 3 AND ws3.d_year = 1998 AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END ORDER BY ss1.d_year;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "patch_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query031_multi_i1",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "with ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address, item\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n  and ss_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ss_list_price between 86 and 100\n  and ca_state in ('IA','IL')\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address, item\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n  and ws_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ws_list_price between 86 and 100\n  and ca_state in ('IA','IL')\ngroup by ca_county,d_qoy, d_year)\n select\n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.d_year;",
    "patch_sql": "WITH ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND ss_item_sk = i_item_sk AND i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ss_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address, item WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ws_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') GROUP BY ca_county, d_qoy, d_year), ss_filtered AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN item ON ss_item_sk = i_item_sk WHERE i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ss_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') AND d_year = 1998 AND d_qoy IN (1, 2, 3) GROUP BY ca_county, d_qoy, d_year), ws_filtered AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN customer_address ON ws_bill_addr_sk = ca_address_sk JOIN item ON ws_item_sk = i_item_sk WHERE i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ws_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') AND d_year = 1998 AND d_qoy IN (1, 2, 3) GROUP BY ca_county, d_qoy, d_year), ss_pivoted AS (SELECT ca_county, MAX(CASE WHEN d_qoy = 1 THEN store_sales END) AS q1_store_sales, MAX(CASE WHEN d_qoy = 2 THEN store_sales END) AS q2_store_sales, MAX(CASE WHEN d_qoy = 3 THEN store_sales END) AS q3_store_sales FROM ss_filtered GROUP BY ca_county), ws_pivoted AS (SELECT ca_county, MAX(CASE WHEN d_qoy = 1 THEN web_sales END) AS q1_web_sales, MAX(CASE WHEN d_qoy = 2 THEN web_sales END) AS q2_web_sales, MAX(CASE WHEN d_qoy = 3 THEN web_sales END) AS q3_web_sales FROM ws_filtered GROUP BY ca_county) SELECT ss_pivoted.ca_county, 1998 AS d_year, (CAST(q2_web_sales AS DOUBLE PRECISION) / NULLIF(q1_web_sales, 0)) AS web_q1_q2_increase, (CAST(q2_store_sales AS DOUBLE PRECISION) / NULLIF(q1_store_sales, 0)) AS store_q1_q2_increase, (CAST(q3_web_sales AS DOUBLE PRECISION) / NULLIF(q2_web_sales, 0)) AS web_q2_q3_increase, (CAST(q3_store_sales AS DOUBLE PRECISION) / NULLIF(q2_store_sales, 0)) AS store_q2_q3_increase FROM ss_pivoted JOIN ws_pivoted ON ss_pivoted.ca_county = ws_pivoted.ca_county WHERE (CASE WHEN q1_web_sales > 0 THEN CAST(q2_web_sales AS DOUBLE PRECISION) / q1_web_sales ELSE NULL END) > (CASE WHEN q1_store_sales > 0 THEN CAST(q2_store_sales AS DOUBLE PRECISION) / q1_store_sales ELSE NULL END) AND (CASE WHEN q2_web_sales > 0 THEN CAST(q3_web_sales AS DOUBLE PRECISION) / q2_web_sales ELSE NULL END) > (CASE WHEN q2_store_sales > 0 THEN CAST(q3_store_sales AS DOUBLE PRECISION) / q2_store_sales ELSE NULL END) ORDER BY d_year;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "patch_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query031_multi_i1",
    "patch_id": "t4",
    "iteration": 1,
    "original_sql": "with ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address, item\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n  and ss_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ss_list_price between 86 and 100\n  and ca_state in ('IA','IL')\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address, item\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n  and ws_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ws_list_price between 86 and 100\n  and ca_state in ('IA','IL')\ngroup by ca_county,d_qoy, d_year)\n select\n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.d_year;",
    "patch_sql": "WITH ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND ss_item_sk = i_item_sk AND i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ss_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address, item WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ws_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') GROUP BY ca_county, d_qoy, d_year), ws_agg AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales JOIN date_dim ON ws_sold_date_sk = d_date_sk JOIN customer_address ON ws_bill_addr_sk = ca_address_sk JOIN item ON ws_item_sk = i_item_sk WHERE i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ws_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') GROUP BY ca_county, d_qoy, d_year), ss_agg AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN customer_address ON ss_addr_sk = ca_address_sk JOIN item ON ss_item_sk = i_item_sk WHERE i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ss_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') GROUP BY ca_county, d_qoy, d_year) SELECT ss1.ca_county, ss1.d_year, ws2.web_sales / ws1.web_sales AS web_q1_q2_increase, ss2.store_sales / ss1.store_sales AS store_q1_q2_increase, ws3.web_sales / ws2.web_sales AS web_q2_q3_increase, ss3.store_sales / ss2.store_sales AS store_q2_q3_increase FROM ss_agg AS ss1, ss_agg AS ss2, ss_agg AS ss3, ws_agg AS ws1, ws_agg AS ws2, ws_agg AS ws3 WHERE ss1.d_qoy = 1 AND ss1.d_year = 1998 AND ss1.ca_county = ss2.ca_county AND ss2.d_qoy = 2 AND ss2.d_year = 1998 AND ss2.ca_county = ss3.ca_county AND ss3.d_qoy = 3 AND ss3.d_year = 1998 AND ss1.ca_county = ws1.ca_county AND ws1.d_qoy = 1 AND ws1.d_year = 1998 AND ws1.ca_county = ws2.ca_county AND ws2.d_qoy = 2 AND ws2.d_year = 1998 AND ws1.ca_county = ws3.ca_county AND ws3.d_qoy = 3 AND ws3.d_year = 1998 AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END ORDER BY ss1.d_year;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "patch_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query031_multi_i1",
    "patch_id": "t2",
    "iteration": 1,
    "original_sql": "with ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address, item\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n  and ss_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ss_list_price between 86 and 100\n  and ca_state in ('IA','IL')\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address, item\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n  and ws_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ws_list_price between 86 and 100\n  and ca_state in ('IA','IL')\ngroup by ca_county,d_qoy, d_year)\n select\n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.d_year;",
    "patch_sql": "WITH ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND ss_item_sk = i_item_sk AND i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ss_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address, item WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27 AND ws_list_price BETWEEN 86 AND 100 AND ca_state IN ('IA', 'IL') GROUP BY ca_county, d_qoy, d_year), filtered_items AS (SELECT i_item_sk FROM item WHERE i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27), filtered_addresses AS (SELECT ca_address_sk, ca_county FROM customer_address WHERE ca_state IN ('IA', 'IL')) SELECT ss1.ca_county, ss1.d_year, ws2.web_sales / ws1.web_sales AS web_q1_q2_increase, ss2.store_sales / ss1.store_sales AS store_q1_q2_increase, ws3.web_sales / ws2.web_sales AS web_q2_q3_increase, ss3.store_sales / ss2.store_sales AS store_q2_q3_increase FROM ss AS ss1 INNER JOIN ss AS ss2 ON ss1.ca_county = ss2.ca_county AND ss2.d_qoy = 2 AND ss2.d_year = 1998 INNER JOIN ss AS ss3 ON ss2.ca_county = ss3.ca_county AND ss3.d_qoy = 3 AND ss3.d_year = 1998 INNER JOIN ws AS ws1 ON ss1.ca_county = ws1.ca_county AND ws1.d_qoy = 1 AND ws1.d_year = 1998 INNER JOIN ws AS ws2 ON ws1.ca_county = ws2.ca_county AND ws2.d_qoy = 2 AND ws2.d_year = 1998 INNER JOIN ws AS ws3 ON ws1.ca_county = ws3.ca_county AND ws3.d_qoy = 3 AND ws3.d_year = 1998 WHERE ss1.d_qoy = 1 AND ss1.d_year = 1998 AND (CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END) > (CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END) AND (CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END) > (CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END) ORDER BY ss1.d_year;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "patch_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query031_multi_i1",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "with ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address, item\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n  and ss_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ss_list_price between 86 and 100\n  and ca_state in ('IA','IL')\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address, item\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n  and ws_item_sk = i_item_sk\n  and i_color IN ('navajo', 'orchid')\n  and i_manager_id BETWEEN 8 and 27\n  and ws_list_price between 86 and 100\n  and ca_state in ('IA','IL')\ngroup by ca_county,d_qoy, d_year)\n select\n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.d_year;",
    "patch_sql": "WITH filtered_item AS (SELECT i_item_sk FROM item WHERE i_color IN ('navajo', 'orchid') AND i_manager_id BETWEEN 8 AND 27), filtered_address AS (SELECT ca_address_sk, ca_county FROM customer_address WHERE ca_state IN ('IA', 'IL')), ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND ss_item_sk = i_item_sk AND i_item_sk IN (SELECT i_item_sk FROM filtered_item) AND ca_address_sk IN (SELECT ca_address_sk FROM filtered_address) AND d_year = 1998 AND d_qoy IN (1, 2, 3) AND ss_list_price BETWEEN 86 AND 100 GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address, item WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND i_item_sk IN (SELECT i_item_sk FROM filtered_item) AND ca_address_sk IN (SELECT ca_address_sk FROM filtered_address) AND d_year = 1998 AND d_qoy IN (1, 2, 3) AND ws_list_price BETWEEN 86 AND 100 GROUP BY ca_county, d_qoy, d_year) SELECT ss1.ca_county, ss1.d_year, ws2.web_sales / ws1.web_sales AS web_q1_q2_increase, ss2.store_sales / ss1.store_sales AS store_q1_q2_increase, ws3.web_sales / ws2.web_sales AS web_q2_q3_increase, ss3.store_sales / ss2.store_sales AS store_q2_q3_increase FROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3 WHERE ss1.d_qoy = 1 AND ss1.d_year = 1998 AND ss1.ca_county = ss2.ca_county AND ss2.d_qoy = 2 AND ss2.d_year = 1998 AND ss2.ca_county = ss3.ca_county AND ss3.d_qoy = 3 AND ss3.d_year = 1998 AND ss1.ca_county = ws1.ca_county AND ws1.d_qoy = 1 AND ws1.d_year = 1998 AND ws1.ca_county = ws2.ca_county AND ws2.d_qoy = 2 AND ws2.d_year = 1998 AND ws1.ca_county = ws3.ca_county AND ws3.d_qoy = 3 AND ws3.d_year = 1998 AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END ORDER BY ss1.d_year;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "patch_cksum": "c5960a04c2e1204d7b8e49d13b6379ea",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query031_multi_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "with ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address, item\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n  and ss_item_sk = i_item_sk\n  and i_color IN ('dark', 'puff')\n  and i_manager_id BETWEEN 15 and 34\n  and ss_list_price between 244 and 258\n  and ca_state in ('KS','OH')\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address, item\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n  and ws_item_sk = i_item_sk\n  and i_color IN ('dark', 'puff')\n  and i_manager_id BETWEEN 15 and 34\n  and ws_list_price between 244 and 258\n  and ca_state in ('KS','OH')\ngroup by ca_county,d_qoy, d_year)\n select\n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1999\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1999\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1999\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1999\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1999\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1999\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.d_year;",
    "patch_sql": "WITH ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND ss_item_sk = i_item_sk AND i_color IN ('dark', 'puff') AND i_manager_id BETWEEN 15 AND 34 AND ss_list_price BETWEEN 244 AND 258 AND ca_state IN ('KS', 'OH') AND d_year = 1999 AND d_qoy IN (1, 2, 3) GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address, item WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND i_color IN ('dark', 'puff') AND i_manager_id BETWEEN 15 AND 34 AND ws_list_price BETWEEN 244 AND 258 AND ca_state IN ('KS', 'OH') AND d_year = 1999 AND d_qoy IN (1, 2, 3) GROUP BY ca_county, d_qoy, d_year) SELECT ss1.ca_county, ss1.d_year, ws2.web_sales / ws1.web_sales AS web_q1_q2_increase, ss2.store_sales / ss1.store_sales AS store_q1_q2_increase, ws3.web_sales / ws2.web_sales AS web_q2_q3_increase, ss3.store_sales / ss2.store_sales AS store_q2_q3_increase FROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3 WHERE ss1.d_qoy = 1 AND ss1.d_year = 1999 AND ss1.ca_county = ss2.ca_county AND ss2.d_qoy = 2 AND ss2.d_year = 1999 AND ss2.ca_county = ss3.ca_county AND ss3.d_qoy = 3 AND ss3.d_year = 1999 AND ss1.ca_county = ws1.ca_county AND ws1.d_qoy = 1 AND ws1.d_year = 1999 AND ws1.ca_county = ws2.ca_county AND ws2.d_qoy = 2 AND ws2.d_year = 1999 AND ws1.ca_county = ws3.ca_county AND ws3.d_qoy = 3 AND ws3.d_year = 1999 AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END ORDER BY ss1.d_year;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "56f22b5f4d8c16f1970d67f8ef0bb9b1",
    "patch_cksum": "56f22b5f4d8c16f1970d67f8ef0bb9b1",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query031_multi_i2",
    "patch_id": "syn_w1",
    "iteration": 0,
    "original_sql": "with ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address, item\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n  and ss_item_sk = i_item_sk\n  and i_color IN ('dark', 'puff')\n  and i_manager_id BETWEEN 15 and 34\n  and ss_list_price between 244 and 258\n  and ca_state in ('KS','OH')\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address, item\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n  and ws_item_sk = i_item_sk\n  and i_color IN ('dark', 'puff')\n  and i_manager_id BETWEEN 15 and 34\n  and ws_list_price between 244 and 258\n  and ca_state in ('KS','OH')\ngroup by ca_county,d_qoy, d_year)\n select\n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1999\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1999\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1999\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1999\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1999\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1999\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end\n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by ss1.d_year;",
    "patch_sql": "WITH ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address, item WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND ss_item_sk = i_item_sk AND i_color IN ('dark', 'puff') AND i_manager_id BETWEEN 15 AND 34 AND ss_list_price BETWEEN 244 AND 258 AND ca_state IN ('KS', 'OH') AND d_year = 1999 AND d_qoy IN (1, 2, 3) GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address, item WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND i_color IN ('dark', 'puff') AND i_manager_id BETWEEN 15 AND 34 AND ws_list_price BETWEEN 244 AND 258 AND ca_state IN ('KS', 'OH') AND d_year = 1999 AND d_qoy IN (1, 2, 3) GROUP BY ca_county, d_qoy, d_year) SELECT ss1.ca_county, ss1.d_year, ws2.web_sales / ws1.web_sales AS web_q1_q2_increase, ss2.store_sales / ss1.store_sales AS store_q1_q2_increase, ws3.web_sales / ws2.web_sales AS web_q2_q3_increase, ss3.store_sales / ss2.store_sales AS store_q2_q3_increase FROM ss AS ss1, ss AS ss2, ss AS ss3, ws AS ws1, ws AS ws2, ws AS ws3 WHERE ss1.d_qoy = 1 AND ss1.d_year = 1999 AND ss1.ca_county = ss2.ca_county AND ss2.d_qoy = 2 AND ss2.d_year = 1999 AND ss2.ca_county = ss3.ca_county AND ss3.d_qoy = 3 AND ss3.d_year = 1999 AND ss1.ca_county = ws1.ca_county AND ws1.d_qoy = 1 AND ws1.d_year = 1999 AND ws1.ca_county = ws2.ca_county AND ws2.d_qoy = 2 AND ws2.d_year = 1999 AND ws1.ca_county = ws3.ca_county AND ws3.d_qoy = 3 AND ws3.d_year = 1999 AND CASE WHEN ws1.web_sales > 0 THEN ws2.web_sales / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN ss2.store_sales / ss1.store_sales ELSE NULL END AND CASE WHEN ws2.web_sales > 0 THEN ws3.web_sales / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN ss3.store_sales / ss2.store_sales ELSE NULL END ORDER BY ss1.d_year;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "56f22b5f4d8c16f1970d67f8ef0bb9b1",
    "patch_cksum": "56f22b5f4d8c16f1970d67f8ef0bb9b1",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query038_multi_i1",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select  count(*) from (\n    select distinct c_last_name, c_first_name, d_date\n    from store_sales, date_dim, customer\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      and store_sales.ss_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and ss_list_price between 193 and 252\n      and ss_wholesale_cost BETWEEN 35 AND 55\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from catalog_sales, date_dim, customer\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and cs_list_price between 193 and 252\n      and cs_wholesale_cost BETWEEN 35 AND 55\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from web_sales, date_dim, customer\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and ws_list_price between 193 and 252\n      and ws_wholesale_cost BETWEEN 35 AND 55\n) hot_cust\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_month IN (1, 2, 5, 12)), store_sales_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss INNER JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN filtered_customers AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 193 AND 252 AND ss.ss_wholesale_cost BETWEEN 35 AND 55) SELECT COUNT(*) FROM store_sales_base AS ssb WHERE EXISTS(SELECT 1 FROM catalog_sales AS cs INNER JOIN filtered_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN filtered_customers AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 193 AND 252 AND cs.cs_wholesale_cost BETWEEN 35 AND 55 AND c.c_last_name = ssb.c_last_name AND c.c_first_name = ssb.c_first_name AND d.d_date = ssb.d_date) AND EXISTS(SELECT 1 FROM web_sales AS ws INNER JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN filtered_customers AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 193 AND 252 AND ws.ws_wholesale_cost BETWEEN 35 AND 55 AND c.c_last_name = ssb.c_last_name AND c.c_first_name = ssb.c_first_name AND d.d_date = ssb.d_date) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "patch_cksum": "66ecce8f96446270380e38b993187e97",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "CHECKSUM_MISMATCH"
  },
  {
    "query_id": "query038_multi_i1",
    "patch_id": "t2",
    "iteration": 1,
    "original_sql": "select  count(*) from (\n    select distinct c_last_name, c_first_name, d_date\n    from store_sales, date_dim, customer\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      and store_sales.ss_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and ss_list_price between 193 and 252\n      and ss_wholesale_cost BETWEEN 35 AND 55\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from catalog_sales, date_dim, customer\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and cs_list_price between 193 and 252\n      and cs_wholesale_cost BETWEEN 35 AND 55\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from web_sales, date_dim, customer\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and ws_list_price between 193 and 252\n      and ws_wholesale_cost BETWEEN 35 AND 55\n) hot_cust\nlimit 100;",
    "patch_sql": "WITH store_sales_agg AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 193 AND 252 AND ss_wholesale_cost BETWEEN 35 AND 55 GROUP BY ss_customer_sk, ss_sold_date_sk), catalog_sales_agg AS (SELECT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 193 AND 252 AND cs_wholesale_cost BETWEEN 35 AND 55 GROUP BY cs_bill_customer_sk, cs_sold_date_sk), web_sales_agg AS (SELECT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_list_price BETWEEN 193 AND 252 AND ws_wholesale_cost BETWEEN 35 AND 55 GROUP BY ws_bill_customer_sk, ws_sold_date_sk), store_sales_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales_agg AS ss INNER JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1200 AND 1200 + 11 AND c.c_birth_month IN (1, 2, 5, 12)) SELECT COUNT(*) FROM store_sales_base AS ssb WHERE EXISTS(SELECT 1 FROM catalog_sales_agg AS cs INNER JOIN date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1200 AND 1200 + 11 AND c.c_birth_month IN (1, 2, 5, 12) AND c.c_last_name = ssb.c_last_name AND c.c_first_name = ssb.c_first_name AND d.d_date = ssb.d_date) AND EXISTS(SELECT 1 FROM web_sales_agg AS ws INNER JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1200 AND 1200 + 11 AND c.c_birth_month IN (1, 2, 5, 12) AND c.c_last_name = ssb.c_last_name AND c.c_first_name = ssb.c_first_name AND d.d_date = ssb.d_date) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "patch_cksum": "66ecce8f96446270380e38b993187e97",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "CHECKSUM_MISMATCH"
  },
  {
    "query_id": "query038_multi_i1",
    "patch_id": "t3",
    "iteration": 1,
    "original_sql": "select  count(*) from (\n    select distinct c_last_name, c_first_name, d_date\n    from store_sales, date_dim, customer\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      and store_sales.ss_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and ss_list_price between 193 and 252\n      and ss_wholesale_cost BETWEEN 35 AND 55\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from catalog_sales, date_dim, customer\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and cs_list_price between 193 and 252\n      and cs_wholesale_cost BETWEEN 35 AND 55\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from web_sales, date_dim, customer\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and ws_list_price between 193 and 252\n      and ws_wholesale_cost BETWEEN 35 AND 55\n) hot_cust\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name, c_birth_month FROM customer WHERE c_birth_month IN (1, 2, 5, 12)) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_customers ON store_sales.ss_customer_sk = filtered_customers.c_customer_sk WHERE ss_list_price BETWEEN 193 AND 252 AND ss_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN filtered_dates ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_customers ON catalog_sales.cs_bill_customer_sk = filtered_customers.c_customer_sk WHERE cs_list_price BETWEEN 193 AND 252 AND cs_wholesale_cost BETWEEN 35 AND 55 INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN filtered_dates ON web_sales.ws_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_customers ON web_sales.ws_bill_customer_sk = filtered_customers.c_customer_sk WHERE ws_list_price BETWEEN 193 AND 252 AND ws_wholesale_cost BETWEEN 35 AND 55) AS hot_cust LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "patch_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query038_multi_i1",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "select  count(*) from (\n    select distinct c_last_name, c_first_name, d_date\n    from store_sales, date_dim, customer\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      and store_sales.ss_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and ss_list_price between 193 and 252\n      and ss_wholesale_cost BETWEEN 35 AND 55\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from catalog_sales, date_dim, customer\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and cs_list_price between 193 and 252\n      and cs_wholesale_cost BETWEEN 35 AND 55\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from web_sales, date_dim, customer\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1200 and 1200 + 11\n      and c_birth_month in (1, 2, 5, 12)\n      and ws_list_price between 193 and 252\n      and ws_wholesale_cost BETWEEN 35 AND 55\n) hot_cust\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_month IN (1, 2, 5, 12)), filtered_store_sales AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 193 AND 252 AND ss_wholesale_cost BETWEEN 35 AND 55), filtered_catalog_sales AS (SELECT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 193 AND 252 AND cs_wholesale_cost BETWEEN 35 AND 55), filtered_web_sales AS (SELECT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_list_price BETWEEN 193 AND 252 AND ws_wholesale_cost BETWEEN 35 AND 55) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM filtered_store_sales AS ss JOIN filtered_dates AS dd ON ss.ss_sold_date_sk = dd.d_date_sk JOIN filtered_customers AS cc ON ss.ss_customer_sk = cc.c_customer_sk INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM filtered_catalog_sales AS cs JOIN filtered_dates AS dd ON cs.cs_sold_date_sk = dd.d_date_sk JOIN filtered_customers AS cc ON cs.cs_bill_customer_sk = cc.c_customer_sk INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM filtered_web_sales AS ws JOIN filtered_dates AS dd ON ws.ws_sold_date_sk = dd.d_date_sk JOIN filtered_customers AS cc ON ws.ws_bill_customer_sk = cc.c_customer_sk) AS hot_cust LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "patch_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query038_multi_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select  count(*) from (\n    select distinct c_last_name, c_first_name, d_date\n    from store_sales, date_dim, customer\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      and store_sales.ss_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ss_list_price between 241 and 300\n      and ss_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from catalog_sales, date_dim, customer\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and cs_list_price between 241 and 300\n      and cs_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from web_sales, date_dim, customer\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ws_list_price between 241 and 300\n      and ws_wholesale_cost BETWEEN 76 AND 96\n) hot_cust\nlimit 100;",
    "patch_sql": "WITH store AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales, date_dim, customer WHERE store_sales.ss_sold_date_sk = date_dim.d_date_sk AND store_sales.ss_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales, date_dim, customer WHERE catalog_sales.cs_sold_date_sk = date_dim.d_date_sk AND catalog_sales.cs_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web AS (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_dim, customer WHERE web_sales.ws_sold_date_sk = date_dim.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) AND ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM store WHERE EXISTS(SELECT 1 FROM catalog WHERE c_last_name = store.c_last_name AND c_first_name = store.c_first_name AND d_date = store.d_date) AND EXISTS(SELECT 1 FROM web WHERE c_last_name = store.c_last_name AND c_first_name = store.c_first_name AND d_date = store.d_date) LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 23741c356c789badef33447f1f27f2b6 vs 2a9ccd09",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "patch_cksum": "66ecce8f96446270380e38b993187e97",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "CHECKSUM_MISMATCH"
  },
  {
    "query_id": "query038_multi_i2",
    "patch_id": "t3",
    "iteration": 0,
    "original_sql": "select  count(*) from (\n    select distinct c_last_name, c_first_name, d_date\n    from store_sales, date_dim, customer\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      and store_sales.ss_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ss_list_price between 241 and 300\n      and ss_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from catalog_sales, date_dim, customer\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and cs_list_price between 241 and 300\n      and cs_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from web_sales, date_dim, customer\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ws_list_price between 241 and 300\n      and ws_wholesale_cost BETWEEN 76 AND 96\n) hot_cust\nlimit 100;",
    "patch_sql": "WITH store_sales_filtered AS (SELECT * FROM store_sales WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_sales_filtered AS (SELECT * FROM catalog_sales WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_sales_filtered AS (SELECT * FROM web_sales WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales_filtered, date_dim, customer WHERE ss_sold_date_sk = d_date_sk AND ss_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales_filtered, date_dim, customer WHERE cs_sold_date_sk = d_date_sk AND cs_bill_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10) INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales_filtered, date_dim, customer WHERE ws_sold_date_sk = d_date_sk AND ws_bill_customer_sk = c_customer_sk AND d_month_seq BETWEEN 1207 AND 1207 + 11 AND c_birth_month IN (2, 3, 4, 10)) AS hot_cust LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "patch_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query038_multi_i2",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "select  count(*) from (\n    select distinct c_last_name, c_first_name, d_date\n    from store_sales, date_dim, customer\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      and store_sales.ss_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ss_list_price between 241 and 300\n      and ss_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from catalog_sales, date_dim, customer\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and cs_list_price between 241 and 300\n      and cs_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from web_sales, date_dim, customer\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ws_list_price between 241 and 300\n      and ws_wholesale_cost BETWEEN 76 AND 96\n) hot_cust\nlimit 100;",
    "patch_sql": "WITH date_filter AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11), customer_filter AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_month IN (2, 3, 4, 10)), store_sales_filtered AS (SELECT ss_customer_sk, ss_sold_date_sk, ss_list_price, ss_wholesale_cost FROM store_sales WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), catalog_sales_filtered AS (SELECT cs_bill_customer_sk, cs_sold_date_sk, cs_list_price, cs_wholesale_cost FROM catalog_sales WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), web_sales_filtered AS (SELECT ws_bill_customer_sk, ws_sold_date_sk, ws_list_price, ws_wholesale_cost FROM web_sales WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96), hot_cust AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales_filtered AS s JOIN date_filter AS d ON s.ss_sold_date_sk = d.d_date_sk JOIN customer_filter AS c ON s.ss_customer_sk = c.c_customer_sk WHERE EXISTS(SELECT 1 FROM catalog_sales_filtered AS cs WHERE cs.cs_bill_customer_sk = c.c_customer_sk AND cs.cs_sold_date_sk = d.d_date_sk) AND EXISTS(SELECT 1 FROM web_sales_filtered AS ws WHERE ws.ws_bill_customer_sk = c.c_customer_sk AND ws.ws_sold_date_sk = d.d_date_sk)) SELECT COUNT(*) FROM hot_cust LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (retry failed): Checksum mismatch: original=2a9ccd09d8f9afdc982ef7c8",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "patch_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query038_multi_i2",
    "patch_id": "t2",
    "iteration": 2,
    "original_sql": "select  count(*) from (\n    select distinct c_last_name, c_first_name, d_date\n    from store_sales, date_dim, customer\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      and store_sales.ss_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ss_list_price between 241 and 300\n      and ss_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from catalog_sales, date_dim, customer\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and cs_list_price between 241 and 300\n      and cs_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from web_sales, date_dim, customer\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ws_list_price between 241 and 300\n      and ws_wholesale_cost BETWEEN 76 AND 96\n) hot_cust\nlimit 100;",
    "patch_sql": "WITH web_sales_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM web_sales AS ws INNER JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1207 AND 1207 + 11 AND c.c_birth_month IN (2, 3, 4, 10) AND ws.ws_list_price BETWEEN 241 AND 300 AND ws.ws_wholesale_cost BETWEEN 76 AND 96) SELECT COUNT(*) FROM web_sales_base AS wsb WHERE EXISTS(SELECT 1 FROM store_sales AS ss INNER JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1207 AND 1207 + 11 AND c.c_birth_month IN (2, 3, 4, 10) AND ss.ss_list_price BETWEEN 241 AND 300 AND ss.ss_wholesale_cost BETWEEN 76 AND 96 AND c.c_last_name = wsb.c_last_name AND c.c_first_name = wsb.c_first_name AND d.d_date = wsb.d_date) AND EXISTS(SELECT 1 FROM catalog_sales AS cs INNER JOIN date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1207 AND 1207 + 11 AND c.c_birth_month IN (2, 3, 4, 10) AND cs.cs_list_price BETWEEN 241 AND 300 AND cs.cs_wholesale_cost BETWEEN 76 AND 96 AND c.c_last_name = wsb.c_last_name AND c.c_first_name = wsb.c_first_name AND d.d_date = wsb.d_date) LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (retry failed): Checksum mismatch: original=2a9ccd09d8f9afdc982ef7c8",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "patch_cksum": "66ecce8f96446270380e38b993187e97",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "CHECKSUM_MISMATCH"
  },
  {
    "query_id": "query038_multi_i2",
    "patch_id": "t3",
    "iteration": 2,
    "original_sql": "select  count(*) from (\n    select distinct c_last_name, c_first_name, d_date\n    from store_sales, date_dim, customer\n          where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n      and store_sales.ss_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ss_list_price between 241 and 300\n      and ss_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from catalog_sales, date_dim, customer\n          where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n      and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and cs_list_price between 241 and 300\n      and cs_wholesale_cost BETWEEN 76 AND 96\n  intersect\n    select distinct c_last_name, c_first_name, d_date\n    from web_sales, date_dim, customer\n          where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n      and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n      and d_month_seq between 1207 and 1207 + 11\n      and c_birth_month in (2, 3, 4, 10)\n      and ws_list_price between 241 and 300\n      and ws_wholesale_cost BETWEEN 76 AND 96\n) hot_cust\nlimit 100;",
    "patch_sql": "WITH ss_filtered AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 241 AND 300 AND ss_wholesale_cost BETWEEN 76 AND 96), cs_filtered AS (SELECT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 241 AND 300 AND cs_wholesale_cost BETWEEN 76 AND 96), ws_filtered AS (SELECT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_list_price BETWEEN 241 AND 300 AND ws_wholesale_cost BETWEEN 76 AND 96), filtered_date AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1207 AND 1207 + 11), filtered_customer AS (SELECT c_customer_sk, c_last_name, c_first_name, c_birth_month FROM customer WHERE c_birth_month IN (2, 3, 4, 10)) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM ss_filtered AS ss JOIN filtered_customer AS c ON ss.ss_customer_sk = c.c_customer_sk JOIN filtered_date AS d ON ss.ss_sold_date_sk = d.d_date_sk INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM cs_filtered AS cs JOIN filtered_customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN filtered_date AS d ON cs.cs_sold_date_sk = d.d_date_sk INTERSECT SELECT DISTINCT c_last_name, c_first_name, d_date FROM ws_filtered AS ws JOIN filtered_customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN filtered_date AS d ON ws.ws_sold_date_sk = d.d_date_sk) AS hot_cust LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "patch_cksum": "f0a54eaaf7d53e4ff1ba587d1e374b7c",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query039_multi_i1",
    "patch_id": "syn_w2",
    "iteration": 0,
    "original_sql": "with inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2002\n        and i_category IN ('Jewelry', 'Men')\n        and i_manager_id BETWEEN 81 and 100\n        and inv_quantity_on_hand between 0 and 200\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=2\n  and inv2.d_moy=2+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n        ,inv2.d_moy,inv2.mean, inv2.cov\n;\nwith inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2002\n        and i_category IN ('Jewelry', 'Men')\n        and i_manager_id BETWEEN 81 and 100\n        and inv_quantity_on_hand between 0 and 200\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=2\n  and inv2.d_moy=2+1\n  and inv1.cov > 1.5\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n        ,inv2.d_moy,inv2.mean, inv2.cov\n;",
    "patch_sql": "WITH inventory_filtered AS (SELECT inv_item_sk, inv_warehouse_sk, inv_date_sk, inv_quantity_on_hand, w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy FROM inventory INNER JOIN item ON inv_item_sk = i_item_sk INNER JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk INNER JOIN date_dim ON inv_date_sk = d_date_sk WHERE d_year = 2002 AND i_category IN ('Jewelry', 'Men') AND i_manager_id BETWEEN 81 AND 100 AND inv_quantity_on_hand BETWEEN 0 AND 200 AND d_moy IN (2, 3)), inventory_stats AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, STDDEV_SAMP(inv_quantity_on_hand) AS stdev, AVG(inv_quantity_on_hand) AS mean FROM inventory_filtered GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy), inv AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM inventory_stats WHERE CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1) SELECT inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM inv AS inv1, inv AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk AND inv1.d_moy = 2 AND inv2.d_moy = 3 AND inv1.cov > 1.5 ORDER BY inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.d_moy, inv2.mean, inv2.cov;\n\nWITH inv AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, STDDEV_SAMP(inv_quantity_on_hand) AS stdev, AVG(inv_quantity_on_hand) AS mean FROM inventory, item, warehouse, date_dim WHERE inv_item_sk = i_item_sk AND inv_warehouse_sk = w_warehouse_sk AND inv_date_sk = d_date_sk AND d_year = 2002 AND i_category IN ('Jewelry', 'Men') AND i_manager_id BETWEEN 81 AND 100 AND inv_quantity_on_hand BETWEEN 0 AND 200 GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy) AS foo WHERE CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1) SELECT inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM inv AS inv1, inv AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk AND inv1.d_moy = 2 AND inv2.d_moy = 2 + 1 AND inv1.cov > 1.5 ORDER BY inv1.w_warehouse_sk, inv1.i_item_sk, inv1.d_moy, inv1.mean, inv1.cov, inv2.d_moy, inv2.mean, inv2.cov;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "cfa23bece7f14b5dc689d99958783571",
    "patch_cksum": "cfa23bece7f14b5dc689d99958783571",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query040_agg_i1",
    "patch_id": "S0",
    "iteration": 1,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-19' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-19' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-19' as date) - interval '30 day')\n                and (cast ('2002-02-19' as date) + interval '30 day') \n and i_category  = 'Jewelry'\n and i_manager_id between 61 and 100\n and cs_wholesale_cost between 42 and 61\n and cr_reason_sk = 33\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "WITH filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Jewelry' AND i_manager_id BETWEEN 61 AND 100), filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN (CAST('2002-02-19' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-19' AS DATE) + INTERVAL '30 DAY')) SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-19' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-19' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales JOIN filtered_items ON cs_item_sk = i_item_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk AND cr_reason_sk = 33 JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk WHERE cs_wholesale_cost BETWEEN 42 AND 61 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): row count 100 vs 0",
    "gt_semantic_passed": false,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query040_agg_i1",
    "patch_id": "S0",
    "iteration": 2,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-19' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-19' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-19' as date) - interval '30 day')\n                and (cast ('2002-02-19' as date) + interval '30 day') \n and i_category  = 'Jewelry'\n and i_manager_id between 61 and 100\n and cs_wholesale_cost between 42 and 61\n and cr_reason_sk = 33\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN (CAST('2002-02-19' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-19' AS DATE) + INTERVAL '30 DAY')) SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-19' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-19' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk WHERE i_category = 'Jewelry' AND i_manager_id BETWEEN 61 AND 100 AND cs_wholesale_cost BETWEEN 42 AND 61 AND cr_reason_sk = 33 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query040_agg_i1",
    "patch_id": "S0",
    "iteration": 2,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-19' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-19' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-19' as date) - interval '30 day')\n                and (cast ('2002-02-19' as date) + interval '30 day') \n and i_category  = 'Jewelry'\n and i_manager_id between 61 and 100\n and cs_wholesale_cost between 42 and 61\n and cr_reason_sk = 33\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN (CAST('2002-02-19' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-19' AS DATE) + INTERVAL '30 DAY')) SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-19' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-19' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk WHERE i_category = 'Jewelry' AND i_manager_id BETWEEN 61 AND 100 AND cs_wholesale_cost BETWEEN 42 AND 61 AND cr_reason_sk = 33 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query040_agg_i1",
    "patch_id": "S0",
    "iteration": 2,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-19' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-19' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-19' as date) - interval '30 day')\n                and (cast ('2002-02-19' as date) + interval '30 day') \n and i_category  = 'Jewelry'\n and i_manager_id between 61 and 100\n and cs_wholesale_cost between 42 and 61\n and cr_reason_sk = 33\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN (CAST('2002-02-19' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-19' AS DATE) + INTERVAL '30 DAY')) SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-19' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-19' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk WHERE i_category = 'Jewelry' AND i_manager_id BETWEEN 61 AND 100 AND cs_wholesale_cost BETWEEN 42 AND 61 AND cr_reason_sk = 33 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query040_agg_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-20' as date) - interval '30 day')\n                and (cast ('2002-02-20' as date) + interval '30 day') \n and i_category  = 'Shoes'\n and i_manager_id between 42 and 81\n and cs_wholesale_cost between 68 and 87\n and cr_reason_sk = 40\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk AND cr_reason_sk = 40) INNER JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk INNER JOIN item ON i_item_sk = cs_item_sk INNER JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE d_date BETWEEN (CAST('2002-02-20' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-20' AS DATE) + INTERVAL '30 DAY') AND i_category = 'Shoes' AND i_manager_id BETWEEN 42 AND 81 AND cs_wholesale_cost BETWEEN 68 AND 87 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): row count 100 vs 0",
    "gt_semantic_passed": false,
    "orig_rows": 0,
    "patch_rows": 2,
    "orig_cksum": "empty",
    "patch_cksum": "5a935ee45e82a76578f5d39df71bc2d5",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query040_agg_i2",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-20' as date) - interval '30 day')\n                and (cast ('2002-02-20' as date) + interval '30 day') \n and i_category  = 'Shoes'\n and i_manager_id between 42 and 81\n and cs_wholesale_cost between 68 and 87\n and cr_reason_sk = 40\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "WITH filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Shoes' AND i_manager_id BETWEEN 42 AND 81), filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN (CAST('2002-02-20' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-20' AS DATE) + INTERVAL '30 DAY')) SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales JOIN filtered_items ON cs_item_sk = filtered_items.i_item_sk JOIN filtered_dates ON cs_sold_date_sk = filtered_dates.d_date_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk AND cr_reason_sk = 40 WHERE cs_wholesale_cost BETWEEN 68 AND 87 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): row count 100 vs 0",
    "gt_semantic_passed": false,
    "orig_rows": 0,
    "patch_rows": 2,
    "orig_cksum": "empty",
    "patch_cksum": "5a935ee45e82a76578f5d39df71bc2d5",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query040_agg_i2",
    "patch_id": "S0",
    "iteration": 2,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-20' as date) - interval '30 day')\n                and (cast ('2002-02-20' as date) + interval '30 day') \n and i_category  = 'Shoes'\n and i_manager_id between 42 and 81\n and cs_wholesale_cost between 68 and 87\n and cr_reason_sk = 40\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN (CAST('2002-02-20' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-20' AS DATE) + INTERVAL '30 DAY')), filtered_items AS (SELECT i_item_sk, i_item_id, i_category, i_manager_id FROM item WHERE i_category = 'Shoes' AND i_manager_id BETWEEN 42 AND 81) SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales JOIN filtered_items ON cs_item_sk = i_item_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk WHERE cs_wholesale_cost BETWEEN 68 AND 87 AND cr_reason_sk = 40 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query040_agg_i2",
    "patch_id": "S0",
    "iteration": 2,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-20' as date) - interval '30 day')\n                and (cast ('2002-02-20' as date) + interval '30 day') \n and i_category  = 'Shoes'\n and i_manager_id between 42 and 81\n and cs_wholesale_cost between 68 and 87\n and cr_reason_sk = 40\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN (CAST('2002-02-20' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-20' AS DATE) + INTERVAL '30 DAY')), filtered_items AS (SELECT i_item_sk, i_item_id, i_category, i_manager_id FROM item WHERE i_category = 'Shoes' AND i_manager_id BETWEEN 42 AND 81) SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales JOIN filtered_items ON cs_item_sk = i_item_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk WHERE cs_wholesale_cost BETWEEN 68 AND 87 AND cr_reason_sk = 40 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query040_agg_i2",
    "patch_id": "S0",
    "iteration": 2,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-20' as date) - interval '30 day')\n                and (cast ('2002-02-20' as date) + interval '30 day') \n and i_category  = 'Shoes'\n and i_manager_id between 42 and 81\n and cs_wholesale_cost between 68 and 87\n and cr_reason_sk = 40\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN (CAST('2002-02-20' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-20' AS DATE) + INTERVAL '30 DAY')), filtered_items AS (SELECT i_item_sk, i_item_id, i_category, i_manager_id FROM item WHERE i_category = 'Shoes' AND i_manager_id BETWEEN 42 AND 81) SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales JOIN filtered_items ON cs_item_sk = i_item_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk WHERE cs_wholesale_cost BETWEEN 68 AND 87 AND cr_reason_sk = 40 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query040_agg_i2",
    "patch_id": "S0",
    "iteration": 2,
    "original_sql": "select \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2002-02-20' as date))\n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number\n        and cs_item_sk = cr_item_sk)\n  ,warehouse\n  ,item\n  ,date_dim\n where\n i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk\n and cs_sold_date_sk    = d_date_sk\n and d_date between  (cast ('2002-02-20' as date) - interval '30 day')\n                and (cast ('2002-02-20' as date) + interval '30 day') \n and i_category  = 'Shoes'\n and i_manager_id between 42 and 81\n and cs_wholesale_cost between 68 and 87\n and cr_reason_sk = 40\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN (CAST('2002-02-20' AS DATE) - INTERVAL '30 DAY') AND (CAST('2002-02-20' AS DATE) + INTERVAL '30 DAY')), filtered_items AS (SELECT i_item_sk, i_item_id, i_category, i_manager_id FROM item WHERE i_category = 'Shoes' AND i_manager_id BETWEEN 42 AND 81) SELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2002-02-20' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales JOIN filtered_items ON cs_item_sk = i_item_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk LEFT JOIN catalog_returns ON cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk WHERE cs_wholesale_cost BETWEEN 68 AND 87 AND cr_reason_sk = 40 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query050_agg_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"\nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\nand d1.d_date between (d2.d_date - interval '120 day')\n               and d2.d_date\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n        ,s_zip\nlimit 100;",
    "patch_sql": "WITH d2_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 2000 AND d_moy = 8), d1_date_bounds AS (SELECT MIN(d_date) AS min_d2_date, MAX(d_date) AS max_d2_date FROM d2_dates), d1_dates AS (SELECT d_date_sk, d_date FROM date_dim, d1_date_bounds WHERE d_date BETWEEN (min_d2_date - INTERVAL '120 DAY') AND max_d2_date), filtered_sales AS (SELECT ss_ticket_number, ss_item_sk, ss_customer_sk, ss_store_sk, d1_dates.d_date AS sold_date, ss_sold_date_sk FROM store_sales INNER JOIN d1_dates ON store_sales.ss_sold_date_sk = d1_dates.d_date_sk), filtered_returns AS (SELECT sr_ticket_number, sr_item_sk, sr_customer_sk, d2_dates.d_date AS return_date, sr_returned_date_sk FROM store_returns INNER JOIN d2_dates ON store_returns.sr_returned_date_sk = d2_dates.d_date_sk) SELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 30) AND (sr_returned_date_sk - ss_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 60) AND (sr_returned_date_sk - ss_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 90) AND (sr_returned_date_sk - ss_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM filtered_sales INNER JOIN filtered_returns ON filtered_sales.ss_ticket_number = filtered_returns.sr_ticket_number AND filtered_sales.ss_item_sk = filtered_returns.sr_item_sk AND filtered_sales.ss_customer_sk = filtered_returns.sr_customer_sk INNER JOIN store ON filtered_sales.ss_store_sk = store.s_store_sk WHERE filtered_sales.sold_date BETWEEN (filtered_returns.return_date - INTERVAL '120 DAY') AND filtered_returns.return_date GROUP BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip ORDER BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "093619e318741831dff3094b6540dd50",
    "patch_cksum": "093619e318741831dff3094b6540dd50",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query050_agg_i2",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "select \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"\nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 1999\nand d2.d_moy  = 7\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\nand d1.d_date between (d2.d_date - interval '120 day')\n               and d2.d_date\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n        ,s_zip\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d2.d_date_sk AS ret_date_sk, d1.d_date_sk AS sold_date_sk FROM date_dim AS d2 JOIN date_dim AS d1 ON d1.d_date BETWEEN (d2.d_date - INTERVAL '120 DAY') AND d2.d_date WHERE d2.d_year = 1999 AND d2.d_moy = 7) SELECT s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip, SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 30) AND (sr_returned_date_sk - ss_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 60) AND (sr_returned_date_sk - ss_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 90) AND (sr_returned_date_sk - ss_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (sr_returned_date_sk - ss_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM store_sales JOIN store_returns ON ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk AND ss_customer_sk = sr_customer_sk JOIN filtered_dates AS fd ON ss_sold_date_sk = fd.sold_date_sk AND sr_returned_date_sk = fd.ret_date_sk JOIN store ON ss_store_sk = s_store_sk WHERE TRUE GROUP BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip ORDER BY s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "5495c77ff228c01a2bbf7550ff7a7d78",
    "patch_cksum": "5495c77ff228c01a2bbf7550ff7a7d78",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query054_multi_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "with my_customers as (\n select distinct c_customer_sk\n        , c_current_addr_sk\n from\n        ( select cs_sold_date_sk sold_date_sk,\n                 cs_bill_customer_sk customer_sk,\n                 cs_item_sk item_sk,\n                 cs_wholesale_cost wholesale_cost\n          from   catalog_sales\n          union all\n          select ws_sold_date_sk sold_date_sk,\n                 ws_bill_customer_sk customer_sk,\n                 ws_item_sk item_sk,\n                 ws_wholesale_cost wholesale_cost\n          from   web_sales\n         ) cs_or_ws_sales,\n         item,\n         date_dim,\n         customer\n where   sold_date_sk = d_date_sk\n         and item_sk = i_item_sk\n         and i_category = 'Electronics'\n         and i_class = 'personal'\n         and c_customer_sk = cs_or_ws_sales.customer_sk\n         and d_moy = 1\n         and d_year = 1998\n         and wholesale_cost BETWEEN 35 AND 65\n         and c_birth_year BETWEEN 1928 AND 1941\n )\n , my_revenue as (\n select c_customer_sk,\n        sum(ss_ext_sales_price) as revenue\n from   my_customers,\n        store_sales,\n        customer_address,\n        store,\n        date_dim\n where  c_current_addr_sk = ca_address_sk\n        and ca_county = s_county\n        and ca_state = s_state\n        and ss_sold_date_sk = d_date_sk\n        and c_customer_sk = ss_customer_sk\n        and ss_wholesale_cost BETWEEN 35 AND 65\n        and s_state in ('AR','CO','IA'\n                    ,'IL','KY','NC'\n                    ,'NM','NY','PA'\n                    ,'TX')\n        and d_month_seq between (select distinct d_month_seq+1\n                                 from   date_dim where d_year = 1998 and d_moy = 1)\n                           and  (select distinct d_month_seq+3\n                                 from   date_dim where d_year = 1998 and d_moy = 1)\n group by c_customer_sk\n )\n , segments as\n (select cast((revenue/50) as int) as segment\n  from   my_revenue\n )\n  select  segment, count(*) as num_customers, segment*50 as segment_base\n from segments\n group by segment\n order by segment, num_customers\n limit 100;",
    "patch_sql": "WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Electronics' AND i_class = 'personal' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 1 AND d_year = 1998 AND wholesale_cost BETWEEN 35 AND 65 AND c_birth_year BETWEEN 1928 AND 1941), prefetched_dates AS (SELECT d_month_seq FROM date_dim WHERE d_year = 1998 AND d_moy = 1), my_revenue AS (SELECT c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND ss_wholesale_cost BETWEEN 35 AND 65 AND s_state IN ('AR', 'CO', 'IA', 'IL', 'KY', 'NC', 'NM', 'NY', 'PA', 'TX') AND d_month_seq BETWEEN (SELECT d_month_seq + 1 FROM prefetched_dates) AND (SELECT d_month_seq + 3 FROM prefetched_dates) GROUP BY c_customer_sk), segments AS (SELECT CAST((revenue / 50) AS INT) AS segment FROM my_revenue) SELECT segment, COUNT(*) AS num_customers, segment * 50 AS segment_base FROM segments GROUP BY segment ORDER BY segment, num_customers LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query054_multi_i2",
    "patch_id": "syn_w2",
    "iteration": 0,
    "original_sql": "with my_customers as (\n select distinct c_customer_sk\n        , c_current_addr_sk\n from\n        ( select cs_sold_date_sk sold_date_sk,\n                 cs_bill_customer_sk customer_sk,\n                 cs_item_sk item_sk,\n                 cs_wholesale_cost wholesale_cost\n          from   catalog_sales\n          union all\n          select ws_sold_date_sk sold_date_sk,\n                 ws_bill_customer_sk customer_sk,\n                 ws_item_sk item_sk,\n                 ws_wholesale_cost wholesale_cost\n          from   web_sales\n         ) cs_or_ws_sales,\n         item,\n         date_dim,\n         customer\n where   sold_date_sk = d_date_sk\n         and item_sk = i_item_sk\n         and i_category = 'Home'\n         and i_class = 'curtains/drapes'\n         and c_customer_sk = cs_or_ws_sales.customer_sk\n         and d_moy = 5\n         and d_year = 1998\n         and wholesale_cost BETWEEN 70 AND 100\n         and c_birth_year BETWEEN 1942 AND 1955\n )\n , my_revenue as (\n select c_customer_sk,\n        sum(ss_ext_sales_price) as revenue\n from   my_customers,\n        store_sales,\n        customer_address,\n        store,\n        date_dim\n where  c_current_addr_sk = ca_address_sk\n        and ca_county = s_county\n        and ca_state = s_state\n        and ss_sold_date_sk = d_date_sk\n        and c_customer_sk = ss_customer_sk\n        and ss_wholesale_cost BETWEEN 70 AND 100\n        and s_state in ('AR','GA','IN'\n                    ,'KS','KY','NC'\n                    ,'OH','PA','SD'\n                    ,'VA')\n        and d_month_seq between (select distinct d_month_seq+1\n                                 from   date_dim where d_year = 1998 and d_moy = 5)\n                           and  (select distinct d_month_seq+3\n                                 from   date_dim where d_year = 1998 and d_moy = 5)\n group by c_customer_sk\n )\n , segments as\n (select cast((revenue/50) as int) as segment\n  from   my_revenue\n )\n  select  segment, count(*) as num_customers, segment*50 as segment_base\n from segments\n group by segment\n order by segment, num_customers\n limit 100;",
    "patch_sql": "WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Home' AND i_class = 'curtains/drapes' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 5 AND d_year = 1998 AND wholesale_cost BETWEEN 70 AND 100 AND c_birth_year BETWEEN 1942 AND 1955), base_month AS (SELECT DISTINCT d_month_seq FROM date_dim WHERE d_year = 1998 AND d_moy = 5), my_revenue AS (SELECT c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND ss_wholesale_cost BETWEEN 70 AND 100 AND s_state IN ('AR', 'GA', 'IN', 'KS', 'KY', 'NC', 'OH', 'PA', 'SD', 'VA') AND d_month_seq BETWEEN (SELECT d_month_seq + 1 FROM base_month) AND (SELECT d_month_seq + 3 FROM base_month) GROUP BY c_customer_sk), segments AS (SELECT CAST((revenue / 50) AS INT) AS segment FROM my_revenue) SELECT segment, COUNT(*) AS num_customers, segment * 50 AS segment_base FROM segments GROUP BY segment ORDER BY segment, num_customers LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "11cc41518f6cc8be2f6dde4bcd38d930",
    "patch_cksum": "11cc41518f6cc8be2f6dde4bcd38d930",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query054_multi_i2",
    "patch_id": "S0 by_node_id CTE_Q_S0_my_revenue",
    "iteration": 2,
    "original_sql": "with my_customers as (\n select distinct c_customer_sk\n        , c_current_addr_sk\n from\n        ( select cs_sold_date_sk sold_date_sk,\n                 cs_bill_customer_sk customer_sk,\n                 cs_item_sk item_sk,\n                 cs_wholesale_cost wholesale_cost\n          from   catalog_sales\n          union all\n          select ws_sold_date_sk sold_date_sk,\n                 ws_bill_customer_sk customer_sk,\n                 ws_item_sk item_sk,\n                 ws_wholesale_cost wholesale_cost\n          from   web_sales\n         ) cs_or_ws_sales,\n         item,\n         date_dim,\n         customer\n where   sold_date_sk = d_date_sk\n         and item_sk = i_item_sk\n         and i_category = 'Home'\n         and i_class = 'curtains/drapes'\n         and c_customer_sk = cs_or_ws_sales.customer_sk\n         and d_moy = 5\n         and d_year = 1998\n         and wholesale_cost BETWEEN 70 AND 100\n         and c_birth_year BETWEEN 1942 AND 1955\n )\n , my_revenue as (\n select c_customer_sk,\n        sum(ss_ext_sales_price) as revenue\n from   my_customers,\n        store_sales,\n        customer_address,\n        store,\n        date_dim\n where  c_current_addr_sk = ca_address_sk\n        and ca_county = s_county\n        and ca_state = s_state\n        and ss_sold_date_sk = d_date_sk\n        and c_customer_sk = ss_customer_sk\n        and ss_wholesale_cost BETWEEN 70 AND 100\n        and s_state in ('AR','GA','IN'\n                    ,'KS','KY','NC'\n                    ,'OH','PA','SD'\n                    ,'VA')\n        and d_month_seq between (select distinct d_month_seq+1\n                                 from   date_dim where d_year = 1998 and d_moy = 5)\n                           and  (select distinct d_month_seq+3\n                                 from   date_dim where d_year = 1998 and d_moy = 5)\n group by c_customer_sk\n )\n , segments as\n (select cast((revenue/50) as int) as segment\n  from   my_revenue\n )\n  select  segment, count(*) as num_customers, segment*50 as segment_base\n from segments\n group by segment\n order by segment, num_customers\n limit 100;",
    "patch_sql": "WITH my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost FROM web_sales) AS cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Home' AND i_class = 'curtains/drapes' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 5 AND d_year = 1998 AND wholesale_cost BETWEEN 70 AND 100 AND c_birth_year BETWEEN 1942 AND 1955), my_revenue AS (SELECT c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND ss_wholesale_cost BETWEEN 70 AND 100 AND s_state IN ('AR', 'GA', 'IN', 'KS', 'KY', 'NC', 'OH', 'PA', 'SD', 'VA') AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq + 1 FROM date_dim WHERE d_year = 1998 AND d_moy = 5) AND (SELECT DISTINCT d_month_seq + 3 FROM date_dim WHERE d_year = 1998 AND d_moy = 5) GROUP BY c_customer_sk), segments AS (SELECT CAST((revenue / 50) AS INT) AS segment FROM my_revenue), base_month AS (SELECT DISTINCT d_month_seq FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_date_dim AS (SELECT d_date_sk, d_month_seq FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_item AS (SELECT i_item_sk FROM item WHERE i_category = 'Home' AND i_class = 'curtains/drapes') SELECT segment, COUNT(*) AS num_customers, segment * 50 AS segment_base FROM segments GROUP BY segment ORDER BY segment, num_customers LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "11cc41518f6cc8be2f6dde4bcd38d930",
    "patch_cksum": "11cc41518f6cc8be2f6dde4bcd38d930",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query059_multi_i2",
    "patch_id": "syn_w2",
    "iteration": 0,
    "original_sql": "with wss as\n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n and ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 85 * 0.01\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and\n        d_month_seq between 1183 and 1183 + 11\n        and s_state in ('AR','GA','IN'\n                    ,'KS','KY','OH','SD','VA')\n        ) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and\n        d_month_seq between 1183+ 12 and 1183 + 23\n        and s_state in ('AR','GA','IN'\n                    ,'KS','KY','OH','SD','VA')) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\nlimit 100;",
    "patch_sql": "WITH wss AS (SELECT d_week_seq, ss_store_sk, SUM(CASE WHEN (d_day_name = 'Sunday') THEN ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN (d_day_name = 'Monday') THEN ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN (d_day_name = 'Tuesday') THEN ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN (d_day_name = 'Wednesday') THEN ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN (d_day_name = 'Thursday') THEN ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN (d_day_name = 'Friday') THEN ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN (d_day_name = 'Saturday') THEN ss_sales_price ELSE NULL END) AS sat_sales FROM store_sales, date_dim WHERE d_date_sk = ss_sold_date_sk AND ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 85 * 0.01 GROUP BY d_week_seq, ss_store_sk), filtered_wss AS (SELECT d_week_seq, ss_store_sk, s_store_id, s_store_name, SUM(CASE WHEN (d_day_name = 'Sunday') THEN ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN (d_day_name = 'Monday') THEN ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN (d_day_name = 'Tuesday') THEN ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN (d_day_name = 'Wednesday') THEN ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN (d_day_name = 'Thursday') THEN ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN (d_day_name = 'Friday') THEN ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN (d_day_name = 'Saturday') THEN ss_sales_price ELSE NULL END) AS sat_sales FROM store_sales JOIN date_dim ON d_date_sk = ss_sold_date_sk JOIN store ON ss_store_sk = s_store_sk WHERE ss_sales_price / ss_list_price BETWEEN 65 * 0.01 AND 85 * 0.01 AND d_month_seq BETWEEN 1183 AND 1183 + 23 AND s_state IN ('AR', 'GA', 'IN', 'KS', 'KY', 'OH', 'SD', 'VA') GROUP BY d_week_seq, ss_store_sk, s_store_id, s_store_name), y_data AS (SELECT s_store_name AS s_store_name1, d_week_seq AS d_week_seq1, s_store_id AS s_store_id1, sun_sales AS sun_sales1, mon_sales AS mon_sales1, tue_sales AS tue_sales1, wed_sales AS wed_sales1, thu_sales AS thu_sales1, fri_sales AS fri_sales1, sat_sales AS sat_sales1 FROM filtered_wss WHERE d_week_seq BETWEEN 1183 AND 1183 + 11), x_data AS (SELECT s_store_name AS s_store_name2, d_week_seq AS d_week_seq2, s_store_id AS s_store_id2, sun_sales AS sun_sales2, mon_sales AS mon_sales2, tue_sales AS tue_sales2, wed_sales AS wed_sales2, thu_sales AS thu_sales2, fri_sales AS fri_sales2, sat_sales AS sat_sales2 FROM filtered_wss WHERE d_week_seq BETWEEN 1183 + 12 AND 1183 + 23) SELECT s_store_name1, s_store_id1, d_week_seq1, sun_sales1 / sun_sales2, mon_sales1 / mon_sales2, tue_sales1 / tue_sales2, wed_sales1 / wed_sales2, thu_sales1 / thu_sales2, fri_sales1 / fri_sales2, sat_sales1 / sat_sales2 FROM y_data AS y JOIN x_data AS x ON s_store_id1 = s_store_id2 AND d_week_seq1 = d_week_seq2 - 52 ORDER BY s_store_name1, s_store_id1, d_week_seq1 LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 7c530e349b98b85098d614c1538dba72 vs 98d08fb9",
    "gt_semantic_passed": false,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query065_multi_i1",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk,\n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11\n    and ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11\n  and ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and\n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n       and i_manager_id BETWEEN 80 and 84\n       and s_state in ('IA','IL','NC')\n order by s_store_name, i_item_desc\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1195 AND 1195 + 11), base_sales AS (SELECT ss_store_sk, ss_item_sk, ss_sales_price, ss_list_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01), revenue_per_item AS (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM base_sales GROUP BY ss_store_sk, ss_item_sk), avg_revenue_per_store AS (SELECT ss_store_sk, AVG(revenue) AS ave FROM revenue_per_item GROUP BY ss_store_sk) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store, item, revenue_per_item AS sc, avg_revenue_per_store AS sb WHERE sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave AND s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk AND i_manager_id BETWEEN 80 AND 84 AND s_state IN ('IA', 'IL', 'NC') ORDER BY s_store_name, i_item_desc LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query065_multi_i1",
    "patch_id": "t3",
    "iteration": 1,
    "original_sql": "select \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk,\n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11\n    and ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1195 and 1195+11\n  and ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and\n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n       and i_manager_id BETWEEN 80 and 84\n       and s_state in ('IA','IL','NC')\n order by s_store_name, i_item_desc\nlimit 100;",
    "patch_sql": "WITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_state IN ('IA', 'IL', 'NC')), filtered_item AS (SELECT i_item_sk FROM item WHERE i_manager_id BETWEEN 80 AND 84) SELECT s_store_name, i_item_desc, sc.revenue, i_current_price, i_wholesale_cost, i_brand FROM store JOIN item ON s_store_sk = i_item_sk, (SELECT ss_store_sk, AVG(revenue) AS ave FROM (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN filtered_store AS fs ON ss_store_sk = fs.s_store_sk JOIN filtered_item AS fi ON ss_item_sk = fi.i_item_sk WHERE d_month_seq BETWEEN 1195 AND 1195 + 11 AND ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sa GROUP BY ss_store_sk) AS sb JOIN (SELECT ss_store_sk, ss_item_sk, SUM(ss_sales_price) AS revenue FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk JOIN filtered_store AS fs ON ss_store_sk = fs.s_store_sk JOIN filtered_item AS fi ON ss_item_sk = fi.i_item_sk WHERE d_month_seq BETWEEN 1195 AND 1195 + 11 AND ss_sales_price / ss_list_price BETWEEN 38 * 0.01 AND 48 * 0.01 GROUP BY ss_store_sk, ss_item_sk) AS sc ON sb.ss_store_sk = sc.ss_store_sk AND sc.revenue <= 0.1 * sb.ave WHERE s_store_sk = sc.ss_store_sk AND i_item_sk = sc.ss_item_sk ORDER BY s_store_name, i_item_desc LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query069_multi_i2",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('GA','KY','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk\n  and cd_marital_status in ('D', 'W', 'U')\n  and cd_education_status in ('Primary', 'College') and\n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 3 and 3+2\n                and ss_list_price between 52 and 141\n          ) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 3 and 3+2\n                  and ws_list_price between 52 and 141\n            ) and\n    not exists (select *\n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 3 and 3+2\n                  and cs_list_price between 52 and 141)\n            )\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;",
    "patch_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy BETWEEN 3 AND 3 + 2), store_sales_filtered AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE ss_list_price BETWEEN 52 AND 141), web_sales_filtered AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_filter ON ws_sold_date_sk = d_date_sk WHERE ws_list_price BETWEEN 52 AND 141), catalog_sales_filtered AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_filter ON cs_sold_date_sk = d_date_sk WHERE cs_list_price BETWEEN 52 AND 141) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk LEFT JOIN store_sales_filtered AS ssf ON c.c_customer_sk = ssf.ss_customer_sk LEFT JOIN web_sales_filtered AS wsf ON c.c_customer_sk = wsf.ws_bill_customer_sk LEFT JOIN catalog_sales_filtered AS csf ON c.c_customer_sk = csf.cs_ship_customer_sk WHERE ca_state IN ('GA', 'KY', 'SD') AND cd_marital_status IN ('D', 'W', 'U') AND cd_education_status IN ('Primary', 'College') AND NOT ssf.ss_customer_sk IS NULL AND wsf.ws_bill_customer_sk IS NULL AND csf.cs_ship_customer_sk IS NULL GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "c5c74a91763fee0566c6f28e2ee579c8",
    "patch_cksum": "c5c74a91763fee0566c6f28e2ee579c8",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query069_multi_i2",
    "patch_id": "t3",
    "iteration": 1,
    "original_sql": "select \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('GA','KY','SD') and\n  cd_demo_sk = c.c_current_cdemo_sk\n  and cd_marital_status in ('D', 'W', 'U')\n  and cd_education_status in ('Primary', 'College') and\n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_moy between 3 and 3+2\n                and ss_list_price between 52 and 141\n          ) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 3 and 3+2\n                  and ws_list_price between 52 and 141\n            ) and\n    not exists (select *\n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_moy between 3 and 3+2\n                  and cs_list_price between 52 and 141)\n            )\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100;",
    "patch_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy BETWEEN 3 AND 3 + 2) SELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer_address AS ca INNER JOIN customer AS c ON c.c_current_addr_sk = ca.ca_address_sk INNER JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE ca_state IN ('GA', 'KY', 'SD') AND cd_marital_status IN ('D', 'W', 'U') AND cd_education_status IN ('Primary', 'College') AND EXISTS(SELECT * FROM store_sales JOIN date_filter AS df ON ss_sold_date_sk = df.d_date_sk WHERE c.c_customer_sk = ss_customer_sk AND ss_list_price BETWEEN 52 AND 141) AND (NOT EXISTS(SELECT * FROM web_sales JOIN date_filter AS df ON ws_sold_date_sk = df.d_date_sk WHERE c.c_customer_sk = ws_bill_customer_sk AND ws_list_price BETWEEN 52 AND 141) AND NOT EXISTS(SELECT * FROM catalog_sales JOIN date_filter AS df ON cs_sold_date_sk = df.d_date_sk WHERE c.c_customer_sk = cs_ship_customer_sk AND cs_list_price BETWEEN 52 AND 141)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "c5c74a91763fee0566c6f28e2ee579c8",
    "patch_cksum": "c5c74a91763fee0566c6f28e2ee579c8",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query075_multi_i2",
    "patch_id": "t3",
    "iteration": 0,
    "original_sql": "WITH all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number\n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Children'\n       and cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and cr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number\n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Children'\n       and ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and sr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number\n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Children'\n       and ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and wr_reason_sk in (8, 18, 20, 23, 41)) sales_detail\nGROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=1999\n   AND prev_yr.d_year=1999-1\n   AND prev_yr.sales_cnt > 0\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n limit 100;",
    "patch_sql": "WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Children' AND cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND cr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Children' AND ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND sr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Children' AND ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND wr_reason_sk IN (8, 18, 20, 23, 41)) AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id), filtered_items AS (SELECT i_item_sk, i_brand_id, i_class_id, i_category_id, i_manufact_id FROM item WHERE i_category = 'Children') SELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr, all_sales AS prev_yr WHERE curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 1999 AND prev_yr.d_year = 1999 - 1 AND prev_yr.sales_cnt > 0 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query075_multi_i2",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "WITH all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number\n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Children'\n       and cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and cr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number\n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Children'\n       and ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and sr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number\n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Children'\n       and ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and wr_reason_sk in (8, 18, 20, 23, 41)) sales_detail\nGROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=1999\n   AND prev_yr.d_year=1999-1\n   AND prev_yr.sales_cnt > 0\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n limit 100;",
    "patch_sql": "WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Children' AND cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND cr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Children' AND ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND sr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Children' AND ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND wr_reason_sk IN (8, 18, 20, 23, 41)) AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id), all_sales_windowed AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt, sales_amt, LAG(d_year) OVER (PARTITION BY i_brand_id, i_class_id, i_category_id, i_manufact_id ORDER BY d_year) AS prev_d_year, LAG(sales_cnt) OVER (PARTITION BY i_brand_id, i_class_id, i_category_id, i_manufact_id ORDER BY d_year) AS prev_sales_cnt, LAG(sales_amt) OVER (PARTITION BY i_brand_id, i_class_id, i_category_id, i_manufact_id ORDER BY d_year) AS prev_sales_amt FROM all_sales) SELECT d_year - 1 AS prev_year, d_year AS year, i_brand_id, i_class_id, i_category_id, i_manufact_id, prev_sales_cnt AS prev_yr_cnt, sales_cnt AS curr_yr_cnt, sales_cnt - prev_sales_cnt AS sales_cnt_diff, sales_amt - prev_sales_amt AS sales_amt_diff FROM all_sales_windowed WHERE d_year = 1999 AND prev_d_year = 1998 AND prev_sales_cnt > 0 AND CAST(sales_cnt AS DECIMAL(17, 2)) / CAST(prev_sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query075_multi_i2",
    "patch_id": "t3",
    "iteration": 1,
    "original_sql": "WITH all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number\n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Children'\n       and cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and cr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number\n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Children'\n       and ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and sr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number\n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Children'\n       and ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and wr_reason_sk in (8, 18, 20, 23, 41)) sales_detail\nGROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=1999\n   AND prev_yr.d_year=1999-1\n   AND prev_yr.sales_cnt > 0\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n limit 100;",
    "patch_sql": "WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Children' AND cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND cr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Children' AND ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND sr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Children' AND ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND wr_reason_sk IN (8, 18, 20, 23, 41)) AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id), filtered_curr_yr AS (SELECT * FROM all_sales WHERE d_year = 1999), filtered_prev_yr AS (SELECT * FROM all_sales WHERE d_year = 1998) SELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM filtered_curr_yr AS curr_yr INNER JOIN filtered_prev_yr AS prev_yr ON curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id WHERE prev_yr.sales_cnt > 0 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query075_multi_i2",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "WITH all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number\n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Children'\n       and cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and cr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number\n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Children'\n       and ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and sr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number\n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Children'\n       and ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and wr_reason_sk in (8, 18, 20, 23, 41)) sales_detail\nGROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=1999\n   AND prev_yr.d_year=1999-1\n   AND prev_yr.sales_cnt > 0\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n limit 100;",
    "patch_sql": "WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Children' AND cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND cr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Children' AND ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND sr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Children' AND ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND wr_reason_sk IN (8, 18, 20, 23, 41)) AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id), filtered_items AS (SELECT i_item_sk, i_brand_id, i_class_id, i_category_id, i_manufact_id FROM item WHERE i_category = 'Children'), filtered_catalog_returns AS (SELECT cr_item_sk, cr_order_number, cr_return_quantity, cr_return_amount FROM catalog_returns WHERE cr_reason_sk IN (8, 18, 20, 23, 41)), filtered_store_returns AS (SELECT sr_item_sk, sr_ticket_number, sr_return_quantity, sr_return_amt FROM store_returns WHERE sr_reason_sk IN (8, 18, 20, 23, 41)), filtered_web_returns AS (SELECT wr_item_sk, wr_order_number, wr_return_quantity, wr_return_amt FROM web_returns WHERE wr_reason_sk IN (8, 18, 20, 23, 41)) SELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr, all_sales AS prev_yr WHERE curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 1999 AND prev_yr.d_year = 1999 - 1 AND prev_yr.sales_cnt > 0 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query075_multi_i2",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "WITH all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number\n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Children'\n       and cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and cr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number\n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Children'\n       and ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and sr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number\n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Children'\n       and ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and wr_reason_sk in (8, 18, 20, 23, 41)) sales_detail\nGROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=1999\n   AND prev_yr.d_year=1999-1\n   AND prev_yr.sales_cnt > 0\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n limit 100;",
    "patch_sql": "WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Children' AND cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND cr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Children' AND ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND sr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Children' AND ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND wr_reason_sk IN (8, 18, 20, 23, 41)) AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id), filtered_items AS (SELECT i_item_sk, i_brand_id, i_class_id, i_category_id, i_manufact_id FROM item WHERE i_category = 'Children'), filtered_catalog_returns AS (SELECT cr_item_sk, cr_order_number, cr_return_quantity, cr_return_amount FROM catalog_returns WHERE cr_reason_sk IN (8, 18, 20, 23, 41)), filtered_store_returns AS (SELECT sr_item_sk, sr_ticket_number, sr_return_quantity, sr_return_amt FROM store_returns WHERE sr_reason_sk IN (8, 18, 20, 23, 41)), filtered_web_returns AS (SELECT wr_item_sk, wr_order_number, wr_return_quantity, wr_return_amt FROM web_returns WHERE wr_reason_sk IN (8, 18, 20, 23, 41)) SELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr, all_sales AS prev_yr WHERE curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 1999 AND prev_yr.d_year = 1999 - 1 AND prev_yr.sales_cnt > 0 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query075_multi_i2",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "WITH all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number\n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Children'\n       and cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and cr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number\n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Children'\n       and ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and sr_reason_sk in (8, 18, 20, 23, 41)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number\n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Children'\n       and ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01\n       and wr_reason_sk in (8, 18, 20, 23, 41)) sales_detail\nGROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=1999\n   AND prev_yr.d_year=1999-1\n   AND prev_yr.sales_cnt > 0\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n limit 100;",
    "patch_sql": "WITH all_sales AS (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, SUM(sales_cnt) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, cs_quantity - COALESCE(cr_return_quantity, 0) AS sales_cnt, cs_ext_sales_price - COALESCE(cr_return_amount, 0.0) AS sales_amt FROM catalog_sales JOIN item ON i_item_sk = cs_item_sk JOIN date_dim ON d_date_sk = cs_sold_date_sk LEFT JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) WHERE i_category = 'Children' AND cs_sales_price / cs_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND cr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ss_quantity - COALESCE(sr_return_quantity, 0) AS sales_cnt, ss_ext_sales_price - COALESCE(sr_return_amt, 0.0) AS sales_amt FROM store_sales JOIN item ON i_item_sk = ss_item_sk JOIN date_dim ON d_date_sk = ss_sold_date_sk LEFT JOIN store_returns ON (ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk) WHERE i_category = 'Children' AND ss_sales_price / ss_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND sr_reason_sk IN (8, 18, 20, 23, 41) UNION SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, ws_quantity - COALESCE(wr_return_quantity, 0) AS sales_cnt, ws_ext_sales_price - COALESCE(wr_return_amt, 0.0) AS sales_amt FROM web_sales JOIN item ON i_item_sk = ws_item_sk JOIN date_dim ON d_date_sk = ws_sold_date_sk LEFT JOIN web_returns ON (ws_order_number = wr_order_number AND ws_item_sk = wr_item_sk) WHERE i_category = 'Children' AND ws_sales_price / ws_list_price BETWEEN 69 * 0.01 AND 89 * 0.01 AND wr_reason_sk IN (8, 18, 20, 23, 41)) AS sales_detail GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id), filtered_items AS (SELECT i_item_sk, i_brand_id, i_class_id, i_category_id, i_manufact_id FROM item WHERE i_category = 'Children'), filtered_catalog_returns AS (SELECT cr_item_sk, cr_order_number, cr_return_quantity, cr_return_amount FROM catalog_returns WHERE cr_reason_sk IN (8, 18, 20, 23, 41)), filtered_store_returns AS (SELECT sr_item_sk, sr_ticket_number, sr_return_quantity, sr_return_amt FROM store_returns WHERE sr_reason_sk IN (8, 18, 20, 23, 41)), filtered_web_returns AS (SELECT wr_item_sk, wr_order_number, wr_return_quantity, wr_return_amt FROM web_returns WHERE wr_reason_sk IN (8, 18, 20, 23, 41)) SELECT prev_yr.d_year AS prev_year, curr_yr.d_year AS year, curr_yr.i_brand_id, curr_yr.i_class_id, curr_yr.i_category_id, curr_yr.i_manufact_id, prev_yr.sales_cnt AS prev_yr_cnt, curr_yr.sales_cnt AS curr_yr_cnt, curr_yr.sales_cnt - prev_yr.sales_cnt AS sales_cnt_diff, curr_yr.sales_amt - prev_yr.sales_amt AS sales_amt_diff FROM all_sales AS curr_yr, all_sales AS prev_yr WHERE curr_yr.i_brand_id = prev_yr.i_brand_id AND curr_yr.i_class_id = prev_yr.i_class_id AND curr_yr.i_category_id = prev_yr.i_category_id AND curr_yr.i_manufact_id = prev_yr.i_manufact_id AND curr_yr.d_year = 1999 AND prev_yr.d_year = 1999 - 1 AND prev_yr.sales_cnt > 0 AND CAST(curr_yr.sales_cnt AS DECIMAL(17, 2)) / CAST(prev_yr.sales_cnt AS DECIMAL(17, 2)) < 0.9 ORDER BY sales_cnt_diff, sales_amt_diff LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query080_multi_i1",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "with ssr as\n (select  s_store_id as store_id,\n          sum(ss_ext_sales_price) as sales,\n          sum(coalesce(sr_return_amt, 0)) as returns,\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n  from store_sales left outer join store_returns on\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n     date_dim,\n     store,\n     item,\n     promotion\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-29' as date)\n                  and cast('1998-08-29' as date) + interval '30 day'\n       and ss_store_sk = s_store_sk\n       and ss_item_sk = i_item_sk\n       and i_current_price > 50\n       and ss_promo_sk = p_promo_sk\n       and p_channel_email = 'N'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and ss_wholesale_cost BETWEEN 23 AND 38\n       and i_category IN ('Children', 'Sports')\n group by s_store_id)\n ,\n csr as\n (select  cp_catalog_page_id as catalog_page_id,\n          sum(cs_ext_sales_price) as sales,\n          sum(coalesce(cr_return_amount, 0)) as returns,\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n  from catalog_sales left outer join catalog_returns on\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n     date_dim,\n     catalog_page,\n     item,\n     promotion\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-29' as date)\n                  and cast('1998-08-29' as date) + interval '30 day'\n        and cs_catalog_page_sk = cp_catalog_page_sk\n       and cs_item_sk = i_item_sk\n       and i_current_price > 50\n       and cs_promo_sk = p_promo_sk\n       and p_channel_email = 'N'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and cs_wholesale_cost BETWEEN 23 AND 38\n       and i_category IN ('Children', 'Sports')\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select  web_site_id,\n          sum(ws_ext_sales_price) as sales,\n          sum(coalesce(wr_return_amt, 0)) as returns,\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n  from web_sales left outer join web_returns on\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n     date_dim,\n     web_site,\n     item,\n     promotion\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-29' as date)\n                  and cast('1998-08-29' as date) + interval '30 day'\n        and ws_web_site_sk = web_site_sk\n       and ws_item_sk = i_item_sk\n       and i_current_price > 50\n       and ws_promo_sk = p_promo_sk\n       and p_channel_email = 'N'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and ws_wholesale_cost BETWEEN 23 AND 38\n       and i_category IN ('Children', 'Sports')\ngroup by web_site_id)\n  select  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from\n (select 'store channel' as channel\n        , 'store' || store_id as id\n        , sales\n        , returns\n        , profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || catalog_page_id as id\n        , sales\n        , returns\n        , profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , profit\n from   wsr\n ) x\n group by rollup (channel, id)\n order by channel\n         ,id\n limit 100;",
    "patch_sql": "WITH ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number), date_dim, store, item, promotion WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1998-08-29' AS DATE) AND CAST('1998-08-29' AS DATE) + INTERVAL '30 DAY' AND ss_store_sk = s_store_sk AND ss_item_sk = i_item_sk AND i_current_price > 50 AND ss_promo_sk = p_promo_sk AND p_channel_email = 'N' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ss_wholesale_cost BETWEEN 23 AND 38 AND i_category IN ('Children', 'Sports') GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number), date_dim, catalog_page, item, promotion WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1998-08-29' AS DATE) AND CAST('1998-08-29' AS DATE) + INTERVAL '30 DAY' AND cs_catalog_page_sk = cp_catalog_page_sk AND cs_item_sk = i_item_sk AND i_current_price > 50 AND cs_promo_sk = p_promo_sk AND p_channel_email = 'N' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND cs_wholesale_cost BETWEEN 23 AND 38 AND i_category IN ('Children', 'Sports') GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number), date_dim, web_site, item, promotion WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1998-08-29' AS DATE) AND CAST('1998-08-29' AS DATE) + INTERVAL '30 DAY' AND ws_web_site_sk = web_site_sk AND ws_item_sk = i_item_sk AND i_current_price > 50 AND ws_promo_sk = p_promo_sk AND p_channel_email = 'N' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ws_wholesale_cost BETWEEN 23 AND 38 AND i_category IN ('Children', 'Sports') GROUP BY web_site_id), filtered_item AS (SELECT i_item_sk FROM item WHERE i_current_price > 50 AND i_category IN ('Children', 'Sports')), filtered_promo AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'N' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N'), ssr_preagg AS (SELECT ss_store_sk, ss_item_sk, ss_ticket_number, ss_promo_sk, ss_wholesale_cost, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) JOIN filtered_item ON ss_item_sk = i_item_sk JOIN filtered_promo ON ss_promo_sk = p_promo_sk WHERE ss_wholesale_cost BETWEEN 23 AND 38 GROUP BY ss_store_sk, ss_item_sk, ss_ticket_number, ss_promo_sk, ss_wholesale_cost) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query080_multi_i1",
    "patch_id": "t2",
    "iteration": 2,
    "original_sql": "with ssr as\n (select  s_store_id as store_id,\n          sum(ss_ext_sales_price) as sales,\n          sum(coalesce(sr_return_amt, 0)) as returns,\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n  from store_sales left outer join store_returns on\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n     date_dim,\n     store,\n     item,\n     promotion\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-29' as date)\n                  and cast('1998-08-29' as date) + interval '30 day'\n       and ss_store_sk = s_store_sk\n       and ss_item_sk = i_item_sk\n       and i_current_price > 50\n       and ss_promo_sk = p_promo_sk\n       and p_channel_email = 'N'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and ss_wholesale_cost BETWEEN 23 AND 38\n       and i_category IN ('Children', 'Sports')\n group by s_store_id)\n ,\n csr as\n (select  cp_catalog_page_id as catalog_page_id,\n          sum(cs_ext_sales_price) as sales,\n          sum(coalesce(cr_return_amount, 0)) as returns,\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n  from catalog_sales left outer join catalog_returns on\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n     date_dim,\n     catalog_page,\n     item,\n     promotion\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-29' as date)\n                  and cast('1998-08-29' as date) + interval '30 day'\n        and cs_catalog_page_sk = cp_catalog_page_sk\n       and cs_item_sk = i_item_sk\n       and i_current_price > 50\n       and cs_promo_sk = p_promo_sk\n       and p_channel_email = 'N'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and cs_wholesale_cost BETWEEN 23 AND 38\n       and i_category IN ('Children', 'Sports')\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select  web_site_id,\n          sum(ws_ext_sales_price) as sales,\n          sum(coalesce(wr_return_amt, 0)) as returns,\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n  from web_sales left outer join web_returns on\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n     date_dim,\n     web_site,\n     item,\n     promotion\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('1998-08-29' as date)\n                  and cast('1998-08-29' as date) + interval '30 day'\n        and ws_web_site_sk = web_site_sk\n       and ws_item_sk = i_item_sk\n       and i_current_price > 50\n       and ws_promo_sk = p_promo_sk\n       and p_channel_email = 'N'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and ws_wholesale_cost BETWEEN 23 AND 38\n       and i_category IN ('Children', 'Sports')\ngroup by web_site_id)\n  select  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from\n (select 'store channel' as channel\n        , 'store' || store_id as id\n        , sales\n        , returns\n        , profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || catalog_page_id as id\n        , sales\n        , returns\n        , profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , profit\n from   wsr\n ) x\n group by rollup (channel, id)\n order by channel\n         ,id\n limit 100;",
    "patch_sql": "WITH ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number), date_dim, store, item, promotion WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1998-08-29' AS DATE) AND CAST('1998-08-29' AS DATE) + INTERVAL '30 DAY' AND ss_store_sk = s_store_sk AND ss_item_sk = i_item_sk AND i_current_price > 50 AND ss_promo_sk = p_promo_sk AND p_channel_email = 'N' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ss_wholesale_cost BETWEEN 23 AND 38 AND i_category IN ('Children', 'Sports') GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number), date_dim, catalog_page, item, promotion WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1998-08-29' AS DATE) AND CAST('1998-08-29' AS DATE) + INTERVAL '30 DAY' AND cs_catalog_page_sk = cp_catalog_page_sk AND cs_item_sk = i_item_sk AND i_current_price > 50 AND cs_promo_sk = p_promo_sk AND p_channel_email = 'N' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND cs_wholesale_cost BETWEEN 23 AND 38 AND i_category IN ('Children', 'Sports') GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number), date_dim, web_site, item, promotion WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1998-08-29' AS DATE) AND CAST('1998-08-29' AS DATE) + INTERVAL '30 DAY' AND ws_web_site_sk = web_site_sk AND ws_item_sk = i_item_sk AND i_current_price > 50 AND ws_promo_sk = p_promo_sk AND p_channel_email = 'N' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ws_wholesale_cost BETWEEN 23 AND 38 AND i_category IN ('Children', 'Sports') GROUP BY web_site_id), filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('1998-08-29' AS DATE) AND CAST('1998-08-29' AS DATE) + INTERVAL '30 DAY'), filtered_items AS (SELECT i_item_sk FROM item WHERE i_current_price > 50 AND i_category IN ('Children', 'Sports')), filtered_promos AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'N' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N') SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query080_multi_i2",
    "patch_id": "t3",
    "iteration": 0,
    "original_sql": "with ssr as\n (select  s_store_id as store_id,\n          sum(ss_ext_sales_price) as sales,\n          sum(coalesce(sr_return_amt, 0)) as returns,\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n  from store_sales left outer join store_returns on\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n     date_dim,\n     store,\n     item,\n     promotion\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('1999-10-21' as date)\n                  and cast('1999-10-21' as date) + interval '30 day'\n       and ss_store_sk = s_store_sk\n       and ss_item_sk = i_item_sk\n       and i_current_price > 50\n       and ss_promo_sk = p_promo_sk\n       and p_channel_email = 'Y'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and ss_wholesale_cost BETWEEN 21 AND 36\n       and i_category IN ('Men', 'Music')\n group by s_store_id)\n ,\n csr as\n (select  cp_catalog_page_id as catalog_page_id,\n          sum(cs_ext_sales_price) as sales,\n          sum(coalesce(cr_return_amount, 0)) as returns,\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n  from catalog_sales left outer join catalog_returns on\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n     date_dim,\n     catalog_page,\n     item,\n     promotion\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('1999-10-21' as date)\n                  and cast('1999-10-21' as date) + interval '30 day'\n        and cs_catalog_page_sk = cp_catalog_page_sk\n       and cs_item_sk = i_item_sk\n       and i_current_price > 50\n       and cs_promo_sk = p_promo_sk\n       and p_channel_email = 'Y'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and cs_wholesale_cost BETWEEN 21 AND 36\n       and i_category IN ('Men', 'Music')\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select  web_site_id,\n          sum(ws_ext_sales_price) as sales,\n          sum(coalesce(wr_return_amt, 0)) as returns,\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n  from web_sales left outer join web_returns on\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n     date_dim,\n     web_site,\n     item,\n     promotion\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('1999-10-21' as date)\n                  and cast('1999-10-21' as date) + interval '30 day'\n        and ws_web_site_sk = web_site_sk\n       and ws_item_sk = i_item_sk\n       and i_current_price > 50\n       and ws_promo_sk = p_promo_sk\n       and p_channel_email = 'Y'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and ws_wholesale_cost BETWEEN 21 AND 36\n       and i_category IN ('Men', 'Music')\ngroup by web_site_id)\n  select  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from\n (select 'store channel' as channel\n        , 'store' || store_id as id\n        , sales\n        , returns\n        , profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || catalog_page_id as id\n        , sales\n        , returns\n        , profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , profit\n from   wsr\n ) x\n group by rollup (channel, id)\n order by channel\n         ,id\n limit 100;",
    "patch_sql": "WITH ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number), date_dim, store, item, promotion WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY' AND ss_store_sk = s_store_sk AND ss_item_sk = i_item_sk AND i_current_price > 50 AND ss_promo_sk = p_promo_sk AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ss_wholesale_cost BETWEEN 21 AND 36 AND i_category IN ('Men', 'Music') GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number), date_dim, catalog_page, item, promotion WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY' AND cs_catalog_page_sk = cp_catalog_page_sk AND cs_item_sk = i_item_sk AND i_current_price > 50 AND cs_promo_sk = p_promo_sk AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND cs_wholesale_cost BETWEEN 21 AND 36 AND i_category IN ('Men', 'Music') GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number), date_dim, web_site, item, promotion WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY' AND ws_web_site_sk = web_site_sk AND ws_item_sk = i_item_sk AND i_current_price > 50 AND ws_promo_sk = p_promo_sk AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ws_wholesale_cost BETWEEN 21 AND 36 AND i_category IN ('Men', 'Music') GROUP BY web_site_id), agg_store_returns AS (SELECT sr_item_sk, sr_ticket_number, SUM(sr_return_amt) AS return_amt, SUM(sr_net_loss) AS net_loss FROM store_returns GROUP BY sr_item_sk, sr_ticket_number), agg_catalog_returns AS (SELECT cr_item_sk, cr_order_number, SUM(cr_return_amount) AS return_amt, SUM(cr_net_loss) AS net_loss FROM catalog_returns GROUP BY cr_item_sk, cr_order_number), agg_web_returns AS (SELECT wr_item_sk, wr_order_number, SUM(wr_return_amt) AS return_amt, SUM(wr_net_loss) AS net_loss FROM web_returns GROUP BY wr_item_sk, wr_order_number) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query080_multi_i2",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "with ssr as\n (select  s_store_id as store_id,\n          sum(ss_ext_sales_price) as sales,\n          sum(coalesce(sr_return_amt, 0)) as returns,\n          sum(ss_net_profit - coalesce(sr_net_loss, 0)) as profit\n  from store_sales left outer join store_returns on\n         (ss_item_sk = sr_item_sk and ss_ticket_number = sr_ticket_number),\n     date_dim,\n     store,\n     item,\n     promotion\n where ss_sold_date_sk = d_date_sk\n       and d_date between cast('1999-10-21' as date)\n                  and cast('1999-10-21' as date) + interval '30 day'\n       and ss_store_sk = s_store_sk\n       and ss_item_sk = i_item_sk\n       and i_current_price > 50\n       and ss_promo_sk = p_promo_sk\n       and p_channel_email = 'Y'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and ss_wholesale_cost BETWEEN 21 AND 36\n       and i_category IN ('Men', 'Music')\n group by s_store_id)\n ,\n csr as\n (select  cp_catalog_page_id as catalog_page_id,\n          sum(cs_ext_sales_price) as sales,\n          sum(coalesce(cr_return_amount, 0)) as returns,\n          sum(cs_net_profit - coalesce(cr_net_loss, 0)) as profit\n  from catalog_sales left outer join catalog_returns on\n         (cs_item_sk = cr_item_sk and cs_order_number = cr_order_number),\n     date_dim,\n     catalog_page,\n     item,\n     promotion\n where cs_sold_date_sk = d_date_sk\n       and d_date between cast('1999-10-21' as date)\n                  and cast('1999-10-21' as date) + interval '30 day'\n        and cs_catalog_page_sk = cp_catalog_page_sk\n       and cs_item_sk = i_item_sk\n       and i_current_price > 50\n       and cs_promo_sk = p_promo_sk\n       and p_channel_email = 'Y'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and cs_wholesale_cost BETWEEN 21 AND 36\n       and i_category IN ('Men', 'Music')\ngroup by cp_catalog_page_id)\n ,\n wsr as\n (select  web_site_id,\n          sum(ws_ext_sales_price) as sales,\n          sum(coalesce(wr_return_amt, 0)) as returns,\n          sum(ws_net_profit - coalesce(wr_net_loss, 0)) as profit\n  from web_sales left outer join web_returns on\n         (ws_item_sk = wr_item_sk and ws_order_number = wr_order_number),\n     date_dim,\n     web_site,\n     item,\n     promotion\n where ws_sold_date_sk = d_date_sk\n       and d_date between cast('1999-10-21' as date)\n                  and cast('1999-10-21' as date) + interval '30 day'\n        and ws_web_site_sk = web_site_sk\n       and ws_item_sk = i_item_sk\n       and i_current_price > 50\n       and ws_promo_sk = p_promo_sk\n       and p_channel_email = 'Y'\n       and p_channel_tv = 'N'\n       and p_channel_radio = 'N'\n       and p_channel_press = 'N'\n       and p_channel_event = 'N'\n       and ws_wholesale_cost BETWEEN 21 AND 36\n       and i_category IN ('Men', 'Music')\ngroup by web_site_id)\n  select  channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from\n (select 'store channel' as channel\n        , 'store' || store_id as id\n        , sales\n        , returns\n        , profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || catalog_page_id as id\n        , sales\n        , returns\n        , profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , profit\n from   wsr\n ) x\n group by rollup (channel, id)\n order by channel\n         ,id\n limit 100;",
    "patch_sql": "WITH ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number), date_dim, store, item, promotion WHERE ss_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY' AND ss_store_sk = s_store_sk AND ss_item_sk = i_item_sk AND i_current_price > 50 AND ss_promo_sk = p_promo_sk AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ss_wholesale_cost BETWEEN 21 AND 36 AND i_category IN ('Men', 'Music') GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number), date_dim, catalog_page, item, promotion WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY' AND cs_catalog_page_sk = cp_catalog_page_sk AND cs_item_sk = i_item_sk AND i_current_price > 50 AND cs_promo_sk = p_promo_sk AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND cs_wholesale_cost BETWEEN 21 AND 36 AND i_category IN ('Men', 'Music') GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number), date_dim, web_site, item, promotion WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY' AND ws_web_site_sk = web_site_sk AND ws_item_sk = i_item_sk AND i_current_price > 50 AND ws_promo_sk = p_promo_sk AND p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N' AND ws_wholesale_cost BETWEEN 21 AND 36 AND i_category IN ('Men', 'Music') GROUP BY web_site_id), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-10-21' AS DATE) AND CAST('1999-10-21' AS DATE) + INTERVAL '30 DAY'), filtered_promos AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'Y' AND p_channel_tv = 'N' AND p_channel_radio = 'N' AND p_channel_press = 'N' AND p_channel_event = 'N'), filtered_items AS (SELECT i_item_sk FROM item WHERE i_current_price > 50 AND i_category IN ('Men', 'Music')), ssr_preagg AS (SELECT ss_store_sk, ss_item_sk, ss_promo_sk, ss_ticket_number, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM filtered_dates) AND ss_item_sk IN (SELECT i_item_sk FROM filtered_items) AND ss_promo_sk IN (SELECT p_promo_sk FROM filtered_promos) AND ss_wholesale_cost BETWEEN 21 AND 36 GROUP BY ss_store_sk, ss_item_sk, ss_promo_sk, ss_ticket_number) SELECT channel, id, SUM(sales) AS sales, SUM(returns) AS returns, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, 'store' || store_id AS id, sales, returns, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, 'catalog_page' || catalog_page_id AS id, sales, returns, profit FROM csr UNION ALL SELECT 'web channel' AS channel, 'web_site' || web_site_id AS id, sales, returns, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel, id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": null,
    "patch_cksum": null,
    "orig_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "patch_err": "'<' not supported between instances of 'NoneType' and 'str'",
    "witness_verdict": "ORIG_ERROR"
  },
  {
    "query_id": "query081_multi_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'IA'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n limit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT cr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, SUM(cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns, date_dim, customer_address WHERE cr_returned_date_sk = d_date_sk AND d_year = 2000 AND cr_returning_addr_sk = ca_address_sk GROUP BY cr_returning_customer_sk, ca_state), state_avg AS (SELECT ctr_state, AVG(ctr_total_return) AS avg_return FROM customer_total_return GROUP BY ctr_state) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return FROM customer_total_return AS ctr1 INNER JOIN state_avg AS sa ON ctr1.ctr_state = sa.ctr_state, customer_address, customer WHERE ctr1.ctr_total_return > sa.avg_return * 1.2 AND ca_address_sk = c_current_addr_sk AND ca_state = 'IA' AND ctr1.ctr_customer_sk = c_customer_sk ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "PENDING",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query081_multi_i1",
    "patch_id": "syn_w1",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'IA'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n limit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT cr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, SUM(cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns, date_dim, customer_address WHERE cr_returned_date_sk = d_date_sk AND d_year = 2000 AND cr_returning_addr_sk = ca_address_sk GROUP BY cr_returning_customer_sk, ca_state), state_avg AS (SELECT ctr_state, AVG(ctr_total_return) AS avg_return FROM customer_total_return GROUP BY ctr_state) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return FROM customer_total_return AS ctr1 INNER JOIN state_avg AS sa ON ctr1.ctr_state = sa.ctr_state, customer_address, customer WHERE ctr1.ctr_total_return > sa.avg_return * 1.2 AND ca_address_sk = c_current_addr_sk AND ca_state = 'IA' AND ctr1.ctr_customer_sk = c_customer_sk ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "PENDING",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query081_multi_i1",
    "patch_id": "syn_w2",
    "iteration": 0,
    "original_sql": "with customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'IA'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n limit 100;",
    "patch_sql": "WITH customer_total_return AS (SELECT cr_returning_customer_sk AS ctr_customer_sk, ca_state AS ctr_state, SUM(cr_return_amt_inc_tax) AS ctr_total_return FROM catalog_returns, date_dim, customer_address WHERE cr_returned_date_sk = d_date_sk AND d_year = 2000 AND cr_returning_addr_sk = ca_address_sk GROUP BY cr_returning_customer_sk, ca_state), state_avg AS (SELECT ctr_state, AVG(ctr_total_return) AS avg_return FROM customer_total_return GROUP BY ctr_state) SELECT c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return FROM customer_total_return AS ctr1 INNER JOIN state_avg AS sa ON ctr1.ctr_state = sa.ctr_state, customer_address, customer WHERE ctr1.ctr_total_return > sa.avg_return * 1.2 AND ca_address_sk = c_current_addr_sk AND ca_state = 'IA' AND ctr1.ctr_customer_sk = c_customer_sk ORDER BY c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "PENDING",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 0,
    "patch_rows": 0,
    "orig_cksum": "empty",
    "patch_cksum": "empty",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "ZERO_ROWS"
  },
  {
    "query_id": "query083_multi_i1",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "with sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n\twhere d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  where d_date in ('2002-02-26','2002-05-03','2002-08-19','2002-11-18')))\n and   sr_returned_date_sk   = d_date_sk\n and i_category IN ('Home', 'Men')\n and i_manager_id BETWEEN 8 and 17\n and sr_return_amt / sr_return_quantity between 237 and 266\n and sr_reason_sk in (6, 7, 25, 45, 51)\ngroup by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  \t  where d_date in ('2002-02-26','2002-05-03','2002-08-19','2002-11-18')))\n and   cr_returned_date_sk   = d_date_sk\n and i_category IN ('Home', 'Men')\n and i_manager_id BETWEEN 8 and 17\n and cr_return_amount / cr_return_quantity between 237 and 266\n and cr_reason_sk in (6, 7, 25, 45, 51)\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t\t\t  where d_date in ('2002-02-26','2002-05-03','2002-08-19','2002-11-18')))\n and   wr_returned_date_sk   = d_date_sk\n and i_category IN ('Home', 'Men')\n and i_manager_id BETWEEN 8 and 17\n and wr_return_amt / wr_return_quantity between 237 and 266\n and wr_reason_sk in (6, 7, 25, 45, 51)\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id\n order by sr_items.item_id\n         ,sr_item_qty\n limit 100;",
    "patch_sql": "WITH date_filter AS (SELECT d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('2002-02-26', '2002-05-03', '2002-08-19', '2002-11-18'))), sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns, item, date_dim WHERE sr_item_sk = i_item_sk AND sr_returned_date_sk = d_date_sk AND d_date IN (SELECT d_date FROM date_filter) AND i_category IN ('Home', 'Men') AND i_manager_id BETWEEN 8 AND 17 AND sr_return_amt / sr_return_quantity BETWEEN 237 AND 266 AND sr_reason_sk IN (6, 7, 25, 45, 51) GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns, item, date_dim WHERE cr_item_sk = i_item_sk AND cr_returned_date_sk = d_date_sk AND d_date IN (SELECT d_date FROM date_filter) AND i_category IN ('Home', 'Men') AND i_manager_id BETWEEN 8 AND 17 AND cr_return_amount / cr_return_quantity BETWEEN 237 AND 266 AND cr_reason_sk IN (6, 7, 25, 45, 51) GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns, item, date_dim WHERE wr_item_sk = i_item_sk AND wr_returned_date_sk = d_date_sk AND d_date IN (SELECT d_date FROM date_filter) AND i_category IN ('Home', 'Men') AND i_manager_id BETWEEN 8 AND 17 AND wr_return_amt / wr_return_quantity BETWEEN 237 AND 266 AND wr_reason_sk IN (6, 7, 25, 45, 51) GROUP BY i_item_id) SELECT sr_items.item_id, sr_item_qty, sr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS sr_dev, cr_item_qty, cr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS cr_dev, wr_item_qty, wr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM sr_items, cr_items, wr_items WHERE sr_items.item_id = cr_items.item_id AND sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id, sr_item_qty LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "29a5b39fd0814d0d28a3987368f78dd1",
    "patch_cksum": "29a5b39fd0814d0d28a3987368f78dd1",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query083_multi_i1",
    "patch_id": "t3",
    "iteration": 2,
    "original_sql": "with sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n\twhere d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  where d_date in ('2002-02-26','2002-05-03','2002-08-19','2002-11-18')))\n and   sr_returned_date_sk   = d_date_sk\n and i_category IN ('Home', 'Men')\n and i_manager_id BETWEEN 8 and 17\n and sr_return_amt / sr_return_quantity between 237 and 266\n and sr_reason_sk in (6, 7, 25, 45, 51)\ngroup by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  \t  where d_date in ('2002-02-26','2002-05-03','2002-08-19','2002-11-18')))\n and   cr_returned_date_sk   = d_date_sk\n and i_category IN ('Home', 'Men')\n and i_manager_id BETWEEN 8 and 17\n and cr_return_amount / cr_return_quantity between 237 and 266\n and cr_reason_sk in (6, 7, 25, 45, 51)\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t\t\t  where d_date in ('2002-02-26','2002-05-03','2002-08-19','2002-11-18')))\n and   wr_returned_date_sk   = d_date_sk\n and i_category IN ('Home', 'Men')\n and i_manager_id BETWEEN 8 and 17\n and wr_return_amt / wr_return_quantity between 237 and 266\n and wr_reason_sk in (6, 7, 25, 45, 51)\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id\n order by sr_items.item_id\n         ,sr_item_qty\n limit 100;",
    "patch_sql": "WITH target_dates AS (SELECT DISTINCT d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('2002-02-26', '2002-05-03', '2002-08-19', '2002-11-18'))), sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns, item, date_dim WHERE sr_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM target_dates) AND sr_returned_date_sk = d_date_sk AND i_category IN ('Home', 'Men') AND i_manager_id BETWEEN 8 AND 17 AND sr_return_amt / sr_return_quantity BETWEEN 237 AND 266 AND sr_reason_sk IN (6, 7, 25, 45, 51) GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns, item, date_dim WHERE cr_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM target_dates) AND cr_returned_date_sk = d_date_sk AND i_category IN ('Home', 'Men') AND i_manager_id BETWEEN 8 AND 17 AND cr_return_amount / cr_return_quantity BETWEEN 237 AND 266 AND cr_reason_sk IN (6, 7, 25, 45, 51) GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns, item, date_dim WHERE wr_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM target_dates) AND wr_returned_date_sk = d_date_sk AND i_category IN ('Home', 'Men') AND i_manager_id BETWEEN 8 AND 17 AND wr_return_amt / wr_return_quantity BETWEEN 237 AND 266 AND wr_reason_sk IN (6, 7, 25, 45, 51) GROUP BY i_item_id) SELECT sr_items.item_id, sr_item_qty, sr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS sr_dev, cr_item_qty, cr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS cr_dev, wr_item_qty, wr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM sr_items, cr_items, wr_items WHERE sr_items.item_id = cr_items.item_id AND sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id, sr_item_qty LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "29a5b39fd0814d0d28a3987368f78dd1",
    "patch_cksum": "29a5b39fd0814d0d28a3987368f78dd1",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query083_multi_i2",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "with sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n\twhere d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  where d_date in ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')))\n and   sr_returned_date_sk   = d_date_sk\n and i_category IN ('Children', 'Electronics')\n and i_manager_id BETWEEN 15 and 24\n and sr_return_amt / sr_return_quantity between 253 and 282\n and sr_reason_sk in (7, 18, 19, 22, 36)\ngroup by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  \t  where d_date in ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')))\n and   cr_returned_date_sk   = d_date_sk\n and i_category IN ('Children', 'Electronics')\n and i_manager_id BETWEEN 15 and 24\n and cr_return_amount / cr_return_quantity between 253 and 282\n and cr_reason_sk in (7, 18, 19, 22, 36)\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t\t\t  where d_date in ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')))\n and   wr_returned_date_sk   = d_date_sk\n and i_category IN ('Children', 'Electronics')\n and i_manager_id BETWEEN 15 and 24\n and wr_return_amt / wr_return_quantity between 253 and 282\n and wr_reason_sk in (7, 18, 19, 22, 36)\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id\n order by sr_items.item_id\n         ,sr_item_qty\n limit 100;",
    "patch_sql": "WITH sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns, item, date_dim WHERE sr_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05'))) AND sr_returned_date_sk = d_date_sk AND i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24 AND sr_return_amt / sr_return_quantity BETWEEN 253 AND 282 AND sr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns, item, date_dim WHERE cr_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05'))) AND cr_returned_date_sk = d_date_sk AND i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24 AND cr_return_amount / cr_return_quantity BETWEEN 253 AND 282 AND cr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns, item, date_dim WHERE wr_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05'))) AND wr_returned_date_sk = d_date_sk AND i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24 AND wr_return_amt / wr_return_quantity BETWEEN 253 AND 282 AND wr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY i_item_id), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24) SELECT sr_items.item_id, sr_item_qty, sr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS sr_dev, cr_item_qty, cr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS cr_dev, wr_item_qty, wr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM (SELECT fi.i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns, filtered_items AS fi, date_dim WHERE sr_item_sk = fi.i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05'))) AND sr_returned_date_sk = d_date_sk AND sr_return_amt / sr_return_quantity BETWEEN 253 AND 282 AND sr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY fi.i_item_id) AS sr_items, (SELECT fi.i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns, filtered_items AS fi, date_dim WHERE cr_item_sk = fi.i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05'))) AND cr_returned_date_sk = d_date_sk AND cr_return_amount / cr_return_quantity BETWEEN 253 AND 282 AND cr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY fi.i_item_id) AS cr_items, (SELECT fi.i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns, filtered_items AS fi, date_dim WHERE wr_item_sk = fi.i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05'))) AND wr_returned_date_sk = d_date_sk AND wr_return_amt / wr_return_quantity BETWEEN 253 AND 282 AND wr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY fi.i_item_id) AS wr_items WHERE sr_items.item_id = cr_items.item_id AND sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id, sr_item_qty LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "03c0446966ce6e693d12a88f158e268d",
    "patch_cksum": "03c0446966ce6e693d12a88f158e268d",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query083_multi_i2",
    "patch_id": "t3",
    "iteration": 0,
    "original_sql": "with sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n\twhere d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  where d_date in ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')))\n and   sr_returned_date_sk   = d_date_sk\n and i_category IN ('Children', 'Electronics')\n and i_manager_id BETWEEN 15 and 24\n and sr_return_amt / sr_return_quantity between 253 and 282\n and sr_reason_sk in (7, 18, 19, 22, 36)\ngroup by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  \t  where d_date in ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')))\n and   cr_returned_date_sk   = d_date_sk\n and i_category IN ('Children', 'Electronics')\n and i_manager_id BETWEEN 15 and 24\n and cr_return_amount / cr_return_quantity between 253 and 282\n and cr_reason_sk in (7, 18, 19, 22, 36)\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t\t\t  where d_date in ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')))\n and   wr_returned_date_sk   = d_date_sk\n and i_category IN ('Children', 'Electronics')\n and i_manager_id BETWEEN 15 and 24\n and wr_return_amt / wr_return_quantity between 253 and 282\n and wr_reason_sk in (7, 18, 19, 22, 36)\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id\n order by sr_items.item_id\n         ,sr_item_qty\n limit 100;",
    "patch_sql": "WITH date_subquery_cte AS (SELECT d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05'))), sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns INNER JOIN item ON sr_item_sk = i_item_sk INNER JOIN date_dim ON sr_returned_date_sk = d_date_sk WHERE d_date IN (SELECT d_date FROM date_subquery_cte) AND i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24 AND sr_return_amt / sr_return_quantity BETWEEN 253 AND 282 AND sr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns INNER JOIN item ON cr_item_sk = i_item_sk INNER JOIN date_dim ON cr_returned_date_sk = d_date_sk WHERE d_date IN (SELECT d_date FROM date_subquery_cte) AND i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24 AND cr_return_amount / cr_return_quantity BETWEEN 253 AND 282 AND cr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns INNER JOIN item ON wr_item_sk = i_item_sk INNER JOIN date_dim ON wr_returned_date_sk = d_date_sk WHERE d_date IN (SELECT d_date FROM date_subquery_cte) AND i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24 AND wr_return_amt / wr_return_quantity BETWEEN 253 AND 282 AND wr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY i_item_id) SELECT sr_items.item_id, sr_item_qty, sr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS sr_dev, cr_item_qty, cr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS cr_dev, wr_item_qty, wr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM sr_items INNER JOIN cr_items ON sr_items.item_id = cr_items.item_id INNER JOIN wr_items ON sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id, sr_item_qty LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "03c0446966ce6e693d12a88f158e268d",
    "patch_cksum": "03c0446966ce6e693d12a88f158e268d",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query083_multi_i2",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "with sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n\twhere d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  where d_date in ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')))\n and   sr_returned_date_sk   = d_date_sk\n and i_category IN ('Children', 'Electronics')\n and i_manager_id BETWEEN 15 and 24\n and sr_return_amt / sr_return_quantity between 253 and 282\n and sr_reason_sk in (7, 18, 19, 22, 36)\ngroup by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t  \t  where d_date in ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')))\n and   cr_returned_date_sk   = d_date_sk\n and i_category IN ('Children', 'Electronics')\n and i_manager_id BETWEEN 15 and 24\n and cr_return_amount / cr_return_quantity between 253 and 282\n and cr_reason_sk in (7, 18, 19, 22, 36)\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in\n\t(select d_date\n\tfrom date_dim\n  where d_month_seq in\n\t\t(select d_month_seq\n\t\tfrom date_dim\n\t\t\t  where d_date in ('1999-01-10','1999-06-17','1999-08-04','1999-11-05')))\n and   wr_returned_date_sk   = d_date_sk\n and i_category IN ('Children', 'Electronics')\n and i_manager_id BETWEEN 15 and 24\n and wr_return_amt / wr_return_quantity between 253 and 282\n and wr_reason_sk in (7, 18, 19, 22, 36)\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id\n order by sr_items.item_id\n         ,sr_item_qty\n limit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq IN (SELECT d_month_seq FROM date_dim WHERE d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05'))), sr_items AS (SELECT i_item_id AS item_id, SUM(sr_return_quantity) AS sr_item_qty FROM store_returns JOIN item ON sr_item_sk = i_item_sk JOIN filtered_dates ON sr_returned_date_sk = d_date_sk WHERE i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24 AND sr_return_amt / sr_return_quantity BETWEEN 253 AND 282 AND sr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY i_item_id), cr_items AS (SELECT i_item_id AS item_id, SUM(cr_return_quantity) AS cr_item_qty FROM catalog_returns JOIN item ON cr_item_sk = i_item_sk JOIN filtered_dates ON cr_returned_date_sk = d_date_sk WHERE i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24 AND cr_return_amount / cr_return_quantity BETWEEN 253 AND 282 AND cr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY i_item_id), wr_items AS (SELECT i_item_id AS item_id, SUM(wr_return_quantity) AS wr_item_qty FROM web_returns JOIN item ON wr_item_sk = i_item_sk JOIN filtered_dates ON wr_returned_date_sk = d_date_sk WHERE i_category IN ('Children', 'Electronics') AND i_manager_id BETWEEN 15 AND 24 AND wr_return_amt / wr_return_quantity BETWEEN 253 AND 282 AND wr_reason_sk IN (7, 18, 19, 22, 36) GROUP BY i_item_id) SELECT sr_items.item_id, sr_item_qty, sr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS sr_dev, cr_item_qty, cr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS cr_dev, wr_item_qty, wr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS wr_dev, (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average FROM sr_items, cr_items, wr_items WHERE sr_items.item_id = cr_items.item_id AND sr_items.item_id = wr_items.item_id ORDER BY sr_items.item_id, sr_item_qty LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "03c0446966ce6e693d12a88f158e268d",
    "patch_cksum": "03c0446966ce6e693d12a88f158e268d",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query084_agg_i1",
    "patch_id": "t2",
    "iteration": 2,
    "original_sql": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from customer\n     ,customer_address\n     ,customer_demographics\n     ,household_demographics\n     ,income_band\n     ,store_returns\n where ca_city\t        =  'Jackson'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  23567\n   and ib_upper_bound   <=  23567 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n limit 100;",
    "patch_sql": "WITH filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Jackson'), filtered_income_band AS (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 23567 AND ib_upper_bound <= 23567 + 50000), aggregated_store_returns AS (SELECT sr_cdemo_sk FROM store_returns GROUP BY sr_cdemo_sk) SELECT c_customer_id AS customer_id, COALESCE(c_last_name, '') || ', ' || COALESCE(c_first_name, '') AS customername FROM customer JOIN filtered_customer_address ON c_current_addr_sk = ca_address_sk JOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk JOIN filtered_income_band ON hd_income_band_sk = ib_income_band_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN aggregated_store_returns ON sr_cdemo_sk = cd_demo_sk WHERE TRUE ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): row count 19 vs 100",
    "gt_semantic_passed": false,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "c574ae56b925741e33dc3446cc426666",
    "patch_cksum": "c574ae56b925741e33dc3446cc426666",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query084_agg_i1",
    "patch_id": "t4",
    "iteration": 2,
    "original_sql": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from customer\n     ,customer_address\n     ,customer_demographics\n     ,household_demographics\n     ,income_band\n     ,store_returns\n where ca_city\t        =  'Jackson'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  23567\n   and ib_upper_bound   <=  23567 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n limit 100;",
    "patch_sql": "WITH filtered_customers AS (SELECT c_customer_id, c_first_name, c_last_name, c_current_cdemo_sk, c_current_hdemo_sk, c_current_addr_sk FROM customer INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE ca_city = 'Jackson'), valid_income_bands AS (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 23567 AND ib_upper_bound <= 23567 + 50000), joined_demographics AS (SELECT cd_demo_sk FROM customer_demographics AS cd INNER JOIN household_demographics AS hd ON cd.cd_demo_sk = hd.hd_demo_sk INNER JOIN valid_income_bands AS vib ON hd.hd_income_band_sk = vib.ib_income_band_sk) SELECT c_customer_id AS customer_id, COALESCE(c_last_name, '') || ', ' || COALESCE(c_first_name, '') AS customername FROM filtered_customers AS fc LEFT JOIN store_returns AS sr ON sr.sr_cdemo_sk = fc.c_current_cdemo_sk INNER JOIN joined_demographics AS jd ON jd.cd_demo_sk = fc.c_current_cdemo_sk WHERE TRUE ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (retry failed): Row count mismatch: original=100, patch=0",
    "gt_semantic_passed": false,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "c574ae56b925741e33dc3446cc426666",
    "patch_cksum": "c574ae56b925741e33dc3446cc426666",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query084_agg_i1",
    "patch_id": "t3",
    "iteration": 2,
    "original_sql": "select  c_customer_id as customer_id\n       , coalesce(c_last_name,'') || ', ' || coalesce(c_first_name,'') as customername\n from customer\n     ,customer_address\n     ,customer_demographics\n     ,household_demographics\n     ,income_band\n     ,store_returns\n where ca_city\t        =  'Jackson'\n   and c_current_addr_sk = ca_address_sk\n   and ib_lower_bound   >=  23567\n   and ib_upper_bound   <=  23567 + 50000\n   and ib_income_band_sk = hd_income_band_sk\n   and cd_demo_sk = c_current_cdemo_sk\n   and hd_demo_sk = c_current_hdemo_sk\n   and sr_cdemo_sk = cd_demo_sk\n order by c_customer_id\n limit 100;",
    "patch_sql": "WITH filtered_income_band AS (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 23567 AND ib_upper_bound <= 23567 + 50000), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Jackson') SELECT c_customer_id AS customer_id, COALESCE(c_last_name, '') || ', ' || COALESCE(c_first_name, '') AS customername FROM customer JOIN filtered_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk JOIN filtered_income_band ON ib_income_band_sk = hd_income_band_sk JOIN store_returns ON sr_cdemo_sk = cd_demo_sk WHERE TRUE ORDER BY c_customer_id LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "c574ae56b925741e33dc3446cc426666",
    "patch_cksum": "c574ae56b925741e33dc3446cc426666",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query085_agg_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason\n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'College'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Unknown'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'M'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NC', 'PA', 'TX')\n     and ws_net_profit between 100 and 200\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('AR', 'CO', 'NY')\n     and ws_net_profit between 150 and 300\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'IL', 'TX')\n     and ws_net_profit between 50 and 250\n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;",
    "patch_sql": "WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_cd1 AS (SELECT cd_demo_sk, cd_marital_status, cd_education_status FROM customer_demographics WHERE cd_marital_status IN ('S', 'W', 'M') AND cd_education_status IN ('College', 'Unknown', 'Secondary')) SELECT SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) FROM web_sales INNER JOIN filtered_date_dim ON ws_sold_date_sk = d_date_sk INNER JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number INNER JOIN web_page ON ws_web_page_sk = wp_web_page_sk INNER JOIN filtered_cd1 AS cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk INNER JOIN customer_demographics AS cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk AND cd2.cd_marital_status = cd1.cd_marital_status AND cd2.cd_education_status = cd1.cd_education_status INNER JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk INNER JOIN reason ON r_reason_sk = wr_reason_sk WHERE ((cd1.cd_marital_status = 'S' AND cd1.cd_education_status = 'College' AND ws_sales_price BETWEEN 100.00 AND 150.00) OR (cd1.cd_marital_status = 'W' AND cd1.cd_education_status = 'Unknown' AND ws_sales_price BETWEEN 50.00 AND 100.00) OR (cd1.cd_marital_status = 'M' AND cd1.cd_education_status = 'Secondary' AND ws_sales_price BETWEEN 150.00 AND 200.00)) AND ((ca_country = 'United States' AND ca_state IN ('NC', 'PA', 'TX') AND ws_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'CO', 'NY') AND ws_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('IA', 'IL', 'TX') AND ws_net_profit BETWEEN 50 AND 250)) GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "32e66441e634e3cc629f50b2fe15008f",
    "patch_cksum": "32e66441e634e3cc629f50b2fe15008f",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query085_agg_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason\n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2002\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'M'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '2 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('KY', 'NC', 'SD')\n     and ws_net_profit between 100 and 200\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('AR', 'GA', 'IN')\n     and ws_net_profit between 150 and 300\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('KS', 'OH', 'VA')\n     and ws_net_profit between 50 and 250\n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;",
    "patch_sql": "SELECT SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) FROM date_dim INNER JOIN web_sales ON (ws_sold_date_sk = d_date_sk AND d_year = 2002) INNER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number) INNER JOIN customer_demographics AS cd1 ON (wr_refunded_cdemo_sk = cd1.cd_demo_sk) INNER JOIN customer_demographics AS cd2 ON (wr_returning_cdemo_sk = cd2.cd_demo_sk) INNER JOIN customer_address ON (wr_refunded_addr_sk = ca_address_sk) INNER JOIN web_page ON (ws_web_page_sk = wp_web_page_sk) INNER JOIN reason ON (wr_reason_sk = r_reason_sk) WHERE ((cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Primary' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 100.00 AND 150.00) OR (cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Secondary' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 50.00 AND 100.00) OR (cd1.cd_marital_status = 'U' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = '2 yr Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 150.00 AND 200.00)) AND ((ca_country = 'United States' AND ca_state IN ('KY', 'NC', 'SD') AND ws_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'GA', 'IN') AND ws_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'VA') AND ws_net_profit BETWEEN 50 AND 250)) GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "55213d944234324940adbf3264add0b0",
    "patch_cksum": "55213d944234324940adbf3264add0b0",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query085_agg_i2",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason\n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2002\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'M'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '2 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('KY', 'NC', 'SD')\n     and ws_net_profit between 100 and 200\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('AR', 'GA', 'IN')\n     and ws_net_profit between 150 and 300\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('KS', 'OH', 'VA')\n     and ws_net_profit between 50 and 250\n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;",
    "patch_sql": "WITH filtered_web_sales AS (SELECT ws_item_sk, ws_order_number, ws_quantity, ws_web_page_sk, ws_sold_date_sk, wr_refunded_cdemo_sk, wr_returning_cdemo_sk, wr_refunded_addr_sk, wr_reason_sk, wr_refunded_cash, wr_fee FROM web_sales JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number WHERE (ws_sales_price BETWEEN 100.00 AND 150.00 OR ws_sales_price BETWEEN 50.00 AND 100.00 OR ws_sales_price BETWEEN 150.00 AND 200.00) AND (ws_net_profit BETWEEN 100 AND 200 OR ws_net_profit BETWEEN 150 AND 300 OR ws_net_profit BETWEEN 50 AND 250)), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002) SELECT SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) FROM filtered_web_sales JOIN web_page ON ws_web_page_sk = wp_web_page_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer_demographics AS cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk JOIN customer_demographics AS cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk JOIN reason ON r_reason_sk = wr_reason_sk WHERE (cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Primary' AND cd1.cd_education_status = cd2.cd_education_status) OR (cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Secondary' AND cd1.cd_education_status = cd2.cd_education_status) OR (cd1.cd_marital_status = 'U' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = '2 yr Degree' AND cd1.cd_education_status = cd2.cd_education_status) AND ((ca_country = 'United States' AND ca_state IN ('KY', 'NC', 'SD')) OR (ca_country = 'United States' AND ca_state IN ('AR', 'GA', 'IN')) OR (ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'VA'))) GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (retry failed): Row count mismatch: original=16, patch=41",
    "gt_semantic_passed": false,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "55213d944234324940adbf3264add0b0",
    "patch_cksum": "55213d944234324940adbf3264add0b0",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query085_agg_i2",
    "patch_id": "t2",
    "iteration": 1,
    "original_sql": "select  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason\n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2002\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'M'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '2 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('KY', 'NC', 'SD')\n     and ws_net_profit between 100 and 200\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('AR', 'GA', 'IN')\n     and ws_net_profit between 150 and 300\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('KS', 'OH', 'VA')\n     and ws_net_profit between 50 and 250\n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;",
    "patch_sql": "WITH filtered_cd AS (SELECT cd_demo_sk, cd_marital_status, cd_education_status FROM customer_demographics WHERE (cd_marital_status = 'S' AND cd_education_status = 'Primary') OR (cd_marital_status = 'M' AND cd_education_status = 'Secondary') OR (cd_marital_status = 'U' AND cd_education_status = '2 yr Degree')), filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), preagg_web_sales AS (SELECT ws_item_sk, ws_order_number, ws_web_page_sk, ws_sold_date_sk, ws_quantity, ws_sales_price, ws_net_profit FROM web_sales WHERE ws_sales_price BETWEEN 50.00 AND 200.00) SELECT SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) FROM preagg_web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk JOIN filtered_date AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN filtered_cd AS cd1 ON cd1.cd_demo_sk = wr.wr_refunded_cdemo_sk JOIN filtered_cd AS cd2 ON cd2.cd_demo_sk = wr.wr_returning_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = wr.wr_refunded_addr_sk JOIN reason AS r ON r.r_reason_sk = wr.wr_reason_sk WHERE ((cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Primary' AND cd1.cd_education_status = cd2.cd_education_status AND ws.ws_sales_price BETWEEN 100.00 AND 150.00) OR (cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Secondary' AND cd1.cd_education_status = cd2.cd_education_status AND ws.ws_sales_price BETWEEN 50.00 AND 100.00) OR (cd1.cd_marital_status = 'U' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = '2 yr Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws.ws_sales_price BETWEEN 150.00 AND 200.00)) AND ((ca.ca_country = 'United States' AND ca.ca_state IN ('KY', 'NC', 'SD') AND ws.ws_net_profit BETWEEN 100 AND 200) OR (ca.ca_country = 'United States' AND ca.ca_state IN ('AR', 'GA', 'IN') AND ws.ws_net_profit BETWEEN 150 AND 300) OR (ca.ca_country = 'United States' AND ca.ca_state IN ('KS', 'OH', 'VA') AND ws.ws_net_profit BETWEEN 50 AND 250)) GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "55213d944234324940adbf3264add0b0",
    "patch_cksum": "55213d944234324940adbf3264add0b0",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query085_agg_i2",
    "patch_id": "S0:03014fca41c49153",
    "iteration": 2,
    "original_sql": "select  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason\n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2002\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk\n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Primary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'M'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '2 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('KY', 'NC', 'SD')\n     and ws_net_profit between 100 and 200\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('AR', 'GA', 'IN')\n     and ws_net_profit between 150 and 300\n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('KS', 'OH', 'VA')\n     and ws_net_profit between 50 and 250\n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002) SELECT SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) FROM web_sales INNER JOIN filtered_dates ON ws_sold_date_sk = d_date_sk INNER JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number INNER JOIN web_page ON ws_web_page_sk = wp_web_page_sk INNER JOIN customer_demographics AS cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk INNER JOIN customer_demographics AS cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk INNER JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk INNER JOIN reason ON r_reason_sk = wr_reason_sk WHERE ((cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Primary' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 100.00 AND 150.00) OR (cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Secondary' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 50.00 AND 100.00) OR (cd1.cd_marital_status = 'U' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = '2 yr Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 150.00 AND 200.00)) AND ((ca_country = 'United States' AND ca_state IN ('KY', 'NC', 'SD') AND ws_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('AR', 'GA', 'IN') AND ws_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('KS', 'OH', 'VA') AND ws_net_profit BETWEEN 50 AND 250)) GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc FROM 1 FOR 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "55213d944234324940adbf3264add0b0",
    "patch_cksum": "55213d944234324940adbf3264add0b0",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ss_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ss_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and cs_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and cs_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ws_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ws_wholesale_cost BETWEEN 35 AND 45\n         )\n) cool_cust\n;",
    "patch_sql": "WITH filtered_date AS (SELECT * FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11), filtered_customer AS (SELECT * FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961) SELECT COUNT(*) FROM ((SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales INNER JOIN filtered_date ON store_sales.ss_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_customer ON store_sales.ss_customer_sk = filtered_customer.c_customer_sk WHERE ss_list_price BETWEEN 242 AND 271 AND ss_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales INNER JOIN filtered_date ON catalog_sales.cs_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_customer ON catalog_sales.cs_bill_customer_sk = filtered_customer.c_customer_sk WHERE cs_list_price BETWEEN 242 AND 271 AND cs_wholesale_cost BETWEEN 35 AND 45) EXCEPT (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales INNER JOIN filtered_date ON web_sales.ws_sold_date_sk = filtered_date.d_date_sk INNER JOIN filtered_customer ON web_sales.ws_bill_customer_sk = filtered_customer.c_customer_sk WHERE ws_list_price BETWEEN 242 AND 271 AND ws_wholesale_cost BETWEEN 35 AND 45)) AS cool_cust;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i1",
    "patch_id": "t1_comb",
    "iteration": 1,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ss_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ss_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and cs_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and cs_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ws_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ws_wholesale_cost BETWEEN 35 AND 45\n         )\n) cool_cust\n;",
    "patch_sql": "WITH store_sales_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1214 AND 1214 + 11 AND ss.ss_list_price BETWEEN 242 AND 271 AND c.c_birth_year BETWEEN 1955 AND 1961 AND ss.ss_wholesale_cost BETWEEN 35 AND 45), catalog_sales_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM catalog_sales AS cs JOIN date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk JOIN customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1214 AND 1214 + 11 AND cs.cs_list_price BETWEEN 242 AND 271 AND c.c_birth_year BETWEEN 1955 AND 1961 AND cs.cs_wholesale_cost BETWEEN 35 AND 45), web_sales_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM web_sales AS ws JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1214 AND 1214 + 11 AND ws.ws_list_price BETWEEN 242 AND 271 AND c.c_birth_year BETWEEN 1955 AND 1961 AND ws.ws_wholesale_cost BETWEEN 35 AND 45) SELECT COUNT(*) FROM store_sales_base AS ssb WHERE NOT EXISTS(SELECT 1 FROM catalog_sales_base AS csb WHERE csb.c_last_name = ssb.c_last_name AND csb.c_first_name = ssb.c_first_name AND csb.d_date = ssb.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales_base AS wsb WHERE wsb.c_last_name = ssb.c_last_name AND wsb.c_first_name = ssb.c_first_name AND wsb.d_date = ssb.d_date);",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i1",
    "patch_id": "t3_rescue",
    "iteration": 1,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ss_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ss_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and cs_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and cs_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ws_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ws_wholesale_cost BETWEEN 35 AND 45\n         )\n) cool_cust\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11), filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961), store_sales_base AS (SELECT DISTINCT fc.c_last_name, fc.c_first_name, fd.d_date FROM store_sales AS ss INNER JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk INNER JOIN filtered_customers AS fc ON ss.ss_customer_sk = fc.c_customer_sk WHERE ss.ss_list_price BETWEEN 242 AND 271 AND ss.ss_wholesale_cost BETWEEN 35 AND 45) SELECT COUNT(*) FROM store_sales_base AS ssb WHERE NOT EXISTS(SELECT 1 FROM catalog_sales AS cs INNER JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk INNER JOIN filtered_customers AS fc ON cs.cs_bill_customer_sk = fc.c_customer_sk WHERE cs.cs_list_price BETWEEN 242 AND 271 AND cs.cs_wholesale_cost BETWEEN 35 AND 45 AND fc.c_last_name = ssb.c_last_name AND fc.c_first_name = ssb.c_first_name AND fd.d_date = ssb.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales AS ws INNER JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk INNER JOIN filtered_customers AS fc ON ws.ws_bill_customer_sk = fc.c_customer_sk WHERE ws.ws_list_price BETWEEN 242 AND 271 AND ws.ws_wholesale_cost BETWEEN 35 AND 45 AND fc.c_last_name = ssb.c_last_name AND fc.c_first_name = ssb.c_first_name AND fd.d_date = ssb.d_date);",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i1",
    "patch_id": "t2_refine",
    "iteration": 1,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ss_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ss_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and cs_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and cs_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ws_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ws_wholesale_cost BETWEEN 35 AND 45\n         )\n) cool_cust\n;",
    "patch_sql": "WITH filtered_date AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11), filtered_customer AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961), store_sales_filtered AS (SELECT DISTINCT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 242 AND 271 AND ss_wholesale_cost BETWEEN 35 AND 45), catalog_sales_filtered AS (SELECT DISTINCT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 242 AND 271 AND cs_wholesale_cost BETWEEN 35 AND 45), web_sales_filtered AS (SELECT DISTINCT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_list_price BETWEEN 242 AND 271 AND ws_wholesale_cost BETWEEN 35 AND 45) SELECT COUNT(*) FROM (SELECT c_last_name, c_first_name, d_date FROM store_sales_filtered AS ss JOIN filtered_customer AS c ON ss.ss_customer_sk = c.c_customer_sk JOIN filtered_date AS d ON ss.ss_sold_date_sk = d.d_date_sk EXCEPT SELECT c_last_name, c_first_name, d_date FROM catalog_sales_filtered AS cs JOIN filtered_customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk JOIN filtered_date AS d ON cs.cs_sold_date_sk = d.d_date_sk EXCEPT SELECT c_last_name, c_first_name, d_date FROM web_sales_filtered AS ws JOIN filtered_customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk JOIN filtered_date AS d ON ws.ws_sold_date_sk = d.d_date_sk) AS cool_cust;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i1",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ss_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ss_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and cs_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and cs_wholesale_cost BETWEEN 35 AND 45\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1214 and 1214+11\n         and ws_list_price between 242 and 271\n         and c_birth_year BETWEEN 1955 AND 1961\n         and ws_wholesale_cost BETWEEN 35 AND 45\n         )\n) cool_cust\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1214 AND 1214 + 11), filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1955 AND 1961), store_sales_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss INNER JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN filtered_customers AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 242 AND 271 AND ss.ss_wholesale_cost BETWEEN 35 AND 45) SELECT COUNT(*) FROM store_sales_base AS ssb WHERE NOT EXISTS(SELECT 1 FROM catalog_sales AS cs INNER JOIN filtered_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN filtered_customers AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 242 AND 271 AND cs.cs_wholesale_cost BETWEEN 35 AND 45 AND c.c_last_name = ssb.c_last_name AND c.c_first_name = ssb.c_first_name AND d.d_date = ssb.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales AS ws INNER JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN filtered_customers AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 242 AND 271 AND ws.ws_wholesale_cost BETWEEN 35 AND 45 AND c.c_last_name = ssb.c_last_name AND c.c_first_name = ssb.c_first_name AND d.d_date = ssb.d_date);",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i2",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ss_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ss_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and cs_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and cs_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ws_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ws_wholesale_cost BETWEEN 76 AND 86\n         )\n) cool_cust\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1213 AND 1213 + 11), filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1968 AND 1974), store_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN filtered_customers AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 168 AND 197 AND ss.ss_wholesale_cost BETWEEN 76 AND 86) SELECT COUNT(*) FROM store_base AS sb WHERE NOT EXISTS(SELECT 1 FROM catalog_sales AS cs JOIN filtered_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk JOIN filtered_customers AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 168 AND 197 AND cs.cs_wholesale_cost BETWEEN 76 AND 86 AND c.c_last_name = sb.c_last_name AND c.c_first_name = sb.c_first_name AND d.d_date = sb.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales AS ws JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN filtered_customers AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 168 AND 197 AND ws.ws_wholesale_cost BETWEEN 76 AND 86 AND c.c_last_name = sb.c_last_name AND c.c_first_name = sb.c_first_name AND d.d_date = sb.d_date);",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 4dcb616549f308de8e921c0b3aac141b vs 16e8d651",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i2",
    "patch_id": "t4",
    "iteration": 1,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ss_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ss_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and cs_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and cs_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ws_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ws_wholesale_cost BETWEEN 76 AND 86\n         )\n) cool_cust\n;",
    "patch_sql": "WITH store_sales_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss INNER JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1213 AND 1213 + 11 AND ss.ss_list_price BETWEEN 168 AND 197 AND c.c_birth_year BETWEEN 1968 AND 1974 AND ss.ss_wholesale_cost BETWEEN 76 AND 86), catalog_sales_check AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM catalog_sales AS cs INNER JOIN date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1213 AND 1213 + 11 AND cs.cs_list_price BETWEEN 168 AND 197 AND c.c_birth_year BETWEEN 1968 AND 1974 AND cs.cs_wholesale_cost BETWEEN 76 AND 86), web_sales_check AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM web_sales AS ws INNER JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1213 AND 1213 + 11 AND ws.ws_list_price BETWEEN 168 AND 197 AND c.c_birth_year BETWEEN 1968 AND 1974 AND ws.ws_wholesale_cost BETWEEN 76 AND 86) SELECT COUNT(*) FROM store_sales_base AS ssb WHERE NOT EXISTS(SELECT 1 FROM catalog_sales_check AS csc WHERE csc.c_last_name = ssb.c_last_name AND csc.c_first_name = ssb.c_first_name AND csc.d_date = ssb.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales_check AS wsc WHERE wsc.c_last_name = ssb.c_last_name AND wsc.c_first_name = ssb.c_first_name AND wsc.d_date = ssb.d_date);",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 4dcb616549f308de8e921c0b3aac141b vs 16e8d651",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i2",
    "patch_id": "t2",
    "iteration": 1,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ss_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ss_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and cs_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and cs_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ws_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ws_wholesale_cost BETWEEN 76 AND 86\n         )\n) cool_cust\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1213 AND 1213 + 11), filtered_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1968 AND 1974), agg_store_sales AS (SELECT ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 168 AND 197 AND ss_wholesale_cost BETWEEN 76 AND 86), agg_catalog_sales AS (SELECT cs_bill_customer_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 168 AND 197 AND cs_wholesale_cost BETWEEN 76 AND 86), agg_web_sales AS (SELECT ws_bill_customer_sk, ws_sold_date_sk FROM web_sales WHERE ws_list_price BETWEEN 168 AND 197 AND ws_wholesale_cost BETWEEN 76 AND 86) SELECT COUNT(*) FROM ((SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM agg_store_sales AS s JOIN filtered_customers AS c ON s.ss_customer_sk = c.c_customer_sk JOIN filtered_dates AS d ON s.ss_sold_date_sk = d.d_date_sk) EXCEPT (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM agg_catalog_sales AS s JOIN filtered_customers AS c ON s.cs_bill_customer_sk = c.c_customer_sk JOIN filtered_dates AS d ON s.cs_sold_date_sk = d.d_date_sk) EXCEPT (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM agg_web_sales AS s JOIN filtered_customers AS c ON s.ws_bill_customer_sk = c.c_customer_sk JOIN filtered_dates AS d ON s.ws_sold_date_sk = d.d_date_sk)) AS cool_cust;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i2",
    "patch_id": "rescue_t4",
    "iteration": 2,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ss_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ss_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and cs_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and cs_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ws_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ws_wholesale_cost BETWEEN 76 AND 86\n         )\n) cool_cust\n;",
    "patch_sql": "WITH store_sales_base AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss INNER JOIN date_dim AS d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1213 AND 1213 + 11 AND ss.ss_list_price BETWEEN 168 AND 197 AND c.c_birth_year BETWEEN 1968 AND 1974 AND ss.ss_wholesale_cost BETWEEN 76 AND 86), catalog_sales_check AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM catalog_sales AS cs INNER JOIN date_dim AS d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1213 AND 1213 + 11 AND cs.cs_list_price BETWEEN 168 AND 197 AND c.c_birth_year BETWEEN 1968 AND 1974 AND cs.cs_wholesale_cost BETWEEN 76 AND 86), web_sales_check AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM web_sales AS ws INNER JOIN date_dim AS d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN customer AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE d.d_month_seq BETWEEN 1213 AND 1213 + 11 AND ws.ws_list_price BETWEEN 168 AND 197 AND c.c_birth_year BETWEEN 1968 AND 1974 AND ws.ws_wholesale_cost BETWEEN 76 AND 86) SELECT COUNT(*) FROM store_sales_base AS ssb WHERE NOT EXISTS(SELECT 1 FROM catalog_sales_check AS csc WHERE csc.c_last_name = ssb.c_last_name AND csc.c_first_name = ssb.c_first_name AND csc.d_date = ssb.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales_check AS wsc WHERE wsc.c_last_name = ssb.c_last_name AND wsc.c_first_name = ssb.c_first_name AND wsc.d_date = ssb.d_date);",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 3205f5cc3ebedc2e447342126d05c898 vs 16e8d651",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query087_multi_i2",
    "patch_id": "prefetch_dims",
    "iteration": 2,
    "original_sql": "select count(*)\nfrom ((select distinct c_last_name, c_first_name, d_date\n       from store_sales, date_dim, customer\n       where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n         and store_sales.ss_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ss_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ss_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from catalog_sales, date_dim, customer\n       where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk\n         and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and cs_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and cs_wholesale_cost BETWEEN 76 AND 86\n         )\n       except\n      (select distinct c_last_name, c_first_name, d_date\n       from web_sales, date_dim, customer\n       where web_sales.ws_sold_date_sk = date_dim.d_date_sk\n         and web_sales.ws_bill_customer_sk = customer.c_customer_sk\n         and d_month_seq between 1213 and 1213+11\n         and ws_list_price between 168 and 197\n         and c_birth_year BETWEEN 1968 AND 1974\n         and ws_wholesale_cost BETWEEN 76 AND 86\n         )\n) cool_cust\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1213 AND 1213 + 11), base_customers AS (SELECT c_customer_sk, c_last_name, c_first_name FROM customer WHERE c_birth_year BETWEEN 1968 AND 1974), store_sales_customers AS (SELECT DISTINCT c.c_last_name, c.c_first_name, d.d_date FROM store_sales AS ss INNER JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk INNER JOIN base_customers AS c ON ss.ss_customer_sk = c.c_customer_sk WHERE ss.ss_list_price BETWEEN 168 AND 197 AND ss.ss_wholesale_cost BETWEEN 76 AND 86) SELECT COUNT(*) FROM store_sales_customers AS ssc WHERE NOT EXISTS(SELECT 1 FROM catalog_sales AS cs INNER JOIN filtered_dates AS d ON cs.cs_sold_date_sk = d.d_date_sk INNER JOIN base_customers AS c ON cs.cs_bill_customer_sk = c.c_customer_sk WHERE cs.cs_list_price BETWEEN 168 AND 197 AND cs.cs_wholesale_cost BETWEEN 76 AND 86 AND c.c_last_name = ssc.c_last_name AND c.c_first_name = ssc.c_first_name AND d.d_date = ssc.d_date) AND NOT EXISTS(SELECT 1 FROM web_sales AS ws INNER JOIN filtered_dates AS d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN base_customers AS c ON ws.ws_bill_customer_sk = c.c_customer_sk WHERE ws.ws_list_price BETWEEN 168 AND 197 AND ws.ws_wholesale_cost BETWEEN 76 AND 86 AND c.c_last_name = ssc.c_last_name AND c.c_first_name = ssc.c_first_name AND d.d_date = ssc.d_date);",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum 4dcb616549f308de8e921c0b3aac141b vs 16e8d651",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "42849996bebdb03f329890f622b760c9",
    "patch_cksum": "42849996bebdb03f329890f622b760c9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query091_agg_i2",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "select  \n        cc_call_center_id Call_Center,\n        cc_name Call_Center_Name,\n        cc_manager Manager,\n        sum(cr_net_loss) Returns_Loss\nfrom\n        call_center,\n        catalog_returns,\n        date_dim,\n        customer,\n        customer_address,\n        customer_demographics,\n        household_demographics\nwhere\n        cr_call_center_sk       = cc_call_center_sk\nand     cr_returned_date_sk     = d_date_sk\nand     cr_returning_customer_sk= c_customer_sk\nand     cd_demo_sk              = c_current_cdemo_sk\nand     hd_demo_sk              = c_current_hdemo_sk\nand     ca_address_sk           = c_current_addr_sk\nand     d_year                  = 2001 \nand     d_moy                   = 12\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\nand     hd_buy_potential like '>10000%'\nand     ca_gmt_offset           = -6\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\norder by sum(cr_net_loss) desc;",
    "patch_sql": "WITH prefetched_dims AS (SELECT cd_demo_sk, hd_demo_sk, ca_address_sk, cd_marital_status, cd_education_status FROM customer_demographics, household_demographics, customer_address WHERE ((cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')) AND hd_buy_potential LIKE '>10000%' AND ca_gmt_offset = -6) SELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM catalog_returns JOIN date_dim ON cr_returned_date_sk = d_date_sk JOIN call_center ON cr_call_center_sk = cc_call_center_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN prefetched_dims ON cd_demo_sk = c_current_cdemo_sk AND hd_demo_sk = c_current_hdemo_sk AND ca_address_sk = c_current_addr_sk WHERE d_year = 2001 AND d_moy = 12 GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "52101c0f505fef96f1ab3d82944bafb9",
    "patch_cksum": "52101c0f505fef96f1ab3d82944bafb9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query091_agg_i2",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "select  \n        cc_call_center_id Call_Center,\n        cc_name Call_Center_Name,\n        cc_manager Manager,\n        sum(cr_net_loss) Returns_Loss\nfrom\n        call_center,\n        catalog_returns,\n        date_dim,\n        customer,\n        customer_address,\n        customer_demographics,\n        household_demographics\nwhere\n        cr_call_center_sk       = cc_call_center_sk\nand     cr_returned_date_sk     = d_date_sk\nand     cr_returning_customer_sk= c_customer_sk\nand     cd_demo_sk              = c_current_cdemo_sk\nand     hd_demo_sk              = c_current_hdemo_sk\nand     ca_address_sk           = c_current_addr_sk\nand     d_year                  = 2001 \nand     d_moy                   = 12\nand     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')\n        or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))\nand     hd_buy_potential like '>10000%'\nand     ca_gmt_offset           = -6\ngroup by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status\norder by sum(cr_net_loss) desc;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), filtered_call_center AS (SELECT cc_call_center_sk, cc_call_center_id, cc_name, cc_manager FROM call_center) SELECT cc_call_center_id AS Call_Center, cc_name AS Call_Center_Name, cc_manager AS Manager, SUM(cr_net_loss) AS Returns_Loss FROM catalog_returns JOIN filtered_dates ON cr_returned_date_sk = d_date_sk JOIN filtered_call_center ON cr_call_center_sk = cc_call_center_sk JOIN customer ON cr_returning_customer_sk = c_customer_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk JOIN customer_address ON ca_address_sk = c_current_addr_sk WHERE ((cd_marital_status = 'M' AND cd_education_status = 'Unknown') OR (cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree')) AND hd_buy_potential LIKE '>10000%' AND ca_gmt_offset = -6 GROUP BY cc_call_center_id, cc_name, cc_manager, cd_marital_status, cd_education_status ORDER BY SUM(cr_net_loss) DESC;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "52101c0f505fef96f1ab3d82944bafb9",
    "patch_cksum": "52101c0f505fef96f1ab3d82944bafb9",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query092_multi_i1",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "select \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"\nfrom\n    web_sales\n   ,item\n   ,date_dim\nwhere\n(i_manufact_id BETWEEN 566 and 765\nor i_category IN ('Children', 'Jewelry', 'Men'))\nand i_item_sk = ws_item_sk\nand d_date between '2002-03-06' and\n        cast('2002-03-06' as date) + interval '90 day'\nand d_date_sk = ws_sold_date_sk\nand ws_wholesale_cost BETWEEN 16 AND 36\nand ws_ext_discount_amt\n     > (\n         SELECT\n            1.3 * avg(ws_ext_discount_amt)\n         FROM\n            web_sales\n           ,date_dim\n         WHERE\n              ws_item_sk = i_item_sk\n          and d_date between '2002-03-06' and\n                             cast('2002-03-06' as date) + interval '90 day'\n          and d_date_sk = ws_sold_date_sk\n          and ws_wholesale_cost BETWEEN 16 AND 36\n          and ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01\n  )\norder by sum(ws_ext_discount_amt)\nlimit 100;",
    "patch_sql": "WITH filtered_sales AS (SELECT * FROM web_sales INNER JOIN date_dim ON d_date_sk = ws_sold_date_sk WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND ws_wholesale_cost BETWEEN 16 AND 36) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM filtered_sales INNER JOIN item ON i_item_sk = ws_item_sk WHERE (i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')) AND ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM web_sales, date_dim WHERE ws_item_sk = i_item_sk AND d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND d_date_sk = ws_sold_date_sk AND ws_wholesale_cost BETWEEN 16 AND 36 AND ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01) ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "PENDING",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "62fc60f4872b4e69291c1e2982b2a587",
    "patch_cksum": "62fc60f4872b4e69291c1e2982b2a587",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query092_multi_i1",
    "patch_id": "S0:45f976cc8e3ef038",
    "iteration": 1,
    "original_sql": "select \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"\nfrom\n    web_sales\n   ,item\n   ,date_dim\nwhere\n(i_manufact_id BETWEEN 566 and 765\nor i_category IN ('Children', 'Jewelry', 'Men'))\nand i_item_sk = ws_item_sk\nand d_date between '2002-03-06' and\n        cast('2002-03-06' as date) + interval '90 day'\nand d_date_sk = ws_sold_date_sk\nand ws_wholesale_cost BETWEEN 16 AND 36\nand ws_ext_discount_amt\n     > (\n         SELECT\n            1.3 * avg(ws_ext_discount_amt)\n         FROM\n            web_sales\n           ,date_dim\n         WHERE\n              ws_item_sk = i_item_sk\n          and d_date between '2002-03-06' and\n                             cast('2002-03-06' as date) + interval '90 day'\n          and d_date_sk = ws_sold_date_sk\n          and ws_wholesale_cost BETWEEN 16 AND 36\n          and ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01\n  )\norder by sum(ws_ext_discount_amt)\nlimit 100;",
    "patch_sql": "WITH filtered_sales AS (SELECT ws_item_sk, ws_ext_discount_amt, ws_sales_price, ws_list_price FROM web_sales INNER JOIN date_dim ON d_date_sk = ws_sold_date_sk WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND ws_wholesale_cost BETWEEN 16 AND 36), item_thresholds AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM filtered_sales WHERE ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY ws_item_sk) SELECT SUM(filtered_sales.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM filtered_sales INNER JOIN item ON i_item_sk = filtered_sales.ws_item_sk INNER JOIN item_thresholds ON filtered_sales.ws_item_sk = item_thresholds.ws_item_sk WHERE (i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')) AND filtered_sales.ws_ext_discount_amt > item_thresholds.threshold ORDER BY SUM(filtered_sales.ws_ext_discount_amt) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "PENDING",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "62fc60f4872b4e69291c1e2982b2a587",
    "patch_cksum": "62fc60f4872b4e69291c1e2982b2a587",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query092_multi_i1",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "select \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"\nfrom\n    web_sales\n   ,item\n   ,date_dim\nwhere\n(i_manufact_id BETWEEN 566 and 765\nor i_category IN ('Children', 'Jewelry', 'Men'))\nand i_item_sk = ws_item_sk\nand d_date between '2002-03-06' and\n        cast('2002-03-06' as date) + interval '90 day'\nand d_date_sk = ws_sold_date_sk\nand ws_wholesale_cost BETWEEN 16 AND 36\nand ws_ext_discount_amt\n     > (\n         SELECT\n            1.3 * avg(ws_ext_discount_amt)\n         FROM\n            web_sales\n           ,date_dim\n         WHERE\n              ws_item_sk = i_item_sk\n          and d_date between '2002-03-06' and\n                             cast('2002-03-06' as date) + interval '90 day'\n          and d_date_sk = ws_sold_date_sk\n          and ws_wholesale_cost BETWEEN 16 AND 36\n          and ws_sales_price / ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01\n  )\norder by sum(ws_ext_discount_amt)\nlimit 100;",
    "patch_sql": "WITH filtered_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id BETWEEN 566 AND 765 OR i_category IN ('Children', 'Jewelry', 'Men')), common_scan AS (SELECT ws_item_sk, ws_ext_discount_amt, ws_sales_price, ws_list_price FROM web_sales INNER JOIN date_dim ON d_date_sk = ws_sold_date_sk WHERE d_date BETWEEN '2002-03-06' AND CAST('2002-03-06' AS DATE) + INTERVAL '90 DAY' AND ws_wholesale_cost BETWEEN 16 AND 36), threshold_computation AS (SELECT cs.ws_item_sk, 1.3 * AVG(cs.ws_ext_discount_amt) AS threshold FROM common_scan AS cs INNER JOIN filtered_items AS fi ON cs.ws_item_sk = fi.i_item_sk WHERE cs.ws_sales_price / cs.ws_list_price BETWEEN 35 * 0.01 AND 50 * 0.01 GROUP BY cs.ws_item_sk), outer_rows AS (SELECT cs.ws_item_sk, cs.ws_ext_discount_amt FROM common_scan AS cs INNER JOIN filtered_items AS fi ON cs.ws_item_sk = fi.i_item_sk), join_filter AS (SELECT o.ws_ext_discount_amt FROM outer_rows AS o INNER JOIN threshold_computation AS t ON o.ws_item_sk = t.ws_item_sk WHERE o.ws_ext_discount_amt > t.threshold) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM join_filter ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "PENDING",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "62fc60f4872b4e69291c1e2982b2a587",
    "patch_cksum": "62fc60f4872b4e69291c1e2982b2a587",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query092_multi_i2",
    "patch_id": "t1_rescue",
    "iteration": 1,
    "original_sql": "select \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"\nfrom\n    web_sales\n   ,item\n   ,date_dim\nwhere\n(i_manufact_id BETWEEN 797 and 996\nor i_category IN ('Men', 'Shoes', 'Sports'))\nand i_item_sk = ws_item_sk\nand d_date between '1999-01-29' and\n        cast('1999-01-29' as date) + interval '90 day'\nand d_date_sk = ws_sold_date_sk\nand ws_wholesale_cost BETWEEN 35 AND 55\nand ws_ext_discount_amt\n     > (\n         SELECT\n            1.3 * avg(ws_ext_discount_amt)\n         FROM\n            web_sales\n           ,date_dim\n         WHERE\n              ws_item_sk = i_item_sk\n          and d_date between '1999-01-29' and\n                             cast('1999-01-29' as date) + interval '90 day'\n          and d_date_sk = ws_sold_date_sk\n          and ws_wholesale_cost BETWEEN 35 AND 55\n          and ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01\n  )\norder by sum(ws_ext_discount_amt)\nlimit 100;",
    "patch_sql": "WITH filtered_web_sales AS (SELECT ws_item_sk, ws_sold_date_sk, ws_ext_discount_amt, ws_wholesale_cost, ws_sales_price, ws_list_price FROM web_sales WHERE ws_wholesale_cost BETWEEN 35 AND 55 AND ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01), filtered_date_dim AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN '1999-01-29' AND CAST('1999-01-29' AS DATE) + INTERVAL '90 DAY'), thresholds AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM filtered_web_sales JOIN filtered_date_dim ON ws_sold_date_sk = d_date_sk GROUP BY ws_item_sk) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM filtered_web_sales AS fws JOIN item AS i ON i.i_item_sk = fws.ws_item_sk JOIN filtered_date_dim AS dd ON fws.ws_sold_date_sk = dd.d_date_sk JOIN thresholds AS t ON fws.ws_item_sk = t.ws_item_sk WHERE (i_manufact_id BETWEEN 797 AND 996 OR i_category IN ('Men', 'Shoes', 'Sports')) AND fws.ws_ext_discount_amt > t.threshold ORDER BY SUM(fws.ws_ext_discount_amt) LIMIT 100;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): checksum c3a8064db6e63f6372e7e728577502b0 vs c68bea3e",
    "gt_semantic_passed": false,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "3aa39cf15e70a7429450ba9cbd1df887",
    "patch_cksum": "3aa39cf15e70a7429450ba9cbd1df887",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query092_multi_i2",
    "patch_id": "syn_w1_rescue",
    "iteration": 1,
    "original_sql": "select \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"\nfrom\n    web_sales\n   ,item\n   ,date_dim\nwhere\n(i_manufact_id BETWEEN 797 and 996\nor i_category IN ('Men', 'Shoes', 'Sports'))\nand i_item_sk = ws_item_sk\nand d_date between '1999-01-29' and\n        cast('1999-01-29' as date) + interval '90 day'\nand d_date_sk = ws_sold_date_sk\nand ws_wholesale_cost BETWEEN 35 AND 55\nand ws_ext_discount_amt\n     > (\n         SELECT\n            1.3 * avg(ws_ext_discount_amt)\n         FROM\n            web_sales\n           ,date_dim\n         WHERE\n              ws_item_sk = i_item_sk\n          and d_date between '1999-01-29' and\n                             cast('1999-01-29' as date) + interval '90 day'\n          and d_date_sk = ws_sold_date_sk\n          and ws_wholesale_cost BETWEEN 35 AND 55\n          and ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01\n  )\norder by sum(ws_ext_discount_amt)\nlimit 100;",
    "patch_sql": "WITH filtered_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id BETWEEN 797 AND 996 OR i_category IN ('Men', 'Shoes', 'Sports')), common_scan AS (SELECT ws_item_sk, ws_ext_discount_amt, ws_sales_price, ws_list_price, ws_wholesale_cost FROM web_sales INNER JOIN date_dim ON d_date_sk = ws_sold_date_sk WHERE d_date BETWEEN '1999-01-29' AND CAST('1999-01-29' AS DATE) + INTERVAL '90 DAY' AND ws_wholesale_cost BETWEEN 35 AND 55), threshold_computation AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM common_scan WHERE ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01 GROUP BY ws_item_sk), outer_rows AS (SELECT cs.ws_item_sk, cs.ws_ext_discount_amt FROM common_scan AS cs INNER JOIN filtered_items AS fi ON cs.ws_item_sk = fi.i_item_sk), final_filtered AS (SELECT o.ws_ext_discount_amt FROM outer_rows AS o INNER JOIN threshold_computation AS t ON o.ws_item_sk = t.ws_item_sk WHERE o.ws_ext_discount_amt > t.threshold) SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM final_filtered ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "PENDING",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "3aa39cf15e70a7429450ba9cbd1df887",
    "patch_cksum": "3aa39cf15e70a7429450ba9cbd1df887",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query092_multi_i2",
    "patch_id": "t2_refine",
    "iteration": 1,
    "original_sql": "select \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\"\nfrom\n    web_sales\n   ,item\n   ,date_dim\nwhere\n(i_manufact_id BETWEEN 797 and 996\nor i_category IN ('Men', 'Shoes', 'Sports'))\nand i_item_sk = ws_item_sk\nand d_date between '1999-01-29' and\n        cast('1999-01-29' as date) + interval '90 day'\nand d_date_sk = ws_sold_date_sk\nand ws_wholesale_cost BETWEEN 35 AND 55\nand ws_ext_discount_amt\n     > (\n         SELECT\n            1.3 * avg(ws_ext_discount_amt)\n         FROM\n            web_sales\n           ,date_dim\n         WHERE\n              ws_item_sk = i_item_sk\n          and d_date between '1999-01-29' and\n                             cast('1999-01-29' as date) + interval '90 day'\n          and d_date_sk = ws_sold_date_sk\n          and ws_wholesale_cost BETWEEN 35 AND 55\n          and ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01\n  )\norder by sum(ws_ext_discount_amt)\nlimit 100;",
    "patch_sql": "WITH filtered_items AS (SELECT i_item_sk FROM item WHERE i_manufact_id BETWEEN 797 AND 996 OR i_category IN ('Men', 'Shoes', 'Sports')), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1999-01-29' AND CAST('1999-01-29' AS DATE) + INTERVAL '90 DAY') SELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales INNER JOIN filtered_items ON ws_item_sk = filtered_items.i_item_sk INNER JOIN filtered_dates ON ws_sold_date_sk = filtered_dates.d_date_sk WHERE ws_wholesale_cost BETWEEN 35 AND 55 AND ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM web_sales INNER JOIN filtered_dates ON ws_sold_date_sk = filtered_dates.d_date_sk WHERE ws_item_sk = filtered_items.i_item_sk AND ws_wholesale_cost BETWEEN 35 AND 55 AND ws_sales_price / ws_list_price BETWEEN 76 * 0.01 AND 91 * 0.01) ORDER BY SUM(ws_ext_discount_amt) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "PENDING",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "3aa39cf15e70a7429450ba9cbd1df887",
    "patch_cksum": "3aa39cf15e70a7429450ba9cbd1df887",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query094_multi_i1",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "select \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '2002-9-01' and\n           cast('2002-9-01' as date) + interval '60 day'\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state in ('CA','MI','OH'\n            ,'SD' ,'TX' ,'VA')\nand ws1.ws_web_site_sk = web_site_sk\nand web_gmt_offset >= -5\nand ws1.ws_list_price between 237 and 266\nand exists (select *\n            from web_sales ws2\n            where ws1.ws_order_number = ws2.ws_order_number\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n               from web_returns wr1\n               where ws1.ws_order_number = wr1.wr_order_number\n               and wr1.wr_reason_sk in (7, 25, 26, 52, 69)\n               )\norder by count(distinct ws_order_number)\nlimit 100;",
    "patch_sql": "WITH prefiltered_returns AS (SELECT DISTINCT wr_order_number FROM web_returns WHERE wr_reason_sk IN (7, 25, 26, 52, 69)) SELECT COUNT(DISTINCT ws_order_number) AS \"order count\", SUM(ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws_net_profit) AS \"total net profit\" FROM web_sales AS ws1 JOIN date_dim ON ws1.ws_ship_date_sk = d_date_sk JOIN customer_address ON ws1.ws_ship_addr_sk = ca_address_sk JOIN web_site ON ws1.ws_web_site_sk = web_site_sk LEFT JOIN prefiltered_returns AS pr ON ws1.ws_order_number = pr.wr_order_number WHERE d_date BETWEEN '2002-9-01' AND CAST('2002-9-01' AS DATE) + INTERVAL '60 DAY' AND ca_state IN ('CA', 'MI', 'OH', 'SD', 'TX', 'VA') AND web_gmt_offset >= -5 AND ws1.ws_list_price BETWEEN 237 AND 266 AND EXISTS(SELECT 1 FROM web_sales AS ws2 WHERE ws1.ws_order_number = ws2.ws_order_number AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) AND pr.wr_order_number IS NULL ORDER BY COUNT(DISTINCT ws_order_number) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "7d4cca27213acfe5dc95d6f021821f9e",
    "patch_cksum": "7d4cca27213acfe5dc95d6f021821f9e",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query094_multi_i2",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "select \n   count(distinct ws_order_number) as \"order count\"\n  ,sum(ws_ext_ship_cost) as \"total shipping cost\"\n  ,sum(ws_net_profit) as \"total net profit\"\nfrom\n   web_sales ws1\n  ,date_dim\n  ,customer_address\n  ,web_site\nwhere\n    d_date between '1999-10-01' and\n           cast('1999-10-01' as date) + interval '60 day'\nand ws1.ws_ship_date_sk = d_date_sk\nand ws1.ws_ship_addr_sk = ca_address_sk\nand ca_state in ('MO','MT','OK'\n            ,'SC' ,'TX' ,'WI')\nand ws1.ws_web_site_sk = web_site_sk\nand web_gmt_offset >= -5\nand ws1.ws_list_price between 253 and 282\nand exists (select *\n            from web_sales ws2\n            where ws1.ws_order_number = ws2.ws_order_number\n              and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk)\nand not exists(select *\n               from web_returns wr1\n               where ws1.ws_order_number = wr1.wr_order_number\n               and wr1.wr_reason_sk in (8, 18, 20, 23, 41)\n               )\norder by count(distinct ws_order_number)\nlimit 100;",
    "patch_sql": "WITH filtered_web_returns AS (SELECT DISTINCT wr_order_number FROM web_returns WHERE wr_reason_sk IN (8, 18, 20, 23, 41)) SELECT COUNT(DISTINCT ws_order_number) AS \"order count\", SUM(ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws_net_profit) AS \"total net profit\" FROM web_sales AS ws1 JOIN date_dim ON ws1.ws_ship_date_sk = d_date_sk JOIN customer_address ON ws1.ws_ship_addr_sk = ca_address_sk JOIN web_site ON ws1.ws_web_site_sk = web_site_sk LEFT JOIN filtered_web_returns AS fwr ON ws1.ws_order_number = fwr.wr_order_number WHERE d_date BETWEEN '1999-10-01' AND CAST('1999-10-01' AS DATE) + INTERVAL '60 DAY' AND ca_state IN ('MO', 'MT', 'OK', 'SC', 'TX', 'WI') AND web_gmt_offset >= -5 AND ws1.ws_list_price BETWEEN 253 AND 282 AND EXISTS(SELECT * FROM web_sales AS ws2 WHERE ws1.ws_order_number = ws2.ws_order_number AND ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) AND fwr.wr_order_number IS NULL ORDER BY COUNT(DISTINCT ws_order_number) LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 1,
    "patch_rows": 1,
    "orig_cksum": "6fc02c4c10c2e4413378f6e2aee3fe07",
    "patch_cksum": "6fc02c4c10c2e4413378f6e2aee3fe07",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query099_agg_i1",
    "patch_id": "t9",
    "iteration": 2,
    "original_sql": "select \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"\nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\nd_month_seq between 1192 and 1192 + 23\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\nand cs_list_price between 86 and 115\nand sm_type = 'EXPRESS'\nand cc_class = 'small'\nand w_gmt_offset = -5\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n        ,cc_name\nlimit 100;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1192 AND 1192 + 23), filtered_warehouse AS (SELECT w_warehouse_sk, w_warehouse_name FROM warehouse WHERE w_gmt_offset = -5), filtered_ship_mode AS (SELECT sm_ship_mode_sk, sm_type FROM ship_mode WHERE sm_type = 'EXPRESS'), filtered_call_center AS (SELECT cc_call_center_sk, cc_name FROM call_center WHERE cc_class = 'small'), filtered_catalog_sales AS (SELECT cs_ship_date_sk, cs_sold_date_sk, cs_warehouse_sk, cs_ship_mode_sk, cs_call_center_sk FROM catalog_sales WHERE cs_list_price BETWEEN 86 AND 115) SELECT SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name, SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 30) AND (cs_ship_date_sk - cs_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 60) AND (cs_ship_date_sk - cs_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 90) AND (cs_ship_date_sk - cs_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM filtered_catalog_sales AS cs JOIN filtered_dates AS d ON cs.cs_ship_date_sk = d.d_date_sk JOIN filtered_warehouse AS w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN filtered_ship_mode AS sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN filtered_call_center AS cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE TRUE GROUP BY SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name ORDER BY SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "137821ce16502fe7b0a7ac7904ce202e",
    "patch_cksum": "137821ce16502fe7b0a7ac7904ce202e",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query099_agg_i1",
    "patch_id": "t11",
    "iteration": 2,
    "original_sql": "select \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"\nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\nd_month_seq between 1192 and 1192 + 23\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\nand cs_list_price between 86 and 115\nand sm_type = 'EXPRESS'\nand cc_class = 'small'\nand w_gmt_offset = -5\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n        ,cc_name\nlimit 100;",
    "patch_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1192 AND 1192 + 23), preagg_catalog_sales AS (SELECT cs_warehouse_sk, cs_ship_mode_sk, cs_call_center_sk, cs_ship_date_sk, cs_sold_date_sk FROM catalog_sales WHERE cs_list_price BETWEEN 86 AND 115) SELECT SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name, SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 30) AND (cs_ship_date_sk - cs_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 60) AND (cs_ship_date_sk - cs_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 90) AND (cs_ship_date_sk - cs_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM preagg_catalog_sales AS cs JOIN filtered_date AS d ON cs.cs_ship_date_sk = d.d_date_sk JOIN warehouse AS w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN ship_mode AS sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN call_center AS cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE sm.sm_type = 'EXPRESS' AND cc.cc_class = 'small' AND w.w_gmt_offset = -5 GROUP BY SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name ORDER BY SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "137821ce16502fe7b0a7ac7904ce202e",
    "patch_cksum": "137821ce16502fe7b0a7ac7904ce202e",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query099_agg_i1",
    "patch_id": "t10",
    "iteration": 2,
    "original_sql": "select \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"\nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\nd_month_seq between 1192 and 1192 + 23\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\nand cs_list_price between 86 and 115\nand sm_type = 'EXPRESS'\nand cc_class = 'small'\nand w_gmt_offset = -5\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n        ,cc_name\nlimit 100;",
    "patch_sql": "WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1192 AND 1192 + 23), filtered_warehouse AS (SELECT w_warehouse_sk, w_warehouse_name FROM warehouse WHERE w_gmt_offset = -5), filtered_ship_mode AS (SELECT sm_ship_mode_sk, sm_type FROM ship_mode WHERE sm_type = 'EXPRESS'), filtered_call_center AS (SELECT cc_call_center_sk, cc_name FROM call_center WHERE cc_class = 'small') SELECT SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name, SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 30) AND (cs_ship_date_sk - cs_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 60) AND (cs_ship_date_sk - cs_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 90) AND (cs_ship_date_sk - cs_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM catalog_sales AS cs INNER JOIN filtered_date_dim AS dd ON cs.cs_ship_date_sk = dd.d_date_sk INNER JOIN filtered_warehouse AS w ON cs.cs_warehouse_sk = w.w_warehouse_sk INNER JOIN filtered_ship_mode AS sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk INNER JOIN filtered_call_center AS cc ON cs.cs_call_center_sk = cc.cc_call_center_sk WHERE cs_list_price BETWEEN 86 AND 115 GROUP BY SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name ORDER BY SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "137821ce16502fe7b0a7ac7904ce202e",
    "patch_cksum": "137821ce16502fe7b0a7ac7904ce202e",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query099_agg_i2",
    "patch_id": "t3",
    "iteration": 0,
    "original_sql": "select \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\"\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\"\nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\nd_month_seq between 1191 and 1191 + 23\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\nand cs_list_price between 244 and 273\nand sm_type = 'LIBRARY'\nand cc_class = 'medium'\nand w_gmt_offset = -5\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n        ,cc_name\nlimit 100;",
    "patch_sql": "WITH filtered_warehouse AS (SELECT * FROM warehouse WHERE w_gmt_offset = -5), filtered_ship_mode AS (SELECT * FROM ship_mode WHERE sm_type = 'LIBRARY'), filtered_call_center AS (SELECT * FROM call_center WHERE cc_class = 'medium') SELECT SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name, SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 30) AND (cs_ship_date_sk - cs_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 60) AND (cs_ship_date_sk - cs_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 90) AND (cs_ship_date_sk - cs_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM catalog_sales, filtered_warehouse, filtered_ship_mode, filtered_call_center, date_dim WHERE cs_ship_date_sk = d_date_sk AND cs_warehouse_sk = w_warehouse_sk AND cs_ship_mode_sk = sm_ship_mode_sk AND cs_call_center_sk = cc_call_center_sk AND d_month_seq BETWEEN 1191 AND 1191 + 23 AND cs_list_price BETWEEN 244 AND 273 GROUP BY SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name ORDER BY SUBSTRING(w_warehouse_name FROM 1 FOR 20), sm_type, cc_name LIMIT 100;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "NEUTRAL",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "ff3a58b816b7ca37732bb3b191f1cdff",
    "patch_cksum": "ff3a58b816b7ca37732bb3b191f1cdff",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query100_agg_i1",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select  item1.i_item_sk, item2.i_item_sk, count(*) as cnt\nFROM item AS item1,\nitem AS item2,\nstore_sales AS s1,\nstore_sales AS s2,\ndate_dim,\ncustomer,\ncustomer_address,\ncustomer_demographics\nWHERE\nitem1.i_item_sk < item2.i_item_sk\nAND s1.ss_ticket_number = s2.ss_ticket_number\nAND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk\nAND s1.ss_customer_sk = c_customer_sk\nand c_current_addr_sk = ca_address_sk\nand c_current_cdemo_sk = cd_demo_sk\nAND d_year between 1998 and 1998 + 1\nand d_date_sk = s1.ss_sold_date_sk\nand item1.i_category in ('Electronics', 'Jewelry')\nand item2.i_manager_id between 81 and 100\nand cd_marital_status = 'S'\nand cd_education_status = 'College'\nand s1.ss_list_price between 108 and 122\nand s2.ss_list_price between 108 and 122\nGROUP BY item1.i_item_sk, item2.i_item_sk\nORDER BY cnt\n;",
    "patch_sql": "WITH prefetched_sales AS (SELECT * FROM store_sales JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1998 AND 1999 AND ss_list_price BETWEEN 108 AND 122) SELECT item1.i_item_sk, item2.i_item_sk, COUNT(*) AS cnt FROM prefetched_sales AS s1 JOIN prefetched_sales AS s2 ON s1.ss_ticket_number = s2.ss_ticket_number JOIN item AS item1 ON s1.ss_item_sk = item1.i_item_sk JOIN item AS item2 ON s2.ss_item_sk = item2.i_item_sk JOIN customer ON s1.ss_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE item1.i_category IN ('Electronics', 'Jewelry') AND item2.i_manager_id BETWEEN 81 AND 100 AND item1.i_item_sk < item2.i_item_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): row count 294 vs 304",
    "gt_semantic_passed": false,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "1464301b986f46d94445901b1db44b7c",
    "patch_cksum": "1464301b986f46d94445901b1db44b7c",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query100_agg_i1",
    "patch_id": "syn_w2",
    "iteration": 0,
    "original_sql": "select  item1.i_item_sk, item2.i_item_sk, count(*) as cnt\nFROM item AS item1,\nitem AS item2,\nstore_sales AS s1,\nstore_sales AS s2,\ndate_dim,\ncustomer,\ncustomer_address,\ncustomer_demographics\nWHERE\nitem1.i_item_sk < item2.i_item_sk\nAND s1.ss_ticket_number = s2.ss_ticket_number\nAND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk\nAND s1.ss_customer_sk = c_customer_sk\nand c_current_addr_sk = ca_address_sk\nand c_current_cdemo_sk = cd_demo_sk\nAND d_year between 1998 and 1998 + 1\nand d_date_sk = s1.ss_sold_date_sk\nand item1.i_category in ('Electronics', 'Jewelry')\nand item2.i_manager_id between 81 and 100\nand cd_marital_status = 'S'\nand cd_education_status = 'College'\nand s1.ss_list_price between 108 and 122\nand s2.ss_list_price between 108 and 122\nGROUP BY item1.i_item_sk, item2.i_item_sk\nORDER BY cnt\n;",
    "patch_sql": "WITH prefetched_sales AS (SELECT * FROM store_sales INNER JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE d_year BETWEEN 1998 AND 1999 AND ss_list_price BETWEEN 108 AND 122) SELECT item1.i_item_sk, item2.i_item_sk, COUNT(*) AS cnt FROM prefetched_sales AS s1 JOIN prefetched_sales AS s2 ON s1.ss_ticket_number = s2.ss_ticket_number JOIN item AS item1 ON s1.ss_item_sk = item1.i_item_sk JOIN item AS item2 ON s2.ss_item_sk = item2.i_item_sk JOIN customer ON s1.ss_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE item1.i_category IN ('Electronics', 'Jewelry') AND item2.i_manager_id BETWEEN 81 AND 100 AND item1.i_item_sk < item2.i_item_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt;",
    "ground_truth": "CHECKSUM_FAIL",
    "gt_status": "FAIL",
    "gt_error": "Equivalence (after retry): row count 294 vs 304",
    "gt_semantic_passed": false,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "1464301b986f46d94445901b1db44b7c",
    "patch_cksum": "1464301b986f46d94445901b1db44b7c",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query100_agg_i2",
    "patch_id": "t1",
    "iteration": 0,
    "original_sql": "select  item1.i_item_sk, item2.i_item_sk, count(*) as cnt\nFROM item AS item1,\nitem AS item2,\nstore_sales AS s1,\nstore_sales AS s2,\ndate_dim,\ncustomer,\ncustomer_address,\ncustomer_demographics\nWHERE\nitem1.i_item_sk < item2.i_item_sk\nAND s1.ss_ticket_number = s2.ss_ticket_number\nAND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk\nAND s1.ss_customer_sk = c_customer_sk\nand c_current_addr_sk = ca_address_sk\nand c_current_cdemo_sk = cd_demo_sk\nAND d_year between 1999 and 1999 + 1\nand d_date_sk = s1.ss_sold_date_sk\nand item1.i_category in ('Electronics', 'Men')\nand item2.i_manager_id between 44 and 63\nand cd_marital_status = 'D'\nand cd_education_status = 'College'\nand s1.ss_list_price between 115 and 129\nand s2.ss_list_price between 115 and 129\nGROUP BY item1.i_item_sk, item2.i_item_sk\nORDER BY cnt\n;",
    "patch_sql": "WITH prefetched_sales AS (SELECT ss_ticket_number, ss_item_sk, ss_customer_sk, ss_sold_date_sk, ss_list_price FROM store_sales WHERE ss_list_price BETWEEN 115 AND 129) SELECT item1.i_item_sk, item2.i_item_sk, COUNT(*) AS cnt FROM prefetched_sales AS s1 INNER JOIN prefetched_sales AS s2 ON s1.ss_ticket_number = s2.ss_ticket_number INNER JOIN item AS item1 ON s1.ss_item_sk = item1.i_item_sk INNER JOIN item AS item2 ON s2.ss_item_sk = item2.i_item_sk INNER JOIN date_dim ON d_date_sk = s1.ss_sold_date_sk INNER JOIN customer ON s1.ss_customer_sk = c_customer_sk INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk INNER JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE item1.i_item_sk < item2.i_item_sk AND d_year BETWEEN 1999 AND 2000 AND item1.i_category IN ('Electronics', 'Men') AND item2.i_manager_id BETWEEN 44 AND 63 AND cd_marital_status = 'D' AND cd_education_status = 'College' GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "da87bac15e1ce2d8dedbffb7a71dcb22",
    "patch_cksum": "da87bac15e1ce2d8dedbffb7a71dcb22",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query100_agg_i2",
    "patch_id": "t3",
    "iteration": 0,
    "original_sql": "select  item1.i_item_sk, item2.i_item_sk, count(*) as cnt\nFROM item AS item1,\nitem AS item2,\nstore_sales AS s1,\nstore_sales AS s2,\ndate_dim,\ncustomer,\ncustomer_address,\ncustomer_demographics\nWHERE\nitem1.i_item_sk < item2.i_item_sk\nAND s1.ss_ticket_number = s2.ss_ticket_number\nAND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk\nAND s1.ss_customer_sk = c_customer_sk\nand c_current_addr_sk = ca_address_sk\nand c_current_cdemo_sk = cd_demo_sk\nAND d_year between 1999 and 1999 + 1\nand d_date_sk = s1.ss_sold_date_sk\nand item1.i_category in ('Electronics', 'Men')\nand item2.i_manager_id between 44 and 63\nand cd_marital_status = 'D'\nand cd_education_status = 'College'\nand s1.ss_list_price between 115 and 129\nand s2.ss_list_price between 115 and 129\nGROUP BY item1.i_item_sk, item2.i_item_sk\nORDER BY cnt\n;",
    "patch_sql": "WITH filtered_item1 AS (SELECT * FROM item WHERE i_category IN ('Electronics', 'Men')), filtered_item2 AS (SELECT * FROM item WHERE i_manager_id BETWEEN 44 AND 63), prefetched_sales AS (SELECT ss_item_sk, ss_ticket_number, ss_customer_sk, ss_sold_date_sk, ss_list_price FROM store_sales WHERE ss_list_price BETWEEN 115 AND 129) SELECT item1.i_item_sk, item2.i_item_sk, COUNT(*) AS cnt FROM prefetched_sales AS s1 INNER JOIN filtered_item1 AS item1 ON s1.ss_item_sk = item1.i_item_sk INNER JOIN prefetched_sales AS s2 ON s1.ss_ticket_number = s2.ss_ticket_number INNER JOIN filtered_item2 AS item2 ON s2.ss_item_sk = item2.i_item_sk INNER JOIN date_dim ON s1.ss_sold_date_sk = d_date_sk INNER JOIN customer ON s1.ss_customer_sk = c_customer_sk INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk INNER JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE item1.i_item_sk < item2.i_item_sk AND d_year BETWEEN 1999 AND 2000 AND cd_marital_status = 'D' AND cd_education_status = 'College' GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "da87bac15e1ce2d8dedbffb7a71dcb22",
    "patch_cksum": "da87bac15e1ce2d8dedbffb7a71dcb22",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query100_agg_i2",
    "patch_id": "t2",
    "iteration": 0,
    "original_sql": "select  item1.i_item_sk, item2.i_item_sk, count(*) as cnt\nFROM item AS item1,\nitem AS item2,\nstore_sales AS s1,\nstore_sales AS s2,\ndate_dim,\ncustomer,\ncustomer_address,\ncustomer_demographics\nWHERE\nitem1.i_item_sk < item2.i_item_sk\nAND s1.ss_ticket_number = s2.ss_ticket_number\nAND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk\nAND s1.ss_customer_sk = c_customer_sk\nand c_current_addr_sk = ca_address_sk\nand c_current_cdemo_sk = cd_demo_sk\nAND d_year between 1999 and 1999 + 1\nand d_date_sk = s1.ss_sold_date_sk\nand item1.i_category in ('Electronics', 'Men')\nand item2.i_manager_id between 44 and 63\nand cd_marital_status = 'D'\nand cd_education_status = 'College'\nand s1.ss_list_price between 115 and 129\nand s2.ss_list_price between 115 and 129\nGROUP BY item1.i_item_sk, item2.i_item_sk\nORDER BY cnt\n;",
    "patch_sql": "WITH prefetched_sales AS (SELECT ss_ticket_number, ss_item_sk, ss_customer_sk, ss_sold_date_sk FROM store_sales WHERE ss_list_price BETWEEN 115 AND 129) SELECT item1.i_item_sk, item2.i_item_sk, COUNT(*) AS cnt FROM prefetched_sales AS s1 INNER JOIN item AS item1 ON s1.ss_item_sk = item1.i_item_sk INNER JOIN prefetched_sales AS s2 ON s1.ss_ticket_number = s2.ss_ticket_number AND s1.ss_item_sk < s2.ss_item_sk INNER JOIN item AS item2 ON s2.ss_item_sk = item2.i_item_sk INNER JOIN date_dim ON s1.ss_sold_date_sk = d_date_sk INNER JOIN customer ON s1.ss_customer_sk = c_customer_sk INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk INNER JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE d_year BETWEEN 1999 AND 1999 + 1 AND item1.i_category IN ('Electronics', 'Men') AND item2.i_manager_id BETWEEN 44 AND 63 AND cd_marital_status = 'D' AND cd_education_status = 'College' GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "da87bac15e1ce2d8dedbffb7a71dcb22",
    "patch_cksum": "da87bac15e1ce2d8dedbffb7a71dcb22",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query100_agg_i2",
    "patch_id": "t1",
    "iteration": 1,
    "original_sql": "select  item1.i_item_sk, item2.i_item_sk, count(*) as cnt\nFROM item AS item1,\nitem AS item2,\nstore_sales AS s1,\nstore_sales AS s2,\ndate_dim,\ncustomer,\ncustomer_address,\ncustomer_demographics\nWHERE\nitem1.i_item_sk < item2.i_item_sk\nAND s1.ss_ticket_number = s2.ss_ticket_number\nAND s1.ss_item_sk = item1.i_item_sk and s2.ss_item_sk = item2.i_item_sk\nAND s1.ss_customer_sk = c_customer_sk\nand c_current_addr_sk = ca_address_sk\nand c_current_cdemo_sk = cd_demo_sk\nAND d_year between 1999 and 1999 + 1\nand d_date_sk = s1.ss_sold_date_sk\nand item1.i_category in ('Electronics', 'Men')\nand item2.i_manager_id between 44 and 63\nand cd_marital_status = 'D'\nand cd_education_status = 'College'\nand s1.ss_list_price between 115 and 129\nand s2.ss_list_price between 115 and 129\nGROUP BY item1.i_item_sk, item2.i_item_sk\nORDER BY cnt\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year BETWEEN 1999 AND 1999 + 1), filtered_customers AS (SELECT c_customer_sk, c_current_addr_sk, c_current_cdemo_sk FROM customer JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk WHERE cd_marital_status = 'D' AND cd_education_status = 'College'), filtered_store_sales AS (SELECT ss_ticket_number, ss_item_sk, ss_customer_sk, ss_sold_date_sk, ss_list_price FROM store_sales WHERE ss_list_price BETWEEN 115 AND 129) SELECT item1.i_item_sk, item2.i_item_sk, COUNT(*) AS cnt FROM item AS item1 JOIN item AS item2 ON item1.i_item_sk < item2.i_item_sk JOIN filtered_store_sales AS s1 ON s1.ss_item_sk = item1.i_item_sk JOIN filtered_store_sales AS s2 ON s1.ss_ticket_number = s2.ss_ticket_number AND s2.ss_item_sk = item2.i_item_sk JOIN filtered_customers AS c ON s1.ss_customer_sk = c.c_customer_sk JOIN filtered_dates AS d ON d.d_date_sk = s1.ss_sold_date_sk WHERE item1.i_category IN ('Electronics', 'Men') AND item2.i_manager_id BETWEEN 44 AND 63 GROUP BY item1.i_item_sk, item2.i_item_sk ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "da87bac15e1ce2d8dedbffb7a71dcb22",
    "patch_cksum": "da87bac15e1ce2d8dedbffb7a71dcb22",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query101_agg_i1",
    "patch_id": "t1",
    "iteration": 2,
    "original_sql": "select  c_customer_sk, c_first_name, c_last_name, count(*) as cnt\nFROM\nstore_sales,\nstore_returns,\nweb_sales,\ndate_dim d1,\ndate_dim d2,\nitem,\ncustomer,\ncustomer_address,\nhousehold_demographics\nWHERE\nss_ticket_number = sr_ticket_number\nAND ss_customer_sk = ws_bill_customer_sk\nAND ss_customer_sk = c_customer_sk\nAND c_current_addr_sk = ca_address_sk\nAND c_current_hdemo_sk = hd_demo_sk\nAND ss_item_sk = sr_item_sk\nAND sr_item_sk = ws_item_sk\nAND i_item_sk = ss_item_sk\nAND i_category IN ('Children', 'Electronics', 'Music')\nAND sr_returned_date_sk = d1.d_date_sk\nAND ws_sold_date_sk = d2.d_date_sk\nAND d2.d_date between d1.d_date AND (d1.d_date + interval '90 day')\nAND ca_state in ('AR', 'CO', 'NC', 'NY', 'TX')\nAND d1.d_year = 1998\nAND hd_income_band_sk BETWEEN 7 AND 13\nAND hd_buy_potential = '0-500'\nAND ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 55 * 0.01\nGROUP BY c_customer_sk, c_first_name, c_last_name\nORDER BY cnt\n;",
    "patch_sql": "WITH filtered_items AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Electronics', 'Music')), filtered_customers AS (SELECT c_customer_sk, c_current_addr_sk, c_current_hdemo_sk, c_first_name, c_last_name FROM customer JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk WHERE ca_state IN ('AR', 'CO', 'NC', 'NY', 'TX') AND hd_income_band_sk BETWEEN 7 AND 13 AND hd_buy_potential = '0-500'), date_pairs AS (SELECT d1.d_date_sk AS returned_date_sk, d2.d_date_sk AS sold_date_sk FROM date_dim AS d1 JOIN date_dim AS d2 ON d2.d_date BETWEEN d1.d_date AND (d1.d_date + INTERVAL '90 DAY') WHERE d1.d_year = 1998) SELECT c_customer_sk, c_first_name, c_last_name, COUNT(*) AS cnt FROM store_sales JOIN store_returns ON ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk JOIN web_sales ON ss_customer_sk = ws_bill_customer_sk AND sr_item_sk = ws_item_sk JOIN filtered_items ON i_item_sk = ss_item_sk JOIN filtered_customers ON ss_customer_sk = c_customer_sk JOIN date_pairs ON sr_returned_date_sk = returned_date_sk AND ws_sold_date_sk = sold_date_sk WHERE ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 55 * 0.01 GROUP BY c_customer_sk, c_first_name, c_last_name ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "dc8217962d7a3a75ebb2891a18e8b959",
    "patch_cksum": "dc8217962d7a3a75ebb2891a18e8b959",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query101_agg_i1",
    "patch_id": "t3",
    "iteration": 2,
    "original_sql": "select  c_customer_sk, c_first_name, c_last_name, count(*) as cnt\nFROM\nstore_sales,\nstore_returns,\nweb_sales,\ndate_dim d1,\ndate_dim d2,\nitem,\ncustomer,\ncustomer_address,\nhousehold_demographics\nWHERE\nss_ticket_number = sr_ticket_number\nAND ss_customer_sk = ws_bill_customer_sk\nAND ss_customer_sk = c_customer_sk\nAND c_current_addr_sk = ca_address_sk\nAND c_current_hdemo_sk = hd_demo_sk\nAND ss_item_sk = sr_item_sk\nAND sr_item_sk = ws_item_sk\nAND i_item_sk = ss_item_sk\nAND i_category IN ('Children', 'Electronics', 'Music')\nAND sr_returned_date_sk = d1.d_date_sk\nAND ws_sold_date_sk = d2.d_date_sk\nAND d2.d_date between d1.d_date AND (d1.d_date + interval '90 day')\nAND ca_state in ('AR', 'CO', 'NC', 'NY', 'TX')\nAND d1.d_year = 1998\nAND hd_income_band_sk BETWEEN 7 AND 13\nAND hd_buy_potential = '0-500'\nAND ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 55 * 0.01\nGROUP BY c_customer_sk, c_first_name, c_last_name\nORDER BY cnt\n;",
    "patch_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 1998), filtered_items AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Electronics', 'Music')), filtered_customers AS (SELECT c_customer_sk, c_first_name, c_last_name, c_current_addr_sk, c_current_hdemo_sk FROM customer WHERE EXISTS(SELECT 1 FROM customer_address WHERE ca_address_sk = c_current_addr_sk AND ca_state IN ('AR', 'CO', 'NC', 'NY', 'TX')) AND EXISTS(SELECT 1 FROM household_demographics WHERE hd_demo_sk = c_current_hdemo_sk AND hd_income_band_sk BETWEEN 7 AND 13 AND hd_buy_potential = '0-500')) SELECT c_customer_sk, c_first_name, c_last_name, COUNT(*) AS cnt FROM store_sales INNER JOIN store_returns ON ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk INNER JOIN web_sales ON ss_customer_sk = ws_bill_customer_sk AND sr_item_sk = ws_item_sk INNER JOIN filtered_dates AS d1 ON sr_returned_date_sk = d1.d_date_sk INNER JOIN filtered_dates AS d2 ON ws_sold_date_sk = d2.d_date_sk INNER JOIN filtered_items ON i_item_sk = ss_item_sk INNER JOIN filtered_customers ON ss_customer_sk = c_customer_sk INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk INNER JOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk WHERE d2.d_date BETWEEN d1.d_date AND (d1.d_date + INTERVAL '90 DAY') AND ss_sales_price / ss_list_price BETWEEN 35 * 0.01 AND 55 * 0.01 GROUP BY c_customer_sk, c_first_name, c_last_name ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "dc8217962d7a3a75ebb2891a18e8b959",
    "patch_cksum": "dc8217962d7a3a75ebb2891a18e8b959",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query101_agg_i2",
    "patch_id": "S0:f2ece665ad1a915f",
    "iteration": 2,
    "original_sql": "select  c_customer_sk, c_first_name, c_last_name, count(*) as cnt\nFROM\nstore_sales,\nstore_returns,\nweb_sales,\ndate_dim d1,\ndate_dim d2,\nitem,\ncustomer,\ncustomer_address,\nhousehold_demographics\nWHERE\nss_ticket_number = sr_ticket_number\nAND ss_customer_sk = ws_bill_customer_sk\nAND ss_customer_sk = c_customer_sk\nAND c_current_addr_sk = ca_address_sk\nAND c_current_hdemo_sk = hd_demo_sk\nAND ss_item_sk = sr_item_sk\nAND sr_item_sk = ws_item_sk\nAND i_item_sk = ss_item_sk\nAND i_category IN ('Children', 'Home', 'Women')\nAND sr_returned_date_sk = d1.d_date_sk\nAND ws_sold_date_sk = d2.d_date_sk\nAND d2.d_date between d1.d_date AND (d1.d_date + interval '90 day')\nAND ca_state in ('AR', 'GA', 'IN', 'KY', 'VA')\nAND d1.d_year = 2000\nAND hd_income_band_sk BETWEEN 8 AND 14\nAND hd_buy_potential = '501-1000'\nAND ss_sales_price / ss_list_price BETWEEN 76 * 0.01 AND 96 * 0.01\nGROUP BY c_customer_sk, c_first_name, c_last_name\nORDER BY cnt\n;",
    "patch_sql": "WITH filtered_d1 AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 2000), filtered_item AS (SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Home', 'Women')) SELECT c_customer_sk, c_first_name, c_last_name, COUNT(*) AS cnt FROM store_sales INNER JOIN store_returns ON ss_ticket_number = sr_ticket_number AND ss_item_sk = sr_item_sk INNER JOIN web_sales ON ss_customer_sk = ws_bill_customer_sk AND sr_item_sk = ws_item_sk INNER JOIN filtered_d1 AS d1 ON sr_returned_date_sk = d1.d_date_sk INNER JOIN date_dim AS d2 ON ws_sold_date_sk = d2.d_date_sk INNER JOIN filtered_item AS i ON ss_item_sk = i.i_item_sk INNER JOIN customer ON ss_customer_sk = c_customer_sk INNER JOIN customer_address ON c_current_addr_sk = ca_address_sk INNER JOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk WHERE d2.d_date BETWEEN d1.d_date AND (d1.d_date + INTERVAL '90 DAY') AND ca_state IN ('AR', 'GA', 'IN', 'KY', 'VA') AND hd_income_band_sk BETWEEN 8 AND 14 AND hd_buy_potential = '501-1000' AND ss_sales_price / ss_list_price BETWEEN 76 * 0.01 AND 96 * 0.01 GROUP BY c_customer_sk, c_first_name, c_last_name ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "d404e1ea9a523ce118468a048f5e5d59",
    "patch_cksum": "d404e1ea9a523ce118468a048f5e5d59",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query102_agg_i1",
    "patch_id": "t1_rescue",
    "iteration": 1,
    "original_sql": "select \n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    hd_vehicle_count,\n    count(*) as cnt\nfrom\n    store_sales,\n    web_sales,\n    date_dim d1,\n    date_dim d2,\n    customer,\n    inventory,\n    store,\n    warehouse,\n    item,\n    customer_demographics,\n    household_demographics,\n    customer_address\n    where\n      ss_item_sk = i_item_sk\n      and ws_item_sk = ss_item_sk\n      and ss_sold_date_sk = d1.d_date_sk\n      and ws_sold_date_sk = d2.d_date_sk\n\t\t\tand d2.d_date between d1.d_date and (d1.d_date + interval '30 day')\n      and ss_customer_sk = c_customer_sk\n      and ws_bill_customer_sk = c_customer_sk\n      and ws_warehouse_sk = inv_warehouse_sk\n      and ws_warehouse_sk = w_warehouse_sk\n      and inv_item_sk = ss_item_sk\n      and inv_date_sk = ss_sold_date_sk\n      and inv_quantity_on_hand >= ss_quantity\n      and s_state = w_state\n      AND i_category IN ('Children', 'Jewelry', 'Men')\n      and i_manager_id IN (21, 22, 38, 39, 46, 47, 66, 67, 74, 93)\n      and c_current_cdemo_sk = cd_demo_sk\n      and c_current_hdemo_sk = hd_demo_sk\n      and c_current_addr_sk = ca_address_sk\n      and ca_state in ('AZ', 'KS', 'OH', 'TX', 'WA')\n      and d1.d_year = 2001\n      and ws_wholesale_cost BETWEEN 35 AND 55\n    group by cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count\n    order by cnt\n    ;",
    "patch_sql": "WITH filtered_d1_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 2001), filtered_web_sales AS (SELECT * FROM web_sales WHERE ws_wholesale_cost BETWEEN 35 AND 55) SELECT cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count, COUNT(*) AS cnt FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN filtered_web_sales ON ws_item_sk = ss_item_sk JOIN filtered_d1_dates AS d1 ON ss_sold_date_sk = d1.d_date_sk JOIN date_dim AS d2 ON ws_sold_date_sk = d2.d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk AND ws_bill_customer_sk = c_customer_sk JOIN inventory ON inv_item_sk = ss_item_sk AND inv_date_sk = ss_sold_date_sk AND inv_quantity_on_hand >= ss_quantity JOIN warehouse ON ws_warehouse_sk = inv_warehouse_sk AND ws_warehouse_sk = w_warehouse_sk JOIN store ON s_state = w_state JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk JOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk WHERE d2.d_date BETWEEN d1.d_date AND (d1.d_date + INTERVAL '30 DAY') AND i_category IN ('Children', 'Jewelry', 'Men') AND i_manager_id IN (21, 22, 38, 39, 46, 47, 66, 67, 74, 93) AND ca_state IN ('AZ', 'KS', 'OH', 'TX', 'WA') GROUP BY cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "WIN",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "489845b8157ae4d136ba9d60c6e04686",
    "patch_cksum": "489845b8157ae4d136ba9d60c6e04686",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query102_agg_i1",
    "patch_id": "t5",
    "iteration": 1,
    "original_sql": "select \n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    hd_vehicle_count,\n    count(*) as cnt\nfrom\n    store_sales,\n    web_sales,\n    date_dim d1,\n    date_dim d2,\n    customer,\n    inventory,\n    store,\n    warehouse,\n    item,\n    customer_demographics,\n    household_demographics,\n    customer_address\n    where\n      ss_item_sk = i_item_sk\n      and ws_item_sk = ss_item_sk\n      and ss_sold_date_sk = d1.d_date_sk\n      and ws_sold_date_sk = d2.d_date_sk\n\t\t\tand d2.d_date between d1.d_date and (d1.d_date + interval '30 day')\n      and ss_customer_sk = c_customer_sk\n      and ws_bill_customer_sk = c_customer_sk\n      and ws_warehouse_sk = inv_warehouse_sk\n      and ws_warehouse_sk = w_warehouse_sk\n      and inv_item_sk = ss_item_sk\n      and inv_date_sk = ss_sold_date_sk\n      and inv_quantity_on_hand >= ss_quantity\n      and s_state = w_state\n      AND i_category IN ('Children', 'Jewelry', 'Men')\n      and i_manager_id IN (21, 22, 38, 39, 46, 47, 66, 67, 74, 93)\n      and c_current_cdemo_sk = cd_demo_sk\n      and c_current_hdemo_sk = hd_demo_sk\n      and c_current_addr_sk = ca_address_sk\n      and ca_state in ('AZ', 'KS', 'OH', 'TX', 'WA')\n      and d1.d_year = 2001\n      and ws_wholesale_cost BETWEEN 35 AND 55\n    group by cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count\n    order by cnt\n    ;",
    "patch_sql": "WITH filtered_warehouse AS (SELECT w_warehouse_sk, w_state FROM warehouse WHERE w_state IN (SELECT s_state FROM store)), filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_sold_date_sk, ss_quantity FROM store_sales INNER JOIN item ON ss_item_sk = i_item_sk INNER JOIN date_dim AS d1 ON ss_sold_date_sk = d1.d_date_sk WHERE d1.d_year = 2001 AND i_category IN ('Children', 'Jewelry', 'Men') AND i_manager_id IN (21, 22, 38, 39, 46, 47, 66, 67, 74, 93)), filtered_web_sales AS (SELECT ws_item_sk, ws_bill_customer_sk, ws_sold_date_sk, ws_warehouse_sk FROM web_sales INNER JOIN date_dim AS d2 ON ws_sold_date_sk = d2.d_date_sk WHERE d2.d_date BETWEEN (SELECT d_date FROM date_dim WHERE d_date_sk = (SELECT ss_sold_date_sk FROM filtered_store_sales LIMIT 1)) AND (SELECT d_date + INTERVAL '30 DAY' FROM date_dim WHERE d_date_sk = (SELECT ss_sold_date_sk FROM filtered_store_sales LIMIT 1)) AND ws_wholesale_cost BETWEEN 35 AND 55) SELECT cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count, COUNT(*) AS cnt FROM filtered_store_sales AS ss JOIN filtered_web_sales AS ws ON ss.ss_item_sk = ws.ws_item_sk JOIN customer AS c ON ss.ss_customer_sk = c.c_customer_sk AND ws.ws_bill_customer_sk = c.c_customer_sk JOIN customer_address AS ca ON c.c_current_addr_sk = ca_address_sk JOIN customer_demographics AS cd ON c.c_current_cdemo_sk = cd_demo_sk JOIN household_demographics AS hd ON c.c_current_hdemo_sk = hd_demo_sk JOIN inventory AS inv ON inv_item_sk = ss.ss_item_sk AND inv_date_sk = ss.ss_sold_date_sk AND inv_warehouse_sk = ws.ws_warehouse_sk JOIN filtered_warehouse AS w ON ws.ws_warehouse_sk = w.w_warehouse_sk JOIN store AS s ON s_state = w.w_state WHERE inv_quantity_on_hand >= ss.ss_quantity AND ca_state IN ('AZ', 'KS', 'OH', 'TX', 'WA') GROUP BY cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "489845b8157ae4d136ba9d60c6e04686",
    "patch_cksum": "489845b8157ae4d136ba9d60c6e04686",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  },
  {
    "query_id": "query102_agg_i2",
    "patch_id": "t3",
    "iteration": 2,
    "original_sql": "select \n    cd_gender,\n    cd_marital_status,\n    cd_education_status,\n    hd_vehicle_count,\n    count(*) as cnt\nfrom\n    store_sales,\n    web_sales,\n    date_dim d1,\n    date_dim d2,\n    customer,\n    inventory,\n    store,\n    warehouse,\n    item,\n    customer_demographics,\n    household_demographics,\n    customer_address\n    where\n      ss_item_sk = i_item_sk\n      and ws_item_sk = ss_item_sk\n      and ss_sold_date_sk = d1.d_date_sk\n      and ws_sold_date_sk = d2.d_date_sk\n\t\t\tand d2.d_date between d1.d_date and (d1.d_date + interval '30 day')\n      and ss_customer_sk = c_customer_sk\n      and ws_bill_customer_sk = c_customer_sk\n      and ws_warehouse_sk = inv_warehouse_sk\n      and ws_warehouse_sk = w_warehouse_sk\n      and inv_item_sk = ss_item_sk\n      and inv_date_sk = ss_sold_date_sk\n      and inv_quantity_on_hand >= ss_quantity\n      and s_state = w_state\n      AND i_category IN ('Men', 'Shoes', 'Sports')\n      and i_manager_id IN (6, 11, 16, 17, 19, 28, 47, 82, 88, 98)\n      and c_current_cdemo_sk = cd_demo_sk\n      and c_current_hdemo_sk = hd_demo_sk\n      and c_current_addr_sk = ca_address_sk\n      and ca_state in ('AR', 'CA', 'KS', 'NY', 'VA')\n      and d1.d_year = 1998\n      and ws_wholesale_cost BETWEEN 76 AND 96\n    group by cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count\n    order by cnt\n    ;",
    "patch_sql": "WITH filtered_items AS (SELECT i_item_sk FROM item WHERE i_category IN ('Men', 'Shoes', 'Sports') AND i_manager_id IN (6, 11, 16, 17, 19, 28, 47, 82, 88, 98)), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_state IN ('AR', 'CA', 'KS', 'NY', 'VA')), filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 1998), warehouse_state_map AS (SELECT w_warehouse_sk, w_state FROM warehouse) SELECT cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count, COUNT(*) AS cnt FROM store_sales JOIN filtered_items ON ss_item_sk = i_item_sk JOIN web_sales ON ws_item_sk = ss_item_sk AND ws_bill_customer_sk = ss_customer_sk JOIN filtered_dates AS d1 ON ss_sold_date_sk = d1.d_date_sk JOIN date_dim AS d2 ON ws_sold_date_sk = d2.d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN inventory ON inv_item_sk = ss_item_sk AND inv_date_sk = ss_sold_date_sk AND inv_quantity_on_hand >= ss_quantity JOIN warehouse_state_map AS w ON ws_warehouse_sk = w.w_warehouse_sk AND inv_warehouse_sk = w.w_warehouse_sk JOIN store ON s_state = w.w_state JOIN customer_demographics ON c_current_cdemo_sk = cd_demo_sk JOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk JOIN filtered_addresses ON c_current_addr_sk = ca_address_sk WHERE d2.d_date BETWEEN d1.d_date AND (d1.d_date + INTERVAL '30 DAY') AND ws_wholesale_cost BETWEEN 76 AND 96 GROUP BY cd_gender, cd_marital_status, cd_education_status, hd_vehicle_count ORDER BY cnt;",
    "ground_truth": "EQUIVALENT",
    "gt_status": "REGRESSION",
    "gt_error": "",
    "gt_semantic_passed": true,
    "orig_rows": 2,
    "patch_rows": 2,
    "orig_cksum": "1a9f0bb1e918c7033f595a67fb41ec30",
    "patch_cksum": "1a9f0bb1e918c7033f595a67fb41ec30",
    "orig_err": null,
    "patch_err": null,
    "witness_verdict": "MATCH"
  }
]