TABLES:
  catalog_sales
  customer
  date_dim
  item
  store_sales
  web_sales

JOINS:
  store_sales.ss_sold_date_sk = date_dim.d_date_sk
  store_sales.ss_item_sk = item.i_item_sk
  store_sales.ss_customer_sk = customer.c_customer_sk
  catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
  web_sales.ws_sold_date_sk = date_dim.d_date_sk

FILTERS:
  item.i_category IN ('Men', 'Music', 'Sports')
  item.i_manager_id BETWEEN 44 AND 63
  date_dim.d_year = 1999
  store_sales.ss_wholesale_cost BETWEEN 26 AND 36
  customer.c_birth_year BETWEEN 1987 AND 1993
  catalog_sales.cs_wholesale_cost BETWEEN 26 AND 36
  catalog_sales.cs_bill_customer_sk IN ()
  catalog_sales.cs_item_sk IN ()
  date_dim.d_moy = 5
  web_sales.ws_wholesale_cost BETWEEN 26 AND 36
  web_sales.ws_bill_customer_sk IN ()
  web_sales.ws_item_sk IN ()

AGGREGATES:
  Correlated: SUM(ss_quantity * ss_sales_price) > (SELECT *)
  GROUP BY: SUBSTRING(i_item_desc, 1, 30), item.i_item_sk, date_dim.d_date
  GROUP BY: customer.c_customer_sk

CTEs:
  frequent_ss_items:
    FROM: store_sales, date_dim, item
    WHERE: item.i_manager_id BETWEEN 44 AND 63, date_dim.d_year = 1999, store_sales.ss_sold_date_sk = date_dim.d_date_sk (JOIN), store_sales.ss_item_sk = item.i_item_sk (JOIN)
    GROUP BY: SUBSTRING(i_item_desc, 1, 30), item.i_item_sk, date_dim.d_date
    OUTPUT: itemdesc = SUBSTRING(i_item_desc, 1, 30), item_sk = item.i_item_sk, solddate = date_dim.d_date, cnt = COUNT(*)
  max_store_sales:
    FROM: store_sales, customer, date_dim
    WHERE: store_sales.ss_wholesale_cost BETWEEN 26 AND 36, date_dim.d_year = 1999, store_sales.ss_customer_sk = customer.c_customer_sk (JOIN), store_sales.ss_sold_date_sk = date_dim.d_date_sk (JOIN)
    GROUP BY: customer.c_customer_sk
    OUTPUT: tpcds_cmax = MAX(csales)
  best_ss_customer:
    FROM: store_sales, customer
    WHERE: store_sales.ss_customer_sk = customer.c_customer_sk (JOIN), customer.c_birth_year BETWEEN 1987 AND 1993
    GROUP BY: customer.c_customer_sk
    OUTPUT: customer.c_customer_sk, ssales = SUM(ss_quantity * ss_sales_price)

COLUMNS NEEDED (table.column : type):
  catalog_sales: cs_bill_customer_sk (INTEGER), cs_item_sk (INTEGER), cs_sold_date_sk (INTEGER), cs_wholesale_cost (DECIMAL(7)
  customer: c_birth_year (INTEGER), c_customer_sk (INTEGER)
  date_dim: d_date (DATE), d_date_sk (INTEGER), d_moy (INTEGER), d_year (INTEGER)
  item: i_category (VARCHAR), i_item_sk (INTEGER), i_manager_id (INTEGER)
  store_sales: ss_customer_sk (INTEGER), ss_item_sk (INTEGER), ss_quantity (INTEGER), ss_sales_price (DECIMAL(7), ss_sold_date_sk (INTEGER), ss_wholesale_cost (DECIMAL(7)
  web_sales: ws_bill_customer_sk (INTEGER), ws_item_sk (INTEGER), ws_sold_date_sk (INTEGER), ws_wholesale_cost (DECIMAL(7)