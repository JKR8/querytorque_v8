TABLES:
  catalog_sales
  date_dim (alias: d1)
  date_dim (alias: d2)
  date_dim (alias: d3)
  item
  store
  store_returns
  store_sales

JOINS:
  catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
  store_returns.sr_item_sk = catalog_sales.cs_item_sk
  store_returns.sr_customer_sk = catalog_sales.cs_bill_customer_sk
  store_returns.sr_returned_date_sk = date_dim.d_date_sk
  store_sales.ss_ticket_number = store_returns.sr_ticket_number
  store_sales.ss_item_sk = store_returns.sr_item_sk
  store_sales.ss_customer_sk = store_returns.sr_customer_sk
  store.s_store_sk = store_sales.ss_store_sk
  item.i_item_sk = store_sales.ss_item_sk
  date_dim.d_date_sk = store_sales.ss_sold_date_sk

FILTERS:
  date_dim.d_year = 2000
  date_dim.d_moy BETWEEN 2 AND 2 + 2
  date_dim.d_moy = 2

AGGREGATES:
  GROUP BY: item.i_item_id, item.i_item_desc, store.s_store_id, store.s_store_name

COLUMNS NEEDED (table.column : type):
  catalog_sales: cs_bill_customer_sk (INTEGER), cs_item_sk (INTEGER), cs_net_profit (DECIMAL(7), cs_sold_date_sk (INTEGER)
  date_dim: d_date_sk (INTEGER), d_moy (INTEGER), d_year (INTEGER)
  item: i_item_desc (VARCHAR), i_item_id (VARCHAR), i_item_sk (INTEGER)
  store: s_store_id (VARCHAR), s_store_name (VARCHAR), s_store_sk (INTEGER)
  store_returns: sr_customer_sk (INTEGER), sr_item_sk (INTEGER), sr_net_loss (DECIMAL(7), sr_returned_date_sk (INTEGER), sr_ticket_number (INTEGER)
  store_sales: ss_customer_sk (INTEGER), ss_item_sk (INTEGER), ss_net_profit (DECIMAL(7), ss_sold_date_sk (INTEGER), ss_store_sk (INTEGER), ss_ticket_number (INTEGER)