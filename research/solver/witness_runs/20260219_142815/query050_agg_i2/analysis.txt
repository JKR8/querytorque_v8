TABLES:
  date_dim (alias: d1)
  date_dim (alias: d2)
  store
  store_returns
  store_sales

JOINS:
  store_sales.ss_store_sk = store.s_store_sk
  store_sales.ss_customer_sk = store_returns.sr_customer_sk
  store_returns.sr_returned_date_sk = date_dim.d_date_sk
  store_sales.ss_sold_date_sk = date_dim.d_date_sk
  store_sales.ss_item_sk = store_returns.sr_item_sk
  store_sales.ss_ticket_number = store_returns.sr_ticket_number

FILTERS:
  date_dim.d_date BETWEEN (d2.d_date - INTERVAL '120' DAY) AND date_dim.d_date
  date_dim.d_year = 1999
  date_dim.d_moy = 7

AGGREGATES:
  GROUP BY: store.s_store_name, store.s_company_id, store.s_street_number, store.s_street_name, store.s_street_type, store.s_suite_number, store.s_city, store.s_county, store.s_state, store.s_zip

COLUMNS NEEDED (table.column : type):
  date_dim: d_date (DATE), d_date_sk (INTEGER), d_moy (INTEGER), d_year (INTEGER)
  store: s_city (VARCHAR), s_company_id (INTEGER), s_county (VARCHAR), s_state (VARCHAR), s_store_name (VARCHAR), s_store_sk (INTEGER), s_street_name (VARCHAR), s_street_number (VARCHAR), s_street_type (VARCHAR), s_suite_number (VARCHAR), s_zip (VARCHAR)
  store_returns: sr_customer_sk (INTEGER), sr_item_sk (INTEGER), sr_returned_date_sk (INTEGER), sr_ticket_number (INTEGER)
  store_sales: ss_customer_sk (INTEGER), ss_item_sk (INTEGER), ss_sold_date_sk (INTEGER), ss_store_sk (INTEGER), ss_ticket_number (INTEGER)