TABLES:
  catalog_sales
  customer
  customer_address
  date_dim
  item
  store
  store_sales
  web_sales

JOINS:
  customer.c_customer_sk = cs_or_ws_sales.customer_sk
  customer.c_customer_sk = store_sales.ss_customer_sk
  store_sales.ss_sold_date_sk = date_dim.d_date_sk
  customer_address.ca_state = store.s_state
  customer.c_current_addr_sk = customer_address.ca_address_sk
  customer_address.ca_county = store.s_county

FILTERS:
  customer.c_birth_year BETWEEN 1942 AND 1955
  wholesale_cost BETWEEN 70 AND 100
  date_dim.d_year = 1998
  date_dim.d_moy = 5
  item.i_class = 'curtains/drapes'
  item.i_category = 'Home'
  sold_date_sk = date_dim.d_date_sk
  item_sk = item.i_item_sk
  date_dim.d_month_seq BETWEEN (SELECT DISTINCT d_month_seq + 1 FROM date_dim WHERE d_year = 1998 AND d_moy = 5) AND (SELECT DISTINCT d_month_seq + 3 FROM date_dim WHERE d_year = 1998 AND d_moy = 5)
  store.s_state IN ('AR', 'GA', 'IN', 'KS', 'KY', 'NC', 'OH', 'PA', 'SD', 'VA')
  store_sales.ss_wholesale_cost BETWEEN 70 AND 100

AGGREGATES:
  GROUP BY: segment
  GROUP BY: customer.c_customer_sk

CTEs:
  my_customers:
    FROM: item, date_dim, customer, catalog_sales, web_sales
    WHERE: customer.c_birth_year BETWEEN 1942 AND 1955, wholesale_cost BETWEEN 70 AND 100, date_dim.d_year = 1998, date_dim.d_moy = 5, customer.c_customer_sk = cs_or_ws_sales.customer_sk (JOIN), item.i_class = 'curtains/drapes', item.i_category = 'Home', sold_date_sk = date_dim.d_date_sk (JOIN), item_sk = item.i_item_sk (JOIN)
    OUTPUT: customer.c_customer_sk, customer.c_current_addr_sk
  my_revenue:
    FROM: store_sales, customer_address, store, date_dim, date_dim, date_dim
    WHERE: date_dim.d_month_seq BETWEEN (SELECT DISTINCT d_month_seq + 1 FROM date_dim WHERE d_year = 1998 AND d_moy = 5) AND (SELECT DISTINCT d_month_seq + 3 FROM date_dim WHERE d_year = 1998 AND d_moy = 5), store_sales.ss_wholesale_cost BETWEEN 70 AND 100, customer.c_customer_sk = store_sales.ss_customer_sk (JOIN), store_sales.ss_sold_date_sk = date_dim.d_date_sk (JOIN), customer_address.ca_state = store.s_state (JOIN), date_dim.d_year = 1998, date_dim.d_moy = 5, date_dim.d_year = 1998, date_dim.d_moy = 5, customer.c_current_addr_sk = customer_address.ca_address_sk (JOIN), customer_address.ca_county = store.s_county (JOIN)
    GROUP BY: customer.c_customer_sk
    OUTPUT: customer.c_customer_sk, revenue = SUM(ss_ext_sales_price)
  segments:
    FROM: 
    OUTPUT: segment = CAST((revenue / 50) AS INT)

COLUMNS NEEDED (table.column : type):
  customer: c_birth_year (INTEGER), c_current_addr_sk (INTEGER), c_customer_sk (INTEGER)
  customer_address: ca_address_sk (INTEGER), ca_county (VARCHAR), ca_state (VARCHAR)
  date_dim: d_date_sk (INTEGER), d_month_seq (INTEGER), d_moy (INTEGER), d_year (INTEGER)
  item: i_category (VARCHAR), i_class (VARCHAR), i_item_sk (INTEGER)
  store: s_county (VARCHAR), s_state (VARCHAR)
  store_sales: ss_customer_sk (INTEGER), ss_ext_sales_price (DECIMAL(7), ss_sold_date_sk (INTEGER), ss_wholesale_cost (DECIMAL(7)