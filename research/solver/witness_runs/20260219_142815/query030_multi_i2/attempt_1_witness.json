{
  "reasoning": "Need at least 2 rows in final result. The query groups by wr_returning_customer_sk, ca_state, wr_reason_sk in CTE. The correlated subquery compares ctr_total_return > avg(ctr_total_return)*1.2 for same ctr_state. To get 2 final rows, we need at least 2 groups (different customers) that satisfy the condition, or same customer with different states/reasons. Simpler: create 2 groups in same state (e.g., 'OK') each with 2 rows in CTE, where one row's total is high enough to exceed 1.2*average of its group. For state 'OK', create two customers (sk 1000, 1001) each with two CTE rows (reason 20 and 36). For customer 1000: two CTE rows with totals 1000 and 2000. Average = (1000+2000)/2 = 1500, 1.2*1500 = 1800. Row with 2000 > 1800 qualifies. For customer 1001: totals 1200 and 1800. Average = (1200+1800)/2 = 1500, 1.2*1500 = 1800. Row with 1800 is not > 1800, so need adjust: use 1200 and 2000. Average = (1200+2000)/2 = 1600, 1.2*1600 = 1920. 2000 > 1920 qualifies. So both customers have one qualifying row each. Ensure filters: birth_year between 1985-1991, ca_state in list, i_manager_id 68-77, wr_return_amt/wr_return_quantity between 242-271 (denominator >0). Use denominator 1 for simplicity: wr_return_amt between 242 and 271. Use i_manager_id 70. Use date_dim d_year=2002. Ensure join keys match.",
  "tables": {
    "customer": {
      "columns": [
        "c_customer_sk",
        "c_customer_id",
        "c_salutation",
        "c_first_name",
        "c_last_name",
        "c_preferred_cust_flag",
        "c_birth_day",
        "c_birth_month",
        "c_birth_year",
        "c_birth_country",
        "c_login",
        "c_email_address",
        "c_last_review_date_sk",
        "c_current_addr_sk"
      ],
      "rows": [
        [
          1000,
          "C1000",
          "Mr.",
          "John",
          "Doe",
          "Y",
          1,
          1,
          1986,
          "USA",
          "jdoe",
          "jdoe@email.com",
          null,
          2000
        ],
        [
          1001,
          "C1001",
          "Ms.",
          "Jane",
          "Smith",
          "N",
          2,
          2,
          1987,
          "USA",
          "jsmith",
          "jsmith@email.com",
          null,
          2001
        ]
      ]
    },
    "customer_address": {
      "columns": [
        "ca_address_sk",
        "ca_state"
      ],
      "rows": [
        [
          2000,
          "OK"
        ],
        [
          2001,
          "OK"
        ]
      ]
    },
    "date_dim": {
      "columns": [
        "d_date_sk",
        "d_year"
      ],
      "rows": [
        [
          3000,
          2002
        ]
      ]
    },
    "item": {
      "columns": [
        "i_item_sk",
        "i_manager_id"
      ],
      "rows": [
        [
          4000,
          70
        ]
      ]
    },
    "web_returns": {
      "columns": [
        "wr_returning_customer_sk",
        "wr_returning_addr_sk",
        "wr_item_sk",
        "wr_reason_sk",
        "wr_return_amt",
        "wr_return_quantity",
        "wr_returned_date_sk"
      ],
      "rows": [
        [
          1000,
          2000,
          4000,
          20,
          250.0,
          1,
          3000
        ],
        [
          1000,
          2000,
          4000,
          36,
          2000.0,
          1,
          3000
        ],
        [
          1001,
          2001,
          4000,
          20,
          242.0,
          1,
          3000
        ],
        [
          1001,
          2001,
          4000,
          36,
          2000.0,
          1,
          3000
        ]
      ]
    }
  }
}