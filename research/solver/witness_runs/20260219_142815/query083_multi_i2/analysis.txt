TABLES:
  catalog_returns
  date_dim
  item
  store_returns
  web_returns

JOINS:
  sr_items.item_id = cr_items.item_id
  sr_items.item_id = wr_items.item_id
  store_returns.sr_returned_date_sk = date_dim.d_date_sk
  store_returns.sr_item_sk = item.i_item_sk
  catalog_returns.cr_returned_date_sk = date_dim.d_date_sk
  catalog_returns.cr_item_sk = item.i_item_sk
  web_returns.wr_returned_date_sk = date_dim.d_date_sk
  web_returns.wr_item_sk = item.i_item_sk

FILTERS:
  store_returns.sr_reason_sk IN (7, 18, 19, 22, 36)
  sr_return_amt / sr_return_quantity BETWEEN 253 AND 282
  item.i_manager_id BETWEEN 15 AND 24
  item.i_category IN ('Children', 'Electronics')
  date_dim.d_date IN ()
  date_dim.d_month_seq IN ()
  date_dim.d_date IN ('1999-01-10', '1999-06-17', '1999-08-04', '1999-11-05')
  catalog_returns.cr_reason_sk IN (7, 18, 19, 22, 36)
  cr_return_amount / cr_return_quantity BETWEEN 253 AND 282
  web_returns.wr_reason_sk IN (7, 18, 19, 22, 36)
  wr_return_amt / wr_return_quantity BETWEEN 253 AND 282

AGGREGATES:
  GROUP BY: item.i_item_id

CTEs:
  sr_items:
    FROM: store_returns, item, date_dim, date_dim, date_dim
    WHERE: sr_return_amt / sr_return_quantity BETWEEN 253 AND 282, item.i_manager_id BETWEEN 15 AND 24, store_returns.sr_returned_date_sk = date_dim.d_date_sk (JOIN), store_returns.sr_item_sk = item.i_item_sk (JOIN)
    GROUP BY: item.i_item_id
    OUTPUT: item_id = item.i_item_id, sr_item_qty = SUM(sr_return_quantity)
  cr_items:
    FROM: catalog_returns, item, date_dim, date_dim, date_dim
    WHERE: cr_return_amount / cr_return_quantity BETWEEN 253 AND 282, item.i_manager_id BETWEEN 15 AND 24, catalog_returns.cr_returned_date_sk = date_dim.d_date_sk (JOIN), catalog_returns.cr_item_sk = item.i_item_sk (JOIN)
    GROUP BY: item.i_item_id
    OUTPUT: item_id = item.i_item_id, cr_item_qty = SUM(cr_return_quantity)
  wr_items:
    FROM: web_returns, item, date_dim, date_dim, date_dim
    WHERE: wr_return_amt / wr_return_quantity BETWEEN 253 AND 282, item.i_manager_id BETWEEN 15 AND 24, web_returns.wr_returned_date_sk = date_dim.d_date_sk (JOIN), web_returns.wr_item_sk = item.i_item_sk (JOIN)
    GROUP BY: item.i_item_id
    OUTPUT: item_id = item.i_item_id, wr_item_qty = SUM(wr_return_quantity)

NOTES:
  Division in filter: sr_return_amt / sr_return_quantity — denominator must be > 0
  Division in filter: cr_return_amount / cr_return_quantity — denominator must be > 0
  Division in filter: wr_return_amt / wr_return_quantity — denominator must be > 0

COLUMNS NEEDED (table.column : type):
  catalog_returns: cr_item_qty (?), cr_item_sk (INTEGER), cr_reason_sk (INTEGER), cr_return_amount (DECIMAL(7), cr_return_quantity (INTEGER), cr_returned_date_sk (INTEGER)
  date_dim: d_date (DATE), d_date_sk (INTEGER), d_month_seq (INTEGER)
  item: i_category (VARCHAR), i_item_id (VARCHAR), i_item_sk (INTEGER), i_manager_id (INTEGER)
  store_returns: sr_item_qty (?), sr_item_sk (INTEGER), sr_reason_sk (INTEGER), sr_return_amt (DECIMAL(7), sr_return_quantity (INTEGER), sr_returned_date_sk (INTEGER)
  web_returns: wr_item_qty (?), wr_item_sk (INTEGER), wr_reason_sk (INTEGER), wr_return_amt (DECIMAL(7), wr_return_quantity (INTEGER), wr_returned_date_sk (INTEGER)