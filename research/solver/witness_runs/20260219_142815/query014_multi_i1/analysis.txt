TABLES:
  catalog_sales
  date_dim (alias: d1)
  date_dim (alias: d2)
  date_dim (alias: d3)
  date_dim
  item (alias: ics)
  item (alias: iss)
  item
  item (alias: iws)
  store_sales
  web_sales

JOINS:
  this_year.i_category_id = last_year.i_category_id
  this_year.i_brand_id = last_year.i_brand_id
  this_year.i_class_id = last_year.i_class_id
  store_sales.ss_sold_date_sk = date_dim.d_date_sk
  store_sales.ss_item_sk = item.i_item_sk
  web_sales.ws_sold_date_sk = date_dim.d_date_sk
  web_sales.ws_item_sk = item.i_item_sk
  catalog_sales.cs_item_sk = item.i_item_sk
  catalog_sales.cs_sold_date_sk = date_dim.d_date_sk

FILTERS:
  store_sales.ss_wholesale_cost BETWEEN 35 AND 55
  item.i_manager_id BETWEEN 91 AND 100
  item.i_category IN ('Electronics', 'Jewelry', 'Men')
  date_dim.d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 + 1 AND d_moy = 12 AND d_dom = 20)
  store_sales.ss_item_sk IN ()
  date_dim.d_dom = 20
  date_dim.d_year = 1999 + 1
  date_dim.d_moy = 12
  date_dim.d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_year = 1999 AND d_moy = 12 AND d_dom = 20)
  date_dim.d_year = 1999
  item.i_category_id = category_id
  item.i_brand_id = brand_id
  item.i_class_id = class_id
  date_dim.d_year BETWEEN 1999 AND 1999 + 2
  web_sales.ws_wholesale_cost BETWEEN 35 AND 55
  catalog_sales.cs_wholesale_cost BETWEEN 35 AND 55

AGGREGATES:
  Correlated: SUM(ss_quantity * ss_list_price) > (SELECT average_sales)
  GROUP BY: item.i_brand_id, item.i_class_id, item.i_category_id

CTEs:
  cross_items:
    FROM: item, web_sales, item, date_dim, store_sales, item, date_dim, catalog_sales, item, date_dim
    WHERE: item.i_manager_id BETWEEN 91 AND 100, item.i_category_id = category_id (JOIN), item.i_brand_id = brand_id (JOIN), item.i_class_id = class_id (JOIN)
    OUTPUT: ss_item_sk = item.i_item_sk
  avg_sales:
    FROM: web_sales, date_dim, store_sales, date_dim, catalog_sales, date_dim
    WHERE: date_dim.d_year BETWEEN 1999 AND 1999 + 2, web_sales.ws_sold_date_sk = date_dim.d_date_sk (JOIN), web_sales.ws_wholesale_cost BETWEEN 35 AND 55
    OUTPUT: average_sales = AVG(quantity * list_price)

COLUMNS NEEDED (table.column : type):
  catalog_sales: cs_item_sk (INTEGER), cs_sold_date_sk (INTEGER), cs_wholesale_cost (DECIMAL(7)
  date_dim: d_date_sk (INTEGER), d_dom (INTEGER), d_moy (INTEGER), d_week_seq (INTEGER), d_year (INTEGER)
  item: i_brand_id (INTEGER), i_category (VARCHAR), i_category_id (INTEGER), i_class_id (INTEGER), i_item_sk (INTEGER), i_manager_id (INTEGER)
  store_sales: ss_item_sk (INTEGER), ss_list_price (DECIMAL(7), ss_quantity (INTEGER), ss_sold_date_sk (INTEGER), ss_wholesale_cost (DECIMAL(7)
  web_sales: ws_item_sk (INTEGER), ws_sold_date_sk (INTEGER), ws_wholesale_cost (DECIMAL(7)