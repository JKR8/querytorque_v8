{
  "reasoning": "We need at least 2 rows in final union. Each subquery (catalog_sales, web_sales) must join with frequent_ss_items and best_ss_customer. We'll create one frequent_ss_items group (item_sk=1000, solddate='1998-10-01') with count=5 (>4). One best_ss_customer (c_customer_sk=2000) with ssales > 95% of max_store_sales. Compute max_store_sales: need csales for customer 2000 and maybe another. Let csales for customer 2000 = 1000, for customer 2001 = 500. Then max_store_sales = 1000. 95% of 1000 = 950. So customer 2000's ssales must be >950, set to 1000. Customer 2001's ssales = 500 (doesn't qualify). Then catalog_sales and web_sales each need at least one row with cs_item_sk=1000, cs_bill_customer_sk=2000, ws_item_sk=1000, ws_bill_customer_sk=2000, matching date_dim for 1998-10, wholesale costs between 11 and 21. We'll create two catalog_sales rows and one web_sales row (or vice versa) to ensure final union has at least 2 rows.",
  "tables": {
    "catalog_sales": {
      "columns": ["cs_bill_customer_sk", "cs_item_sk", "cs_sold_date_sk", "cs_wholesale_cost", "cs_quantity", "cs_list_price"],
      "rows": [
        [2000, 1000, 3000, 15.0, 1, 100.0],
        [2000, 1000, 3000, 15.0, 2, 200.0]
      ]
    },
    "customer": {
      "columns": ["c_birth_year", "c_customer_sk"],
      "rows": [
        [1935, 2000],
        [1936, 2001]
      ]
    },
    "date_dim": {
      "columns": ["d_date", "d_date_sk", "d_moy", "d_year"],
      "rows": [
        ["1998-10-01", 3000, 10, 1998]
      ]
    },
    "item": {
      "columns": ["i_category", "i_item_sk", "i_manager_id", "i_item_desc"],
      "rows": [
        ["Children", 1000, 85, "Some description that is long enough for substring"]
      ]
    },
    "store_sales": {
      "columns": ["ss_customer_sk", "ss_item_sk", "ss_quantity", "ss_sales_price", "ss_sold_date_sk", "ss_wholesale_cost"],
      "rows": [
        [2000, 1000, 10, 100.0, 3000, 15.0],
        [2000, 1000, 10, 100.0, 3000, 15.0],
        [2000, 1000, 10, 100.0, 3000, 15.0],
        [2000, 1000, 10, 100.0, 3000, 15.0],
        [2000, 1000, 10, 100.0, 3000, 15.0],
        [2001, 1000, 5, 100.0, 3000, 15.0],
        [2001, 1000, 5, 100.0, 3000, 15.0],
        [2001, 1000, 5, 100.0, 3000, 15.0],
        [2001, 1000, 5, 100.0, 3000, 15.0],
        [2001, 1000, 5, 100.0, 3000, 15.0]
      ]
    },
    "web_sales": {
      "columns": ["ws_bill_customer_sk", "ws_item_sk", "ws_sold_date_sk", "ws_wholesale_cost", "ws_quantity", "ws_list_price"],
      "rows": [
        [2000, 1000, 3000, 15.0, 1, 150.0]
      ]
    }
  }
}