{
  "reasoning": "Need to fix ambiguous d_week_seq reference in ORDER BY clause. Also need to ensure all joins have matching keys and filters are satisfied. For d3.d_date > d1.d_date + INTERVAL '3' DAY, need d3.d_date_sk > d1.d_date_sk by at least 4 days. Create two groups with same i_item_desc, w_warehouse_name, d_week_seq but different promotion status. Ensure inventory.inv_quantity_on_hand < catalog_sales.cs_quantity.",
  "tables": {
    "catalog_sales": {
      "columns": [
        "cs_item_sk",
        "cs_order_number",
        "cs_quantity",
        "cs_wholesale_cost",
        "cs_bill_cdemo_sk",
        "cs_bill_hdemo_sk",
        "cs_sold_date_sk",
        "cs_ship_date_sk",
        "cs_promo_sk"
      ],
      "rows": [
        [
          1000,
          1000,
          100,
          40.0,
          1000,
          1000,
          1000,
          1003,
          null
        ],
        [
          1001,
          1001,
          100,
          45.0,
          1001,
          1001,
          1002,
          1005,
          1000
        ]
      ]
    },
    "inventory": {
      "columns": [
        "inv_item_sk",
        "inv_warehouse_sk",
        "inv_date_sk",
        "inv_quantity_on_hand"
      ],
      "rows": [
        [
          1000,
          1000,
          1000,
          50
        ],
        [
          1001,
          1001,
          1002,
          50
        ]
      ]
    },
    "warehouse": {
      "columns": [
        "w_warehouse_sk",
        "w_warehouse_name"
      ],
      "rows": [
        [
          1000,
          "warehouse1"
        ],
        [
          1001,
          "warehouse2"
        ]
      ]
    },
    "item": {
      "columns": [
        "i_item_sk",
        "i_category",
        "i_item_desc"
      ],
      "rows": [
        [
          1000,
          "Children",
          "desc1"
        ],
        [
          1001,
          "Jewelry",
          "desc2"
        ]
      ]
    },
    "customer_demographics": {
      "columns": [
        "cd_demo_sk",
        "cd_dep_count",
        "cd_marital_status"
      ],
      "rows": [
        [
          1000,
          9,
          "U"
        ],
        [
          1001,
          10,
          "U"
        ]
      ]
    },
    "household_demographics": {
      "columns": [
        "hd_demo_sk",
        "hd_buy_potential"
      ],
      "rows": [
        [
          1000,
          ">10000"
        ],
        [
          1001,
          ">10000"
        ]
      ]
    },
    "date_dim": {
      "columns": [
        "d_date_sk",
        "d_date",
        "d_week_seq",
        "d_year"
      ],
      "rows": [
        [
          1000,
          "1998-01-01",
          1,
          1998
        ],
        [
          1001,
          "1998-01-02",
          1,
          1998
        ],
        [
          1002,
          "1998-01-03",
          1,
          1998
        ],
        [
          1003,
          "1998-01-05",
          1,
          1998
        ],
        [
          1004,
          "1998-01-06",
          2,
          1998
        ],
        [
          1005,
          "1998-01-07",
          2,
          1998
        ],
        [
          1006,
          "1998-01-08",
          2,
          1998
        ],
        [
          1007,
          "1998-01-10",
          2,
          1998
        ]
      ]
    },
    "promotion": {
      "columns": [
        "p_promo_sk"
      ],
      "rows": [
        [
          1000
        ]
      ]
    },
    "catalog_returns": {
      "columns": [
        "cr_item_sk",
        "cr_order_number"
      ],
      "rows": []
    }
  }
}