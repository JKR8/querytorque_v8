TABLES:
  customer
  customer_address
  date_dim (alias: d1)
  date_dim (alias: d2)
  household_demographics
  item
  store_returns
  store_sales
  web_sales

JOINS:
  web_sales.ws_sold_date_sk = date_dim.d_date_sk
  store_returns.sr_returned_date_sk = date_dim.d_date_sk
  item.i_item_sk = store_sales.ss_item_sk
  store_returns.sr_item_sk = web_sales.ws_item_sk
  store_sales.ss_item_sk = store_returns.sr_item_sk
  customer.c_current_hdemo_sk = household_demographics.hd_demo_sk
  customer.c_current_addr_sk = customer_address.ca_address_sk
  store_sales.ss_customer_sk = customer.c_customer_sk
  store_sales.ss_ticket_number = store_returns.sr_ticket_number
  store_sales.ss_customer_sk = web_sales.ws_bill_customer_sk

FILTERS:
  ss_sales_price / ss_list_price BETWEEN 76 * 0.01 AND 96 * 0.01
  household_demographics.hd_buy_potential = '501-1000'
  household_demographics.hd_income_band_sk BETWEEN 8 AND 14
  date_dim.d_year = 2000
  customer_address.ca_state IN ('AR', 'GA', 'IN', 'KY', 'VA')
  date_dim.d_date BETWEEN date_dim.d_date AND (d1.d_date + INTERVAL '90' DAY)
  item.i_category IN ('Children', 'Home', 'Women')

AGGREGATES:
  GROUP BY: customer.c_customer_sk, customer.c_first_name, customer.c_last_name

NOTES:
  Division in filter: ss_sales_price / ss_list_price â€” denominator must be > 0

COLUMNS NEEDED (table.column : type):
  customer: c_current_addr_sk (INTEGER), c_current_hdemo_sk (INTEGER), c_customer_sk (INTEGER), c_first_name (VARCHAR), c_last_name (VARCHAR)
  customer_address: ca_address_sk (INTEGER), ca_state (VARCHAR)
  date_dim: d_date (DATE), d_date_sk (INTEGER), d_year (INTEGER)
  household_demographics: hd_buy_potential (VARCHAR), hd_demo_sk (INTEGER), hd_income_band_sk (INTEGER)
  item: i_category (VARCHAR), i_item_sk (INTEGER)
  store_returns: sr_item_sk (INTEGER), sr_returned_date_sk (INTEGER), sr_ticket_number (INTEGER)
  store_sales: ss_customer_sk (INTEGER), ss_item_sk (INTEGER), ss_list_price (DECIMAL(7), ss_sales_price (DECIMAL(7), ss_ticket_number (INTEGER)
  web_sales: ws_bill_customer_sk (INTEGER), ws_item_sk (INTEGER), ws_sold_date_sk (INTEGER)