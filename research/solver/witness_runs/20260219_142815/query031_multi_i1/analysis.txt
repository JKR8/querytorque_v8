TABLES:
  customer_address
  date_dim
  item
  store_sales
  web_sales

JOINS:
  ss.ca_county = ws.ca_county
  store_sales.ss_item_sk = item.i_item_sk
  store_sales.ss_sold_date_sk = date_dim.d_date_sk
  store_sales.ss_addr_sk = customer_address.ca_address_sk
  web_sales.ws_item_sk = item.i_item_sk
  web_sales.ws_sold_date_sk = date_dim.d_date_sk
  web_sales.ws_bill_addr_sk = customer_address.ca_address_sk

FILTERS:
  ws.d_year = 1998
  ws.d_qoy = 3
  ws.web_sales > 0
  ss.store_sales > 0
  ws.d_qoy = 2
  ws.d_qoy = 1
  ss.d_year = 1998
  ss.d_qoy = 3
  ss.d_qoy = 2
  ss.d_qoy = 1
  customer_address.ca_state IN ('IA', 'IL')
  store_sales.ss_list_price BETWEEN 86 AND 100
  item.i_manager_id BETWEEN 8 AND 27
  item.i_color IN ('navajo', 'orchid')
  web_sales.ws_list_price BETWEEN 86 AND 100

AGGREGATES:
  GROUP BY: customer_address.ca_county, date_dim.d_qoy, date_dim.d_year

CTEs:
  ss:
    FROM: store_sales, date_dim, customer_address, item
    WHERE: store_sales.ss_list_price BETWEEN 86 AND 100, item.i_manager_id BETWEEN 8 AND 27, store_sales.ss_item_sk = item.i_item_sk (JOIN), store_sales.ss_sold_date_sk = date_dim.d_date_sk (JOIN), store_sales.ss_addr_sk = customer_address.ca_address_sk (JOIN)
    GROUP BY: customer_address.ca_county, date_dim.d_qoy, date_dim.d_year
    OUTPUT: customer_address.ca_county, date_dim.d_qoy, date_dim.d_year, store_sales = SUM(ss_ext_sales_price)
  ws:
    FROM: web_sales, date_dim, customer_address, item
    WHERE: web_sales.ws_list_price BETWEEN 86 AND 100, item.i_manager_id BETWEEN 8 AND 27, web_sales.ws_item_sk = item.i_item_sk (JOIN), web_sales.ws_sold_date_sk = date_dim.d_date_sk (JOIN), web_sales.ws_bill_addr_sk = customer_address.ca_address_sk (JOIN)
    GROUP BY: customer_address.ca_county, date_dim.d_qoy, date_dim.d_year
    OUTPUT: customer_address.ca_county, date_dim.d_qoy, date_dim.d_year, web_sales = SUM(ws_ext_sales_price)

COLUMNS NEEDED (table.column : type):
  customer_address: ca_address_sk (INTEGER), ca_county (VARCHAR), ca_state (VARCHAR)
  date_dim: d_date_sk (INTEGER), d_qoy (INTEGER), d_year (INTEGER)
  item: i_color (VARCHAR), i_item_sk (INTEGER), i_manager_id (INTEGER)
  store_sales: ss_addr_sk (INTEGER), ss_ext_sales_price (DECIMAL(7), ss_item_sk (INTEGER), ss_list_price (DECIMAL(7), ss_sold_date_sk (INTEGER)
  web_sales: ws_bill_addr_sk (INTEGER), ws_ext_sales_price (DECIMAL(7), ws_item_sk (INTEGER), ws_list_price (DECIMAL(7), ws_sold_date_sk (INTEGER)