TABLES:
  date_dim (alias: d)
  date_dim
  store
  store_sales

JOINS:
  date_dim.d_week_seq = wss.d_week_seq
  store_sales.ss_store_sk = store.s_store_sk
  date_dim.d_date_sk = store_sales.ss_sold_date_sk

FILTERS:
  store.s_store_id1 = store.s_store_id2
  date_dim.d_week_seq1 = d_week_seq2 - 52
  store.s_state IN ('AR', 'CO', 'IA', 'IL', 'NC', 'NY', 'PA', 'TX')
  date_dim.d_month_seq BETWEEN 1187 AND 1187 + 11
  date_dim.d_month_seq BETWEEN 1187 + 12 AND 1187 + 23
  ss_sales_price / ss_list_price BETWEEN 57 * 0.01 AND 77 * 0.01

AGGREGATES:
  GROUP BY: date_dim.d_week_seq, store_sales.ss_store_sk

CTEs:
  wss:
    FROM: store_sales, date_dim
    WHERE: date_dim.d_date_sk = store_sales.ss_sold_date_sk (JOIN), ss_sales_price / ss_list_price BETWEEN 57 * 0.01 AND 77 * 0.01
    GROUP BY: date_dim.d_week_seq, store_sales.ss_store_sk
    OUTPUT: date_dim.d_week_seq, store_sales.ss_store_sk, sun_sales = SUM(CASE WHEN (d_day_name = 'Sunday') THEN ss_sales_price ELSE NULL END), mon_sales = SUM(CASE WHEN (d_day_name = 'Monday') THEN ss_sales_price ELSE NULL END), tue_sales = SUM(CASE WHEN (d_day_name = 'Tuesday') THEN ss_sales_price ELSE NULL END), wed_sales = SUM(CASE WHEN (d_day_name = 'Wednesday') THEN ss_sales_price ELSE NULL END), thu_sales = SUM(CASE WHEN (d_day_name = 'Thursday') THEN ss_sales_price ELSE NULL END), fri_sales = SUM(CASE WHEN (d_day_name = 'Friday') THEN ss_sales_price ELSE NULL END), sat_sales = SUM(CASE WHEN (d_day_name = 'Saturday') THEN ss_sales_price ELSE NULL END)

NOTES:
  Division in filter: ss_sales_price / ss_list_price â€” denominator must be > 0

COLUMNS NEEDED (table.column : type):
  date_dim: d_date_sk (INTEGER), d_day_name (VARCHAR), d_month_seq (INTEGER), d_week_seq (INTEGER), d_week_seq1 (?)
  store: s_state (VARCHAR), s_store_id1 (?), s_store_id2 (?), s_store_name1 (?), s_store_sk (INTEGER)
  store_sales: ss_list_price (DECIMAL(7), ss_sales_price (DECIMAL(7), ss_sold_date_sk (INTEGER), ss_store_sk (INTEGER)