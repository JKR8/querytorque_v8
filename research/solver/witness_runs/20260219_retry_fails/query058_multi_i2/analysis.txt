TABLES:
  catalog_sales
  customer
  date_dim
  item
  store_sales
  web_sales

JOINS:
  ss_items.birth_year = ws_items.birth_year
  ss_items.birth_year = cs_items.birth_year
  ss_items.item_id = cs_items.item_id
  ss_items.item_id = ws_items.item_id
  store_sales.ss_customer_sk = customer.c_customer_sk
  store_sales.ss_sold_date_sk = date_dim.d_date_sk
  store_sales.ss_item_sk = item.i_item_sk
  catalog_sales.cs_bill_customer_sk = customer.c_customer_sk
  catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
  catalog_sales.cs_item_sk = item.i_item_sk
  web_sales.ws_bill_customer_sk = customer.c_customer_sk
  web_sales.ws_sold_date_sk = date_dim.d_date_sk
  web_sales.ws_item_sk = item.i_item_sk

FILTERS:
  web_sales.ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev
  web_sales.ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev
  catalog_sales.cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev
  catalog_sales.cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev
  store_sales.ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev
  store_sales.ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev
  customer.c_birth_year BETWEEN 1985 AND 1991
  item.i_manager_id BETWEEN 42 AND 71
  store_sales.ss_list_price BETWEEN 168 AND 197
  date_dim.d_date IN ()
  date_dim.d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '2001-06-06')
  date_dim.d_date = '2001-06-06'
  catalog_sales.cs_list_price BETWEEN 168 AND 197
  web_sales.ws_list_price BETWEEN 168 AND 197

AGGREGATES:
  GROUP BY: item.i_item_id, customer.c_birth_year

CTEs:
  ss_items:
    FROM: store_sales, item, date_dim, customer, date_dim, date_dim
    WHERE: customer.c_birth_year BETWEEN 1985 AND 1991, store_sales.ss_customer_sk = customer.c_customer_sk (JOIN), item.i_manager_id BETWEEN 42 AND 71, store_sales.ss_list_price BETWEEN 168 AND 197, store_sales.ss_sold_date_sk = date_dim.d_date_sk (JOIN), store_sales.ss_item_sk = item.i_item_sk (JOIN), date_dim.d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '2001-06-06'), date_dim.d_date = '2001-06-06'
    GROUP BY: item.i_item_id, customer.c_birth_year
    OUTPUT: item_id = item.i_item_id, birth_year = customer.c_birth_year, ss_item_rev = SUM(ss_ext_sales_price)
  cs_items:
    FROM: catalog_sales, item, date_dim, customer, date_dim, date_dim
    WHERE: customer.c_birth_year BETWEEN 1985 AND 1991, catalog_sales.cs_bill_customer_sk = customer.c_customer_sk (JOIN), item.i_manager_id BETWEEN 42 AND 71, catalog_sales.cs_list_price BETWEEN 168 AND 197, catalog_sales.cs_sold_date_sk = date_dim.d_date_sk (JOIN), catalog_sales.cs_item_sk = item.i_item_sk (JOIN), date_dim.d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '2001-06-06'), date_dim.d_date = '2001-06-06'
    GROUP BY: item.i_item_id, customer.c_birth_year
    OUTPUT: item_id = item.i_item_id, birth_year = customer.c_birth_year, cs_item_rev = SUM(cs_ext_sales_price)
  ws_items:
    FROM: web_sales, item, date_dim, customer, date_dim, date_dim
    WHERE: customer.c_birth_year BETWEEN 1985 AND 1991, web_sales.ws_bill_customer_sk = customer.c_customer_sk (JOIN), item.i_manager_id BETWEEN 42 AND 71, web_sales.ws_list_price BETWEEN 168 AND 197, web_sales.ws_sold_date_sk = date_dim.d_date_sk (JOIN), web_sales.ws_item_sk = item.i_item_sk (JOIN), date_dim.d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '2001-06-06'), date_dim.d_date = '2001-06-06'
    GROUP BY: item.i_item_id, customer.c_birth_year
    OUTPUT: item_id = item.i_item_id, birth_year = customer.c_birth_year, ws_item_rev = SUM(ws_ext_sales_price)

COLUMNS NEEDED (table.column : type):
  catalog_sales: cs_bill_customer_sk (INTEGER), cs_ext_sales_price (DECIMAL(7), cs_item_rev (?), cs_item_sk (INTEGER), cs_list_price (DECIMAL(7), cs_sold_date_sk (INTEGER)
  customer: c_birth_year (INTEGER), c_customer_sk (INTEGER)
  date_dim: d_date (DATE), d_date_sk (INTEGER), d_month_seq (INTEGER)
  item: i_item_id (VARCHAR), i_item_sk (INTEGER), i_manager_id (INTEGER)
  store_sales: ss_customer_sk (INTEGER), ss_ext_sales_price (DECIMAL(7), ss_item_rev (?), ss_item_sk (INTEGER), ss_list_price (DECIMAL(7), ss_sold_date_sk (INTEGER)
  web_sales: ws_bill_customer_sk (INTEGER), ws_ext_sales_price (DECIMAL(7), ws_item_rev (?), ws_item_sk (INTEGER), ws_list_price (DECIMAL(7), ws_sold_date_sk (INTEGER)