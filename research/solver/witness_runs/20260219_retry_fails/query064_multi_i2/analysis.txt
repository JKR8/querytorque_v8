TABLES:
  customer_address (alias: ad1)
  customer_address (alias: ad2)
  catalog_returns
  catalog_sales
  customer_demographics (alias: cd1)
  customer_demographics (alias: cd2)
  customer
  date_dim (alias: d1)
  date_dim (alias: d2)
  date_dim (alias: d3)
  household_demographics (alias: hd1)
  household_demographics (alias: hd2)
  income_band (alias: ib1)
  income_band (alias: ib2)
  item
  promotion
  store
  store_returns
  store_sales

JOINS:
  catalog_sales.cs_item_sk = catalog_returns.cr_item_sk
  catalog_sales.cs_order_number = catalog_returns.cr_order_number
  household_demographics.hd_income_band_sk = income_band.ib_income_band_sk
  store_sales.ss_promo_sk = promotion.p_promo_sk
  customer.c_first_shipto_date_sk = date_dim.d_date_sk
  customer.c_first_sales_date_sk = date_dim.d_date_sk
  customer.c_current_addr_sk = customer_address.ca_address_sk
  customer.c_current_hdemo_sk = household_demographics.hd_demo_sk
  customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk
  store_sales.ss_item_sk = cs_ui.cs_item_sk
  store_sales.ss_ticket_number = store_returns.sr_ticket_number
  store_sales.ss_item_sk = store_returns.sr_item_sk
  store_sales.ss_item_sk = item.i_item_sk
  store_sales.ss_addr_sk = customer_address.ca_address_sk
  store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
  store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk
  store_sales.ss_customer_sk = customer.c_customer_sk
  store_sales.ss_store_sk = store.s_store_sk
  store_sales.ss_sold_date_sk = date_dim.d_date_sk

FILTERS:
  cross_sales.cnt <= cross_sales.cnt
  cross_sales.syear = 2000 + 1
  cross_sales.syear = 2000
  catalog_sales.cs_wholesale_cost BETWEEN 76 AND 96
  customer_demographics.cd_education_status IN ('Advanced Degree', '4 yr Degree', '4 yr Degree')
  customer_demographics.cd_marital_status IN ('S', 'S', 'S')
  store_sales.ss_wholesale_cost BETWEEN 76 AND 96
  customer_address.ca_state IN ('KS', 'OH', 'VA')
  promotion.p_channel_radio = 'Y'
  promotion.p_channel_tv = 'Y'
  promotion.p_channel_email = 'Y'
  item.i_current_price BETWEEN 77 AND 77 + 10

AGGREGATES:
  GROUP BY: catalog_sales.cs_item_sk
  GROUP BY: item.i_product_name, item.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, date_dim.d_year, date_dim.d_year, date_dim.d_year

CTEs:
  cs_ui:
    FROM: catalog_sales, catalog_returns
    WHERE: catalog_sales.cs_wholesale_cost BETWEEN 76 AND 96, catalog_sales.cs_item_sk = catalog_returns.cr_item_sk (JOIN), catalog_sales.cs_order_number = catalog_returns.cr_order_number (JOIN)
    GROUP BY: catalog_sales.cs_item_sk
    OUTPUT: catalog_sales.cs_item_sk, sale = SUM(cs_ext_list_price), refund = SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)
  cross_sales:
    FROM: store_sales, store_returns, date_dim, date_dim, date_dim, store, customer, customer_demographics, customer_demographics, promotion, household_demographics, household_demographics, customer_address, customer_address, income_band, income_band, item
    WHERE: store_sales.ss_wholesale_cost BETWEEN 76 AND 96, promotion.p_channel_radio = 'Y', promotion.p_channel_tv = 'Y', promotion.p_channel_email = 'Y', item.i_current_price BETWEEN 77 AND 77 + 10, household_demographics.hd_income_band_sk = income_band.ib_income_band_sk (JOIN), household_demographics.hd_income_band_sk = income_band.ib_income_band_sk (JOIN), store_sales.ss_promo_sk = promotion.p_promo_sk (JOIN), customer.c_first_shipto_date_sk = date_dim.d_date_sk (JOIN), customer.c_first_sales_date_sk = date_dim.d_date_sk (JOIN), customer.c_current_addr_sk = customer_address.ca_address_sk (JOIN), customer.c_current_hdemo_sk = household_demographics.hd_demo_sk (JOIN), customer.c_current_cdemo_sk = customer_demographics.cd_demo_sk (JOIN), store_sales.ss_item_sk = cs_ui.cs_item_sk (JOIN), store_sales.ss_ticket_number = store_returns.sr_ticket_number (JOIN), store_sales.ss_item_sk = store_returns.sr_item_sk (JOIN), store_sales.ss_item_sk = item.i_item_sk (JOIN), store_sales.ss_addr_sk = customer_address.ca_address_sk (JOIN), store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk (JOIN), store_sales.ss_cdemo_sk = customer_demographics.cd_demo_sk (JOIN), store_sales.ss_customer_sk = customer.c_customer_sk (JOIN), store_sales.ss_store_sk = store.s_store_sk (JOIN), store_sales.ss_sold_date_sk = date_dim.d_date_sk (JOIN)
    GROUP BY: item.i_product_name, item.i_item_sk, store.s_store_name, store.s_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, customer_address.ca_street_number, customer_address.ca_street_name, customer_address.ca_city, customer_address.ca_zip, date_dim.d_year, date_dim.d_year, date_dim.d_year
    OUTPUT: product_name = item.i_product_name, item_sk = item.i_item_sk, store_name = store.s_store_name, store_zip = store.s_zip, b_street_number = customer_address.ca_street_number, b_street_name = customer_address.ca_street_name, b_city = customer_address.ca_city, b_zip = customer_address.ca_zip, c_street_number = customer_address.ca_street_number, c_street_name = customer_address.ca_street_name, c_city = customer_address.ca_city, c_zip = customer_address.ca_zip, syear = date_dim.d_year, fsyear = date_dim.d_year, s2year = date_dim.d_year, cnt = COUNT(*), s1 = SUM(ss_wholesale_cost), s2 = SUM(ss_list_price), s3 = SUM(ss_coupon_amt)

COLUMNS NEEDED (table.column : type):
  catalog_returns: cr_item_sk (INTEGER), cr_order_number (INTEGER), cr_refunded_cash (DECIMAL(7), cr_reversed_charge (DECIMAL(7), cr_store_credit (DECIMAL(7)
  catalog_sales: cs_ext_list_price (DECIMAL(7), cs_item_sk (INTEGER), cs_order_number (INTEGER), cs_wholesale_cost (DECIMAL(7)
  customer: c_current_addr_sk (INTEGER), c_current_cdemo_sk (INTEGER), c_current_hdemo_sk (INTEGER), c_customer_sk (INTEGER), c_first_sales_date_sk (INTEGER), c_first_shipto_date_sk (INTEGER)
  customer_address: ca_address_sk (INTEGER), ca_city (VARCHAR), ca_state (VARCHAR), ca_street_name (VARCHAR), ca_street_number (VARCHAR), ca_zip (VARCHAR)
  customer_demographics: cd_demo_sk (INTEGER), cd_education_status (VARCHAR), cd_marital_status (VARCHAR)
  date_dim: d_date_sk (INTEGER), d_year (INTEGER)
  household_demographics: hd_demo_sk (INTEGER), hd_income_band_sk (INTEGER)
  income_band: ib_income_band_sk (INTEGER)
  item: i_current_price (DECIMAL(7), i_item_sk (INTEGER), i_product_name (VARCHAR)
  promotion: p_channel_email (VARCHAR), p_channel_radio (VARCHAR), p_channel_tv (VARCHAR), p_promo_sk (INTEGER)
  store: s_store_name (VARCHAR), s_store_sk (INTEGER), s_zip (VARCHAR)
  store_returns: sr_item_sk (INTEGER), sr_ticket_number (INTEGER)
  store_sales: ss_addr_sk (INTEGER), ss_cdemo_sk (INTEGER), ss_coupon_amt (DECIMAL(7), ss_customer_sk (INTEGER), ss_hdemo_sk (INTEGER), ss_item_sk (INTEGER), ss_list_price (DECIMAL(7), ss_promo_sk (INTEGER), ss_sold_date_sk (INTEGER), ss_store_sk (INTEGER), ss_ticket_number (INTEGER), ss_wholesale_cost (DECIMAL(7)