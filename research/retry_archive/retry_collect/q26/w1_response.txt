```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 2000",
        "filtered_customer_demographics": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'",
        "filtered_promotions": "SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'N' OR p_channel_event = 'N'",
        "joined_facts": "SELECT cs_item_sk, cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price FROM catalog_sales cs JOIN filtered_dates fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_customer_demographics fcd ON cs.cs_bill_cdemo_sk = fcd.cd_demo_sk JOIN filtered_promotions fp ON cs.cs_promo_sk = fp.p_promo_sk",
        "main_query": "SELECT i_item_id, AVG(cs_quantity) AS agg1, AVG(cs_list_price) AS agg2, AVG(cs_coupon_amt) AS agg3, AVG(cs_sales_price) AS agg4 FROM joined_facts jf JOIN item i ON jf.cs_item_sk = i.i_item_sk GROUP BY i_item_id ORDER BY i_item_id LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (i_item_id)",
        "same result rows"
      ],
      "expected_speedup": "3.5x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "or_to_union",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 2000",
        "filtered_customer_demographics": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'",
        "promo_email_N": "SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'N'",
        "promo_event_N": "SELECT p_promo_sk FROM promotion WHERE p_channel_event = 'N' AND (p_channel_email != 'N' OR p_channel_email IS NULL)",
        "union_promotions": "SELECT p_promo_sk FROM promo_email_N UNION ALL SELECT p_promo_sk FROM promo_event_N",
        "joined_facts": "SELECT cs_item_sk, cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price FROM catalog_sales cs JOIN filtered_dates fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_customer_demographics fcd ON cs.cs_bill_cdemo_sk = fcd.cd_demo_sk JOIN union_promotions up ON cs.cs_promo_sk = up.p_promo_sk",
        "main_query": "SELECT i_item_id, AVG(cs_quantity) AS agg1, AVG(cs_list_price) AS agg2, AVG(cs_coupon_amt) AS agg3, AVG(cs_sales_price) AS agg4 FROM joined_facts jf JOIN item i ON jf.cs_item_sk = i.i_item_sk GROUP BY i_item_id ORDER BY i_item_id LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (i_item_id)",
        "same result rows"
      ],
      "expected_speedup": "2.8x",
      "risk": "medium"
    }
  ],
  "explanation": "rs_01 applies DATE_CTE_ISOLATE to filter date_dim, customer_demographics, and promotion tables early into CTEs before joining with catalog_sales. This reduces the large fact table scan by applying dimension filters first. rs_02 additionally converts the OR condition on promotion into UNION ALL of two mutually exclusive branches, enabling separate index access paths for each condition. Both rewrites preserve the original grain and output columns."
}
```