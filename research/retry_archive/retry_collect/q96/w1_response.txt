```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "early_filter",
      "nodes": {
        "filtered_store": "SELECT s_store_sk FROM store WHERE s_store_name = 'ese'",
        "filtered_hd": "SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 7",
        "filtered_time": "SELECT t_time_sk FROM time_dim WHERE t_hour = 20 AND t_minute >= 30",
        "filtered_sales": "SELECT ss_store_sk, ss_hdemo_sk, ss_sold_time_sk FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk JOIN filtered_time ON ss_sold_time_sk = t_time_sk",
        "main_query": "SELECT COUNT(*) FROM filtered_sales ORDER BY COUNT(*) LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same aggregation result"
      ],
      "expected_speedup": "3.50x",
      "risk": "low"
    }
  ],
  "explanation": "Pushed dimension table filters (store, household_demographics, time_dim) into separate CTEs before joining with the large fact table store_sales. This reduces the store_sales join from a full table scan (172M rows) to only matching foreign keys from pre-filtered dimension tables. The filtered_sales CTE now uses indexed lookups rather than scanning the entire fact table."
}
```