```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001",
        "filtered_items": "SELECT i_item_id, i_item_sk FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)",
        "branch1_sales": "SELECT ws_bill_customer_sk, ws_item_sk, ws_sales_price FROM web_sales ws JOIN filtered_dates fd ON ws.ws_sold_date_sk = fd.d_date_sk",
        "branch1": "SELECT ca_zip, ca_city, ws_sales_price FROM branch1_sales bs JOIN customer c ON bs.ws_bill_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item i ON bs.ws_item_sk = i.i_item_sk WHERE SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')",
        "branch2": "SELECT ca_zip, ca_city, ws_sales_price FROM branch1_sales bs JOIN customer c ON bs.ws_bill_customer_sk = c.c_customer_sk JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN filtered_items fi ON bs.ws_item_sk = fi.i_item_sk",
        "combined": "SELECT ca_zip, ca_city, SUM(ws_sales_price) FROM (SELECT ca_zip, ca_city, ws_sales_price FROM branch1 UNION ALL SELECT ca_zip, ca_city, ws_sales_price FROM branch2) t GROUP BY ca_zip, ca_city HAVING SUM(ws_sales_price) IS NOT NULL ORDER BY ca_zip, ca_city LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same aggregation"
      ],
      "expected_speedup": "2.5x",
      "risk": "medium"
    }
  ],
  "explanation": "Split OR condition into UNION ALL branches to allow independent filtering and early joins. Branch1 handles ca_zip filter, Branch2 handles item subquery filter. Date filter extracted to CTE for early fact table reduction. This avoids scanning the full item table twice and allows separate join optimizations per branch."
}
```