```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "multi_dimension_prefetch",
      "nodes": {
        "filtered_d1": "SELECT d_date_sk, d_week_seq, d_date FROM date_dim WHERE d_year = 1999",
        "filtered_d2": "SELECT d_date_sk, d_week_seq FROM date_dim WHERE EXISTS (SELECT 1 FROM filtered_d1 WHERE filtered_d1.d_week_seq = date_dim.d_week_seq)",
        "filtered_cd": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D'",
        "filtered_hd": "SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000'",
        "main_query": "SELECT i_item_desc, w_warehouse_name, d1.d_week_seq, SUM(CASE WHEN p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo, SUM(CASE WHEN NOT p_promo_sk IS NULL THEN 1 ELSE 0 END) AS promo, COUNT(*) AS total_cnt FROM catalog_sales JOIN filtered_d1 AS d1 ON cs_sold_date_sk = d1.d_date_sk JOIN filtered_d2 AS d2 ON inv_date_sk = d2.d_date_sk JOIN inventory ON (cs_item_sk = inv_item_sk AND d1.d_week_seq = d2.d_week_seq) JOIN warehouse ON (w_warehouse_sk = inv_warehouse_sk) JOIN item ON (i_item_sk = cs_item_sk) JOIN filtered_cd ON (cs_bill_cdemo_sk = cd_demo_sk) JOIN filtered_hd ON (cs_bill_hdemo_sk = hd_demo_sk) JOIN date_dim AS d3 ON (cs_ship_date_sk = d3.d_date_sk) LEFT OUTER JOIN promotion ON (cs_promo_sk = p_promo_sk) LEFT OUTER JOIN catalog_returns ON (cr_item_sk = cs_item_sk AND cr_order_number = cs_order_number) WHERE inv_quantity_on_hand < cs_quantity AND d3.d_date > d1.d_date + 5 GROUP BY i_item_desc, w_warehouse_name, d1.d_week_seq ORDER BY total_cnt DESC NULLS FIRST, i_item_desc NULLS FIRST, w_warehouse_name NULLS FIRST, d1.d_week_seq NULLS FIRST LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same GROUP BY grain"
      ],
      "expected_speedup": "2.8x",
      "risk": "low"
    }
  ],
  "explanation": "Created prefetch CTEs for frequently filtered dimensions: date_dim (d1 filtered by year=1999, d2 filtered by week_seq matching d1), customer_demographics (marital_status='D'), household_demographics (buy_potential='>10000'). This reduces large table scans early and leverages the pattern from QT-OPT-003. The main query now joins with these smaller, filtered CTEs instead of full tables."
}
```