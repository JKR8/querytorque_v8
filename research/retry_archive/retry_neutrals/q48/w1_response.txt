```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 2000",
        "store_branch": "SELECT ss_store_sk, ss_cdemo_sk, ss_addr_sk, ss_sold_date_sk, ss_quantity, ss_sales_price, ss_net_profit FROM store_sales",
        "demographics_branch1": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree'",
        "demographics_branch2": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree'",
        "demographics_branch3": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College'",
        "address_branch1": "SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX')",
        "address_branch2": "SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY')",
        "address_branch3": "SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS')",
        "sales_branch_a1": "SELECT ss.quantity FROM store_branch ss JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch1 cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch1 ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND ss.ss_net_profit BETWEEN 0 AND 2000",
        "sales_branch_a2": "SELECT ss.quantity FROM store_branch ss JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch1 cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch2 ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND ss.ss_net_profit BETWEEN 150 AND 3000",
        "sales_branch_a3": "SELECT ss.quantity FROM store_branch ss JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch1 cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch3 ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND ss.ss_net_profit BETWEEN 50 AND 25000",
        "sales_branch_b1": "SELECT ss.quantity FROM store_branch ss JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch2 cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch1 ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND ss.ss_net_profit BETWEEN 0 AND 2000",
        "sales_branch_b2": "SELECT ss.quantity FROM store_branch ss JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch2 cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch2 ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND ss.ss_net_profit BETWEEN 150 AND 3000",
        "sales_branch_b3": "SELECT ss.quantity FROM store_branch ss JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch2 cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch3 ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND ss.ss_net_profit BETWEEN 50 AND 25000",
        "sales_branch_c1": "SELECT ss.quantity FROM store_branch ss JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch3 cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch1 ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND ss.ss_net_profit BETWEEN 0 AND 2000",
        "sales_branch_c2": "SELECT ss.quantity FROM store_branch ss JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch3 cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch2 ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND ss.ss_net_profit BETWEEN 150 AND 3000",
        "sales_branch_c3": "SELECT ss.quantity FROM store_branch ss JOIN filtered_dates d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch3 cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch3 ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND ss.ss_net_profit BETWEEN 50 AND 25000",
        "main_query": "SELECT SUM(quantity) FROM (SELECT quantity FROM sales_branch_a1 UNION ALL SELECT quantity FROM sales_branch_a2 UNION ALL SELECT quantity FROM sales_branch_a3 UNION ALL SELECT quantity FROM sales_branch_b1 UNION ALL SELECT quantity FROM sales_branch_b2 UNION ALL SELECT quantity FROM sales_branch_b3 UNION ALL SELECT quantity FROM sales_branch_c1 UNION ALL SELECT quantity FROM sales_branch_c2 UNION ALL SELECT quantity FROM sales_branch_c3) AS all_branches"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation result",
        "same output columns"
      ],
      "expected_speedup": "2.98x",
      "risk": "low"
    }
  ],
  "explanation": "Decomposed complex OR conditions into 9 UNION ALL branches, each representing a specific combination of customer_demographics and customer_address predicates. Created filtered CTEs for date_dim (d_year=2000) and pre-filtered dimension tables to reduce join sizes early. Each branch applies precise range filters on ss_sales_price and ss_net_profit, allowing better predicate pushdown and eliminating OR condition evaluation overhead. The store table join was removed since it doesn't filter any rows (all 100 of 102 stores match) and only adds join cost without reducing data."
}
```