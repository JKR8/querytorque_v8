```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "date_filter": "SELECT d_date_sk FROM date_dim WHERE d_year = 1999",
        "store_filter": "SELECT s_store_sk, s_store_name, s_company_name FROM store",
        "item_branch1": "SELECT i_item_sk, i_category, i_class, i_brand FROM item WHERE i_category IN ('Books', 'Electronics', 'Sports') AND i_class IN ('computers', 'stereo', 'football')",
        "item_branch2": "SELECT i_item_sk, i_category, i_class, i_brand FROM item WHERE i_category IN ('Men', 'Jewelry', 'Women') AND i_class IN ('shirts', 'birdal', 'dresses')",
        "branch1_sales": "SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, SUM(ss_sales_price) AS sum_sales FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN item_branch1 ON ss_item_sk = i_item_sk JOIN store_filter ON ss_store_sk = s_store_sk GROUP BY i_category, i_class, i_brand, s_store_name, s_company_name, d_moy",
        "branch2_sales": "SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, SUM(ss_sales_price) AS sum_sales FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN item_branch2 ON ss_item_sk = i_item_sk JOIN store_filter ON ss_store_sk = s_store_sk GROUP BY i_category, i_class, i_brand, s_store_name, s_company_name, d_moy",
        "combined_sales": "SELECT * FROM branch1_sales UNION ALL SELECT * FROM branch2_sales",
        "main_query": "SELECT * FROM (SELECT i_category, i_class, i_brand, s_store_name, s_company_name, d_moy, sum_sales, AVG(sum_sales) OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name) AS avg_monthly_sales FROM combined_sales) AS tmp1 WHERE CASE WHEN (avg_monthly_sales <> 0) THEN (ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales) ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales, s_store_name, 1, 2, 3, 5, 6, 7, 8 LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same result rows",
        "same ordering",
        "same grain"
      ],
      "expected_speedup": "2.50x",
      "risk": "medium"
    }
  ],
  "explanation": "Split the OR condition on item category/class into UNION ALL branches to eliminate expensive OR filter evaluation during the join. Each branch filters items first, then joins with store_sales only for relevant rows. Also isolated date_dim filter into a CTE to push down early. This reduces the join cardinality and allows separate evaluation of disjoint conditions."
}
```