```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5",
        "filtered_ca": "SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5",
        "filtered_items": "SELECT DISTINCT i_manufact_id FROM item WHERE i_category IN ('Electronics')",
        "ss_rewritten": "SELECT i.i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales ss JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_ca ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE i.i_manufact_id IN (SELECT i_manufact_id FROM filtered_items) GROUP BY i.i_manufact_id",
        "ws_rewritten": "SELECT i.i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales ws JOIN filtered_dates fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_ca ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE i.i_manufact_id IN (SELECT i_manufact_id FROM filtered_items) GROUP BY i.i_manufact_id"
      },
      "invariants_kept": [
        "same result rows",
        "same column output",
        "same grouping and aggregation"
      ],
      "expected_speedup": "3.0x",
      "risk": "low"
    },
    {
      "id": "rs_02", 
      "transform": "materialize_cte",
      "nodes": {
        "eligible_manufacturers": "SELECT DISTINCT i_manufact_id FROM item WHERE i_category IN ('Electronics')",
        "ss_opt": "SELECT i.i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales ss JOIN date_dim d ON ss.ss_sold_date_sk = d.d_date_sk JOIN customer_address ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk WHERE d.d_year = 1998 AND d.d_moy = 5 AND ca.ca_gmt_offset = -5 AND i.i_manufact_id IN (SELECT i_manufact_id FROM eligible_manufacturers) GROUP BY i.i_manufact_id",
        "ws_opt": "SELECT i.i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales ws JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk JOIN customer_address ca ON ws.ws_bill_addr_sk = ca.ca_address_sk JOIN item i ON ws.ws_item_sk = i.i_item_sk WHERE d.d_year = 1998 AND d.d_moy = 5 AND ca.ca_gmt_offset = -5 AND i.i_manufact_id IN (SELECT i_manufact_id FROM eligible_manufacturers) GROUP BY i.i_manufact_id"
      },
      "invariants_kept": [
        "same result rows",
        "same column output",
        "same grouping and aggregation"
      ],
      "expected_speedup": "1.5x",
      "risk": "low"
    }
  ],
  "explanation": "Applied two complementary optimizations: 1) DATE_CTE_ISOLATE to filter date_dim and customer_address early into CTEs, reducing join cardinality for store_sales and web_sales. 2) MATERIALIZE_CTE to extract the repeated manufacturer subquery into a reusable CTE, eliminating redundant scans of the item table for the same category filter. The combination reduces fact table joins from large unfiltered scans to pre-filtered subsets."
}
```