Looking at the query structure, I notice a repeated pattern: each CTE (ss, ws, and likely cs) has the same filters on date_dim (d_year=2002, d_moy=1) and customer_address (ca_gmt_offset=-5). This is a classic case for **dimension pre-filtering CTEs**.

However, the biggest opportunity I see is that all three CTEs scan the same fact tables with the same date and address filters. This suggests we should pre-filter dimensions into CTEs and join once with all fact tables.

**Key insight**: Create shared dimension CTEs for date and address that all fact tables can use. This avoids re-filtering the same dimensions three times.

```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "dimension_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy = 1",
        "filtered_addresses": "SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5",
        "home_items": "SELECT i_manufact_id, i_item_sk FROM item WHERE i_category IN ('Home')",
        "ss": "SELECT hi.i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales ss JOIN home_items hi ON ss.ss_item_sk = hi.i_item_sk JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_addresses fa ON ss.ss_addr_sk = fa.ca_address_sk GROUP BY hi.i_manufact_id",
        "ws": "SELECT hi.i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales ws JOIN home_items hi ON ws.ws_item_sk = hi.i_item_sk JOIN filtered_dates fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_addresses fa ON ws.ws_bill_addr_sk = fa.ca_address_sk GROUP BY hi.i_manufact_id",
        "cs": "SELECT hi.i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales cs JOIN home_items hi ON cs.cs_item_sk = hi.i_item_sk JOIN filtered_dates fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_addresses fa ON cs.cs_bill_addr_sk = fa.ca_address_sk GROUP BY hi.i_manufact_id",
        "main_query": "SELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same grouping and aggregation"
      ],
      "expected_speedup": "1.5x",
      "risk": "low"
    }
  ],
  "explanation": "Created shared dimension CTEs for date_dim (filtered by d_year=2002, d_moy=1) and customer_address (filtered by ca_gmt_offset=-5). Also created a CTE for home category items. This allows each fact table (store_sales, web_sales, catalog_sales) to join with pre-filtered dimensions once, avoiding repeated filtering of the same dimension tables. The home_items CTE also eliminates the correlated subquery pattern."
}
```