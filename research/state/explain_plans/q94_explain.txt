-- Q94 EXPLAIN ANALYZE (SF10)
-- State: baseline
-- Best speedup: 1.00x
-- Source SQL: /mnt/d/TPC-DS/queries_duckdb_converted/query_94.sql

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE select     count(distinct ws_order_number) as "order count"   ,sum(ws_ext_ship_cost) as "total shipping cost"   ,sum(ws_net_profit) as "total net profit" from    web_sales ws1   ,date_dim   ,customer_address   ,web_site where     d_date between '2000-2-01' and             (cast('2000-2-01' as date) + INTERVAL 60 DAY) and ws1.ws_ship_date_sk = d_date_sk and ws1.ws_ship_addr_sk = ca_address_sk and ca_state = 'OK' and ws1.ws_web_site_sk = web_site_sk and web_company_name = 'pri' and exists (select *             from web_sales ws2             where ws1.ws_order_number = ws2.ws_order_number               and ws1.ws_warehouse_sk <> ws2.ws_warehouse_sk) and not exists(select *                from web_returns wr1                where ws1.ws_order_number = wr1.wr_order_number) order by count(distinct ws_order_number)  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.107s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────────┐
│      QUERY      │
└────────┬────────┘
┌────────┴────────┐
│ EXPLAIN_ANALYZE │
│    ──────────   │
│      0 rows     │
│     (0.00s)     │
└────────┬────────┘
┌────────┴────────┐
│      TOP_N      │
│    ──────────   │
│     Top: 100    │
│                 │
│    Order By:    │
│  count(DISTINCT │
│ ws1.ws_order_num│
│     ber) ASC    │
│                 │
│      1 row      │
│     (0.00s)     │
└────────┬────────┘
┌────────┴────────┐
│UNGROUPED_AG...  │
│    ──────────   │
│   Aggregates:   │
│ count(DISTINCT  │
│       #0)       │
│     sum(#1)     │
│     sum(#2)     │
│                 │
│      1 row      │
│     (0.00s)     │
└────────┬────────┘
┌────────┴────────┐
│    PROJECTION   │
│    ──────────   │
│ ws_order_number │
│ ws_ext_ship_cost│
│  ws_net_profit  │
│                 │
│     258 rows    │
│     (0.00s)     │
└────────┬────────┘
┌────────┴────────┐
│ RIGHT_DELIM_JOIN│
│    ──────────   │
│    Join Type:   │
│    RIGHT_ANTI   │
│                 │
│   Conditions:   │
│ ws_order_number │
│  IS NOT DISTINCT│
│ FROM ws_order_nu├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────┐
│       mber      │                                                                                                                                              │                                                        │
│                 │                                                                                                                                              │                                                        │
│   Delim Index:  │                                                                                                                                              │                                                        │
│        2        │                                                                                                                                              │                                                        │
│                 │                                                                                                                                              │                                                        │
│      0 rows     │                                                                                                                                              │                                                        │
│     (0.00s)     │                                                                                                                                              │                                                        │
└────────┬────────┘                                                                                                                                              │                                                        │
┌────────┴────────┐                                                                                                                                     ┌────────┴────────┐                                      ┌────────┴────────┐
│ RIGHT_DELIM_JOIN│                                                                                                                                     │    HASH_JOIN    │                                      │  HASH_GROUP_BY  │
│    ──────────   │                                                                                                                                     │    ──────────   │                                      │    ──────────   │
│    Join Type:   │                                                                                                                                     │    Join Type:   │                                      │    Groups: #0   │
│    RIGHT_SEMI   │                                                                                                                                     │    RIGHT_ANTI   │                                      │                 │
│                 │                                                                                                                                     │                 │                                      │                 │
│   Conditions:   │                                                                                                                                     │   Conditions:   │                                      │                 │
│ ws_warehouse_sk │                                                                                                                                     │ ws_order_number │                                      │                 │
│  IS NOT DISTINCT│                                                                                                                                     │  IS NOT DISTINCT│                                      │                 │
│ FROM ws_warehous│                                                                                                                                     │ FROM ws_order_nu│                                      │                 │
│       e_sk      │                                                                                                                                     │       mber      │                                      │                 │
│ ws_order_number ├──────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────┐         │                 ├────────────────────────────┐         │                 │
│  IS NOT DISTINCT│                                                                  │                                                        │         │                 │                            │         │                 │
│ FROM ws_order_nu│                                                                  │                                                        │         │                 │                            │         │                 │
│       mber      │                                                                  │                                                        │         │                 │                            │         │                 │
│                 │                                                                  │                                                        │         │                 │                            │         │                 │
│   Delim Index:  │                                                                  │                                                        │         │                 │                            │         │                 │
│        1        │                                                                  │                                                        │         │                 │                            │         │                 │
│                 │                                                                  │                                                        │         │                 │                            │         │                 │
│      0 rows     │                                                                  │                                                        │         │     258 rows    │                            │         │     695 rows    │
│     (0.00s)     │                                                                  │                                                        │         │     (0.00s)     │                            │         │     (0.00s)     │
└────────┬────────┘                                                                  │                                                        │         └────────┬────────┘                            │         └─────────────────┘
┌────────┴────────┐                                                         ┌────────┴────────┐                                      ┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐
│    HASH_JOIN    │                                                         │    HASH_JOIN    │                                      │  HASH_GROUP_BY  ││    PROJECTION   │                   │    DUMMY_SCAN   │
│    ──────────   │                                                         │    ──────────   │                                      │    ──────────   ││    ──────────   │                   │    ──────────   │
│    Join Type:   │                                                         │    Join Type:   │                                      │     Groups:     ││ ws_order_number │                   │                 │
│      INNER      │                                                         │    RIGHT_SEMI   │                                      │        #1       ││                 │                   │                 │
│                 │                                                         │                 │                                      │        #0       ││                 │                   │                 │
│   Conditions:   │                                                         │   Conditions:   │                                      │                 ││                 │                   │                 │
│ ws_web_site_sk =│                                                         │ ws_warehouse_sk │                                      │                 ││                 │                   │                 │
│    web_site_sk  │                                                         │  IS NOT DISTINCT│                                      │                 ││                 │                   │                 │
│                 ├───────────────────────────────────────────────┐         │ FROM ws_warehous├────────────────────────────┐         │                 ││                 │                   │                 │
│                 │                                               │         │       e_sk      │                            │         │                 ││                 │                   │                 │
│                 │                                               │         │ ws_order_number │                            │         │                 ││                 │                   │                 │
│                 │                                               │         │  IS NOT DISTINCT│                            │         │                 ││                 │                   │                 │
│                 │                                               │         │ FROM ws_order_nu│                            │         │                 ││                 │                   │                 │
│                 │                                               │         │       mber      │                            │         │                 ││                 │                   │                 │
│                 │                                               │         │                 │                            │         │                 ││                 │                   │                 │
│     955 rows    │                                               │         │     955 rows    │                            │         │     919 rows    ││     903 rows    │                   │      0 rows     │
│     (0.00s)     │                                               │         │     (0.00s)     │                            │         │     (0.00s)     ││     (0.00s)     │                   │     (0.00s)     │
└────────┬────────┘                                               │         └────────┬────────┘                            │         └─────────────────┘└────────┬────────┘                   └─────────────────┘
┌────────┴────────┐                                      ┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐                   ┌────────┴────────┐
│    HASH_JOIN    │                                      │    TABLE_SCAN   ││    PROJECTION   │                   │    DUMMY_SCAN   │                   │    HASH_JOIN    │
│    ──────────   │                                      │    ──────────   ││    ──────────   │                   │    ──────────   │                   │    ──────────   │
│    Join Type:   │                                      │      Table:     ││ ws_warehouse_sk │                   │                 │                   │    Join Type:   │
│      INNER      │                                      │     web_site    ││ ws_order_number │                   │                 │                   │      INNER      │
│                 │                                      │                 ││                 │                   │                 │                   │                 │
│   Conditions:   │                                      │      Type:      ││                 │                   │                 │                   │   Conditions:   │
│ ws_ship_date_sk │                                      │ Sequential Scan ││                 │                   │                 │                   │ wr_order_number │
│   = d_date_sk   │                                      │                 ││                 │                   │                 │                   │= ws_order_number│
│                 ├────────────────────────────┐         │   Projections:  ││                 │                   │                 │                   │                 ├─────────┐
│                 │                            │         │   web_site_sk   ││                 │                   │                 │                   │                 │         │
│                 │                            │         │                 ││                 │                   │                 │                   │                 │         │
│                 │                            │         │     Filters:    ││                 │                   │                 │                   │                 │         │
│                 │                            │         │ web_company_name││                 │                   │                 │                   │                 │         │
│                 │                            │         │      ='pri'     ││                 │                   │                 │                   │                 │         │
│                 │                            │         │                 ││                 │                   │                 │                   │                 │         │
│    3,700 rows   │                            │         │      7 rows     ││    9,555 rows   │                   │      0 rows     │                   │     903 rows    │         │
│     (0.00s)     │                            │         │     (0.00s)     ││     (0.00s)     │                   │     (0.00s)     │                   │     (0.00s)     │         │
└────────┬────────┘                            │         └─────────────────┘└────────┬────────┘                   └─────────────────┘                   └────────┬────────┘         │
┌────────┴────────┐                   ┌────────┴────────┐                   ┌────────┴────────┐                                                         ┌────────┴────────┐┌────────┴────────┐
│    HASH_JOIN    │                   │      FILTER     │                   │    HASH_JOIN    │                                                         │    TABLE_SCAN   ││    DELIM_SCAN   │
│    ──────────   │                   │    ──────────   │                   │    ──────────   │                                                         │    ──────────   ││    ──────────   │
│    Join Type:   │                   │    (d_date_sk   │                   │    Join Type:   │                                                         │      Table:     ││   Delim Index:  │
│      INNER      │                   │  BETWEEN 2450817│                   │      INNER      │                                                         │   web_returns   ││        2        │
│                 │                   │   AND 2452762)  │                   │                 │                                                         │                 ││                 │
│   Conditions:   │                   │                 │                   │   Conditions:   │                                                         │      Type:      ││                 │
│ ws_ship_addr_sk │                   │                 │                   │ ws_order_number │                                                         │ Sequential Scan ││                 │
│ = ca_address_sk ├─────────┐         │                 │                   │= ws_order_number├─────────┐                                               │                 ││                 │
│                 │         │         │                 │                   │ ws_warehouse_sk │         │                                               │   Projections:  ││                 │
│                 │         │         │                 │                   │!= ws_warehouse_s│         │                                               │ wr_order_number ││                 │
│                 │         │         │                 │                   │        k        │         │                                               │                 ││                 │
│                 │         │         │                 │                   │                 │         │                                               │                 ││                 │
│    3,700 rows   │         │         │     61 rows     │                   │    9,555 rows   │         │                                               │   718,078 rows  ││      0 rows     │
│     (0.03s)     │         │         │     (0.00s)     │                   │     (0.03s)     │         │                                               │     (0.00s)     ││     (0.00s)     │
└────────┬────────┘         │         └────────┬────────┘                   └────────┬────────┘         │                                               └─────────────────┘└─────────────────┘
┌────────┴────────┐┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐┌────────┴────────┐
│    TABLE_SCAN   ││    TABLE_SCAN   ││    TABLE_SCAN   │                   │    TABLE_SCAN   ││    DELIM_SCAN   │
│    ──────────   ││    ──────────   ││    ──────────   │                   │    ──────────   ││    ──────────   │
│      Table:     ││      Table:     ││      Table:     │                   │      Table:     ││   Delim Index:  │
│    web_sales    ││ customer_address││     date_dim    │                   │    web_sales    ││        1        │
│                 ││                 ││                 │                   │                 ││                 │
│      Type:      ││      Type:      ││      Type:      │                   │      Type:      ││                 │
│ Sequential Scan ││ Sequential Scan ││ Sequential Scan │                   │ Sequential Scan ││                 │
│                 ││                 ││                 │                   │                 ││                 │
│   Projections:  ││   Projections:  ││   Projections:  │                   │   Projections:  ││                 │
│ ws_ship_date_sk ││  ca_address_sk  ││    d_date_sk    │                   │ ws_order_number ││                 │
│ ws_ship_addr_sk ││                 ││                 │                   │ ws_warehouse_sk ││                 │
│  ws_web_site_sk ││     Filters:    ││     Filters:    │                   │                 ││                 │
│ ws_order_number ││  ca_state='OK'  ││ (CAST(d_date AS │                   │                 ││                 │
│ ws_warehouse_sk ││                 ││    TIMESTAMP)   │                   │                 ││                 │
│ ws_ext_ship_cost││                 ││   BETWEEN '2000 │                   │                 ││                 │
│  ws_net_profit  ││                 ││ -02-01 00:00:00'│                   │                 ││                 │
│                 ││                 ││ ::TIMESTAMP AND │                   │                 ││                 │
│                 ││                 ││  '2000-04-01 00 │                   │                 ││                 │
│                 ││                 ││     :00:00':    │                   │                 ││                 │
│                 ││                 ││   :TIMESTAMP)   │                   │                 ││                 │
│                 ││                 ││                 │                   │                 ││                 │
│   157,711 rows  ││    6,028 rows   ││     61 rows     │                   │  7,185,627 rows ││      0 rows     │
│     (0.78s)     ││     (0.00s)     ││     (0.00s)     │                   │     (0.03s)     ││     (0.00s)     │
└─────────────────┘└─────────────────┘└─────────────────┘                   └─────────────────┘└─────────────────┘
