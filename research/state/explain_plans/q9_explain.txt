-- Q9 EXPLAIN ANALYZE (SF10)
-- State: optimized (retry3w_2, 4.47x)
-- Best speedup: 4.47x
-- Source SQL: /mnt/c/Users/jakc9/Documents/QueryTorque_V8/retry_collect/q9/w3_optimized.sql

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE WITH quantity_aggregations AS (SELECT CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN 1 WHEN ss_quantity BETWEEN 21 AND 40 THEN 2 WHEN ss_quantity BETWEEN 41 AND 60 THEN 3 WHEN ss_quantity BETWEEN 61 AND 80 THEN 4 WHEN ss_quantity BETWEEN 81 AND 100 THEN 5 END AS bucket, COUNT(*) AS cnt, AVG(ss_ext_discount_amt) AS avg_disc, AVG(ss_net_paid) AS avg_net FROM store_sales WHERE ss_quantity BETWEEN 1 AND 100 GROUP BY CASE WHEN ss_quantity BETWEEN 1 AND 20 THEN 1 WHEN ss_quantity BETWEEN 21 AND 40 THEN 2 WHEN ss_quantity BETWEEN 41 AND 60 THEN 3 WHEN ss_quantity BETWEEN 61 AND 80 THEN 4 WHEN ss_quantity BETWEEN 81 AND 100 THEN 5 END) SELECT CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 1) > 74129 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 1) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 1) END AS bucket1, CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 2) > 122840 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 2) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 2) END AS bucket2, CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 3) > 56580 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 3) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 3) END AS bucket3, CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 4) > 10097 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 4) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 4) END AS bucket4, CASE WHEN (SELECT cnt FROM quantity_aggregations WHERE bucket = 5) > 165306 THEN (SELECT avg_disc FROM quantity_aggregations WHERE bucket = 5) ELSE (SELECT avg_net FROM quantity_aggregations WHERE bucket = 5) END AS bucket5 FROM reason WHERE r_reason_sk = 1
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││               Total Time: 1.78s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│     CTE     │
│    ──────   │
│  CTE Name:  │
│quantity_aggr│
│   egations  │
│             ├───────┐
│ Table Index:│       │
│      0      │       │
│             │       │
│    0 rows   │       │
│   (0.00s)   │       │
└──────┬──────┘       │
┌──────┴──────┐┌──────┴──────┐
│HASH_GROUP_BY││  PROJECTION │
│    ──────   ││    ──────   │
│   Groups:   ││   bucket1   │
│      #0     ││   bucket2   │
│             ││   bucket3   │
│ Aggregates: ││   bucket4   │
│ count_star()││   bucket5   │
│   avg(#1)   ││             │
│   avg(#2)   ││             │
│             ││             │
│    5 rows   ││    1 row    │
│   (1.43s)   ││   (0.00s)   │
└──────┬──────┘└──────┬──────┘
┌──────┴──────┐┌──────┴──────┐
│  PROJECTION ││CROSS_PRODUCT│
│    ──────   ││    ──────   │
│ CASE  WHEN (││             │
│ (ss_quantity││             │
│    <= 20))  ││             │
│   THEN (1)  ││             │
│    WHEN ((  ││             │
│ (ss_quantity││             │
│  >= 21) AND ││             │
│ (ss_quantity││             │
│   <= 40)))  ││             │
│   THEN (2)  ││             │
│    WHEN ((  ││             │
│ (ss_quantity││             │
│  >= 41) AND ││             │
│ (ss_quantity││             │
│   <= 60)))  ││             │
│   THEN (3)  ││             ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│    WHEN ((  ││             │                                                                                                                │
│ (ss_quantity││             │                                                                                                                │
│  >= 61) AND ││             │                                                                                                                │
│ (ss_quantity││             │                                                                                                                │
│   <= 80)))  ││             │                                                                                                                │
│   THEN (4)  ││             │                                                                                                                │
│ WHEN ((ss_qu││             │                                                                                                                │
│ antity >= 81││             │                                                                                                                │
│ )) THEN (5) ││             │                                                                                                                │
│   ELSE NULL ││             │                                                                                                                │
│      END    ││             │                                                                                                                │
│ss_ext_discou││             │                                                                                                                │
│    nt_amt   ││             │                                                                                                                │
│ ss_net_paid ││             │                                                                                                                │
│             ││             │                                                                                                                │
│27,504,8...  ││    1 row    │                                                                                                                │
│   (1.37s)   ││   (0.00s)   │                                                                                                                │
└──────┬──────┘└──────┬──────┘                                                                                                                │
┌──────┴──────┐┌──────┴──────┐                                                                                                         ┌──────┴──────┐
│    FILTER   ││CROSS_PRODUCT│                                                                                                         │CROSS_PRODUCT│
│    ──────   ││    ──────   │                                                                                                         │    ──────   │
│ ((CASE  WHEN││             │                                                                                                         │             │
│ ((ss_quantit││             │                                                                                                         │             │
│  y <= 20))  ││             │                                                                                                         │             │
│   THEN (1)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 21) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 40)))  ││             │                                                                                                         │             │
│   THEN (2)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 41) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 60)))  ││             │                                                                                                         │             │
│   THEN (3)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 61) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 80)))  ││             │                                                                                                         │             │
│   THEN (4)  ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity >= 81││             │                                                                                                         │             │
│ )) THEN (5) ││             │                                                                                                         │             │
│   ELSE NULL ││             │                                                                                                         │             │
│  END = 5) OR││             │                                                                                                         │             │
│    ((CASE   ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity <= 20││             │                                                                                                         │             │
│ )) THEN (1) ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 21) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 40)))  ││             │                                                                                                         │             │
│   THEN (2)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 41) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 60)))  ││             │                                                                                                         │             │
│   THEN (3)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 61) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 80)))  ││             │                                                                                                         │             │
│   THEN (4)  ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity >= 81││             │                                                                                                         │             │
│ )) THEN (5) ││             │                                                                                                         │             │
│   ELSE NULL ││             │                                                                                                         │             │
│  END = 5) OR││             │                                                                                                         │             │
│    ((CASE   ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity <= 20││             │                                                                                                         │             │
│ )) THEN (1) ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 21) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 40)))  ││             │                                                                                                         │             │
│   THEN (2)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 41) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 60)))  ││             │                                                                                                         │             │
│   THEN (3)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 61) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 80)))  ││             │                                                                                                         │             │
│   THEN (4)  ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity >= 81││             │                                                                                                         │             │
│ )) THEN (5) ││             │                                                                                                         │             │
│   ELSE NULL ││             │                                                                                                         │             │
│  END = 5) OR││             │                                                                                                         │             │
│    ((CASE   ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity <= 20││             │                                                                                                         │             │
│ )) THEN (1) ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 21) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 40)))  ││             │                                                                                                         │             │
│   THEN (2)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 41) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 60)))  ││             │                                                                                                         │             │
│   THEN (3)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 61) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 80)))  ││             │                                                                                                         │             │
│   THEN (4)  ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity >= 81││             │                                                                                                         │             │
│ )) THEN (5) ││             │                                                                                                         │             │
│   ELSE NULL ││             │                                                                                                         │             │
│  END = 4) OR││             │                                                                                                         │             │
│    ((CASE   ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity <= 20││             │                                                                                                         │             │
│ )) THEN (1) ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 21) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 40)))  ││             │                                                                                                         │             │
│   THEN (2)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 41) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 60)))  ││             │                                                                                                         │             │
│   THEN (3)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 61) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 80)))  ││             │                                                                                                         │             │
│   THEN (4)  ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity >= 81││             │                                                                                                         │             │
│ )) THEN (5) ││             │                                                                                                         │             │
│   ELSE NULL ││             │                                                                                                         │             │
│  END = 4) OR││             │                                                                                                         │             │
│    ((CASE   ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity <= 20││             │                                                                                                         │             │
│ )) THEN (1) ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 21) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 40)))  ││             │                                                                                                         │             │
│   THEN (2)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 41) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 60)))  ││             │                                                                                                         │             │
│   THEN (3)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 61) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 80)))  ││             │                                                                                                         │             │
│   THEN (4)  ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity >= 81││             │                                                                                                         │             │
│ )) THEN (5) ││             │                                                                                                         │             │
│   ELSE NULL ││             │                                                                                                         │             │
│  END = 4) OR││             │                                                                                                         │             │
│    ((CASE   ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity <= 20││             │                                                                                                         │             │
│ )) THEN (1) ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 21) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 40)))  ││             │                                                                                                         │             │
│   THEN (2)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 41) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 60)))  ││             │                                                                                                         │             │
│   THEN (3)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 61) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 80)))  ││             │                                                                                                         │             │
│   THEN (4)  ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity >= 81││             │                                                                                                         │             │
│ )) THEN (5) ││             │                                                                                                         │             │
│   ELSE NULL ││             │                                                                                                         │             │
│  END = 3) OR││             │                                                                                                         │             │
│    ((CASE   ││             │                                                                                                         │             │
│ WHEN ((ss_qu││             │                                                                                                         │             │
│ antity <= 20││             │                                                                                                         │             │
│ )) THEN (1) ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 21) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 40)))  ││             │                                                                                                         │             │
│   THEN (2)  ││             │                                                                                                         │             │
│    WHEN ((  ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│  >= 41) AND ││             │                                                                                                         │             │
│ (ss_quantity││             │                                                                                                         │             │
│   <= 60)))  ││             ├────────────────────────────────────────────────────┐                                                    │             ├────────────────────────────────────────────────────┐
│   THEN (3)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 61) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 80)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (4)  ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity >= 81││             │                                                    │                                                    │             │                                                    │
│ )) THEN (5) ││             │                                                    │                                                    │             │                                                    │
│   ELSE NULL ││             │                                                    │                                                    │             │                                                    │
│  END = 3) OR││             │                                                    │                                                    │             │                                                    │
│    ((CASE   ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity <= 20││             │                                                    │                                                    │             │                                                    │
│ )) THEN (1) ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 21) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 40)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (2)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 41) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 60)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (3)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 61) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 80)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (4)  ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity >= 81││             │                                                    │                                                    │             │                                                    │
│ )) THEN (5) ││             │                                                    │                                                    │             │                                                    │
│   ELSE NULL ││             │                                                    │                                                    │             │                                                    │
│  END = 3) OR││             │                                                    │                                                    │             │                                                    │
│    ((CASE   ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity <= 20││             │                                                    │                                                    │             │                                                    │
│ )) THEN (1) ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 21) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 40)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (2)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 41) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 60)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (3)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 61) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 80)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (4)  ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity >= 81││             │                                                    │                                                    │             │                                                    │
│ )) THEN (5) ││             │                                                    │                                                    │             │                                                    │
│   ELSE NULL ││             │                                                    │                                                    │             │                                                    │
│  END = 2) OR││             │                                                    │                                                    │             │                                                    │
│    ((CASE   ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity <= 20││             │                                                    │                                                    │             │                                                    │
│ )) THEN (1) ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 21) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 40)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (2)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 41) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 60)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (3)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 61) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 80)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (4)  ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity >= 81││             │                                                    │                                                    │             │                                                    │
│ )) THEN (5) ││             │                                                    │                                                    │             │                                                    │
│   ELSE NULL ││             │                                                    │                                                    │             │                                                    │
│  END = 2) OR││             │                                                    │                                                    │             │                                                    │
│    ((CASE   ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity <= 20││             │                                                    │                                                    │             │                                                    │
│ )) THEN (1) ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 21) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 40)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (2)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 41) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 60)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (3)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 61) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 80)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (4)  ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity >= 81││             │                                                    │                                                    │             │                                                    │
│ )) THEN (5) ││             │                                                    │                                                    │             │                                                    │
│   ELSE NULL ││             │                                                    │                                                    │             │                                                    │
│  END = 2) OR││             │                                                    │                                                    │             │                                                    │
│    ((CASE   ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity <= 20││             │                                                    │                                                    │             │                                                    │
│ )) THEN (1) ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 21) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 40)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (2)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 41) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 60)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (3)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 61) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 80)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (4)  ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity >= 81││             │                                                    │                                                    │             │                                                    │
│ )) THEN (5) ││             │                                                    │                                                    │             │                                                    │
│   ELSE NULL ││             │                                                    │                                                    │             │                                                    │
│  END = 1) OR││             │                                                    │                                                    │             │                                                    │
│    ((CASE   ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity <= 20││             │                                                    │                                                    │             │                                                    │
│ )) THEN (1) ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 21) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 40)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (2)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 41) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 60)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (3)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 61) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 80)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (4)  ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity >= 81││             │                                                    │                                                    │             │                                                    │
│ )) THEN (5) ││             │                                                    │                                                    │             │                                                    │
│   ELSE NULL ││             │                                                    │                                                    │             │                                                    │
│  END = 1) OR││             │                                                    │                                                    │             │                                                    │
│  (CASE  WHEN││             │                                                    │                                                    │             │                                                    │
│ ((ss_quantit││             │                                                    │                                                    │             │                                                    │
│  y <= 20))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (1)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 21) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 40)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (2)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 41) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 60)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (3)  ││             │                                                    │                                                    │             │                                                    │
│    WHEN ((  ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│  >= 61) AND ││             │                                                    │                                                    │             │                                                    │
│ (ss_quantity││             │                                                    │                                                    │             │                                                    │
│   <= 80)))  ││             │                                                    │                                                    │             │                                                    │
│   THEN (4)  ││             │                                                    │                                                    │             │                                                    │
│ WHEN ((ss_qu││             │                                                    │                                                    │             │                                                    │
│ antity >= 81││             │                                                    │                                                    │             │                                                    │
│ )) THEN (5) ││             │                                                    │                                                    │             │                                                    │
│   ELSE NULL ││             │                                                    │                                                    │             │                                                    │
│  END = 1))))││             │                                                    │                                                    │             │                                                    │
│ ))))))))))) ││             │                                                    │                                                    │             │                                                    │
│             ││             │                                                    │                                                    │             │                                                    │
│27,504,8...  ││    1 row    │                                                    │                                                    │    1 row    │                                                    │
│   (12.54s)  ││   (0.00s)   │                                                    │                                                    │   (0.00s)   │                                                    │
└──────┬──────┘└──────┬──────┘                                                    │                                                    └──────┬──────┘                                                    │
┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐                                             ┌──────┴──────┐                                             ┌──────┴──────┐
│  TABLE_SCAN ││CROSS_PRODUCT│                                             │CROSS_PRODUCT│                                             │CROSS_PRODUCT│                                             │CROSS_PRODUCT│
│    ──────   ││    ──────   │                                             │    ──────   │                                             │    ──────   │                                             │    ──────   │
│    Table:   ││             │                                             │             │                                             │             │                                             │             │
│ store_sales ││             │                                             │             │                                             │             │                                             │             │
│             ││             │                                             │             │                                             │             │                                             │             │
│    Type:    ││             │                                             │             │                                             │             │                                             │             │
│  Sequential ││             │                                             │             │                                             │             │                                             │             │
│     Scan    ││             │                                             │             │                                             │             │                                             │             │
│             ││             │                                             │             │                                             │             │                                             │             │
│ Projections:││             │                                             │             │                                             │             │                                             │             │
│ ss_quantity ││             │                                             │             │                                             │             │                                             │             │
│ss_ext_discou││             ├──────────────────────┐                      │             ├──────────────────────┐                      │             ├──────────────────────┐                      │             ├──────────────────────┐
│    nt_amt   ││             │                      │                      │             │                      │                      │             │                      │                      │             │                      │
│ ss_net_paid ││             │                      │                      │             │                      │                      │             │                      │                      │             │                      │
│             ││             │                      │                      │             │                      │                      │             │                      │                      │             │                      │
│   Filters:  ││             │                      │                      │             │                      │                      │             │                      │                      │             │                      │
│ ss_quantity>││             │                      │                      │             │                      │                      │             │                      │                      │             │                      │
│=1 AND ss_qua││             │                      │                      │             │                      │                      │             │                      │                      │             │                      │
│  ntity<=100 ││             │                      │                      │             │                      │                      │             │                      │                      │             │                      │
│             ││             │                      │                      │             │                      │                      │             │                      │                      │             │                      │
│27,504,8...  ││    1 row    │                      │                      │    1 row    │                      │                      │    1 row    │                      │                      │    1 row    │                      │
│   (5.56s)   ││   (0.00s)   │                      │                      │   (0.00s)   │                      │                      │   (0.00s)   │                      │                      │   (0.00s)   │                      │
└─────────────┘└──────┬──────┘                      │                      └──────┬──────┘                      │                      └──────┬──────┘                      │                      └──────┬──────┘                      │
               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐
               │CROSS_PRODUCT│               │CROSS_PRODUCT│               │CROSS_PRODUCT│               │CROSS_PRODUCT│               │CROSS_PRODUCT│               │CROSS_PRODUCT│               │CROSS_PRODUCT│               │CROSS_PRODUCT│
               │    ──────   │               │    ──────   │               │    ──────   │               │    ──────   │               │    ──────   │               │    ──────   │               │    ──────   │               │    ──────   │
               │    1 row    ├───────┐       │    1 row    ├───────┐       │    1 row    ├───────┐       │    1 row    ├───────┐       │    1 row    ├───────┐       │    1 row    ├───────┐       │    1 row    ├───────┐       │    1 row    ├
               │   (0.00s)   │       │       │   (0.00s)   │       │       │   (0.00s)   │       │       │   (0.00s)   │       │       │   (0.00s)   │       │       │   (0.00s)   │       │       │   (0.00s)   │       │       │   (0.00s)   │
               └──────┬──────┘       │       └──────┬──────┘       │       └──────┬──────┘       │       └──────┬──────┘       │       └──────┬──────┘       │       └──────┬──────┘       │       └──────┬──────┘       │       └──────┬──────┘
               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
               │  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION │
               │    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   │
               │ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (││ CASE  WHEN (│
               │  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  ││  (#1 > 1))  │
               │ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error││ THEN ("error│
               │ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than││ "('More than│
               │    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  ││    one row  │
               │  returned by││  returned by││  returned by││  returned by││  returned by││  returned by││  returned by││  returned by││  returned by││  returned by││  returned by││  returned by││  returned by││  returned by││  returned by│
               │  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery ││  a subquery │
               │  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an ││  used as an │
               │  expression ││  expression ││  expression ││  expression ││  expression ││  expression ││  expression ││  expression ││  expression ││  expression ││  expression ││  expression ││  expression ││  expression ││  expression │
               │   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  ││   - scalar  │
               │  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries ││  subqueries │
               │   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  ││   can only  │
               │   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  ││   return a  │
               │  single row.││  single row.││  single row.││  single row.││  single row.││  single row.││  single row.││  single row.││  single row.││  single row.││  single row.││  single row.││  single row.││  single row.││  single row.│
               │   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  ││   Use "SET  │
               │ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu││ scalar_subqu│
               │ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_││ery_error_on_│
               │multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows││multiple_rows│
               │  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to ││  =false" to │
               │   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to ││   revert to │
               │   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  ││   previous  │
               │  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of││  behavior of│
               │  returning a││  returning a││  returning a││  returning a││  returning a││  returning a││  returning a││  returning a││  returning a││  returning a││  returning a││  returning a││  returning a││  returning a││  returning a│
               │  random row.││  random row.││  random row.││  random row.││  random row.││  random row.││  random row.││  random row.││  random row.││  random row.││  random row.││  random row.││  random row.││  random row.││  random row.│
               │ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 ││ ')) ELSE #0 │
               │      END    ││      END    ││      END    ││      END    ││      END    ││      END    ││      END    ││      END    ││      END    ││      END    ││      END    ││      END    ││      END    ││      END    ││      END    │
               │             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             │
               │    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    │
               │   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   │
               └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘
               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
               │UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  ││UNGROUPE...  │
               │    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   │
               │ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: ││ Aggregates: │
               │ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) ││ "first"(#0) │
               │ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()││ count_star()│
               │             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             │
               │    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    │
               │   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   │
               └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘
               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
               │  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION │
               │    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   │
               │      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     ││      #0     │
               │             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             │
               │    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    │
               │   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   │
               └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘
               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
               │  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION ││  PROJECTION │
               │    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   │
               │      #2     ││      #3     ││      #1     ││      #2     ││      #3     ││      #1     ││      #2     ││      #3     ││      #1     ││      #2     ││      #3     ││      #1     ││      #2     ││      #3     ││      #1     │
               │             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             │
               │    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    │
               │   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   │
               └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘
               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
               │    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   ││    FILTER   │
               │    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   │
               │ (bucket = 3)││ (bucket = 3)││ (bucket = 4)││ (bucket = 4)││ (bucket = 4)││ (bucket = 5)││ (bucket = 5)││ (bucket = 5)││ (bucket = 2)││ (bucket = 2)││ (bucket = 2)││ (bucket = 3)││ (bucket = 1)││ (bucket = 1)││ (bucket = 1)│
               │             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             │
               │    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    ││    1 row    │
               │   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   │
               └──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘└──────┬──────┘
               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
               │   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  ││   CTE_SCAN  │
               │    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   │
               │  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: ││  CTE Index: │
               │      0      ││      0      ││      0      ││      0      ││      0      ││      0      ││      0      ││      0      ││      0      ││      0      ││      0      ││      0      ││      0      ││      0      ││      0      │
               │             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             ││             │
               │    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   ││    5 rows   │
               │   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   │
               └─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘
