-- Q35 EXPLAIN ANALYZE (SF10)
-- State: baseline
-- Best speedup: 1.00x
-- Source SQL: /mnt/d/TPC-DS/queries_duckdb_converted/query_35.sql

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE select     ca_state,   cd_gender,   cd_marital_status,   cd_dep_count,   count(*) cnt1,   max(cd_dep_count),   sum(cd_dep_count),   max(cd_dep_count),   cd_dep_employed_count,   count(*) cnt2,   max(cd_dep_employed_count),   sum(cd_dep_employed_count),   max(cd_dep_employed_count),   cd_dep_college_count,   count(*) cnt3,   max(cd_dep_college_count),   sum(cd_dep_college_count),   max(cd_dep_college_count)  from   customer c,customer_address ca,customer_demographics  where   c.c_current_addr_sk = ca.ca_address_sk and   cd_demo_sk = c.c_current_cdemo_sk and    exists (select *           from store_sales,date_dim           where c.c_customer_sk = ss_customer_sk and                 ss_sold_date_sk = d_date_sk and                 d_year = 2001 and                 d_qoy < 4) and    (exists (select *             from web_sales,date_dim             where c.c_customer_sk = ws_bill_customer_sk and                   ws_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4) or      exists (select *              from catalog_sales,date_dim             where c.c_customer_sk = cs_ship_customer_sk and                   cs_sold_date_sk = d_date_sk and                   d_year = 2001 and                   d_qoy < 4))  group by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  order by ca_state,           cd_gender,           cd_marital_status,           cd_dep_count,           cd_dep_employed_count,           cd_dep_college_count  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.356s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│    TOP_N    │
│    ──────   │
│     Top:    │
│     100     │
│             │
│  Order By:  │
│ ca.ca_state │
│      ASC    │
│  tpcds_sf10 │
│.main.custome│
│r_demographic│
│ s.cd_gender │
│      ASC    │
│  tpcds_sf10 │
│.main.custome│
│r_demographic│
│s.cd_marital_│
│  status ASC │
│  tpcds_sf10 │
│.main.custome│
│r_demographic│
│s.cd_dep_coun│
│    t ASC    │
│  tpcds_sf10 │
│.main.custome│
│r_demographic│
│s.cd_dep_empl│
│  oyed_count │
│      ASC    │
│  tpcds_sf10 │
│.main.custome│
│r_demographic│
│s.cd_dep_coll│
│ege_count ASC│
│             │
│   100 rows  │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│   ca_state  │
│  cd_gender  │
│cd_marital_st│
│     atus    │
│ cd_dep_count│
│     cnt1    │
│max(cd_dep_co│
│     unt)    │
│sum(cd_dep_co│
│     unt)    │
│max(cd_dep_co│
│     unt)    │
│cd_dep_employ│
│   ed_count  │
│     cnt2    │
│max(cd_dep_em│
│ployed_count)│
│sum(cd_dep_em│
│ployed_count)│
│max(cd_dep_em│
│ployed_count)│
│cd_dep_colleg│
│   e_count   │
│     cnt3    │
│max(cd_dep_co│
│ llege_count)│
│sum(cd_dep_co│
│ llege_count)│
│max(cd_dep_co│
│ llege_count)│
│             │
│ 57,571 rows │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│__internal_de│
│compress_stri│
│    ng(#0)   │
│__internal_de│
│compress_stri│
│    ng(#1)   │
│__internal_de│
│compress_stri│
│    ng(#2)   │
│      #3     │
│      #4     │
│      #5     │
│      #6     │
│      #7     │
│      #8     │
│      #9     │
│     #10     │
│     #11     │
│     #12     │
│             │
│ 57,571 rows │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│HASH_GROUP_BY│
│    ──────   │
│   Groups:   │
│      #0     │
│      #1     │
│      #2     │
│      #3     │
│      #4     │
│      #5     │
│             │
│ Aggregates: │
│ count_star()│
│   max(#6)   │
│   sum(#7)   │
│   max(#8)   │
│   sum(#9)   │
│   max(#10)  │
│   sum(#11)  │
│             │
│ 57,571 rows │
│   (0.04s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│   ca_state  │
│  cd_gender  │
│cd_marital_st│
│     atus    │
│ cd_dep_count│
│cd_dep_employ│
│   ed_count  │
│cd_dep_colleg│
│   e_count   │
│ cd_dep_count│
│ cd_dep_count│
│cd_dep_employ│
│   ed_count  │
│cd_dep_employ│
│   ed_count  │
│cd_dep_colleg│
│   e_count   │
│cd_dep_colleg│
│   e_count   │
│             │
│ 77,459 rows │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│__internal_co│
│mpress_string│
│_uinteger(#5)│
│__internal_co│
│mpress_string│
│_utinyint(#0)│
│__internal_co│
│mpress_string│
│_utinyint(#1)│
│      #2     │
│      #3     │
│      #4     │
│             │
│ 77,459 rows │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│      #0     │
│      #1     │
│      #2     │
│      #3     │
│      #4     │
│      #5     │
│             │
│ 77,459 rows │
│   (0.01s)   │
└──────┬──────┘
┌──────┴──────┐
│    FILTER   │
│    ──────   │
│ (SUBQUERY OR│
│   SUBQUERY) │
│             │
│ 77,459 rows │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│LEFT_DEL...  │
│    ──────   │
│  Join Type: │
│     MARK    │
│             │
│ Conditions: │
│c_customer_sk│
│ IS NOT DISTI│
│   NCT FROM  ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────
│ c_customer_s│                                                                                                                                                                                           │                                     
│      k      │                                                                                                                                                                                           │                                     
│             │                                                                                                                                                                                           │                                     
│ Delim Index:│                                                                                                                                                                                           │                                     
│      3      │                                                                                                                                                                                           │                                     
│             │                                                                                                                                                                                           │                                     
│    0 rows   │                                                                                                                                                                                           │                                     
│   (0.02s)   │                                                                                                                                                                                           │                                     
└──────┬──────┘                                                                                                                                                                                           │                                     
┌──────┴──────┐                                                                                                                                                                                    ┌──────┴──────┐                              
│LEFT_DEL...  │                                                                                                                                                                                    │  HASH_JOIN  │                              
│    ──────   │                                                                                                                                                                                    │    ──────   │                              
│  Join Type: │                                                                                                                                                                                    │  Join Type: │                              
│     MARK    │                                                                                                                                                                                    │     MARK    │                              
│             │                                                                                                                                                                                    │             │                              
│ Conditions: │                                                                                                                                                                                    │ Conditions: │                              
│c_customer_sk│                                                                                                                                                                                    │c_customer_sk│                              
│ IS NOT DISTI│                                                                                                                                                                                    │ IS NOT DISTI│                              
│   NCT FROM  ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────┬───────────────────────────────────────────────────────────┐       │   NCT FROM  ├───────┐                      
│ c_customer_s│                                                                                                                │                                                           │       │ c_customer_s│       │                      
│      k      │                                                                                                                │                                                           │       │      k      │       │                      
│             │                                                                                                                │                                                           │       │             │       │                      
│ Delim Index:│                                                                                                                │                                                           │       │             │       │                      
│      2      │                                                                                                                │                                                           │       │             │       │                      
│             │                                                                                                                │                                                           │       │             │       │                      
│    0 rows   │                                                                                                                │                                                           │       │ 200,111 rows│       │                      
│   (0.05s)   │                                                                                                                │                                                           │       │   (0.08s)   │       │                      
└──────┬──────┘                                                                                                                │                                                           │       └──────┬──────┘       │                      
┌──────┴──────┐                                                                                                         ┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
│LEFT_DEL...  │                                                                                                         │  HASH_JOIN  │                                             │HASH_GROUP_BY││COLUMN_D...  ││  PROJECTION │
│    ──────   │                                                                                                         │    ──────   │                                             │    ──────   ││             ││    ──────   │
│  Join Type: │                                                                                                         │  Join Type: │                                             │   Groups:   ││             ││c_customer_sk│
│     SEMI    │                                                                                                         │     MARK    │                                             │      #5     ││             ││             │
│             │                                                                                                         │             │                                             │             ││             ││             │
│ Conditions: │                                                                                                         │ Conditions: │                                             │             ││             ││             │
│c_customer_sk│                                                                                                         │c_customer_sk│                                             │             ││             ││             │
│ IS NOT DISTI│                                                                                                         │ IS NOT DISTI│                                             │             ││             ││             │
│   NCT FROM  ├─────────────────────────────────────┬───────────────────────────────────────────────────────────┐       │   NCT FROM  ├───────┐                                     │             ││             ││             │
│ c_customer_s│                                     │                                                           │       │ c_customer_s│       │                                     │             ││             ││             │
│      k      │                                     │                                                           │       │      k      │       │                                     │             ││             ││             │
│             │                                     │                                                           │       │             │       │                                     │             ││             ││             │
│ Delim Index:│                                     │                                                           │       │             │       │                                     │             ││             ││             │
│      1      │                                     │                                                           │       │             │       │                                     │             ││             ││             │
│             │                                     │                                                           │       │             │       │                                     │             ││             ││             │
│    0 rows   │                                     │                                                           │       │ 200,111 rows│       │                                     │ 200,111 rows││ 200,111 rows││ 635,450 rows│
│   (0.07s)   │                                     │                                                           │       │   (0.03s)   │       │                                     │   (0.02s)   ││   (0.00s)   ││   (0.00s)   │
└──────┬──────┘                                     │                                                           │       └──────┬──────┘       │                                     └─────────────┘└─────────────┘└──────┬──────┘
┌──────┴──────┐                              ┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐                                                            ┌──────┴──────┐
│  HASH_JOIN  │                              │  HASH_JOIN  │                                             │HASH_GROUP_BY││COLUMN_D...  ││  PROJECTION │                                                            │  HASH_JOIN  │
│    ──────   │                              │    ──────   │                                             │    ──────   ││             ││    ──────   │                                                            │    ──────   │
│  Join Type: │                              │  Join Type: │                                             │   Groups:   ││             ││c_customer_sk│                                                            │  Join Type: │
│    INNER    │                              │     SEMI    │                                             │      #5     ││             ││             │                                                            │    INNER    │
│             │                              │             │                                             │             ││             ││             │                                                            │             │
│ Conditions: │                              │ Conditions: │                                             │             ││             ││             │                                                            │ Conditions: │
│ cd_demo_sk =│                              │c_customer_sk│                                             │             ││             ││             │                                                            │cs_ship_custo│
│ c_current_cd├───────┐                      │ IS NOT DISTI├───────┐                                     │             ││             ││             │                                                            │   mer_sk =  ├───────────────
│    emo_sk   │       │                      │   NCT FROM  │       │                                     │             ││             ││             │                                                            │ c_customer_s│               
│             │       │                      │ c_customer_s│       │                                     │             ││             ││             │                                                            │      k      │               
│             │       │                      │      k      │       │                                     │             ││             ││             │                                                            │             │               
│             │       │                      │             │       │                                     │             ││             ││             │                                                            │             │               
│ 482,697 rows│       │                      │ 200,111 rows│       │                                     │ 482,697 rows││ 200,111 rows││ 323,746 rows│                                                            │ 635,450 rows│               
│   (0.15s)   │       │                      │   (0.27s)   │       │                                     │   (0.03s)   ││   (0.00s)   ││   (0.00s)   │                                                            │   (0.02s)   │               
└──────┬──────┘       │                      └──────┬──────┘       │                                     └─────────────┘└─────────────┘└──────┬──────┘                                                            └──────┬──────┘               
┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐               
│  TABLE_SCAN ││  HASH_JOIN  │               │COLUMN_D...  ││  PROJECTION │                                                            │  HASH_JOIN  │                                                            │  HASH_JOIN  │               
│    ──────   ││    ──────   │               │             ││    ──────   │                                                            │    ──────   │                                                            │    ──────   │               
│    Table:   ││  Join Type: │               │             ││c_customer_sk│                                                            │  Join Type: │                                                            │  Join Type: │               
│customer_demo││    INNER    │               │             ││             │                                                            │    INNER    │                                                            │    INNER    │               
│   graphics  ││             │               │             ││             │                                                            │             │                                                            │             │               
│             ││ Conditions: │               │             ││             │                                                            │ Conditions: │                                                            │ Conditions: │               
│    Type:    ││c_current_add│               │             ││             │                                                            │c_customer_sk│                                                            │cs_sold_date_│               
│  Sequential ││r_sk = ca_add│               │             ││             │                                                            │ = ws_bill_cu│                                                            │sk = d_date_s│               
│     Scan    ││   ress_sk   │               │             ││             │                                                            │  stomer_sk  │                                                            │      k      │               
│             ││             │               │             ││             │                                                            │             │                                                            │             │               
│ Projections:││             │               │             ││             │                                                            │             │                                                            │             │               
│  cd_demo_sk ││             │               │             ││             │                                                            │             │                                                            │             │               
│  cd_gender  ││             │               │             ││             │                                                            │             │                                                            │             │               
│cd_marital_st││             │               │             ││             │                                                            │             │                                                            │             │               
│     atus    ││             ├───────┐       │             ││             │                                                            │             ├───────┐                                                    │             ├───────┐       
│ cd_dep_count││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│cd_dep_employ││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│   ed_count  ││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│cd_dep_colleg││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│   e_count   ││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│             ││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│   Filters:  ││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│ cd_demo_sk> ││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│=4 AND cd_dem││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│o_sk<=1920791││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│             ││             │       │       │             ││             │                                                            │             │       │                                                    │             │       │       
│1,920,78...  ││ 500,000 rows│       │       │ 482,697 rows││2,888,23...  │                                                            │ 323,746 rows│       │                                                    │1,590,36...  │       │       
│   (0.01s)   ││   (0.01s)   │       │       │   (0.00s)   ││   (0.00s)   │                                                            │   (0.07s)   │       │                                                    │   (0.01s)   │       │       
└─────────────┘└──────┬──────┘       │       └─────────────┘└──────┬──────┘                                                            └──────┬──────┘       │                                                    └──────┬──────┘       │       
               ┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐                                                            ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐
               │  TABLE_SCAN ││  TABLE_SCAN │               │  HASH_JOIN  │                                                            │  DELIM_SCAN ││  HASH_JOIN  │                                             │  TABLE_SCAN ││    FILTER   │
               │    ──────   ││    ──────   │               │    ──────   │                                                            │    ──────   ││    ──────   │                                             │    ──────   ││    ──────   │
               │    Table:   ││    Table:   │               │  Join Type: │                                                            │ Delim Index:││  Join Type: │                                             │    Table:   ││  (d_date_sk │
               │   customer  ││customer_addr│               │    INNER    │                                                            │      2      ││    INNER    │                                             │catalog_sales││    BETWEEN  │
               │             ││     ess     │               │             │                                                            │             ││             │                                             │             ││  2450815 AND│
               │    Type:    ││             │               │ Conditions: │                                                            │             ││ Conditions: │                                             │    Type:    ││   2452653)  │
               │  Sequential ││    Type:    │               │c_customer_sk│                                                            │             ││ws_sold_date_│                                             │  Sequential ││             │
               │     Scan    ││  Sequential │               │ = ss_custome│                                                            │             ││sk = d_date_s│                                             │     Scan    ││             │
               │             ││     Scan    │               │     r_sk    │                                                            │             ││      k      │                                             │             ││             │
               │ Projections:││             │               │             ├───────┐                                                    │             ││             ├───────┐                                     │ Projections:││             │
               │c_current_add││ Projections:│               │             │       │                                                    │             ││             │       │                                     │cs_ship_custo││             │
               │     r_sk    ││ca_address_sk│               │             │       │                                                    │             ││             │       │                                     │    mer_sk   ││             │
               │c_current_cde││   ca_state  │               │             │       │                                                    │             ││             │       │                                     │cs_sold_date_││             │
               │    mo_sk    ││             │               │             │       │                                                    │             ││             │       │                                     │      sk     ││             │
               │c_customer_sk││             │               │             │       │                                                    │             ││             │       │                                     │             ││             │
               │             ││             │               │             │       │                                                    │             ││             │       │                                     │             ││             │
               │ 500,000 rows││ 250,000 rows│               │2,888,23...  │       │                                                    │    0 rows   ││ 802,887 rows│       │                                     │1,590,36...  ││   274 rows  │
               │   (0.00s)   ││   (0.00s)   │               │   (0.38s)   │       │                                                    │   (0.00s)   ││   (0.01s)   │       │                                     │   (0.48s)   ││   (0.00s)   │
               └─────────────┘└─────────────┘               └──────┬──────┘       │                                                    └─────────────┘└──────┬──────┘       │                                     └─────────────┘└──────┬──────┘
                                                            ┌──────┴──────┐┌──────┴──────┐                                                            ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐
                                                            │  DELIM_SCAN ││  HASH_JOIN  │                                                            │  TABLE_SCAN ││    FILTER   │                                             │  TABLE_SCAN │
                                                            │    ──────   ││    ──────   │                                                            │    ──────   ││    ──────   │                                             │    ──────   │
                                                            │ Delim Index:││  Join Type: │                                                            │    Table:   ││  (d_date_sk │                                             │    Table:   │
                                                            │      1      ││    INNER    │                                                            │  web_sales  ││    BETWEEN  │                                             │   date_dim  │
                                                            │             ││             │                                                            │             ││  2450816 AND│                                             │             │
                                                            │             ││ Conditions: │                                                            │    Type:    ││   2452642)  │                                             │    Type:    │
                                                            │             ││ss_sold_date_│                                                            │  Sequential ││             │                                             │  Sequential │
                                                            │             ││sk = d_date_s│                                                            │     Scan    ││             │                                             │     Scan    │
                                                            │             ││      k      │                                                            │             ││             │                                             │             │
                                                            │             ││             ├───────┐                                                    │ Projections:││             │                                             │ Projections:│
                                                            │             ││             │       │                                                    │ws_bill_custo││             │                                             │  d_date_sk  │
                                                            │             ││             │       │                                                    │    mer_sk   ││             │                                             │             │
                                                            │             ││             │       │                                                    │ws_sold_date_││             │                                             │   Filters:  │
                                                            │             ││             │       │                                                    │      sk     ││             │                                             │ d_year=2001 │
                                                            │             ││             │       │                                                    │             ││             │                                             │   d_qoy<4   │
                                                            │             ││             │       │                                                    │             ││             │                                             │             │
                                                            │    0 rows   ││3,065,39...  │       │                                                    │ 802,887 rows││   274 rows  │                                             │   274 rows  │
                                                            │   (0.00s)   ││   (0.03s)   │       │                                                    │   (0.03s)   ││   (0.00s)   │                                             │   (0.00s)   │
                                                            └─────────────┘└──────┬──────┘       │                                                    └─────────────┘└──────┬──────┘                                             └─────────────┘
                                                                           ┌──────┴──────┐┌──────┴──────┐                                                            ┌──────┴──────┐
                                                                           │  TABLE_SCAN ││    FILTER   │                                                            │  TABLE_SCAN │
                                                                           │    ──────   ││    ──────   │                                                            │    ──────   │
                                                                           │    Table:   ││  (d_date_sk │                                                            │    Table:   │
                                                                           │ store_sales ││    BETWEEN  │                                                            │   date_dim  │
                                                                           │             ││  2450816 AND│                                                            │             │
                                                                           │    Type:    ││   2452642)  │                                                            │    Type:    │
                                                                           │  Sequential ││             │                                                            │  Sequential │
                                                                           │     Scan    ││             │                                                            │     Scan    │
                                                                           │             ││             │                                                            │             │
                                                                           │ Projections:││             │                                                            │ Projections:│
                                                                           │ss_customer_s││             │                                                            │  d_date_sk  │
                                                                           │      k      ││             │                                                            │             │
                                                                           │ss_sold_date_││             │                                                            │   Filters:  │
                                                                           │      sk     ││             │                                                            │ d_year=2001 │
                                                                           │             ││             │                                                            │   d_qoy<4   │
                                                                           │             ││             │                                                            │             │
                                                                           │3,065,39...  ││   274 rows  │                                                            │   274 rows  │
                                                                           │   (0.18s)   ││   (0.00s)   │                                                            │   (0.00s)   │
                                                                           └─────────────┘└──────┬──────┘                                                            └─────────────┘
                                                                                          ┌──────┴──────┐
                                                                                          │  TABLE_SCAN │
                                                                                          │    ──────   │
                                                                                          │    Table:   │
                                                                                          │   date_dim  │
                                                                                          │             │
                                                                                          │    Type:    │
                                                                                          │  Sequential │
                                                                                          │     Scan    │
                                                                                          │             │
                                                                                          │ Projections:│
                                                                                          │  d_date_sk  │
                                                                                          │             │
                                                                                          │   Filters:  │
                                                                                          │ d_year=2001 │
                                                                                          │   d_qoy<4   │
                                                                                          │             │
                                                                                          │   274 rows  │
                                                                                          │   (0.00s)   │
                                                                                          └─────────────┘
