-- Q82 EXPLAIN ANALYZE (SF10)
-- State: optimized (retry3w_1, 1.18x)
-- Best speedup: 1.18x
-- Source SQL: /mnt/c/Users/jakc9/Documents/QueryTorque_V8/retry_collect/q82/w3_optimized.sql

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-05-25' AS DATE) AND CAST('2000-07-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 62 AND 92 AND i_manufact_id IN (129, 270, 821, 423)), filtered_inventory AS (SELECT inv_item_sk FROM inventory JOIN filtered_dates ON d_date_sk = inv_date_sk WHERE inv_quantity_on_hand BETWEEN 100 AND 500) SELECT i_item_id, i_item_desc, i_current_price FROM filtered_items JOIN filtered_inventory ON i_item_sk = inv_item_sk JOIN store_sales ON i_item_sk = ss_item_sk GROUP BY i_item_id, i_item_desc, i_current_price ORDER BY i_item_id LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.154s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────────┐
│           QUERY           │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      EXPLAIN_ANALYZE      │
│    ────────────────────   │
│           0 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│           TOP_N           │
│    ────────────────────   │
│          Top: 100         │
│                           │
│         Order By:         │
│  filtered_items.i_item_id │
│             ASC           │
│                           │
│           6 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│    ────────────────────   │
│          Groups:          │
│             #0            │
│             #1            │
│             #2            │
│                           │
│           6 rows          │
│          (0.03s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│         i_item_id         │
│        i_item_desc        │
│      i_current_price      │
│                           │
│        96,799 rows        │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         HASH_JOIN         │
│    ────────────────────   │
│      Join Type: INNER     │
│                           │
│        Conditions:        ├──────────────┐
│   ss_item_sk = i_item_sk  │              │
│                           │              │
│        96,799 rows        │              │
│          (0.30s)          │              │
└─────────────┬─────────────┘              │
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         TABLE_SCAN        ││         HASH_JOIN         │
│    ────────────────────   ││    ────────────────────   │
│     Table: store_sales    ││      Join Type: INNER     │
│   Type: Sequential Scan   ││                           │
│                           ││        Conditions:        │
│        Projections:       ││  inv_item_sk = i_item_sk  ├───────────────────────────────────────────┐
│         ss_item_sk        ││                           │                                           │
│                           ││                           │                                           │
│      24,554,122 rows      ││          230 rows         │                                           │
│          (0.20s)          ││          (0.03s)          │                                           │
└───────────────────────────┘└─────────────┬─────────────┘                                           │
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │                             │         PROJECTION        │
                             │    ────────────────────   │                             │    ────────────────────   │
                             │        inv_item_sk        │                             │         i_item_sk         │
                             │                           │                             │         i_item_id         │
                             │                           │                             │        i_item_desc        │
                             │                           │                             │      i_current_price      │
                             │                           │                             │                           │
                             │       1,515,780 rows      │                             │          15 rows          │
                             │          (0.00s)          │                             │          (0.00s)          │
                             └─────────────┬─────────────┘                             └─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                             │         PROJECTION        │
                             │    ────────────────────   │                             │    ────────────────────   │
                             │      Join Type: INNER     │                             │             #0            │
                             │                           │                             │             #2            │
                             │        Conditions:        ├──────────────┐              │             #3            │
                             │  inv_date_sk = d_date_sk  │              │              │             #4            │
                             │                           │              │              │                           │
                             │       1,515,780 rows      │              │              │          15 rows          │
                             │          (0.04s)          │              │              │          (0.00s)          │
                             └─────────────┬─────────────┘              │              └─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         TABLE_SCAN        ││           FILTER          ││           FILTER          │
                             │    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
                             │      Table: inventory     ││ (d_date_sk BETWEEN 2450815││ ((i_manufact_id = 129) OR │
                             │   Type: Sequential Scan   ││        AND 2452635)       ││ (i_manufact_id = 270) OR  │
                             │                           ││                           ││ (i_manufact_id = 821) OR  │
                             │        Projections:       ││                           ││   (i_manufact_id = 423))  │
                             │        inv_date_sk        ││                           ││                           │
                             │        inv_item_sk        ││                           ││                           │
                             │                           ││                           ││                           │
                             │          Filters:         ││                           ││                           │
                             │ inv_quantity_on_hand>=100 ││                           ││                           │
                             │  AND inv_quantity_on_hand<││                           ││                           │
                             │            =500           ││                           ││                           │
                             │                           ││                           ││                           │
                             │       1,515,780 rows      ││          61 rows          ││          15 rows          │
                             │          (0.14s)          ││          (0.00s)          ││          (0.00s)          │
                             └───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         TABLE_SCAN        ││         TABLE_SCAN        │
                                                          │    ────────────────────   ││    ────────────────────   │
                                                          │      Table: date_dim      ││        Table: item        │
                                                          │   Type: Sequential Scan   ││   Type: Sequential Scan   │
                                                          │                           ││                           │
                                                          │        Projections:       ││        Projections:       │
                                                          │         d_date_sk         ││      i_current_price      │
                                                          │                           ││       i_manufact_id       │
                                                          │          Filters:         ││         i_item_sk         │
                                                          │ d_date>='2000-05-25'::DATE││         i_item_id         │
                                                          │  AND d_date<='2000-07-24':││        i_item_desc        │
                                                          │           :DATE           ││                           │
                                                          │                           ││          Filters:         │
                                                          │                           ││ i_current_price>=62.00 AND│
                                                          │                           ││   i_current_price<=92.00  │
                                                          │                           ││ optional: i_manufact_id IN│
                                                          │                           ││    (129, 270, 423, 821)   │
                                                          │                           ││                           │
                                                          │          61 rows          ││         3,418 rows        │
                                                          │          (0.00s)          ││          (0.01s)          │
                                                          └───────────────────────────┘└───────────────────────────┘
