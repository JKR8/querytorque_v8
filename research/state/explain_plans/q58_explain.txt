-- Q58 EXPLAIN ANALYZE (SF10)
-- State: baseline
-- Best speedup: 1.06x
-- Source SQL: /mnt/d/TPC-DS/queries_duckdb_converted/query_58.sql

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE with ss_items as  (select i_item_id item_id         ,sum(ss_ext_sales_price) ss_item_rev   from store_sales      ,item      ,date_dim  where ss_item_sk = i_item_sk    and d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-03-24'))    and ss_sold_date_sk   = d_date_sk  group by i_item_id),  cs_items as  (select i_item_id item_id         ,sum(cs_ext_sales_price) cs_item_rev   from catalog_sales       ,item       ,date_dim  where cs_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq = (select d_week_seq                                        from date_dim                                       where d_date = '2001-03-24'))   and  cs_sold_date_sk = d_date_sk  group by i_item_id),  ws_items as  (select i_item_id item_id         ,sum(ws_ext_sales_price) ws_item_rev   from web_sales       ,item       ,date_dim  where ws_item_sk = i_item_sk   and  d_date in (select d_date                   from date_dim                   where d_week_seq =(select d_week_seq                                       from date_dim                                      where d_date = '2001-03-24'))   and ws_sold_date_sk   = d_date_sk  group by i_item_id)   select ss_items.item_id        ,ss_item_rev        ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev        ,cs_item_rev        ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev        ,ws_item_rev        ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev        ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average  from ss_items,cs_items,ws_items  where ss_items.item_id=cs_items.item_id    and ss_items.item_id=ws_items.item_id     and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev    and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev    and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev    and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev  order by ss_items.item_id          ,ss_item_rev  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.120s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│    TOP_N    │
│    ──────   │
│     Top:    │
│     100     │
│             │
│  Order By:  │
│   ss_items  │
│ .item_id ASC│
│   ss_items  │
│ .ss_item_rev│
│      ASC    │
│             │
│    5 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│   item_id   │
│ ss_item_rev │
│    ss_dev   │
│ cs_item_rev │
│    cs_dev   │
│ ws_item_rev │
│    ws_dev   │
│   average   │
│             │
│    5 rows   │
│   (0.02s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│   item_id   │
│ ss_item_rev │
│(CAST(((ss_it│
│   em_rev +  │
│  cs_item_rev│
│) + ws_item_r│
│ev) AS DOUBLE│
│   ) / 3.0)  │
│ cs_item_rev │
│ ws_item_rev │
│             │
│    5 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  HASH_JOIN  │
│    ──────   │
│  Join Type: │
│    INNER    │
│             │
│ Conditions: │
│  item_id =  │
│    item_id  │
│CAST(ss_item_│
│rev AS DECIMA│
│ L(38,3)) >= │
│(0.9 * ws_ite│
│    m_rev)   │
│(0.9 * ss_ite│
│  m_rev) <=  │
│ CAST(ws_item│
│_rev AS DECIM│
│  AL(38,3))  │
│CAST(ss_item_│
│rev AS DECIMA│
│ L(38,3)) <= │
│(1.1 * ws_ite│
│    m_rev)   │
│(1.1 * ss_ite│
│  m_rev) >=  │
│ CAST(ws_item├───────────────────────────────────────────────────────────────────┐
│_rev AS DECIM│                                                                   │
│  AL(38,3))  │                                                                   │
│CAST(ss_item_│                                                                   │
│rev AS DECIMA│                                                                   │
│ L(38,3)) >= │                                                                   │
│(0.9 * cs_ite│                                                                   │
│    m_rev)   │                                                                   │
│(0.9 * ss_ite│                                                                   │
│  m_rev) <=  │                                                                   │
│ CAST(cs_item│                                                                   │
│_rev AS DECIM│                                                                   │
│  AL(38,3))  │                                                                   │
│CAST(ss_item_│                                                                   │
│rev AS DECIMA│                                                                   │
│ L(38,3)) <= │                                                                   │
│(1.1 * cs_ite│                                                                   │
│    m_rev)   │                                                                   │
│(1.1 * ss_ite│                                                                   │
│  m_rev) >=  │                                                                   │
│ CAST(cs_item│                                                                   │
│_rev AS DECIM│                                                                   │
│  AL(38,3))  │                                                                   │
│             │                                                                   │
│    5 rows   │                                                                   │
│   (0.01s)   │                                                                   │
└──────┬──────┘                                                                   │
┌──────┴──────┐                                                            ┌──────┴──────┐
│HASH_GROUP_BY│                                                            │  HASH_JOIN  │
│    ──────   │                                                            │    ──────   │
│   Groups:   │                                                            │  Join Type: │
│      #0     │                                                            │    INNER    │
│             │                                                            │             │
│ Aggregates: │                                                            │ Conditions: │
│   sum(#1)   │                                                            │  item_id =  │
│             │                                                            │    item_id  │
│             │                                                            │CAST(cs_item_│
│             │                                                            │rev AS DECIMA│
│             │                                                            │ L(38,3)) >= │
│             │                                                            │(0.9 * ws_ite│
│             │                                                            │    m_rev)   │
│             │                                                            │(0.9 * cs_ite│
│             │                                                            │  m_rev) <=  │
│             │                                                            │ CAST(ws_item├───────────────────────────────────────────────────────────────────┐
│             │                                                            │_rev AS DECIM│                                                                   │
│             │                                                            │  AL(38,3))  │                                                                   │
│             │                                                            │CAST(cs_item_│                                                                   │
│             │                                                            │rev AS DECIMA│                                                                   │
│             │                                                            │ L(38,3)) <= │                                                                   │
│             │                                                            │(1.1 * ws_ite│                                                                   │
│             │                                                            │    m_rev)   │                                                                   │
│             │                                                            │(1.1 * cs_ite│                                                                   │
│             │                                                            │  m_rev) >=  │                                                                   │
│             │                                                            │ CAST(ws_item│                                                                   │
│             │                                                            │_rev AS DECIM│                                                                   │
│             │                                                            │  AL(38,3))  │                                                                   │
│             │                                                            │             │                                                                   │
│ 35,330 rows │                                                            │   245 rows  │                                                                   │
│   (0.07s)   │                                                            │   (0.06s)   │                                                                   │
└──────┬──────┘                                                            └──────┬──────┘                                                                   │
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
│  PROJECTION │                                                            │HASH_GROUP_BY│                                                            │HASH_GROUP_BY│
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │
│  i_item_id  │                                                            │   Groups:   │                                                            │   Groups:   │
│ss_ext_sales_│                                                            │      #0     │                                                            │      #0     │
│    price    │                                                            │             │                                                            │             │
│             │                                                            │ Aggregates: │                                                            │ Aggregates: │
│             │                                                            │   sum(#1)   │                                                            │   sum(#1)   │
│             │                                                            │             │                                                            │             │
│ 60,096 rows │                                                            │ 23,731 rows │                                                            │ 14,136 rows │
│   (0.00s)   │                                                            │   (0.01s)   │                                                            │   (0.01s)   │
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
│  HASH_JOIN  │                                                            │  PROJECTION │                                                            │  PROJECTION │
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │
│  Join Type: │                                                            │  i_item_id  │                                                            │  i_item_id  │
│    INNER    │                                                            │cs_ext_sales_│                                                            │ws_ext_sales_│
│             │                                                            │    price    │                                                            │    price    │
│ Conditions: ├────────────────────────────────────────────────────┐       │             │                                                            │             │
│ ss_item_sk =│                                                    │       │             │                                                            │             │
│   i_item_sk │                                                    │       │             │                                                            │             │
│             │                                                    │       │             │                                                            │             │
│ 60,096 rows │                                                    │       │ 31,944 rows │                                                            │ 16,511 rows │
│   (0.00s)   │                                                    │       │   (0.00s)   │                                                            │   (0.00s)   │
└──────┬──────┘                                                    │       └──────┬──────┘                                                            └──────┬──────┘
┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐                                                            ┌──────┴──────┐
│  HASH_JOIN  │                                             │  TABLE_SCAN ││  HASH_JOIN  │                                                            │  HASH_JOIN  │
│    ──────   │                                             │    ──────   ││    ──────   │                                                            │    ──────   │
│  Join Type: │                                             │    Table:   ││  Join Type: │                                                            │  Join Type: │
│    INNER    │                                             │     item    ││    INNER    │                                                            │    INNER    │
│             │                                             │             ││             │                                                            │             │
│ Conditions: │                                             │    Type:    ││ Conditions: │                                                            │ Conditions: │
│ss_sold_date_│                                             │  Sequential ││ cs_item_sk =│                                                            │ ws_item_sk =│
│sk = d_date_s├───────┐                                     │     Scan    ││   i_item_sk ├────────────────────────────────────────────────────┐       │   i_item_sk ├────────────────────────────────────────────────────┐
│      k      │       │                                     │             ││             │                                                    │       │             │                                                    │
│             │       │                                     │ Projections:││             │                                                    │       │             │                                                    │
│             │       │                                     │  i_item_sk  ││             │                                                    │       │             │                                                    │
│             │       │                                     │  i_item_id  ││             │                                                    │       │             │                                                    │
│             │       │                                     │             ││             │                                                    │       │             │                                                    │
│ 60,096 rows │       │                                     │ 102,000 rows││ 31,944 rows │                                                    │       │ 16,511 rows │                                                    │
│   (0.01s)   │       │                                     │   (0.00s)   ││   (0.00s)   │                                                    │       │   (0.00s)   │                                                    │
└──────┬──────┘       │                                     └─────────────┘└──────┬──────┘                                                    │       └──────┬──────┘                                                    │
┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐
│  TABLE_SCAN ││  HASH_JOIN  │                                             │  HASH_JOIN  │                                             │  TABLE_SCAN ││  HASH_JOIN  │                                             │  TABLE_SCAN │
│    ──────   ││    ──────   │                                             │    ──────   │                                             │    ──────   ││    ──────   │                                             │    ──────   │
│    Table:   ││  Join Type: │                                             │  Join Type: │                                             │    Table:   ││  Join Type: │                                             │    Table:   │
│ store_sales ││     SEMI    │                                             │    INNER    │                                             │     item    ││    INNER    │                                             │     item    │
│             ││             │                                             │             │                                             │             ││             │                                             │             │
│    Type:    ││ Conditions: │                                             │ Conditions: │                                             │    Type:    ││ Conditions: │                                             │    Type:    │
│  Sequential ││ d_date = #0 │                                             │cs_sold_date_│                                             │  Sequential ││ws_sold_date_│                                             │  Sequential │
│     Scan    ││             │                                             │sk = d_date_s│                                             │     Scan    ││sk = d_date_s│                                             │     Scan    │
│             ││             │                                             │      k      │                                             │             ││      k      │                                             │             │
│ Projections:││             ├───────┐                                     │             ├───────┐                                     │ Projections:││             ├───────┐                                     │ Projections:│
│  ss_item_sk ││             │       │                                     │             │       │                                     │  i_item_sk  ││             │       │                                     │  i_item_sk  │
│ss_sold_date_││             │       │                                     │             │       │                                     │  i_item_id  ││             │       │                                     │  i_item_id  │
│      sk     ││             │       │                                     │             │       │                                     │             ││             │       │                                     │             │
│ss_ext_sales_││             │       │                                     │             │       │                                     │             ││             │       │                                     │             │
│    price    ││             │       │                                     │             │       │                                     │             ││             │       │                                     │             │
│             ││             │       │                                     │             │       │                                     │             ││             │       │                                     │             │
│ 60,096 rows ││    7 rows   │       │                                     │ 31,944 rows │       │                                     │ 102,000 rows││ 16,511 rows │       │                                     │ 102,000 rows│
│   (0.42s)   ││   (0.00s)   │       │                                     │   (0.00s)   │       │                                     │   (0.00s)   ││   (0.00s)   │       │                                     │   (0.00s)   │
└─────────────┘└──────┬──────┘       │                                     └──────┬──────┘       │                                     └─────────────┘└──────┬──────┘       │                                     └─────────────┘
               ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐
               │  TABLE_SCAN ││  PROJECTION │                              │  TABLE_SCAN ││  HASH_JOIN  │                                             │  TABLE_SCAN ││  HASH_JOIN  │
               │    ──────   ││    ──────   │                              │    ──────   ││    ──────   │                                             │    ──────   ││    ──────   │
               │    Table:   ││    d_date   │                              │    Table:   ││  Join Type: │                                             │    Table:   ││  Join Type: │
               │   date_dim  ││             │                              │catalog_sales││     SEMI    │                                             │  web_sales  ││     SEMI    │
               │             ││             │                              │             ││             │                                             │             ││             │
               │    Type:    ││             │                              │    Type:    ││ Conditions: │                                             │    Type:    ││ Conditions: │
               │  Sequential ││             │                              │  Sequential ││ d_date = #0 │                                             │  Sequential ││ d_date = #0 │
               │     Scan    ││             │                              │     Scan    ││             │                                             │     Scan    ││             │
               │             ││             │                              │             ││             │                                             │             ││             │
               │ Projections:││             │                              │ Projections:││             │                                             │ Projections:││             │
               │    d_date   ││             │                              │  cs_item_sk ││             ├───────┐                                     │  ws_item_sk ││             ├───────┐
               │  d_date_sk  ││             │                              │cs_sold_date_││             │       │                                     │ws_sold_date_││             │       │
               │             ││             │                              │      sk     ││             │       │                                     │      sk     ││             │       │
               │   Filters:  ││             │                              │cs_ext_sales_││             │       │                                     │ws_ext_sales_││             │       │
               │  d_date_sk> ││             │                              │    price    ││             │       │                                     │    price    ││             │       │
               │ =2450816 AND││             │                              │             ││             │       │                                     │             ││             │       │
               │  d_date_sk< ││             │                              │             ││             │       │                                     │             ││             │       │
               │   =2452642  ││             │                              │             ││             │       │                                     │             ││             │       │
               │             ││             │                              │             ││             │       │                                     │             ││             │       │
               │    7 rows   ││    7 rows   │                              │ 31,944 rows ││    7 rows   │       │                                     │ 16,511 rows ││    7 rows   │       │
               │   (0.00s)   ││   (0.00s)   │                              │   (0.00s)   ││   (0.00s)   │       │                                     │   (0.03s)   ││   (0.00s)   │       │
               └─────────────┘└──────┬──────┘                              └─────────────┘└──────┬──────┘       │                                     └─────────────┘└──────┬──────┘       │
                              ┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐
                              │  HASH_JOIN  │                                             │  TABLE_SCAN ││  PROJECTION │                                             │  TABLE_SCAN ││  PROJECTION │
                              │    ──────   │                                             │    ──────   ││    ──────   │                                             │    ──────   ││    ──────   │
                              │  Join Type: │                                             │    Table:   ││    d_date   │                                             │    Table:   ││    d_date   │
                              │    INNER    │                                             │   date_dim  ││             │                                             │   date_dim  ││             │
                              │             │                                             │             ││             │                                             │             ││             │
                              │ Conditions: │                                             │    Type:    ││             │                                             │    Type:    ││             │
                              │ d_week_seq =│                                             │  Sequential ││             │                                             │  Sequential ││             │
                              │   SUBQUERY  │                                             │     Scan    ││             │                                             │     Scan    ││             │
                              │             │                                             │             ││             │                                             │             ││             │
                              │             │                                             │ Projections:││             │                                             │ Projections:││             │
                              │             ├───────┐                                     │    d_date   ││             │                                             │    d_date   ││             │
                              │             │       │                                     │  d_date_sk  ││             │                                             │  d_date_sk  ││             │
                              │             │       │                                     │             ││             │                                             │             ││             │
                              │             │       │                                     │   Filters:  ││             │                                             │   Filters:  ││             │
                              │             │       │                                     │  d_date_sk> ││             │                                             │  d_date_sk> ││             │
                              │             │       │                                     │ =2450815 AND││             │                                             │ =2450816 AND││             │
                              │             │       │                                     │  d_date_sk< ││             │                                             │  d_date_sk< ││             │
                              │             │       │                                     │   =2452653  ││             │                                             │   =2452642  ││             │
                              │             │       │                                     │             ││             │                                             │             ││             │
                              │    7 rows   │       │                                     │    7 rows   ││    7 rows   │                                             │    7 rows   ││    7 rows   │
                              │   (0.00s)   │       │                                     │   (0.00s)   ││   (0.00s)   │                                             │   (0.00s)   ││   (0.00s)   │
                              └──────┬──────┘       │                                     └─────────────┘└──────┬──────┘                                             └─────────────┘└──────┬──────┘
                              ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐                                                            ┌──────┴──────┐
                              │  TABLE_SCAN ││  PROJECTION │                                             │  HASH_JOIN  │                                                            │  HASH_JOIN  │
                              │    ──────   ││    ──────   │                                             │    ──────   │                                                            │    ──────   │
                              │    Table:   ││ CASE  WHEN (│                                             │  Join Type: │                                                            │  Join Type: │
                              │   date_dim  ││  (#1 > 1))  │                                             │    INNER    │                                                            │    INNER    │
                              │             ││ THEN ("error│                                             │             │                                                            │             │
                              │    Type:    ││ "('More than│                                             │ Conditions: │                                                            │ Conditions: │
                              │  Sequential ││    one row  │                                             │ d_week_seq =│                                                            │ d_week_seq =│
                              │     Scan    ││  returned by│                                             │   SUBQUERY  │                                                            │   SUBQUERY  │
                              │             ││  a subquery │                                             │             │                                                            │             │
                              │ Projections:││  used as an │                                             │             │                                                            │             │
                              │  d_week_seq ││  expression │                                             │             │                                                            │             │
                              │    d_date   ││   - scalar  │                                             │             │                                                            │             │
                              │             ││  subqueries │                                             │             │                                                            │             │
                              │             ││   can only  │                                             │             │                                                            │             │
                              │             ││   return a  │                                             │             │                                                            │             │
                              │             ││  single row.│                                             │             ├───────┐                                                    │             ├───────┐
                              │             ││   Use "SET  │                                             │             │       │                                                    │             │       │
                              │             ││ scalar_subqu│                                             │             │       │                                                    │             │       │
                              │             ││ery_error_on_│                                             │             │       │                                                    │             │       │
                              │             ││multiple_rows│                                             │             │       │                                                    │             │       │
                              │             ││  =false" to │                                             │             │       │                                                    │             │       │
                              │             ││   revert to │                                             │             │       │                                                    │             │       │
                              │             ││   previous  │                                             │             │       │                                                    │             │       │
                              │             ││  behavior of│                                             │             │       │                                                    │             │       │
                              │             ││  returning a│                                             │             │       │                                                    │             │       │
                              │             ││  random row.│                                             │             │       │                                                    │             │       │
                              │             ││ ')) ELSE #0 │                                             │             │       │                                                    │             │       │
                              │             ││      END    │                                             │             │       │                                                    │             │       │
                              │             ││             │                                             │             │       │                                                    │             │       │
                              │    7 rows   ││    1 row    │                                             │    7 rows   │       │                                                    │    7 rows   │       │
                              │   (0.00s)   ││   (0.00s)   │                                             │   (0.00s)   │       │                                                    │   (0.00s)   │       │
                              └─────────────┘└──────┬──────┘                                             └──────┬──────┘       │                                                    └──────┬──────┘       │
                                             ┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐
                                             │UNGROUPE...  │                                             │  TABLE_SCAN ││  PROJECTION │                                             │  TABLE_SCAN ││  PROJECTION │
                                             │    ──────   │                                             │    ──────   ││    ──────   │                                             │    ──────   ││    ──────   │
                                             │ Aggregates: │                                             │    Table:   ││ CASE  WHEN (│                                             │    Table:   ││ CASE  WHEN (│
                                             │ "first"(#0) │                                             │   date_dim  ││  (#1 > 1))  │                                             │   date_dim  ││  (#1 > 1))  │
                                             │ count_star()│                                             │             ││ THEN ("error│                                             │             ││ THEN ("error│
                                             │             │                                             │    Type:    ││ "('More than│                                             │    Type:    ││ "('More than│
                                             │             │                                             │  Sequential ││    one row  │                                             │  Sequential ││    one row  │
                                             │             │                                             │     Scan    ││  returned by│                                             │     Scan    ││  returned by│
                                             │             │                                             │             ││  a subquery │                                             │             ││  a subquery │
                                             │             │                                             │ Projections:││  used as an │                                             │ Projections:││  used as an │
                                             │             │                                             │  d_week_seq ││  expression │                                             │  d_week_seq ││  expression │
                                             │             │                                             │    d_date   ││   - scalar  │                                             │    d_date   ││   - scalar  │
                                             │             │                                             │             ││  subqueries │                                             │             ││  subqueries │
                                             │             │                                             │             ││   can only  │                                             │             ││   can only  │
                                             │             │                                             │             ││   return a  │                                             │             ││   return a  │
                                             │             │                                             │             ││  single row.│                                             │             ││  single row.│
                                             │             │                                             │             ││   Use "SET  │                                             │             ││   Use "SET  │
                                             │             │                                             │             ││ scalar_subqu│                                             │             ││ scalar_subqu│
                                             │             │                                             │             ││ery_error_on_│                                             │             ││ery_error_on_│
                                             │             │                                             │             ││multiple_rows│                                             │             ││multiple_rows│
                                             │             │                                             │             ││  =false" to │                                             │             ││  =false" to │
                                             │             │                                             │             ││   revert to │                                             │             ││   revert to │
                                             │             │                                             │             ││   previous  │                                             │             ││   previous  │
                                             │             │                                             │             ││  behavior of│                                             │             ││  behavior of│
                                             │             │                                             │             ││  returning a│                                             │             ││  returning a│
                                             │             │                                             │             ││  random row.│                                             │             ││  random row.│
                                             │             │                                             │             ││ ')) ELSE #0 │                                             │             ││ ')) ELSE #0 │
                                             │             │                                             │             ││      END    │                                             │             ││      END    │
                                             │             │                                             │             ││             │                                             │             ││             │
                                             │    1 row    │                                             │    7 rows   ││    1 row    │                                             │    7 rows   ││    1 row    │
                                             │   (0.00s)   │                                             │   (0.00s)   ││   (0.00s)   │                                             │   (0.00s)   ││   (0.00s)   │
                                             └──────┬──────┘                                             └─────────────┘└──────┬──────┘                                             └─────────────┘└──────┬──────┘
                                             ┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
                                             │  PROJECTION │                                                            │UNGROUPE...  │                                                            │UNGROUPE...  │
                                             │    ──────   │                                                            │    ──────   │                                                            │    ──────   │
                                             │      #0     │                                                            │ Aggregates: │                                                            │ Aggregates: │
                                             │             │                                                            │ "first"(#0) │                                                            │ "first"(#0) │
                                             │             │                                                            │ count_star()│                                                            │ count_star()│
                                             │             │                                                            │             │                                                            │             │
                                             │    1 row    │                                                            │    1 row    │                                                            │    1 row    │
                                             │   (0.00s)   │                                                            │   (0.00s)   │                                                            │   (0.00s)   │
                                             └──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘
                                             ┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
                                             │  TABLE_SCAN │                                                            │  PROJECTION │                                                            │  PROJECTION │
                                             │    ──────   │                                                            │    ──────   │                                                            │    ──────   │
                                             │    Table:   │                                                            │      #0     │                                                            │      #0     │
                                             │   date_dim  │                                                            │             │                                                            │             │
                                             │             │                                                            │             │                                                            │             │
                                             │    Type:    │                                                            │             │                                                            │             │
                                             │  Sequential │                                                            │             │                                                            │             │
                                             │     Scan    │                                                            │             │                                                            │             │
                                             │             │                                                            │             │                                                            │             │
                                             │ Projections:│                                                            │             │                                                            │             │
                                             │  d_week_seq │                                                            │             │                                                            │             │
                                             │             │                                                            │             │                                                            │             │
                                             │   Filters:  │                                                            │             │                                                            │             │
                                             │ d_date='2001│                                                            │             │                                                            │             │
                                             │-03-24'::DATE│                                                            │             │                                                            │             │
                                             │             │                                                            │             │                                                            │             │
                                             │    1 row    │                                                            │    1 row    │                                                            │    1 row    │
                                             │   (0.00s)   │                                                            │   (0.00s)   │                                                            │   (0.00s)   │
                                             └─────────────┘                                                            └──────┬──────┘                                                            └──────┬──────┘
                                                                                                                        ┌──────┴──────┐                                                            ┌──────┴──────┐
                                                                                                                        │  TABLE_SCAN │                                                            │  TABLE_SCAN │
                                                                                                                        │    ──────   │                                                            │    ──────   │
                                                                                                                        │    Table:   │                                                            │    Table:   │
                                                                                                                        │   date_dim  │                                                            │   date_dim  │
                                                                                                                        │             │                                                            │             │
                                                                                                                        │    Type:    │                                                            │    Type:    │
                                                                                                                        │  Sequential │                                                            │  Sequential │
                                                                                                                        │     Scan    │                                                            │     Scan    │
                                                                                                                        │             │                                                            │             │
                                                                                                                        │ Projections:│                                                            │ Projections:│
                                                                                                                        │  d_week_seq │                                                            │  d_week_seq │
                                                                                                                        │             │                                                            │             │
                                                                                                                        │   Filters:  │                                                            │   Filters:  │
                                                                                                                        │ d_date='2001│                                                            │ d_date='2001│
                                                                                                                        │-03-24'::DATE│                                                            │-03-24'::DATE│
                                                                                                                        │             │                                                            │             │
                                                                                                                        │    1 row    │                                                            │    1 row    │
                                                                                                                        │   (0.00s)   │                                                            │   (0.00s)   │
                                                                                                                        └─────────────┘                                                            └─────────────┘
