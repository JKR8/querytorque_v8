WITH filtered_store_sales AS (SELECT ss_list_price, CASE WHEN ss_quantity BETWEEN 0 AND 5 THEN 1 WHEN ss_quantity BETWEEN 6 AND 10 THEN 2 WHEN ss_quantity BETWEEN 11 AND 15 THEN 3 WHEN ss_quantity BETWEEN 16 AND 20 THEN 4 WHEN ss_quantity BETWEEN 21 AND 25 THEN 5 WHEN ss_quantity BETWEEN 26 AND 30 THEN 6 END AS bucket FROM store_sales WHERE ((ss_quantity BETWEEN 0 AND 5 AND (ss_list_price BETWEEN 131 AND 141 OR ss_coupon_amt BETWEEN 16798 AND 17798 OR ss_wholesale_cost BETWEEN 25 AND 45)) OR (ss_quantity BETWEEN 6 AND 10 AND (ss_list_price BETWEEN 145 AND 155 OR ss_coupon_amt BETWEEN 14792 AND 15792 OR ss_wholesale_cost BETWEEN 46 AND 66)) OR (ss_quantity BETWEEN 11 AND 15 AND (ss_list_price BETWEEN 150 AND 160 OR ss_coupon_amt BETWEEN 6600 AND 7600 OR ss_wholesale_cost BETWEEN 9 AND 29)) OR (ss_quantity BETWEEN 16 AND 20 AND (ss_list_price BETWEEN 91 AND 101 OR ss_coupon_amt BETWEEN 13493 AND 14493 OR ss_wholesale_cost BETWEEN 36 AND 56)) OR (ss_quantity BETWEEN 21 AND 25 AND (ss_list_price BETWEEN 0 AND 10 OR ss_coupon_amt BETWEEN 7629 AND 8629 OR ss_wholesale_cost BETWEEN 6 AND 26)) OR (ss_quantity BETWEEN 26 AND 30 AND (ss_list_price BETWEEN 89 AND 99 OR ss_coupon_amt BETWEEN 15257 AND 16257 OR ss_wholesale_cost BETWEEN 31 AND 51)))) SELECT AVG(CASE WHEN bucket = 1 THEN ss_list_price END) AS B1_LP, COUNT(CASE WHEN bucket = 1 THEN ss_list_price END) AS B1_CNT, COUNT(DISTINCT CASE WHEN bucket = 1 THEN ss_list_price END) AS B1_CNTD, AVG(CASE WHEN bucket = 2 THEN ss_list_price END) AS B2_LP, COUNT(CASE WHEN bucket = 2 THEN ss_list_price END) AS B2_CNT, COUNT(DISTINCT CASE WHEN bucket = 2 THEN ss_list_price END) AS B2_CNTD, AVG(CASE WHEN bucket = 3 THEN ss_list_price END) AS B3_LP, COUNT(CASE WHEN bucket = 3 THEN ss_list_price END) AS B3_CNT, COUNT(DISTINCT CASE WHEN bucket = 3 THEN ss_list_price END) AS B3_CNTD, AVG(CASE WHEN bucket = 4 THEN ss_list_price END) AS B4_LP, COUNT(CASE WHEN bucket = 4 THEN ss_list_price END) AS B4_CNT, COUNT(DISTINCT CASE WHEN bucket = 4 THEN ss_list_price END) AS B4_CNTD, AVG(CASE WHEN bucket = 5 THEN ss_list_price END) AS B5_LP, COUNT(CASE WHEN bucket = 5 THEN ss_list_price END) AS B5_CNT, COUNT(DISTINCT CASE WHEN bucket = 5 THEN ss_list_price END) AS B5_CNTD, AVG(CASE WHEN bucket = 6 THEN ss_list_price END) AS B6_LP, COUNT(CASE WHEN bucket = 6 THEN ss_list_price END) AS B6_CNT, COUNT(DISTINCT CASE WHEN bucket = 6 THEN ss_list_price END) AS B6_CNTD FROM filtered_store_sales GROUP BY () LIMIT 100