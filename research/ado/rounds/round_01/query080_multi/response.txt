```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "ssr": "WITH filtered_date AS (\n  SELECT d_date_sk\n  FROM date_dim\n  WHERE d_date BETWEEN CAST('1998-08-23' AS DATE) AND CAST('1998-08-23' AS DATE) + INTERVAL '30' DAY\n),\nfiltered_item AS (\n  SELECT i_item_sk\n  FROM item\n  WHERE i_current_price > 50\n    AND i_category IN ('Jewelry', 'Music')\n),\nfiltered_promotion AS (\n  SELECT p_promo_sk\n  FROM promotion\n  WHERE p_channel_email = 'Y'\n    AND p_channel_tv = 'Y'\n    AND p_channel_radio = 'N'\n    AND p_channel_press = 'N'\n    AND p_channel_event = 'Y'\n)\nSELECT s_store_id AS store_id,\n       SUM(ss_ext_sales_price) AS sales,\n       SUM(COALESCE(sr_return_amt, 0)) AS returns,\n       SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit\nFROM store_sales\nLEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number)\nINNER JOIN filtered_date ON ss_sold_date_sk = filtered_date.d_date_sk\nINNER JOIN store ON ss_store_sk = s_store_sk\nINNER JOIN filtered_item ON ss_item_sk = filtered_item.i_item_sk\nINNER JOIN filtered_promotion ON ss_promo_sk = filtered_promotion.p_promo_sk\nWHERE ss_wholesale_cost BETWEEN 63 AND 78\nGROUP BY s_store_id"
      },
      "invariants_kept": ["output_columns", "grain", "required_predicates", "literal_values"],
      "expected_speedup": "2x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "date_cte_isolate",
      "nodes": {
        "csr": "WITH filtered_date AS (\n  SELECT d_date_sk\n  FROM date_dim\n  WHERE d_date BETWEEN CAST('1998-08-23' AS DATE) AND CAST('1998-08-23' AS DATE) + INTERVAL '30' DAY\n),\nfiltered_item AS (\n  SELECT i_item_sk\n  FROM item\n  WHERE i_current_price > 50\n    AND i_category IN ('Jewelry', 'Music')\n),\nfiltered_promotion AS (\n  SELECT p_promo_sk\n  FROM promotion\n  WHERE p_channel_email = 'Y'\n    AND p_channel_tv = 'Y'\n    AND p_channel_radio = 'N'\n    AND p_channel_press = 'N'\n    AND p_channel_event = 'Y'\n)\nSELECT cp_catalog_page_id AS catalog_page_id,\n       SUM(cs_ext_sales_price) AS sales,\n       SUM(COALESCE(cr_return_amount, 0)) AS returns,\n       SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit\nFROM catalog_sales\nLEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number)\nINNER JOIN filtered_date ON cs_sold_date_sk = filtered_date.d_date_sk\nINNER JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk\nINNER JOIN filtered_item ON cs_item_sk = filtered_item.i_item_sk\nINNER JOIN filtered_promotion ON cs_promo_sk = filtered_promotion.p_promo_sk\nWHERE cs_wholesale_cost BETWEEN 63 AND 78\nGROUP BY cp_catalog_page_id"
      },
      "invariants_kept": ["output_columns", "grain", "required_predicates", "literal_values"],
      "expected_speedup": "2x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filtering into CTEs for both ssr and csr, allowing early reduction of fact table joins. Also created filtered CTEs for item and promotion tables to push all dimension filters before joining with large fact tables. This follows star schema best practice of filtering dimensions first. Literal values are preserved exactly."
}
```