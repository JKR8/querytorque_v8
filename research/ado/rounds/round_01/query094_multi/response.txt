```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-10-01' AND CAST('2002-10-01' AS DATE) + INTERVAL '60' DAY",
        "filtered_addresses": "SELECT ca_address_sk FROM customer_address WHERE ca_state IN ('IL', 'KS', 'LA', 'MN', 'MT', 'SC')",
        "filtered_sites": "SELECT web_site_sk FROM web_site WHERE web_gmt_offset >= -5"
      },
      "invariants_kept": ["Date range preserved", "State list preserved", "GMT offset preserved"],
      "expected_speedup": "3x",
      "risk": "low"
    },
    {
      "id": "rs_02", 
      "transform": "decorrelate",
      "nodes": {
        "multi_warehouse_orders": "SELECT ws_order_number FROM web_sales GROUP BY ws_order_number HAVING COUNT(DISTINCT ws_warehouse_sk) > 1",
        "returned_orders_with_reasons": "SELECT DISTINCT wr_order_number FROM web_returns WHERE wr_reason_sk IN (17, 48, 50, 56, 68)",
        "main_query": "SELECT COUNT(DISTINCT ws_order_number) AS \"order count\", SUM(ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws_net_profit) AS \"total net profit\" FROM web_sales ws1 JOIN filtered_dates fd ON ws1.ws_ship_date_sk = fd.d_date_sk JOIN filtered_addresses fa ON ws1.ws_ship_addr_sk = fa.ca_address_sk JOIN filtered_sites fs ON ws1.ws_web_site_sk = fs.web_site_sk JOIN multi_warehouse_orders mwo ON ws1.ws_order_number = mwo.ws_order_number LEFT JOIN returned_orders_with_reasons ror ON ws1.ws_order_number = ror.wr_order_number WHERE ws_list_price BETWEEN 184 AND 213 AND ror.wr_order_number IS NULL GROUP BY () ORDER BY COUNT(DISTINCT ws_order_number) LIMIT 100"
      },
      "invariants_kept": ["Same EXISTS/NOT EXISTS logic", "All filters preserved", "Output columns unchanged"],
      "expected_speedup": "5x", 
      "risk": "medium"
    }
  ],
  "explanation": "1. Isolated date, address, and site filters into CTEs to reduce join sizes early (date_cte_isolate). 2. Decorrelated EXISTS/NOT EXISTS subqueries into separate pre-aggregated CTEs: multi_warehouse_orders finds orders with multiple warehouses, returned_orders_with_reasons finds orders with specific return reasons. The main query now uses efficient joins instead of correlated subqueries. All literal values (dates, states, price range, reason codes) are preserved exactly as in the original."
}
```