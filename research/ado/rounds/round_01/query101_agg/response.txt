```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "main_query": "WITH filtered_dates AS (\n    SELECT d_date_sk, d_date\n    FROM date_dim\n    WHERE d_year = 2000\n)\nSELECT c_customer_sk, c_first_name, c_last_name, COUNT(*) AS cnt\nFROM store_sales\nJOIN store_returns ON ss_ticket_number = sr_ticket_number\nJOIN web_sales ON ss_customer_sk = ws_bill_customer_sk\nJOIN filtered_dates d1 ON sr_returned_date_sk = d1.d_date_sk\nJOIN date_dim d2 ON ws_sold_date_sk = d2.d_date_sk\nJOIN item ON i_item_sk = ss_item_sk\nJOIN customer ON ss_customer_sk = c_customer_sk\nJOIN customer_address ON c_current_addr_sk = ca_address_sk\nJOIN household_demographics ON c_current_hdemo_sk = hd_demo_sk\nWHERE i_category IN ('Children', 'Electronics', 'Women')\n  AND d2.d_date BETWEEN d1.d_date AND (d1.d_date + INTERVAL '90' DAY)\n  AND ca_state IN ('GA', 'IA', 'LA', 'MO', 'SD')\n  AND hd_income_band_sk BETWEEN 12 AND 18\n  AND hd_buy_potential = '0-500'\n  AND ss_sales_price / ss_list_price BETWEEN 34 * 0.01 AND 54 * 0.01\nGROUP BY c_customer_sk, c_first_name, c_last_name\nORDER BY cnt"
      },
      "invariants_kept": [
        "All literal values preserved exactly",
        "Output columns unchanged",
        "Result grain unchanged",
        "All predicates preserved"
      ],
      "expected_speedup": "1.5x-2x",
      "risk": "low"
    }
  ],
  "explanation": "Created filtered_dates CTE to isolate the selective date_dim filter (d1.d_year = 2000) and push it down early. This reduces the join size before connecting to fact tables. The rewrite maintains all original predicates and literal values exactly. Changed implicit joins to explicit JOIN syntax for clarity without affecting semantics."
}
```