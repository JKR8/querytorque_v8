```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "main_query": "WITH filtered_date AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_year = 1999 AND d_moy = 1\n),\nfiltered_ca AS (\n    SELECT ca_address_sk\n    FROM customer_address\n    WHERE ca_gmt_offset = -7\n),\nfiltered_hd AS (\n    SELECT hd_demo_sk\n    FROM household_demographics\n    WHERE hd_buy_potential LIKE '1001-5000%'\n),\ncd_branch1 AS (\n    SELECT cd_demo_sk\n    FROM customer_demographics\n    WHERE cd_marital_status = 'M' AND cd_education_status = 'Unknown'\n),\ncd_branch2 AS (\n    SELECT cd_demo_sk\n    FROM customer_demographics\n    WHERE cd_marital_status = 'W' AND cd_education_status = 'Advanced Degree'\n),\ncustomer_branch1 AS (\n    SELECT c_customer_sk\n    FROM customer\n    JOIN filtered_ca ON ca_address_sk = c_current_addr_sk\n    JOIN cd_branch1 ON cd_demo_sk = c_current_cdemo_sk\n    JOIN filtered_hd ON hd_demo_sk = c_current_hdemo_sk\n),\ncustomer_branch2 AS (\n    SELECT c_customer_sk\n    FROM customer\n    JOIN filtered_ca ON ca_address_sk = c_current_addr_sk\n    JOIN cd_branch2 ON cd_demo_sk = c_current_cdemo_sk\n    JOIN filtered_hd ON hd_demo_sk = c_current_hdemo_sk\n),\nbranch1_data AS (\n    SELECT cc_call_center_id, cc_name, cc_manager, cr_net_loss, cr_item_sk, cr_order_number\n    FROM call_center\n    JOIN catalog_returns ON cr_call_center_sk = cc_call_center_sk\n    JOIN filtered_date ON cr_returned_date_sk = d_date_sk\n    JOIN customer_branch1 ON cr_returning_customer_sk = c_customer_sk\n),\nbranch2_data AS (\n    SELECT cc_call_center_id, cc_name, cc_manager, cr_net_loss, cr_item_sk, cr_order_number\n    FROM call_center\n    JOIN catalog_returns ON cr_call_center_sk = cc_call_center_sk\n    JOIN filtered_date ON cr_returned_date_sk = d_date_sk\n    JOIN customer_branch2 ON cr_returning_customer_sk = c_customer_sk\n),\ncombined_data AS (\n    SELECT * FROM branch1_data\n    UNION ALL\n    SELECT * FROM branch2_data\n)\nSELECT MIN(cc_call_center_id), MIN(cc_name), MIN(cc_manager), MIN(cr_net_loss), MIN(cr_item_sk), MIN(cr_order_number)\nFROM combined_data"
      },
      "invariants_kept": [
        "All original literal values preserved exactly",
        "Same output columns and grain (single-row aggregates)",
        "Same join relationships preserved via filtered CTEs",
        "OR condition split into two disjoint branches via UNION ALL"
      ],
      "expected_speedup": "2x",
      "risk": "low"
    }
  ],
  "explanation": "Split the OR condition on customer_demographics into two disjoint branches using UNION ALL to allow separate execution paths and index utilization. Created filtered CTEs for date_dim, customer_address, and household_demographics to apply filters early and reduce join sizes. The OR condition has only 2 simple branches with different filter values, satisfying the OR_TO_UNION_LIMIT constraint. All literal values are preserved exactly as in the original query."
}
```