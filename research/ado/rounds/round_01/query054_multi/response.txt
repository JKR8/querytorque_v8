```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate, early_filter",
      "nodes": {
        "my_customers": "WITH filtered_date AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_moy = 11 AND d_year = 1998\n),\nfiltered_item AS (\n    SELECT i_item_sk\n    FROM item\n    WHERE i_category = 'Books' AND i_class = 'fiction'\n),\nfiltered_customer AS (\n    SELECT c_customer_sk, c_current_addr_sk\n    FROM customer\n    WHERE c_birth_year BETWEEN 1993 AND 2006\n),\ncs_or_ws_sales AS (\n    SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk, cs_wholesale_cost AS wholesale_cost\n    FROM catalog_sales\n    WHERE cs_wholesale_cost BETWEEN 70 AND 100\n    UNION ALL\n    SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk, ws_wholesale_cost AS wholesale_cost\n    FROM web_sales\n    WHERE ws_wholesale_cost BETWEEN 70 AND 100\n)\nSELECT DISTINCT c.c_customer_sk, c.c_current_addr_sk\nFROM cs_or_ws_sales sales\nINNER JOIN filtered_date d ON sales.sold_date_sk = d.d_date_sk\nINNER JOIN filtered_item i ON sales.item_sk = i.i_item_sk\nINNER JOIN filtered_customer c ON sales.customer_sk = c.c_customer_sk"
      },
      "invariants_kept": [
        "output_columns: c_customer_sk, c_current_addr_sk",
        "filters: d_year=1998, d_moy=11, i_category='Books', i_class='fiction', c_birth_year BETWEEN 1993 AND 2006, wholesale_cost BETWEEN 70 AND 100",
        "join conditions: sold_date_sk = d_date_sk, item_sk = i_item_sk, customer_sk = c_customer_sk",
        "DISTINCT preservation"
      ],
      "expected_speedup": "2x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "date_cte_isolate, early_filter",
      "nodes": {
        "my_revenue": "WITH date_range AS (\n    SELECT d_month_seq + 1 AS start_seq, d_month_seq + 3 AS end_seq\n    FROM date_dim\n    WHERE d_year = 1998 AND d_moy = 11\n),\nfiltered_date AS (\n    SELECT d_date_sk\n    FROM date_dim, date_range\n    WHERE d_month_seq BETWEEN date_range.start_seq AND date_range.end_seq\n),\nfiltered_store AS (\n    SELECT s_county, s_state\n    FROM store\n    WHERE s_state IN ('GA', 'IA', 'LA', 'MO', 'OH', 'PA', 'SD', 'TN', 'TX', 'VA')\n),\nfiltered_ca AS (\n    SELECT ca_address_sk, ca_county, ca_state\n    FROM customer_address\n)\nSELECT c.c_customer_sk, SUM(ss_ext_sales_price) AS revenue\nFROM my_customers c\nINNER JOIN filtered_ca ca ON c.c_current_addr_sk = ca.ca_address_sk\nINNER JOIN filtered_store s ON ca.ca_county = s.s_county AND ca.ca_state = s.s_state\nINNER JOIN store_sales ss ON c.c_customer_sk = ss.ss_customer_sk\nINNER JOIN filtered_date d ON ss.ss_sold_date_sk = d.d_date_sk\nWHERE ss.ss_wholesale_cost BETWEEN 70 AND 100\nGROUP BY c.c_customer_sk"
      },
      "invariants_kept": [
        "output_columns: c_customer_sk, revenue",
        "grain: c_customer_sk",
        "filters: ss_wholesale_cost BETWEEN 70 AND 100, s_state IN list, d_month_seq range",
        "join conditions: c_current_addr_sk = ca_address_sk, ca_county = s_county, ca_state = s_state, ss_sold_date_sk = d_date_sk, c_customer_sk = ss_customer_sk"
      ],
      "expected_speedup": "3x",
      "risk": "low"
    }
  ],
  "explanation": "Applied two independent rewrites: 1) For my_customers, isolated date_dim filter into CTE and pushed item/customer filters early to reduce join sizes before DISTINCT. Also pushed wholesale_cost filter into UNION branches. 2) For my_revenue, pre-computed date range CTE and isolated store/customer_address filters to reduce join cardinality early. Both rewrites maintain exact literal values and semantic invariants while enabling better join order optimization and predicate pushdown."
}
```