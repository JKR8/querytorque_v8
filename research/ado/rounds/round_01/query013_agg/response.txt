```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "semantic_rewrite",
      "nodes": {
        "main_query": "WITH date_cte AS (\n  SELECT d_date_sk\n  FROM date_dim\n  WHERE d_year = 2001\n),\nfiltered_ss AS (\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_sales_price, ss_net_profit,\n         ss_store_sk, ss_sold_date_sk, ss_cdemo_sk, ss_hdemo_sk, ss_addr_sk\n  FROM store_sales\n  WHERE ((ss_sales_price BETWEEN 100.00 AND 150.00) OR (ss_sales_price BETWEEN 50.00 AND 100.00) OR (ss_sales_price BETWEEN 150.00 AND 200.00))\n    AND ((ss_net_profit BETWEEN 100 AND 200) OR (ss_net_profit BETWEEN 150 AND 300) OR (ss_net_profit BETWEEN 50 AND 250))\n)\nSELECT AVG(ss_quantity), AVG(ss_ext_sales_price), AVG(ss_ext_wholesale_cost), SUM(ss_ext_wholesale_cost)\nFROM filtered_ss\nJOIN store ON s_store_sk = ss_store_sk\nJOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\nJOIN household_demographics ON hd_demo_sk = ss_hdemo_sk\nJOIN customer_address ON ca_address_sk = ss_addr_sk\nJOIN date_cte ON ss_sold_date_sk = date_cte.d_date_sk\nWHERE ((cd_marital_status = 'U' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3)\n    OR (cd_marital_status = 'W' AND cd_education_status = 'Secondary' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1)\n    OR (cd_marital_status = 'D' AND cd_education_status = 'Secondary' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1))\n  AND ((ca_country = 'United States' AND ca_state IN ('IA', 'MO', 'TX') AND ss_net_profit BETWEEN 100 AND 200)\n    OR (ca_country = 'United States' AND ca_state IN ('GA', 'LA', 'SD') AND ss_net_profit BETWEEN 150 AND 300)\n    OR (ca_country = 'United States' AND ca_state IN ('TN', 'TX', 'VA') AND ss_net_profit BETWEEN 50 AND 250))"
      },
      "invariants_kept": ["All literal values preserved exactly", "All original predicates maintained", "Same output columns and aggregation grain", "Same result rows as original"],
      "expected_speedup": "1.5x-2x",
      "risk": "low"
    }
  ],
  "explanation": "Applied multiple transforms: 1) Isolated date filter into CTE (date_cte_isolate) to reduce early join cardinality. 2) Pushed sales_price and net_profit range filters into filtered_ss CTE (early_filter) to reduce fact table rows before complex multi-table joins. 3) Preserved original OR structure as required by OR_TO_UNION_LIMIT constraint since splitting would create 9 combinations. 4) Maintained all original literal values and predicate logic exactly."
}
```