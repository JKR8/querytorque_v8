```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '1998-03-13' AND CAST('1998-03-13' AS DATE) + INTERVAL '90' DAY"
      },
      "invariants_kept": ["date filtering preserved exactly", "all joins preserved"],
      "expected_speedup": "1.2x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "decorrelate",
      "nodes": {
        "item_avg_discount": "SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM web_sales ws INNER JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE d.d_date BETWEEN '1998-03-13' AND CAST('1998-03-13' AS DATE) + INTERVAL '90' DAY AND ws.ws_wholesale_cost BETWEEN 26 AND 46 AND ws.ws_sales_price / ws.ws_list_price BETWEEN 34 * 0.01 AND 49 * 0.01 GROUP BY ws_item_sk",
        "main_query": "SELECT SUM(ws.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales ws INNER JOIN item i ON ws.ws_item_sk = i.i_item_sk INNER JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk INNER JOIN item_avg_discount iad ON ws.ws_item_sk = iad.ws_item_sk WHERE (i.i_manufact_id BETWEEN 341 AND 540 OR i.i_category IN ('Home', 'Men', 'Music')) AND d.d_date BETWEEN '1998-03-13' AND CAST('1998-03-13' AS DATE) + INTERVAL '90' DAY AND ws.ws_wholesale_cost BETWEEN 26 AND 46 AND ws.ws_ext_discount_amt > iad.threshold ORDER BY SUM(ws.ws_ext_discount_amt) LIMIT 100"
      },
      "invariants_kept": ["exact same filtering logic", "same aggregation result", "correlation preserved via join"],
      "expected_speedup": "3x",
      "risk": "medium"
    },
    {
      "id": "rs_03", 
      "transform": "or_to_union",
      "nodes": {
        "main_query": "SELECT SUM(ws.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM ( SELECT ws_ext_discount_amt FROM web_sales ws INNER JOIN item i ON ws.ws_item_sk = i.i_item_sk INNER JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE i.i_manufact_id BETWEEN 341 AND 540 AND d.d_date BETWEEN '1998-03-13' AND CAST('1998-03-13' AS DATE) + INTERVAL '90' DAY AND ws.ws_wholesale_cost BETWEEN 26 AND 46 AND ws.ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM web_sales ws2 INNER JOIN date_dim d2 ON ws2.ws_sold_date_sk = d2.d_date_sk WHERE ws2.ws_item_sk = ws.ws_item_sk AND d2.d_date BETWEEN '1998-03-13' AND CAST('1998-03-13' AS DATE) + INTERVAL '90' DAY AND ws2.ws_wholesale_cost BETWEEN 26 AND 46 AND ws2.ws_sales_price / ws2.ws_list_price BETWEEN 34 * 0.01 AND 49 * 0.01) UNION ALL SELECT ws_ext_discount_amt FROM web_sales ws INNER JOIN item i ON ws.ws_item_sk = i.i_item_sk INNER JOIN date_dim d ON ws.ws_sold_date_sk = d.d_date_sk WHERE i.i_category IN ('Home', 'Men', 'Music') AND d.d_date BETWEEN '1998-03-13' AND CAST('1998-03-13' AS DATE) + INTERVAL '90' DAY AND ws.ws_wholesale_cost BETWEEN 26 AND 46 AND ws.ws_ext_discount_amt > (SELECT 1.3 * AVG(ws_ext_discount_amt) FROM web_sales ws2 INNER JOIN date_dim d2 ON ws2.ws_sold_date_sk = d2.d_date_sk WHERE ws2.ws_item_sk = ws.ws_item_sk AND d2.d_date BETWEEN '1998-03-13' AND CAST('1998-03-13' AS DATE) + INTERVAL '90' DAY AND ws2.ws_wholesale_cost BETWEEN 26 AND 46 AND ws2.ws_sales_price / ws2.ws_list_price BETWEEN 34 * 0.01 AND 49 * 0.01) ) AS subquery ORDER BY SUM(ws_ext_discount_amt) LIMIT 100"
      },
      "invariants_kept": ["same result (OR to UNION ALL with disjoint conditions)", "all literal values preserved"],
      "expected_speedup": "2x",
      "risk": "high"
    }
  ],
  "explanation": "Three independent rewrite options: 1) Date CTE isolation to filter dates early (rs_01). 2) Decorrelate subquery by precomputing average discount per item (rs_02) - eliminates per-row subquery execution. 3) Split OR condition into UNION ALL for potentially better index usage (rs_03). Note rs_03 has higher risk due to constraint warnings about OR expansion causing regression if overused. The decorrelation transform (rs_02) likely provides the best speedup by eliminating correlated execution. All transforms preserve exact literal values as required."
}
```