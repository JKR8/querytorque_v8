```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "main_query": "WITH date_filtered AS (\n    SELECT d_date_sk FROM date_dim WHERE d_year = 1998\n),\ncd_filtered AS (\n    SELECT cd_demo_sk FROM customer_demographics \n    WHERE cd_gender = 'F' AND cd_education_status = 'College'\n),\nc_filtered AS (\n    SELECT c_customer_sk, c_current_addr_sk, c_birth_year FROM customer \n    WHERE c_birth_month = 1\n),\nca_filtered AS (\n    SELECT ca_address_sk, ca_country, ca_state, ca_county FROM customer_address \n    WHERE ca_state IN ('GA', 'LA', 'SD')\n),\nitem_filtered AS (\n    SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Jewelry'\n)\nSELECT i_item_id, ca_country, ca_state, ca_county, \n       AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n       AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n       AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n       AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n       AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n       AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6\nFROM catalog_sales cs\nJOIN date_filtered d ON cs.cs_sold_date_sk = d.d_date_sk\nJOIN cd_filtered cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk\nJOIN c_filtered c ON cs.cs_bill_customer_sk = c.c_customer_sk\nJOIN ca_filtered ca ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN item_filtered i ON cs.cs_item_sk = i.i_item_sk\nWHERE cs.cs_wholesale_cost BETWEEN 52 AND 57\nGROUP BY ROLLUP (i_item_id, ca_country, ca_state, ca_county)\nORDER BY ca_country, ca_state, ca_county, i_item_id\nLIMIT 100"
      },
      "invariants_kept": [
        "output columns and grain",
        "all literal values preserved exactly",
        "ROLLUP grouping preserved",
        "aggregate calculations unchanged",
        "join relationships preserved"
      ],
      "expected_speedup": "2x-3x",
      "risk": "low"
    }
  ],
  "explanation": "Created filtered CTEs for each dimension table to push predicates early and reduce intermediate join sizes. The date_dim filter (d_year=1998) is isolated in a CTE per QT-OPT-003. Other dimension filters (customer_demographics, customer, customer_address, item) are also pushed into CTEs. This forces the optimizer to filter small dimension tables first before joining to the large catalog_sales table. All literal values are preserved exactly as required. The IN clause with 3 values is left intact (no ORâ†’UNION expansion)."
}
```