```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "early_filter",
      "nodes": {
        "main_query": "WITH filtered_address AS (\n  SELECT ca_address_sk\n  FROM customer_address\n  WHERE ca_city = 'Lakeview'\n),\nfiltered_income_band AS (\n  SELECT ib_income_band_sk\n  FROM income_band\n  WHERE ib_lower_bound >= 69452\n    AND ib_upper_bound <= 69452 + 50000\n)\nSELECT c_customer_id AS customer_id,\n       COALESCE(c_last_name, '') || ', ' || COALESCE(c_first_name, '') AS customername\nFROM customer\nJOIN filtered_address ON c_current_addr_sk = ca_address_sk\nJOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk\nJOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk\nJOIN filtered_income_band ON ib_income_band_sk = hd_income_band_sk\nJOIN store_returns ON sr_cdemo_sk = cd_demo_sk\nORDER BY c_customer_id\nLIMIT 100"
      },
      "invariants_kept": [
        "output_columns: customer_id, customername",
        "all join conditions preserved",
        "all filter predicates preserved",
        "ordering and limit preserved",
        "literal values preserved exactly: 'Lakeview', 69452, 50000"
      ],
      "expected_speedup": "2x-5x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "reorder_join",
      "nodes": {
        "main_query": "WITH filtered_address AS (\n  SELECT ca_address_sk\n  FROM customer_address\n  WHERE ca_city = 'Lakeview'\n),\nfiltered_income_band AS (\n  SELECT ib_income_band_sk\n  FROM income_band\n  WHERE ib_lower_bound >= 69452\n    AND ib_upper_bound <= 69452 + 50000\n),\nfiltered_customers AS (\n  SELECT c_customer_id, c_last_name, c_first_name, c_current_cdemo_sk\n  FROM customer\n  JOIN filtered_address ON c_current_addr_sk = ca_address_sk\n  JOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk\n  JOIN filtered_income_band ON ib_income_band_sk = hd_income_band_sk\n)\nSELECT c_customer_id AS customer_id,\n       COALESCE(c_last_name, '') || ', ' || COALESCE(c_first_name, '') AS customername\nFROM filtered_customers\nJOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk\nJOIN store_returns ON sr_cdemo_sk = cd_demo_sk\nORDER BY c_customer_id\nLIMIT 100"
      },
      "invariants_kept": [
        "output_columns: customer_id, customername",
        "all join conditions preserved",
        "all filter predicates preserved",
        "ordering and limit preserved",
        "literal values preserved exactly: 'Lakeview', 69452, 50000"
      ],
      "expected_speedup": "3x-7x",
      "risk": "medium"
    }
  ],
  "explanation": "Rewrote query using two approaches: 1) Early filtering via CTEs for dimension tables with selective predicates (customer_address.city='Lakeview' and income_band bounds), reducing the working set before large fact table joins. 2) Additionally reordering joins to filter customers first using dimension constraints before joining to store_returns fact table. Both approaches leverage star schema optimization by filtering dimensions first, reducing the cardinality of intermediate results. The second approach is more aggressive but should provide better performance by completely isolating dimension filtering before the fact table join."
}
```