```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "main_query": "WITH date_filter AS (\n    SELECT DISTINCT d_date_sk\n    FROM date_dim\n    WHERE d_month_seq IN (\n        SELECT d_month_seq\n        FROM date_dim\n        WHERE d_date IN ('2002-02-01', '2002-04-11', '2002-07-17', '2002-10-09')\n    )\n),\nsr_items AS (\n    SELECT i_item_id AS item_id,\n           SUM(sr_return_quantity) AS sr_item_qty\n    FROM store_returns\n    JOIN item ON sr_item_sk = i_item_sk\n    JOIN date_filter ON sr_returned_date_sk = date_filter.d_date_sk\n    WHERE i_category IN ('Jewelry', 'Music')\n      AND i_manager_id BETWEEN 16 AND 25\n      AND sr_return_amt / sr_return_quantity BETWEEN 184 AND 213\n      AND sr_reason_sk IN (26, 32, 40, 66, 73)\n    GROUP BY i_item_id\n),\ncr_items AS (\n    SELECT i_item_id AS item_id,\n           SUM(cr_return_quantity) AS cr_item_qty\n    FROM catalog_returns\n    JOIN item ON cr_item_sk = i_item_sk\n    JOIN date_filter ON cr_returned_date_sk = date_filter.d_date_sk\n    WHERE i_category IN ('Jewelry', 'Music')\n      AND i_manager_id BETWEEN 16 AND 25\n      AND cr_return_amount / cr_return_quantity BETWEEN 184 AND 213\n      AND cr_reason_sk IN (26, 32, 40, 66, 73)\n    GROUP BY i_item_id\n)\nSELECT sr_items.item_id,\n       sr_item_qty,\n       sr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS sr_dev,\n       cr_item_qty,\n       cr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS cr_dev,\n       wr_item_qty,\n       wr_item_qty / (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 * 100 AS wr_dev,\n       (sr_item_qty + cr_item_qty + wr_item_qty) / 3.0 AS average\nFROM sr_items,\n     cr_items,\n     wr_items\nWHERE sr_items.item_id = cr_items.item_id\n  AND sr_items.item_id = wr_items.item_id\nORDER BY sr_items.item_id,\n         sr_item_qty\nLIMIT 100"
      },
      "invariants_kept": [
        "All literal values preserved exactly",
        "Output columns unchanged",
        "Aggregation grain unchanged",
        "Date filtering semantics preserved"
      ],
      "expected_speedup": "1.5x-2x",
      "risk": "low"
    }
  ],
  "explanation": "Created a common date_filter CTE that isolates the date_dim subquery pattern used in both sr_items and cr_items. This prevents repeated execution of the same subquery and allows early filtering of fact tables by joining directly with the filtered date keys. The rewrite maintains all literal values and filtering conditions exactly as in the original, while optimizing the access pattern by pushing date filtering before joins."
}
```