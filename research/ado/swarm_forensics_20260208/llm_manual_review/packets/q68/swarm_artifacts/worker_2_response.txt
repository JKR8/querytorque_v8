```sql
WITH filtered_date AS (
  SELECT d_date_sk
  FROM date_dim
  WHERE d_dom BETWEEN 1 AND 2
    AND d_year IN (1998, 1998 + 1, 1998 + 2)
),
filtered_store AS (
  SELECT s_store_sk
  FROM store
  WHERE s_city IN ('Pleasant Hill', 'Five Points')
),
filtered_household_demographics AS (
  SELECT hd_demo_sk
  FROM household_demographics
  WHERE hd_dep_count = 8
     OR hd_vehicle_count = -1
),
sales_aggregated AS (
  SELECT
    ss_ticket_number,
    ss_customer_sk,
    ca_city AS bought_city,
    SUM(ss_ext_sales_price) AS extended_price,
    SUM(ss_ext_list_price) AS list_price,
    SUM(ss_ext_tax) AS extended_tax
  FROM store_sales
  JOIN filtered_date ON ss_sold_date_sk = d_date_sk
  JOIN filtered_store ON ss_store_sk = s_store_sk
  JOIN filtered_household_demographics ON ss_hdemo_sk = hd_demo_sk
  JOIN customer_address ON ss_addr_sk = ca_address_sk
  GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city
)
SELECT
  c_last_name,
  c_first_name,
  current_addr.ca_city,
  bought_city,
  ss_ticket_number,
  extended_price,
  extended_tax,
  list_price
FROM sales_aggregated
JOIN customer ON ss_customer_sk = c_customer_sk
JOIN customer_address AS current_addr ON customer.c_current_addr_sk = current_addr.ca_address_sk
WHERE current_addr.ca_city <> bought_city
ORDER BY c_last_name, ss_ticket_number
LIMIT 100
```

**Changes**: Isolated date, store, and household demographics filters into separate CTEs before joining with the fact table. This allows predicate pushdown and creates small hash tables for efficient probing during the fact table join.

**Expected speedup**: 1.5â€“2x, due to reduced dimension table scans and early filtering before the large fact table join.