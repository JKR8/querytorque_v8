```sql
WITH filtered_household AS (
  SELECT hd_demo_sk
  FROM household_demographics
  WHERE hd_buy_potential = '501-1000'
),
filtered_customer AS (
  SELECT cd_demo_sk
  FROM customer_demographics
  WHERE cd_marital_status = 'W'
),
filtered_d1 AS (
  SELECT d_date_sk, d_week_seq, d_date
  FROM date_dim
  WHERE d_year = 2002
),
prejoined_core AS (
  SELECT
    cs.cs_item_sk,
    cs.cs_order_number,
    cs.cs_quantity,
    cs.cs_promo_sk,
    cs.cs_ship_date_sk,
    d1.d_week_seq,
    d1.d_date,
    i.i_item_desc,
    inv.inv_warehouse_sk,
    inv.inv_quantity_on_hand,
    inv.inv_date_sk
  FROM catalog_sales cs
  JOIN filtered_d1 d1 ON cs.cs_sold_date_sk = d1.d_date_sk
  JOIN filtered_household hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk
  JOIN filtered_customer cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk
  JOIN item i ON cs.cs_item_sk = i.i_item_sk
  JOIN inventory inv ON cs.cs_item_sk = inv.inv_item_sk
  WHERE inv.inv_quantity_on_hand < cs.cs_quantity
),
joined_d2 AS (
  SELECT
    core.*,
    d2.d_date_sk AS d2_date_sk
  FROM prejoined_core core
  JOIN date_dim d2 ON core.inv_date_sk = d2.d_date_sk
    AND core.d_week_seq = d2.d_week_seq
),
joined_d3 AS (
  SELECT
    core.*,
    d3.d_date_sk AS d3_date_sk
  FROM joined_d2 core
  JOIN date_dim d3 ON core.cs_ship_date_sk = d3.d_date_sk
    AND d3.d_date > core.d_date + 5
),
joined_warehouse AS (
  SELECT
    core.*,
    w.w_warehouse_name
  FROM joined_d3 core
  JOIN warehouse w ON core.inv_warehouse_sk = w.w_warehouse_sk
)
SELECT
  i_item_desc,
  w_warehouse_name,
  d_week_seq,
  SUM(CASE WHEN p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo,
  SUM(CASE WHEN NOT p_promo_sk IS NULL THEN 1 ELSE 0 END) AS promo,
  COUNT(*) AS total_cnt
FROM joined_warehouse
LEFT OUTER JOIN promotion ON cs_promo_sk = p_promo_sk
LEFT OUTER JOIN catalog_returns ON cs_item_sk = cr_item_sk
  AND cs_order_number = cr_order_number
GROUP BY
  i_item_desc,
  w_warehouse_name,
  d_week_seq
ORDER BY
  total_cnt DESC,
  i_item_desc,
  w_warehouse_name,
  d_week_seq
LIMIT 100
```

Changes: Applied aggressive prefetch restructuring by creating layered CTEs: first filtered dimension tables (household_demographics, customer_demographics, date_dim d1), then pre-joined them with catalog_sales, item, and inventory in a core CTE, then sequentially joined remaining date dimensions (d2, d3) and warehouse, and finally performed the outer joins and aggregation in the main query. This reduces early data volume and avoids repeated filtering of the same dimension tables.

Expected speedup: ~2-3x (reduction of large fact table scans via early dimension filtering and pre-joining).