```sql
WITH filtered_date AS (
  SELECT d_date_sk, d_year
  FROM date_dim
  WHERE d_year = 2000
),
non_returned_sales AS (
  -- Store sales without returns
  SELECT 
    d_year,
    ss_item_sk AS item_sk,
    ss_customer_sk AS customer_sk,
    'store' AS channel,
    ss_quantity AS quantity,
    ss_wholesale_cost AS wholesale_cost,
    ss_sales_price AS sales_price
  FROM store_sales
  JOIN filtered_date ON ss_sold_date_sk = d_date_sk
  WHERE NOT EXISTS (
    SELECT 1 FROM store_returns
    WHERE sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk
  )
  UNION ALL
  -- Web sales without returns
  SELECT 
    d_year,
    ws_item_sk AS item_sk,
    ws_bill_customer_sk AS customer_sk,
    'web' AS channel,
    ws_quantity AS quantity,
    ws_wholesale_cost AS wholesale_cost,
    ws_sales_price AS sales_price
  FROM web_sales
  JOIN filtered_date ON ws_sold_date_sk = d_date_sk
  WHERE NOT EXISTS (
    SELECT 1 FROM web_returns
    WHERE wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk
  )
  UNION ALL
  -- Catalog sales without returns
  SELECT 
    d_year,
    cs_item_sk AS item_sk,
    cs_bill_customer_sk AS customer_sk,
    'catalog' AS channel,
    cs_quantity AS quantity,
    cs_wholesale_cost AS wholesale_cost,
    cs_sales_price AS sales_price
  FROM catalog_sales
  JOIN filtered_date ON cs_sold_date_sk = d_date_sk
  WHERE NOT EXISTS (
    SELECT 1 FROM catalog_returns
    WHERE cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk
  )
),
channel_aggregates AS (
  SELECT
    d_year,
    item_sk,
    customer_sk,
    SUM(CASE WHEN channel = 'store' THEN quantity ELSE 0 END) AS ss_qty,
    SUM(CASE WHEN channel = 'store' THEN wholesale_cost ELSE 0 END) AS ss_wc,
    SUM(CASE WHEN channel = 'store' THEN sales_price ELSE 0 END) AS ss_sp,
    SUM(CASE WHEN channel = 'web' THEN quantity ELSE 0 END) AS ws_qty,
    SUM(CASE WHEN channel = 'web' THEN wholesale_cost ELSE 0 END) AS ws_wc,
    SUM(CASE WHEN channel = 'web' THEN sales_price ELSE 0 END) AS ws_sp,
    SUM(CASE WHEN channel = 'catalog' THEN quantity ELSE 0 END) AS cs_qty,
    SUM(CASE WHEN channel = 'catalog' THEN wholesale_cost ELSE 0 END) AS cs_wc,
    SUM(CASE WHEN channel = 'catalog' THEN sales_price ELSE 0 END) AS cs_sp
  FROM non_returned_sales
  GROUP BY d_year, item_sk, customer_sk
)
SELECT
  item_sk AS ss_item_sk,
  ROUND(ss_qty / (COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0)), 2) AS ratio,
  ss_qty AS store_qty,
  ss_wc AS store_wholesale_cost,
  ss_sp AS store_sales_price,
  COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0) AS other_chan_qty,
  COALESCE(ws_wc, 0) + COALESCE(cs_wc, 0) AS other_chan_wholesale_cost,
  COALESCE(ws_sp, 0) + COALESCE(cs_sp, 0) AS other_chan_sales_price
FROM channel_aggregates
WHERE COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0) > 0
ORDER BY
  item_sk,
  ss_qty DESC,
  ss_wc DESC,
  ss_sp DESC,
  other_chan_qty,
  other_chan_wholesale_cost,
  other_chan_sales_price,
  ratio
LIMIT 100
```

Changes: Consolidated the three independent anti-join aggregations into a single pass using UNION ALL, then computed all channel aggregates in one CTE with conditional aggregation. Added a filtered_date CTE to push the year 2000 filter early and avoid redundant date_dim scans.

Expected speedup: 2-3x by eliminating redundant scans of the large fact tables and reducing the number of GROUP BY operations from three to one.