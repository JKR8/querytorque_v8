```sql
WITH filtered_items AS (
    SELECT 
        i_item_sk,
        i_item_id,
        i_item_desc,
        i_category,
        i_class,
        i_current_price
    FROM item
    WHERE i_category IN ('Books', 'Sports', 'Men')
),
filtered_dates AS (
    SELECT 
        d_date_sk
    FROM date_dim
    WHERE d_date BETWEEN CAST('1998-04-06' AS DATE) 
        AND (CAST('1998-04-06' AS DATE) + INTERVAL '30' DAY)
)
SELECT
    i.i_item_id,
    i.i_item_desc,
    i.i_category,
    i.i_class,
    i.i_current_price,
    SUM(ws.ws_ext_sales_price) AS itemrevenue,
    SUM(ws.ws_ext_sales_price) * 100 / SUM(SUM(ws.ws_ext_sales_price)) OVER (PARTITION BY i.i_class) AS revenueratio
FROM web_sales ws
JOIN filtered_items i ON ws.ws_item_sk = i.i_item_sk
JOIN filtered_dates d ON ws.ws_sold_date_sk = d.d_date_sk
GROUP BY
    i.i_item_id,
    i.i_item_desc,
    i.i_category,
    i.i_class,
    i.i_current_price
ORDER BY
    i.i_category,
    i.i_class,
    i.i_item_id,
    i.i_item_desc,
    revenueratio
LIMIT 100
```

```
Changes: Isolated filtered dimension tables (item and date_dim) into separate CTEs before joining with web_sales, enabling independent optimization and predicate pushdown on each dimension.
Expected speedup: 1.5-2x (similar to dimension_cte_isolate pattern)
```