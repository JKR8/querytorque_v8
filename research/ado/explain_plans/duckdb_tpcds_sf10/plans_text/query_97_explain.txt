-- benchmark: tpcds
-- query_id: query_97
-- source_sql: /mnt/d/TPC-DS/queries_duckdb_converted/query_97.sql
-- database: /mnt/d/TPC-DS/tpcds_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 240.353
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE with ssci as ( select ss_customer_sk customer_sk       ,ss_item_sk item_sk from store_sales,date_dim where ss_sold_date_sk = d_date_sk   and d_month_seq between 1214 and 1214 + 11 group by ss_customer_sk         ,ss_item_sk), csci as(  select cs_bill_customer_sk customer_sk       ,cs_item_sk item_sk from catalog_sales,date_dim where cs_sold_date_sk = d_date_sk   and d_month_seq between 1214 and 1214 + 11 group by cs_bill_customer_sk         ,cs_item_sk)  select sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only       ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only       ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog from ssci full outer join csci on (ssci.customer_sk=csci.customer_sk                                and ssci.item_sk = csci.item_sk)  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.239s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────────┐
│           QUERY           │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      EXPLAIN_ANALYZE      │
│    ────────────────────   │
│           0 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      STREAMING_LIMIT      │
│    ────────────────────   │
│           1 row           │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│    UNGROUPED_AGGREGATE    │
│    ────────────────────   │
│        Aggregates:        │
│          sum(#0)          │
│          sum(#1)          │
│          sum(#2)          │
│                           │
│           1 row           │
│          (0.02s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│    CASE  WHEN ((#0 AND    │
│  (customer_sk IS NULL)))  │
│     THEN (1) ELSE 0 END   │
│ CASE  WHEN (((customer_sk │
│  IS NULL) AND (customer_sk│
│   IS NOT NULL))) THEN (1) │
│         ELSE 0 END        │
│    CASE  WHEN ((#0 AND    │
│ (customer_sk IS NOT NULL))│
│   ) THEN (1) ELSE 0 END   │
│                           │
│       8,278,748 rows      │
│          (0.08s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│ (customer_sk IS NOT NULL) │
│        customer_sk        │
│        customer_sk        │
│                           │
│       8,278,748 rows      │
│          (0.01s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         HASH_JOIN         │
│    ────────────────────   │
│      Join Type: FULL      │
│                           │
│        Conditions:        │
│ customer_sk = customer_sk ├───────────────────────────────────────────┐
│     item_sk = item_sk     │                                           │
│                           │                                           │
│       8,278,748 rows      │                                           │
│          (0.65s)          │                                           │
└─────────────┬─────────────┘                                           │
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │                             │       HASH_GROUP_BY       │
│    ────────────────────   │                             │    ────────────────────   │
│          Groups:          │                             │          Groups:          │
│             #0            │                             │             #0            │
│             #1            │                             │             #1            │
│                           │                             │                           │
│       5,426,825 rows      │                             │       2,852,497 rows      │
│          (0.99s)          │                             │          (0.40s)          │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         PROJECTION        │                             │         PROJECTION        │
│    ────────────────────   │                             │    ────────────────────   │
│       ss_customer_sk      │                             │    cs_bill_customer_sk    │
│         ss_item_sk        │                             │         cs_item_sk        │
│                           │                             │                           │
│       5,506,684 rows      │                             │       2,852,997 rows      │
│          (0.00s)          │                             │          (0.00s)          │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         PROJECTION        │                             │         PROJECTION        │
│    ────────────────────   │                             │    ────────────────────   │
│             #0            │                             │             #0            │
│             #1            │                             │             #1            │
│__internal_compress_integra│                             │__internal_compress_integra│
│  l_usmallint(#2, 2450816) │                             │  l_usmallint(#2, 2450815) │
│                           │                             │                           │
│       5,506,684 rows      │                             │       2,852,997 rows      │
│          (0.02s)          │                             │          (0.00s)          │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         HASH_JOIN         │                             │         HASH_JOIN         │
│    ────────────────────   │                             │    ────────────────────   │
│      Join Type: INNER     │                             │      Join Type: INNER     │
│                           │                             │                           │
│        Conditions:        ├──────────────┐              │        Conditions:        ├──────────────┐
│ss_sold_date_sk = d_date_sk│              │              │cs_sold_date_sk = d_date_sk│              │
│                           │              │              │                           │              │
│       5,506,684 rows      │              │              │       2,852,997 rows      │              │
│          (0.06s)          │              │              │          (0.01s)          │              │
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘              │
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         TABLE_SCAN        ││           FILTER          ││         TABLE_SCAN        ││           FILTER          │
│    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
│     Table: store_sales    ││ (d_date_sk BETWEEN 2450816││    Table: catalog_sales   ││ (d_date_sk BETWEEN 2450815│
│   Type: Sequential Scan   ││        AND 2452642)       ││   Type: Sequential Scan   ││        AND 2452653)       │
│                           ││                           ││                           ││                           │
│        Projections:       ││                           ││        Projections:       ││                           │
│      ss_sold_date_sk      ││                           ││      cs_sold_date_sk      ││                           │
│       ss_customer_sk      ││                           ││    cs_bill_customer_sk    ││                           │
│         ss_item_sk        ││                           ││         cs_item_sk        ││                           │
│                           ││                           ││                           ││                           │
│       5,506,684 rows      ││          365 rows         ││       2,852,997 rows      ││          365 rows         │
│          (0.23s)          ││          (0.00s)          ││          (0.03s)          ││          (0.00s)          │
└───────────────────────────┘└─────────────┬─────────────┘└───────────────────────────┘└─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                             │         TABLE_SCAN        │                             │         TABLE_SCAN        │
                             │    ────────────────────   │                             │    ────────────────────   │
                             │      Table: date_dim      │                             │      Table: date_dim      │
                             │   Type: Sequential Scan   │                             │   Type: Sequential Scan   │
                             │                           │                             │                           │
                             │        Projections:       │                             │        Projections:       │
                             │         d_date_sk         │                             │         d_date_sk         │
                             │                           │                             │                           │
                             │          Filters:         │                             │          Filters:         │
                             │   d_month_seq>=1214 AND   │                             │   d_month_seq>=1214 AND   │
                             │      d_month_seq<=1225    │                             │      d_month_seq<=1225    │
                             │                           │                             │                           │
                             │          365 rows         │                             │          365 rows         │
                             │          (0.00s)          │                             │          (0.00s)          │
                             └───────────────────────────┘                             └───────────────────────────┘

