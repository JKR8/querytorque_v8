-- benchmark: tpcds
-- query_id: query_73
-- source_sql: /mnt/d/TPC-DS/queries_duckdb_converted/query_73.sql
-- database: /mnt/d/TPC-DS/tpcds_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 54.017
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE select c_last_name        ,c_first_name        ,c_salutation        ,c_preferred_cust_flag         ,ss_ticket_number        ,cnt from    (select ss_ticket_number           ,ss_customer_sk           ,count(*) cnt     from store_sales,date_dim,store,household_demographics     where store_sales.ss_sold_date_sk = date_dim.d_date_sk     and store_sales.ss_store_sk = store.s_store_sk       and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk     and date_dim.d_dom between 1 and 2      and (household_demographics.hd_buy_potential = '501-1000' or          household_demographics.hd_buy_potential = 'Unknown')     and household_demographics.hd_vehicle_count > 0     and case when household_demographics.hd_vehicle_count > 0 then               household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count else null end > 1     and date_dim.d_year in (2000,2000+1,2000+2)     and store.s_county in ('Fairfield County','Walker County','Daviess County','Barrow County')     group by ss_ticket_number,ss_customer_sk) dj,customer     where ss_customer_sk = c_customer_sk       and cnt between 1 and 5     order by cnt desc, c_last_name asc
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.0527s             ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────────┐
│           QUERY           │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      EXPLAIN_ANALYZE      │
│    ────────────────────   │
│           0 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│__internal_decompress_strin│
│           g(#0)           │
│__internal_decompress_strin│
│           g(#1)           │
│__internal_decompress_strin│
│           g(#2)           │
│__internal_decompress_strin│
│           g(#3)           │
│             #4            │
│             #5            │
│                           │
│          15 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│          ORDER_BY         │
│    ────────────────────   │
│        dj.cnt DESC        │
│  tpcds_sf10.main.customer │
│      .c_last_name ASC     │
│                           │
│          15 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│__internal_compress_string_│
│        uhugeint(#0)       │
│__internal_compress_string_│
│        uhugeint(#1)       │
│__internal_compress_string_│
│        ubigint(#2)        │
│__internal_compress_string_│
│        utinyint(#3)       │
│             #4            │
│             #5            │
│                           │
│          15 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         HASH_JOIN         │
│    ────────────────────   │
│      Join Type: INNER     │
│                           │
│        Conditions:        │
│      c_customer_sk =      ├──────────────┐
│       ss_customer_sk      │              │
│                           │              │
│          15 rows          │              │
│          (0.00s)          │              │
└─────────────┬─────────────┘              │
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         TABLE_SCAN        ││           FILTER          │
│    ────────────────────   ││    ────────────────────   │
│      Table: customer      ││   (cnt BETWEEN 1 AND 5)   │
│   Type: Sequential Scan   ││                           │
│                           ││                           │
│        Projections:       ││                           │
│       c_customer_sk       ││                           │
│        c_last_name        ││                           │
│        c_first_name       ││                           │
│        c_salutation       ││                           │
│   c_preferred_cust_flag   ││                           │
│                           ││                           │
│        486,090 rows       ││          308 rows         │
│          (0.01s)          ││          (0.00s)          │
└───────────────────────────┘└─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐
                             │       HASH_GROUP_BY       │
                             │    ────────────────────   │
                             │          Groups:          │
                             │             #0            │
                             │             #1            │
                             │                           │
                             │        Aggregates:        │
                             │        count_star()       │
                             │                           │
                             │         5,044 rows        │
                             │          (0.01s)          │
                             └─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │
                             │    ────────────────────   │
                             │      ss_ticket_number     │
                             │       ss_customer_sk      │
                             │                           │
                             │        52,259 rows        │
                             │          (0.00s)          │
                             └─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐
                             │         PROJECTION        │
                             │    ────────────────────   │
                             │             #0            │
                             │             #1            │
                             │__internal_compress_integra│
                             │     l_utinyint(#2, 1)     │
                             │                           │
                             │        52,259 rows        │
                             │          (0.00s)          │
                             └─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │
                             │    ────────────────────   │
                             │      Join Type: INNER     │
                             │                           │
                             │        Conditions:        ├────────────────────────────────────────────────────────────────────────┐
                             │  ss_store_sk = s_store_sk │                                                                        │
                             │                           │                                                                        │
                             │        52,259 rows        │                                                                        │
                             │          (0.00s)          │                                                                        │
                             └─────────────┬─────────────┘                                                                        │
                             ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                                                          │           FILTER          │
                             │    ────────────────────   │                                                          │    ────────────────────   │
                             │      Join Type: INNER     │                                                          │    (s_store_sk <= 100)    │
                             │                           │                                                          │                           │
                             │        Conditions:        ├───────────────────────────────────────────┐              │                           │
                             │ss_sold_date_sk = d_date_sk│                                           │              │                           │
                             │                           │                                           │              │                           │
                             │        134,882 rows       │                                           │              │          34 rows          │
                             │          (0.04s)          │                                           │              │          (0.00s)          │
                             └─────────────┬─────────────┘                                           │              └─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         HASH_JOIN         │                             │           FILTER          ││         PROJECTION        │
                             │    ────────────────────   │                             │    ────────────────────   ││    ────────────────────   │
                             │      Join Type: INNER     │                             │ (d_date_sk BETWEEN 2450816││             #0            │
                             │                           │                             │        AND 2452642)       ││                           │
                             │        Conditions:        ├──────────────┐              │                           ││                           │
                             │  ss_hdemo_sk = hd_demo_sk │              │              │                           ││                           │
                             │                           │              │              │                           ││                           │
                             │       1,960,809 rows      │              │              │          72 rows          ││          35 rows          │
                             │          (0.05s)          │              │              │          (0.00s)          ││          (0.00s)          │
                             └─────────────┬─────────────┘              │              └─────────────┬─────────────┘└─────────────┬─────────────┘
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         TABLE_SCAN        ││         PROJECTION        ││         TABLE_SCAN        ││           FILTER          │
                             │    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
                             │     Table: store_sales    ││             #0            ││      Table: date_dim      ││  ((s_county = 'Fairfield  │
                             │   Type: Sequential Scan   ││                           ││   Type: Sequential Scan   ││  County') OR (s_county =  │
                             │                           ││                           ││                           ││    'Walker County') OR    │
                             │        Projections:       ││                           ││        Projections:       ││    (s_county = 'Daviess   │
                             │      ss_sold_date_sk      ││                           ││         d_date_sk         ││  County') OR (s_county =  │
                             │        ss_store_sk        ││                           ││                           ││     'Barrow County'))     │
                             │        ss_hdemo_sk        ││                           ││          Filters:         ││                           │
                             │      ss_ticket_number     ││                           ││   d_dom>=1 AND d_dom<=2   ││                           │
                             │       ss_customer_sk      ││                           ││  d_year>=2000 AND d_year< ││                           │
                             │                           ││                           ││           =2002           ││                           │
                             │                           ││                           ││                           ││                           │
                             │       8,564,318 rows      ││         1,040 rows        ││          72 rows          ││          35 rows          │
                             │          (0.39s)          ││          (0.00s)          ││          (0.00s)          ││          (0.00s)          │
                             └───────────────────────────┘└─────────────┬─────────────┘└───────────────────────────┘└─────────────┬─────────────┘
                                                          ┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
                                                          │           FILTER          │                             │         TABLE_SCAN        │
                                                          │    ────────────────────   │                             │    ────────────────────   │
                                                          │ (((hd_buy_potential = '501│                             │        Table: store       │
                                                          │        -1000') OR         │                             │   Type: Sequential Scan   │
                                                          │    (hd_buy_potential =    │                             │                           │
                                                          │   'Unknown')) AND (CASE   │                             │        Projections:       │
                                                          │  WHEN ((hd_vehicle_count >│                             │         s_store_sk        │
                                                          │       0)) THEN ((CAST     │                             │          s_county         │
                                                          │ (hd_dep_count AS DOUBLE) /│                             │                           │
                                                          │  CAST(hd_vehicle_count AS │                             │          Filters:         │
                                                          │  DOUBLE))) ELSE NULL END >│                             │  optional: s_county IN (  │
                                                          │            1.0))          │                             │    'Fairfield County',    │
                                                          │                           │                             │ 'Walker County', 'Daviess │
                                                          │                           │                             │  County', 'Barrow County')│
                                                          │                           │                             │                           │
                                                          │         1,040 rows        │                             │          102 rows         │
                                                          │          (0.00s)          │                             │          (0.00s)          │
                                                          └─────────────┬─────────────┘                             └───────────────────────────┘
                                                          ┌─────────────┴─────────────┐
                                                          │         TABLE_SCAN        │
                                                          │    ────────────────────   │
                                                          │           Table:          │
                                                          │   household_demographics  │
                                                          │                           │
                                                          │   Type: Sequential Scan   │
                                                          │                           │
                                                          │        Projections:       │
                                                          │         hd_demo_sk        │
                                                          │      hd_buy_potential     │
                                                          │      hd_vehicle_count     │
                                                          │        hd_dep_count       │
                                                          │                           │
                                                          │          Filters:         │
                                                          │ optional: hd_buy_potential│
                                                          │       ='501-1000' OR      │
                                                          │ hd_buy_potential='Unknown'│
                                                          │     hd_vehicle_count>0    │
                                                          │                           │
                                                          │         4,800 rows        │
                                                          │          (0.00s)          │
                                                          └───────────────────────────┘

