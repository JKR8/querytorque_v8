-- benchmark: tpcds
-- query_id: query_33
-- source_sql: /mnt/d/TPC-DS/queries_duckdb_converted/query_33.sql
-- database: /mnt/d/TPC-DS/tpcds_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 66.551
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE with ss as (  select           i_manufact_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_manufact_id in (select   i_manufact_id from  item where i_category in ('Home'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 1  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  cs as (  select           i_manufact_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 1  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5   group by i_manufact_id),  ws as (  select           i_manufact_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_manufact_id               in (select   i_manufact_id from  item where i_category in ('Home'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2002  and     d_moy                   = 1  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -5  group by i_manufact_id)   select i_manufact_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_manufact_id  order by total_sales  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.0641s             ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│    TOP_N    │
│    ──────   │
│     Top:    │
│     100     │
│             │
│  Order By:  │
│   sum(tmp1  │
│ .total_sales│
│    ) ASC    │
│             │
│   100 rows  │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│__internal_de│
│compress_inte│
│ gral_integer│
│   (#0, 1)   │
│      #1     │
│             │
│   980 rows  │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│PERFECT_...  │
│    ──────   │
│   Groups:   │
│      #0     │
│             │
│ Aggregates: │
│   sum(#1)   │
│             │
│   980 rows  │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│i_manufact_id│
│ total_sales │
│             │
│  2,939 rows │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│__internal_co│
│mpress_integr│
│ al_usmallint│
│   (#0, 1)   │
│      #1     │
│             │
│  2,939 rows │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│    UNION    │
│    ──────   │
│    0 rows   ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│   (0.00s)   │                                                                                                                                              │
└──────┬──────┘                                                                                                                                              │
┌──────┴──────┐                                                                                                                                       ┌──────┴──────┐
│    UNION    │                                                                                                                                       │  PROJECTION │
│    ──────   │                                                                                                                                       │    ──────   │
│             │                                                                                                                                       │__internal_de│
│             │                                                                                                                                       │compress_inte│
│             │                                                                                                                                       │ gral_integer│
│             ├───────────────────────────────────────────────────────────────────┐                                                                   │   (#0, 1)   │
│             │                                                                   │                                                                   │      #1     │
│             │                                                                   │                                                                   │             │
│    0 rows   │                                                                   │                                                                   │   979 rows  │
│   (0.00s)   │                                                                   │                                                                   │   (0.00s)   │
└──────┬──────┘                                                                   │                                                                   └──────┬──────┘
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
│  PROJECTION │                                                            │  PROJECTION │                                                            │PERFECT_...  │
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │
│__internal_de│                                                            │__internal_de│                                                            │   Groups:   │
│compress_inte│                                                            │compress_inte│                                                            │      #0     │
│ gral_integer│                                                            │ gral_integer│                                                            │             │
│   (#0, 1)   │                                                            │   (#0, 1)   │                                                            │ Aggregates: │
│      #1     │                                                            │      #1     │                                                            │   sum(#1)   │
│             │                                                            │             │                                                            │             │
│   980 rows  │                                                            │   980 rows  │                                                            │   979 rows  │
│   (0.00s)   │                                                            │   (0.00s)   │                                                            │   (0.00s)   │
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
│PERFECT_...  │                                                            │PERFECT_...  │                                                            │  PROJECTION │
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │
│   Groups:   │                                                            │   Groups:   │                                                            │i_manufact_id│
│      #0     │                                                            │      #0     │                                                            │ws_ext_sales_│
│             │                                                            │             │                                                            │    price    │
│ Aggregates: │                                                            │ Aggregates: │                                                            │             │
│   sum(#1)   │                                                            │   sum(#1)   │                                                            │             │
│             │                                                            │             │                                                            │             │
│   980 rows  │                                                            │   980 rows  │                                                            │ 30,531 rows │
│   (0.00s)   │                                                            │   (0.00s)   │                                                            │   (0.00s)   │
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
│  PROJECTION │                                                            │  PROJECTION │                                                            │  PROJECTION │
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │
│i_manufact_id│                                                            │i_manufact_id│                                                            │__internal_co│
│ss_ext_sales_│                                                            │cs_ext_sales_│                                                            │mpress_integr│
│    price    │                                                            │    price    │                                                            │ al_usmallint│
│             │                                                            │             │                                                            │   (#0, 1)   │
│             │                                                            │             │                                                            │      #1     │
│             │                                                            │             │                                                            │             │
│ 114,324 rows│                                                            │ 50,842 rows │                                                            │ 30,531 rows │
│   (0.00s)   │                                                            │   (0.00s)   │                                                            │   (0.00s)   │
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
│  PROJECTION │                                                            │  PROJECTION │                                                            │  HASH_JOIN  │
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │
│      #0     │                                                            │      #0     │                                                            │  Join Type: │
│__internal_co│                                                            │__internal_co│                                                            │     SEMI    │
│mpress_integr│                                                            │mpress_integr│                                                            │             │
│ al_usmallint│                                                            │ al_usmallint│                                                            │ Conditions: ├────────────────────────────────────────────────────┐
│   (#1, 1)   │                                                            │   (#1, 1)   │                                                            │i_manufact_id│                                                    │
│             │                                                            │             │                                                            │     = #0    │                                                    │
│             │                                                            │             │                                                            │             │                                                    │
│ 114,324 rows│                                                            │ 50,842 rows │                                                            │ 30,531 rows │                                                    │
│   (0.00s)   │                                                            │   (0.00s)   │                                                            │   (0.00s)   │                                                    │
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘                                                    │
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐                                             ┌──────┴──────┐
│  HASH_JOIN  │                                                            │  HASH_JOIN  │                                                            │  HASH_JOIN  │                                             │  TABLE_SCAN │
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │                                             │    ──────   │
│  Join Type: │                                                            │  Join Type: │                                                            │  Join Type: │                                             │    Table:   │
│    INNER    │                                                            │    INNER    │                                                            │    INNER    │                                             │     item    │
│             │                                                            │             │                                                            │             │                                             │             │
│ Conditions: │                                                            │ Conditions: │                                                            │ Conditions: │                                             │    Type:    │
│ ss_item_sk =│                                                            │ cs_item_sk =│                                                            │ i_item_sk = │                                             │  Sequential │
│   i_item_sk │                                                            │   i_item_sk │                                                            │  ws_item_sk │                                             │     Scan    │
│             │                                                            │             │                                                            │             │                                             │             │
│             ├─────────────────────────────────────┐                      │             ├─────────────────────────────────────┐                      │             ├───────┐                                     │ Projections:│
│             │                                     │                      │             │                                     │                      │             │       │                                     │i_manufact_id│
│             │                                     │                      │             │                                     │                      │             │       │                                     │             │
│             │                                     │                      │             │                                     │                      │             │       │                                     │   Filters:  │
│             │                                     │                      │             │                                     │                      │             │       │                                     │ i_category= │
│             │                                     │                      │             │                                     │                      │             │       │                                     │    'Home'   │
│             │                                     │                      │             │                                     │                      │             │       │                                     │             │
│ 114,324 rows│                                     │                      │ 50,842 rows │                                     │                      │ 30,688 rows │       │                                     │ 10,205 rows │
│   (0.00s)   │                                     │                      │   (0.00s)   │                                     │                      │   (0.01s)   │       │                                     │   (0.00s)   │
└──────┬──────┘                                     │                      └──────┬──────┘                                     │                      └──────┬──────┘       │                                     └─────────────┘
┌──────┴──────┐                              ┌──────┴──────┐               ┌──────┴──────┐                              ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐
│  HASH_JOIN  │                              │  HASH_JOIN  │               │  HASH_JOIN  │                              │  HASH_JOIN  │               │  TABLE_SCAN ││  HASH_JOIN  │
│    ──────   │                              │    ──────   │               │    ──────   │                              │    ──────   │               │    ──────   ││    ──────   │
│  Join Type: │                              │  Join Type: │               │  Join Type: │                              │  Join Type: │               │    Table:   ││  Join Type: │
│    INNER    │                              │     SEMI    │               │    INNER    │                              │     SEMI    │               │     item    ││    INNER    │
│             │                              │             │               │             │                              │             │               │             ││             │
│ Conditions: │                              │ Conditions: │               │ Conditions: │                              │ Conditions: │               │    Type:    ││ Conditions: │
│ ss_addr_sk =│                              │i_manufact_id│               │cs_bill_addr_│                              │i_manufact_id│               │  Sequential ││ws_bill_addr_│
│ ca_address_s├──────────────────────┐       │     = #0    ├───────┐       │sk = ca_addre├──────────────────────┐       │     = #0    ├───────┐       │     Scan    ││sk = ca_addre├──────────────────────┐
│      k      │                      │       │             │       │       │    ss_sk    │                      │       │             │       │       │             ││    ss_sk    │                      │
│             │                      │       │             │       │       │             │                      │       │             │       │       │ Projections:││             │                      │
│             │                      │       │             │       │       │             │                      │       │             │       │       │i_manufact_id││             │                      │
│             │                      │       │             │       │       │             │                      │       │             │       │       │  i_item_sk  ││             │                      │
│             │                      │       │             │       │       │             │                      │       │             │       │       │             ││             │                      │
│ 115,169 rows│                      │       │ 101,236 rows│       │       │ 51,218 rows │                      │       │ 101,236 rows│       │       │ 101,731 rows││ 30,778 rows │                      │
│   (0.01s)   │                      │       │   (0.00s)   │       │       │   (0.00s)   │                      │       │   (0.00s)   │       │       │   (0.00s)   ││   (0.00s)   │                      │
└──────┬──────┘                      │       └──────┬──────┘       │       └──────┬──────┘                      │       └──────┬──────┘       │       └─────────────┘└──────┬──────┘                      │
┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐
│  HASH_JOIN  │               │  TABLE_SCAN ││  TABLE_SCAN ││  TABLE_SCAN ││  HASH_JOIN  │               │  TABLE_SCAN ││  TABLE_SCAN ││  TABLE_SCAN │               │  HASH_JOIN  │               │  TABLE_SCAN │
│    ──────   │               │    ──────   ││    ──────   ││    ──────   ││    ──────   │               │    ──────   ││    ──────   ││    ──────   │               │    ──────   │               │    ──────   │
│  Join Type: │               │    Table:   ││    Table:   ││    Table:   ││  Join Type: │               │    Table:   ││    Table:   ││    Table:   │               │  Join Type: │               │    Table:   │
│    INNER    │               │customer_addr││     item    ││     item    ││    INNER    │               │customer_addr││     item    ││     item    │               │    INNER    │               │customer_addr│
│             │               │     ess     ││             ││             ││             │               │     ess     ││             ││             │               │             │               │     ess     │
│ Conditions: │               │             ││    Type:    ││    Type:    ││ Conditions: │               │             ││    Type:    ││    Type:    │               │ Conditions: │               │             │
│ss_sold_date_│               │    Type:    ││  Sequential ││  Sequential ││cs_sold_date_│               │    Type:    ││  Sequential ││  Sequential │               │ws_sold_date_│               │    Type:    │
│sk = d_date_s│               │  Sequential ││     Scan    ││     Scan    ││sk = d_date_s│               │  Sequential ││     Scan    ││     Scan    │               │sk = d_date_s│               │  Sequential │
│      k      │               │     Scan    ││             ││             ││      k      │               │     Scan    ││             ││             │               │      k      │               │     Scan    │
│             ├───────┐       │             ││ Projections:││ Projections:││             ├───────┐       │             ││ Projections:││ Projections:│               │             ├───────┐       │             │
│             │       │       │ Projections:││i_manufact_id││i_manufact_id││             │       │       │ Projections:││i_manufact_id││i_manufact_id│               │             │       │       │ Projections:│
│             │       │       │ca_address_sk││  i_item_sk  ││             ││             │       │       │ca_address_sk││  i_item_sk  ││             │               │             │       │       │ca_address_sk│
│             │       │       │             ││             ││   Filters:  ││             │       │       │             ││             ││   Filters:  │               │             │       │       │             │
│             │       │       │   Filters:  ││             ││ i_category= ││             │       │       │   Filters:  ││             ││ i_category= │               │             │       │       │   Filters:  │
│             │       │       │ca_gmt_offset││             ││    'Home'   ││             │       │       │ca_gmt_offset││             ││    'Home'   │               │             │       │       │ca_gmt_offset│
│             │       │       │    =-5.00   ││             ││             ││             │       │       │    =-5.00   ││             ││             │               │             │       │       │    =-5.00   │
│             │       │       │             ││             ││             ││             │       │       │             ││             ││             │               │             │       │       │             │
│ 315,946 rows│       │       │ 90,666 rows ││ 101,753 rows││ 10,205 rows ││ 141,131 rows│       │       │ 90,666 rows ││ 101,753 rows││ 10,205 rows │               │ 82,514 rows │       │       │ 90,666 rows │
│   (0.05s)   │       │       │   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   │       │       │   (0.00s)   ││   (0.00s)   ││   (0.00s)   │               │   (0.01s)   │       │       │   (0.00s)   │
└──────┬──────┘       │       └─────────────┘└─────────────┘└─────────────┘└──────┬──────┘       │       └─────────────┘└─────────────┘└─────────────┘               └──────┬──────┘       │       └─────────────┘
┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐                                                            ┌──────┴──────┐┌──────┴──────┐
│  TABLE_SCAN ││    FILTER   │                                             │  TABLE_SCAN ││    FILTER   │                                                            │  TABLE_SCAN ││    FILTER   │
│    ──────   ││    ──────   │                                             │    ──────   ││    ──────   │                                                            │    ──────   ││    ──────   │
│    Table:   ││  (d_date_sk │                                             │    Table:   ││  (d_date_sk │                                                            │    Table:   ││  (d_date_sk │
│ store_sales ││    BETWEEN  │                                             │catalog_sales││    BETWEEN  │                                                            │  web_sales  ││    BETWEEN  │
│             ││  2450816 AND│                                             │             ││  2450815 AND│                                                            │             ││  2450816 AND│
│    Type:    ││   2452642)  │                                             │    Type:    ││   2452653)  │                                                            │    Type:    ││   2452642)  │
│  Sequential ││             │                                             │  Sequential ││             │                                                            │  Sequential ││             │
│     Scan    ││             │                                             │     Scan    ││             │                                                            │     Scan    ││             │
│             ││             │                                             │             ││             │                                                            │             ││             │
│ Projections:││             │                                             │ Projections:││             │                                                            │ Projections:││             │
│  ss_item_sk ││             │                                             │  cs_item_sk ││             │                                                            │  ws_item_sk ││             │
│ss_sold_date_││             │                                             │cs_sold_date_││             │                                                            │ws_sold_date_││             │
│      sk     ││             │                                             │      sk     ││             │                                                            │      sk     ││             │
│  ss_addr_sk ││             │                                             │cs_bill_addr_││             │                                                            │ws_bill_addr_││             │
│ss_ext_sales_││             │                                             │      sk     ││             │                                                            │      sk     ││             │
│    price    ││             │                                             │cs_ext_sales_││             │                                                            │ws_ext_sales_││             │
│             ││             │                                             │    price    ││             │                                                            │    price    ││             │
│             ││             │                                             │             ││             │                                                            │             ││             │
│ 315,946 rows││   31 rows   │                                             │ 141,131 rows││   31 rows   │                                                            │ 82,514 rows ││   31 rows   │
│   (0.28s)   ││   (0.00s)   │                                             │   (0.04s)   ││   (0.00s)   │                                                            │   (0.06s)   ││   (0.00s)   │
└─────────────┘└──────┬──────┘                                             └─────────────┘└──────┬──────┘                                                            └─────────────┘└──────┬──────┘
               ┌──────┴──────┐                                                            ┌──────┴──────┐                                                                           ┌──────┴──────┐
               │  TABLE_SCAN │                                                            │  TABLE_SCAN │                                                                           │  TABLE_SCAN │
               │    ──────   │                                                            │    ──────   │                                                                           │    ──────   │
               │    Table:   │                                                            │    Table:   │                                                                           │    Table:   │
               │   date_dim  │                                                            │   date_dim  │                                                                           │   date_dim  │
               │             │                                                            │             │                                                                           │             │
               │    Type:    │                                                            │    Type:    │                                                                           │    Type:    │
               │  Sequential │                                                            │  Sequential │                                                                           │  Sequential │
               │     Scan    │                                                            │     Scan    │                                                                           │     Scan    │
               │             │                                                            │             │                                                                           │             │
               │ Projections:│                                                            │ Projections:│                                                                           │ Projections:│
               │  d_date_sk  │                                                            │  d_date_sk  │                                                                           │  d_date_sk  │
               │             │                                                            │             │                                                                           │             │
               │   Filters:  │                                                            │   Filters:  │                                                                           │   Filters:  │
               │ d_year=2002 │                                                            │ d_year=2002 │                                                                           │ d_year=2002 │
               │   d_moy=1   │                                                            │   d_moy=1   │                                                                           │   d_moy=1   │
               │             │                                                            │             │                                                                           │             │
               │   31 rows   │                                                            │   31 rows   │                                                                           │   31 rows   │
               │   (0.00s)   │                                                            │   (0.00s)   │                                                                           │   (0.00s)   │
               └─────────────┘                                                            └─────────────┘                                                                           └─────────────┘

