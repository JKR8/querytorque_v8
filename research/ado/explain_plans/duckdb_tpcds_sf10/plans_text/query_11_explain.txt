-- benchmark: tpcds
-- query_id: query_11
-- source_sql: /mnt/d/TPC-DS/queries_duckdb_converted/query_11.sql
-- database: /mnt/d/TPC-DS/tpcds_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 923.712
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE with year_total as (  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total        ,'s' sale_type  from customer      ,store_sales      ,date_dim  where c_customer_sk = ss_customer_sk    and ss_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year   union all  select c_customer_id customer_id        ,c_first_name customer_first_name        ,c_last_name customer_last_name        ,c_preferred_cust_flag customer_preferred_cust_flag        ,c_birth_country customer_birth_country        ,c_login customer_login        ,c_email_address customer_email_address        ,d_year dyear        ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total        ,'w' sale_type  from customer      ,web_sales      ,date_dim  where c_customer_sk = ws_bill_customer_sk    and ws_sold_date_sk = d_date_sk  group by c_customer_id          ,c_first_name          ,c_last_name          ,c_preferred_cust_flag           ,c_birth_country          ,c_login          ,c_email_address          ,d_year          )   select                    t_s_secyear.customer_id                  ,t_s_secyear.customer_first_name                  ,t_s_secyear.customer_last_name                  ,t_s_secyear.customer_birth_country  from year_total t_s_firstyear      ,year_total t_s_secyear      ,year_total t_w_firstyear      ,year_total t_w_secyear  where t_s_secyear.customer_id = t_s_firstyear.customer_id          and t_s_firstyear.customer_id = t_w_secyear.customer_id          and t_s_firstyear.customer_id = t_w_firstyear.customer_id          and t_s_firstyear.sale_type = 's'          and t_w_firstyear.sale_type = 'w'          and t_s_secyear.sale_type = 's'          and t_w_secyear.sale_type = 'w'          and t_s_firstyear.dyear = 2001          and t_s_secyear.dyear = 2001+1          and t_w_firstyear.dyear = 2001          and t_w_secyear.dyear = 2001+1          and t_s_firstyear.year_total > 0          and t_w_firstyear.year_total > 0          and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end              > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end  order by t_s_secyear.customer_id          ,t_s_secyear.customer_first_name          ,t_s_secyear.customer_last_name          ,t_s_secyear.customer_birth_country  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.921s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────────┐
│      QUERY      │
└────────┬────────┘
┌────────┴────────┐
│ EXPLAIN_ANALYZE │
│    ──────────   │
│      0 rows     │
│     (0.00s)     │
└────────┬────────┘
┌────────┴────────┐
│      TOP_N      │
│    ──────────   │
│     Top: 100    │
│                 │
│    Order By:    │
│   t_s_secyear   │
│ .customer_id ASC│
│   t_s_secyear   │
│.customer_first_n│
│     ame ASC     │
│   t_s_secyear   │
│.customer_last_na│
│      me ASC     │
│   t_s_secyear   │
│.customer_birth_c│
│    ountry ASC   │
│                 │
│     100 rows    │
│     (0.00s)     │
└────────┬────────┘
┌────────┴────────┐
│    PROJECTION   │
│    ──────────   │
│   customer_id   │
│customer_first_na│
│        me       │
│customer_last_nam│
│        e        │
│customer_birth_co│
│      untry      │
│                 │
│    4,185 rows   │
│     (0.00s)     │
└────────┬────────┘
┌────────┴────────┐
│    PROJECTION   │
│    ──────────   │
│        #0       │
│        #1       │
│        #2       │
│        #5       │
│                 │
│    4,185 rows   │
│     (0.00s)     │
└────────┬────────┘
┌────────┴────────┐
│      FILTER     │
│    ──────────   │
│  (CASE  WHEN (  │
│ (year_total > 0 │
│   .00)) THEN (  │
│ (CAST(year_total│
│   AS DOUBLE) /  │
│  CAST(year_total│
│   AS DOUBLE)))  │
│  ELSE 0.0 END > │
│   CASE  WHEN (  │
│ (year_total > 0 │
│   .00)) THEN (  │
│ (CAST(year_total│
│   AS DOUBLE) /  │
│  CAST(year_total│
│   AS DOUBLE)))  │
│   ELSE 0.0 END) │
│                 │
│    4,185 rows   │
│     (0.00s)     │
└────────┬────────┘
┌────────┴────────┐
│    HASH_JOIN    │
│    ──────────   │
│    Join Type:   │
│      INNER      │
│                 │
│   Conditions:   ├───────────────────────────────────────────────┐
│  customer_id =  │                                               │
│    customer_id  │                                               │
│                 │                                               │
│    8,662 rows   │                                               │
│     (0.02s)     │                                               │
└────────┬────────┘                                               │
┌────────┴────────┐                                      ┌────────┴────────┐
│    PROJECTION   │                                      │    HASH_JOIN    │
│    ──────────   │                                      │    ──────────   │
│   customer_id   │                                      │    Join Type:   │
│customer_first_na│                                      │      INNER      │
│        me       │                                      │                 │
│customer_last_nam│                                      │   Conditions:   │
│        e        │                                      │  customer_id =  ├───────────────────────────────────────────────┐
│customer_birth_co│                                      │    customer_id  │                                               │
│      untry      │                                      │                 │                                               │
│    year_total   │                                      │                 │                                               │
│                 │                                      │                 │                                               │
│   308,164 rows  │                                      │   14,024 rows   │                                               │
│     (0.00s)     │                                      │     (0.02s)     │                                               │
└────────┬────────┘                                      └────────┬────────┘                                               │
┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐
│    PROJECTION   │                                      │    PROJECTION   │                                      │    HASH_JOIN    │
│    ──────────   │                                      │    ──────────   │                                      │    ──────────   │
│        #0       │                                      │   customer_id   │                                      │    Join Type:   │
│__internal_decomp│                                      │    year_total   │                                      │      INNER      │
│ ress_string(#1) │                                      │                 │                                      │                 │
│__internal_decomp│                                      │                 │                                      │   Conditions:   │
│ ress_string(#2) │                                      │                 │                                      │  customer_id =  │
│__internal_decomp│                                      │                 │                                      │    customer_id  │
│ ress_string(#3) │                                      │                 │                                      │                 │
│        #4       │                                      │                 │                                      │                 │
│__internal_decomp│                                      │                 │                                      │                 ├───────────────────────────────────────────────┐
│ ress_string(#5) │                                      │                 │                                      │                 │                                               │
│        #6       │                                      │                 │                                      │                 │                                               │
│__internal_decomp│                                      │                 │                                      │                 │                                               │
│ress_integral_int│                                      │                 │                                      │                 │                                               │
│  eger(#7, 2002) │                                      │                 │                                      │                 │                                               │
│        #8       │                                      │                 │                                      │                 │                                               │
│                 │                                      │                 │                                      │                 │                                               │
│   308,164 rows  │                                      │   106,622 rows  │                                      │   65,536 rows   │                                               │
│     (0.02s)     │                                      │     (0.00s)     │                                      │     (0.03s)     │                                               │
└────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘                                               │
┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐
│  HASH_GROUP_BY  │                                      │    PROJECTION   │                                      │    PROJECTION   │                                      │    PROJECTION   │
│    ──────────   │                                      │    ──────────   │                                      │    ──────────   │                                      │    ──────────   │
│     Groups:     │                                      │        #0       │                                      │        #0       │                                      │        #0       │
│        #0       │                                      │__internal_decomp│                                      │        #8       │                                      │        #8       │
│        #1       │                                      │ ress_string(#1) │                                      │                 │                                      │                 │
│        #2       │                                      │__internal_decomp│                                      │                 │                                      │                 │
│        #3       │                                      │ ress_string(#2) │                                      │                 │                                      │                 │
│        #4       │                                      │__internal_decomp│                                      │                 │                                      │                 │
│        #5       │                                      │ ress_string(#3) │                                      │                 │                                      │                 │
│        #6       │                                      │        #4       │                                      │                 │                                      │                 │
│        #7       │                                      │__internal_decomp│                                      │                 │                                      │                 │
│                 │                                      │ ress_string(#5) │                                      │                 │                                      │                 │
│   Aggregates:   │                                      │        #6       │                                      │                 │                                      │                 │
│     sum(#8)     │                                      │__internal_decomp│                                      │                 │                                      │                 │
│                 │                                      │ress_integral_int│                                      │                 │                                      │                 │
│                 │                                      │  eger(#7, 2002) │                                      │                 │                                      │                 │
│                 │                                      │        #8       │                                      │                 │                                      │                 │
│                 │                                      │                 │                                      │                 │                                      │                 │
│   308,164 rows  │                                      │   106,622 rows  │                                      │   307,969 rows  │                                      │   106,184 rows  │
│     (0.64s)     │                                      │     (0.01s)     │                                      │     (0.00s)     │                                      │     (0.00s)     │
└────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘
┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐
│    PROJECTION   │                                      │  HASH_GROUP_BY  │                                      │      FILTER     │                                      │      FILTER     │
│    ──────────   │                                      │    ──────────   │                                      │    ──────────   │                                      │    ──────────   │
│  c_customer_id  │                                      │     Groups:     │                                      │ (year_total > 0 │                                      │ (year_total > 0 │
│   c_first_name  │                                      │        #0       │                                      │       .00)      │                                      │       .00)      │
│   c_last_name   │                                      │        #1       │                                      │                 │                                      │                 │
│c_preferred_cust_│                                      │        #2       │                                      │                 │                                      │                 │
│       flag      │                                      │        #3       │                                      │                 │                                      │                 │
│ c_birth_country │                                      │        #4       │                                      │                 │                                      │                 │
│     c_login     │                                      │        #5       │                                      │                 │                                      │                 │
│ c_email_address │                                      │        #6       │                                      │                 │                                      │                 │
│      d_year     │                                      │        #7       │                                      │                 │                                      │                 │
│(ss_ext_list_pric│                                      │                 │                                      │                 │                                      │                 │
│e - ss_ext_discou│                                      │   Aggregates:   │                                      │                 │                                      │                 │
│     nt_amt)     │                                      │     sum(#8)     │                                      │                 │                                      │                 │
│                 │                                      │                 │                                      │                 │                                      │                 │
│  5,373,238 rows │                                      │   106,622 rows  │                                      │   307,969 rows  │                                      │   106,184 rows  │
│     (0.01s)     │                                      │     (0.18s)     │                                      │     (0.00s)     │                                      │     (0.00s)     │
└────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘
┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐
│    PROJECTION   │                                      │    PROJECTION   │                                      │    PROJECTION   │                                      │    PROJECTION   │
│    ──────────   │                                      │    ──────────   │                                      │    ──────────   │                                      │    ──────────   │
│        #0       │                                      │  c_customer_id  │                                      │        #0       │                                      │        #0       │
│__internal_compre│                                      │   c_first_name  │                                      │__internal_decomp│                                      │__internal_decomp│
│ss_string_uhugein│                                      │   c_last_name   │                                      │ ress_string(#1) │                                      │ ress_string(#1) │
│      t(#1)      │                                      │c_preferred_cust_│                                      │__internal_decomp│                                      │__internal_decomp│
│__internal_compre│                                      │       flag      │                                      │ ress_string(#2) │                                      │ ress_string(#2) │
│ss_string_uhugein│                                      │ c_birth_country │                                      │__internal_decomp│                                      │__internal_decomp│
│      t(#2)      │                                      │     c_login     │                                      │ ress_string(#3) │                                      │ ress_string(#3) │
│__internal_compre│                                      │ c_email_address │                                      │        #4       │                                      │        #4       │
│ss_string_utinyin│                                      │      d_year     │                                      │__internal_decomp│                                      │__internal_decomp│
│      t(#3)      │                                      │(ws_ext_list_pric│                                      │ ress_string(#5) │                                      │ ress_string(#5) │
│        #4       │                                      │e - ws_ext_discou│                                      │        #6       │                                      │        #6       │
│__internal_compre│                                      │     nt_amt)     │                                      │__internal_decomp│                                      │__internal_decomp│
│ss_string_utinyin│                                      │                 │                                      │ress_integral_int│                                      │ress_integral_int│
│      t(#5)      │                                      │                 │                                      │  eger(#7, 2001) │                                      │  eger(#7, 2001) │
│        #6       │                                      │                 │                                      │        #8       │                                      │        #8       │
│        #7       │                                      │                 │                                      │                 │                                      │                 │
│        #8       │                                      │                 │                                      │                 │                                      │                 │
│__internal_compre│                                      │                 │                                      │                 │                                      │                 │
│ss_integral_utiny│                                      │                 │                                      │                 │                                      │                 │
│  int(#9, 2002)  │                                      │                 │                                      │                 │                                      │                 │
│                 │                                      │                 │                                      │                 │                                      │                 │
│  5,373,238 rows │                                      │  1,438,637 rows │                                      │   307,969 rows  │                                      │   106,184 rows  │
│     (0.11s)     │                                      │     (0.00s)     │                                      │     (0.02s)     │                                      │     (0.01s)     │
└────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘
┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐
│    HASH_JOIN    │                                      │    PROJECTION   │                                      │  HASH_GROUP_BY  │                                      │  HASH_GROUP_BY  │
│    ──────────   │                                      │    ──────────   │                                      │    ──────────   │                                      │    ──────────   │
│    Join Type:   │                                      │        #0       │                                      │     Groups:     │                                      │     Groups:     │
│      INNER      │                                      │__internal_compre│                                      │        #0       │                                      │        #0       │
│                 │                                      │ss_string_uhugein│                                      │        #1       │                                      │        #1       │
│   Conditions:   │                                      │      t(#1)      │                                      │        #2       │                                      │        #2       │
│ c_customer_sk = │                                      │__internal_compre│                                      │        #3       │                                      │        #3       │
│  ss_customer_sk │                                      │ss_string_uhugein│                                      │        #4       │                                      │        #4       │
│                 │                                      │      t(#2)      │                                      │        #5       │                                      │        #5       │
│                 │                                      │__internal_compre│                                      │        #6       │                                      │        #6       │
│                 │                                      │ss_string_utinyin│                                      │        #7       │                                      │        #7       │
│                 │                                      │      t(#3)      │                                      │                 │                                      │                 │
│                 ├─────────┐                            │        #4       │                                      │   Aggregates:   │                                      │   Aggregates:   │
│                 │         │                            │__internal_compre│                                      │     sum(#8)     │                                      │     sum(#8)     │
│                 │         │                            │ss_string_utinyin│                                      │                 │                                      │                 │
│                 │         │                            │      t(#5)      │                                      │                 │                                      │                 │
│                 │         │                            │        #6       │                                      │                 │                                      │                 │
│                 │         │                            │        #7       │                                      │                 │                                      │                 │
│                 │         │                            │        #8       │                                      │                 │                                      │                 │
│                 │         │                            │__internal_compre│                                      │                 │                                      │                 │
│                 │         │                            │ss_integral_utiny│                                      │                 │                                      │                 │
│                 │         │                            │  int(#9, 2002)  │                                      │                 │                                      │                 │
│                 │         │                            │                 │                                      │                 │                                      │                 │
│  5,373,238 rows │         │                            │  1,438,637 rows │                                      │   307,969 rows  │                                      │   106,184 rows  │
│     (0.67s)     │         │                            │     (0.03s)     │                                      │     (0.64s)     │                                      │     (0.18s)     │
└────────┬────────┘         │                            └────────┬────────┘                                      └────────┬────────┘                                      └────────┬────────┘
┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐                                      ┌────────┴────────┐                                      ┌────────┴────────┐
│    TABLE_SCAN   ││    HASH_JOIN    │                   │    HASH_JOIN    │                                      │    PROJECTION   │                                      │    PROJECTION   │
│    ──────────   ││    ──────────   │                   │    ──────────   │                                      │    ──────────   │                                      │    ──────────   │
│      Table:     ││    Join Type:   │                   │    Join Type:   │                                      │  c_customer_id  │                                      │  c_customer_id  │
│     customer    ││      INNER      │                   │      INNER      │                                      │   c_first_name  │                                      │   c_first_name  │
│                 ││                 │                   │                 │                                      │   c_last_name   │                                      │   c_last_name   │
│      Type:      ││   Conditions:   │                   │   Conditions:   │                                      │c_preferred_cust_│                                      │c_preferred_cust_│
│ Sequential Scan ││ ss_sold_date_sk │                   │ c_customer_sk = │                                      │       flag      │                                      │       flag      │
│                 ││   = d_date_sk   │                   │ ws_bill_customer│                                      │ c_birth_country │                                      │ c_birth_country │
│   Projections:  ││                 │                   │       _sk       │                                      │     c_login     │                                      │     c_login     │
│  c_customer_sk  ││                 │                   │                 │                                      │ c_email_address │                                      │ c_email_address │
│  c_customer_id  ││                 ├─────────┐         │                 ├─────────┐                            │      d_year     │                                      │      d_year     │
│   c_first_name  ││                 │         │         │                 │         │                            │(ss_ext_list_pric│                                      │(ws_ext_list_pric│
│   c_last_name   ││                 │         │         │                 │         │                            │e - ss_ext_discou│                                      │e - ws_ext_discou│
│c_preferred_cust_││                 │         │         │                 │         │                            │     nt_amt)     │                                      │     nt_amt)     │
│       flag      ││                 │         │         │                 │         │                            │                 │                                      │                 │
│ c_birth_country ││                 │         │         │                 │         │                            │                 │                                      │                 │
│     c_login     ││                 │         │         │                 │         │                            │                 │                                      │                 │
│ c_email_address ││                 │         │         │                 │         │                            │                 │                                      │                 │
│                 ││                 │         │         │                 │         │                            │                 │                                      │                 │
│   499,908 rows  ││  5,504,119 rows │         │         │  1,438,637 rows │         │                            │  5,341,842 rows │                                      │  1,432,703 rows │
│     (0.06s)     ││     (0.05s)     │         │         │     (0.14s)     │         │                            │     (0.01s)     │                                      │     (0.00s)     │
└─────────────────┘└────────┬────────┘         │         └────────┬────────┘         │                            └────────┬────────┘                                      └────────┬────────┘
                   ┌────────┴────────┐┌────────┴────────┐┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐                                      ┌────────┴────────┐
                   │    TABLE_SCAN   ││      FILTER     ││    TABLE_SCAN   ││    HASH_JOIN    │                   │    PROJECTION   │                                      │    PROJECTION   │
                   │    ──────────   ││    ──────────   ││    ──────────   ││    ──────────   │                   │    ──────────   │                                      │    ──────────   │
                   │      Table:     ││    (d_date_sk   ││      Table:     ││    Join Type:   │                   │        #0       │                                      │        #0       │
                   │   store_sales   ││  BETWEEN 2450816││     customer    ││      INNER      │                   │__internal_compre│                                      │__internal_compre│
                   │                 ││   AND 2452642)  ││                 ││                 │                   │ss_string_uhugein│                                      │ss_string_uhugein│
                   │      Type:      ││                 ││      Type:      ││   Conditions:   │                   │      t(#1)      │                                      │      t(#1)      │
                   │ Sequential Scan ││                 ││ Sequential Scan ││ ws_sold_date_sk │                   │__internal_compre│                                      │__internal_compre│
                   │                 ││                 ││                 ││   = d_date_sk   │                   │ss_string_uhugein│                                      │ss_string_uhugein│
                   │   Projections:  ││                 ││   Projections:  ││                 │                   │      t(#2)      │                                      │      t(#2)      │
                   │  ss_customer_sk ││                 ││  c_customer_sk  ││                 │                   │__internal_compre│                                      │__internal_compre│
                   │ ss_sold_date_sk ││                 ││  c_customer_id  ││                 │                   │ss_string_utinyin│                                      │ss_string_utinyin│
                   │ss_ext_list_price││                 ││   c_first_name  ││                 │                   │      t(#3)      │                                      │      t(#3)      │
                   │ss_ext_discount_a││                 ││   c_last_name   ││                 │                   │        #4       │                                      │        #4       │
                   │        mt       ││                 ││c_preferred_cust_││                 ├─────────┐         │__internal_compre│                                      │__internal_compre│
                   │                 ││                 ││       flag      ││                 │         │         │ss_string_utinyin│                                      │ss_string_utinyin│
                   │                 ││                 ││ c_birth_country ││                 │         │         │      t(#5)      │                                      │      t(#5)      │
                   │                 ││                 ││     c_login     ││                 │         │         │        #6       │                                      │        #6       │
                   │                 ││                 ││ c_email_address ││                 │         │         │        #7       │                                      │        #7       │
                   │                 ││                 ││                 ││                 │         │         │        #8       │                                      │        #8       │
                   │                 ││                 ││     Filters:    ││                 │         │         │__internal_compre│                                      │__internal_compre│
                   │                 ││                 ││ c_customer_sk>=2││                 │         │         │ss_integral_utiny│                                      │ss_integral_utiny│
                   │                 ││                 ││ AND c_customer_s││                 │         │         │  int(#9, 2001)  │                                      │  int(#9, 2001)  │
                   │                 ││                 ││    k<=499998    ││                 │         │         │                 │                                      │                 │
                   │                 ││                 ││                 ││                 │         │         │                 │                                      │                 │
                   │  5,504,119 rows ││     365 rows    ││   499,978 rows  ││  1,438,827 rows │         │         │  5,341,842 rows │                                      │  1,432,703 rows │
                   │     (0.34s)     ││     (0.00s)     ││     (0.05s)     ││     (0.01s)     │         │         │     (0.11s)     │                                      │     (0.03s)     │
                   └─────────────────┘└────────┬────────┘└─────────────────┘└────────┬────────┘         │         └────────┬────────┘                                      └────────┬────────┘
                                      ┌────────┴────────┐                   ┌────────┴────────┐┌────────┴────────┐┌────────┴────────┐                                      ┌────────┴────────┐
                                      │    TABLE_SCAN   │                   │    TABLE_SCAN   ││      FILTER     ││    HASH_JOIN    │                                      │    HASH_JOIN    │
                                      │    ──────────   │                   │    ──────────   ││    ──────────   ││    ──────────   │                                      │    ──────────   │
                                      │      Table:     │                   │      Table:     ││    (d_date_sk   ││    Join Type:   │                                      │    Join Type:   │
                                      │     date_dim    │                   │    web_sales    ││  BETWEEN 2450816││      INNER      │                                      │      INNER      │
                                      │                 │                   │                 ││   AND 2452642)  ││                 │                                      │                 │
                                      │      Type:      │                   │      Type:      ││                 ││   Conditions:   │                                      │   Conditions:   │
                                      │ Sequential Scan │                   │ Sequential Scan ││                 ││ c_customer_sk = │                                      │ c_customer_sk = │
                                      │                 │                   │                 ││                 ││  ss_customer_sk │                                      │ ws_bill_customer│
                                      │   Projections:  │                   │   Projections:  ││                 ││                 │                                      │       _sk       │
                                      │    d_date_sk    │                   │ws_bill_customer_││                 ││                 ├─────────┐                            │                 ├─────────┐
                                      │      d_year     │                   │        sk       ││                 ││                 │         │                            │                 │         │
                                      │                 │                   │ ws_sold_date_sk ││                 ││                 │         │                            │                 │         │
                                      │     Filters:    │                   │ws_ext_list_price││                 ││                 │         │                            │                 │         │
                                      │   d_year=2002   │                   │ws_ext_discount_a││                 ││                 │         │                            │                 │         │
                                      │                 │                   │        mt       ││                 ││                 │         │                            │                 │         │
                                      │                 │                   │                 ││                 ││                 │         │                            │                 │         │
                                      │     365 rows    │                   │  1,438,827 rows ││     365 rows    ││  5,341,842 rows │         │                            │  1,432,703 rows │         │
                                      │     (0.00s)     │                   │     (0.05s)     ││     (0.00s)     ││     (0.67s)     │         │                            │     (0.20s)     │         │
                                      └─────────────────┘                   └─────────────────┘└────────┬────────┘└────────┬────────┘         │                            └────────┬────────┘         │
                                                                                               ┌────────┴────────┐┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐┌────────┴────────┐
                                                                                               │    TABLE_SCAN   ││    TABLE_SCAN   ││    HASH_JOIN    │                   │    TABLE_SCAN   ││    HASH_JOIN    │
                                                                                               │    ──────────   ││    ──────────   ││    ──────────   │                   │    ──────────   ││    ──────────   │
                                                                                               │      Table:     ││      Table:     ││    Join Type:   │                   │      Table:     ││    Join Type:   │
                                                                                               │     date_dim    ││     customer    ││      INNER      │                   │     customer    ││      INNER      │
                                                                                               │                 ││                 ││                 │                   │                 ││                 │
                                                                                               │      Type:      ││      Type:      ││   Conditions:   │                   │      Type:      ││   Conditions:   │
                                                                                               │ Sequential Scan ││ Sequential Scan ││ ss_sold_date_sk │                   │ Sequential Scan ││ ws_sold_date_sk │
                                                                                               │                 ││                 ││   = d_date_sk   │                   │                 ││   = d_date_sk   │
                                                                                               │   Projections:  ││   Projections:  ││                 │                   │   Projections:  ││                 │
                                                                                               │    d_date_sk    ││  c_customer_sk  ││                 │                   │  c_customer_sk  ││                 │
                                                                                               │      d_year     ││  c_customer_id  ││                 │                   │  c_customer_id  ││                 │
                                                                                               │                 ││   c_first_name  ││                 │                   │   c_first_name  ││                 │
                                                                                               │     Filters:    ││   c_last_name   ││                 │                   │   c_last_name   ││                 │
                                                                                               │   d_year=2002   ││c_preferred_cust_││                 ├─────────┐         │c_preferred_cust_││                 ├─────────┐
                                                                                               │                 ││       flag      ││                 │         │         │       flag      ││                 │         │
                                                                                               │                 ││ c_birth_country ││                 │         │         │ c_birth_country ││                 │         │
                                                                                               │                 ││     c_login     ││                 │         │         │     c_login     ││                 │         │
                                                                                               │                 ││ c_email_address ││                 │         │         │ c_email_address ││                 │         │
                                                                                               │                 ││                 ││                 │         │         │                 ││                 │         │
                                                                                               │                 ││                 ││                 │         │         │     Filters:    ││                 │         │
                                                                                               │                 ││                 ││                 │         │         │ c_customer_sk>=2││                 │         │
                                                                                               │                 ││                 ││                 │         │         │ AND c_customer_s││                 │         │
                                                                                               │                 ││                 ││                 │         │         │    k<=499998    ││                 │         │
                                                                                               │                 ││                 ││                 │         │         │                 ││                 │         │
                                                                                               │     365 rows    ││   499,989 rows  ││  5,471,263 rows │         │         │   499,981 rows  ││  1,432,881 rows │         │
                                                                                               │     (0.00s)     ││     (0.06s)     ││     (0.05s)     │         │         │     (0.04s)     ││     (0.02s)     │         │
                                                                                               └─────────────────┘└─────────────────┘└────────┬────────┘         │         └─────────────────┘└────────┬────────┘         │
                                                                                                                                     ┌────────┴────────┐┌────────┴────────┐                   ┌────────┴────────┐┌────────┴────────┐
                                                                                                                                     │    TABLE_SCAN   ││      FILTER     │                   │    TABLE_SCAN   ││      FILTER     │
                                                                                                                                     │    ──────────   ││    ──────────   │                   │    ──────────   ││    ──────────   │
                                                                                                                                     │      Table:     ││    (d_date_sk   │                   │      Table:     ││    (d_date_sk   │
                                                                                                                                     │   store_sales   ││  BETWEEN 2450816│                   │    web_sales    ││  BETWEEN 2450816│
                                                                                                                                     │                 ││   AND 2452642)  │                   │                 ││   AND 2452642)  │
                                                                                                                                     │      Type:      ││                 │                   │      Type:      ││                 │
                                                                                                                                     │ Sequential Scan ││                 │                   │ Sequential Scan ││                 │
                                                                                                                                     │                 ││                 │                   │                 ││                 │
                                                                                                                                     │   Projections:  ││                 │                   │   Projections:  ││                 │
                                                                                                                                     │  ss_customer_sk ││                 │                   │ws_bill_customer_││                 │
                                                                                                                                     │ ss_sold_date_sk ││                 │                   │        sk       ││                 │
                                                                                                                                     │ss_ext_list_price││                 │                   │ ws_sold_date_sk ││                 │
                                                                                                                                     │ss_ext_discount_a││                 │                   │ws_ext_list_price││                 │
                                                                                                                                     │        mt       ││                 │                   │ws_ext_discount_a││                 │
                                                                                                                                     │                 ││                 │                   │        mt       ││                 │
                                                                                                                                     │                 ││                 │                   │                 ││                 │
                                                                                                                                     │  5,471,263 rows ││     365 rows    │                   │  1,432,881 rows ││     365 rows    │
                                                                                                                                     │     (0.32s)     ││     (0.00s)     │                   │     (0.07s)     ││     (0.00s)     │
                                                                                                                                     └─────────────────┘└────────┬────────┘                   └─────────────────┘└────────┬────────┘
                                                                                                                                                        ┌────────┴────────┐                                      ┌────────┴────────┐
                                                                                                                                                        │    TABLE_SCAN   │                                      │    TABLE_SCAN   │
                                                                                                                                                        │    ──────────   │                                      │    ──────────   │
                                                                                                                                                        │      Table:     │                                      │      Table:     │
                                                                                                                                                        │     date_dim    │                                      │     date_dim    │
                                                                                                                                                        │                 │                                      │                 │
                                                                                                                                                        │      Type:      │                                      │      Type:      │
                                                                                                                                                        │ Sequential Scan │                                      │ Sequential Scan │
                                                                                                                                                        │                 │                                      │                 │
                                                                                                                                                        │   Projections:  │                                      │   Projections:  │
                                                                                                                                                        │    d_date_sk    │                                      │    d_date_sk    │
                                                                                                                                                        │      d_year     │                                      │      d_year     │
                                                                                                                                                        │                 │                                      │                 │
                                                                                                                                                        │     Filters:    │                                      │     Filters:    │
                                                                                                                                                        │   d_year=2001   │                                      │   d_year=2001   │
                                                                                                                                                        │                 │                                      │                 │
                                                                                                                                                        │     365 rows    │                                      │     365 rows    │
                                                                                                                                                        │     (0.00s)     │                                      │     (0.00s)     │
                                                                                                                                                        └─────────────────┘                                      └─────────────────┘

