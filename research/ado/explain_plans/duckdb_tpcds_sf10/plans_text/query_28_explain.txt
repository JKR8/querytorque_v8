-- benchmark: tpcds
-- query_id: query_28
-- source_sql: /mnt/d/TPC-DS/queries_duckdb_converted/query_28.sql
-- database: /mnt/d/TPC-DS/tpcds_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 407.772
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE select * from (select avg(ss_list_price) B1_LP             ,count(ss_list_price) B1_CNT             ,count(distinct ss_list_price) B1_CNTD       from store_sales       where ss_quantity between 0 and 5         and (ss_list_price between 131 and 131+10               or ss_coupon_amt between 16798 and 16798+1000              or ss_wholesale_cost between 25 and 25+20)) B1,      (select avg(ss_list_price) B2_LP             ,count(ss_list_price) B2_CNT             ,count(distinct ss_list_price) B2_CNTD       from store_sales       where ss_quantity between 6 and 10         and (ss_list_price between 145 and 145+10           or ss_coupon_amt between 14792 and 14792+1000           or ss_wholesale_cost between 46 and 46+20)) B2,      (select avg(ss_list_price) B3_LP             ,count(ss_list_price) B3_CNT             ,count(distinct ss_list_price) B3_CNTD       from store_sales       where ss_quantity between 11 and 15         and (ss_list_price between 150 and 150+10           or ss_coupon_amt between 6600 and 6600+1000           or ss_wholesale_cost between 9 and 9+20)) B3,      (select avg(ss_list_price) B4_LP             ,count(ss_list_price) B4_CNT             ,count(distinct ss_list_price) B4_CNTD       from store_sales       where ss_quantity between 16 and 20         and (ss_list_price between 91 and 91+10           or ss_coupon_amt between 13493 and 13493+1000           or ss_wholesale_cost between 36 and 36+20)) B4,      (select avg(ss_list_price) B5_LP             ,count(ss_list_price) B5_CNT             ,count(distinct ss_list_price) B5_CNTD       from store_sales       where ss_quantity between 21 and 25         and (ss_list_price between 0 and 0+10           or ss_coupon_amt between 7629 and 7629+1000           or ss_wholesale_cost between 6 and 6+20)) B5,      (select avg(ss_list_price) B6_LP             ,count(ss_list_price) B6_CNT             ,count(distinct ss_list_price) B6_CNTD       from store_sales       where ss_quantity between 26 and 30         and (ss_list_price between 89 and 89+10           or ss_coupon_amt between 15257 and 15257+1000           or ss_wholesale_cost between 31 and 31+20)) B6  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.406s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────────┐
│           QUERY           │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      EXPLAIN_ANALYZE      │
│    ────────────────────   │
│           0 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│           B1_LP           │
│           B1_CNT          │
│          B1_CNTD          │
│           B2_LP           │
│           B2_CNT          │
│          B2_CNTD          │
│           B3_LP           │
│           B3_CNT          │
│          B3_CNTD          │
│           B4_LP           │
│           B4_CNT          │
│          B4_CNTD          │
│           B5_LP           │
│           B5_CNT          │
│          B5_CNTD          │
│           B6_LP           │
│           B6_CNT          │
│          B6_CNTD          │
│                           │
│           1 row           │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      STREAMING_LIMIT      │
│    ────────────────────   │
│           1 row           │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       CROSS_PRODUCT       │
│    ────────────────────   │
│           1 row           ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│          (0.00s)          │                                                                                                                                  │
└─────────────┬─────────────┘                                                                                                                                  │
┌─────────────┴─────────────┐                                                                                                                    ┌─────────────┴─────────────┐
│       CROSS_PRODUCT       │                                                                                                                    │    UNGROUPED_AGGREGATE    │
│    ────────────────────   │                                                                                                                    │    ────────────────────   │
│                           │                                                                                                                    │        Aggregates:        │
│                           │                                                                                                                    │          avg(#0)          │
│                           ├─────────────────────────────────────────────────────────────────────────────────────────────────────┐              │         count(#1)         │
│                           │                                                                                                     │              │     count(DISTINCT #2)    │
│                           │                                                                                                     │              │                           │
│           1 row           │                                                                                                     │              │           1 row           │
│          (0.00s)          │                                                                                                     │              │          (0.06s)          │
└─────────────┬─────────────┘                                                                                                     │              └─────────────┬─────────────┘
┌─────────────┴─────────────┐                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       CROSS_PRODUCT       │                                                                                       │    UNGROUPED_AGGREGATE    ││         PROJECTION        │
│    ────────────────────   │                                                                                       │    ────────────────────   ││    ────────────────────   │
│                           │                                                                                       │        Aggregates:        ││       ss_list_price       │
│                           │                                                                                       │          avg(#0)          ││       ss_list_price       │
│                           ├────────────────────────────────────────────────────────────────────────┐              │         count(#1)         ││       ss_list_price       │
│                           │                                                                        │              │     count(DISTINCT #2)    ││                           │
│                           │                                                                        │              │                           ││                           │
│           1 row           │                                                                        │              │           1 row           ││        322,786 rows       │
│          (0.00s)          │                                                                        │              │          (0.05s)          ││          (0.00s)          │
└─────────────┬─────────────┘                                                                        │              └─────────────┬─────────────┘└─────────────┬─────────────┘
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       CROSS_PRODUCT       │                                                          │    UNGROUPED_AGGREGATE    ││         PROJECTION        ││         PROJECTION        │
│    ────────────────────   │                                                          │    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
│                           │                                                          │        Aggregates:        ││       ss_list_price       ││             #0            │
│                           │                                                          │          avg(#0)          ││       ss_list_price       ││                           │
│                           ├───────────────────────────────────────────┐              │         count(#1)         ││       ss_list_price       ││                           │
│                           │                                           │              │     count(DISTINCT #2)    ││                           ││                           │
│                           │                                           │              │                           ││                           ││                           │
│           1 row           │                                           │              │           1 row           ││        310,872 rows       ││        322,786 rows       │
│          (0.00s)          │                                           │              │          (0.08s)          ││          (0.01s)          ││          (0.00s)          │
└─────────────┬─────────────┘                                           │              └─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│       CROSS_PRODUCT       │                             │    UNGROUPED_AGGREGATE    ││         PROJECTION        ││         PROJECTION        ││           FILTER          │
│    ────────────────────   │                             │    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
│                           │                             │        Aggregates:        ││       ss_list_price       ││             #0            ││ (((ss_list_price >= 131.00│
│                           │                             │          avg(#0)          ││       ss_list_price       ││                           ││  ) AND (ss_list_price <=  │
│                           │                             │         count(#1)         ││       ss_list_price       ││                           ││        141.00)) OR (      │
│                           │                             │     count(DISTINCT #2)    ││                           ││                           ││ (ss_coupon_amt >= 16798.00│
│                           │                             │                           ││                           ││                           ││  ) AND (ss_coupon_amt <=  │
│                           ├──────────────┐              │                           ││                           ││                           ││       17798.00)) OR (     │
│                           │              │              │                           ││                           ││                           ││  (ss_wholesale_cost >= 25 │
│                           │              │              │                           ││                           ││                           ││         .00) AND          │
│                           │              │              │                           ││                           ││                           ││  (ss_wholesale_cost <= 45 │
│                           │              │              │                           ││                           ││                           ││           .00)))          │
│                           │              │              │                           ││                           ││                           ││                           │
│           1 row           │              │              │           1 row           ││        305,906 rows       ││        310,872 rows       ││        322,786 rows       │
│          (0.00s)          │              │              │          (0.06s)          ││          (0.01s)          ││          (0.00s)          ││          (0.13s)          │
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│    UNGROUPED_AGGREGATE    ││    UNGROUPED_AGGREGATE    ││         PROJECTION        ││         PROJECTION        ││           FILTER          ││         TABLE_SCAN        │
│    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
│        Aggregates:        ││        Aggregates:        ││       ss_list_price       ││             #0            ││ (((ss_list_price >= 145.00││     Table: store_sales    │
│          avg(#0)          ││          avg(#0)          ││       ss_list_price       ││                           ││  ) AND (ss_list_price <=  ││   Type: Sequential Scan   │
│         count(#1)         ││         count(#1)         ││       ss_list_price       ││                           ││        155.00)) OR (      ││                           │
│     count(DISTINCT #2)    ││     count(DISTINCT #2)    ││                           ││                           ││ (ss_coupon_amt >= 14792.00││        Projections:       │
│                           ││                           ││                           ││                           ││  ) AND (ss_coupon_amt <=  ││       ss_list_price       │
│                           ││                           ││                           ││                           ││       15792.00)) OR (     ││       ss_coupon_amt       │
│                           ││                           ││                           ││                           ││  (ss_wholesale_cost >= 46 ││     ss_wholesale_cost     │
│                           ││                           ││                           ││                           ││         .00) AND          ││                           │
│                           ││                           ││                           ││                           ││  (ss_wholesale_cost <= 66 ││          Filters:         │
│                           ││                           ││                           ││                           ││           .00)))          ││     ss_quantity>=0 AND    │
│                           ││                           ││                           ││                           ││                           ││       ss_quantity<=5      │
│                           ││                           ││                           ││                           ││                           ││                           │
│           1 row           ││           1 row           ││        344,318 rows       ││        305,906 rows       ││        310,872 rows       ││       1,374,872 rows      │
│          (0.08s)          ││          (0.06s)          ││          (0.01s)          ││          (0.01s)          ││          (0.13s)          ││          (1.27s)          │
└─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘└───────────────────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         PROJECTION        ││         PROJECTION        ││         PROJECTION        ││           FILTER          ││         TABLE_SCAN        │
│    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
│       ss_list_price       ││       ss_list_price       ││             #0            ││ (((ss_list_price >= 150.00││     Table: store_sales    │
│       ss_list_price       ││       ss_list_price       ││                           ││  ) AND (ss_list_price <=  ││   Type: Sequential Scan   │
│       ss_list_price       ││       ss_list_price       ││                           ││        160.00)) OR (      ││                           │
│                           ││                           ││                           ││ (ss_coupon_amt >= 6600.00)││        Projections:       │
│                           ││                           ││                           ││    AND (ss_coupon_amt <=  ││       ss_list_price       │
│                           ││                           ││                           ││       7600.00)) OR (      ││       ss_coupon_amt       │
│                           ││                           ││                           ││ (ss_wholesale_cost >= 9.00││     ss_wholesale_cost     │
│                           ││                           ││                           ││ ) AND (ss_wholesale_cost <││                           │
│                           ││                           ││                           ││         = 29.00)))        ││          Filters:         │
│                           ││                           ││                           ││                           ││     ss_quantity>=6 AND    │
│                           ││                           ││                           ││                           ││       ss_quantity<=10     │
│                           ││                           ││                           ││                           ││                           │
│        337,681 rows       ││        354,974 rows       ││        344,318 rows       ││        305,906 rows       ││       1,375,330 rows      │
│          (0.01s)          ││          (0.00s)          ││          (0.00s)          ││          (0.15s)          ││          (0.34s)          │
└─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘└───────────────────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         PROJECTION        ││         PROJECTION        ││           FILTER          ││         TABLE_SCAN        │
│    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
│             #0            ││             #0            ││ (((ss_list_price >= 91.00)││     Table: store_sales    │
│                           ││                           ││  AND (ss_list_price <= 101││   Type: Sequential Scan   │
│                           ││                           ││ .00)) OR ((ss_coupon_amt >││                           │
│                           ││                           ││      = 13493.00) AND      ││        Projections:       │
│                           ││                           ││ (ss_coupon_amt <= 14493.00││       ss_list_price       │
│                           ││                           ││ )) OR ((ss_wholesale_cost ││       ss_coupon_amt       │
│                           ││                           ││       >= 36.00) AND       ││     ss_wholesale_cost     │
│                           ││                           ││  (ss_wholesale_cost <= 56 ││                           │
│                           ││                           ││           .00)))          ││          Filters:         │
│                           ││                           ││                           ││    ss_quantity>=11 AND    │
│                           ││                           ││                           ││       ss_quantity<=15     │
│                           ││                           ││                           ││                           │
│        337,681 rows       ││        354,974 rows       ││        344,318 rows       ││       1,373,928 rows      │
│          (0.00s)          ││          (0.00s)          ││          (0.14s)          ││          (0.39s)          │
└─────────────┬─────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘└───────────────────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│           FILTER          ││           FILTER          ││         TABLE_SCAN        │
│    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
│  (((ss_coupon_amt >= 7629 ││ (((ss_list_price >= 89.00)││     Table: store_sales    │
│ .00) AND (ss_coupon_amt <=││  AND (ss_list_price <= 99 ││   Type: Sequential Scan   │
│       8629.00)) OR (      ││ .00)) OR ((ss_coupon_amt >││                           │
│ (ss_wholesale_cost >= 6.00││      = 15257.00) AND      ││        Projections:       │
│ ) AND (ss_wholesale_cost <││ (ss_coupon_amt <= 16257.00││       ss_list_price       │
│       = 26.00)) OR (      ││ )) OR ((ss_wholesale_cost ││       ss_coupon_amt       │
│  (ss_list_price <= 10.00) ││       >= 31.00) AND       ││     ss_wholesale_cost     │
│  AND constant_or_null(true││  (ss_wholesale_cost <= 51 ││                           │
│  , ss_list_price, 0.00))) ││           .00)))          ││          Filters:         │
│                           ││                           ││    ss_quantity>=16 AND    │
│                           ││                           ││       ss_quantity<=20     │
│                           ││                           ││                           │
│        337,681 rows       ││        354,974 rows       ││       1,374,086 rows      │
│          (0.20s)          ││          (0.14s)          ││          (0.34s)          │
└─────────────┬─────────────┘└─────────────┬─────────────┘└───────────────────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         TABLE_SCAN        ││         TABLE_SCAN        │
│    ────────────────────   ││    ────────────────────   │
│     Table: store_sales    ││     Table: store_sales    │
│   Type: Sequential Scan   ││   Type: Sequential Scan   │
│                           ││                           │
│        Projections:       ││        Projections:       │
│       ss_list_price       ││       ss_list_price       │
│       ss_coupon_amt       ││       ss_coupon_amt       │
│     ss_wholesale_cost     ││     ss_wholesale_cost     │
│                           ││                           │
│          Filters:         ││          Filters:         │
│    ss_quantity>=21 AND    ││    ss_quantity>=26 AND    │
│       ss_quantity<=25     ││       ss_quantity<=30     │
│                           ││                           │
│       1,374,327 rows      ││       1,375,150 rows      │
│          (0.42s)          ││          (0.38s)          │
└───────────────────────────┘└───────────────────────────┘

