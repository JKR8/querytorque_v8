-- benchmark: tpcds
-- query_id: query_93
-- source_sql: /mnt/d/TPC-DS/queries_duckdb_converted/query_93.sql
-- database: /mnt/d/TPC-DS/tpcds_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 217.955
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE select ss_customer_sk             ,sum(act_sales) sumsales       from (select ss_item_sk                   ,ss_ticket_number                   ,ss_customer_sk                   ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price                                                             else (ss_quantity*ss_sales_price) end act_sales             from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk                                                                and sr_ticket_number = ss_ticket_number)                 ,reason             where sr_reason_sk = r_reason_sk               and r_reason_desc = 'duplicate purchase') t       group by ss_customer_sk       order by sumsales, ss_customer_sk  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.217s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────────┐
│           QUERY           │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      EXPLAIN_ANALYZE      │
│    ────────────────────   │
│           0 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│           TOP_N           │
│    ────────────────────   │
│          Top: 100         │
│                           │
│         Order By:         │
│    sum(t.act_sales) ASC   │
│    t.ss_customer_sk ASC   │
│                           │
│          100 rows         │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│    ────────────────────   │
│         Groups: #0        │
│    Aggregates: sum(#1)    │
│                           │
│        54,761 rows        │
│          (0.02s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│       ss_customer_sk      │
│         act_sales         │
│                           │
│        61,506 rows        │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│       ss_customer_sk      │
│         act_sales         │
│                           │
│        61,506 rows        │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         HASH_JOIN         │
│    ────────────────────   │
│      Join Type: INNER     │
│                           │
│        Conditions:        ├───────────────────────────────────────────┐
│ sr_reason_sk = r_reason_sk│                                           │
│                           │                                           │
│        61,506 rows        │                                           │
│          (0.17s)          │                                           │
└─────────────┬─────────────┘                                           │
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         HASH_JOIN         │                             │         TABLE_SCAN        │
│    ────────────────────   │                             │    ────────────────────   │
│      Join Type: LEFT      │                             │       Table: reason       │
│                           │                             │   Type: Sequential Scan   │
│        Conditions:        │                             │                           │
│  ss_item_sk = sr_item_sk  │                             │        Projections:       │
│     ss_ticket_number =    │                             │        r_reason_sk        │
│      sr_ticket_number     ├──────────────┐              │                           │
│                           │              │              │          Filters:         │
│                           │              │              │  r_reason_desc='duplicate │
│                           │              │              │          purchase'        │
│                           │              │              │                           │
│      28,800,991 rows      │              │              │           1 row           │
│          (1.92s)          │              │              │          (0.00s)          │
└─────────────┬─────────────┘              │              └───────────────────────────┘
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         TABLE_SCAN        ││         TABLE_SCAN        │
│    ────────────────────   ││    ────────────────────   │
│     Table: store_sales    ││    Table: store_returns   │
│   Type: Sequential Scan   ││   Type: Sequential Scan   │
│                           ││                           │
│        Projections:       ││        Projections:       │
│         ss_item_sk        ││         sr_item_sk        │
│      ss_ticket_number     ││      sr_ticket_number     │
│       ss_customer_sk      ││        sr_reason_sk       │
│        ss_quantity        ││     sr_return_quantity    │
│       ss_sales_price      ││                           │
│                           ││                           │
│      28,800,991 rows      ││       2,877,532 rows      │
│          (0.25s)          ││          (0.02s)          │
└───────────────────────────┘└───────────────────────────┘

