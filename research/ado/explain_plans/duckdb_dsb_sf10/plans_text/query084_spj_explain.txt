-- benchmark: dsb
-- query_id: query084_spj
-- source_sql: research/ado/queries_dsb_sf10_duckdb/spj_queries/query084_spj.sql
-- database: /mnt/d/TPC-DS/dsb_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 17.435
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE select min(c_customer_id),     min(sr_ticket_number),     min(sr_item_sk)  from customer      ,customer_address      ,customer_demographics      ,household_demographics      ,income_band      ,store_returns  where ca_city	        =  'Hopewell'    and c_current_addr_sk = ca_address_sk    and ib_lower_bound   >=  3 * 10000    and ib_upper_bound   <=  3 * 10000 + 50000    and ib_income_band_sk = hd_income_band_sk    and cd_demo_sk = c_current_cdemo_sk    and hd_demo_sk = c_current_hdemo_sk    and sr_cdemo_sk = cd_demo_sk
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.0165s             ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────────┐
│           QUERY           │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      EXPLAIN_ANALYZE      │
│    ────────────────────   │
│           0 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│    UNGROUPED_AGGREGATE    │
│    ────────────────────   │
│        Aggregates:        │
│          min(#0)          │
│          min(#1)          │
│          min(#2)          │
│                           │
│           1 row           │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│       c_customer_id       │
│      sr_ticket_number     │
│         sr_item_sk        │
│                           │
│         1,467 rows        │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         HASH_JOIN         │
│    ────────────────────   │
│      Join Type: INNER     │
│                           │
│        Conditions:        │
│       sr_cdemo_sk =       ├──────────────┐
│     c_current_cdemo_sk    │              │
│                           │              │
│         1,467 rows        │              │
│          (0.02s)          │              │
└─────────────┬─────────────┘              │
┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         TABLE_SCAN        ││         HASH_JOIN         │
│    ────────────────────   ││    ────────────────────   │
│    Table: store_returns   ││      Join Type: INNER     │
│   Type: Sequential Scan   ││                           │
│                           ││        Conditions:        │
│        Projections:       ││        cd_demo_sk =       │
│        sr_cdemo_sk        ││     c_current_cdemo_sk    │
│      sr_ticket_number     ││                           │
│         sr_item_sk        ││                           ├──────────────┐
│                           ││                           │              │
│          Filters:         ││                           │              │
│     sr_cdemo_sk>=4 AND    ││                           │              │
│    sr_cdemo_sk<=1920791   ││                           │              │
│                           ││                           │              │
│       2,774,571 rows      ││         1,054 rows        │              │
│          (0.03s)          ││          (0.01s)          │              │
└───────────────────────────┘└─────────────┬─────────────┘              │
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         TABLE_SCAN        ││         HASH_JOIN         │
                             │    ────────────────────   ││    ────────────────────   │
                             │           Table:          ││      Join Type: INNER     │
                             │   customer_demographics   ││                           │
                             │                           ││        Conditions:        │
                             │   Type: Sequential Scan   ││    hd_income_band_sk =    │
                             │                           ││      ib_income_band_sk    │
                             │        Projections:       ││                           │
                             │         cd_demo_sk        ││                           ├────────────────────────────────────────────────────────────────────────┐
                             │                           ││                           │                                                                        │
                             │          Filters:         ││                           │                                                                        │
                             │     cd_demo_sk>=4 AND     ││                           │                                                                        │
                             │     cd_demo_sk<=1920791   ││                           │                                                                        │
                             │                           ││                           │                                                                        │
                             │       1,919,006 rows      ││         1,067 rows        │                                                                        │
                             │          (0.00s)          ││          (0.00s)          │                                                                        │
                             └───────────────────────────┘└─────────────┬─────────────┘                                                                        │
                                                          ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
                                                          │         HASH_JOIN         │                                                          │         TABLE_SCAN        │
                                                          │    ────────────────────   │                                                          │    ────────────────────   │
                                                          │      Join Type: INNER     │                                                          │     Table: income_band    │
                                                          │                           │                                                          │   Type: Sequential Scan   │
                                                          │        Conditions:        │                                                          │                           │
                                                          │        hd_demo_sk =       │                                                          │        Projections:       │
                                                          │     c_current_hdemo_sk    │                                                          │     ib_income_band_sk     │
                                                          │                           ├──────────────┐                                           │                           │
                                                          │                           │              │                                           │          Filters:         │
                                                          │                           │              │                                           │   ib_lower_bound>=30000   │
                                                          │                           │              │                                           │   ib_upper_bound<=80000   │
                                                          │                           │              │                                           │                           │
                                                          │         1,067 rows        │              │                                           │           5 rows          │
                                                          │          (0.00s)          │              │                                           │          (0.00s)          │
                                                          └─────────────┬─────────────┘              │                                           └───────────────────────────┘
                                                          ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                          │         TABLE_SCAN        ││         HASH_JOIN         │
                                                          │    ────────────────────   ││    ────────────────────   │
                                                          │           Table:          ││      Join Type: INNER     │
                                                          │   household_demographics  ││                           │
                                                          │                           ││        Conditions:        │
                                                          │   Type: Sequential Scan   ││    c_current_addr_sk =    │
                                                          │                           ││        ca_address_sk      ├──────────────┐
                                                          │        Projections:       ││                           │              │
                                                          │     hd_income_band_sk     ││                           │              │
                                                          │         hd_demo_sk        ││                           │              │
                                                          │                           ││                           │              │
                                                          │         1,800 rows        ││         4,204 rows        │              │
                                                          │          (0.00s)          ││          (0.00s)          │              │
                                                          └───────────────────────────┘└─────────────┬─────────────┘              │
                                                                                       ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                                                                                       │         TABLE_SCAN        ││         TABLE_SCAN        │
                                                                                       │    ────────────────────   ││    ────────────────────   │
                                                                                       │      Table: customer      ││           Table:          │
                                                                                       │   Type: Sequential Scan   ││      customer_address     │
                                                                                       │                           ││                           │
                                                                                       │        Projections:       ││   Type: Sequential Scan   │
                                                                                       │     c_current_addr_sk     ││                           │
                                                                                       │     c_current_cdemo_sk    ││        Projections:       │
                                                                                       │     c_current_hdemo_sk    ││       ca_address_sk       │
                                                                                       │       c_customer_id       ││                           │
                                                                                       │                           ││          Filters:         │
                                                                                       │                           ││     ca_city='Hopewell'    │
                                                                                       │                           ││                           │
                                                                                       │        499,952 rows       ││         2,078 rows        │
                                                                                       │          (0.01s)          ││          (0.00s)          │
                                                                                       └───────────────────────────┘└───────────────────────────┘

