-- benchmark: dsb
-- query_id: query014
-- source_sql: research/ado/queries_dsb_sf10_duckdb/multi_block_queries/query014.sql
-- database: /mnt/d/TPC-DS/dsb_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 471.639
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE with  cross_items as  (select i_item_sk ss_item_sk  from item,  (select iss.i_brand_id brand_id      ,iss.i_class_id class_id      ,iss.i_category_id category_id  from store_sales      ,item iss      ,date_dim d1  where ss_item_sk = iss.i_item_sk    and ss_sold_date_sk = d1.d_date_sk    and d1.d_year between 1998 AND 1998 + 2    and i_category IN ('Books', 'Home', 'Jewelry')    and i_manager_id BETWEEN 28 and 37    and ss_wholesale_cost BETWEEN 80 AND 100 intersect  select ics.i_brand_id      ,ics.i_class_id      ,ics.i_category_id  from catalog_sales      ,item ics      ,date_dim d2  where cs_item_sk = ics.i_item_sk    and cs_sold_date_sk = d2.d_date_sk    and d2.d_year between 1998 AND 1998 + 2    and i_category IN ('Books', 'Home', 'Jewelry')    and i_manager_id BETWEEN 28 and 37    and cs_wholesale_cost BETWEEN 80 AND 100 intersect  select iws.i_brand_id      ,iws.i_class_id      ,iws.i_category_id  from web_sales      ,item iws      ,date_dim d3  where ws_item_sk = iws.i_item_sk    and ws_sold_date_sk = d3.d_date_sk    and ws_wholesale_cost BETWEEN 80 AND 100    and d3.d_year between 1998 AND 1998 + 2) x  where i_brand_id = brand_id       and i_class_id = class_id       and i_category_id = category_id       and i_category IN ('Books', 'Home', 'Jewelry')       and i_manager_id BETWEEN 28 and 37 ),  avg_sales as (select avg(quantity*list_price) average_sales   from (select ss_quantity quantity              ,ss_list_price list_price        from store_sales            ,date_dim        where ss_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2          and ss_wholesale_cost BETWEEN 80 AND 100        union all        select cs_quantity quantity              ,cs_list_price list_price        from catalog_sales            ,date_dim        where cs_sold_date_sk = d_date_sk          and d_year between 1998 and 1998 + 2          and cs_wholesale_cost BETWEEN 80 AND 100        union all        select ws_quantity quantity              ,ws_list_price list_price        from web_sales            ,date_dim        where ws_sold_date_sk = d_date_sk         and ws_wholesale_cost BETWEEN 80 AND 100          and d_year between 1998 and 1998 + 2) x)   select  this_year.channel ty_channel                            ,this_year.i_brand_id ty_brand                            ,this_year.i_class_id ty_class                            ,this_year.i_category_id ty_category                            ,this_year.sales ty_sales                            ,this_year.number_sales ty_number_sales                            ,last_year.channel ly_channel                            ,last_year.i_brand_id ly_brand                            ,last_year.i_class_id ly_class                            ,last_year.i_category_id ly_category                            ,last_year.sales ly_sales                            ,last_year.number_sales ly_number_sales  from  (select 'store' channel, i_brand_id,i_class_id,i_category_id         ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales  from store_sales      ,item      ,date_dim  where ss_item_sk in (select ss_item_sk from cross_items)    and ss_item_sk = i_item_sk    and ss_sold_date_sk = d_date_sk    and d_week_seq = (select d_week_seq                      from date_dim                      where d_year = 1998 + 1                        and d_moy = 12                        and d_dom = 5)    and i_category IN ('Books', 'Home', 'Jewelry')    and i_manager_id BETWEEN 28 and 37    and ss_wholesale_cost BETWEEN 80 AND 100  group by i_brand_id,i_class_id,i_category_id  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year,  (select 'store' channel, i_brand_id,i_class_id         ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales  from store_sales      ,item      ,date_dim  where ss_item_sk in (select ss_item_sk from cross_items)    and ss_item_sk = i_item_sk    and ss_sold_date_sk = d_date_sk    and d_week_seq = (select d_week_seq                      from date_dim                      where d_year = 1998                        and d_moy = 12                        and d_dom = 5)    and i_category IN ('Books', 'Home', 'Jewelry')    and ss_wholesale_cost BETWEEN 80 AND 100    and i_manager_id BETWEEN 28 and 37 group by i_brand_id,i_class_id,i_category_id  having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year  where this_year.i_brand_id= last_year.i_brand_id    and this_year.i_class_id = last_year.i_class_id    and this_year.i_category_id = last_year.i_category_id  order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id  limit 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.468s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│     CTE     │
│    ──────   │
│  CTE Name:  │
│ cross_items │
│             │
│ Table Index:├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│      0      │                                                                                                                                              │
│             │                                                                                                                                              │
│    0 rows   │                                                                                                                                              │
│   (0.00s)   │                                                                                                                                              │
└──────┬──────┘                                                                                                                                              │
┌──────┴──────┐                                                                                                                                       ┌──────┴──────┐
│  PROJECTION │                                                                                                                                       │     CTE     │
│    ──────   │                                                                                                                                       │    ──────   │
│  ss_item_sk │                                                                                                                                       │  CTE Name:  │
│             │                                                                                                                                       │  avg_sales  │
│             │                                                                                                                                       │             │
│             │                                                                                                                                       │ Table Index:├───────────────────────────────────────────────────────────────────────────
│             │                                                                                                                                       │      37     │                                                                           
│             │                                                                                                                                       │             │                                                                           
│  3,370 rows │                                                                                                                                       │    0 rows   │                                                                           
│   (0.00s)   │                                                                                                                                       │   (0.00s)   │                                                                           
└──────┬──────┘                                                                                                                                       └──────┬──────┘                                                                           
┌──────┴──────┐                                                                                                                                       ┌──────┴──────┐                                                                           
│  HASH_JOIN  │                                                                                                                                       │UNGROUPE...  │                                                                           
│    ──────   │                                                                                                                                       │    ──────   │                                                                           
│  Join Type: │                                                                                                                                       │ Aggregates: │                                                                           
│    INNER    │                                                                                                                                       │   avg(#0)   │                                                                           
│             │                                                                                                                                       │             │                                                                           
│ Conditions: │                                                                                                                                       │             │                                                                           
│  brand_id = │                                                                                                                                       │             │                                                                           
│  i_brand_id │                                                                                                                                       │             │                                                                           
│  class_id = │                                                                                                                                       │             │                                                                           
│  i_class_id │                                                                                                                                       │             │                                                                           
│ category_id ├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐       │             │                                                                           
│= i_category_│                                                                                                                               │       │             │                                                                           
│      id     │                                                                                                                               │       │             │                                                                           
│             │                                                                                                                               │       │             │                                                                           
│             │                                                                                                                               │       │             │                                                                           
│             │                                                                                                                               │       │             │                                                                           
│             │                                                                                                                               │       │             │                                                                           
│             │                                                                                                                               │       │             │                                                                           
│  3,370 rows │                                                                                                                               │       │    1 row    │                                                                           
│   (0.00s)   │                                                                                                                               │       │   (0.04s)   │                                                                           
└──────┬──────┘                                                                                                                               │       └──────┬──────┘                                                                           
┌──────┴──────┐                                                                                                                        ┌──────┴──────┐┌──────┴──────┐                                                                           
│HASH_GROUP_BY│                                                                                                                        │  PROJECTION ││  PROJECTION │                                                                           
│    ──────   │                                                                                                                        │    ──────   ││    ──────   │                                                                           
│   Groups:   │                                                                                                                        │      #0     ││(CAST(quantit│                                                                           
│      #0     │                                                                                                                        │      #1     ││ y AS DECIMAL│                                                                           
│      #1     │                                                                                                                        │      #2     ││  (26,0)) *  │                                                                           
│      #2     │                                                                                                                        │      #4     ││ CAST(list_pr│                                                                           
│             │                                                                                                                        │             ││ice AS DECIMA│                                                                           
│             │                                                                                                                        │             ││  L(26,2)))  │                                                                           
│             │                                                                                                                        │             ││             │                                                                           
│             │                                                                                                                        │             ││             │                                                                           
│             │                                                                                                                        │             ││             │                                                                           
│             │                                                                                                                        │             ││             │                                                                           
│             │                                                                                                                        │             ││             │                                                                           
│             │                                                                                                                        │             ││             │                                                                           
│             │                                                                                                                        │             ││             │                                                                           
│             │                                                                                                                        │             ││             │                                                                           
│             │                                                                                                                        │             ││             │                                                                           
│   891 rows  │                                                                                                                        │  4,418 rows ││5,847,99...  │                                                                           
│   (0.00s)   │                                                                                                                        │   (0.00s)   ││   (0.29s)   │                                                                           
└──────┬──────┘                                                                                                                        └──────┬──────┘└──────┬──────┘                                                                           
┌──────┴──────┐                                                                                                                        ┌──────┴──────┐┌──────┴──────┐                                                                           
│  HASH_JOIN  │                                                                                                                        │    FILTER   ││    UNION    │                                                                           
│    ──────   │                                                                                                                        │    ──────   ││    ──────   │                                                                           
│  Join Type: │                                                                                                                        │ ((i_category││             │                                                                           
│     SEMI    │                                                                                                                        │  = 'Books') ││             │                                                                           
│             │                                                                                                                        │ OR (i_catego││             │                                                                           
│ Conditions: │                                                                                                                        │ ry = 'Home')││             │                                                                           
│  #0 IS NOT  │                                                                                                                        │ OR (i_catego││             │                                                                           
│   DISTINCT  │                                                                                                                        │ry = 'Jewelry││             │                                                                           
│    FROM #0  │                                                                                                                        │     '))     ││             │                                                                           
│  #1 IS NOT  ├──────────────────────────────────────────────────────────────────────────────────┐                                     │             ││             ├────────────────────────────────────────────────────┐                      
│   DISTINCT  │                                                                                  │                                     │             ││             │                                                    │                      
│    FROM #1  │                                                                                  │                                     │             ││             │                                                    │                      
│  #2 IS NOT  │                                                                                  │                                     │             ││             │                                                    │                      
│   DISTINCT  │                                                                                  │                                     │             ││             │                                                    │                      
│    FROM #2  │                                                                                  │                                     │             ││             │                                                    │                      
│             │                                                                                  │                                     │             ││             │                                                    │                      
│   891 rows  │                                                                                  │                                     │  4,418 rows ││    0 rows   │                                                    │                      
│   (0.09s)   │                                                                                  │                                     │   (0.00s)   ││   (0.00s)   │                                                    │                      
└──────┬──────┘                                                                                  │                                     └──────┬──────┘└──────┬──────┘                                                    │                      
┌──────┴──────┐                                                                           ┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐               
│HASH_GROUP_BY│                                                                           │  PROJECTION │                              │  TABLE_SCAN ││    UNION    │                                             │  PROJECTION │               
│    ──────   │                                                                           │    ──────   │                              │    ──────   ││    ──────   │                                             │    ──────   │               
│   Groups:   │                                                                           │  i_brand_id │                              │    Table:   ││             │                                             │   quantity  │               
│      #0     │                                                                           │  i_class_id │                              │     item    ││             │                                             │  list_price │               
│      #1     │                                                                           │i_category_id│                              │             ││             │                                             │             │               
│      #2     │                                                                           │             │                              │    Type:    ││             │                                             │             │               
│             │                                                                           │             │                              │  Sequential ││             │                                             │             │               
│             │                                                                           │             │                              │     Scan    ││             │                                             │             │               
│             │                                                                           │             │                              │             ││             │                                             │             │               
│             │                                                                           │             │                              │ Projections:││             │                                             │             │               
│             │                                                                           │             │                              │  i_brand_id ││             │                                             │             │               
│             │                                                                           │             │                              │  i_class_id ││             │                                             │             │               
│             │                                                                           │             │                              │i_category_id││             │                                             │             │               
│             │                                                                           │             │                              │  i_category ││             │                                             │             │               
│             │                                                                           │             │                              │  i_item_sk  ││             ├──────────────────────┐                      │             │               
│             │                                                                           │             │                              │             ││             │                      │                      │             │               
│             │                                                                           │             │                              │   Filters:  ││             │                      │                      │             │               
│             │                                                                           │             │                              │  optional:  ││             │                      │                      │             │               
│             │                                                                           │             │                              │  i_category ││             │                      │                      │             │               
│             │                                                                           │             │                              │  IN ('Books'││             │                      │                      │             │               
│             │                                                                           │             │                              │  , 'Home',  ││             │                      │                      │             │               
│             │                                                                           │             │                              │  'Jewelry') ││             │                      │                      │             │               
│             │                                                                           │             │                              │ i_manager_id││             │                      │                      │             │               
│             │                                                                           │             │                              │   >=28 AND  ││             │                      │                      │             │               
│             │                                                                           │             │                              │ i_manager_id││             │                      │                      │             │               
│             │                                                                           │             │                              │     <=37    ││             │                      │                      │             │               
│             │                                                                           │             │                              │             ││             │                      │                      │             │               
│   894 rows  │                                                                           │ 870,515 rows│                              │ 14,947 rows ││    0 rows   │                      │                      │ 870,515 rows│               
│   (0.11s)   │                                                                           │   (0.00s)   │                              │   (0.01s)   ││   (0.00s)   │                      │                      │   (0.00s)   │               
└──────┬──────┘                                                                           └──────┬──────┘                              └─────────────┘└──────┬──────┘                      │                      └──────┬──────┘               
┌──────┴──────┐                                                                           ┌──────┴──────┐                                             ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐               
│  HASH_JOIN  │                                                                           │  HASH_JOIN  │                                             │  PROJECTION │               │  PROJECTION │               │  HASH_JOIN  │               
│    ──────   │                                                                           │    ──────   │                                             │    ──────   │               │    ──────   │               │    ──────   │               
│  Join Type: │                                                                           │  Join Type: │                                             │   quantity  │               │   quantity  │               │  Join Type: │               
│     SEMI    │                                                                           │    INNER    │                                             │  list_price │               │  list_price │               │    INNER    │               
│             │                                                                           │             │                                             │             │               │             │               │             │               
│ Conditions: │                                                                           │ Conditions: │                                             │             │               │             │               │ Conditions: │               
│  #0 IS NOT  │                                                                           │ ws_item_sk =│                                             │             │               │             │               │ws_sold_date_│               
│   DISTINCT  │                                                                           │   i_item_sk │                                             │             │               │             │               │sk = d_date_s│               
│    FROM #0  │                                                                           │             │                                             │             │               │             │               │      k      │               
│  #1 IS NOT  ├─────────────────────────────────────┐                                     │             ├──────────────────────┐                      │             │               │             │               │             ├───────┐       
│   DISTINCT  │                                     │                                     │             │                      │                      │             │               │             │               │             │       │       
│    FROM #1  │                                     │                                     │             │                      │                      │             │               │             │               │             │       │       
│  #2 IS NOT  │                                     │                                     │             │                      │                      │             │               │             │               │             │       │       
│   DISTINCT  │                                     │                                     │             │                      │                      │             │               │             │               │             │       │       
│    FROM #2  │                                     │                                     │             │                      │                      │             │               │             │               │             │       │       
│             │                                     │                                     │             │                      │                      │             │               │             │               │             │       │       
│             │                                     │                                     │             │                      │                      │             │               │             │               │             │       │       
│ 139,309 rows│                                     │                                     │ 870,515 rows│                      │                      │3,248,80...  │               │1,728,68...  │               │ 870,515 rows│       │       
│   (0.03s)   │                                     │                                     │   (0.01s)   │                      │                      │   (0.00s)   │               │   (0.00s)   │               │   (0.01s)   │       │       
└──────┬──────┘                                     │                                     └──────┬──────┘                      │                      └──────┬──────┘               └──────┬──────┘               └──────┬──────┘       │       
┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐
│  PROJECTION │                              │  PROJECTION │                              │  HASH_JOIN  │               │  TABLE_SCAN │               │  HASH_JOIN  │               │  HASH_JOIN  │               │  TABLE_SCAN ││    FILTER   │
│    ──────   │                              │    ──────   │                              │    ──────   │               │    ──────   │               │    ──────   │               │    ──────   │               │    ──────   ││    ──────   │
│   brand_id  │                              │  i_brand_id │                              │  Join Type: │               │    Table:   │               │  Join Type: │               │  Join Type: │               │    Table:   ││  (d_date_sk │
│   class_id  │                              │  i_class_id │                              │    INNER    │               │     item    │               │    INNER    │               │    INNER    │               │  web_sales  ││    BETWEEN  │
│ category_id │                              │i_category_id│                              │             │               │             │               │             │               │             │               │             ││  2450816 AND│
│             │                              │             │                              │ Conditions: │               │    Type:    │               │ Conditions: │               │ Conditions: │               │    Type:    ││   2452642)  │
│             │                              │             │                              │ws_sold_date_│               │  Sequential │               │ss_sold_date_│               │cs_sold_date_│               │  Sequential ││             │
│             │                              │             │                              │sk = d_date_s│               │     Scan    │               │sk = d_date_s│               │sk = d_date_s│               │     Scan    ││             │
│             │                              │             │                              │      k      │               │             │               │      k      │               │      k      │               │             ││             │
│             │                              │             │                              │             │               │ Projections:│               │             │               │             │               │ Projections:││             │
│             │                              │             │                              │             │               │  i_item_sk  │               │             │               │             │               │ws_sold_date_││             │
│             │                              │             │                              │             │               │  i_brand_id │               │             │               │             │               │      sk     ││             │
│             │                              │             │                              │             │               │  i_class_id │               │             │               │             │               │ ws_quantity ││             │
│             │                              │             │                              │             │               │i_category_id│               │             │               │             │               │ws_list_price││             │
│             │                              │             │                              │             │               │             │               │             │               │             │               │             ││             │
│             │                              │             │                              │             ├───────┐       │             │               │             ├───────┐       │             ├───────┐       │   Filters:  ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │ws_wholesale_││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │ cost>=80.00 ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │ AND ws_whole││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │  sale_cost< ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │   =100.00   ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │             ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │             ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │             ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │             ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │             ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │             ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │             ││             │
│             │                              │             │                              │             │       │       │             │               │             │       │       │             │       │       │             ││             │
│ 139,309 rows│                              │ 74,440 rows │                              │ 870,515 rows│       │       │ 102,000 rows│               │3,248,80...  │       │       │1,728,68...  │       │       │ 870,515 rows││  1,095 rows │
│   (0.00s)   │                              │   (0.00s)   │                              │   (0.01s)   │       │       │   (0.01s)   │               │   (0.03s)   │       │       │   (0.01s)   │       │       │   (0.24s)   ││   (0.00s)   │
└──────┬──────┘                              └──────┬──────┘                              └──────┬──────┘       │       └─────────────┘               └──────┬──────┘       │       └──────┬──────┘       │       └─────────────┘└──────┬──────┘
┌──────┴──────┐                              ┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐
│  HASH_JOIN  │                              │  HASH_JOIN  │                              │  TABLE_SCAN ││    FILTER   │                              │  TABLE_SCAN ││    FILTER   ││  TABLE_SCAN ││    FILTER   │               │  TABLE_SCAN │
│    ──────   │                              │    ──────   │                              │    ──────   ││    ──────   │                              │    ──────   ││    ──────   ││    ──────   ││    ──────   │               │    ──────   │
│  Join Type: │                              │  Join Type: │                              │    Table:   ││  (d_date_sk │                              │    Table:   ││  (d_date_sk ││    Table:   ││  (d_date_sk │               │    Table:   │
│    INNER    │                              │    INNER    │                              │  web_sales  ││    BETWEEN  │                              │ store_sales ││    BETWEEN  ││catalog_sales││    BETWEEN  │               │   date_dim  │
│             │                              │             │                              │             ││  2450816 AND│                              │             ││  2450816 AND││             ││  2450815 AND│               │             │
│ Conditions: │                              │ Conditions: │                              │    Type:    ││   2452642)  │                              │    Type:    ││   2452642)  ││    Type:    ││   2452653)  │               │    Type:    │
│ss_sold_date_│                              │cs_sold_date_│                              │  Sequential ││             │                              │  Sequential ││             ││  Sequential ││             │               │  Sequential │
│sk = d_date_s│                              │sk = d_date_s│                              │     Scan    ││             │                              │     Scan    ││             ││     Scan    ││             │               │     Scan    │
│      k      │                              │      k      │                              │             ││             │                              │             ││             ││             ││             │               │             │
│             │                              │             │                              │ Projections:││             │                              │ Projections:││             ││ Projections:││             │               │ Projections:│
│             │                              │             │                              │  ws_item_sk ││             │                              │ss_sold_date_││             ││cs_sold_date_││             │               │  d_date_sk  │
│             │                              │             │                              │ws_sold_date_││             │                              │      sk     ││             ││      sk     ││             │               │             │
│             ├──────────────────────┐       │             ├──────────────────────┐       │      sk     ││             │                              │ ss_quantity ││             ││ cs_quantity ││             │               │   Filters:  │
│             │                      │       │             │                      │       │             ││             │                              │ss_list_price││             ││cs_list_price││             │               │ d_year>=1998│
│             │                      │       │             │                      │       │   Filters:  ││             │                              │             ││             ││             ││             │               │  AND d_year<│
│             │                      │       │             │                      │       │ws_wholesale_││             │                              │   Filters:  ││             ││   Filters:  ││             │               │    =2000    │
│             │                      │       │             │                      │       │ cost>=80.00 ││             │                              │ss_wholesale_││             ││cs_wholesale_││             │               │             │
│             │                      │       │             │                      │       │ AND ws_whole││             │                              │ cost>=80.00 ││             ││ cost>=80.00 ││             │               │             │
│             │                      │       │             │                      │       │  sale_cost< ││             │                              │ AND ss_whole││             ││ AND cs_whole││             │               │             │
│             │                      │       │             │                      │       │   =100.00   ││             │                              │  sale_cost< ││             ││  sale_cost< ││             │               │             │
│             │                      │       │             │                      │       │             ││             │                              │   =100.00   ││             ││   =100.00   ││             │               │             │
│             │                      │       │             │                      │       │             ││             │                              │             ││             ││             ││             │               │             │
│ 139,309 rows│                      │       │ 74,440 rows │                      │       │ 870,515 rows││  1,095 rows │                              │3,248,80...  ││  1,095 rows ││1,728,68...  ││  1,096 rows │               │  1,096 rows │
│   (0.00s)   │                      │       │   (0.00s)   │                      │       │   (0.35s)   ││   (0.00s)   │                              │   (0.94s)   ││   (0.00s)   ││   (0.77s)   ││   (0.00s)   │               │   (0.00s)   │
└──────┬──────┘                      │       └──────┬──────┘                      │       └─────────────┘└──────┬──────┘                              └─────────────┘└──────┬──────┘└─────────────┘└──────┬──────┘               └─────────────┘
┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐                                             ┌──────┴──────┐               ┌──────┴──────┐                              
│  HASH_JOIN  │               │    FILTER   ││  HASH_JOIN  │               │    FILTER   │               │  TABLE_SCAN │                                             │  TABLE_SCAN │               │  TABLE_SCAN │                              
│    ──────   │               │    ──────   ││    ──────   │               │    ──────   │               │    ──────   │                                             │    ──────   │               │    ──────   │                              
│  Join Type: │               │  (d_date_sk ││  Join Type: │               │  (d_date_sk │               │    Table:   │                                             │    Table:   │               │    Table:   │                              
│    INNER    │               │    BETWEEN  ││    INNER    │               │    BETWEEN  │               │   date_dim  │                                             │   date_dim  │               │   date_dim  │                              
│             │               │  2450816 AND││             │               │  2450815 AND│               │             │                                             │             │               │             │                              
│ Conditions: │               │   2452642)  ││ Conditions: │               │   2452653)  │               │    Type:    │                                             │    Type:    │               │    Type:    │                              
│ ss_item_sk =│               │             ││ cs_item_sk =│               │             │               │  Sequential │                                             │  Sequential │               │  Sequential │                              
│   i_item_sk │               │             ││   i_item_sk │               │             │               │     Scan    │                                             │     Scan    │               │     Scan    │                              
│             │               │             ││             │               │             │               │             │                                             │             │               │             │                              
│             ├───────┐       │             ││             ├───────┐       │             │               │ Projections:│                                             │ Projections:│               │ Projections:│                              
│             │       │       │             ││             │       │       │             │               │  d_date_sk  │                                             │  d_date_sk  │               │  d_date_sk  │                              
│             │       │       │             ││             │       │       │             │               │             │                                             │             │               │             │                              
│             │       │       │             ││             │       │       │             │               │   Filters:  │                                             │   Filters:  │               │   Filters:  │                              
│             │       │       │             ││             │       │       │             │               │ d_year>=1998│                                             │ d_year>=1998│               │ d_year>=1998│                              
│             │       │       │             ││             │       │       │             │               │  AND d_year<│                                             │  AND d_year<│               │  AND d_year<│                              
│             │       │       │             ││             │       │       │             │               │    =2000    │                                             │    =2000    │               │    =2000    │                              
│             │       │       │             ││             │       │       │             │               │             │                                             │             │               │             │                              
│ 139,309 rows│       │       │  1,095 rows ││ 74,440 rows │       │       │  1,096 rows │               │  1,096 rows │                                             │  1,096 rows │               │  1,096 rows │                              
│   (0.05s)   │       │       │   (0.00s)   ││   (0.02s)   │       │       │   (0.00s)   │               │   (0.00s)   │                                             │   (0.00s)   │               │   (0.00s)   │                              
└──────┬──────┘       │       └──────┬──────┘└──────┬──────┘       │       └──────┬──────┘               └─────────────┘                                             └─────────────┘               └─────────────┘                              
┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐                                                                                                                                                      
│  TABLE_SCAN ││  PROJECTION ││  TABLE_SCAN ││  TABLE_SCAN ││  PROJECTION ││  TABLE_SCAN │                                                                                                                                                      
│    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   │                                                                                                                                                      
│    Table:   ││      #0     ││    Table:   ││    Table:   ││      #0     ││    Table:   │                                                                                                                                                      
│ store_sales ││      #2     ││   date_dim  ││catalog_sales││      #2     ││   date_dim  │                                                                                                                                                      
│             ││      #3     ││             ││             ││      #3     ││             │                                                                                                                                                      
│    Type:    ││      #4     ││    Type:    ││    Type:    ││      #4     ││    Type:    │                                                                                                                                                      
│  Sequential ││             ││  Sequential ││  Sequential ││             ││  Sequential │                                                                                                                                                      
│     Scan    ││             ││     Scan    ││     Scan    ││             ││     Scan    │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│ Projections:││             ││ Projections:││ Projections:││             ││ Projections:│                                                                                                                                                      
│  ss_item_sk ││             ││  d_date_sk  ││  cs_item_sk ││             ││  d_date_sk  │                                                                                                                                                      
│ss_sold_date_││             ││             ││cs_sold_date_││             ││             │                                                                                                                                                      
│      sk     ││             ││   Filters:  ││      sk     ││             ││   Filters:  │                                                                                                                                                      
│             ││             ││ d_year>=1998││             ││             ││ d_year>=1998│                                                                                                                                                      
│   Filters:  ││             ││  AND d_year<││   Filters:  ││             ││  AND d_year<│                                                                                                                                                      
│ss_wholesale_││             ││    =2000    ││cs_wholesale_││             ││    =2000    │                                                                                                                                                      
│ cost>=80.00 ││             ││             ││ cost>=80.00 ││             ││             │                                                                                                                                                      
│ AND ss_whole││             ││             ││ AND cs_whole││             ││             │                                                                                                                                                      
│  sale_cost< ││             ││             ││  sale_cost< ││             ││             │                                                                                                                                                      
│   =100.00   ││             ││             ││   =100.00   ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│             ││             ││             ││             ││             ││             │                                                                                                                                                      
│3,245,07...  ││  4,418 rows ││  1,096 rows ││1,726,66...  ││  4,418 rows ││  1,096 rows │                                                                                                                                                      
│   (0.25s)   ││   (0.00s)   ││   (0.00s)   ││   (1.33s)   ││   (0.00s)   ││   (0.00s)   │                                                                                                                                                      
└─────────────┘└──────┬──────┘└─────────────┘└─────────────┘└──────┬──────┘└─────────────┘                                                                                                                                                      
               ┌──────┴──────┐                              ┌──────┴──────┐                                                                                                                                                                     
               │    FILTER   │                              │    FILTER   │                                                                                                                                                                     
               │    ──────   │                              │    ──────   │                                                                                                                                                                     
               │ ((i_category│                              │ ((i_category│                                                                                                                                                                     
               │  = 'Books') │                              │  = 'Books') │                                                                                                                                                                     
               │ OR (i_catego│                              │ OR (i_catego│                                                                                                                                                                     
               │ ry = 'Home')│                              │ ry = 'Home')│                                                                                                                                                                     
               │ OR (i_catego│                              │ OR (i_catego│                                                                                                                                                                     
               │ry = 'Jewelry│                              │ry = 'Jewelry│                                                                                                                                                                     
               │     '))     │                              │     '))     │                                                                                                                                                                     
               │             │                              │             │                                                                                                                                                                     
               │  4,418 rows │                              │  4,418 rows │                                                                                                                                                                     
               │   (0.00s)   │                              │   (0.00s)   │                                                                                                                                                                     
               └──────┬──────┘                              └──────┬──────┘                                                                                                                                                                     
               ┌──────┴──────┐                              ┌──────┴──────┐                                                                                                                                                                     
               │  TABLE_SCAN │                              │  TABLE_SCAN │                                                                                                                                                                     
               │    ──────   │                              │    ──────   │                                                                                                                                                                     
               │    Table:   │                              │    Table:   │                                                                                                                                                                     
               │     item    │                              │     item    │                                                                                                                                                                     
               │             │                              │             │                                                                                                                                                                     
               │    Type:    │                              │    Type:    │                                                                                                                                                                     
               │  Sequential │                              │  Sequential │                                                                                                                                                                     
               │     Scan    │                              │     Scan    │                                                                                                                                                                     
               │             │                              │             │                                                                                                                                                                     
               │ Projections:│                              │ Projections:│                                                                                                                                                                     
               │  i_item_sk  │                              │  i_item_sk  │                                                                                                                                                                     
               │  i_category │                              │  i_category │                                                                                                                                                                     
               │  i_brand_id │                              │  i_brand_id │                                                                                                                                                                     
               │  i_class_id │                              │  i_class_id │                                                                                                                                                                     
               │i_category_id│                              │i_category_id│                                                                                                                                                                     
               │             │                              │             │                                                                                                                                                                     
               │   Filters:  │                              │   Filters:  │                                                                                                                                                                     
               │  optional:  │                              │  optional:  │                                                                                                                                                                     
               │  i_category │                              │  i_category │                                                                                                                                                                     
               │  IN ('Books'│                              │  IN ('Books'│                                                                                                                                                                     
               │  , 'Home',  │                              │  , 'Home',  │                                                                                                                                                                     
               │  'Jewelry') │                              │  'Jewelry') │                                                                                                                                                                     
               │ i_manager_id│                              │ i_manager_id│                                                                                                                                                                     
               │   >=28 AND  │                              │   >=28 AND  │                                                                                                                                                                     
               │ i_manager_id│                              │ i_manager_id│                                                                                                                                                                     
               │     <=37    │                              │     <=37    │                                                                                                                                                                     
               │             │                              │             │                                                                                                                                                                     
               │ 14,947 rows │                              │ 14,947 rows │                                                                                                                                                                     
               │   (0.01s)   │                              │   (0.01s)   │                                                                                                                                                                     
               └─────────────┘                              └─────────────┘                                                                                                                                                                     
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                
                                                                                                                                                                                                                                                

