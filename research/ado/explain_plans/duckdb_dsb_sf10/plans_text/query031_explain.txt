-- benchmark: dsb
-- query_id: query031
-- source_sql: research/ado/queries_dsb_sf10_duckdb/multi_block_queries/query031.sql
-- database: /mnt/d/TPC-DS/dsb_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 147.938
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE with ss as  (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales  from store_sales,date_dim,customer_address, item  where ss_sold_date_sk = d_date_sk   and ss_addr_sk=ca_address_sk   and ss_item_sk = i_item_sk   and i_color IN ('purple', 'sandy')   and i_manager_id BETWEEN 36 and 55   and ss_list_price between 77 and 91   and ca_state in ('GA','IL')  group by ca_county,d_qoy, d_year),  ws as  (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales  from web_sales,date_dim,customer_address, item  where ws_sold_date_sk = d_date_sk   and ws_bill_addr_sk=ca_address_sk   and ws_item_sk = i_item_sk   and i_color IN ('purple', 'sandy')   and i_manager_id BETWEEN 36 and 55   and ws_list_price between 77 and 91   and ca_state in ('GA','IL') group by ca_county,d_qoy, d_year)  select         ss1.ca_county        ,ss1.d_year        ,ws2.web_sales/ws1.web_sales web_q1_q2_increase        ,ss2.store_sales/ss1.store_sales store_q1_q2_increase        ,ws3.web_sales/ws2.web_sales web_q2_q3_increase        ,ss3.store_sales/ss2.store_sales store_q2_q3_increase  from         ss ss1        ,ss ss2        ,ss ss3        ,ws ws1        ,ws ws2        ,ws ws3  where     ss1.d_qoy = 1     and ss1.d_year = 2001     and ss1.ca_county = ss2.ca_county     and ss2.d_qoy = 2     and ss2.d_year = 2001  and ss2.ca_county = ss3.ca_county     and ss3.d_qoy = 3     and ss3.d_year = 2001     and ss1.ca_county = ws1.ca_county     and ws1.d_qoy = 1     and ws1.d_year = 2001     and ws1.ca_county = ws2.ca_county     and ws2.d_qoy = 2     and ws2.d_year = 2001     and ws1.ca_county = ws3.ca_county     and ws3.d_qoy = 3     and ws3.d_year =2001     and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end        > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end     and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end        > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end  order by store_q1_q2_increase
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.146s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────┐
│     QUERY     │
└───────┬───────┘
┌───────┴───────┐
│EXPLAIN_ANALYZE│
│    ────────   │
│     0 rows    │
│    (0.00s)    │
└───────┬───────┘
┌───────┴───────┐
│      CTE      │
│    ────────   │
│   CTE Name:   │
│       ss      │
│               │
│  Table Index: ├───────────────────────────────────────────────────────────┐
│       0       │                                                           │
│               │                                                           │
│     0 rows    │                                                           │
│    (0.00s)    │                                                           │
└───────┬───────┘                                                           │
┌───────┴───────┐                                                   ┌───────┴───────┐
│   PROJECTION  │                                                   │      CTE      │
│    ────────   │                                                   │    ────────   │
│       #0      │                                                   │   CTE Name:   │
│__internal_deco│                                                   │       ws      │
│mpress_integral│                                                   │               │
│ _bigint(#1, 1)│                                                   │  Table Index: │
│__internal_deco│                                                   │       11      │
│mpress_integral│                                                   │               ├───────────────────────────────────────────────────────────┐
│  _bigint(#2,  │                                                   │               │                                                           │
│      1900)    │                                                   │               │                                                           │
│       #3      │                                                   │               │                                                           │
│               │                                                   │               │                                                           │
│    168 rows   │                                                   │     0 rows    │                                                           │
│    (0.00s)    │                                                   │    (0.00s)    │                                                           │
└───────┬───────┘                                                   └───────┬───────┘                                                           │
┌───────┴───────┐                                                   ┌───────┴───────┐                                                   ┌───────┴───────┐
│ HASH_GROUP_BY │                                                   │   PROJECTION  │                                                   │    ORDER_BY   │
│    ────────   │                                                   │    ────────   │                                                   │    ────────   │
│    Groups:    │                                                   │       #0      │                                                   │(ss2.store_sale│
│       #0      │                                                   │__internal_deco│                                                   │s / ss1.store_s│
│       #1      │                                                   │mpress_integral│                                                   │   ales) ASC   │
│       #2      │                                                   │ _bigint(#1, 1)│                                                   │               │
│               │                                                   │__internal_deco│                                                   │               │
│  Aggregates:  │                                                   │mpress_integral│                                                   │               │
│    sum(#3)    │                                                   │  _bigint(#2,  │                                                   │               │
│               │                                                   │      1900)    │                                                   │               │
│               │                                                   │       #3      │                                                   │               │
│               │                                                   │               │                                                   │               │
│    168 rows   │                                                   │    41 rows    │                                                   │     0 rows    │
│    (0.01s)    │                                                   │    (0.00s)    │                                                   │    (0.00s)    │
└───────┬───────┘                                                   └───────┬───────┘                                                   └───────┬───────┘
┌───────┴───────┐                                                   ┌───────┴───────┐                                                   ┌───────┴───────┐
│   PROJECTION  │                                                   │ HASH_GROUP_BY │                                                   │   PROJECTION  │
│    ────────   │                                                   │    ────────   │                                                   │    ────────   │
│   ca_county   │                                                   │    Groups:    │                                                   │   ca_county   │
│     d_qoy     │                                                   │       #0      │                                                   │     d_year    │
│     d_year    │                                                   │       #1      │                                                   │web_q1_q2_incre│
│ss_ext_sales_pr│                                                   │       #2      │                                                   │      ase      │
│      ice      │                                                   │               │                                                   │store_q1_q2_inc│
│               │                                                   │  Aggregates:  │                                                   │     rease     │
│               │                                                   │    sum(#3)    │                                                   │web_q2_q3_incre│
│               │                                                   │               │                                                   │      ase      │
│               │                                                   │               │                                                   │store_q2_q3_inc│
│               │                                                   │               │                                                   │     rease     │
│               │                                                   │               │                                                   │               │
│    206 rows   │                                                   │    41 rows    │                                                   │     0 rows    │
│    (0.00s)    │                                                   │    (0.00s)    │                                                   │    (0.00s)    │
└───────┬───────┘                                                   └───────┬───────┘                                                   └───────┬───────┘
┌───────┴───────┐                                                   ┌───────┴───────┐                                                   ┌───────┴───────┐
│   PROJECTION  │                                                   │   PROJECTION  │                                                   │   PROJECTION  │
│    ────────   │                                                   │    ────────   │                                                   │    ────────   │
│       #0      │                                                   │   ca_county   │                                                   │   ca_county   │
│       #1      │                                                   │     d_qoy     │                                                   │     d_year    │
│__internal_comp│                                                   │     d_year    │                                                   │ CAST(web_sales│
│ress_integral_u│                                                   │ws_ext_sales_pr│                                                   │   AS DOUBLE)  │
│ tinyint(#2, 1)│                                                   │      ice      │                                                   │   web_sales   │
│__internal_comp│                                                   │               │                                                   │CAST(store_sale│
│ress_integral_u│                                                   │               │                                                   │  s AS DOUBLE) │
│  tinyint(#3,  │                                                   │               │                                                   │  store_sales  │
│      1900)    │                                                   │               │                                                   │   web_sales   │
│               │                                                   │               │                                                   │  store_sales  │
│               │                                                   │               │                                                   │               │
│    206 rows   │                                                   │    41 rows    │                                                   │     0 rows    │
│    (0.00s)    │                                                   │    (0.00s)    │                                                   │    (0.00s)    │
└───────┬───────┘                                                   └───────┬───────┘                                                   └───────┬───────┘
┌───────┴───────┐                                                   ┌───────┴───────┐                                                   ┌───────┴───────┐
│   HASH_JOIN   │                                                   │   PROJECTION  │                                                   │     FILTER    │
│    ────────   │                                                   │    ────────   │                                                   │    ────────   │
│   Join Type:  │                                                   │       #0      │                                                   │ ((CASE  WHEN (│
│     INNER     │                                                   │       #1      │                                                   │ (web_sales > 0│
│               │                                                   │__internal_comp│                                                   │  .00)) THEN ( │
│  Conditions:  │                                                   │ress_integral_u│                                                   │(CAST(web_sales│
│ ca_address_sk │                                                   │ tinyint(#2, 1)│                                                   │  AS DOUBLE) / │
│  = ss_addr_sk │                                                   │__internal_comp│                                                   │ CAST(web_sales│
│               │                                                   │ress_integral_u│                                                   │  AS DOUBLE))) │
│               │                                                   │  tinyint(#3,  │                                                   │  ELSE NULL END│
│               │                                                   │      1900)    │                                                   │  > CASE  WHEN │
│               │                                                   │               │                                                   │ ((store_sales │
│               │                                                   │               │                                                   │ > 0.00)) THEN │
│               │                                                   │               │                                                   │((CAST(store_sa│
│               │                                                   │               │                                                   │ les AS DOUBLE)│
│               │                                                   │               │                                                   │ / CAST(store_s│
│               │                                                   │               │                                                   │ ales AS DOUBLE│
│               │                                                   │               │                                                   │ ))) ELSE NULL │
│               │                                                   │               │                                                   │    END) AND   │
│               ├────────┐                                          │               │                                                   │ (CASE  WHEN ( │
│               │        │                                          │               │                                                   │ (web_sales > 0│
│               │        │                                          │               │                                                   │  .00)) THEN ( │
│               │        │                                          │               │                                                   │(CAST(web_sales│
│               │        │                                          │               │                                                   │  AS DOUBLE) / │
│               │        │                                          │               │                                                   │ CAST(web_sales│
│               │        │                                          │               │                                                   │  AS DOUBLE))) │
│               │        │                                          │               │                                                   │  ELSE NULL END│
│               │        │                                          │               │                                                   │  > CASE  WHEN │
│               │        │                                          │               │                                                   │ ((store_sales │
│               │        │                                          │               │                                                   │ > 0.00)) THEN │
│               │        │                                          │               │                                                   │((CAST(store_sa│
│               │        │                                          │               │                                                   │ les AS DOUBLE)│
│               │        │                                          │               │                                                   │ / CAST(store_s│
│               │        │                                          │               │                                                   │ ales AS DOUBLE│
│               │        │                                          │               │                                                   │ ))) ELSE NULL │
│               │        │                                          │               │                                                   │      END))    │
│               │        │                                          │               │                                                   │               │
│    206 rows   │        │                                          │    41 rows    │                                                   │     0 rows    │
│    (0.01s)    │        │                                          │    (0.00s)    │                                                   │    (0.00s)    │
└───────┬───────┘        │                                          └───────┬───────┘                                                   └───────┬───────┘
┌───────┴───────┐┌───────┴───────┐                                  ┌───────┴───────┐                                                   ┌───────┴───────┐
│   PROJECTION  ││   HASH_JOIN   │                                  │   HASH_JOIN   │                                                   │   HASH_JOIN   │
│    ────────   ││    ────────   │                                  │    ────────   │                                                   │    ────────   │
│       #0      ││   Join Type:  │                                  │   Join Type:  │                                                   │   Join Type:  │
│       #2      ││     INNER     │                                  │     INNER     │                                                   │     INNER     │
│               ││               │                                  │               │                                                   │               │
│               ││  Conditions:  │                                  │  Conditions:  │                                                   │  Conditions:  │
│               ││ss_sold_date_sk│                                  │ ca_address_sk │                                                   │  ca_county =  │
│               ││   = d_date_sk ├─────────────────────────┐        │= ws_bill_addr_├────────┐                                          │    ca_county  ├──────────────────────────────────────────┐
│               ││               │                         │        │       sk      │        │                                          │  ca_county =  │                                          │
│               ││               │                         │        │               │        │                                          │    ca_county  │                                          │
│               ││               │                         │        │               │        │                                          │  ca_county =  │                                          │
│               ││               │                         │        │               │        │                                          │    ca_county  │                                          │
│               ││               │                         │        │               │        │                                          │               │                                          │
│  20,022 rows  ││   2,662 rows  │                         │        │    41 rows    │        │                                          │     0 rows    │                                          │
│    (0.00s)    ││    (0.00s)    │                         │        │    (0.00s)    │        │                                          │    (0.00s)    │                                          │
└───────┬───────┘└───────┬───────┘                         │        └───────┬───────┘        │                                          └───────┬───────┘                                          │
┌───────┴───────┐┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐                                  ┌───────┴───────┐                                  ┌───────┴───────┐
│     FILTER    ││   HASH_JOIN   │                 │     FILTER    ││   PROJECTION  ││   HASH_JOIN   │                                  │   HASH_JOIN   │                                  │   HASH_JOIN   │
│    ────────   ││    ────────   │                 │    ────────   ││    ────────   ││    ────────   │                                  │    ────────   │                                  │    ────────   │
│ ((ca_state =  ││   Join Type:  │                 │ (((d_qoy = 3) ││       #0      ││   Join Type:  │                                  │   Join Type:  │                                  │   Join Type:  │
│   'GA') OR    ││     INNER     │                 │  AND (d_year =││       #2      ││     INNER     │                                  │     INNER     │                                  │     INNER     │
│  (ca_state =  ││               │                 │  2001)) OR (( ││               ││               │                                  │               │                                  │               │
│     'IL'))    ││  Conditions:  │                 │  (d_qoy = 1)  ││               ││  Conditions:  │                                  │  Conditions:  │                                  │  Conditions:  │
│               ││  ss_item_sk = │                 │  AND (d_year =││               ││ws_sold_date_sk│                                  │  ca_county =  │                                  │  ca_county =  │
│               ││    i_item_sk  ├────────┐        │   2001)) OR ( ││               ││   = d_date_sk ├─────────────────────────┐        │    ca_county  ├─────────────────────────┐        │    ca_county  ├────────┐
│               ││               │        │        │  (d_qoy = 2)  ││               ││               │                         │        │  ca_county =  │                         │        │  ca_county =  │        │
│               ││               │        │        │  AND (d_year =││               ││               │                         │        │    ca_county  │                         │        │    ca_county  │        │
│               ││               │        │        │    2001))))   ││               ││               │                         │        │               │                         │        │               │        │
│               ││               │        │        │               ││               ││               │                         │        │               │                         │        │               │        │
│  20,022 rows  ││   2,662 rows  │        │        │    274 rows   ││  19,963 rows  ││    527 rows   │                         │        │     0 rows    │                         │        │     1 row     │        │
│    (0.00s)    ││    (0.03s)    │        │        │    (0.00s)    ││    (0.00s)    ││    (0.00s)    │                         │        │    (0.00s)    │                         │        │    (0.00s)    │        │
└───────┬───────┘└───────┬───────┘        │        └───────┬───────┘└───────┬───────┘└───────┬───────┘                         │        └───────┬───────┘                         │        └───────┬───────┘        │
┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐
│   TABLE_SCAN  ││   TABLE_SCAN  ││   PROJECTION  ││   TABLE_SCAN  ││     FILTER    ││   HASH_JOIN   │                 │     FILTER    ││   HASH_JOIN   │                 │   PROJECTION  ││   PROJECTION  ││   HASH_JOIN   │
│    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   │                 │    ────────   ││    ────────   │                 │    ────────   ││    ────────   ││    ────────   │
│     Table:    ││     Table:    ││       #0      ││     Table:    ││ ((ca_state =  ││   Join Type:  │                 │ (((d_qoy = 3) ││   Join Type:  │                 │       #0      ││       #0      ││   Join Type:  │
│customer_addres││  store_sales  ││               ││    date_dim   ││   'GA') OR    ││     INNER     │                 │  AND (d_year =││     INNER     │                 │       #2      ││       #3      ││     INNER     │
│       s       ││               ││               ││               ││  (ca_state =  ││               │                 │  2001)) OR (( ││               │                 │       #3      ││               ││               │
│               ││     Type:     ││               ││     Type:     ││     'IL'))    ││  Conditions:  │                 │  (d_qoy = 1)  ││  Conditions:  │                 │               ││               ││  Conditions:  │
│     Type:     ││Sequential Scan││               ││Sequential Scan││               ││  ws_item_sk = │                 │  AND (d_year =││  ca_county =  │                 │               ││               ││  ca_county =  │
│Sequential Scan││               ││               ││               ││               ││    i_item_sk  │                 │   2001)) OR ( ││    ca_county  │                 │               ││               ││    ca_county  │
│               ││  Projections: ││               ││  Projections: ││               ││               │                 │  (d_qoy = 2)  ││               │                 │               ││               ││               │
│  Projections: ││ss_sold_date_sk││               ││   d_date_sk   ││               ││               │                 │  AND (d_year =││               │                 │               ││               ││               │
│ ca_address_sk ││   ss_addr_sk  ││               ││     d_qoy     ││               ││               │                 │    2001))))   ││               │                 │               ││               ││               │
│    ca_state   ││   ss_item_sk  ││               ││     d_year    ││               ││               ├────────┐        │               ││               ├────────┐        │               ││               ││               ├────────┐
│   ca_county   ││ss_ext_sales_pr││               ││               ││               ││               │        │        │               ││               │        │        │               ││               ││               │        │
│               ││      ice      ││               ││    Filters:   ││               ││               │        │        │               ││               │        │        │               ││               ││               │        │
│    Filters:   ││               ││               ││   d_date_sk>  ││               ││               │        │        │               ││               │        │        │               ││               ││               │        │
│   optional:   ││    Filters:   ││               ││  =2450816 AND ││               ││               │        │        │               ││               │        │        │               ││               ││               │        │
│  ca_state IN (││ ss_list_price>││               ││   d_date_sk<  ││               ││               │        │        │               ││               │        │        │               ││               ││               │        │
│  'GA', 'IL')  ││   =77.00 AND  ││               ││    =2452642   ││               ││               │        │        │               ││               │        │        │               ││               ││               │        │
│               ││  ss_list_price││               ││               ││               ││               │        │        │               ││               │        │        │               ││               ││               │        │
│               ││    <=91.00    ││               ││               ││               ││               │        │        │               ││               │        │        │               ││               ││               │        │
│               ││               ││               ││               ││               ││               │        │        │               ││               │        │        │               ││               ││               │        │
│  249,939 rows ││  293,297 rows ││    849 rows   ││   1,827 rows  ││  19,963 rows  ││    527 rows   │        │        │    274 rows   ││     1 row     │        │        │    46 rows    ││    75 rows    ││     1 row     │        │
│    (0.01s)    ││    (0.30s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    ││    (0.01s)    │        │        │    (0.00s)    ││    (0.00s)    │        │        │    (0.00s)    ││    (0.00s)    ││    (0.00s)    │        │
└───────────────┘└───────────────┘└───────┬───────┘└───────────────┘└───────┬───────┘└───────┬───────┘        │        └───────┬───────┘└───────┬───────┘        │        └───────┬───────┘└───────┬───────┘└───────┬───────┘        │
                                  ┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐
                                  │     FILTER    │                 │   TABLE_SCAN  ││   TABLE_SCAN  ││   PROJECTION  ││   TABLE_SCAN  ││   PROJECTION  ││   PROJECTION  ││     FILTER    ││     FILTER    ││   PROJECTION  ││   PROJECTION  │
                                  │    ────────   │                 │    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   │
                                  │  ((i_color =  │                 │     Table:    ││     Table:    ││       #0      ││     Table:    ││       #0      ││       #0      ││  ((d_qoy = 1) ││  ((d_qoy = 3) ││       #0      ││       #0      │
                                  │ 'purple') OR  │                 │customer_addres││   web_sales   ││               ││    date_dim   ││       #3      ││       #3      ││  AND (d_year =││  AND (d_year =││       #3      ││       #3      │
                                  │  (i_color =   │                 │       s       ││               ││               ││               ││               ││               ││     2001))    ││     2001))    ││               ││               │
                                  │   'sandy'))   │                 │               ││     Type:     ││               ││     Type:     ││               ││               ││               ││               ││               ││               │
                                  │               │                 │     Type:     ││Sequential Scan││               ││Sequential Scan││               ││               ││               ││               ││               ││               │
                                  │               │                 │Sequential Scan││               ││               ││               ││               ││               ││               ││               ││               ││               │
                                  │               │                 │               ││  Projections: ││               ││  Projections: ││               ││               ││               ││               ││               ││               │
                                  │               │                 │  Projections: ││ws_sold_date_sk││               ││   d_date_sk   ││               ││               ││               ││               ││               ││               │
                                  │               │                 │ ca_address_sk ││ws_bill_addr_sk││               ││     d_qoy     ││               ││               ││               ││               ││               ││               │
                                  │               │                 │    ca_state   ││   ws_item_sk  ││               ││     d_year    ││               ││               ││               ││               ││               ││               │
                                  │               │                 │   ca_county   ││ws_ext_sales_pr││               ││               ││               ││               ││               ││               ││               ││               │
                                  │               │                 │               ││      ice      ││               ││    Filters:   ││               ││               ││               ││               ││               ││               │
                                  │               │                 │    Filters:   ││               ││               ││   d_date_sk>  ││               ││               ││               ││               ││               ││               │
                                  │               │                 │   optional:   ││    Filters:   ││               ││  =2450816 AND ││               ││               ││               ││               ││               ││               │
                                  │               │                 │  ca_state IN (││ ws_list_price>││               ││   d_date_sk<  ││               ││               ││               ││               ││               ││               │
                                  │               │                 │  'GA', 'IL')  ││   =77.00 AND  ││               ││    =2452642   ││               ││               ││               ││               ││               ││               │
                                  │               │                 │               ││  ws_list_price││               ││               ││               ││               ││               ││               ││               ││               │
                                  │               │                 │               ││    <=91.00    ││               ││               ││               ││               ││               ││               ││               ││               │
                                  │               │                 │               ││               ││               ││               ││               ││               ││               ││               ││               ││               │
                                  │    849 rows   │                 │  249,170 rows ││  62,381 rows  ││    849 rows   ││   1,827 rows  ││    47 rows    ││    16 rows    ││    46 rows    ││    75 rows    ││    16 rows    ││     9 rows    │
                                  │    (0.00s)    │                 │    (0.01s)    ││    (1.09s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    │
                                  └───────┬───────┘                 └───────────────┘└───────────────┘└───────┬───────┘└───────────────┘└───────┬───────┘└───────┬───────┘└───────┬───────┘└───────┬───────┘└───────┬───────┘└───────┬───────┘
                                  ┌───────┴───────┐                                                   ┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐
                                  │   TABLE_SCAN  │                                                   │     FILTER    │                 │     FILTER    ││     FILTER    ││    CTE_SCAN   ││    CTE_SCAN   ││     FILTER    ││     FILTER    │
                                  │    ────────   │                                                   │    ────────   │                 │    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   ││    ────────   │
                                  │     Table:    │                                                   │  ((i_color =  │                 │  ((d_qoy = 2) ││  ((d_qoy = 1) ││   CTE Index:  ││   CTE Index:  ││  ((d_qoy = 2) ││  ((d_qoy = 3) │
                                  │      item     │                                                   │ 'purple') OR  │                 │  AND (d_year =││  AND (d_year =││       0       ││       0       ││  AND (d_year =││  AND (d_year =│
                                  │               │                                                   │  (i_color =   │                 │     2001))    ││     2001))    ││               ││               ││     2001))    ││     2001))    │
                                  │     Type:     │                                                   │   'sandy'))   │                 │               ││               ││               ││               ││               ││               │
                                  │Sequential Scan│                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │               │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │  Projections: │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │   i_item_sk   │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │    i_color    │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │               │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │    Filters:   │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │   optional:   │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │  i_color IN ( │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │   'purple',   │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │    'sandy')   │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │ i_manager_id> │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │=36 AND i_manag│                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │   er_id<=55   │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │               │                                                   │               │                 │               ││               ││               ││               ││               ││               │
                                  │  18,593 rows  │                                                   │    849 rows   │                 │    47 rows    ││    16 rows    ││    168 rows   ││    168 rows   ││    16 rows    ││     9 rows    │
                                  │    (0.00s)    │                                                   │    (0.00s)    │                 │    (0.00s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    ││    (0.00s)    │
                                  └───────────────┘                                                   └───────┬───────┘                 └───────┬───────┘└───────┬───────┘└───────────────┘└───────────────┘└───────┬───────┘└───────┬───────┘
                                                                                                      ┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐                                  ┌───────┴───────┐┌───────┴───────┐
                                                                                                      │   TABLE_SCAN  │                 │    CTE_SCAN   ││    CTE_SCAN   │                                  │    CTE_SCAN   ││    CTE_SCAN   │
                                                                                                      │    ────────   │                 │    ────────   ││    ────────   │                                  │    ────────   ││    ────────   │
                                                                                                      │     Table:    │                 │   CTE Index:  ││   CTE Index:  │                                  │   CTE Index:  ││   CTE Index:  │
                                                                                                      │      item     │                 │       0       ││       11      │                                  │       11      ││       11      │
                                                                                                      │               │                 │               ││               │                                  │               ││               │
                                                                                                      │     Type:     │                 │               ││               │                                  │               ││               │
                                                                                                      │Sequential Scan│                 │               ││               │                                  │               ││               │
                                                                                                      │               │                 │               ││               │                                  │               ││               │
                                                                                                      │  Projections: │                 │               ││               │                                  │               ││               │
                                                                                                      │   i_item_sk   │                 │               ││               │                                  │               ││               │
                                                                                                      │    i_color    │                 │               ││               │                                  │               ││               │
                                                                                                      │               │                 │               ││               │                                  │               ││               │
                                                                                                      │    Filters:   │                 │               ││               │                                  │               ││               │
                                                                                                      │   optional:   │                 │               ││               │                                  │               ││               │
                                                                                                      │  i_color IN ( │                 │               ││               │                                  │               ││               │
                                                                                                      │   'purple',   │                 │               ││               │                                  │               ││               │
                                                                                                      │    'sandy')   │                 │               ││               │                                  │               ││               │
                                                                                                      │ i_manager_id> │                 │               ││               │                                  │               ││               │
                                                                                                      │=36 AND i_manag│                 │               ││               │                                  │               ││               │
                                                                                                      │   er_id<=55   │                 │               ││               │                                  │               ││               │
                                                                                                      │               │                 │               ││               │                                  │               ││               │
                                                                                                      │  18,593 rows  │                 │    168 rows   ││    41 rows    │                                  │    41 rows    ││    41 rows    │
                                                                                                      │    (0.00s)    │                 │    (0.00s)    ││    (0.00s)    │                                  │    (0.00s)    ││    (0.00s)    │
                                                                                                      └───────────────┘                 └───────────────┘└───────────────┘                                  └───────────────┘└───────────────┘

