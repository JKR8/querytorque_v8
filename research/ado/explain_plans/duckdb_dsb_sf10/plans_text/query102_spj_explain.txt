-- benchmark: dsb
-- query_id: query102_spj
-- source_sql: research/ado/queries_dsb_sf10_duckdb/spj_queries/query102_spj.sql
-- database: /mnt/d/TPC-DS/dsb_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 123.142
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE select min(ss_item_sk),     min(ss_ticket_number),     min(ws_order_number),     min(c_customer_sk),     min(cd_demo_sk),     min(hd_demo_sk) from     store_sales,     web_sales,     date_dim d1,     date_dim d2,     customer,     inventory,     store,     warehouse,     item,     customer_demographics,     household_demographics,     customer_address where     ss_item_sk = i_item_sk     and ws_item_sk = ss_item_sk     and ss_sold_date_sk = d1.d_date_sk     and ws_sold_date_sk = d2.d_date_sk     and d2.d_date between d1.d_date and (d1.d_date + interval '30 day')     and ss_customer_sk = c_customer_sk     and ws_bill_customer_sk = c_customer_sk     and ws_warehouse_sk = inv_warehouse_sk     and ws_warehouse_sk = w_warehouse_sk     and inv_item_sk = ss_item_sk     and inv_date_sk = ss_sold_date_sk     and inv_quantity_on_hand >= ss_quantity     and s_state = w_state     AND i_category IN ('Books', 'Home', 'Sports')     and i_manager_id IN (3, 15, 17, 26, 43, 44, 55, 70, 82, 95)     and c_current_cdemo_sk = cd_demo_sk     and c_current_hdemo_sk = hd_demo_sk     and c_current_addr_sk = ca_address_sk     and ca_state in ('IN', 'LA', 'NE', 'NM', 'OH')     and d1.d_year = 2001     and ws_wholesale_cost BETWEEN 80 AND 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.121s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────┐
│     QUERY     │
└───────┬───────┘
┌───────┴───────┐
│EXPLAIN_ANALYZE│
│    ────────   │
│     0 rows    │
│    (0.00s)    │
└───────┬───────┘
┌───────┴───────┐
│UNGROUPED_...  │
│    ────────   │
│  Aggregates:  │
│    min(#0)    │
│    min(#1)    │
│    min(#2)    │
│    min(#3)    │
│    min(#4)    │
│    min(#5)    │
│               │
│     1 row     │
│    (0.00s)    │
└───────┬───────┘
┌───────┴───────┐
│   PROJECTION  │
│    ────────   │
│   ss_item_sk  │
│ss_ticket_numbe│
│       r       │
│ws_order_number│
│ c_customer_sk │
│   cd_demo_sk  │
│   hd_demo_sk  │
│               │
│     0 rows    │
│    (0.00s)    │
└───────┬───────┘
┌───────┴───────┐
│   HASH_JOIN   │
│    ────────   │
│   Join Type:  │
│     INNER     │
│               │
│  Conditions:  │
│ inv_item_sk = │
│    i_item_sk  │
│inv_warehouse_s│
│k = w_warehouse│
│      _sk      ├────────┐
│ inv_date_sk = │        │
│ ss_sold_date_s│        │
│       k       │        │
│CAST(inv_quanti│        │
│ ty_on_hand AS │        │
│   BIGINT) >=  │        │
│   ss_quantity │        │
│               │        │
│     0 rows    │        │
│    (0.00s)    │        │
└───────┬───────┘        │
┌───────┴───────┐┌───────┴───────┐
│   TABLE_SCAN  ││   HASH_JOIN   │
│    ────────   ││    ────────   │
│     Table:    ││   Join Type:  │
│   inventory   ││     INNER     │
│               ││               │
│     Type:     ││  Conditions:  │
│Sequential Scan││ws_warehouse_sk│
│               ││ = w_warehouse_│
│  Projections: ││       sk      │
│inv_warehouse_s││               │
│       k       ││               │
│  inv_item_sk  ││               ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  inv_date_sk  ││               │                                                                                                                                                                                  │
│inv_quantity_on││               │                                                                                                                                                                                  │
│     _hand     ││               │                                                                                                                                                                                  │
│               ││               │                                                                                                                                                                                  │
│    Filters:   ││               │                                                                                                                                                                                  │
│  inv_date_sk> ││               │                                                                                                                                                                                  │
│    =2450816   ││               │                                                                                                                                                                                  │
│               ││               │                                                                                                                                                                                  │
│  24,528 rows  ││     0 rows    │                                                                                                                                                                                  │
│    (0.00s)    ││    (0.00s)    │                                                                                                                                                                                  │
└───────────────┘└───────┬───────┘                                                                                                                                                                                  │
                 ┌───────┴───────┐                                                                                                                                                                          ┌───────┴───────┐
                 │   HASH_JOIN   │                                                                                                                                                                          │   HASH_JOIN   │
                 │    ────────   │                                                                                                                                                                          │    ────────   │
                 │   Join Type:  │                                                                                                                                                                          │   Join Type:  │
                 │     INNER     │                                                                                                                                                                          │     INNER     │
                 │               │                                                                                                                                                                          │               │
                 │  Conditions:  │                                                                                                                                                                          │  Conditions:  │
                 │ ss_customer_sk├─────────────────────────────────────────────────────────────────────────────────────────────┐                                                                            │   s_state =   ├────────┐
                 │ = c_customer_s│                                                                                             │                                                                            │     w_state   │        │
                 │       k       │                                                                                             │                                                                            │               │        │
                 │               │                                                                                             │                                                                            │               │        │
                 │     0 rows    │                                                                                             │                                                                            │    350 rows   │        │
                 │    (0.00s)    │                                                                                             │                                                                            │    (0.00s)    │        │
                 └───────┬───────┘                                                                                             │                                                                            └───────┬───────┘        │
                 ┌───────┴───────┐                                                                                     ┌───────┴───────┐                                                                    ┌───────┴───────┐┌───────┴───────┐
                 │   HASH_JOIN   │                                                                                     │   HASH_JOIN   │                                                                    │   TABLE_SCAN  ││   TABLE_SCAN  │
                 │    ────────   │                                                                                     │    ────────   │                                                                    │    ────────   ││    ────────   │
                 │   Join Type:  │                                                                                     │   Join Type:  │                                                                    │     Table:    ││     Table:    │
                 │     INNER     │                                                                                     │     INNER     │                                                                    │     store     ││   warehouse   │
                 │               │                                                                                     │               │                                                                    │               ││               │
                 │  Conditions:  │                                                                                     │  Conditions:  │                                                                    │     Type:     ││     Type:     │
                 │ss_sold_date_sk│                                                                                     │c_current_hdemo│                                                                    │Sequential Scan││Sequential Scan│
                 │   = d_date_sk │                                                                                     │_sk = hd_demo_s│                                                                    │               ││               │
                 │  ss_item_sk = ├────────┐                                                                            │       k       ├───────────────────────────────────────────────────────────┐        │  Projections: ││  Projections: │
                 │    i_item_sk  │        │                                                                            │               │                                                           │        │    s_state    ││ w_warehouse_sk│
                 │ ss_customer_sk│        │                                                                            │               │                                                           │        │               ││    w_state    │
                 │ = ws_bill_cust│        │                                                                            │               │                                                           │        │               ││               │
                 │    omer_sk    │        │                                                                            │               │                                                           │        │               ││               │
                 │               │        │                                                                            │               │                                                           │        │               ││               │
                 │     0 rows    │        │                                                                            │  53,013 rows  │                                                           │        │    70 rows    ││    10 rows    │
                 │    (0.23s)    │        │                                                                            │    (0.00s)    │                                                           │        │    (0.00s)    ││    (0.00s)    │
                 └───────┬───────┘        │                                                                            └───────┬───────┘                                                           │        └───────────────┘└───────────────┘
                 ┌───────┴───────┐┌───────┴───────┐                                                                    ┌───────┴───────┐                                                   ┌───────┴───────┐
                 │     FILTER    ││   HASH_JOIN   │                                                                    │   HASH_JOIN   │                                                   │   TABLE_SCAN  │
                 │    ────────   ││    ────────   │                                                                    │    ────────   │                                                   │    ────────   │
                 │(ss_sold_date_s││   Join Type:  │                                                                    │   Join Type:  │                                                   │     Table:    │
                 │ k <= 2452635) ││     INNER     │                                                                    │     INNER     │                                                   │household_demog│
                 │               ││               │                                                                    │               │                                                   │    raphics    │
                 │               ││  Conditions:  │                                                                    │  Conditions:  │                                                   │               │
                 │               ││  ws_item_sk = │                                                                    │  cd_demo_sk = │                                                   │     Type:     │
                 │               ││    i_item_sk  ├──────────────────────────────────────────┐                         │ c_current_cdem├────────┐                                          │Sequential Scan│
                 │               ││               │                                          │                         │      o_sk     │        │                                          │               │
                 │               ││               │                                          │                         │               │        │                                          │  Projections: │
                 │               ││               │                                          │                         │               │        │                                          │   hd_demo_sk  │
                 │               ││               │                                          │                         │               │        │                                          │               │
                 │ 5,336,555 rows││  295,103 rows │                                          │                         │  54,042 rows  │        │                                          │   7,200 rows  │
                 │    (0.03s)    ││    (0.04s)    │                                          │                         │    (0.04s)    │        │                                          │    (0.00s)    │
                 └───────┬───────┘└───────┬───────┘                                          │                         └───────┬───────┘        │                                          └───────────────┘
                 ┌───────┴───────┐┌───────┴───────┐                                  ┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐
                 │   TABLE_SCAN  ││   HASH_JOIN   │                                  │   PROJECTION  │                 │   TABLE_SCAN  ││   HASH_JOIN   │
                 │    ────────   ││    ────────   │                                  │    ────────   │                 │    ────────   ││    ────────   │
                 │     Table:    ││   Join Type:  │                                  │       #0      │                 │     Table:    ││   Join Type:  │
                 │  store_sales  ││     INNER     │                                  │               │                 │customer_demogr││     INNER     │
                 │               ││               │                                  │               │                 │     aphics    ││               │
                 │     Type:     ││  Conditions:  │                                  │               │                 │               ││  Conditions:  │
                 │Sequential Scan││ws_sold_date_sk│                                  │               │                 │     Type:     ││c_current_addr_│
                 │               ││   = d_date_sk │                                  │               │                 │Sequential Scan││sk = ca_address│
                 │  Projections: ││               │                                  │               │                 │               ││      _sk      │
                 │   ss_item_sk  ││               │                                  │               │                 │  Projections: ││               │
                 │ss_sold_date_sk││               │                                  │               │                 │   cd_demo_sk  ││               │
                 │ ss_customer_sk││               ├────────┐                         │               │                 │               ││               ├────────┐
                 │  ss_quantity  ││               │        │                         │               │                 │    Filters:   ││               │        │
                 │ss_ticket_numbe││               │        │                         │               │                 │ cd_demo_sk>=4 ││               │        │
                 │       r       ││               │        │                         │               │                 │ AND cd_demo_sk││               │        │
                 │               ││               │        │                         │               │                 │   <=1920791   ││               │        │
                 │    Filters:   ││               │        │                         │               │                 │               ││               │        │
                 │ ss_customer_sk││               │        │                         │               │                 │               ││               │        │
                 │>=2 AND ss_cust││               │        │                         │               │                 │               ││               │        │
                 │omer_sk<=499998││               │        │                         │               │                 │               ││               │        │
                 │               ││               │        │                         │               │                 │               ││               │        │
                 │ 5,336,555 rows││ 9,008,740 rows│        │                         │   3,299 rows  │                 │ 1,920,706 rows││  56,001 rows  │        │
                 │    (0.49s)    ││    (0.08s)    │        │                         │    (0.00s)    │                 │    (0.00s)    ││    (0.00s)    │        │
                 └───────────────┘└───────┬───────┘        │                         └───────┬───────┘                 └───────────────┘└───────┬───────┘        │
                                  ┌───────┴───────┐┌───────┴───────┐                 ┌───────┴───────┐                                  ┌───────┴───────┐┌───────┴───────┐
                                  │   TABLE_SCAN  ││PIECEWISE_...  │                 │     FILTER    │                                  │   TABLE_SCAN  ││   PROJECTION  │
                                  │    ────────   ││    ────────   │                 │    ────────   │                                  │    ────────   ││    ────────   │
                                  │     Table:    ││   Join Type:  │                 │ (IN (...) AND │                                  │     Table:    ││       #0      │
                                  │   web_sales   ││     INNER     │                 │ ((i_category =│                                  │    customer   ││               │
                                  │               ││               │                 │  'Books') OR  │                                  │               ││               │
                                  │     Type:     ││  Conditions:  │                 │ (i_category = │                                  │     Type:     ││               │
                                  │Sequential Scan││ CAST(d_date AS│                 │  'Home') OR   │                                  │Sequential Scan││               │
                                  │               ││  TIMESTAMP) >=│                 │ (i_category = │                                  │               ││               │
                                  │  Projections: ││   CAST(d_date │                 │  'Sports')))  │                                  │  Projections: ││               │
                                  │   ws_item_sk  ││  AS TIMESTAMP)│                 │               │                                  │ c_customer_sk ││               │
                                  │ws_sold_date_sk││ CAST(d_date AS│                 │               │                                  │c_current_cdemo││               │
                                  │ws_bill_custome││  TIMESTAMP) <=│                 │               │                                  │      _sk      ││               │
                                  │      r_sk     ││  (d_date + '30├────────┐        │               │                                  │c_current_hdemo││               │
                                  │ws_warehouse_sk││ days'::INTERVA│        │        │               │                                  │      _sk      ││               │
                                  │ws_order_number││       L)      │        │        │               │                                  │c_current_addr_││               │
                                  │               ││               │        │        │               │                                  │       sk      ││               │
                                  │    Filters:   ││               │        │        │               │                                  │               ││               │
                                  │ws_wholesale_co││               │        │        │               │                                  │    Filters:   ││               │
                                  │ st>=80.00 AND ││               │        │        │               │                                  │ c_customer_sk>││               │
                                  │ ws_wholesale_c││               │        │        │               │                                  │=2 AND c_custom││               │
                                  │  ost<=100.00  ││               │        │        │               │                                  │ er_sk<=499998 ││               │
                                  │               ││               │        │        │               │                                  │               ││               │
                                  │  305,376 rows ││  11,315 rows  │        │        │   3,299 rows  │                                  │  499,969 rows ││  27,979 rows  │
                                  │    (0.11s)    ││    (0.01s)    │        │        │    (0.00s)    │                                  │    (0.00s)    ││    (0.00s)    │
                                  └───────────────┘└───────┬───────┘        │        └───────┬───────┘                                  └───────────────┘└───────┬───────┘
                                                   ┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐                                                   ┌───────┴───────┐
                                                   │   TABLE_SCAN  ││     FILTER    ││   HASH_JOIN   │                                                   │     FILTER    │
                                                   │    ────────   ││    ────────   ││    ────────   │                                                   │    ────────   │
                                                   │     Table:    ││   (d_date_sk  ││   Join Type:  │                                                   │    IN (...)   │
                                                   │    date_dim   ││     BETWEEN   ││      MARK     │                                                   │               │
                                                   │               ││   2450816 AND ││               │                                                   │               │
                                                   │     Type:     ││    2452635)   ││  Conditions:  │                                                   │               │
                                                   │Sequential Scan││               ││ i_manager_id =│                                                   │               │
                                                   │               ││               ││       #0      │                                                   │               │
                                                   │  Projections: ││               ││               │                                                   │               │
                                                   │   d_date_sk   ││               ││               │                                                   │               │
                                                   │     d_date    ││               ││               ├────────┐                                          │               │
                                                   │               ││               ││               │        │                                          │               │
                                                   │    Filters:   ││               ││               │        │                                          │               │
                                                   │   d_date_sk>  ││               ││               │        │                                          │               │
                                                   │  =2450816 AND ││               ││               │        │                                          │               │
                                                   │   d_date_sk<  ││               ││               │        │                                          │               │
                                                   │    =2452642   ││               ││               │        │                                          │               │
                                                   │               ││               ││               │        │                                          │               │
                                                   │   1,827 rows  ││    365 rows   ││  102,000 rows │        │                                          │  27,979 rows  │
                                                   │    (0.00s)    ││    (0.00s)    ││    (0.00s)    │        │                                          │    (0.00s)    │
                                                   └───────────────┘└───────┬───────┘└───────┬───────┘        │                                          └───────┬───────┘
                                                                    ┌───────┴───────┐┌───────┴───────┐┌───────┴───────┐                                  ┌───────┴───────┐
                                                                    │   TABLE_SCAN  ││   TABLE_SCAN  ││COLUMN_DAT...  │                                  │   HASH_JOIN   │
                                                                    │    ────────   ││    ────────   ││               │                                  │    ────────   │
                                                                    │     Table:    ││     Table:    ││               │                                  │   Join Type:  │
                                                                    │    date_dim   ││      item     ││               │                                  │      MARK     │
                                                                    │               ││               ││               │                                  │               │
                                                                    │     Type:     ││     Type:     ││               │                                  │  Conditions:  │
                                                                    │Sequential Scan││Sequential Scan││               │                                  │ ca_state = #0 │
                                                                    │               ││               ││               │                                  │               │
                                                                    │  Projections: ││  Projections: ││               │                                  │               │
                                                                    │   d_date_sk   ││   i_item_sk   ││               │                                  │               │
                                                                    │     d_date    ││   i_category  ││               │                                  │               │
                                                                    │               ││  i_manager_id ││               │                                  │               │
                                                                    │    Filters:   ││               ││               │                                  │               │
                                                                    │  d_year=2001  ││    Filters:   ││               │                                  │               │
                                                                    │               ││   optional:   ││               │                                  │               ├────────┐
                                                                    │               ││  i_category IN││               │                                  │               │        │
                                                                    │               ││   ('Books',   ││               │                                  │               │        │
                                                                    │               ││    'Home',    ││               │                                  │               │        │
                                                                    │               ││   'Sports')   ││               │                                  │               │        │
                                                                    │               ││   optional:   ││               │                                  │               │        │
                                                                    │               ││  i_manager_id ││               │                                  │               │        │
                                                                    │               ││  IN (3, 15, 17││               │                                  │               │        │
                                                                    │               ││ , 26, 43, 44, ││               │                                  │               │        │
                                                                    │               ││   55, 70, 82, ││               │                                  │               │        │
                                                                    │               ││       95)     ││               │                                  │               │        │
                                                                    │               ││               ││               │                                  │               │        │
                                                                    │    365 rows   ││  102,000 rows ││    10 rows    │                                  │  250,000 rows │        │
                                                                    │    (0.00s)    ││    (0.00s)    ││    (0.00s)    │                                  │    (0.00s)    │        │
                                                                    └───────────────┘└───────────────┘└───────────────┘                                  └───────┬───────┘        │
                                                                                                                                                         ┌───────┴───────┐┌───────┴───────┐
                                                                                                                                                         │   TABLE_SCAN  ││COLUMN_DAT...  │
                                                                                                                                                         │    ────────   ││               │
                                                                                                                                                         │     Table:    ││               │
                                                                                                                                                         │customer_addres││               │
                                                                                                                                                         │       s       ││               │
                                                                                                                                                         │               ││               │
                                                                                                                                                         │     Type:     ││               │
                                                                                                                                                         │Sequential Scan││               │
                                                                                                                                                         │               ││               │
                                                                                                                                                         │  Projections: ││               │
                                                                                                                                                         │ ca_address_sk ││               │
                                                                                                                                                         │    ca_state   ││               │
                                                                                                                                                         │               ││               │
                                                                                                                                                         │    Filters:   ││               │
                                                                                                                                                         │   optional:   ││               │
                                                                                                                                                         │  ca_state IN (││               │
                                                                                                                                                         │  'IN', 'LA',  ││               │
                                                                                                                                                         │  'NE', 'NM',  ││               │
                                                                                                                                                         │     'OH')     ││               │
                                                                                                                                                         │               ││               │
                                                                                                                                                         │  250,000 rows ││     5 rows    │
                                                                                                                                                         │    (0.00s)    ││    (0.00s)    │
                                                                                                                                                         └───────────────┘└───────────────┘

