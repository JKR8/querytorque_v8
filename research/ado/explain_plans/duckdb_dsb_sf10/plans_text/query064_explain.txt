-- benchmark: dsb
-- query_id: query064
-- source_sql: research/ado/queries_dsb_sf10_duckdb/multi_block_queries/query064.sql
-- database: /mnt/d/TPC-DS/dsb_sf10.duckdb
-- statement_count: 1
-- client_elapsed_ms: 275.363
-- execution_time_ms: 0.000

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE with cs_ui as  (select cs_item_sk         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund   from catalog_sales       ,catalog_returns   where cs_item_sk = cr_item_sk     and cs_order_number = cr_order_number     and cs_wholesale_cost BETWEEN 80 AND 100    group by cs_item_sk   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)), cross_sales as  (select i_product_name product_name      ,i_item_sk item_sk      ,s_store_name store_name      ,s_zip store_zip      ,ad1.ca_street_number b_street_number      ,ad1.ca_street_name b_street_name      ,ad1.ca_city b_city      ,ad1.ca_zip b_zip      ,ad2.ca_street_number c_street_number      ,ad2.ca_street_name c_street_name      ,ad2.ca_city c_city      ,ad2.ca_zip c_zip      ,d1.d_year as syear      ,d2.d_year as fsyear      ,d3.d_year s2year      ,count(*) cnt      ,sum(ss_wholesale_cost) s1      ,sum(ss_list_price) s2      ,sum(ss_coupon_amt) s3   FROM   store_sales         ,store_returns         ,cs_ui         ,date_dim d1         ,date_dim d2         ,date_dim d3         ,store         ,customer         ,customer_demographics cd1         ,customer_demographics cd2         ,promotion         ,household_demographics hd1         ,household_demographics hd2         ,customer_address ad1         ,customer_address ad2         ,income_band ib1         ,income_band ib2         ,item   WHERE  ss_store_sk = s_store_sk AND          ss_sold_date_sk = d1.d_date_sk AND          ss_customer_sk = c_customer_sk AND          ss_cdemo_sk= cd1.cd_demo_sk AND          ss_hdemo_sk = hd1.hd_demo_sk AND          ss_addr_sk = ad1.ca_address_sk and          ss_item_sk = i_item_sk and          ss_item_sk = sr_item_sk and          ss_ticket_number = sr_ticket_number and          ss_item_sk = cs_ui.cs_item_sk and          c_current_cdemo_sk = cd2.cd_demo_sk AND          c_current_hdemo_sk = hd2.hd_demo_sk AND          c_current_addr_sk = ad2.ca_address_sk and          c_first_sales_date_sk = d2.d_date_sk and          c_first_shipto_date_sk = d3.d_date_sk and          ss_promo_sk = p_promo_sk and          hd1.hd_income_band_sk = ib1.ib_income_band_sk and          hd2.hd_income_band_sk = ib2.ib_income_band_sk and          cd1.cd_marital_status <> cd2.cd_marital_status and          i_current_price between 1 and 1 + 10          and p_channel_email = 'Y'          and p_channel_tv = 'Y'          and p_channel_radio = 'Y'          and ad2.ca_state in ('GA','IL','OH')          and ss_wholesale_cost BETWEEN 80 AND 100          and cd1.cd_marital_status in ('W', 'W', 'D')          and cd1.cd_education_status in ('College', '4 yr Degree', 'College')          and cd2.cd_marital_status in ('W', 'W', 'D')          and cd2.cd_education_status in ('College', '4 yr Degree', 'College') group by i_product_name        ,i_item_sk        ,s_store_name        ,s_zip        ,ad1.ca_street_number        ,ad1.ca_street_name        ,ad1.ca_city        ,ad1.ca_zip        ,ad2.ca_street_number        ,ad2.ca_street_name        ,ad2.ca_city        ,ad2.ca_zip        ,d1.d_year        ,d2.d_year        ,d3.d_year ) select cs1.product_name      ,cs1.store_name      ,cs1.store_zip      ,cs1.b_street_number      ,cs1.b_street_name      ,cs1.b_city      ,cs1.b_zip      ,cs1.c_street_number      ,cs1.c_street_name      ,cs1.c_city      ,cs1.c_zip      ,cs1.syear      ,cs1.cnt      ,cs1.s1 as s11      ,cs1.s2 as s21      ,cs1.s3 as s31      ,cs2.s1 as s12      ,cs2.s2 as s22      ,cs2.s3 as s32      ,cs2.syear      ,cs2.cnt from cross_sales cs1,cross_sales cs2 where cs1.item_sk=cs2.item_sk and      cs1.syear = 1999 and      cs2.syear = 1999 + 1 and      cs2.cnt <= cs1.cnt and      cs1.store_name = cs2.store_name and      cs1.store_zip = cs2.store_zip order by cs1.product_name        ,cs1.store_name        ,cs2.cnt        ,cs1.s1        ,cs2.s1
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.271s              ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│     CTE     │
│    ──────   │
│  CTE Name:  │
│ cross_sales │
│             │
│ Table Index:├─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
│      9      │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│    0 rows   │                                                                                                                                                                                                                                 
│   (0.00s)   │                                                                                                                                                                                                                                 
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                                 
│  PROJECTION │                                                                                                                                                                                                                                 
│    ──────   │                                                                                                                                                                                                                                 
│      #0     │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_inte│                                                                                                                                                                                                                                 
│ gral_bigint(│                                                                                                                                                                                                                                 
│    #1, 1)   │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_stri│                                                                                                                                                                                                                                 
│    ng(#2)   │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_stri│                                                                                                                                                                                                                                 
│    ng(#3)   │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_stri│                                                                                                                                                                                                                                 
│    ng(#4)   │                                                                                                                                                                                                                                 
│      #5     │                                                                                                                                                                                                                                 
│      #6     │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_stri│                                                                                                                                                                                                                                 
│    ng(#7)   │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_stri│                                                                                                                                                                                                                                 
│    ng(#8)   │                                                                                                                                                                                                                                 
│      #9     │                                                                                                                                                                                                                                 
│     #10     │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_stri│                                                                                                                                                                                                                                 
│   ng(#11)   │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_inte│                                                                                                                                                                                                                                 
│ gral_bigint(│                                                                                                                                                                                                                                 
│  #12, 1900) │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_inte│                                                                                                                                                                                                                                 
│ gral_bigint(│                                                                                                                                                                                                                                 
│  #13, 1900) │                                                                                                                                                                                                                                 
│__internal_de│                                                                                                                                                                                                                                 
│compress_inte│                                                                                                                                                                                                                                 
│ gral_bigint(│                                                                                                                                                                                                                                 
│  #14, 1900) │                                                                                                                                                                                                                                 
│     #15     │                                                                                                                                                                                                                                 
│     #16     │                                                                                                                                                                                                                                 
│     #17     │                                                                                                                                                                                                                                 
│     #18     │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│    0 rows   │                                                                                                                                                                                                                                 
│   (0.00s)   │                                                                                                                                                                                                                                 
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                                 
│HASH_GROUP_BY│                                                                                                                                                                                                                                 
│    ──────   │                                                                                                                                                                                                                                 
│   Groups:   │                                                                                                                                                                                                                                 
│      #0     │                                                                                                                                                                                                                                 
│      #1     │                                                                                                                                                                                                                                 
│      #2     │                                                                                                                                                                                                                                 
│      #3     │                                                                                                                                                                                                                                 
│      #4     │                                                                                                                                                                                                                                 
│      #5     │                                                                                                                                                                                                                                 
│      #6     │                                                                                                                                                                                                                                 
│      #7     │                                                                                                                                                                                                                                 
│      #8     │                                                                                                                                                                                                                                 
│      #9     │                                                                                                                                                                                                                                 
│     #10     │                                                                                                                                                                                                                                 
│     #11     │                                                                                                                                                                                                                                 
│     #12     │                                                                                                                                                                                                                                 
│     #13     │                                                                                                                                                                                                                                 
│     #14     │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│ Aggregates: │                                                                                                                                                                                                                                 
│ count_star()│                                                                                                                                                                                                                                 
│   sum(#15)  │                                                                                                                                                                                                                                 
│   sum(#16)  │                                                                                                                                                                                                                                 
│   sum(#17)  │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│    0 rows   │                                                                                                                                                                                                                                 
│   (0.00s)   │                                                                                                                                                                                                                                 
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                                 
│  PROJECTION │                                                                                                                                                                                                                                 
│    ──────   │                                                                                                                                                                                                                                 
│i_product_nam│                                                                                                                                                                                                                                 
│      e      │                                                                                                                                                                                                                                 
│  i_item_sk  │                                                                                                                                                                                                                                 
│ s_store_name│                                                                                                                                                                                                                                 
│    s_zip    │                                                                                                                                                                                                                                 
│ca_street_num│                                                                                                                                                                                                                                 
│     ber     │                                                                                                                                                                                                                                 
│ca_street_nam│                                                                                                                                                                                                                                 
│      e      │                                                                                                                                                                                                                                 
│   ca_city   │                                                                                                                                                                                                                                 
│    ca_zip   │                                                                                                                                                                                                                                 
│ca_street_num│                                                                                                                                                                                                                                 
│     ber     │                                                                                                                                                                                                                                 
│ca_street_nam│                                                                                                                                                                                                                                 
│      e      │                                                                                                                                                                                                                                 
│   ca_city   │                                                                                                                                                                                                                                 
│    ca_zip   │                                                                                                                                                                                                                                 
│    d_year   │                                                                                                                                                                                                                                 
│    d_year   │                                                                                                                                                                                                                                 
│    d_year   │                                                                                                                                                                                                                                 
│ss_wholesale_│                                                                                                                                                                                                                                 
│     cost    │                                                                                                                                                                                                                                 
│ss_list_price│                                                                                                                                                                                                                                 
│ss_coupon_amt│                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│    0 rows   │                                                                                                                                                                                                                                 
│   (0.00s)   │                                                                                                                                                                                                                                 
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                                 
│  PROJECTION │                                                                                                                                                                                                                                 
│    ──────   │                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_integr│                                                                                                                                                                                                                                 
│ al_uinteger(│                                                                                                                                                                                                                                 
│    #0, 1)   │                                                                                                                                                                                                                                 
│      #1     │                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_string│                                                                                                                                                                                                                                 
│ _ubigint(#2)│                                                                                                                                                                                                                                 
│      #3     │                                                                                                                                                                                                                                 
│      #4     │                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_string│                                                                                                                                                                                                                                 
│ _ubigint(#5)│                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_string│                                                                                                                                                                                                                                 
│_ubigint(#16)│                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_string│                                                                                                                                                                                                                                 
│_ubigint(#17)│                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_integr│                                                                                                                                                                                                                                 
│ al_utinyint(│                                                                                                                                                                                                                                 
│  #15, 1900) │                                                                                                                                                                                                                                 
│      #6     │                                                                                                                                                                                                                                 
│      #7     │                                                                                                                                                                                                                                 
│      #8     │                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_integr│                                                                                                                                                                                                                                 
│ al_utinyint(│                                                                                                                                                                                                                                 
│  #9, 1900)  │                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_integr│                                                                                                                                                                                                                                 
│ al_utinyint(│                                                                                                                                                                                                                                 
│  #10, 1900) │                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_string│                                                                                                                                                                                                                                 
│_ubigint(#11)│                                                                                                                                                                                                                                 
│     #12     │                                                                                                                                                                                                                                 
│     #13     │                                                                                                                                                                                                                                 
│__internal_co│                                                                                                                                                                                                                                 
│mpress_string│                                                                                                                                                                                                                                 
│_ubigint(#14)│                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│    0 rows   │                                                                                                                                                                                                                                 
│   (0.00s)   │                                                                                                                                                                                                                                 
└──────┬──────┘                                                                                                                                                                                                                                 
┌──────┴──────┐                                                                                                                                                                                                                                 
│  HASH_JOIN  │                                                                                                                                                                                                                                 
│    ──────   │                                                                                                                                                                                                                                 
│  Join Type: │                                                                                                                                                                                                                                 
│    INNER    │                                                                                                                                                                                                                                 
│             │                                                                                                                                                                                                                                 
│ Conditions: │                                                                                                                                                                                                                                 
│ sr_item_sk =│                                                                                                                                                                                                                                 
│  ss_item_sk ├────────────────────────────────────────────────────┐                                                                                                                                                                            
│sr_ticket_num│                                                    │                                                                                                                                                                            
│ber = ss_tick│                                                    │                                                                                                                                                                            
│  et_number  │                                                    │                                                                                                                                                                            
│             │                                                    │                                                                                                                                                                            
│    0 rows   │                                                    │                                                                                                                                                                            
│   (0.00s)   │                                                    │                                                                                                                                                                            
└──────┬──────┘                                                    │                                                                                                                                                                            
┌──────┴──────┐                                             ┌──────┴──────┐                                                                                                                                                                     
│  HASH_JOIN  │                                             │  HASH_JOIN  │                                                                                                                                                                     
│    ──────   │                                             │    ──────   │                                                                                                                                                                     
│  Join Type: │                                             │  Join Type: │                                                                                                                                                                     
│    INNER    │                                             │    INNER    │                                                                                                                                                                     
│             │                                             │             │                                                                                                                                                                     
│ Conditions: ├───────┐                                     │ Conditions: ├──────────────────────┐                                                                                                                                              
│ sr_item_sk =│       │                                     │ hd_demo_sk =│                      │                                                                                                                                              
│   i_item_sk │       │                                     │  ss_hdemo_sk│                      │                                                                                                                                              
│             │       │                                     │             │                      │                                                                                                                                              
│ 16,652 rows │       │                                     │    0 rows   │                      │                                                                                                                                              
│   (0.01s)   │       │                                     │   (0.00s)   │                      │                                                                                                                                              
└──────┬──────┘       │                                     └──────┬──────┘                      │                                                                                                                                              
┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐               ┌──────┴──────┐
│  TABLE_SCAN ││  HASH_JOIN  │                              │  HASH_JOIN  │               │  HASH_JOIN  │
│    ──────   ││    ──────   │                              │    ──────   │               │    ──────   │
│    Table:   ││  Join Type: │                              │  Join Type: │               │  Join Type: │
│store_returns││    INNER    │                              │    INNER    │               │    INNER    │
│             ││             │                              │             │               │             │
│    Type:    ││ Conditions: │                              │ Conditions: │               │ Conditions: │
│  Sequential ││ cs_item_sk =│                              │hd_income_ban│               │ca_address_sk│
│     Scan    ││   i_item_sk │                              │d_sk = ib_inc│               │ = ss_addr_sk│
│             ││             ├──────────────────────┐       │ ome_band_sk ├───────┐       │             ├───────┐
│ Projections:││             │                      │       │             │       │       │             │       │
│  sr_item_sk ││             │                      │       │             │       │       │             │       │
│sr_ticket_num││             │                      │       │             │       │       │             │       │
│     ber     ││             │                      │       │             │       │       │             │       │
│             ││             │                      │       │             │       │       │             │       │
│ 24,576 rows ││ 64,770 rows │                      │       │  2,048 rows │       │       │    0 rows   │       │
│   (0.00s)   ││   (0.00s)   │                      │       │   (0.00s)   │       │       │   (0.00s)   │       │
└─────────────┘└──────┬──────┘                      │       └──────┬──────┘       │       └──────┬──────┘       │
               ┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
               │  PROJECTION │               │  TABLE_SCAN ││  TABLE_SCAN ││  TABLE_SCAN ││  TABLE_SCAN ││  HASH_JOIN  │
               │    ──────   │               │    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   │
               │      #0     │               │    Table:   ││    Table:   ││    Table:   ││    Table:   ││  Join Type: │
               │             │               │     item    ││household_dem││ income_band ││customer_addr││    INNER    │
               │             │               │             ││  ographics  ││             ││     ess     ││             │
               │             │               │    Type:    ││             ││    Type:    ││             ││ Conditions: │
               │             │               │  Sequential ││    Type:    ││  Sequential ││    Type:    ││ ss_store_sk │
               │             │               │     Scan    ││  Sequential ││     Scan    ││  Sequential ││ = s_store_sk│
               │             │               │             ││     Scan    ││             ││     Scan    ││             │
               │             │               │ Projections:││             ││ Projections:││             ││             │
               │             │               │  i_item_sk  ││ Projections:││ib_income_ban││ Projections:││             │
               │             │               │i_product_nam││  hd_demo_sk ││     d_sk    ││ca_address_sk││             ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
               │             │               │      e      ││hd_income_ban││             ││ca_street_num││             │                                                                                                                        
               │             │               │             ││     d_sk    ││             ││     ber     ││             │                                                                                                                        
               │             │               │   Filters:  ││             ││             ││ca_street_nam││             │                                                                                                                        
               │             │               │i_current_pri││             ││             ││      e      ││             │                                                                                                                        
               │             │               │ ce>=1.00 AND││             ││             ││   ca_city   ││             │                                                                                                                        
               │             │               │ i_current_pr││             ││             ││    ca_zip   ││             │                                                                                                                        
               │             │               │  ice<=11.00 ││             ││             ││             ││             │                                                                                                                        
               │             │               │             ││             ││             ││             ││             │                                                                                                                        
               │ 82,208 rows │               │ 80,337 rows ││  2,048 rows ││   20 rows   ││  6,144 rows ││    0 rows   │                                                                                                                        
               │   (0.00s)   │               │   (0.01s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   ││   (0.00s)   │                                                                                                                        
               └──────┬──────┘               └─────────────┘└─────────────┘└─────────────┘└─────────────┘└──────┬──────┘                                                                                                                        
               ┌──────┴──────┐                                                                           ┌──────┴──────┐                                                                                                                        
               │    FILTER   │                                                                           │  HASH_JOIN  │                                                                                                                        
               │    ──────   │                                                                           │    ──────   │                                                                                                                        
               │(sum(cs_ext_l│                                                                           │  Join Type: │                                                                                                                        
               │ ist_price) >│                                                                           │    INNER    │                                                                                                                        
               │  (2 * sum(( │                                                                           │             │                                                                                                                        
               │(cr_refunded_│                                                                           │ Conditions: │                                                                                                                        
               │cash + cr_rev│                                                                           │ss_sold_date_│                                                                                                                        
               │ ersed_charge│                                                                           │sk = d_date_s│                                                                                                                        
               │) + cr_store_│                                                                           │      k      │                                                                                                                        
               │  credit)))) │                                                                           │             │                                                                                                                        
               │             │                                                                           │             ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
               │             │                                                                           │             │                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │ 82,208 rows │                                                                           │    0 rows   │                                                                                                                        
               │   (0.00s)   │                                                                           │   (0.00s)   │                                                                                                                        
               └──────┬──────┘                                                                           └──────┬──────┘                                                                                                                        
               ┌──────┴──────┐                                                                           ┌──────┴──────┐                                                                                                                        
               │  PROJECTION │                                                                           │  HASH_JOIN  │                                                                                                                        
               │    ──────   │                                                                           │    ──────   │                                                                                                                        
               │__internal_de│                                                                           │  Join Type: │                                                                                                                        
               │compress_inte│                                                                           │    INNER    │                                                                                                                        
               │ gral_bigint(│                                                                           │             │                                                                                                                        
               │    #0, 1)   │                                                                           │ Conditions: │                                                                                                                        
               │      #1     │                                                                           │ ss_promo_sk ├────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
               │      #2     │                                                                           │ = p_promo_sk│                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │ 90,683 rows │                                                                           │    0 rows   │                                                                                                                        
               │   (0.00s)   │                                                                           │   (0.00s)   │                                                                                                                        
               └──────┬──────┘                                                                           └──────┬──────┘                                                                                                                        
               ┌──────┴──────┐                                                                           ┌──────┴──────┐                                                                                                                        
               │HASH_GROUP_BY│                                                                           │  HASH_JOIN  │                                                                                                                        
               │    ──────   │                                                                           │    ──────   │                                                                                                                        
               │   Groups:   │                                                                           │  Join Type: │                                                                                                                        
               │      #0     │                                                                           │    INNER    │                                                                                                                        
               │             │                                                                           │             │                                                                                                                        
               │ Aggregates: │                                                                           │ Conditions: │                                                                                                                        
               │   sum(#1)   │                                                                           │ ss_cdemo_sk │                                                                                                                        
               │   sum(#2)   │                                                                           │ = cd_demo_sk│                                                                                                                        
               │             │                                                                           │cd_marital_st│                                                                                                                        
               │             │                                                                           │atus != cd_ma│                                                                                                                        
               │             │                                                                           │ rital_status├────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐       
               │             │                                                                           │             │                                                                                                                │       
               │             │                                                                           │             │                                                                                                                │       
               │             │                                                                           │             │                                                                                                                │       
               │             │                                                                           │             │                                                                                                                │       
               │             │                                                                           │             │                                                                                                                │       
               │             │                                                                           │             │                                                                                                                │       
               │             │                                                                           │             │                                                                                                                │       
               │             │                                                                           │             │                                                                                                                │       
               │ 90,683 rows │                                                                           │  1,279 rows │                                                                                                                │       
               │   (0.07s)   │                                                                           │   (0.02s)   │                                                                                                                │       
               └──────┬──────┘                                                                           └──────┬──────┘                                                                                                                │       
               ┌──────┴──────┐                                                                           ┌──────┴──────┐                                                                                                         ┌──────┴──────┐
               │  PROJECTION │                                                                           │  HASH_JOIN  │                                                                                                         │  PROJECTION │
               │    ──────   │                                                                           │    ──────   │                                                                                                         │    ──────   │
               │  cs_item_sk │                                                                           │  Join Type: │                                                                                                         │      #0     │
               │cs_ext_list_p│                                                                           │    INNER    │                                                                                                         │      #1     │
               │     rice    │                                                                           │             │                                                                                                         │             │
               │((cr_refunded│                                                                           │ Conditions: │                                                                                                         │             │
               │_cash + cr_re│                                                                           │ss_customer_s├───────┐                                                                                                 │             │
               │versed_charge│                                                                           │k = c_custome│       │                                                                                                 │             │
               │) + cr_store_│                                                                           │     r_sk    │       │                                                                                                 │             │
               │   credit)   │                                                                           │             │       │                                                                                                 │             │
               │             │                                                                           │             │       │                                                                                                 │             │
               │ 290,333 rows│                                                                           │ 21,840 rows │       │                                                                                                 │ 219,520 rows│
               │   (0.00s)   │                                                                           │   (0.12s)   │       │                                                                                                 │   (0.00s)   │
               └──────┬──────┘                                                                           └──────┬──────┘       │                                                                                                 └──────┬──────┘
               ┌──────┴──────┐                                                                           ┌──────┴──────┐┌──────┴──────┐                                                                                          ┌──────┴──────┐
               │  PROJECTION │                                                                           │    FILTER   ││  HASH_JOIN  │                                                                                          │    FILTER   │
               │    ──────   │                                                                           │    ──────   ││    ──────   │                                                                                          │    ──────   │
               │__internal_co│                                                                           │(ss_ticket_nu││  Join Type: │                                                                                          │(((cd_marital│
               │mpress_integr│                                                                           │mber <= 23999││    INNER    │                                                                                          │ _status = 'W│
               │ al_uinteger(│                                                                           │     99)     ││             │                                                                                          │') OR (cd_mar│
               │    #0, 1)   │                                                                           │             ││ Conditions: │                                                                                          │ ital_status │
               │      #1     │                                                                           │             ││c_current_hde│                                                                                          │  = 'W') OR  │
               │      #2     │                                                                           │             ││mo_sk = hd_de│                                                                                          │(cd_marital_s│
               │      #3     │                                                                           │             ││    mo_sk    │                                                                                          │ tatus = 'D')│
               │      #4     │                                                                           │             ││             │                                                                                          │) AND ((cd_ed│
               │             │                                                                           │             ││             │                                                                                          │ucation_statu│
               │             │                                                                           │             ││             ├───────────────────────────────────────────────────────────────────┐                      │ s = 'College│
               │             │                                                                           │             ││             │                                                                   │                      │') OR (cd_edu│
               │             │                                                                           │             ││             │                                                                   │                      │cation_status│
               │             │                                                                           │             ││             │                                                                   │                      │    = '4 yr  │
               │             │                                                                           │             ││             │                                                                   │                      │  Degree') OR│
               │             │                                                                           │             ││             │                                                                   │                      │ (cd_educatio│
               │             │                                                                           │             ││             │                                                                   │                      │ n_status =  │
               │             │                                                                           │             ││             │                                                                   │                      │ 'College')))│
               │             │                                                                           │             ││             │                                                                   │                      │             │
               │ 290,333 rows│                                                                           │1,876,07...  ││  5,798 rows │                                                                   │                      │ 219,520 rows│
               │   (0.00s)   │                                                                           │   (0.02s)   ││   (0.00s)   │                                                                   │                      │   (0.04s)   │
               └──────┬──────┘                                                                           └──────┬──────┘└──────┬──────┘                                                                   │                      └──────┬──────┘
               ┌──────┴──────┐                                                                           ┌──────┴──────┐┌──────┴──────┐                                                            ┌──────┴──────┐               ┌──────┴──────┐
               │  HASH_JOIN  │                                                                           │  TABLE_SCAN ││  HASH_JOIN  │                                                            │  HASH_JOIN  │               │  TABLE_SCAN │
               │    ──────   │                                                                           │    ──────   ││    ──────   │                                                            │    ──────   │               │    ──────   │
               │  Join Type: │                                                                           │    Table:   ││  Join Type: │                                                            │  Join Type: │               │    Table:   │
               │    INNER    │                                                                           │ store_sales ││    INNER    │                                                            │    INNER    │               │customer_demo│
               │             │                                                                           │             ││             │                                                            │             │               │   graphics  │
               │ Conditions: │                                                                           │    Type:    ││ Conditions: │                                                            │ Conditions: │               │             │
               │ cs_item_sk =│                                                                           │  Sequential ││ d_date_sk = │                                                            │hd_income_ban│               │    Type:    │
               │  cr_item_sk │                                                                           │     Scan    ││ c_first_ship│                                                            │d_sk = ib_inc│               │  Sequential │
               │cs_order_numb│                                                                           │             ││  to_date_sk │                                                            │ ome_band_sk │               │     Scan    │
               │er = cr_order│                                                                           │ Projections:││             │                                                            │             │               │             │
               │   _number   │                                                                           │ ss_store_sk ││             │                                                            │             │               │ Projections:│
               │             │                                                                           │ss_sold_date_││             │                                                            │             │               │  cd_demo_sk │
               │             │                                                                           │      sk     ││             │                                                            │             │               │cd_marital_st│
               │             │                                                                           │ss_customer_s││             │                                                            │             │               │     atus    │
               │             │                                                                           │      k      ││             │                                                            │             │               │cd_education_│
               │             │                                                                           │ ss_cdemo_sk ││             │                                                            │             │               │    status   │
               │             │                                                                           │ ss_hdemo_sk ││             │                                                            │             │               │             │
               │             │                                                                           │  ss_addr_sk ││             │                                                            │             │               │   Filters:  │
               │             ├───────┐                                                                   │  ss_item_sk ││             ├───────┐                                                    │             ├───────┐       │  optional:  │
               │             │       │                                                                   │ss_ticket_num││             │       │                                                    │             │       │       │ cd_marital_s│
               │             │       │                                                                   │     ber     ││             │       │                                                    │             │       │       │ tatus IN ('W│
               │             │       │                                                                   │ ss_promo_sk ││             │       │                                                    │             │       │       │ ', 'W', 'D')│
               │             │       │                                                                   │ss_wholesale_││             │       │                                                    │             │       │       │  optional:  │
               │             │       │                                                                   │     cost    ││             │       │                                                    │             │       │       │ cd_education│
               │             │       │                                                                   │ss_list_price││             │       │                                                    │             │       │       │ _status IN (│
               │             │       │                                                                   │ss_coupon_amt││             │       │                                                    │             │       │       │ 'College',  │
               │             │       │                                                                   │             ││             │       │                                                    │             │       │       │ '4 yr Degree│
               │             │       │                                                                   │   Filters:  ││             │       │                                                    │             │       │       │', 'College')│
               │             │       │                                                                   │ss_wholesale_││             │       │                                                    │             │       │       │             │
               │             │       │                                                                   │ cost>=80.00 ││             │       │                                                    │             │       │       │             │
               │             │       │                                                                   │ AND ss_whole││             │       │                                                    │             │       │       │             │
               │             │       │                                                                   │  sale_cost< ││             │       │                                                    │             │       │       │             │
               │             │       │                                                                   │   =100.00   ││             │       │                                                    │             │       │       │             │
               │             │       │                                                                   │             ││             │       │                                                    │             │       │       │             │
               │ 290,333 rows│       │                                                                   │1,876,07...  ││  5,827 rows │       │                                                    │  7,200 rows │       │       │1,920,80...  │
               │   (0.34s)   │       │                                                                   │   (0.61s)   ││   (0.00s)   │       │                                                    │   (0.00s)   │       │       │   (0.00s)   │
               └──────┬──────┘       │                                                                   └─────────────┘└──────┬──────┘       │                                                    └──────┬──────┘       │       └─────────────┘
               ┌──────┴──────┐┌──────┴──────┐                                                                           ┌──────┴──────┐┌──────┴──────┐                                             ┌──────┴──────┐┌──────┴──────┐
               │    FILTER   ││  TABLE_SCAN │                                                                           │  TABLE_SCAN ││  HASH_JOIN  │                                             │  TABLE_SCAN ││  TABLE_SCAN │
               │    ──────   ││    ──────   │                                                                           │    ──────   ││    ──────   │                                             │    ──────   ││    ──────   │
               │(cs_order_num││    Table:   │                                                                           │    Table:   ││  Join Type: │                                             │    Table:   ││    Table:   │
               │  ber >= 2)  ││catalog_retur│                                                                           │   date_dim  ││    INNER    │                                             │household_dem││ income_band │
               │             ││      ns     │                                                                           │             ││             │                                             │  ographics  ││             │
               │             ││             │                                                                           │    Type:    ││ Conditions: │                                             │             ││    Type:    │
               │             ││    Type:    │                                                                           │  Sequential ││ d_date_sk = │                                             │    Type:    ││  Sequential │
               │             ││  Sequential │                                                                           │     Scan    ││ c_first_sale│                                             │  Sequential ││     Scan    │
               │             ││     Scan    │                                                                           │             ││  s_date_sk  │                                             │     Scan    ││             │
               │             ││             │                                                                           │ Projections:││             │                                             │             ││ Projections:│
               │             ││ Projections:│                                                                           │  d_date_sk  ││             │                                             │ Projections:││ib_income_ban│
               │             ││  cr_item_sk │                                                                           │    d_year   ││             ├───────┐                                     │  hd_demo_sk ││     d_sk    │
               │             ││cr_order_numb│                                                                           │             ││             │       │                                     │hd_income_ban││             │
               │             ││      er     │                                                                           │   Filters:  ││             │       │                                     │     d_sk    ││             │
               │             ││cr_refunded_c│                                                                           │  d_date_sk> ││             │       │                                     │             ││             │
               │             ││     ash     │                                                                           │ =2449028 AND││             │       │                                     │             ││             │
               │             ││cr_reversed_c│                                                                           │  d_date_sk< ││             │       │                                     │             ││             │
               │             ││    harge    │                                                                           │   =2452678  ││             │       │                                     │             ││             │
               │             ││cr_store_cred│                                                                           │             ││             │       │                                     │             ││             │
               │             ││      it     │                                                                           │             ││             │       │                                     │             ││             │
               │             ││             │                                                                           │             ││             │       │                                     │             ││             │
               │2,897,18...  ││1,441,22...  │                                                                           │  3,651 rows ││  5,888 rows │       │                                     │  7,200 rows ││   20 rows   │
               │   (0.01s)   ││   (0.09s)   │                                                                           │   (0.00s)   ││   (0.01s)   │       │                                     │   (0.00s)   ││   (0.00s)   │
               └──────┬──────┘└─────────────┘                                                                           └─────────────┘└──────┬──────┘       │                                     └─────────────┘└─────────────┘
               ┌──────┴──────┐                                                                                                         ┌──────┴──────┐┌──────┴──────┐
               │  TABLE_SCAN │                                                                                                         │  TABLE_SCAN ││  HASH_JOIN  │
               │    ──────   │                                                                                                         │    ──────   ││    ──────   │
               │    Table:   │                                                                                                         │    Table:   ││  Join Type: │
               │catalog_sales│                                                                                                         │   date_dim  ││    INNER    │
               │             │                                                                                                         │             ││             │
               │    Type:    │                                                                                                         │    Type:    ││ Conditions: │
               │  Sequential │                                                                                                         │  Sequential ││ cd_demo_sk =│
               │     Scan    │                                                                                                         │     Scan    ││ c_current_cd│
               │             │                                                                                                         │             ││    emo_sk   │
               │ Projections:│                                                                                                         │ Projections:││             │
               │  cs_item_sk │                                                                                                         │  d_date_sk  ││             │
               │cs_order_numb│                                                                                                         │    d_year   ││             │
               │      er     │                                                                                                         │             ││             ├───────┐
               │cs_ext_list_p│                                                                                                         │   Filters:  ││             │       │
               │     rice    │                                                                                                         │  d_date_sk> ││             │       │
               │             │                                                                                                         │ =2448998 AND││             │       │
               │   Filters:  │                                                                                                         │  d_date_sk< ││             │       │
               │cs_wholesale_│                                                                                                         │   =2452648  ││             │       │
               │ cost>=80.00 │                                                                                                         │             ││             │       │
               │ AND cs_whole│                                                                                                         │             ││             │       │
               │  sale_cost< │                                                                                                         │             ││             │       │
               │   =100.00   │                                                                                                         │             ││             │       │
               │             │                                                                                                         │             ││             │       │
               │2,897,18...  │                                                                                                         │  3,651 rows ││  5,997 rows │       │
               │   (1.13s)   │                                                                                                         │   (0.00s)   ││   (0.04s)   │       │
               └─────────────┘                                                                                                         └─────────────┘└──────┬──────┘       │
                                                                                                                                                      ┌──────┴──────┐┌──────┴──────┐
                                                                                                                                                      │    FILTER   ││  HASH_JOIN  │
                                                                                                                                                      │    ──────   ││    ──────   │
                                                                                                                                                      │ (cd_demo_sk ││  Join Type: │
                                                                                                                                                      │   BETWEEN 4 ││    INNER    │
                                                                                                                                                      │ AND 1920791)││             │
                                                                                                                                                      │             ││ Conditions: │
                                                                                                                                                      │             ││c_current_add├───────┐
                                                                                                                                                      │             ││r_sk = ca_add│       │
                                                                                                                                                      │             ││   ress_sk   │       │
                                                                                                                                                      │             ││             │       │
                                                                                                                                                      │ 219,520 rows││ 53,816 rows │       │
                                                                                                                                                      │   (0.00s)   ││   (0.01s)   │       │
                                                                                                                                                      └──────┬──────┘└──────┬──────┘       │
                                                                                                                                                      ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐
                                                                                                                                                      │  PROJECTION ││  TABLE_SCAN ││  PROJECTION │
                                                                                                                                                      │    ──────   ││    ──────   ││    ──────   │
                                                                                                                                                      │      #0     ││    Table:   ││      #0     │
                                                                                                                                                      │      #1     ││   customer  ││      #2     │
                                                                                                                                                      │             ││             ││      #3     │
                                                                                                                                                      │             ││    Type:    ││      #4     │
                                                                                                                                                      │             ││  Sequential ││      #5     │
                                                                                                                                                      │             ││     Scan    ││             │
                                                                                                                                                      │             ││             ││             │
                                                                                                                                                      │             ││ Projections:││             │
                                                                                                                                                      │             ││c_customer_sk││             │
                                                                                                                                                      │             ││c_current_cde││             │
                                                                                                                                                      │             ││    mo_sk    ││             │
                                                                                                                                                      │             ││c_current_hde││             │
                                                                                                                                                      │             ││    mo_sk    ││             │
                                                                                                                                                      │             ││c_current_add││             │
                                                                                                                                                      │             ││     r_sk    ││             │
                                                                                                                                                      │             ││c_first_sales││             │
                                                                                                                                                      │             ││   _date_sk  ││             │
                                                                                                                                                      │             ││c_first_shipt││             │
                                                                                                                                                      │             ││  o_date_sk  ││             │
                                                                                                                                                      │             ││             ││             │
                                                                                                                                                      │ 219,520 rows││ 499,970 rows││ 26,831 rows │
                                                                                                                                                      │   (0.00s)   ││   (0.03s)   ││   (0.00s)   │
                                                                                                                                                      └──────┬──────┘└─────────────┘└──────┬──────┘
                                                                                                                                                      ┌──────┴──────┐               ┌──────┴──────┐
                                                                                                                                                      │    FILTER   │               │    FILTER   │
                                                                                                                                                      │    ──────   │               │    ──────   │
                                                                                                                                                      │(((cd_marital│               │ ((ca_state =│
                                                                                                                                                      │ _status = 'W│               │   'GA') OR  │
                                                                                                                                                      │') OR (cd_mar│               │ (ca_state = │
                                                                                                                                                      │ ital_status │               │  'IL') OR   │
                                                                                                                                                      │  = 'W') OR  │               │ (ca_state = │
                                                                                                                                                      │(cd_marital_s│               │    'OH'))   │
                                                                                                                                                      │ tatus = 'D')│               │             │
                                                                                                                                                      │) AND ((cd_ed│               │             │
                                                                                                                                                      │ucation_statu│               │             │
                                                                                                                                                      │ s = 'College│               │             │
                                                                                                                                                      │') OR (cd_edu│               │             │
                                                                                                                                                      │cation_status│               │             │
                                                                                                                                                      │    = '4 yr  │               │             │
                                                                                                                                                      │  Degree') OR│               │             │
                                                                                                                                                      │ (cd_educatio│               │             │
                                                                                                                                                      │ n_status =  │               │             │
                                                                                                                                                      │ 'College')))│               │             │
                                                                                                                                                      │             │               │             │
                                                                                                                                                      │ 219,520 rows│               │ 26,831 rows │
                                                                                                                                                      │   (0.04s)   │               │   (0.00s)   │
                                                                                                                                                      └──────┬──────┘               └──────┬──────┘
                                                                                                                                                      ┌──────┴──────┐               ┌──────┴──────┐
                                                                                                                                                      │  TABLE_SCAN │               │  TABLE_SCAN │
                                                                                                                                                      │    ──────   │               │    ──────   │
                                                                                                                                                      │    Table:   │               │    Table:   │
                                                                                                                                                      │customer_demo│               │customer_addr│
                                                                                                                                                      │   graphics  │               │     ess     │
                                                                                                                                                      │             │               │             │
                                                                                                                                                      │    Type:    │               │    Type:    │
                                                                                                                                                      │  Sequential │               │  Sequential │
                                                                                                                                                      │     Scan    │               │     Scan    │
                                                                                                                                                      │             │               │             │
                                                                                                                                                      │ Projections:│               │ Projections:│
                                                                                                                                                      │  cd_demo_sk │               │ca_address_sk│
                                                                                                                                                      │cd_marital_st│               │   ca_state  │
                                                                                                                                                      │     atus    │               │ca_street_num│
                                                                                                                                                      │cd_education_│               │     ber     │
                                                                                                                                                      │    status   │               │ca_street_nam│
                                                                                                                                                      │             │               │      e      │
                                                                                                                                                      │   Filters:  │               │   ca_city   │
                                                                                                                                                      │  optional:  │               │    ca_zip   │
                                                                                                                                                      │ cd_marital_s│               │             │
                                                                                                                                                      │ tatus IN ('W│               │   Filters:  │
                                                                                                                                                      │ ', 'W', 'D')│               │  optional:  │
                                                                                                                                                      │  optional:  │               │  ca_state IN│
                                                                                                                                                      │ cd_education│               │  ('GA', 'IL'│
                                                                                                                                                      │ _status IN (│               │   , 'OH')   │
                                                                                                                                                      │ 'College',  │               │             │
                                                                                                                                                      │ '4 yr Degree│               │             │
                                                                                                                                                      │', 'College')│               │             │
                                                                                                                                                      │             │               │             │
                                                                                                                                                      │1,920,78...  │               │ 250,000 rows│
                                                                                                                                                      │   (0.01s)   │               │   (0.02s)   │
                                                                                                                                                      └─────────────┘               └─────────────┘

