```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_date_customers": "SELECT d_date_sk FROM date_dim WHERE d_moy = 5 AND d_year = 1998",
        "filtered_item": "SELECT i_item_sk FROM item WHERE i_category = 'Women' AND i_class = 'maternity'",
        "filtered_catalog_sales": "SELECT cs_sold_date_sk, cs_bill_customer_sk, cs_item_sk FROM catalog_sales",
        "filtered_web_sales": "SELECT ws_sold_date_sk, ws_bill_customer_sk, ws_item_sk FROM web_sales",
        "cs_qualified": "SELECT DISTINCT cs_bill_customer_sk AS customer_sk, c_current_addr_sk FROM filtered_catalog_sales JOIN filtered_date_customers ON cs_sold_date_sk = d_date_sk JOIN filtered_item ON cs_item_sk = i_item_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk",
        "ws_qualified": "SELECT DISTINCT ws_bill_customer_sk AS customer_sk, c_current_addr_sk FROM filtered_web_sales JOIN filtered_date_customers ON ws_sold_date_sk = d_date_sk JOIN filtered_item ON ws_item_sk = i_item_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk",
        "my_customers": "SELECT * FROM cs_qualified UNION ALL SELECT * FROM ws_qualified",
        "base_month": "SELECT DISTINCT d_month_seq FROM date_dim WHERE d_year = 1998 AND d_moy = 5",
        "date_range": "SELECT d_date_sk FROM date_dim CROSS JOIN base_month WHERE d_month_seq BETWEEN base_month.d_month_seq + 1 AND base_month.d_month_seq + 3",
        "filtered_store_sales": "SELECT ss_customer_sk, ss_ext_sales_price FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk",
        "my_revenue": "SELECT mc.c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers mc JOIN filtered_store_sales fss ON mc.c_customer_sk = fss.ss_customer_sk JOIN customer_address ca ON mc.c_current_addr_sk = ca.ca_address_sk JOIN store s ON ca.ca_county = s.s_county AND ca.ca_state = s.s_state GROUP BY mc.c_customer_sk",
        "segments": "SELECT CAST((revenue / 50) AS INT) AS segment FROM my_revenue"
      },
      "invariants_kept": [
        "same output columns for all CTEs",
        "same grain for my_revenue",
        "same grouping and aggregation",
        "same distinct semantics in my_customers"
      ],
      "expected_speedup": "3.5x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filters into separate CTEs to avoid repeated subqueries and full table scans. For my_customers: created filtered_date_customers and filtered_item CTEs, then pushed them into UNION ALL branches, eliminating the correlated date_dim scan. For my_revenue: created base_month CTE to compute the month_seq range once, then joined store_sales via date_range CTE. This reduces 4 sequential scans of date_dim to 2 CTE scans and enables early filtering of sales data."
}
```