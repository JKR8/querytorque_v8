```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "filtered_store": "SELECT s_store_sk FROM store WHERE s_county IN ('Ziebach County', 'Daviess County', 'Walker County', 'Richland County', 'Barrow County', 'Franklin Parish', 'Williamson County', 'Luce County')",
        "filtered_dates_dom1_3": "SELECT d_date_sk FROM date_dim WHERE d_year IN (1998, 1999, 2000) AND d_dom BETWEEN 1 AND 3",
        "filtered_dates_dom25_28": "SELECT d_date_sk FROM date_dim WHERE d_year IN (1998, 1999, 2000) AND d_dom BETWEEN 25 AND 28",
        "filtered_hd_1001_5000": "SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '1001-5000' AND hd_vehicle_count > 0 AND (hd_dep_count / hd_vehicle_count) > 1.2",
        "filtered_hd_0_500": "SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '0-500' AND hd_vehicle_count > 0 AND (hd_dep_count / hd_vehicle_count) > 1.2",
        "dn_union": "SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_store ON store_sales.ss_store_sk = filtered_store.s_store_sk JOIN filtered_dates_dom1_3 ON store_sales.ss_sold_date_sk = filtered_dates_dom1_3.d_date_sk JOIN filtered_hd_1001_5000 ON store_sales.ss_hdemo_sk = filtered_hd_1001_5000.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_store ON store_sales.ss_store_sk = filtered_store.s_store_sk JOIN filtered_dates_dom1_3 ON store_sales.ss_sold_date_sk = filtered_dates_dom1_3.d_date_sk JOIN filtered_hd_0_500 ON store_sales.ss_hdemo_sk = filtered_hd_0_500.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_store ON store_sales.ss_store_sk = filtered_store.s_store_sk JOIN filtered_dates_dom25_28 ON store_sales.ss_sold_date_sk = filtered_dates_dom25_28.d_date_sk JOIN filtered_hd_1001_5000 ON store_sales.ss_hdemo_sk = filtered_hd_1001_5000.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales JOIN filtered_store ON store_sales.ss_store_sk = filtered_store.s_store_sk JOIN filtered_dates_dom25_28 ON store_sales.ss_sold_date_sk = filtered_dates_dom25_28.d_date_sk JOIN filtered_hd_0_500 ON store_sales.ss_hdemo_sk = filtered_hd_0_500.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk",
        "dn_aggregated": "SELECT ss_ticket_number, ss_customer_sk, SUM(cnt) AS cnt FROM dn_union GROUP BY ss_ticket_number, ss_customer_sk HAVING SUM(cnt) BETWEEN 15 AND 20",
        "main_query": "SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, dn_aggregated.ss_ticket_number, dn_aggregated.cnt FROM dn_aggregated JOIN customer ON dn_aggregated.ss_customer_sk = customer.c_customer_sk ORDER BY c_last_name, c_first_name, c_salutation, c_preferred_cust_flag DESC, dn_aggregated.ss_ticket_number"
      },
      "invariants_kept": [
        "output columns unchanged",
        "same grouping grain (ss_ticket_number, ss_customer_sk)",
        "same result rows",
        "same ordering",
        "same HAVING filter (cnt BETWEEN 15 AND 20)"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Transformed OR conditions into UNION ALL with four branches (2 date ranges Ã— 2 hd_buy_potential values). Each branch uses focused CTEs for filtered dimensions, allowing better pushdown and parallelization. The final aggregation combines counts from all branches and applies the HAVING filter. This avoids scanning store_sales multiple times with mixed OR predicates."
}
```