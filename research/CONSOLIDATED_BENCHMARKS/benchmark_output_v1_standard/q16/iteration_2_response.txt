```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "materialize_cte",
      "nodes": {
        "date_range": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-4-01' AND (CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY)",
        "multi_warehouse_orders": "SELECT cs_order_number FROM catalog_sales GROUP BY cs_order_number HAVING COUNT(DISTINCT cs_warehouse_sk) > 1",
        "non_returned_orders": "SELECT cr_order_number FROM catalog_returns",
        "main_query": "SELECT COUNT(DISTINCT cs1.cs_order_number) AS \"order count\", SUM(cs1.cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs1.cs_net_profit) AS \"total net profit\" FROM catalog_sales cs1 JOIN date_range dr ON cs1.cs_ship_date_sk = dr.d_date_sk JOIN customer_address ON cs1.cs_ship_addr_sk = ca_address_sk JOIN call_center ON cs1.cs_call_center_sk = cc_call_center_sk JOIN multi_warehouse_orders mwo ON cs1.cs_order_number = mwo.cs_order_number LEFT JOIN non_returned_orders nro ON cs1.cs_order_number = nro.cr_order_number WHERE ca_state = 'WV' AND cc_county IN ('Ziebach County', 'Luce County', 'Richland County', 'Daviess County', 'Barrow County') AND nro.cr_order_number IS NULL ORDER BY COUNT(DISTINCT cs1.cs_order_number) LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation"
      ],
      "expected_speedup": "2.0x",
      "risk": "low"
    }
  ],
  "explanation": "Materialized three CTEs: 1) date_range to isolate date filter and reduce date_dim scan early, 2) multi_warehouse_orders to compute orders with multiple warehouses once instead of correlated EXISTS, 3) non_returned_orders to get returned orders for anti-join. Main query now uses efficient JOINs instead of correlated subqueries, allowing better join ordering and predicate pushdown."
}
```