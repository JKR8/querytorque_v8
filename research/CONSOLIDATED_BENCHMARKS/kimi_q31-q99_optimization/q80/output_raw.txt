 ```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "early_filter",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1998-08-28' AS DATE) AND (CAST('1998-08-28' AS DATE) + INTERVAL '30' DAY)",
        "filtered_items": "SELECT i_item_sk FROM item WHERE i_current_price > 50",
        "filtered_promos": "SELECT p_promo_sk FROM promotion WHERE p_channel_tv = 'N'",
        "ssr": "SELECT s.s_store_id AS store_id, SUM(ss.ss_ext_sales_price) AS sales, SUM(COALESCE(sr.sr_return_amt, 0)) AS \"returns\", SUM(ss.ss_net_profit - COALESCE(sr.sr_net_loss, 0)) AS profit FROM store_sales ss LEFT OUTER JOIN store_returns sr ON ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk JOIN filtered_items fi ON ss.ss_item_sk = fi.i_item_sk JOIN filtered_promos fp ON ss.ss_promo_sk = fp.p_promo_sk GROUP BY s.s_store_id",
        "csr": "SELECT cp.cp_catalog_page_id AS catalog_page_id, SUM(cs.cs_ext_sales_price) AS sales, SUM(COALESCE(cr.cr_return_amount, 0)) AS \"returns\", SUM(cs.cs_net_profit - COALESCE(cr.cr_net_loss, 0)) AS profit FROM catalog_sales cs LEFT OUTER JOIN catalog_returns cr ON cs.cs_item_sk = cr.cr_item_sk AND cs.cs_order_number = cr.cr_order_number JOIN filtered_dates fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk JOIN filtered_items fi ON cs.cs_item_sk = fi.i_item_sk JOIN filtered_promos fp ON cs.cs_promo_sk = fp.p_promo_sk GROUP BY cp.cp_catalog_page_id"
      },
      "invariants_kept": [
        "output columns unchanged for ssr and csr",
        "grain preserved (s_store_id and cp_catalog_page_id)",
        "same aggregation results",
        "all required predicates applied"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Applied early_filter to push dimension table predicates (date range, item price > 50, promo channel = 'N') into separate filtered CTEs. This reduces data volume before joining with large fact tables (store_sales, catalog_sales) and their corresponding returns tables. By filtering date_dim, item, and promotion early, the subsequent joins and aggregations in ssr and csr process significantly fewer rows, improving performance while maintaining identical output semantics."
}
```