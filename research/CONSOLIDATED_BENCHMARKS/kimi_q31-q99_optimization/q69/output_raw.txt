 ```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "decorrelate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy BETWEEN 1 AND 1 + 2",
        "store_buyers": "SELECT DISTINCT ss_customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk",
        "web_buyers": "SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk",
        "catalog_buyers": "SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk",
        "main_query": "SELECT cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, COUNT(*) AS cnt1, cd.cd_purchase_estimate, COUNT(*) AS cnt2, cd.cd_credit_rating, COUNT(*) AS cnt3 FROM customer c JOIN customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics cd ON c.c_current_cdemo_sk = cd.cd_demo_sk JOIN store_buyers sb ON c.c_customer_sk = sb.ss_customer_sk LEFT JOIN web_buyers wb ON c.c_customer_sk = wb.ws_bill_customer_sk LEFT JOIN catalog_buyers cb ON c.c_customer_sk = cb.cs_ship_customer_sk WHERE ca.ca_state IN ('TX', 'VA', 'MI') AND wb.ws_bill_customer_sk IS NULL AND cb.cs_ship_customer_sk IS NULL GROUP BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating ORDER BY cd.cd_gender, cd.cd_marital_status, cd.cd_education_status, cd.cd_purchase_estimate, cd.cd_credit_rating LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same aggregation semantics"
      ],
      "expected_speedup": "3.50x",
      "risk": "low"
    }
  ],
  "explanation": "Decorrelated the three EXISTS/NOT EXISTS subqueries by materializing distinct customer sets for each sales channel (store, web, catalog) filtered by the date range (d_year=2000, d_moy 1-3). Converted the correlated semi-joins and anti-joins into explicit joins: INNER JOIN with store_buyers ensures customers have store sales, LEFT JOIN with IS NULL checks on web_buyers and catalog_buyers ensures customers have no sales in those channels. Pushed the date filter into a shared CTE to avoid redundant scans of date_dim. This eliminates repeated subquery execution per customer row."
}
```