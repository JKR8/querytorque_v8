{
  "id": "DIMENSION_CTE_SAME_COLUMN_OR",
  "severity": "MEDIUM",
  "description": "Do not extract dimension CTE filters when the WHERE clause has OR conditions on the same column. Same-column ORs are efficiently handled by the optimizer in a single scan; CTE extraction adds overhead without benefit.",
  "observed_failures": [
    {
      "query": "Q37",
      "regression": "0.89x",
      "problem": "OR conditions on item.i_current_price ranges were extracted into separate CTEs, adding CTE materialization overhead without improving selectivity.",
      "type": "SAME_COLUMN_OR_CTE"
    }
  ],
  "constraint_rules": [
    {
      "rule": "KEEP_SAME_COLUMN_OR_INLINE",
      "description": "When OR conditions filter the same column (e.g., i_current_price BETWEEN X AND Y OR i_current_price BETWEEN A AND B), keep them inline in WHERE. Only extract dimension CTEs when filters span different columns or tables."
    }
  ],
  "prompt_instruction": "Do not create dimension CTEs to isolate OR conditions that filter the same column. The optimizer handles same-column ORs efficiently in a single scan. Only apply dimension_cte_isolate when filters span different columns or different dimension tables."
}
