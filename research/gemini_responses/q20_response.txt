{
  "operations": [
    {
      "op": "add_cte",
      "after": "start",
      "name": "filtered_item",
      "sql": "select i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price from item where i_category in ('Shoes', 'Books', 'Women')"
    },
    {
      "op": "add_cte",
      "after": "filtered_item",
      "name": "filtered_date",
      "sql": "select d_date_sk from date_dim where d_date between cast('2002-01-26' as date) and (cast('2002-01-26' as date) + INTERVAL 30 DAY)"
    },
    {
      "op": "replace_clause",
      "target": "main_query.from",
      "sql": "from catalog_sales, filtered_item, filtered_date"
    },
    {
      "op": "replace_clause",
      "target": "main_query.where",
      "sql": "where cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk"
    }
  ],
  "semantic_warnings": [],
  "explanation": "Pushed filters for 'item' and 'date_dim' into CTEs. This ensures optimal join order and reduces the cost of scanning the item table which was identified as a bottleneck."
}