{
  "operations": [
    {
      "op": "add_cte",
      "after": "start",
      "name": "filtered_cdemo",
      "sql": "select cd_demo_sk, cd_gender, cd_marital_status, cd_education_status from customer_demographics where cd_gender = 'F' and cd_marital_status = 'W' and cd_education_status = 'College'"
    },
    {
      "op": "add_cte",
      "after": "filtered_cdemo",
      "name": "filtered_date",
      "sql": "select d_date_sk, d_year from date_dim where d_year = 2001"
    },
    {
      "op": "add_cte",
      "after": "filtered_date",
      "name": "filtered_promo",
      "sql": "select p_promo_sk, p_channel_email, p_channel_event from promotion where (p_channel_email = 'N' or p_channel_event = 'N')"
    },
    {
      "op": "replace_clause",
      "target": "main_query.from",
      "sql": "from store_sales, filtered_cdemo, filtered_date, item, filtered_promo"
    },
    {
      "op": "replace_clause",
      "target": "main_query.where",
      "sql": "where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk"
    }
  ],
  "semantic_warnings": [],
  "explanation": "Applied Predicate Pushdown by filtering dimension tables (demographics, date, promotion) in CTEs before joining to the large store_sales fact table."
}