{
  "operations": [
    {
      "op": "add_cte",
      "after": "start",
      "name": "filtered_item",
      "sql": "select i_item_sk, i_brand, i_brand_id, i_manufact_id, i_manufact from item where i_manager_id=2"
    },
    {
      "op": "add_cte",
      "after": "filtered_item",
      "name": "filtered_date",
      "sql": "select d_date_sk from date_dim where d_moy=12 and d_year=1999"
    },
    {
      "op": "replace_clause",
      "target": "main_query.from",
      "sql": "from filtered_date, store_sales, filtered_item, customer, customer_address, store"
    },
    {
      "op": "replace_clause",
      "target": "main_query.where",
      "sql": "where d_date_sk = ss_sold_date_sk\n   and ss_item_sk = i_item_sk\n   and ss_customer_sk = c_customer_sk \n   and c_current_addr_sk = ca_address_sk\n   and substr(ca_zip,1,5) <> substr(s_zip,1,5) \n   and ss_store_sk = s_store_sk"
    }
  ],
  "semantic_warnings": [],
  "explanation": "Applied Predicate Pushdown (Pattern 1) by filtering 'item' (by manager) and 'date_dim' (by month/year) in CTEs. This reduces the number of fact table rows processed."
}