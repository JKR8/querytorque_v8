[
  {
    "query": 1,
    "speedup": 0,
    "correct": false,
    "orig_time": 0.02099764347076416,
    "opt_time": 0,
    "error": "Binder Error: Referenced column \"s_store_sk\" not found in FROM clause!\nCandidate bindings: \"ctr_store_sk\", \"ctr_customer_sk\", \"ctr_store_avg\"\n\nLINE 29:   AND s_store_sk = ctr1.ctr_store_sk\n               ^",
    "explanation": "Pushed the store state filter ('SD') into the CTE to reduce the aggregation set. Replaced the correlated subquery (which re-scanned the CTE) with a window function computed in the same pass."
  },
  {
    "query": 2,
    "speedup": 1.5039470514037898,
    "correct": false,
    "orig_time": 0.025300264358520508,
    "opt_time": 0.01682257652282715,
    "error": null,
    "explanation": "Applied Predicate Pushdown (Pattern 1) by adding 'd_year in (1998, 1999)' to the 'wswscs' CTE. This avoids aggregating data for all years when only 1998 and 1999 are needed by the main query."
  },
  {
    "query": 3,
    "speedup": 0,
    "correct": false,
    "orig_time": 0.0072591304779052734,
    "opt_time": 0,
    "error": "Binder Error: Referenced table \"store_sales\" not found!\nCandidate tables: \"dt\"\n\nLINE 9:   dt.d_date_sk = store_sales.ss_sold_date_sk\n                         ^",
    "explanation": "Used CTEs to explicitly filter 'date_dim' and 'item' tables before joining them to the large 'store_sales' fact table. This enforces Predicate Pushdown (Pattern 1)."
  },
  {
    "query": 4,
    "speedup": 1.0481278644709604,
    "correct": true,
    "orig_time": 0.5258321762084961,
    "opt_time": 0.5016870498657227,
    "error": null,
    "explanation": "Pushed the year filter (d_year in 1999, 2000) into all branches of the 'year_total' CTE. This prevents aggregating data for unneeded years, significantly reducing the scan and hash group by costs."
  },
  {
    "query": 6,
    "speedup": 0,
    "correct": false,
    "orig_time": 0.02973330020904541,
    "opt_time": 0,
    "error": "Binder Error: Referenced table \"i\" not found!\nCandidate tables: \"a\"\n\nLINE 25:       j.i_category = i.i_category\n                              ^",
    "explanation": "Converted the correlated subquery calculating average price per category into a window function within a CTE. This avoids rescanning the item table for every row."
  },
  {
    "query": 7,
    "speedup": 0,
    "correct": false,
    "orig_time": 0.03798973560333252,
    "opt_time": 0,
    "error": "Binder Error: Referenced column \"d_date_sk\" not found in FROM clause!\nCandidate bindings: \"ss_addr_sk\", \"ss_item_sk\", \"ss_sold_date_sk\", \"ss_cdemo_sk\", \"ss_hdemo_sk\"\n\nLINE 10:   ss_sold_date_sk = d_date_sk\n                             ^",
    "explanation": "Applied Predicate Pushdown by filtering dimension tables (demographics, date, promotion) in CTEs before joining to the large store_sales fact table."
  },
  {
    "query": 8,
    "speedup": 0,
    "correct": false,
    "orig_time": 0.4388926029205322,
    "opt_time": 0,
    "error": "Binder Error: Referenced column \"s_store_sk\" not found in FROM clause!\nCandidate bindings: \"ss_store_sk\", \"ss_item_sk\", \"ss_customer_sk\", \"ss_cdemo_sk\", \"ss_hdemo_sk\"\n\nLINE 7:   ss_store_sk = s_store_sk\n                        ^",
    "explanation": "Merged the zip code filter and the preferred customer count check into a single subquery. This eliminates the need to scan customer_address twice and perform an expensive INTERSECT operation."
  },
  {
    "query": 9,
    "speedup": 1.0073844775082075,
    "correct": true,
    "orig_time": 0.026263833045959473,
    "opt_time": 0.02607131004333496,
    "error": null,
    "explanation": "Replaced multiple independent subqueries scanning the same table with a single pass aggregation using CASE WHEN. This dramatically reduces I/O."
  }
]