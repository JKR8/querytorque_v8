{
  "operations": [
    {
      "op": "add_cte",
      "after": "start",
      "name": "filtered_item",
      "sql": "SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Books', 'Sports', 'Men')"
    },
    {
      "op": "add_cte",
      "after": "filtered_item",
      "name": "filtered_date",
      "sql": "SELECT d_date_sk, d_date FROM date_dim WHERE d_date between cast('1998-04-06' as date) and (cast('1998-04-06' as date) + INTERVAL 30 DAY)"
    },
    {
      "op": "replace_clause",
      "target": "main_query.from",
      "sql": "from web_sales, filtered_item, filtered_date"
    },
    {
      "op": "replace_clause",
      "target": "main_query.where",
      "sql": "where ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk"
    }
  ],
  "semantic_warnings": [],
  "explanation": "Pushed dimension filters into CTEs 'filtered_item' and 'filtered_date'. This ensures that only relevant items and dates are processed before joining with the fact table."
}