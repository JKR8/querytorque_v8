============================================================
MINIMAL PROMPT THAT WORKED (DeepSeek achieved 2.17x speedup)
============================================================

Optimize this SQL. Reduce rows early.

Row counts:
- store_returns: 29M rows
- store WHERE s_state='SD': 41 rows
- date_dim WHERE d_year=2000: 366 rows

```sql
with customer_total_return as
(select sr_customer_sk as ctr_customer_sk, sr_store_sk as ctr_store_sk, sum(SR_FEE) as ctr_total_return
from store_returns, date_dim
where sr_returned_date_sk = d_date_sk and d_year = 2000
group by sr_customer_sk, sr_store_sk)
select c_customer_id
from customer_total_return ctr1, store, customer
where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk)
and s_store_sk = ctr1.ctr_store_sk and s_state = 'SD' and ctr1.ctr_customer_sk = c_customer_sk
order by c_customer_id LIMIT 100;
```

Return optimized SQL only.

============================================================
KEY DIFFERENCES FROM V7/V8:
============================================================

1. Shows FILTER SELECTIVITY: "store WHERE s_state='SD': 41 rows"
   - v7/v8 only showed "store: 402 rows" (total, not filtered)

2. Much shorter - just the essential info

3. No schema details, no engine info, no constraints

4. Simple instruction: "Reduce rows early"

============================================================
RESULT: DeepSeek used EXISTS to filter before aggregation
============================================================
