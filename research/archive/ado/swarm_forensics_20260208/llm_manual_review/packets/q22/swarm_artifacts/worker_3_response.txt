```sql
WITH filtered_dates AS (
  SELECT d_date_sk
  FROM date_dim
  WHERE d_month_seq BETWEEN 1188 AND 1188 + 11
),
prejoined_inventory AS (
  SELECT 
    inv_item_sk,
    inv_quantity_on_hand
  FROM inventory
  JOIN filtered_dates ON inv_date_sk = d_date_sk
)
SELECT
  i_product_name,
  i_brand,
  i_class,
  i_category,
  AVG(inv_quantity_on_hand) AS qoh
FROM prejoined_inventory
JOIN item ON inv_item_sk = i_item_sk
GROUP BY
  ROLLUP (
    i_product_name,
    i_brand,
    i_class,
    i_category
  )
ORDER BY
  qoh,
  i_product_name,
  i_brand,
  i_class,
  i_category
LIMIT 100;
```

Changes: Isolated the date_dim filter into a CTE, then pre-joined it with the fact table (inventory) in a second CTE before joining with the remaining dimension (item). This creates a staged pipeline that reduces the fact table scan using the filtered dimension keys first.

Expected speedup: 2-3x by eliminating unnecessary inventory scans outside the date range and enabling better join order optimization.