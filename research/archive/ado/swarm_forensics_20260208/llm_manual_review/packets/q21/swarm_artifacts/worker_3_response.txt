```sql
WITH filtered_item AS (
    SELECT i_item_sk, i_item_id
    FROM item
    WHERE i_current_price BETWEEN 0.99 AND 1.49
),
filtered_date AS (
    SELECT d_date_sk, d_date
    FROM date_dim
    WHERE d_date BETWEEN (
        CAST('2002-02-27' AS DATE) - INTERVAL '30' DAY
    ) AND (
        CAST('2002-02-27' AS DATE) + INTERVAL '30' DAY
    )
),
inventory_prejoined AS (
    SELECT 
        inv_quantity_on_hand,
        inv_warehouse_sk,
        filtered_item.i_item_id,
        filtered_date.d_date
    FROM inventory
    JOIN filtered_item ON inventory.inv_item_sk = filtered_item.i_item_sk
    JOIN filtered_date ON inventory.inv_date_sk = filtered_date.d_date_sk
),
aggregated AS (
    SELECT
        w_warehouse_name,
        i_item_id,
        SUM(
            CASE
                WHEN CAST(d_date AS DATE) < CAST('2002-02-27' AS DATE)
                THEN inv_quantity_on_hand
                ELSE 0
            END
        ) AS inv_before,
        SUM(
            CASE
                WHEN CAST(d_date AS DATE) >= CAST('2002-02-27' AS DATE)
                THEN inv_quantity_on_hand
                ELSE 0
            END
        ) AS inv_after
    FROM inventory_prejoined
    JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk
    GROUP BY
        w_warehouse_name,
        i_item_id
)
SELECT *
FROM aggregated
WHERE (
    CASE WHEN inv_before > 0 THEN inv_after / inv_before ELSE NULL END
) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0
ORDER BY
    w_warehouse_name,
    i_item_id
LIMIT 100
```

Changes: Applied aggressive_multi_cte_prefetch strategy by pre-filtering item and date_dim into separate CTEs, then pre-joining them with the fact table (inventory) in a second CTE before final aggregation with warehouse. This reduces large table scans by applying dimension filters early and joining only filtered keys to the fact table.

Expected speedup: 2-3x (reduces fact table joins by applying selective dimension filters first)