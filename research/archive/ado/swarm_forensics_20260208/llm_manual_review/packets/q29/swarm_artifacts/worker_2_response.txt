```sql
WITH d1_dates AS (
  SELECT d_date_sk
  FROM date_dim
  WHERE d_moy = 4
    AND d_year = 1999
),
d2_dates AS (
  SELECT d_date_sk
  FROM date_dim
  WHERE d_moy BETWEEN 4 AND 7
    AND d_year = 1999
),
d3_dates AS (
  SELECT d_date_sk
  FROM date_dim
  WHERE d_year IN (1999, 2000, 2001)
),
filtered_store_sales AS (
  SELECT
    ss_item_sk,
    ss_customer_sk,
    ss_ticket_number,
    ss_store_sk,
    ss_quantity
  FROM store_sales
  JOIN d1_dates ON ss_sold_date_sk = d1_dates.d_date_sk
),
filtered_store_returns AS (
  SELECT
    sr_item_sk,
    sr_customer_sk,
    sr_ticket_number,
    sr_return_quantity
  FROM store_returns
  JOIN d2_dates ON sr_returned_date_sk = d2_dates.d_date_sk
),
filtered_catalog_sales AS (
  SELECT
    cs_item_sk,
    cs_bill_customer_sk,
    cs_quantity
  FROM catalog_sales
  JOIN d3_dates ON cs_sold_date_sk = d3_dates.d_date_sk
)
SELECT
  i.i_item_id,
  i.i_item_desc,
  s.s_store_id,
  s.s_store_name,
  AVG(fss.ss_quantity) AS store_sales_quantity,
  AVG(fsr.sr_return_quantity) AS store_returns_quantity,
  AVG(fcs.cs_quantity) AS catalog_sales_quantity
FROM filtered_store_sales fss
JOIN filtered_store_returns fsr
  ON fss.ss_customer_sk = fsr.sr_customer_sk
 AND fss.ss_item_sk = fsr.sr_item_sk
 AND fss.ss_ticket_number = fsr.sr_ticket_number
JOIN filtered_catalog_sales fcs
  ON fsr.sr_customer_sk = fcs.cs_bill_customer_sk
 AND fsr.sr_item_sk = fcs.cs_item_sk
JOIN store s ON fss.ss_store_sk = s.s_store_sk
JOIN item i ON fss.ss_item_sk = i.i_item_sk
GROUP BY
  i.i_item_id,
  i.i_item_desc,
  s.s_store_id,
  s.s_store_name
ORDER BY
  i.i_item_id,
  i.i_item_desc,
  s.s_store_id,
  s.s_store_name
LIMIT 100
```

**Changes**: Isolated each date_dim alias into separate CTEs with their respective filters, then pre-joined each fact table with its corresponding date CTE before the main multi-way join. This creates small hash tables for date lookups and reduces rows entering the complex join.

**Expected speedup**: 2.0x-2.5x from early fact table reduction and better predicate pushdown.