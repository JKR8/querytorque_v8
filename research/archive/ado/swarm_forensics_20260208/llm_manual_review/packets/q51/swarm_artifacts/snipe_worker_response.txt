```sql
WITH filtered_dates AS (
  SELECT d_date_sk, d_date
  FROM date_dim
  WHERE d_month_seq BETWEEN 1216 AND 1216 + 11
),
web_daily AS (
  SELECT
    ws_item_sk AS item_sk,
    d.d_date,
    SUM(ws_sales_price) AS daily_sales
  FROM web_sales
  JOIN filtered_dates d ON ws_sold_date_sk = d.d_date_sk
  WHERE ws_item_sk IS NOT NULL
  GROUP BY ws_item_sk, d.d_date
),
store_daily AS (
  SELECT
    ss_item_sk AS item_sk,
    d.d_date,
    SUM(ss_sales_price) AS daily_sales
  FROM store_sales
  JOIN filtered_dates d ON ss_sold_date_sk = d.d_date_sk
  WHERE ss_item_sk IS NOT NULL
  GROUP BY ss_item_sk, d.d_date
)
SELECT
  item_sk,
  d_date,
  web_cumulative AS web_sales,
  store_cumulative AS store_sales,
  web_cumulative,
  store_cumulative
FROM (
  SELECT
    COALESCE(web.item_sk, store.item_sk) AS item_sk,
    COALESCE(web.d_date, store.d_date) AS d_date,
    SUM(web.daily_sales) OVER (
      PARTITION BY COALESCE(web.item_sk, store.item_sk)
      ORDER BY COALESCE(web.d_date, store.d_date)
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS web_cumulative,
    SUM(store.daily_sales) OVER (
      PARTITION BY COALESCE(web.item_sk, store.item_sk)
      ORDER BY COALESCE(web.d_date, store.d_date)
      ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
    ) AS store_cumulative
  FROM web_daily web
  FULL OUTER JOIN store_daily store
    ON web.item_sk = store.item_sk AND web.d_date = store.d_date
) y
WHERE web_cumulative > store_cumulative
ORDER BY item_sk, d_date
LIMIT 100
```

**Changes:** Deferred window aggregation by computing daily sums first, moving cumulative calculations after the join. Added shared dimension CTE to filter dates once. Removed redundant MAX windows since cumulative sums are non-decreasing.

**Expected speedup:** ~2.2x (eliminates duplicate date_dim scans, reduces window function computations, and avoids materializing cumulative results before the join)