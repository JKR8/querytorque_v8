```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "main_query": "WITH filtered_date_dim AS (\n  SELECT d_date_sk, d_week_seq, d_date\n  FROM date_dim\n  WHERE d_year = 1998\n),\nfiltered_item AS (\n  SELECT i_item_sk\n  FROM item\n  WHERE i_category IN ('Home', 'Men', 'Music')\n),\nfiltered_customer_demographics AS (\n  SELECT cd_demo_sk\n  FROM customer_demographics\n  WHERE cd_marital_status = 'M'\n    AND cd_dep_count BETWEEN 9 AND 11\n),\nfiltered_household_demographics AS (\n  SELECT hd_demo_sk\n  FROM household_demographics\n  WHERE hd_buy_potential = '501-1000'\n)\nSELECT MIN(i_item_sk), MIN(w_warehouse_name), MIN(d1.d_week_seq), MIN(cs_item_sk), MIN(cs_order_number), MIN(inv_item_sk)\nFROM catalog_sales\nJOIN filtered_item item ON (i_item_sk = cs_item_sk)\nJOIN filtered_customer_demographics cd ON (cs_bill_cdemo_sk = cd_demo_sk)\nJOIN filtered_household_demographics hd ON (cs_bill_hdemo_sk = hd_demo_sk)\nJOIN filtered_date_dim d1 ON (cs_sold_date_sk = d1.d_date_sk)\nJOIN inventory ON (cs_item_sk = inv_item_sk)\nJOIN warehouse ON (w_warehouse_sk = inv_warehouse_sk)\nJOIN date_dim d2 ON (inv_date_sk = d2.d_date_sk)\nJOIN date_dim d3 ON (cs_ship_date_sk = d3.d_date_sk)\nLEFT OUTER JOIN promotion ON (cs_promo_sk = p_promo_sk)\nLEFT OUTER JOIN catalog_returns ON (cr_item_sk = cs_item_sk AND cr_order_number = cs_order_number)\nWHERE d1.d_week_seq = d2.d_week_seq\n  AND inv_quantity_on_hand < cs_quantity\n  AND d3.d_date > d1.d_date + INTERVAL '3' DAY\n  AND cs_wholesale_cost BETWEEN 34 AND 54"
      },
      "invariants_kept": [
        "All original joins preserved",
        "All literal values preserved exactly",
        "All filter conditions preserved",
        "Output columns unchanged",
        "Aggregation grain unchanged"
      ],
      "expected_speedup": "2x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim and dimension table filters into CTEs to push them early in the execution plan. This reduces the amount of data flowing through the joins by applying selective filters on dimension tables (date_dim with d_year=1998, item with categories, customer/household demographics with their respective filters) before joining with large fact tables. The rewrite maintains all original join conditions and literal values exactly."
}
```