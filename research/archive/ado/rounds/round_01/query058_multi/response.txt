```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "date_filter": "SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1999-05-02')",
        "ss_items": "SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk WHERE ss_list_price BETWEEN 217 AND 246 AND i_manager_id BETWEEN 25 AND 54 AND c_birth_year BETWEEN 1961 AND 1967 GROUP BY i_item_id, c_birth_year",
        "cs_items": "SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk JOIN date_filter ON cs_sold_date_sk = d_date_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk WHERE cs_list_price BETWEEN 217 AND 246 AND i_manager_id BETWEEN 25 AND 54 AND c_birth_year BETWEEN 1961 AND 1967 GROUP BY i_item_id, c_birth_year"
      },
      "invariants_kept": [
        "Same output columns and grain for ss_items and cs_items",
        "Date filter condition preserved (same month)",
        "All literal values preserved exactly"
      ],
      "expected_speedup": "1.5x",
      "risk": "low"
    },
    {
      "id": "rs_02",
      "transform": "materialize_cte",
      "nodes": {
        "date_filter": "SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq = (SELECT d_month_seq FROM date_dim WHERE d_date = '1999-05-02')",
        "ss_items": "SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk WHERE ss_list_price BETWEEN 217 AND 246 AND i_manager_id BETWEEN 25 AND 54 AND c_birth_year BETWEEN 1961 AND 1967 GROUP BY i_item_id, c_birth_year",
        "cs_items": "SELECT i_item_id AS item_id, c_birth_year AS birth_year, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk JOIN date_filter ON cs_sold_date_sk = d_date_sk JOIN customer ON cs_bill_customer_sk = c_customer_sk WHERE cs_list_price BETWEEN 217 AND 246 AND i_manager_id BETWEEN 25 AND 54 AND c_birth_year BETWEEN 1961 AND 1967 GROUP BY i_item_id, c_birth_year"
      },
      "invariants_kept": [
        "Same output columns and grain",
        "Date filter computed once and reused"
      ],
      "expected_speedup": "1.2x",
      "risk": "low"
    }
  ],
  "explanation": "Created a shared date_filter CTE that isolates the date dimension subquery, allowing it to be computed once and joined early with fact tables. This eliminates repeated execution of the same subquery in both ss_items and cs_items CTEs. The date_filter CTE is materialized to ensure it's computed only once, avoiding re-execution for each reference. All literal values are preserved exactly as in the original query."
}
```