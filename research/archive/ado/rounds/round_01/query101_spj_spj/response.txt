```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "early_filter, date_cte_isolate, pushdown",
      "nodes": {
        "filtered_d1": "SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 2000",
        "filtered_item": "SELECT i_item_sk FROM item WHERE i_category IN ('Children', 'Electronics', 'Women')",
        "filtered_ca": "SELECT ca_address_sk FROM customer_address WHERE ca_state IN ('GA', 'IA', 'LA', 'MO', 'SD')",
        "filtered_hd": "SELECT hd_demo_sk FROM household_demographics WHERE hd_income_band_sk BETWEEN 12 AND 18 AND hd_buy_potential = '0-500'",
        "main_query": "SELECT MIN(c_customer_sk), MIN(ss_item_sk), MIN(sr_ticket_number), MIN(ws_order_number) FROM (SELECT ss_ticket_number, ss_customer_sk, ss_item_sk, c_customer_sk, c_current_addr_sk, c_current_hdemo_sk, ss_sales_price, ss_list_price FROM store_sales, customer WHERE ss_customer_sk = c_customer_sk AND ss_sales_price / ss_list_price BETWEEN 34 * 0.01 AND 54 * 0.01) ss_cust JOIN store_returns sr ON ss_cust.ss_ticket_number = sr.sr_ticket_number AND ss_cust.ss_item_sk = sr.sr_item_sk JOIN web_sales ws ON ss_cust.ss_customer_sk = ws.ws_bill_customer_sk AND sr.sr_item_sk = ws.ws_item_sk JOIN filtered_d1 d1 ON sr.sr_returned_date_sk = d1.d_date_sk JOIN date_dim d2 ON ws.ws_sold_date_sk = d2.d_date_sk JOIN filtered_item i ON ss_cust.ss_item_sk = i.i_item_sk JOIN filtered_ca ca ON ss_cust.c_current_addr_sk = ca.ca_address_sk JOIN filtered_hd hd ON ss_cust.c_current_hdemo_sk = hd.hd_demo_sk WHERE d2.d_date BETWEEN d1.d_date AND (d1.d_date + INTERVAL '90' DAY)"
      },
      "invariants_kept": [
        "All original literal values preserved exactly",
        "All join conditions preserved",
        "All filter conditions preserved",
        "Same output columns and aggregation grain"
      ],
      "expected_speedup": "3x",
      "risk": "low"
    }
  ],
  "explanation": "Created filtered CTEs for dimension tables with selective filters (date_dim d1, item, customer_address, household_demographics) to reduce join cardinality early. Pushed the ratio filter on store_sales and the join with customer into a subquery to reduce the store_sales rows before joining with other fact tables. This reduces the intermediate result sizes significantly while preserving all original conditions exactly."
}
```