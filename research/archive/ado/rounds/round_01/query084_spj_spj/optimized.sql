WITH filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_city = 'Lakeview'), filtered_income_band AS (SELECT ib_income_band_sk FROM income_band WHERE ib_lower_bound >= 7 * 10000 AND ib_upper_bound <= 7 * 10000 + 50000) SELECT MIN(c_customer_id), MIN(sr_ticket_number), MIN(sr_item_sk) FROM customer JOIN filtered_customer_address ON c_current_addr_sk = ca_address_sk JOIN customer_demographics ON cd_demo_sk = c_current_cdemo_sk JOIN household_demographics ON hd_demo_sk = c_current_hdemo_sk JOIN filtered_income_band ON ib_income_band_sk = hd_income_band_sk JOIN store_returns ON sr_cdemo_sk = cd_demo_sk