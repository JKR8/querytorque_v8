```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate, early_filter, reorder_join",
      "nodes": {
        "main_query": "WITH filtered_date AS (\n  SELECT d_date_sk\n  FROM date_dim\n  WHERE d_year = 2002\n    AND d_moy = 12\n),\nfiltered_item AS (\n  SELECT i_item_sk, i_brand_id, i_manufact_id\n  FROM item\n  WHERE i_category = 'Home'\n),\nfiltered_customer_address AS (\n  SELECT ca_address_sk, ca_zip\n  FROM customer_address\n  WHERE ca_state = 'TX'\n),\nfiltered_customer AS (\n  SELECT c_customer_sk, c_current_addr_sk\n  FROM customer\n  WHERE c_birth_month = 1\n),\nfiltered_store AS (\n  SELECT s_store_sk, s_zip\n  FROM store\n)\nSELECT MIN(i.i_brand_id), MIN(i.i_manufact_id), MIN(ss.ss_ext_sales_price)\nFROM store_sales ss\nINNER JOIN filtered_date d ON d.d_date_sk = ss.ss_sold_date_sk\nINNER JOIN filtered_item i ON ss.ss_item_sk = i.i_item_sk\nINNER JOIN filtered_customer c ON ss.ss_customer_sk = c.c_customer_sk\nINNER JOIN filtered_customer_address ca ON c.c_current_addr_sk = ca.ca_address_sk\nINNER JOIN filtered_store s ON ss.ss_store_sk = s.s_store_sk\nWHERE ss.ss_wholesale_cost BETWEEN 34 AND 54\n  AND SUBSTRING(ca.ca_zip, 1, 5) <> SUBSTRING(s.s_zip, 1, 5)"
      },
      "invariants_kept": [
        "Output columns: MIN(i_brand_id), MIN(i_manufact_id), MIN(ss_ext_sales_price)",
        "All original filter conditions preserved exactly",
        "Same join semantics with all original relationships",
        "Same result grain and cardinality"
      ],
      "expected_speedup": "3x",
      "risk": "low"
    }
  ],
  "explanation": "Created CTEs to isolate selective filters early, particularly the date dimension (QT-OPT-003 pattern). Each CTE applies table-specific filters before joining, reducing the intermediate join sizes significantly. The store_sales fact table is joined last after all dimension filters are applied, with the wholesale cost filter applied at the final join. All literals are preserved exactly as in the original query."
}
```