```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate, early_filter, reorder_join",
      "nodes": {
        "main_query": "WITH filtered_d1 AS (\n    SELECT d_date_sk, d_date\n    FROM date_dim\n    WHERE d_year = 2002\n),\nfiltered_item AS (\n    SELECT i_item_sk\n    FROM item\n    WHERE i_category IN ('Home', 'Men', 'Music')\n      AND i_manager_id IN (1, 2, 4, 11, 12, 14, 21, 29, 32, 52)\n),\nfiltered_ca AS (\n    SELECT ca_address_sk\n    FROM customer_address\n    WHERE ca_state IN ('GA', 'MD', 'MO', 'NC', 'OR')\n),\nfiltered_customer AS (\n    SELECT c_customer_sk, c_current_cdemo_sk, c_current_hdemo_sk\n    FROM customer\n    WHERE c_current_addr_sk IN (SELECT ca_address_sk FROM filtered_ca)\n)\nSELECT MIN(ss_item_sk), MIN(ss_ticket_number), MIN(ws_order_number), MIN(c_customer_sk), MIN(cd_demo_sk), MIN(hd_demo_sk)\nFROM store_sales\nJOIN filtered_d1 d1 ON ss_sold_date_sk = d1.d_date_sk\nJOIN filtered_item i ON ss_item_sk = i.i_item_sk\nJOIN filtered_customer c ON ss_customer_sk = c.c_customer_sk\nJOIN inventory ON inv_item_sk = ss_item_sk AND inv_date_sk = ss_sold_date_sk\nJOIN web_sales ON ws_item_sk = ss_item_sk AND ws_bill_customer_sk = c.c_customer_sk\nJOIN date_dim d2 ON ws_sold_date_sk = d2.d_date_sk\nJOIN warehouse ON ws_warehouse_sk = w_warehouse_sk\nJOIN store ON s_state = w_state\nJOIN customer_demographics ON c.c_current_cdemo_sk = cd_demo_sk\nJOIN household_demographics ON c.c_current_hdemo_sk = hd_demo_sk\nWHERE d2.d_date BETWEEN d1.d_date AND (d1.d_date + INTERVAL '30' DAY)\n  AND inv_quantity_on_hand >= ss_quantity\n  AND ws_warehouse_sk = inv_warehouse_sk\n  AND ws_wholesale_cost BETWEEN 34 AND 54"
      },
      "invariants_kept": [
        "All MIN() aggregate functions preserved",
        "All original filter literals preserved exactly (d_year=2002, categories, manager_ids, states, wholesale_cost range)",
        "All join conditions preserved",
        "Date range condition between d1 and d2 preserved"
      ],
      "expected_speedup": "3x-5x",
      "risk": "medium"
    }
  ],
  "explanation": "Applied three key transforms: 1) DATE_CTE_ISOLATE for d1 with d_year=2002 to filter early; 2) EARLY_FILTER on item, customer_address, and customer to reduce joined rows before expensive joins; 3) REORDER_JOIN to place filtered dimension tables first. This reduces the Cartesian product effect by filtering before joining large fact tables, while preserving all original semantics exactly. The rewrite respects LITERAL_PRESERVATION by copying all literal values exactly."
}
```