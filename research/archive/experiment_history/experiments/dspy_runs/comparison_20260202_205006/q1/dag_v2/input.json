{
  "mode": "dag_v2",
  "model": "moonshotai/kimi-k2.5",
  "sql": "-- start query 1 in stream 0 using template query1.tpl\nwith customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_FEE) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =2000\ngroup by sr_customer_sk\n,sr_store_sk)\n select c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'SD'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\n LIMIT 100;\n\n-- end query 1 in stream 0 using template query1.tpl\n",
  "dag_summary": "Nodes:\n  [customer_total_return] type=cte tables=[store_returns,date_dim] GROUP_BY\n  [main_query] type=main tables=[customer_total_return,store,customer] GROUP_BY CORRELATED\n\nEdges:\n  customer_total_return -> main_query\n  customer_total_return -> main_query",
  "num_examples": 2
}