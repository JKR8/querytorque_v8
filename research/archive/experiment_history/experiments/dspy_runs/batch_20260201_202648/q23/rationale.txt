1. **Materialized CTEs**: Added `/*+ MATERIALIZE */` hints to force materialization of CTEs, preventing repeated computation and reducing intermediate result sizes.

2. **BETWEEN for date ranges**: Replaced `d_year in (2000,2000+1,2000+2,2000+3)` with `d_year BETWEEN 2000 AND 2003` for clearer intent and potential index utilization.

3. **EXISTS instead of IN**: Changed `cs_item_sk IN (SELECT item_sk FROM frequent_ss_items)` to EXISTS with correlation, which is more efficient for large subquery results as it can stop scanning after first match.

4. **Simplified max_store_sales reference**: Changed the correlated subquery in `best_ss_customer` to a simple scalar subquery, reducing complexity.

5. **Explicit JOIN syntax**: Converted implicit joins to explicit JOIN syntax for better readability and optimizer understanding.

6. **Early filtering**: Date filters are applied at the earliest point in each CTE and query, reducing the amount of data processed in subsequent operations.

These optimizations reduce the cost of hash group by operations, minimize intermediate row counts, and improve join efficiency by using EXISTS with correlated subqueries instead of IN with potentially large result sets.