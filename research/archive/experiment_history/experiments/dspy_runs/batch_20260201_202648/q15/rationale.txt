1. **Early date filtering**: By filtering date_dim first (91 rows), we immediately reduce the catalog_sales join from 1.4M rows to only sales from Q1 2001.
2. **Pre-filter customer_address**: The filtered_customer_address CTE applies zip/state filters early, reducing 1M rows before joining.
3. **Separate OR conditions**: The cs_sales_price > 500 condition is kept in the main WHERE clause since it depends on the sales data. The zip/state conditions are pre-applied.
4. **Better join order**: Starting with the smallest filtered set (dates), then joining catalog_sales, then customer, then address follows the principle of reducing row counts early.
5. **Maintains semantics**: The UNION ALL approach for OR conditions was considered but would duplicate rows for customers matching multiple conditions. This approach correctly handles all cases while pushing filters earlier in the execution path.