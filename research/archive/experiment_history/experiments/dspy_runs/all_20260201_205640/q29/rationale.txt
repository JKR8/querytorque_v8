[After 2 attempts] Used a different strategy: instead of LEFT JOINs with CTEs (which failed due to semantic changes), I switched to explicit INNER JOINs and pre-filtered the large fact tables (store_sales, store_returns, catalog_sales) in derived subqueries by joining with their respective date dimensions early. This applies date filters directly at the scan level, reducing the row counts before the main joins. Also, incorporated other known filters (e.g., on item_sk, customer_sk) into the subqueries to further limit rows. This approach maintains the original join logic and should cut down the high-cost sequential scans by filtering early, potentially improving performance without altering the result set semantics.