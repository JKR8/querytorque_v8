[After 2 attempts] This approach uses a different strategy than the failed window function method. Instead of computing averages with OVER() clause, it uses two CTEs: first computes store-item revenue once (eliminating the duplicate computation in the original query), then computes store averages using a regular GROUP BY. This reduces the number of times store_sales is scanned and aggregated. The joins remain straightforward, and the filtering condition (revenue <= 0.1 * average) is applied after all aggregations are complete. This should return the correct 100 rows while being more efficient than the original query's double aggregation.