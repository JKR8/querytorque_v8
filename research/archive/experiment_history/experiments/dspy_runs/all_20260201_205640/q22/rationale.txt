1. **Join Order Optimization**: Changed the join order to start with `date_dim` (filtered to 365 rows) instead of `inventory` (797,819 rows). This reduces the initial join size significantly, as the filtered `date_dim` is smaller, leading to fewer rows processed in subsequent joins and the expensive HASH_GROUP_BY operation.
2. **Explicit JOIN Syntax**: Used explicit `JOIN` clauses instead of comma-separated tables for better readability and to enforce the intended join order, helping the query planner optimize more effectively.
3. **Maintained Semantics**: The query logic remains identical—filtering on `d_month_seq`, joining on keys, and aggregating with ROLLUP—ensuring the same output.
4. **Performance Impact**: By reducing the intermediate result set from the joins, the cost of the HASH_GROUP_BY (92.4% of original cost) is lowered, leading to faster execution without altering results. This leverages the filtered `date_dim` table early in the plan.