1. **Early filtering with CTEs**: Created three CTEs (store_customers, web_customers, catalog_customers) that pre-join each sales table with date_dim and filter for Q1 2000. This reduces repeated date_dim joins and allows the optimizer to materialize these small result sets (store_sales: 84K rows â†’ likely fewer distinct customers).

2. **Converted correlated subqueries to joins**: Changed EXISTS/NOT EXISTS pattern to JOIN/LEFT JOIN with NULL checks. This allows the query planner to optimize join order and use hash joins more efficiently instead of repeatedly executing subqueries for each customer row.

3. **State filter placement**: Moved the ca_state filter directly to the WHERE clause after joining customer_address, ensuring early reduction of the customer dataset.

4. **DISTINCT in CTEs**: Added DISTINCT to CTEs to eliminate duplicate customer keys, reducing the size of intermediate results for joins.

5. **Maintained semantic equivalence**: The query still finds customers with store sales but without web or catalog sales in Q1 2000, living in TX, VA, or MI states, grouped by demographic attributes.

These changes should reduce the sequential scans on large tables by filtering earlier and using more efficient join patterns, potentially converting high-cost sequential scans to indexed lookups or hash joins with smaller intermediate results.