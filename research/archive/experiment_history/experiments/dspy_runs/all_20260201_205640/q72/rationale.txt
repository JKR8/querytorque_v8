1. **Added CTEs for early filtering**: Created filtered CTEs for date_dim (d_year=2002), inventory (inv_item_skâ‰¤203999), customer_demographics (cd_marital_status='W'), and household_demographics (hd_buy_potential='501-1000') to reduce row counts before expensive joins.

2. **Pushed filters into JOIN conditions**: Moved `d2.d_week_seq = d1.d_week_seq` and `d3.d_date > d1.d_date + 5` from WHERE clause to JOIN conditions, allowing the optimizer to apply filters earlier.

3. **Added filter to item join**: Included `i.i_item_sk <= 203999` in the JOIN condition based on row estimate information.

4. **Maintained LEFT JOIN semantics**: Kept LEFT JOINs to promotion and catalog_returns as they affect the SUM/CASE calculations for promo/no_promo counts.

5. **Reduced sequential scan costs**: By filtering large tables early (especially inventory and customer_demographics), we reduce the 56.6% and 12.1% cost operations significantly.

6. **Preserved query semantics**: All original logic, grouping, ordering, and limit are maintained while improving execution performance through predicate pushdown and early filtering.