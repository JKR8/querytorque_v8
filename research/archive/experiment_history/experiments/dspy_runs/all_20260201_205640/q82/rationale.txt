1. **Replaced cross join with semi-joins**: The original query performed a full join with `store_sales` (2.1M rows) and `inventory` (46K rows), causing high-cost sequential scans. By using `EXISTS` subqueries, we stop processing after finding the first matching row, significantly reducing I/O and join overhead.
2. **Early filtering**: The `date_dim` filter is applied inside the `inventory` subquery, limiting rows before joining.
3. **Maintained semantics**: The query still returns items that have both inventory records (within date/quantity constraints) and sales records, grouped by item attributes, identical to the original.
4. **Potential index utilization**: If indexes exist on `inv_item_sk`, `ss_item_sk`, `d_date_sk`, and `i_item_sk`, the semi-joins can leverage index lookups instead of full scans.
5. **Reduced GROUP BY processing**: With fewer rows from the semi-joins, the hash group by operation becomes more efficient.