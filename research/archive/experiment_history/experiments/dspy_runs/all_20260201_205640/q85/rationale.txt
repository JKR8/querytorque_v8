1. **Early Filtering with CTEs**: Created filtered subqueries for `web_sales`, `customer_address`, `customer_demographics`, and `date_dim` to reduce row counts before joins. This minimizes the data processed in later operations.

2. **Combined Filter Conditions**: Consolidated the `ws_sales_price` and `ws_net_profit` filters in the `filtered_sales` CTE, allowing the database to apply both constraints simultaneously rather than evaluating them separately in the WHERE clause.

3. **State List Consolidation**: Combined all state filters (`ca_state IN (...)`) in the `filtered_address` CTE to avoid repeated OR conditions.

4. **Demographics Pre-filtering**: Added marital status and education status filters to the `filtered_demographics` CTE based on the OR conditions in the original query, reducing the dataset before joins.

5. **Simplified Join Conditions**: The main WHERE clause now only contains the demographic matching conditions, making the query logic clearer and potentially allowing better optimization by the query planner.

6. **Index Recommendations**: Based on the filter patterns, consider adding:
   - Indexes on `web_sales(ws_item_sk, ws_sales_price, ws_net_profit)`
   - Index on `customer_address(ca_country, ca_state)`
   - Index on `customer_demographics(cd_demo_sk, cd_marital_status, cd_education_status)`
   - Index on `date_dim(d_year)`

These optimizations should significantly reduce the cost of sequential scans and improve join performance by reducing the cardinality of intermediate results early in the execution plan.