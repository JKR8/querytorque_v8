[After 2 attempts] Used a different strategy: instead of multiple self-joins on CTEs (original approach) or a flawed WHERE clause (previous attempt), this version aggregates quarterly sales into columns per county using conditional aggregation. This reduces the number of joins in the final query from 5 self-joins to a single FULL OUTER JOIN and a GROUP BY, which should lower computational overhead. The WHERE clause is corrected to avoid syntax errors by separating comparisons properly. Early filtering on date_dim (d_year=2000, d_qoy IN (1,2,3)) is retained to reduce row counts before aggregation, addressing the high-cost sequential scans observed in the execution plan.