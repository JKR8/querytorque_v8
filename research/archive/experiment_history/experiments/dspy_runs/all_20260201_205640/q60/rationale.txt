[After 2 attempts] This approach uses a different strategy than the failed attempt: instead of pre-filtering all dimensions into CTEs and joining, we materialize the filtered item IDs once in a CTE (`filtered_items`) and use it in each sales CTE via a subquery in the WHERE clause (`i_item_id IN (SELECT ...)`). This maintains the original query's logic and semantics, which should preserve the correct row counts, while eliminating the repeated subquery execution on the item table. The joins are kept as INNER JOINs on the fact tables with dimensions, but the item filter is applied via the WHERE clause to mimic the original behavior. This reduces the repeated work on the item table and may allow the optimizer to push filters earlier, potentially reducing the row scans on the sales tables by filtering on item_id early. The structure is closer to the original, avoiding the join-order issues that likely caused the previous failure.