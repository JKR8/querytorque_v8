{
  "operations": [
    {
      "op": "replace_cte",
      "name": "wswscs",
      "sql": "select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n   and d_year in (1998, 1999)\n group by d_week_seq"
    }
  ],
  "semantic_warnings": [
    "Added d_year filter to CTE to limit scans."
  ],
  "explanation": "Applied Predicate Pushdown (Pattern 1) by adding 'd_year in (1998, 1999)' to the 'wswscs' CTE. This avoids aggregating data for all years when only 1998 and 1999 are needed by the main query."
}