{
  "operations": [
    {
      "op": "add_cte",
      "after": "start",
      "name": "filtered_cd1",
      "sql": "select cd_demo_sk, cd_dep_count from customer_demographics where cd_gender = 'F' and cd_education_status = 'Advanced Degree'"
    },
    {
      "op": "add_cte",
      "after": "filtered_cd1",
      "name": "filtered_c",
      "sql": "select c_customer_sk, c_current_cdemo_sk, c_current_addr_sk, c_birth_year from customer where c_birth_month in (10,7,8,4,1,2)"
    },
    {
      "op": "add_cte",
      "after": "filtered_c",
      "name": "filtered_ca",
      "sql": "select ca_address_sk, ca_country, ca_state, ca_county from customer_address where ca_state in ('WA','GA','NC','ME','WY','OK','IN')"
    },
    {
      "op": "add_cte",
      "after": "filtered_ca",
      "name": "filtered_date",
      "sql": "select d_date_sk from date_dim where d_year = 1998"
    },
    {
      "op": "replace_clause",
      "target": "main_query.from",
      "sql": "from catalog_sales, filtered_cd1 cd1, customer_demographics cd2, filtered_c c, filtered_ca, filtered_date, item"
    },
    {
      "op": "replace_clause",
      "target": "main_query.where",
      "sql": "where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c.c_customer_sk and\n       c.c_current_cdemo_sk = cd2.cd_demo_sk and\n       c.c_current_addr_sk = ca_address_sk"
    }
  ],
  "semantic_warnings": [],
  "explanation": "Pushed predicates for customer demographics, customer birth month, address state, and date year into CTEs. This significantly reduces the volume of data entering the main join."
}