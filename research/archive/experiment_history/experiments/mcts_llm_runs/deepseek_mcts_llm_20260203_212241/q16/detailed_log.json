{
  "stats": {
    "total_iterations": 12,
    "tree_size": 13,
    "successful_expansions": 12,
    "failed_expansions": 0,
    "validation_calls": 12,
    "llm_ranking_calls": 13,
    "root_visits": 12,
    "total_attempts": 12
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 26754,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.0,
      "output_sql": "SELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM catalog_sales AS cs1\nINNER JOIN date_dim\n  ON cs1.cs_ship_date_sk = d_date_sk\nINNER JOIN customer_address\n  ON cs1.cs_ship_addr_sk = ca_address_sk\nINNER JOIN call_center\n  ON cs1.cs_call_center_sk = cc_call_center_sk\n/* Convert EXISTS to SEMI JOIN */\nINNER JOIN (\n  SELECT DISTINCT\n    cs_order_number\n  FROM catalog_sales AS cs2\n  WHERE\n    cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\n) AS cs2\n  ON cs1.cs_order_number = cs2.cs_order_number\n/* Convert NOT EXISTS to ANTI JOIN */\nLEFT JOIN catalog_returns AS cr1\n  ON cs1.cs_order_number = cr1.cr_order_number\nWHERE\n  d_date BETWEEN '2002-4-01' AND (\n    CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY\n  )\n  AND ca_state = 'WV'\n  AND cc_county IN (\n    'Ziebach County',\n    'Luce County',\n    'Richland County',\n    'Daviess County',\n    'Barrow County'\n  )\n  AND cr1.cr_order_number IS NULL /* ANTI JOIN condition */\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 23717,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH orders_with_multiple_warehouses AS (\n  SELECT\n    cs_order_number\n  FROM catalog_sales\n  GROUP BY\n    cs_order_number\n  HAVING\n    COUNT(DISTINCT cs_warehouse_sk) > 1\n), orders_without_returns AS (\n  SELECT\n    cs_order_number\n  FROM catalog_sales\n  WHERE\n    NOT cs_order_number IN (\n      SELECT DISTINCT\n        cr_order_number\n      FROM catalog_returns\n    )\n)\nSELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM catalog_sales AS cs1, date_dim, customer_address, call_center, orders_with_multiple_warehouses AS omw, orders_without_returns AS owr\nWHERE\n  d_date BETWEEN '2002-4-01' AND (\n    CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY\n  )\n  AND cs1.cs_ship_date_sk = d_date_sk\n  AND cs1.cs_ship_addr_sk = ca_address_sk\n  AND ca_state = 'WV'\n  AND cs1.cs_call_center_sk = cc_call_center_sk\n  AND cc_county IN (\n    'Ziebach County',\n    'Luce County',\n    'Richland County',\n    'Daviess County',\n    'Barrow County'\n  )\n  AND cs1.cs_order_number = omw.cs_order_number\n  AND cs1.cs_order_number = owr.cs_order_number\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 28911,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1511,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 1.1511,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_date BETWEEN '2002-4-01' AND (\n      CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY\n    )\n)\nSELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM catalog_sales AS cs1, filtered_dates, customer_address, call_center\nWHERE\n  cs1.cs_ship_date_sk = filtered_dates.d_date_sk\n  AND cs1.cs_ship_addr_sk = ca_address_sk\n  AND ca_state = 'WV'\n  AND cs1.cs_call_center_sk = cc_call_center_sk\n  AND cc_county IN (\n    'Ziebach County',\n    'Luce County',\n    'Richland County',\n    'Daviess County',\n    'Barrow County'\n  )\n  AND EXISTS(\n    SELECT\n      *\n    FROM catalog_sales AS cs2\n    WHERE\n      cs1.cs_order_number = cs2.cs_order_number\n      AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\n  )\n  AND NOT EXISTS(\n    SELECT\n      *\n    FROM catalog_returns AS cr1\n    WHERE\n      cs1.cs_order_number = cr1.cr_order_number\n  )\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 26203,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.3538,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 1.3538,
      "output_sql": "SELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM call_center, customer_address, date_dim, catalog_sales AS cs1\nWHERE\n  d_date BETWEEN '2002-4-01' AND (\n    CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY\n  )\n  AND cs1.cs_ship_date_sk = d_date_sk\n  AND cs1.cs_ship_addr_sk = ca_address_sk\n  AND ca_state = 'WV'\n  AND cs1.cs_call_center_sk = cc_call_center_sk\n  AND cc_county IN (\n    'Ziebach County',\n    'Luce County',\n    'Richland County',\n    'Daviess County',\n    'Barrow County'\n  )\n  AND EXISTS(\n    SELECT\n      *\n    FROM catalog_sales AS cs2\n    WHERE\n      cs1.cs_order_number = cs2.cs_order_number\n      AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\n  )\n  AND NOT EXISTS(\n    SELECT\n      *\n    FROM catalog_returns AS cr1\n    WHERE\n      cs1.cs_order_number = cr1.cr_order_number\n  )\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 41938,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "WITH combined_cte AS (\n  SELECT\n    *\n  FROM branch1_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch2_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch3_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch4_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch5_cte\n)\nSELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM combined_cte AS cs1\nWHERE\n  EXISTS(\n    SELECT\n      *\n    FROM catalog_sales AS cs2\n    WHERE\n      cs1.cs_order_number = cs2.cs_order_number\n      AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\n  )\n  AND NOT EXISTS(\n    SELECT\n      *\n    FROM catalog_returns AS cr1\n    WHERE\n      cs1.cs_order_number = cr1.cr_order_number\n  )\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 60317,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 0.3381,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.0,
      "output_sql": "SELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM catalog_sales AS cs1, date_dim, customer_address, call_center\nWHERE\n  cs1.cs_ship_date_sk = d_date_sk\n  AND cs1.cs_ship_addr_sk = ca_address_sk\n  AND cs1.cs_call_center_sk = cc_call_center_sk\n  AND EXISTS(\n    SELECT\n      *\n    FROM catalog_sales AS cs2\n    WHERE\n      cs1.cs_order_number = cs2.cs_order_number\n      AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\n  )\n  AND NOT EXISTS(\n    SELECT\n      *\n    FROM catalog_returns AS cr1\n    WHERE\n      cs1.cs_order_number = cr1.cr_order_number\n  )\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 33385,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1618,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 1.1618,
      "output_sql": "SELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM catalog_sales AS cs1, date_dim, customer_address, call_center\nWHERE\n  d_date BETWEEN '2002-4-01' AND (\n    CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY\n  )\n  AND cs1.cs_ship_date_sk = d_date_sk\n  AND cs1.cs_ship_addr_sk = ca_address_sk\n  AND ca_state = 'WV'\n  AND cs1.cs_call_center_sk = cc_call_center_sk\n  AND cc_county IN (\n    'Ziebach County',\n    'Luce County',\n    'Richland County',\n    'Daviess County',\n    'Barrow County'\n  )\n  AND EXISTS(\n    SELECT\n      *\n    FROM catalog_sales AS cs2\n    WHERE\n      cs1.cs_order_number = cs2.cs_order_number\n      AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\n  )\n  AND NOT EXISTS(\n    SELECT\n      *\n    FROM catalog_returns AS cr1\n    WHERE\n      cs1.cs_order_number = cr1.cr_order_number\n  )\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 17,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9322,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.2,
      "output_sql": "select \n   count(distinct cs_order_number) as \"order count\"\n  ,sum(cs_ext_ship_cost) as \"total shipping cost\"\n  ,sum(cs_net_profit) as \"total net profit\"\nfrom\n   catalog_sales cs1\n  ,date_dim\n  ,customer_address\n  ,call_center\nwhere\n    d_date between '2002-4-01' and \n           (cast('2002-4-01' as date) + INTERVAL 60 DAY)\nand cs1.cs_ship_date_sk = d_date_sk\nand cs1.cs_ship_addr_sk = ca_address_sk\nand ca_state = 'WV'\nand cs1.cs_call_center_sk = cc_call_center_sk\nand cc_county in ('Ziebach County','Luce County','Richland County','Daviess County',\n                  'Barrow County'\n)\nand exists (select *\n            from catalog_sales cs2\n            where cs1.cs_order_number = cs2.cs_order_number\n              and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk)\nand not exists(select *\n               from catalog_returns cr1\n               where cs1.cs_order_number = cr1.cr_order_number)\norder by count(distinct cs_order_number)\n LIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 25416,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.0,
      "output_sql": "SELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM catalog_sales AS cs1, date_dim, customer_address, call_center, multi_warehouse_orders AS mwo\nWHERE\n  d_date BETWEEN '2002-4-01' AND (\n    CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY\n  )\n  AND cs1.cs_ship_date_sk = d_date_sk\n  AND cs1.cs_ship_addr_sk = ca_address_sk\n  AND ca_state = 'WV'\n  AND cs1.cs_call_center_sk = cc_call_center_sk\n  AND cc_county IN (\n    'Ziebach County',\n    'Luce County',\n    'Richland County',\n    'Daviess County',\n    'Barrow County'\n  )\n  AND cs1.cs_order_number = mwo.cs_order_number\n  AND NOT EXISTS(\n    SELECT\n      *\n    FROM returned_orders AS ro\n    WHERE\n      cs1.cs_order_number = ro.cr_order_number\n  )\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 21677,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8555,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.2,
      "output_sql": "SELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM catalog_sales AS cs1, date_dim, customer_address, call_center\nWHERE\n  d_date BETWEEN '2002-4-01' AND (\n    CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY\n  )\n  AND cs1.cs_ship_date_sk = d_date_sk\n  AND cs1.cs_ship_addr_sk = ca_address_sk\n  AND ca_state = 'WV'\n  AND cs1.cs_call_center_sk = cc_call_center_sk\n  AND cc_county IN (\n    'Ziebach County',\n    'Luce County',\n    'Richland County',\n    'Daviess County',\n    'Barrow County'\n  )\n  AND EXISTS(\n    SELECT\n      *\n    FROM catalog_sales AS cs2\n    WHERE\n      cs1.cs_order_number = cs2.cs_order_number\n      AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\n  )\n  AND NOT EXISTS(\n    SELECT\n      *\n    FROM catalog_returns AS cr1\n    WHERE\n      cs1.cs_order_number = cr1.cr_order_number\n  )\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 14429,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0301,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.5,
      "output_sql": "SELECT\n  COUNT(DISTINCT cs_order_number) AS \"order count\",\n  SUM(cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs_net_profit) AS \"total net profit\"\nFROM catalog_sales AS cs1, date_dim, customer_address, call_center\nWHERE\n  d_date BETWEEN '2002-4-01' AND (\n    CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY\n  )\n  AND cs1.cs_ship_date_sk = d_date_sk\n  AND cs1.cs_ship_addr_sk = ca_address_sk\n  AND ca_state = 'WV'\n  AND cs1.cs_call_center_sk = cc_call_center_sk\n  AND cc_county IN (\n    'Ziebach County',\n    'Luce County',\n    'Richland County',\n    'Daviess County',\n    'Barrow County'\n  )\n  AND EXISTS(\n    SELECT\n      *\n    FROM catalog_sales AS cs2\n    WHERE\n      cs1.cs_order_number = cs2.cs_order_number\n      AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\n  )\n  AND NOT EXISTS(\n    SELECT\n      *\n    FROM catalog_returns AS cr1\n    WHERE\n      cs1.cs_order_number = cr1.cr_order_number\n  )\nORDER BY\n  COUNT(DISTINCT cs_order_number)\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "date_cte_isolate"
      ],
      "transform_id": "flatten_subq",
      "duration_ms": 23576,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.2036,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_date BETWEEN '2002-4-01' AND (\n      CAST('2002-4-01' AS DATE) + INTERVAL '60' DAY\n    )\n)\nSELECT\n  COUNT(DISTINCT cs1.cs_order_number) AS \"order count\",\n  SUM(cs1.cs_ext_ship_cost) AS \"total shipping cost\",\n  SUM(cs1.cs_net_profit) AS \"total net profit\"\nFROM catalog_sales AS cs1\nINNER JOIN filtered_dates\n  ON cs1.cs_ship_date_sk = filtered_dates.d_date_sk\nINNER JOIN customer_address\n  ON cs1.cs_ship_addr_sk = ca_address_sk\nINNER JOIN call_center\n  ON cs1.cs_call_center_sk = cc_call_center_sk\nINNER JOIN catalog_sales AS cs2\n  ON cs1.cs_order_number = cs2.cs_order_number\n  AND cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk\nLEFT JOIN catalog_returns AS cr1\n  ON cs1.cs_order_number = cr1.cr_order_number\nWHERE\n  ca_state = 'WV'\n  AND cc_county IN (\n    'Ziebach County',\n    'Luce County',\n    'Richland County',\n    'Daviess County',\n    'Barrow County'\n  )\n  AND cr1.cr_order_number IS NULL\nGROUP BY\n  cs1.cs_order_number\nORDER BY\n  COUNT(DISTINCT cs1.cs_order_number)\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0167,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.18,
          "visits": 1,
          "avg_reward": 1.1511,
          "is_valid": true,
          "speedup": 1.1511,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.3871,
          "visits": 1,
          "avg_reward": 1.3538,
          "is_valid": true,
          "speedup": 1.3538,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.1844,
          "visits": 1,
          "avg_reward": 1.1511,
          "is_valid": true,
          "speedup": 1.1511,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.4656,
          "visits": 1,
          "avg_reward": 1.3538,
          "is_valid": true,
          "speedup": 1.3538,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.1884,
          "visits": 1,
          "avg_reward": 1.1511,
          "is_valid": true,
          "speedup": 1.1511,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2449,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.3381,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.4763,
          "visits": 1,
          "avg_reward": 1.3538,
          "is_valid": true,
          "speedup": 1.3538,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.1919,
          "visits": 1,
          "avg_reward": 1.1511,
          "is_valid": true,
          "speedup": 1.1511,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2646,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.3381,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.4861,
          "visits": 1,
          "avg_reward": 1.3538,
          "is_valid": true,
          "speedup": 1.3538,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.1952,
          "visits": 1,
          "avg_reward": 1.1511,
          "is_valid": true,
          "speedup": 1.1511,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2059,
          "visits": 1,
          "avg_reward": 1.1618,
          "is_valid": true,
          "speedup": 1.1618,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.3381,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.4952,
          "visits": 1,
          "avg_reward": 1.3538,
          "is_valid": true,
          "speedup": 1.3538,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9322,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.1982,
          "visits": 1,
          "avg_reward": 1.1511,
          "is_valid": true,
          "speedup": 1.1511,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2089,
          "visits": 1,
          "avg_reward": 1.1618,
          "is_valid": true,
          "speedup": 1.1618,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.45,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.3381,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.6538,
          "visits": 1,
          "avg_reward": 1.3538,
          "is_valid": true,
          "speedup": 1.3538,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.15,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9322,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.2011,
          "visits": 1,
          "avg_reward": 1.1511,
          "is_valid": true,
          "speedup": 1.1511,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2118,
          "visits": 1,
          "avg_reward": 1.1618,
          "is_valid": true,
          "speedup": 1.1618,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7906,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.3381,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.8281,
          "visits": 1,
          "avg_reward": 1.3538,
          "is_valid": true,
          "speedup": 1.3538,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3162,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3581,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8555,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9322,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.2038,
          "visits": 1,
          "avg_reward": 1.1511,
          "is_valid": true,
          "speedup": 1.1511,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2145,
          "visits": 1,
          "avg_reward": 1.1618,
          "is_valid": true,
          "speedup": 1.1618,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.1608,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4975,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.9803,
          "visits": 1,
          "avg_reward": 1.1511,
          "is_valid": true,
          "speedup": 1.1511
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.5196,
          "visits": 1,
          "avg_reward": 1.3538,
          "is_valid": true,
          "speedup": 1.3538
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.3317,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.3381
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2171,
          "visits": 1,
          "avg_reward": 1.1618,
          "is_valid": true,
          "speedup": 1.1618
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9322
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8555
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5553,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0301
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "date_cte_isolate"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 12,
    "avg_reward": 0.3806,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.5755,
        "is_valid": true,
        "speedup": 1.1511,
        "error": null,
        "children": {
          "flatten_subq": {
            "transforms": [
              "date_cte_isolate",
              "flatten_subq"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 1.2036,
            "error": null
          }
        }
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.3538,
        "is_valid": true,
        "speedup": 1.3538,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0.3381,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.1618,
        "is_valid": true,
        "speedup": 1.1618,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9322,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.8555,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0301,
        "error": null
      }
    }
  }
}