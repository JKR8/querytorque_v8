{
  "stats": {
    "total_iterations": 20,
    "tree_size": 18,
    "successful_expansions": 17,
    "failed_expansions": 0,
    "validation_calls": 17,
    "llm_ranking_calls": 30,
    "root_visits": 20,
    "total_attempts": 17
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 31032,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0214,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.5,
      "output_sql": "WITH filtered_dates_d1 AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_quarter_name = '2001Q1'\n), filtered_dates_d2 AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n), filtered_dates_d3 AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n)\nSELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales, store_returns, catalog_sales, filtered_dates_d1 AS d1, filtered_dates_d2 AS d2, filtered_dates_d3 AS d3, store, item\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 34126,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0441,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM date_dim AS d1, store, item, store_sales, date_dim AS d2, store_returns, date_dim AS d3, catalog_sales\nWHERE\n  d1.d_quarter_name = '2001Q1'\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND d2.d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\n  AND d3.d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 97646,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.0,
      "output_sql": "WITH combined_cte AS (\n  SELECT\n    *\n  FROM branch1_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch2_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch3_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch4_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch5_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch6_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch7_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch8_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch9_cte\n)\nSELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM combined_cte\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 29000,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9707,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales, store_returns, catalog_sales, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name = '2001Q1'\n) AS d1, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n) AS d2, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n) AS d3, store, item\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 37441,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(CASE WHEN d1.is_d1 = 1 THEN ss_quantity END) AS store_sales_quantitycount,\n  AVG(CASE WHEN d1.is_d1 = 1 THEN ss_quantity END) AS store_sales_quantityave,\n  STDDEV_SAMP(CASE WHEN d1.is_d1 = 1 THEN ss_quantity END) AS store_sales_quantitystdev,\n  STDDEV_SAMP(CASE WHEN d1.is_d1 = 1 THEN ss_quantity END) / AVG(CASE WHEN d1.is_d1 = 1 THEN ss_quantity END) AS store_sales_quantitycov,\n  COUNT(CASE WHEN d2.is_d2_or_d3 = 1 THEN sr_return_quantity END) AS store_returns_quantitycount,\n  AVG(CASE WHEN d2.is_d2_or_d3 = 1 THEN sr_return_quantity END) AS store_returns_quantityave,\n  STDDEV_SAMP(CASE WHEN d2.is_d2_or_d3 = 1 THEN sr_return_quantity END) AS store_returns_quantitystdev,\n  STDDEV_SAMP(CASE WHEN d2.is_d2_or_d3 = 1 THEN sr_return_quantity END) / AVG(CASE WHEN d2.is_d2_or_d3 = 1 THEN sr_return_quantity END) AS store_returns_quantitycov,\n  COUNT(CASE WHEN d3.is_d2_or_d3 = 1 THEN cs_quantity END) AS catalog_sales_quantitycount,\n  AVG(CASE WHEN d3.is_d2_or_d3 = 1 THEN cs_quantity END) AS catalog_sales_quantityave,\n  STDDEV_SAMP(CASE WHEN d3.is_d2_or_d3 = 1 THEN cs_quantity END) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(CASE WHEN d3.is_d2_or_d3 = 1 THEN cs_quantity END) / AVG(CASE WHEN d3.is_d2_or_d3 = 1 THEN cs_quantity END) AS catalog_sales_quantitycov\nFROM store_sales\nJOIN date_dim_combined AS d1\n  ON d1.d_date_sk = ss_sold_date_sk\nJOIN item\n  ON i_item_sk = ss_item_sk\nJOIN store\n  ON s_store_sk = ss_store_sk\nJOIN store_returns\n  ON ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\nJOIN date_dim_combined AS d2\n  ON sr_returned_date_sk = d2.d_date_sk\nJOIN catalog_sales\n  ON sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk\nJOIN date_dim_combined AS d3\n  ON cs_sold_date_sk = d3.d_date_sk\nWHERE\n  d1.is_d1 = 1 AND d2.is_d2_or_d3 = 1 AND d3.is_d2_or_d3 = 1\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 57885,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  SUM(ssa.store_sales_quantitycount) AS store_sales_quantitycount,\n  AVG(ssa.store_sales_quantityave) AS store_sales_quantityave,\n  STDDEV_SAMP(ssa.store_sales_quantitystdev) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ssa.store_sales_quantitystdev) / AVG(ssa.store_sales_quantityave) AS store_sales_quantitycov,\n  SUM(sra.store_returns_quantitycount) AS store_returns_quantitycount,\n  AVG(sra.store_returns_quantityave) AS store_returns_quantityave,\n  STDDEV_SAMP(sra.store_returns_quantitystdev) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sra.store_returns_quantitystdev) / AVG(sra.store_returns_quantityave) AS store_returns_quantitycov,\n  SUM(csa.catalog_sales_quantitycount) AS catalog_sales_quantitycount,\n  AVG(csa.catalog_sales_quantityave) AS catalog_sales_quantityave,\n  STDDEV_SAMP(csa.catalog_sales_quantitystdev) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(csa.catalog_sales_quantitystdev) / AVG(csa.catalog_sales_quantityave) AS catalog_sales_quantitycov\nFROM store_sales_agg AS ssa\nJOIN store_returns_agg AS sra\n  ON ssa.ss_customer_sk = sra.sr_customer_sk\n  AND ssa.ss_item_sk = sra.sr_item_sk\n  AND ssa.ss_ticket_number = sra.sr_ticket_number\nJOIN catalog_sales_agg AS csa\n  ON sra.sr_customer_sk = csa.cs_bill_customer_sk AND sra.sr_item_sk = csa.cs_item_sk\nJOIN store\n  ON s_store_sk = ssa.ss_store_sk\nJOIN item\n  ON i_item_sk = ssa.ss_item_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 21,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9497,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.2,
      "output_sql": "select i_item_id\n       ,i_item_desc\n       ,s_state\n       ,count(ss_quantity) as store_sales_quantitycount\n       ,avg(ss_quantity) as store_sales_quantityave\n       ,stddev_samp(ss_quantity) as store_sales_quantitystdev\n       ,stddev_samp(ss_quantity)/avg(ss_quantity) as store_sales_quantitycov\n       ,count(sr_return_quantity) as store_returns_quantitycount\n       ,avg(sr_return_quantity) as store_returns_quantityave\n       ,stddev_samp(sr_return_quantity) as store_returns_quantitystdev\n       ,stddev_samp(sr_return_quantity)/avg(sr_return_quantity) as store_returns_quantitycov\n       ,count(cs_quantity) as catalog_sales_quantitycount ,avg(cs_quantity) as catalog_sales_quantityave\n       ,stddev_samp(cs_quantity) as catalog_sales_quantitystdev\n       ,stddev_samp(cs_quantity)/avg(cs_quantity) as catalog_sales_quantitycov\n from store_sales\n     ,store_returns\n     ,catalog_sales\n     ,date_dim d1\n     ,date_dim d2\n     ,date_dim d3\n     ,store\n     ,item\n where d1.d_quarter_name = '2001Q1'\n   and d1.d_date_sk = ss_sold_date_sk\n   and i_item_sk = ss_item_sk\n   and s_store_sk = ss_store_sk\n   and ss_customer_sk = sr_customer_sk\n   and ss_item_sk = sr_item_sk\n   and ss_ticket_number = sr_ticket_number\n   and sr_returned_date_sk = d2.d_date_sk\n   and d2.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n   and sr_customer_sk = cs_bill_customer_sk\n   and sr_item_sk = cs_item_sk\n   and cs_sold_date_sk = d3.d_date_sk\n   and d3.d_quarter_name in ('2001Q1','2001Q2','2001Q3')\n group by i_item_id\n         ,i_item_desc\n         ,s_state\n order by i_item_id\n         ,i_item_desc\n         ,s_state\n LIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 52464,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 0.2742,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.0,
      "output_sql": "SELECT i_item_id\n       ,i_item_desc\n       ,s_state\n       ,COUNT(ss_quantity) AS store_sales_quantitycount\n       ,AVG(ss_quantity) AS store_sales_quantityave\n       ,STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev\n       ,STDDEV_SAMP(ss_quantity)/AVG(ss_quantity) AS store_sales_quantitycov\n       ,COUNT(sr_return_quantity) AS store_returns_quantitycount\n       ,AVG(sr_return_quantity) AS store_returns_quantityave\n       ,STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev\n       ,STDDEV_SAMP(sr_return_quantity)/AVG(sr_return_quantity) AS store_returns_quantitycov\n       ,COUNT(cs_quantity) AS catalog_sales_quantitycount\n       ,AVG(cs_quantity) AS catalog_sales_quantityave\n       ,STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev\n       ,STDDEV_SAMP(cs_quantity)/AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales\nJOIN date_dim d1 ON d1.d_date_sk = ss_sold_date_sk AND d1.d_quarter_name = '2001Q1'\nJOIN item ON i_item_sk = ss_item_sk\nJOIN store ON s_store_sk = ss_store_sk\nLEFT JOIN store_returns ON ss_customer_sk = sr_customer_sk \n                        AND ss_item_sk = sr_item_sk \n                        AND ss_ticket_number = sr_ticket_number\nLEFT JOIN date_dim d2 ON sr_returned_date_sk = d2.d_date_sk \n                      AND d2.d_quarter_name IN ('2001Q1','2001Q2','2001Q3')\nLEFT JOIN catalog_sales ON sr_customer_sk = cs_bill_customer_sk \n                        AND sr_item_sk = cs_item_sk\nLEFT JOIN date_dim d3 ON cs_sold_date_sk = d3.d_date_sk \n                      AND d3.d_quarter_name IN ('2001Q1','2001Q2','2001Q3')\nGROUP BY i_item_id\n         ,i_item_desc\n         ,s_state\nORDER BY i_item_id\n         ,i_item_desc\n         ,s_state\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 52249,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales\nJOIN filtered_d1 AS d1\n  ON d1.d_date_sk = ss_sold_date_sk\nJOIN store_returns\n  ON ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\nJOIN filtered_d2_d3 AS d2\n  ON sr_returned_date_sk = d2.d_date_sk\nJOIN catalog_sales\n  ON sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk\nJOIN filtered_d2_d3 AS d3\n  ON cs_sold_date_sk = d3.d_date_sk\nJOIN store\n  ON s_store_sk = ss_store_sk\nJOIN item\n  ON i_item_sk = ss_item_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 23324,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2889,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 1.2889,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales, store_returns, catalog_sales, date_dim AS d1, date_dim AS d2, date_dim AS d3, store, item\nWHERE\n  d1.d_quarter_name = '2001Q1'\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND d2.d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\n  AND d3.d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 36659,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1456,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 1.1456,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales, store_returns, catalog_sales, date_dim AS d1, date_dim AS d2, store, item\nWHERE\n  d1.d_quarter_name = '2001Q1'\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND d2.d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d2.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "inline_cte"
      ],
      "transform_id": "push_pred",
      "duration_ms": 29019,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.4566,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.4566,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales, store_returns, catalog_sales, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name = '2001Q1'\n) AS d1, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n) AS d2, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n) AS d3, store, item\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "inline_cte",
        "push_pred"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 43647,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(CASE WHEN d1.is_q1_only = 1 THEN ss_quantity END) AS store_sales_quantitycount,\n  AVG(CASE WHEN d1.is_q1_only = 1 THEN ss_quantity END) AS store_sales_quantityave,\n  STDDEV_SAMP(CASE WHEN d1.is_q1_only = 1 THEN ss_quantity END) AS store_sales_quantitystdev,\n  STDDEV_SAMP(CASE WHEN d1.is_q1_only = 1 THEN ss_quantity END) / AVG(CASE WHEN d1.is_q1_only = 1 THEN ss_quantity END) AS store_sales_quantitycov,\n  COUNT(CASE WHEN d2.is_all_quarters = 1 THEN sr_return_quantity END) AS store_returns_quantitycount,\n  AVG(CASE WHEN d2.is_all_quarters = 1 THEN sr_return_quantity END) AS store_returns_quantityave,\n  STDDEV_SAMP(CASE WHEN d2.is_all_quarters = 1 THEN sr_return_quantity END) AS store_returns_quantitystdev,\n  STDDEV_SAMP(CASE WHEN d2.is_all_quarters = 1 THEN sr_return_quantity END) / AVG(CASE WHEN d2.is_all_quarters = 1 THEN sr_return_quantity END) AS store_returns_quantitycov,\n  COUNT(CASE WHEN d3.is_all_quarters = 1 THEN cs_quantity END) AS catalog_sales_quantitycount,\n  AVG(CASE WHEN d3.is_all_quarters = 1 THEN cs_quantity END) AS catalog_sales_quantityave,\n  STDDEV_SAMP(CASE WHEN d3.is_all_quarters = 1 THEN cs_quantity END) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(CASE WHEN d3.is_all_quarters = 1 THEN cs_quantity END) / AVG(CASE WHEN d3.is_all_quarters = 1 THEN cs_quantity END) AS catalog_sales_quantitycov\nFROM store_sales, store_returns, catalog_sales, (\n  SELECT\n    d_date_sk,\n    is_q1_only,\n    is_all_quarters\n  FROM combined_scan\n) AS d1, (\n  SELECT\n    d_date_sk,\n    is_q1_only,\n    is_all_quarters\n  FROM combined_scan\n) AS d2, (\n  SELECT\n    d_date_sk,\n    is_q1_only,\n    is_all_quarters\n  FROM combined_scan\n) AS d3, store, item\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "remove_redundant"
      ],
      "transform_id": "push_pred",
      "duration_ms": 30112,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8137,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales, store_returns, catalog_sales, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name = '2001Q1'\n) AS d1, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n) AS d2, store, item\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d2.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 15,
      "parent_path": [
        "inline_cte",
        "push_pred"
      ],
      "transform_id": "materialize_cte",
      "duration_ms": 24230,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM store_sales, store_returns, catalog_sales, date_dim_q1 AS d1, date_dim_q123 AS d2, date_dim_q123 AS d3, store, item\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d3.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 16,
      "parent_path": [
        "remove_redundant"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 92743,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 2.2599,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 2.2599,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM date_dim AS d1, date_dim AS d2, store, item, store_sales, store_returns, catalog_sales\nWHERE\n  d1.d_quarter_name = '2001Q1'\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND d2.d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d2.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    },
    {
      "iteration": 17,
      "parent_path": [
        "remove_redundant",
        "reorder_join"
      ],
      "transform_id": "push_pred",
      "duration_ms": 27185,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.5501,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.5501,
      "output_sql": "SELECT\n  i_item_id,\n  i_item_desc,\n  s_state,\n  COUNT(ss_quantity) AS store_sales_quantitycount,\n  AVG(ss_quantity) AS store_sales_quantityave,\n  STDDEV_SAMP(ss_quantity) AS store_sales_quantitystdev,\n  STDDEV_SAMP(ss_quantity) / AVG(ss_quantity) AS store_sales_quantitycov,\n  COUNT(sr_return_quantity) AS store_returns_quantitycount,\n  AVG(sr_return_quantity) AS store_returns_quantityave,\n  STDDEV_SAMP(sr_return_quantity) AS store_returns_quantitystdev,\n  STDDEV_SAMP(sr_return_quantity) / AVG(sr_return_quantity) AS store_returns_quantitycov,\n  COUNT(cs_quantity) AS catalog_sales_quantitycount,\n  AVG(cs_quantity) AS catalog_sales_quantityave,\n  STDDEV_SAMP(cs_quantity) AS catalog_sales_quantitystdev,\n  STDDEV_SAMP(cs_quantity) / AVG(cs_quantity) AS catalog_sales_quantitycov\nFROM (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name = '2001Q1'\n) AS d1, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_quarter_name IN ('2001Q1', '2001Q2', '2001Q3')\n) AS d2, store, item, store_sales, store_returns, catalog_sales\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND ss_customer_sk = sr_customer_sk\n  AND ss_item_sk = sr_item_sk\n  AND ss_ticket_number = sr_ticket_number\n  AND sr_returned_date_sk = d2.d_date_sk\n  AND sr_customer_sk = cs_bill_customer_sk\n  AND sr_item_sk = cs_item_sk\n  AND cs_sold_date_sk = d2.d_date_sk\nGROUP BY\n  i_item_id,\n  i_item_desc,\n  s_state\nORDER BY\n  i_item_id,\n  i_item_desc,\n  s_state\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5167,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5236,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5236,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5289,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5289,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3225,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6323,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4828,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.15,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9906,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9743,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3162,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4471,
          "visits": 1,
          "avg_reward": 1.2889,
          "is_valid": true,
          "speedup": 1.2889,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5904,
          "visits": 1,
          "avg_reward": 1.2889,
          "is_valid": true,
          "speedup": 1.2889
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.4471,
          "visits": 1,
          "avg_reward": 1.1456,
          "is_valid": true,
          "speedup": 1.1456
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5827,
          "visits": 2,
          "avg_reward": 1.3728,
          "is_valid": true,
          "speedup": 1.2889
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.4605,
          "visits": 1,
          "avg_reward": 1.1456,
          "is_valid": true,
          "speedup": 1.1456
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.5981,
          "visits": 1,
          "avg_reward": 1.4566,
          "is_valid": true,
          "speedup": 1.4566,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "inline_cte",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.0791,
          "visits": 3,
          "avg_reward": 0.9152,
          "is_valid": true,
          "speedup": 1.2889
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.4734,
          "visits": 1,
          "avg_reward": 1.1456,
          "is_valid": true,
          "speedup": 1.1456
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.0853,
          "visits": 3,
          "avg_reward": 0.9152,
          "is_valid": true,
          "speedup": 1.2889
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8996,
          "visits": 2,
          "avg_reward": 0.6728,
          "is_valid": true,
          "speedup": 1.1456
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8438,
          "visits": 2,
          "avg_reward": 0.7283,
          "is_valid": true,
          "speedup": 1.4566,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "inline_cte",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.495,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5521,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5521,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8272,
          "visits": 4,
          "avg_reward": 0.6864,
          "is_valid": true,
          "speedup": 1.2889
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9075,
          "visits": 2,
          "avg_reward": 0.6728,
          "is_valid": true,
          "speedup": 1.1456
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3414,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8137,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8319,
          "visits": 4,
          "avg_reward": 0.6864,
          "is_valid": true,
          "speedup": 1.2889
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.3836,
          "visits": 3,
          "avg_reward": 1.2018,
          "is_valid": true,
          "speedup": 1.1456
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3732,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8137,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 2.4331,
          "visits": 1,
          "avg_reward": 2.2599,
          "is_valid": true,
          "speedup": 2.2599,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "remove_redundant",
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8363,
          "visits": 4,
          "avg_reward": 0.6864,
          "is_valid": true,
          "speedup": 1.2889
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.4388,
          "visits": 4,
          "avg_reward": 1.2889,
          "is_valid": true,
          "speedup": 1.1456
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8137,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 2.0383,
          "visits": 2,
          "avg_reward": 1.905,
          "is_valid": true,
          "speedup": 2.2599,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "remove_redundant",
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.7072,
          "visits": 1,
          "avg_reward": 1.5501,
          "is_valid": true,
          "speedup": 1.5501,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3849,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "remove_redundant",
        "reorder_join",
        "push_pred"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8407,
          "visits": 4,
          "avg_reward": 0.6864,
          "is_valid": true,
          "speedup": 1.2889
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.1597,
          "visits": 5,
          "avg_reward": 1.0311,
          "is_valid": true,
          "speedup": 1.1456
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8137,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.3818,
          "visits": 3,
          "avg_reward": 1.27,
          "is_valid": true,
          "speedup": 2.2599,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "remove_redundant",
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9033,
          "visits": 2,
          "avg_reward": 0.775,
          "is_valid": true,
          "speedup": 1.5501,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4444,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "remove_redundant",
        "reorder_join",
        "push_pred"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8963,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0214
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8963,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0441
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9707
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5963,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.2742
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3963,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8449,
          "visits": 4,
          "avg_reward": 0.6864,
          "is_valid": true,
          "speedup": 1.2889
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9725,
          "visits": 6,
          "avg_reward": 0.8593,
          "is_valid": true,
          "speedup": 1.1456
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4449,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8137,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.0505,
          "visits": 4,
          "avg_reward": 0.9525,
          "is_valid": true,
          "speedup": 2.2599,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "remove_redundant",
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6278,
          "visits": 3,
          "avg_reward": 0.5167,
          "is_valid": true,
          "speedup": 1.5501,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4969,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4969,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4969,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4969,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4969,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4969,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4969,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4969,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "remove_redundant",
        "reorder_join",
        "push_pred"
      ],
      "candidates": [],
      "selected": "",
      "reason": "max_depth_reached"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 20,
    "avg_reward": 0.4651,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0214,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0441,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9707,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9497,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0.2742,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 4,
        "avg_reward": 0.6864,
        "is_valid": true,
        "speedup": 1.2889,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "inline_cte",
              "push_pred"
            ],
            "depth": 2,
            "visits": 3,
            "avg_reward": 0.4855,
            "is_valid": true,
            "speedup": 1.4566,
            "error": null,
            "children": {
              "consolidate_scans": {
                "transforms": [
                  "inline_cte",
                  "push_pred",
                  "consolidate_scans"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.0,
                "is_valid": false,
                "speedup": 0,
                "error": null
              },
              "materialize_cte": {
                "transforms": [
                  "inline_cte",
                  "push_pred",
                  "materialize_cte"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.0,
                "is_valid": false,
                "speedup": 0,
                "error": null
              }
            }
          }
        }
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 7,
        "avg_reward": 0.7365,
        "is_valid": true,
        "speedup": 1.1456,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "remove_redundant",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.8137,
            "error": null
          },
          "reorder_join": {
            "transforms": [
              "remove_redundant",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 5,
            "avg_reward": 0.762,
            "is_valid": true,
            "speedup": 2.2599,
            "error": null,
            "children": {
              "push_pred": {
                "transforms": [
                  "remove_redundant",
                  "reorder_join",
                  "push_pred"
                ],
                "depth": 3,
                "visits": 4,
                "avg_reward": 0.3875,
                "is_valid": true,
                "speedup": 1.5501,
                "error": null
              }
            }
          }
        }
      }
    }
  }
}