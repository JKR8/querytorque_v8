{
  "stats": {
    "total_iterations": 12,
    "tree_size": 13,
    "successful_expansions": 12,
    "failed_expansions": 0,
    "validation_calls": 12,
    "llm_ranking_calls": 13,
    "root_visits": 12,
    "total_attempts": 12
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 38569,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9779,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.2,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year = 2002 AND d_moy = 1\n), ss AS (\n  SELECT\n    i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM store_sales, filtered_dates, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), cs AS (\n  SELECT\n    i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM catalog_sales, filtered_dates, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), ws AS (\n  SELECT\n    i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM web_sales, filtered_dates, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND ws_item_sk = i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss\n  UNION ALL\n  SELECT\n    *\n  FROM cs\n  UNION ALL\n  SELECT\n    *\n  FROM ws\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 42749,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH combined_sales AS (\n  SELECT\n    i_manufact_id,\n    ss_sales AS total_sales\n  FROM combined_sales\n  WHERE\n    ss_sales > 0\n  UNION ALL\n  SELECT\n    i_manufact_id,\n    cs_sales AS total_sales\n  FROM combined_sales\n  WHERE\n    cs_sales > 0\n  UNION ALL\n  SELECT\n    i_manufact_id,\n    ws_sales AS total_sales\n  FROM combined_sales\n  WHERE\n    ws_sales > 0\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM combined_sales\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 47760,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.638,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.2,
      "output_sql": "WITH ss AS (\n  SELECT\n    i.i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM store_sales, date_dim, customer_address, item AS i\n  INNER JOIN (\n    SELECT DISTINCT\n      i_manufact_id\n    FROM item\n    WHERE\n      i_category IN ('Home')\n  ) AS filter_item\n    ON i.i_manufact_id = filter_item.i_manufact_id\n  WHERE\n    ss_item_sk = i.i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i.i_manufact_id\n), cs AS (\n  SELECT\n    i.i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM catalog_sales, date_dim, customer_address, item AS i\n  INNER JOIN (\n    SELECT DISTINCT\n      i_manufact_id\n    FROM item\n    WHERE\n      i_category IN ('Home')\n  ) AS filter_item\n    ON i.i_manufact_id = filter_item.i_manufact_id\n  WHERE\n    cs_item_sk = i.i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i.i_manufact_id\n), ws AS (\n  SELECT\n    i.i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM web_sales, date_dim, customer_address, item AS i\n  INNER JOIN (\n    SELECT DISTINCT\n      i_manufact_id\n    FROM item\n    WHERE\n      i_category IN ('Home')\n  ) AS filter_item\n    ON i.i_manufact_id = filter_item.i_manufact_id\n  WHERE\n    ws_item_sk = i.i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i.i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss\n  UNION ALL\n  SELECT\n    *\n  FROM cs\n  UNION ALL\n  SELECT\n    *\n  FROM ws\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 74444,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1075,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 1.1075,
      "output_sql": "with item_filter as (\n    select i_manufact_id\n    from item\n    where i_category in ('Home')\n),\nss_branch1 as (\n    select i_manufact_id, sum(ss_ext_sales_price) total_sales\n    from store_sales, date_dim, customer_address, item\n    where ss_item_sk = i_item_sk\n      and ss_sold_date_sk = d_date_sk\n      and d_year = 2002\n      and d_moy = 1\n      and ss_addr_sk = ca_address_sk\n      and ca_gmt_offset = -5\n      and i_manufact_id in (select i_manufact_id from item_filter)\n    group by i_manufact_id\n),\ncs_branch1 as (\n    select i_manufact_id, sum(cs_ext_sales_price) total_sales\n    from catalog_sales, date_dim, customer_address, item\n    where cs_item_sk = i_item_sk\n      and cs_sold_date_sk = d_date_sk\n      and d_year = 2002\n      and d_moy = 1\n      and cs_bill_addr_sk = ca_address_sk\n      and ca_gmt_offset = -5\n      and i_manufact_id in (select i_manufact_id from item_filter)\n    group by i_manufact_id\n),\nws_branch1 as (\n    select i_manufact_id, sum(ws_ext_sales_price) total_sales\n    from web_sales, date_dim, customer_address, item\n    where ws_item_sk = i_item_sk\n      and ws_sold_date_sk = d_date_sk\n      and d_year = 2002\n      and d_moy = 1\n      and ws_bill_addr_sk = ca_address_sk\n      and ca_gmt_offset = -5\n      and i_manufact_id in (select i_manufact_id from item_filter)\n    group by i_manufact_id\n)\nselect i_manufact_id, sum(total_sales) total_sales\nfrom (\n    select * from ss_branch1\n    union all\n    select * from cs_branch1\n    union all\n    select * from ws_branch1\n) tmp1\ngroup by i_manufact_id\norder by total_sales\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 26548,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "WITH home_manufacturers AS (\n  SELECT\n    i_manufact_id\n  FROM item\n  WHERE\n    i_category IN ('Home')\n  GROUP BY\n    i_manufact_id\n), ss AS (\n  SELECT\n    i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM store_sales, date_dim, customer_address, item, home_manufacturers AS hm\n  WHERE\n    ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n    AND i_manufact_id = hm.i_manufact_id\n  GROUP BY\n    i_manufact_id\n), cs AS (\n  SELECT\n    i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM catalog_sales, date_dim, customer_address, item, home_manufacturers AS hm\n  WHERE\n    cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n    AND i_manufact_id = hm.i_manufact_id\n  GROUP BY\n    i_manufact_id\n), ws AS (\n  SELECT\n    i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM web_sales, date_dim, customer_address, item, home_manufacturers AS hm\n  WHERE\n    ws_item_sk = i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n    AND i_manufact_id = hm.i_manufact_id\n  GROUP BY\n    i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss\n  UNION ALL\n  SELECT\n    *\n  FROM cs\n  UNION ALL\n  SELECT\n    *\n  FROM ws\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 38700,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.3859,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.0,
      "output_sql": "WITH ss AS (\n  SELECT\n    i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM store_sales, date_dim, customer_address, item\n  WHERE\n    i_category IN ('Home')\n    AND ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), cs AS (\n  SELECT\n    i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM catalog_sales, date_dim, customer_address, item\n  WHERE\n    i_category IN ('Home')\n    AND cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), ws AS (\n  SELECT\n    i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM web_sales, date_dim, customer_address, item\n  WHERE\n    i_category IN ('Home')\n    AND ws_item_sk = i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss\n  UNION ALL\n  SELECT\n    *\n  FROM cs\n  UNION ALL\n  SELECT\n    *\n  FROM ws\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 23912,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0436,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.5,
      "output_sql": "WITH home_manufacturers AS (\n  SELECT\n    i_manufact_id\n  FROM item\n  WHERE\n    i_category IN ('Home')\n), ss AS (\n  SELECT\n    i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM store_sales, date_dim, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM home_manufacturers\n    )\n    AND ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), cs AS (\n  SELECT\n    i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM catalog_sales, date_dim, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM home_manufacturers\n    )\n    AND cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), ws AS (\n  SELECT\n    i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM web_sales, date_dim, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM home_manufacturers\n    )\n    AND ws_item_sk = i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss\n  UNION ALL\n  SELECT\n    *\n  FROM cs\n  UNION ALL\n  SELECT\n    *\n  FROM ws\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 26774,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9943,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.2,
      "output_sql": "WITH ss AS (\n  SELECT\n    i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM date_dim, customer_address, item, store_sales\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), cs AS (\n  SELECT\n    i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM date_dim, customer_address, item, catalog_sales\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), ws AS (\n  SELECT\n    i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM date_dim, customer_address, item, web_sales\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND ws_item_sk = i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss\n  UNION ALL\n  SELECT\n    *\n  FROM cs\n  UNION ALL\n  SELECT\n    *\n  FROM ws\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 43715,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 0.715,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.0,
      "output_sql": "WITH ss AS (\n  SELECT\n    i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM store_sales, date_dim, customer_address, item\n  WHERE\n    i_category IN ('Home')\n    AND ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), cs AS (\n  SELECT\n    i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM catalog_sales, date_dim, customer_address, item\n  WHERE\n    i_category IN ('Home')\n    AND cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), ws AS (\n  SELECT\n    i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM web_sales, date_dim, customer_address, item\n  WHERE\n    i_category IN ('Home')\n    AND ws_item_sk = i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss\n  UNION ALL\n  SELECT\n    *\n  FROM cs\n  UNION ALL\n  SELECT\n    *\n  FROM ws\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 35782,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0452,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.5,
      "output_sql": "WITH ss AS (\n  SELECT\n    i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM store_sales, date_dim, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), cs AS (\n  SELECT\n    i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM catalog_sales, date_dim, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), ws AS (\n  SELECT\n    i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM web_sales, date_dim, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND ws_item_sk = i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss\n  UNION ALL\n  SELECT\n    *\n  FROM cs\n  UNION ALL\n  SELECT\n    *\n  FROM ws\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 23069,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0293,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.5,
      "output_sql": "WITH ss AS (\n  SELECT\n    i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM store_sales, date_dim, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), cs AS (\n  SELECT\n    i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM catalog_sales, date_dim, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n), ws AS (\n  SELECT\n    i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM web_sales, date_dim, customer_address, item\n  WHERE\n    i_manufact_id IN (\n      SELECT\n        i_manufact_id\n      FROM item\n      WHERE\n        i_category IN ('Home')\n    )\n    AND ws_item_sk = i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n  GROUP BY\n    i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss\n  UNION ALL\n  SELECT\n    *\n  FROM cs\n  UNION ALL\n  SELECT\n    *\n  FROM ws\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "or_to_union"
      ],
      "transform_id": "push_pred",
      "duration_ms": 65355,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.4127,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH item_filter AS (\n  SELECT\n    i_manufact_id\n  FROM item\n  WHERE\n    i_category IN ('Home')\n), ss_branch1 AS (\n  SELECT\n    i_manufact_id,\n    SUM(ss_ext_sales_price) AS total_sales\n  FROM store_sales, date_dim, customer_address, item\n  WHERE\n    ss_item_sk = i_item_sk\n    AND ss_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ss_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n    AND i_category IN ('Home')\n  GROUP BY\n    i_manufact_id\n), cs_branch1 AS (\n  SELECT\n    i_manufact_id,\n    SUM(cs_ext_sales_price) AS total_sales\n  FROM catalog_sales, date_dim, customer_address, item\n  WHERE\n    cs_item_sk = i_item_sk\n    AND cs_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND cs_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n    AND i_category IN ('Home')\n  GROUP BY\n    i_manufact_id\n), ws_branch1 AS (\n  SELECT\n    i_manufact_id,\n    SUM(ws_ext_sales_price) AS total_sales\n  FROM web_sales, date_dim, customer_address, item\n  WHERE\n    ws_item_sk = i_item_sk\n    AND ws_sold_date_sk = d_date_sk\n    AND d_year = 2002\n    AND d_moy = 1\n    AND ws_bill_addr_sk = ca_address_sk\n    AND ca_gmt_offset = -5\n    AND i_category IN ('Home')\n  GROUP BY\n    i_manufact_id\n)\nSELECT\n  i_manufact_id,\n  SUM(total_sales) AS total_sales\nFROM (\n  SELECT\n    *\n  FROM ss_branch1\n  UNION ALL\n  SELECT\n    *\n  FROM cs_branch1\n  UNION ALL\n  SELECT\n    *\n  FROM ws_branch1\n) AS tmp1\nGROUP BY\n  i_manufact_id\nORDER BY\n  total_sales\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2167,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.638,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.638,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1409,
          "visits": 1,
          "avg_reward": 1.1075,
          "is_valid": true,
          "speedup": 1.1075,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.638,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1448,
          "visits": 1,
          "avg_reward": 1.1075,
          "is_valid": true,
          "speedup": 1.1075,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.3859,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2646,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.638,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1484,
          "visits": 1,
          "avg_reward": 1.1075,
          "is_valid": true,
          "speedup": 1.1075,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1323,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.3859,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0436,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.638,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5657,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1516,
          "visits": 1,
          "avg_reward": 1.1075,
          "is_valid": true,
          "speedup": 1.1075,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.3859,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3414,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9943,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0436,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.638,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1547,
          "visits": 1,
          "avg_reward": 1.1075,
          "is_valid": true,
          "speedup": 1.1075,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.45,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.3859,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9943,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0436,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.638,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.715,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1575,
          "visits": 1,
          "avg_reward": 1.1075,
          "is_valid": true,
          "speedup": 1.1075,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3162,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.3859,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3581,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9943,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0436,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0452,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.638,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.715,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1602,
          "visits": 1,
          "avg_reward": 1.1075,
          "is_valid": true,
          "speedup": 1.1075,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.6743,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7906,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9779
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.638
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4091,
          "visits": 1,
          "avg_reward": 1.1075,
          "is_valid": true,
          "speedup": 1.1075
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.3859
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0436
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9943
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0.715
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0452
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0293
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "or_to_union"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 12,
    "avg_reward": 0.2673,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9779,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.638,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.5538,
        "is_valid": true,
        "speedup": 1.1075,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "or_to_union",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 1.4127,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 1.3859,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0436,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9943,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0.715,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0452,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0293,
        "error": null
      }
    }
  }
}