{
  "stats": {
    "total_iterations": 9,
    "tree_size": 10,
    "successful_expansions": 9,
    "failed_expansions": 0,
    "validation_calls": 9,
    "llm_ranking_calls": 10,
    "root_visits": 9,
    "total_attempts": 9
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 38154,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.4497,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 1.4497,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_week_seq = (\n      SELECT\n        d_week_seq\n      FROM date_dim\n      WHERE\n        d_date = '2001-03-24'\n    )\n), ss_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ss_ext_sales_price) AS ss_item_rev\n  FROM store_sales, item, filtered_dates\n  WHERE\n    ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n), cs_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(cs_ext_sales_price) AS cs_item_rev\n  FROM catalog_sales, item, filtered_dates\n  WHERE\n    cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n), ws_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ws_ext_sales_price) AS ws_item_rev\n  FROM web_sales, item, filtered_dates\n  WHERE\n    ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n)\nSELECT\n  ss_items.item_id,\n  ss_item_rev,\n  ss_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ss_dev,\n  cs_item_rev,\n  cs_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS cs_dev,\n  ws_item_rev,\n  ws_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ws_dev,\n  (\n    ss_item_rev + cs_item_rev + ws_item_rev\n  ) / 3 AS average\nFROM ss_items, cs_items, ws_items\nWHERE\n  ss_items.item_id = cs_items.item_id\n  AND ss_items.item_id = ws_items.item_id\n  AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n  AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\nORDER BY\n  ss_items.item_id,\n  ss_item_rev\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [
        "date_cte_isolate"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 56709,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_week_seq = (\n      SELECT\n        d_week_seq\n      FROM date_dim\n      WHERE\n        d_date = '2001-03-24'\n    )\n), aggregated_sales AS (\n  SELECT\n    item_id,\n    ss_item_rev,\n    cs_item_rev,\n    ws_item_rev\n  FROM (\n    SELECT\n      i_item_id AS item_id,\n      SUM(\n        CASE\n          WHEN ss.sold_date_sk IN (\n            SELECT\n              d_date_sk\n            FROM filtered_dates\n          )\n          THEN ss_ext_sales_price\n        END\n      ) AS ss_item_rev,\n      SUM(\n        CASE\n          WHEN cs.sold_date_sk IN (\n            SELECT\n              d_date_sk\n            FROM filtered_dates\n          )\n          THEN cs_ext_sales_price\n        END\n      ) AS cs_item_rev,\n      SUM(\n        CASE\n          WHEN ws.sold_date_sk IN (\n            SELECT\n              d_date_sk\n            FROM filtered_dates\n          )\n          THEN ws_ext_sales_price\n        END\n      ) AS ws_item_rev\n    FROM item\n    LEFT JOIN store_sales AS ss\n      ON ss_item_sk = i_item_sk\n    LEFT JOIN catalog_sales AS cs\n      ON cs_item_sk = i_item_sk\n    LEFT JOIN web_sales AS ws\n      ON ws_item_sk = i_item_sk\n    GROUP BY\n      i_item_id\n  ) AS t\n  WHERE\n    NOT ss_item_rev IS NULL AND NOT cs_item_rev IS NULL AND NOT ws_item_rev IS NULL\n)\nSELECT\n  item_id,\n  ss_item_rev,\n  ss_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ss_dev,\n  cs_item_rev,\n  cs_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS cs_dev,\n  ws_item_rev,\n  ws_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ws_dev,\n  (\n    ss_item_rev + cs_item_rev + ws_item_rev\n  ) / 3 AS average\nFROM aggregated_sales\nWHERE\n  ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n  AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\nORDER BY\n  item_id,\n  ss_item_rev\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 30524,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0243,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.5,
      "output_sql": "WITH week_seq_cte AS (\n  SELECT\n    d_week_seq\n  FROM date_dim\n  WHERE\n    d_date = '2001-03-24'\n), dates_in_week AS (\n  SELECT\n    d_date\n  FROM date_dim\n  WHERE\n    d_week_seq = (\n      SELECT\n        d_week_seq\n      FROM week_seq_cte\n    )\n), ss_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ss_ext_sales_price) AS ss_item_rev\n  FROM store_sales, item, date_dim\n  WHERE\n    ss_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM dates_in_week\n    )\n    AND ss_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n), cs_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(cs_ext_sales_price) AS cs_item_rev\n  FROM catalog_sales, item, date_dim\n  WHERE\n    cs_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM dates_in_week\n    )\n    AND cs_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n), ws_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ws_ext_sales_price) AS ws_item_rev\n  FROM web_sales, item, date_dim\n  WHERE\n    ws_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM dates_in_week\n    )\n    AND ws_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n)\nSELECT\n  ss_items.item_id,\n  ss_item_rev,\n  ss_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ss_dev,\n  cs_item_rev,\n  cs_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS cs_dev,\n  ws_item_rev,\n  ws_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ws_dev,\n  (\n    ss_item_rev + cs_item_rev + ws_item_rev\n  ) / 3 AS average\nFROM ss_items, cs_items, ws_items\nWHERE\n  ss_items.item_id = cs_items.item_id\n  AND ss_items.item_id = ws_items.item_id\n  AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n  AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\nORDER BY\n  ss_items.item_id,\n  ss_item_rev\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 97614,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.4056,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 1.4056,
      "output_sql": "with ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '2001-03-24'))\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n   and cs_sold_date_sk = d_date_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '2001-03-24'))\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                     from date_dim\n                                     where d_date = '2001-03-24'))\n group by i_item_id)\n  select ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by ss_items.item_id\n         ,ss_item_rev\n LIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 53765,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9151,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.2,
      "output_sql": "WITH ss_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ss_ext_sales_price) AS ss_item_rev\n  FROM store_sales, item, date_dim\n  WHERE\n    ss_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM date_dim\n      WHERE\n        d_week_seq = (\n          SELECT\n            d_week_seq\n          FROM date_dim\n          WHERE\n            d_date = '2001-03-24'\n        )\n    )\n    AND ss_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n), cs_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(cs_ext_sales_price) AS cs_item_rev\n  FROM catalog_sales, item, date_dim\n  WHERE\n    cs_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM date_dim\n      WHERE\n        d_week_seq = (\n          SELECT\n            d_week_seq\n          FROM date_dim\n          WHERE\n            d_date = '2001-03-24'\n        )\n    )\n    AND cs_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n), ws_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ws_ext_sales_price) AS ws_item_rev\n  FROM web_sales, item, date_dim\n  WHERE\n    ws_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM date_dim\n      WHERE\n        d_week_seq = (\n          SELECT\n            d_week_seq\n          FROM date_dim\n          WHERE\n            d_date = '2001-03-24'\n        )\n    )\n    AND ws_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n), branch1_cte AS (\n  SELECT\n    ss_items.item_id,\n    ss_item_rev,\n    cs_item_rev,\n    ws_item_rev\n  FROM ss_items, cs_items, ws_items\n  WHERE\n    ss_items.item_id = cs_items.item_id\n    AND ss_items.item_id = ws_items.item_id\n    AND ss_item_rev >= cs_item_rev\n    AND ss_item_rev >= ws_item_rev\n    AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n    AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n), branch2_cte AS (\n  SELECT\n    ss_items.item_id,\n    ss_item_rev,\n    cs_item_rev,\n    ws_item_rev\n  FROM ss_items, cs_items, ws_items\n  WHERE\n    ss_items.item_id = cs_items.item_id\n    AND ss_items.item_id = ws_items.item_id\n    AND cs_item_rev >= ss_item_rev\n    AND cs_item_rev >= ws_item_rev\n    AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n    AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n), branch3_cte AS (\n  SELECT\n    ss_items.item_id,\n    ss_item_rev,\n    cs_item_rev,\n    ws_item_rev\n  FROM ss_items, cs_items, ws_items\n  WHERE\n    ss_items.item_id = cs_items.item_id\n    AND ss_items.item_id = ws_items.item_id\n    AND ws_item_rev >= ss_item_rev\n    AND ws_item_rev >= cs_item_rev\n    AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n    AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n), combined_cte AS (\n  SELECT\n    *\n  FROM branch1_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch2_cte\n  WHERE\n    cs_item_rev > ss_item_rev\n  UNION ALL\n  SELECT\n    *\n  FROM branch3_cte\n  WHERE\n    ws_item_rev > ss_item_rev AND ws_item_rev > cs_item_rev\n)\nSELECT\n  item_id,\n  ss_item_rev,\n  ss_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ss_dev,\n  cs_item_rev,\n  cs_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS cs_dev,\n  ws_item_rev,\n  ws_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ws_dev,\n  (\n    ss_item_rev + cs_item_rev + ws_item_rev\n  ) / 3 AS average\nFROM combined_cte\nORDER BY\n  item_id,\n  ss_item_rev\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 29282,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1718,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 1.1718,
      "output_sql": "WITH week_seq_cte AS (\n  SELECT\n    d_week_seq\n  FROM date_dim\n  WHERE\n    d_date = '2001-03-24'\n), date_range_cte AS (\n  SELECT\n    d_date\n  FROM date_dim\n  WHERE\n    d_week_seq = (\n      SELECT\n        d_week_seq\n      FROM week_seq_cte\n    )\n), ss_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ss_ext_sales_price) AS ss_item_rev\n  FROM store_sales, item, date_dim\n  WHERE\n    ss_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM date_range_cte\n    )\n    AND ss_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n), cs_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(cs_ext_sales_price) AS cs_item_rev\n  FROM catalog_sales, item, date_dim\n  WHERE\n    cs_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM date_range_cte\n    )\n    AND cs_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n), ws_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ws_ext_sales_price) AS ws_item_rev\n  FROM web_sales, item, date_dim\n  WHERE\n    ws_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM date_range_cte\n    )\n    AND ws_sold_date_sk = d_date_sk\n  GROUP BY\n    i_item_id\n)\nSELECT\n  ss_items.item_id,\n  ss_item_rev,\n  ss_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ss_dev,\n  cs_item_rev,\n  cs_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS cs_dev,\n  ws_item_rev,\n  ws_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ws_dev,\n  (\n    ss_item_rev + cs_item_rev + ws_item_rev\n  ) / 3 AS average\nFROM ss_items, cs_items, ws_items\nWHERE\n  ss_items.item_id = cs_items.item_id\n  AND ss_items.item_id = ws_items.item_id\n  AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n  AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\nORDER BY\n  ss_items.item_id,\n  ss_item_rev\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 53782,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2177,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 1.2177,
      "output_sql": "WITH ss_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ss_ext_sales_price) AS ss_item_rev\n  FROM date_dim, item, store_sales\n  WHERE\n    d_date IN (\n      SELECT\n        d_date\n      FROM date_dim\n      WHERE\n        d_week_seq = (\n          SELECT\n            d_week_seq\n          FROM date_dim\n          WHERE\n            d_date = '2001-03-24'\n        )\n    )\n    AND ss_sold_date_sk = d_date_sk\n    AND ss_item_sk = i_item_sk\n  GROUP BY\n    i_item_id\n), cs_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(cs_ext_sales_price) AS cs_item_rev\n  FROM date_dim, item, catalog_sales\n  WHERE\n    d_date IN (\n      SELECT\n        d_date\n      FROM date_dim\n      WHERE\n        d_week_seq = (\n          SELECT\n            d_week_seq\n          FROM date_dim\n          WHERE\n            d_date = '2001-03-24'\n        )\n    )\n    AND cs_sold_date_sk = d_date_sk\n    AND cs_item_sk = i_item_sk\n  GROUP BY\n    i_item_id\n), ws_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ws_ext_sales_price) AS ws_item_rev\n  FROM date_dim, item, web_sales\n  WHERE\n    d_date IN (\n      SELECT\n        d_date\n      FROM date_dim\n      WHERE\n        d_week_seq = (\n          SELECT\n            d_week_seq\n          FROM date_dim\n          WHERE\n            d_date = '2001-03-24'\n        )\n    )\n    AND ws_sold_date_sk = d_date_sk\n    AND ws_item_sk = i_item_sk\n  GROUP BY\n    i_item_id\n)\nSELECT\n  ss_items.item_id,\n  ss_item_rev,\n  ss_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ss_dev,\n  cs_item_rev,\n  cs_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS cs_dev,\n  ws_item_rev,\n  ws_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ws_dev,\n  (\n    ss_item_rev + cs_item_rev + ws_item_rev\n  ) / 3 AS average\nFROM ss_items, cs_items, ws_items\nWHERE\n  ss_items.item_id = cs_items.item_id\n  AND ss_items.item_id = ws_items.item_id\n  AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n  AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\nORDER BY\n  ss_items.item_id,\n  ss_item_rev\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 84565,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.0,
      "output_sql": "WITH ss_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ss_ext_sales_price) AS ss_item_rev\n  FROM store_sales, item, date_dim\n  WHERE\n    ss_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM date_dim\n      WHERE\n        d_week_seq = (\n          SELECT\n            d_week_seq\n          FROM date_dim\n          WHERE\n            d_date = '2001-03-24'\n        )\n    )\n    AND ss_sold_date_sk = d_date_sk\n    AND i_item_id = cs_items.item_id\n    AND i_item_id = ws_items.item_id\n  GROUP BY\n    i_item_id\n), cs_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(cs_ext_sales_price) AS cs_item_rev\n  FROM catalog_sales, item, date_dim\n  WHERE\n    cs_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM date_dim\n      WHERE\n        d_week_seq = (\n          SELECT\n            d_week_seq\n          FROM date_dim\n          WHERE\n            d_date = '2001-03-24'\n        )\n    )\n    AND cs_sold_date_sk = d_date_sk\n    AND i_item_id = ss_items.item_id\n    AND i_item_id = ws_items.item_id\n  GROUP BY\n    i_item_id\n), ws_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ws_ext_sales_price) AS ws_item_rev\n  FROM web_sales, item, date_dim\n  WHERE\n    ws_item_sk = i_item_sk\n    AND d_date IN (\n      SELECT\n        d_date\n      FROM date_dim\n      WHERE\n        d_week_seq = (\n          SELECT\n            d_week_seq\n          FROM date_dim\n          WHERE\n            d_date = '2001-03-24'\n        )\n    )\n    AND ws_sold_date_sk = d_date_sk\n    AND i_item_id = ss_items.item_id\n    AND i_item_id = cs_items.item_id\n  GROUP BY\n    i_item_id\n)\nSELECT\n  ss_items.item_id,\n  ss_item_rev,\n  ss_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ss_dev,\n  cs_item_rev,\n  cs_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS cs_dev,\n  ws_item_rev,\n  ws_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ws_dev,\n  (\n    ss_item_rev + cs_item_rev + ws_item_rev\n  ) / 3 AS average\nFROM ss_items, cs_items, ws_items\nWHERE\n  ss_items.item_id = cs_items.item_id\n  AND ss_items.item_id = ws_items.item_id\n  AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n  AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\nORDER BY\n  ss_items.item_id,\n  ss_item_rev\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 50436,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0811,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.5,
      "output_sql": "WITH target_week AS (\n  SELECT\n    d_week_seq\n  FROM date_dim\n  WHERE\n    d_date = '2001-03-24'\n), target_dates AS (\n  SELECT\n    d_date\n  FROM date_dim\n  WHERE\n    d_week_seq = (\n      SELECT\n        d_week_seq\n      FROM target_week\n    )\n), ss_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ss_ext_sales_price) AS ss_item_rev\n  FROM store_sales\n  JOIN item\n    ON ss_item_sk = i_item_sk\n  JOIN date_dim\n    ON ss_sold_date_sk = d_date_sk\n  WHERE\n    d_date IN (\n      SELECT\n        d_date\n      FROM target_dates\n    )\n  GROUP BY\n    i_item_id\n), cs_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(cs_ext_sales_price) AS cs_item_rev\n  FROM catalog_sales\n  JOIN item\n    ON cs_item_sk = i_item_sk\n  JOIN date_dim\n    ON cs_sold_date_sk = d_date_sk\n  WHERE\n    d_date IN (\n      SELECT\n        d_date\n      FROM target_dates\n    )\n  GROUP BY\n    i_item_id\n), ws_items AS (\n  SELECT\n    i_item_id AS item_id,\n    SUM(ws_ext_sales_price) AS ws_item_rev\n  FROM web_sales\n  JOIN item\n    ON ws_item_sk = i_item_sk\n  JOIN date_dim\n    ON ws_sold_date_sk = d_date_sk\n  WHERE\n    d_date IN (\n      SELECT\n        d_date\n      FROM target_dates\n    )\n  GROUP BY\n    i_item_id\n)\nSELECT\n  ss_items.item_id,\n  ss_item_rev,\n  ss_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ss_dev,\n  cs_item_rev,\n  cs_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS cs_dev,\n  ws_item_rev,\n  ws_item_rev / (\n    (\n      ss_item_rev + cs_item_rev + ws_item_rev\n    ) / 3\n  ) * 100 AS ws_dev,\n  (\n    ss_item_rev + cs_item_rev + ws_item_rev\n  ) / 3 AS average\nFROM ss_items\nJOIN cs_items\n  ON ss_items.item_id = cs_items.item_id\nJOIN ws_items\n  ON ss_items.item_id = ws_items.item_id\nWHERE\n  ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\n  AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev\n  AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev\n  AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev\nORDER BY\n  ss_items.item_id,\n  ss_item_rev\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.4664,
          "visits": 1,
          "avg_reward": 1.4497,
          "is_valid": true,
          "speedup": 1.4497,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "date_cte_isolate"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7406,
          "visits": 2,
          "avg_reward": 0.7249,
          "is_valid": true,
          "speedup": 1.4497,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5289,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0243,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7441,
          "visits": 2,
          "avg_reward": 0.7249,
          "is_valid": true,
          "speedup": 1.4497,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.439,
          "visits": 1,
          "avg_reward": 1.4056,
          "is_valid": true,
          "speedup": 1.4056,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0243,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7471,
          "visits": 2,
          "avg_reward": 0.7249,
          "is_valid": true,
          "speedup": 1.4497,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.4429,
          "visits": 1,
          "avg_reward": 1.4056,
          "is_valid": true,
          "speedup": 1.4056,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9151,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0243,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7497,
          "visits": 2,
          "avg_reward": 0.7249,
          "is_valid": true,
          "speedup": 1.4497,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.5281,
          "visits": 1,
          "avg_reward": 1.4056,
          "is_valid": true,
          "speedup": 1.4056,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.2126,
          "visits": 1,
          "avg_reward": 1.1718,
          "is_valid": true,
          "speedup": 1.1718,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9151,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0243,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7521,
          "visits": 2,
          "avg_reward": 0.7249,
          "is_valid": true,
          "speedup": 1.4497,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.6702,
          "visits": 1,
          "avg_reward": 1.4056,
          "is_valid": true,
          "speedup": 1.4056,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.35,
          "visits": 1,
          "avg_reward": 1.2177,
          "is_valid": true,
          "speedup": 1.2177,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.2159,
          "visits": 1,
          "avg_reward": 1.1718,
          "is_valid": true,
          "speedup": 1.1718,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9151,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0243,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7543,
          "visits": 2,
          "avg_reward": 0.7249,
          "is_valid": true,
          "speedup": 1.4497,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.6885,
          "visits": 1,
          "avg_reward": 1.4056,
          "is_valid": true,
          "speedup": 1.4056,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.3591,
          "visits": 1,
          "avg_reward": 1.2177,
          "is_valid": true,
          "speedup": 1.2177,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.2189,
          "visits": 1,
          "avg_reward": 1.1718,
          "is_valid": true,
          "speedup": 1.1718,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9151,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0243,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7563,
          "visits": 2,
          "avg_reward": 0.7249,
          "is_valid": true,
          "speedup": 1.4497,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 9,
    "avg_reward": 0.7161,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.7249,
        "is_valid": true,
        "speedup": 1.4497,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "date_cte_isolate",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0243,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.4056,
        "is_valid": true,
        "speedup": 1.4056,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9151,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.1718,
        "is_valid": true,
        "speedup": 1.1718,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.2177,
        "is_valid": true,
        "speedup": 1.2177,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0811,
        "error": null
      }
    }
  }
}