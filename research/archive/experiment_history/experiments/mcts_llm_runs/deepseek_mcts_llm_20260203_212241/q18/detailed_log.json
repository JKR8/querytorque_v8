{
  "stats": {
    "total_iterations": 19,
    "tree_size": 20,
    "successful_expansions": 19,
    "failed_expansions": 0,
    "validation_calls": 19,
    "llm_ranking_calls": 28,
    "root_visits": 19,
    "total_attempts": 19
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 23419,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM catalog_sales, customer_demographics AS cd1, customer_demographics AS cd2, customer, customer_address, filtered_dates, item\nWHERE\n  cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND cd1.cd_gender = 'F'\n  AND cd1.cd_education_status = 'Advanced Degree'\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND c_birth_month IN (10, 7, 8, 4, 1, 2)\n  AND ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 25843,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.4893,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM catalog_sales, (\n  SELECT\n    *\n  FROM customer_demographics\n  WHERE\n    cd_gender = 'F' AND cd_education_status = 'Advanced Degree'\n) AS cd1, customer_demographics AS cd2, (\n  SELECT\n    *\n  FROM customer\n  WHERE\n    c_birth_month IN (10, 7, 8, 4, 1, 2)\n) AS customer, (\n  SELECT\n    *\n  FROM customer_address\n  WHERE\n    ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\n) AS customer_address, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_year = 1998\n) AS date_dim, item\nWHERE\n  cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 75438,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0824,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.5,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM customer_demographics AS cd1\nJOIN date_dim\n  ON 1 = 1\nJOIN customer\n  ON 1 = 1\nJOIN customer_demographics AS cd2\n  ON 1 = 1\nJOIN customer_address\n  ON 1 = 1\nJOIN item\n  ON 1 = 1\nJOIN catalog_sales\n  ON cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\nWHERE\n  cd1.cd_gender = 'F'\n  AND cd1.cd_education_status = 'Advanced Degree'\n  AND c_birth_month IN (10, 7, 8, 4, 1, 2)\n  AND d_year = 1998\n  AND ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 37902,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd_bill.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM catalog_sales\nJOIN combined_customer_demographics AS cd_bill\n  ON cs_bill_cdemo_sk = cd_bill.cd_demo_sk\nJOIN combined_customer_demographics AS cd_curr\n  ON c_current_cdemo_sk = cd_curr.cd_demo_sk\nJOIN customer\n  ON cs_bill_customer_sk = c_customer_sk\nJOIN customer_address\n  ON c_current_addr_sk = ca_address_sk\nJOIN date_dim\n  ON cs_sold_date_sk = d_date_sk\nJOIN item\n  ON cs_item_sk = i_item_sk\nWHERE\n  cd_bill.cd_gender = 'F'\n  AND cd_bill.cd_education_status = 'Advanced Degree'\n  AND c_birth_month IN (10, 7, 8, 4, 1, 2)\n  AND d_year = 1998\n  AND ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 81902,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "WITH combined_cte AS (\n  SELECT\n    *\n  FROM branch1_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch2_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch3_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch4_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch5_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch6_cte\n  UNION ALL\n  SELECT\n    *\n  FROM branch7_cte\n)\nSELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM combined_cte\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 44663,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0466,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.5,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM catalog_sales, customer_demographics AS cd1, customer_demographics AS cd2, customer, customer_address, date_dim, item\nWHERE\n  cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND cd1.cd_gender = 'F'\n  AND cd1.cd_education_status = 'Advanced Degree'\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND c_birth_month IN (10, 7, 8, 4, 1, 2)\n  AND d_year = 1998\n  AND ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 24620,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2749,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 1.2749,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM catalog_sales, customer_demographics AS cd1, customer_demographics AS cd2, customer, customer_address, date_dim, item\nWHERE\n  cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND cd1.cd_gender = 'F'\n  AND cd1.cd_education_status = 'Advanced Degree'\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND c_birth_month IN (10, 7, 8, 4, 1, 2)\n  AND d_year = 1998\n  AND ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 20,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0205,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.5,
      "output_sql": "select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        avg( cast(cs_quantity as decimal(12,2))) agg1,\n        avg( cast(cs_list_price as decimal(12,2))) agg2,\n        avg( cast(cs_coupon_amt as decimal(12,2))) agg3,\n        avg( cast(cs_sales_price as decimal(12,2))) agg4,\n        avg( cast(cs_net_profit as decimal(12,2))) agg5,\n        avg( cast(c_birth_year as decimal(12,2))) agg6,\n        avg( cast(cd1.cd_dep_count as decimal(12,2))) agg7\n from catalog_sales, customer_demographics cd1, \n      customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'F' and \n       cd1.cd_education_status = 'Advanced Degree' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (10,7,8,4,1,2) and\n       d_year = 1998 and\n       ca_state in ('WA','GA','NC'\n                   ,'ME','WY','OK','IN')\n group by rollup (i_item_id, ca_country, ca_state, ca_county)\n order by ca_country,\n        ca_state, \n        ca_county,\n\ti_item_id\n LIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 33186,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM catalog_sales\nJOIN filtered_cd1 AS cd1\n  ON cs_bill_cdemo_sk = cd1.cd_demo_sk\nJOIN filtered_customer AS c\n  ON cs_bill_customer_sk = c.c_customer_sk\nJOIN filtered_cd2 AS cd2\n  ON c.c_current_cdemo_sk = cd2.cd_demo_sk\nJOIN filtered_customer_address AS ca\n  ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN filtered_date_dim AS d\n  ON cs_sold_date_sk = d.d_date_sk\nJOIN item AS i\n  ON cs_item_sk = i_item_sk\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 19303,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9813,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM catalog_sales, customer_demographics AS cd1, customer_demographics AS cd2, customer, customer_address, date_dim, item\nWHERE\n  cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND cd1.cd_gender = 'F'\n  AND cd1.cd_education_status = 'Advanced Degree'\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND c_birth_month IN (10, 7, 8, 4, 1, 2)\n  AND d_year = 1998\n  AND ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 64711,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.6602,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 1.6602,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(cs_quantity) AS agg1,\n  AVG(cs_list_price) AS agg2,\n  AVG(cs_coupon_amt) AS agg3,\n  AVG(cs_sales_price) AS agg4,\n  AVG(cs_net_profit) AS agg5,\n  AVG(c_birth_year) AS agg6,\n  AVG(cd1.cd_dep_count) AS agg7\nFROM catalog_sales, customer_demographics AS cd1, customer_demographics AS cd2, customer, customer_address, date_dim, item\nWHERE\n  cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND cd1.cd_gender = 'F'\n  AND cd1.cd_education_status = 'Advanced Degree'\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND c_birth_month IN (10, 7, 8, 4, 1, 2)\n  AND d_year = 1998\n  AND ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "remove_redundant"
      ],
      "transform_id": "push_pred",
      "duration_ms": 24528,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.5419,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(cs_quantity) AS agg1,\n  AVG(cs_list_price) AS agg2,\n  AVG(cs_coupon_amt) AS agg3,\n  AVG(cs_sales_price) AS agg4,\n  AVG(cs_net_profit) AS agg5,\n  AVG(c_birth_year) AS agg6,\n  AVG(cd1.cd_dep_count) AS agg7\nFROM catalog_sales, (\n  SELECT\n    *\n  FROM customer_demographics\n  WHERE\n    cd_gender = 'F' AND cd_education_status = 'Advanced Degree'\n) AS cd1, customer_demographics AS cd2, (\n  SELECT\n    *\n  FROM customer\n  WHERE\n    c_birth_month IN (10, 7, 8, 4, 1, 2)\n) AS customer, (\n  SELECT\n    *\n  FROM customer_address\n  WHERE\n    ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\n) AS customer_address, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_year = 1998\n) AS date_dim, item\nWHERE\n  cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "correlated_to_cte"
      ],
      "transform_id": "push_pred",
      "duration_ms": 29617,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.3552,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM (\n  SELECT\n    *\n  FROM catalog_sales\n) AS cs, (\n  SELECT\n    *\n  FROM customer_demographics\n  WHERE\n    cd_gender = 'F' AND cd_education_status = 'Advanced Degree'\n) AS cd1, (\n  SELECT\n    *\n  FROM customer_demographics\n) AS cd2, (\n  SELECT\n    *\n  FROM customer\n  WHERE\n    c_birth_month IN (10, 7, 8, 4, 1, 2)\n) AS c, (\n  SELECT\n    *\n  FROM customer_address\n  WHERE\n    ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\n) AS ca, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_year = 1998\n) AS d, (\n  SELECT\n    *\n  FROM item\n) AS i\nWHERE\n  cs.cs_sold_date_sk = d.d_date_sk\n  AND cs.cs_item_sk = i.i_item_sk\n  AND cs.cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs.cs_bill_customer_sk = c.c_customer_sk\n  AND c.c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c.c_current_addr_sk = ca.ca_address_sk\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "remove_redundant"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 31046,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.5142,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 1.5142,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(cs_quantity) AS agg1,\n  AVG(cs_list_price) AS agg2,\n  AVG(cs_coupon_amt) AS agg3,\n  AVG(cs_sales_price) AS agg4,\n  AVG(cs_net_profit) AS agg5,\n  AVG(c_birth_year) AS agg6,\n  AVG(cd1.cd_dep_count) AS agg7\nFROM customer_demographics AS cd1\nJOIN catalog_sales\n  ON cs_bill_cdemo_sk = cd1.cd_demo_sk\nJOIN date_dim\n  ON cs_sold_date_sk = d_date_sk\nJOIN customer\n  ON cs_bill_customer_sk = c_customer_sk\nJOIN customer_demographics AS cd2\n  ON c_current_cdemo_sk = cd2.cd_demo_sk\nJOIN customer_address\n  ON c_current_addr_sk = ca_address_sk\nJOIN item\n  ON cs_item_sk = i_item_sk\nWHERE\n  cd1.cd_gender = 'F'\n  AND cd1.cd_education_status = 'Advanced Degree'\n  AND c_birth_month IN (10, 7, 8, 4, 1, 2)\n  AND d_year = 1998\n  AND ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 15,
      "parent_path": [
        "remove_redundant",
        "reorder_join"
      ],
      "transform_id": "push_pred",
      "duration_ms": 23813,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.5633,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(cs_quantity) AS agg1,\n  AVG(cs_list_price) AS agg2,\n  AVG(cs_coupon_amt) AS agg3,\n  AVG(cs_sales_price) AS agg4,\n  AVG(cs_net_profit) AS agg5,\n  AVG(c_birth_year) AS agg6,\n  AVG(cd1.cd_dep_count) AS agg7\nFROM (\n  SELECT\n    *\n  FROM customer_demographics\n  WHERE\n    cd_gender = 'F' AND cd_education_status = 'Advanced Degree'\n) AS cd1\nJOIN catalog_sales\n  ON cs_bill_cdemo_sk = cd1.cd_demo_sk\nJOIN (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_year = 1998\n) AS date_dim\n  ON cs_sold_date_sk = d_date_sk\nJOIN (\n  SELECT\n    *\n  FROM customer\n  WHERE\n    c_birth_month IN (10, 7, 8, 4, 1, 2)\n) AS customer\n  ON cs_bill_customer_sk = c_customer_sk\nJOIN customer_demographics AS cd2\n  ON c_current_cdemo_sk = cd2.cd_demo_sk\nJOIN (\n  SELECT\n    *\n  FROM customer_address\n  WHERE\n    ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\n) AS customer_address\n  ON c_current_addr_sk = ca_address_sk\nJOIN item\n  ON cs_item_sk = i_item_sk\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 16,
      "parent_path": [
        "flatten_subq"
      ],
      "transform_id": "push_pred",
      "duration_ms": 27427,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.482,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM catalog_sales, (\n  SELECT\n    *\n  FROM customer_demographics\n  WHERE\n    cd_gender = 'F' AND cd_education_status = 'Advanced Degree'\n) AS cd1, customer_demographics AS cd2, (\n  SELECT\n    *\n  FROM customer\n  WHERE\n    c_birth_month IN (10, 7, 8, 4, 1, 2)\n) AS customer, (\n  SELECT\n    *\n  FROM customer_address\n  WHERE\n    ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\n) AS customer_address, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_year = 1998\n) AS date_dim, item\nWHERE\n  cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 17,
      "parent_path": [
        "or_to_union"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 57273,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH consolidated_data AS (\n  SELECT\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county,\n    AVG(CAST(CASE WHEN is_branch1 = 1 THEN cs_quantity END AS DECIMAL(12, 2))) AS b1_agg1, /* Combined aggregates using conditional logic */\n    AVG(CAST(CASE WHEN is_branch1 = 1 THEN cs_list_price END AS DECIMAL(12, 2))) AS b1_agg2,\n    AVG(CAST(CASE WHEN is_branch1 = 1 THEN cs_coupon_amt END AS DECIMAL(12, 2))) AS b1_agg3,\n    AVG(CAST(CASE WHEN is_branch1 = 1 THEN cs_sales_price END AS DECIMAL(12, 2))) AS b1_agg4,\n    AVG(CAST(CASE WHEN is_branch1 = 1 THEN cs_net_profit END AS DECIMAL(12, 2))) AS b1_agg5,\n    AVG(CAST(CASE WHEN is_branch1 = 1 THEN c_birth_year END AS DECIMAL(12, 2))) AS b1_agg6,\n    AVG(CAST(CASE WHEN is_branch1 = 1 THEN cd_dep_count END AS DECIMAL(12, 2))) AS b1_agg7\n  /* Repeat similar CASE statements for branches 2-7... */\n  FROM all_data\n  GROUP BY\n    ROLLUP (\n      i_item_id,\n      ca_country,\n      ca_state,\n      ca_county\n    )\n)\nSELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  COALESCE(b1_agg1, b2_agg1, b3_agg1, b4_agg1, b5_agg1, b6_agg1, b7_agg1) AS agg1, /* Combine branch aggregates (UNION ALL equivalent) */\n  COALESCE(b1_agg2, b2_agg2, b3_agg2, b4_agg2, b5_agg2, b6_agg2, b7_agg2) AS agg2,\n  COALESCE(b1_agg3, b2_agg3, b3_agg3, b4_agg3, b5_agg3, b6_agg3, b7_agg3) AS agg3,\n  COALESCE(b1_agg4, b2_agg4, b3_agg4, b4_agg4, b5_agg4, b6_agg4, b7_agg4) AS agg4,\n  COALESCE(b1_agg5, b2_agg5, b3_agg5, b4_agg5, b5_agg5, b6_agg5, b7_agg5) AS agg5,\n  COALESCE(b1_agg6, b2_agg6, b3_agg6, b4_agg6, b5_agg6, b6_agg6, b7_agg6) AS agg6,\n  COALESCE(b1_agg7, b2_agg7, b3_agg7, b4_agg7, b5_agg7, b6_agg7, b7_agg7) AS agg7\nFROM consolidated_data\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 18,
      "parent_path": [
        "remove_redundant"
      ],
      "transform_id": "or_to_union",
      "duration_ms": 73557,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.0,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(cs_quantity) AS agg1,\n  AVG(cs_list_price) AS agg2,\n  AVG(cs_coupon_amt) AS agg3,\n  AVG(cs_sales_price) AS agg4,\n  AVG(cs_net_profit) AS agg5,\n  AVG(c_birth_year) AS agg6,\n  AVG(cd_dep_count) AS agg7\nFROM combined_cte\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    },
    {
      "iteration": 19,
      "parent_path": [
        "correlated_to_cte"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 75162,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0122,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.5,
      "output_sql": "SELECT\n  i_item_id,\n  ca_country,\n  ca_state,\n  ca_county,\n  AVG(CAST(cs_quantity AS DECIMAL(12, 2))) AS agg1,\n  AVG(CAST(cs_list_price AS DECIMAL(12, 2))) AS agg2,\n  AVG(CAST(cs_coupon_amt AS DECIMAL(12, 2))) AS agg3,\n  AVG(CAST(cs_sales_price AS DECIMAL(12, 2))) AS agg4,\n  AVG(CAST(cs_net_profit AS DECIMAL(12, 2))) AS agg5,\n  AVG(CAST(c_birth_year AS DECIMAL(12, 2))) AS agg6,\n  AVG(CAST(cd1.cd_dep_count AS DECIMAL(12, 2))) AS agg7\nFROM date_dim, customer_demographics AS cd1, customer, customer_address, customer_demographics AS cd2, item, catalog_sales\nWHERE\n  cs_sold_date_sk = d_date_sk\n  AND cs_item_sk = i_item_sk\n  AND cs_bill_cdemo_sk = cd1.cd_demo_sk\n  AND cs_bill_customer_sk = c_customer_sk\n  AND cd1.cd_gender = 'F'\n  AND cd1.cd_education_status = 'Advanced Degree'\n  AND c_current_cdemo_sk = cd2.cd_demo_sk\n  AND c_current_addr_sk = ca_address_sk\n  AND c_birth_month IN (10, 7, 8, 4, 1, 2)\n  AND d_year = 1998\n  AND ca_state IN ('WA', 'GA', 'NC', 'ME', 'WY', 'OK', 'IN')\nGROUP BY\n  ROLLUP (\n    i_item_id,\n    ca_country,\n    ca_state,\n    ca_county\n  )\nORDER BY\n  ca_country,\n  ca_state,\n  ca_county,\n  i_item_id\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0167,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3732,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5866,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3118,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2646,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6323,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.319,
          "visits": 1,
          "avg_reward": 1.2749,
          "is_valid": true,
          "speedup": 1.2749,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4828,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.322,
          "visits": 1,
          "avg_reward": 1.2749,
          "is_valid": true,
          "speedup": 1.2749,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.15,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.3249,
          "visits": 1,
          "avg_reward": 1.2749,
          "is_valid": true,
          "speedup": 1.2749,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9906,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9743,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3162,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3581,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9813,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.3276,
          "visits": 1,
          "avg_reward": 1.2749,
          "is_valid": true,
          "speedup": 1.2749,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.5764,
          "visits": 1,
          "avg_reward": 1.2749,
          "is_valid": true,
          "speedup": 1.2749
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9813
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.9617,
          "visits": 1,
          "avg_reward": 1.6602,
          "is_valid": true,
          "speedup": 1.6602
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.5898,
          "visits": 1,
          "avg_reward": 1.2749,
          "is_valid": true,
          "speedup": 1.2749
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9813
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.14,
          "visits": 2,
          "avg_reward": 0.9301,
          "is_valid": true,
          "speedup": 1.6602
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "correlated_to_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.9559,
          "visits": 2,
          "avg_reward": 0.7374,
          "is_valid": true,
          "speedup": 1.2749
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9813
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.1486,
          "visits": 2,
          "avg_reward": 0.9301,
          "is_valid": true,
          "speedup": 1.6602
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3414,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5419,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.9642,
          "visits": 2,
          "avg_reward": 0.7374,
          "is_valid": true,
          "speedup": 1.2749
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9813
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.2948,
          "visits": 3,
          "avg_reward": 1.1248,
          "is_valid": true,
          "speedup": 1.6602
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3732,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5419,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.6874,
          "visits": 1,
          "avg_reward": 1.5142,
          "is_valid": true,
          "speedup": 1.5142,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "remove_redundant",
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0645,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5873,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6936,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0645,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.3555,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.4682,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0466
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.1247,
          "visits": 2,
          "avg_reward": 0.7374,
          "is_valid": true,
          "speedup": 1.2749
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5645,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0645,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2645,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9813
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9194,
          "visits": 4,
          "avg_reward": 0.8936,
          "is_valid": true,
          "speedup": 1.6602
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "flatten_subq"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0667,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 1.2,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.1,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0667,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3944,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0466
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7819,
          "visits": 2,
          "avg_reward": 0.7374,
          "is_valid": true,
          "speedup": 1.2749
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5667,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9813
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9202,
          "visits": 4,
          "avg_reward": 0.8936,
          "is_valid": true,
          "speedup": 1.6602
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "or_to_union"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2499,
          "visits": 2,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5999,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0466
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.9873,
          "visits": 2,
          "avg_reward": 0.7374,
          "is_valid": true,
          "speedup": 1.2749
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9813
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.0435,
          "visits": 4,
          "avg_reward": 0.8936,
          "is_valid": true,
          "speedup": 1.6602
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.5419,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9237,
          "visits": 2,
          "avg_reward": 0.8571,
          "is_valid": true,
          "speedup": 1.5142,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0894,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0894,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0894,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0894,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0894,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.4893
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0824
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2571,
          "visits": 2,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6071,
          "visits": 2,
          "avg_reward": 0.35,
          "is_valid": true,
          "speedup": 1.0466
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.9946,
          "visits": 2,
          "avg_reward": 0.7374,
          "is_valid": true,
          "speedup": 1.2749
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0205
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9813
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8434,
          "visits": 5,
          "avg_reward": 0.7149,
          "is_valid": true,
          "speedup": 1.6602
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "correlated_to_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3414,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.3552,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 19,
    "avg_reward": 0.4026,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.4893,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0824,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "or_to_union",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.35,
        "is_valid": true,
        "speedup": 1.0466,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "flatten_subq",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.482,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 3,
        "avg_reward": 0.6583,
        "is_valid": true,
        "speedup": 1.2749,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "correlated_to_cte",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.3552,
            "error": null
          },
          "reorder_join": {
            "transforms": [
              "correlated_to_cte",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.5,
            "is_valid": true,
            "speedup": 1.0122,
            "error": null
          }
        }
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0205,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9813,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 5,
        "avg_reward": 0.7149,
        "is_valid": true,
        "speedup": 1.6602,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "remove_redundant",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.5419,
            "error": null
          },
          "reorder_join": {
            "transforms": [
              "remove_redundant",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.8571,
            "is_valid": true,
            "speedup": 1.5142,
            "error": null,
            "children": {
              "push_pred": {
                "transforms": [
                  "remove_redundant",
                  "reorder_join",
                  "push_pred"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.5633,
                "error": null
              }
            }
          },
          "or_to_union": {
            "transforms": [
              "remove_redundant",
              "or_to_union"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      }
    }
  }
}