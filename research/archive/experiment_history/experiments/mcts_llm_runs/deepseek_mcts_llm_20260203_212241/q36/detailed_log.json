{
  "stats": {
    "total_iterations": 19,
    "tree_size": 20,
    "successful_expansions": 19,
    "failed_expansions": 0,
    "validation_calls": 19,
    "llm_ranking_calls": 30,
    "root_visits": 19,
    "total_attempts": 19
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 21507,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.0,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM store_sales, filtered_dates AS d1, item, store\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 21484,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8282,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM date_dim AS d1, store, item, store_sales\nWHERE\n  d1.d_year = 2002\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 19026,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9941,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.2,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM store_sales, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_year = 2002\n) AS d1, item, (\n  SELECT\n    *\n  FROM store\n  WHERE\n    s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\n) AS store\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 25845,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.0,
      "output_sql": "SELECT\n  gross_margin,\n  i_category,\n  i_class,\n  lochierarchy,\n  rank_within_parent\nFROM combined_cte\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 51798,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0327,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.5,
      "output_sql": "select \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   inner join date_dim d1 on d1.d_date_sk = ss_sold_date_sk\n   inner join item on i_item_sk = ss_item_sk\n   inner join store on s_store_sk = ss_store_sk\n where\n    d1.d_year = 2002 \n    and s_state in ('SD','TN','GA','SC','MO','AL','MI','OH')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when lochierarchy = 0 then i_category end\n  ,rank_within_parent\n LIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 39788,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.0,
      "output_sql": "SELECT\n  CASE\n    WHEN NOT i_category IS NULL AND NOT i_class IS NULL\n    THEN cat_class_profit / cat_class_sales\n    WHEN NOT i_category IS NULL AND i_class IS NULL\n    THEN cat_profit / cat_sales\n    ELSE total_profit / total_sales\n  END AS gross_margin,\n  i_category,\n  i_class,\n  CASE WHEN i_category IS NULL THEN 2 WHEN i_class IS NULL THEN 1 ELSE 0 END AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY CASE WHEN i_category IS NULL THEN 2 WHEN i_class IS NULL THEN 1 ELSE 0 END, CASE WHEN NOT i_class IS NULL THEN i_category END\n    ORDER BY CASE\n      WHEN NOT i_category IS NULL AND NOT i_class IS NULL\n      THEN cat_class_profit / cat_class_sales\n      WHEN NOT i_category IS NULL AND i_class IS NULL\n      THEN cat_profit / cat_sales\n      ELSE total_profit / total_sales\n    END ASC\n  ) AS rank_within_parent\nFROM (\n  SELECT\n    i_category,\n    i_class,\n    cat_class_profit,\n    cat_class_sales,\n    cat_profit,\n    cat_sales,\n    total_profit,\n    total_sales\n  FROM aggregated\n  UNION ALL\n  SELECT\n    i_category,\n    NULL AS i_class,\n    NULL AS cat_class_profit,\n    NULL AS cat_class_sales,\n    cat_profit,\n    cat_sales,\n    NULL AS total_profit,\n    NULL AS total_sales\n  FROM aggregated\n  GROUP BY\n    i_category,\n    cat_profit,\n    cat_sales\n  UNION ALL\n  SELECT\n    NULL AS i_category,\n    NULL AS i_class,\n    NULL AS cat_class_profit,\n    NULL AS cat_class_sales,\n    NULL AS cat_profit,\n    NULL AS cat_sales,\n    total_profit,\n    total_sales\n  FROM aggregated\n  LIMIT 1\n) AS all_levels\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 21723,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0658,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.5,
      "output_sql": "WITH filtered_sales AS (\n  SELECT\n    ss_net_profit,\n    ss_ext_sales_price,\n    i_category,\n    i_class\n  FROM store_sales\n  JOIN date_dim AS d1\n    ON d1.d_date_sk = ss_sold_date_sk\n  JOIN item\n    ON i_item_sk = ss_item_sk\n  JOIN store\n    ON s_store_sk = ss_store_sk\n  WHERE\n    d1.d_year = 2002 AND s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\n)\nSELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM filtered_sales\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 48760,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.0,
      "output_sql": "WITH sales_aggregates AS (\n    SELECT \n        i_category,\n        i_class,\n        SUM(ss_net_profit) AS total_net_profit,\n        SUM(ss_ext_sales_price) AS total_sales_price\n    FROM\n        store_sales,\n        date_dim d1,\n        item,\n        store\n    WHERE\n        d1.d_year = 2002\n        AND d1.d_date_sk = ss_sold_date_sk\n        AND i_item_sk = ss_item_sk\n        AND s_store_sk = ss_store_sk\n        AND s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\n    GROUP BY\n        i_category,\n        i_class\n)\nSELECT \n    total_net_profit / total_sales_price AS gross_margin,\n    i_category,\n    i_class,\n    grouping(i_category) + grouping(i_class) AS lochierarchy,\n    rank() OVER (\n        PARTITION BY grouping(i_category) + grouping(i_class),\n        CASE WHEN grouping(i_class) = 0 THEN i_category END\n        ORDER BY total_net_profit / total_sales_price ASC\n    ) AS rank_within_parent\nFROM sales_aggregates\nGROUP BY ROLLUP(i_category, i_class)\nORDER BY\n    lochierarchy DESC,\n    CASE WHEN lochierarchy = 0 THEN i_category END,\n    rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 16,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.979,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.2,
      "output_sql": "select \n    sum(ss_net_profit)/sum(ss_ext_sales_price) as gross_margin\n   ,i_category\n   ,i_class\n   ,grouping(i_category)+grouping(i_class) as lochierarchy\n   ,rank() over (\n \tpartition by grouping(i_category)+grouping(i_class),\n \tcase when grouping(i_class) = 0 then i_category end \n \torder by sum(ss_net_profit)/sum(ss_ext_sales_price) asc) as rank_within_parent\n from\n    store_sales\n   ,date_dim       d1\n   ,item\n   ,store\n where\n    d1.d_year = 2002 \n and d1.d_date_sk = ss_sold_date_sk\n and i_item_sk  = ss_item_sk \n and s_store_sk  = ss_store_sk\n and s_state in ('SD','TN','GA','SC',\n                 'MO','AL','MI','OH')\n group by rollup(i_category,i_class)\n order by\n   lochierarchy desc\n  ,case when lochierarchy = 0 then i_category end\n  ,rank_within_parent\n LIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 13857,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1884,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 1.1884,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM store_sales, date_dim AS d1, item, store\nWHERE\n  d1.d_year = 2002\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 44618,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.7549,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 1.7549,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM store_sales, date_dim AS d1, item, store\nWHERE\n  d1.d_year = 2002\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "remove_redundant"
      ],
      "transform_id": "push_pred",
      "duration_ms": 18292,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9179,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM store_sales, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_year = 2002\n) AS d1, item, (\n  SELECT\n    *\n  FROM store\n  WHERE\n    s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\n) AS store\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "inline_cte"
      ],
      "transform_id": "remove_redundant",
      "duration_ms": 23238,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0645,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY lochierarchy, CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM store_sales, date_dim AS d1, item, store\nWHERE\n  d1.d_year = 2002\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "remove_redundant"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 20273,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0134,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.5,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM date_dim AS d1, store, item, store_sales\nWHERE\n  d1.d_year = 2002\n  AND d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\n  AND s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 15,
      "parent_path": [
        "inline_cte",
        "remove_redundant"
      ],
      "transform_id": "push_pred",
      "duration_ms": 20640,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7614,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY lochierarchy, CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM store_sales, (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_year = 2002\n) AS d1, item, (\n  SELECT\n    *\n  FROM store\n  WHERE\n    s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\n) AS store\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 16,
      "parent_path": [
        "remove_redundant",
        "reorder_join"
      ],
      "transform_id": "push_pred",
      "duration_ms": 18886,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9573,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM (\n  SELECT\n    *\n  FROM date_dim\n  WHERE\n    d_year = 2002\n) AS d1, (\n  SELECT\n    *\n  FROM store\n  WHERE\n    s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\n) AS store, item, store_sales\nWHERE\n  d1.d_date_sk = ss_sold_date_sk\n  AND i_item_sk = ss_item_sk\n  AND s_store_sk = ss_store_sk\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 17,
      "parent_path": [
        "flatten_subq"
      ],
      "transform_id": "push_pred",
      "duration_ms": 22274,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1783,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.1783,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM store_sales\nINNER JOIN (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year = 2002\n) AS d1\n  ON d1.d_date_sk = ss_sold_date_sk\nINNER JOIN item\n  ON i_item_sk = ss_item_sk\nINNER JOIN (\n  SELECT\n    s_store_sk\n  FROM store\n  WHERE\n    s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\n) AS store\n  ON s_store_sk = ss_store_sk\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 18,
      "parent_path": [
        "flatten_subq",
        "push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 25309,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9863,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year = 2002\n) AS d1\nINNER JOIN store_sales\n  ON d1.d_date_sk = ss_sold_date_sk\nINNER JOIN item\n  ON i_item_sk = ss_item_sk\nINNER JOIN (\n  SELECT\n    s_store_sk\n  FROM store\n  WHERE\n    s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\n) AS store\n  ON s_store_sk = ss_store_sk\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    },
    {
      "iteration": 19,
      "parent_path": [
        "materialize_cte"
      ],
      "transform_id": "push_pred",
      "duration_ms": 29419,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9223,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH filtered_sales AS (\n  SELECT\n    ss_net_profit,\n    ss_ext_sales_price,\n    i_category,\n    i_class\n  FROM store_sales\n  JOIN (\n    SELECT\n      *\n    FROM date_dim\n    WHERE\n      d_year = 2002\n  ) AS d1\n    ON d1.d_date_sk = ss_sold_date_sk\n  JOIN item\n    ON i_item_sk = ss_item_sk\n  JOIN (\n    SELECT\n      *\n    FROM store\n    WHERE\n      s_state IN ('SD', 'TN', 'GA', 'SC', 'MO', 'AL', 'MI', 'OH')\n  ) AS store\n    ON s_store_sk = ss_store_sk\n)\nSELECT\n  SUM(ss_net_profit) / SUM(ss_ext_sales_price) AS gross_margin,\n  i_category,\n  i_class,\n  GROUPING(i_category) + GROUPING(i_class) AS lochierarchy,\n  RANK() OVER (\n    PARTITION BY GROUPING(i_category) + GROUPING(i_class), CASE WHEN GROUPING(i_class) = 0 THEN i_category END\n    ORDER BY SUM(ss_net_profit) / SUM(ss_ext_sales_price) ASC\n  ) AS rank_within_parent\nFROM filtered_sales\nGROUP BY\n  ROLLUP (\n    i_category,\n    i_class\n  )\nORDER BY\n  lochierarchy DESC,\n  CASE WHEN lochierarchy = 0 THEN i_category END,\n  rank_within_parent\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0167,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3118,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5373,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4449,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3225,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5408,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3323,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5441,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4828,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3414,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9906,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6743,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8162,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.3465,
          "visits": 1,
          "avg_reward": 1.1884,
          "is_valid": true,
          "speedup": 1.1884,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8015,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3015,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5015,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4899,
          "visits": 1,
          "avg_reward": 1.1884,
          "is_valid": true,
          "speedup": 1.1884
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.0564,
          "visits": 1,
          "avg_reward": 1.7549,
          "is_valid": true,
          "speedup": 1.7549
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3149,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5033,
          "visits": 1,
          "avg_reward": 1.1884,
          "is_valid": true,
          "speedup": 1.1884
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.1874,
          "visits": 2,
          "avg_reward": 0.9774,
          "is_valid": true,
          "speedup": 1.7549
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8278,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3278,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5278,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.0627,
          "visits": 2,
          "avg_reward": 0.8442,
          "is_valid": true,
          "speedup": 1.1884
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.196,
          "visits": 2,
          "avg_reward": 0.9774,
          "is_valid": true,
          "speedup": 1.7549
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3414,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9179,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8402,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3402,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5402,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.071,
          "visits": 2,
          "avg_reward": 0.8442,
          "is_valid": true,
          "speedup": 1.1884
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9884,
          "visits": 3,
          "avg_reward": 0.8183,
          "is_valid": true,
          "speedup": 1.7549
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "inline_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0645,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "inline_cte",
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5521,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5521,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8521,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3521,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5521,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8055,
          "visits": 3,
          "avg_reward": 0.6295,
          "is_valid": true,
          "speedup": 1.1884
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9943,
          "visits": 3,
          "avg_reward": 0.8183,
          "is_valid": true,
          "speedup": 1.7549
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "remove_redundant"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3732,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9179,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6732,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0134,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "remove_redundant",
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0327
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8636,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3636,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5636,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8113,
          "visits": 3,
          "avg_reward": 0.6295,
          "is_valid": true,
          "speedup": 1.1884
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8092,
          "visits": 4,
          "avg_reward": 0.6637,
          "is_valid": true,
          "speedup": 1.7549
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "flatten_subq"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.089,
          "visits": 2,
          "avg_reward": 0.8392,
          "is_valid": true,
          "speedup": 1.0327
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8748,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3748,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5748,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8169,
          "visits": 3,
          "avg_reward": 0.6295,
          "is_valid": true,
          "speedup": 1.1884
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.8137,
          "visits": 4,
          "avg_reward": 0.6637,
          "is_valid": true,
          "speedup": 1.7549
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "flatten_subq"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.3197,
          "visits": 1,
          "avg_reward": 1.1783,
          "is_valid": true,
          "speedup": 1.1783,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "flatten_subq",
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8282
        },
        {
          "transform_id": "push_pred",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9941
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.819,
          "visits": 3,
          "avg_reward": 0.6261,
          "is_valid": true,
          "speedup": 1.0327
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8857,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0658
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3857,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5857,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.979
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8223,
          "visits": 3,
          "avg_reward": 0.6295,
          "is_valid": true,
          "speedup": 1.1884
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.818,
          "visits": 4,
          "avg_reward": 0.6637,
          "is_valid": true,
          "speedup": 1.7549
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_best"
    },
    {
      "node_path": [
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 19,
    "avg_reward": 0.4064,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.8282,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9941,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 3,
        "avg_reward": 0.6261,
        "is_valid": true,
        "speedup": 1.0327,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "flatten_subq",
              "push_pred"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.6892,
            "is_valid": true,
            "speedup": 1.1783,
            "error": null,
            "children": {
              "reorder_join": {
                "transforms": [
                  "flatten_subq",
                  "push_pred",
                  "reorder_join"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.9863,
                "error": null
              }
            }
          }
        }
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.35,
        "is_valid": true,
        "speedup": 1.0658,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "materialize_cte",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9223,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.979,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 3,
        "avg_reward": 0.6295,
        "is_valid": true,
        "speedup": 1.1884,
        "error": null,
        "children": {
          "remove_redundant": {
            "transforms": [
              "inline_cte",
              "remove_redundant"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.35,
            "is_valid": true,
            "speedup": 1.0645,
            "error": null,
            "children": {
              "push_pred": {
                "transforms": [
                  "inline_cte",
                  "remove_redundant",
                  "push_pred"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.7614,
                "error": null
              }
            }
          }
        }
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 4,
        "avg_reward": 0.6637,
        "is_valid": true,
        "speedup": 1.7549,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "remove_redundant",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9179,
            "error": null
          },
          "reorder_join": {
            "transforms": [
              "remove_redundant",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.35,
            "is_valid": true,
            "speedup": 1.0134,
            "error": null,
            "children": {
              "push_pred": {
                "transforms": [
                  "remove_redundant",
                  "reorder_join",
                  "push_pred"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.9573,
                "error": null
              }
            }
          }
        }
      }
    }
  }
}