{
  "stats": {
    "total_iterations": 14,
    "tree_size": 15,
    "successful_expansions": 14,
    "failed_expansions": 0,
    "validation_calls": 14,
    "llm_ranking_calls": 19,
    "root_visits": 14,
    "total_attempts": 14
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 51063,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9418,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.2,
      "output_sql": "WITH ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ss_store_sk AS store_sk,\n      ss_sold_date_sk AS date_sk,\n      ss_ext_sales_price AS sales_price,\n      ss_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM store_sales\n    JOIN date_dim\n      ON ss_sold_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n    UNION ALL\n    SELECT\n      sr_store_sk AS store_sk,\n      sr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      sr_return_amt AS return_amt,\n      sr_net_loss AS net_loss\n    FROM store_returns\n    JOIN date_dim\n      ON sr_returned_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n  ) AS salesreturns, store\n  WHERE\n    store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      cs_catalog_page_sk AS page_sk,\n      cs_sold_date_sk AS date_sk,\n      cs_ext_sales_price AS sales_price,\n      cs_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM catalog_sales\n    JOIN date_dim\n      ON cs_sold_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n    UNION ALL\n    SELECT\n      cr_catalog_page_sk AS page_sk,\n      cr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      cr_return_amount AS return_amt,\n      cr_net_loss AS net_loss\n    FROM catalog_returns\n    JOIN date_dim\n      ON cr_returned_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n  ) AS salesreturns, catalog_page\n  WHERE\n    page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      ws_sold_date_sk AS date_sk,\n      ws_ext_sales_price AS sales_price,\n      ws_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales\n    JOIN date_dim\n      ON ws_sold_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n    UNION ALL\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      wr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      wr_return_amt AS return_amt,\n      wr_net_loss AS net_loss\n    FROM web_returns\n    JOIN date_dim\n      ON wr_returned_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n    LEFT OUTER JOIN web_sales\n      ON (\n        wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n      )\n  ) AS salesreturns, web_site\n  WHERE\n    wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "date_cte_isolate",
      "duration_ms": 63100,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.923,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n), ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ss_store_sk AS store_sk,\n      ss_sold_date_sk AS date_sk,\n      ss_ext_sales_price AS sales_price,\n      ss_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM store_sales\n    UNION ALL\n    SELECT\n      sr_store_sk AS store_sk,\n      sr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      sr_return_amt AS return_amt,\n      sr_net_loss AS net_loss\n    FROM store_returns\n  ) AS salesreturns, filtered_dates, store\n  WHERE\n    date_sk = d_date_sk AND store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      cs_catalog_page_sk AS page_sk,\n      cs_sold_date_sk AS date_sk,\n      cs_ext_sales_price AS sales_price,\n      cs_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      cr_catalog_page_sk AS page_sk,\n      cr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      cr_return_amount AS return_amt,\n      cr_net_loss AS net_loss\n    FROM catalog_returns\n  ) AS salesreturns, filtered_dates, catalog_page\n  WHERE\n    date_sk = d_date_sk AND page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      ws_sold_date_sk AS date_sk,\n      ws_ext_sales_price AS sales_price,\n      ws_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales\n    UNION ALL\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      wr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      wr_return_amt AS return_amt,\n      wr_net_loss AS net_loss\n    FROM web_returns\n    LEFT OUTER JOIN web_sales\n      ON (\n        wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n      )\n  ) AS salesreturns, filtered_dates, web_site\n  WHERE\n    date_sk = d_date_sk AND wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 55857,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.0,
      "output_sql": "WITH combined_data AS (\n  SELECT\n    channel_type,\n    entity_sk,\n    date_sk,\n    sales_price,\n    profit,\n    return_amt,\n    net_loss\n  FROM combined_sales_returns\n), date_filtered AS (\n  SELECT\n    channel_type,\n    entity_sk,\n    sales_price,\n    profit,\n    return_amt,\n    net_loss\n  FROM combined_data, date_dim\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n), ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM date_filtered, store\n  WHERE\n    channel_type = 'store' AND entity_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM date_filtered, catalog_page\n  WHERE\n    channel_type = 'catalog' AND entity_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM date_filtered, web_site\n  WHERE\n    channel_type = 'web' AND entity_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 48421,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0086,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.5,
      "output_sql": "WITH ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM date_dim, store, (\n    SELECT\n      ss_store_sk AS store_sk,\n      ss_sold_date_sk AS date_sk,\n      ss_ext_sales_price AS sales_price,\n      ss_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM store_sales\n    UNION ALL\n    SELECT\n      sr_store_sk AS store_sk,\n      sr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      sr_return_amt AS return_amt,\n      sr_net_loss AS net_loss\n    FROM store_returns\n  ) AS salesreturns\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM date_dim, catalog_page, (\n    SELECT\n      cs_catalog_page_sk AS page_sk,\n      cs_sold_date_sk AS date_sk,\n      cs_ext_sales_price AS sales_price,\n      cs_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      cr_catalog_page_sk AS page_sk,\n      cr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      cr_return_amount AS return_amt,\n      cr_net_loss AS net_loss\n    FROM catalog_returns\n  ) AS salesreturns\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM date_dim, web_site, (\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      ws_sold_date_sk AS date_sk,\n      ws_ext_sales_price AS sales_price,\n      ws_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales\n    UNION ALL\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      wr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      wr_return_amt AS return_amt,\n      wr_net_loss AS net_loss\n    FROM web_returns\n    LEFT OUTER JOIN web_sales\n      ON (\n        wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n      )\n  ) AS salesreturns\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 73364,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1032,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 1.1032,
      "output_sql": "WITH ssr_sales AS (\n  SELECT\n    s_store_id,\n    SUM(ss_ext_sales_price) AS sales,\n    SUM(ss_net_profit) AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS \"returns\",\n    CAST(0 AS DECIMAL(7, 2)) AS profit_loss\n  FROM store_sales, date_dim, store\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND ss_store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), ssr_returns AS (\n  SELECT\n    s_store_id,\n    CAST(0 AS DECIMAL(7, 2)) AS sales,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    SUM(sr_return_amt) AS \"returns\",\n    SUM(sr_net_loss) AS profit_loss\n  FROM store_returns, date_dim, store\n  WHERE\n    sr_returned_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND sr_store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales) AS sales,\n    SUM(profit) AS profit,\n    SUM(\"returns\") AS \"returns\",\n    SUM(profit_loss) AS profit_loss\n  FROM (\n    SELECT\n      s_store_id,\n      sales,\n      profit,\n      \"returns\",\n      profit_loss\n    FROM ssr_sales\n    UNION ALL\n    SELECT\n      s_store_id,\n      sales,\n      profit,\n      \"returns\",\n      profit_loss\n    FROM ssr_returns\n  ) AS combined\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      cs_catalog_page_sk AS page_sk,\n      cs_sold_date_sk AS date_sk,\n      cs_ext_sales_price AS sales_price,\n      cs_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      cr_catalog_page_sk AS page_sk,\n      cr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      cr_return_amount AS return_amt,\n      cr_net_loss AS net_loss\n    FROM catalog_returns\n  ) AS salesreturns, date_dim, catalog_page\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      ws_sold_date_sk AS date_sk,\n      ws_ext_sales_price AS sales_price,\n      ws_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales\n    UNION ALL\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      wr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      wr_return_amt AS return_amt,\n      wr_net_loss AS net_loss\n    FROM web_returns\n    LEFT OUTER JOIN web_sales\n      ON (\n        wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n      )\n  ) AS salesreturns, date_dim, web_site\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 73220,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1653,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 1.1653,
      "output_sql": "WITH store_sales_returns AS (\n  SELECT\n    ss_store_sk AS store_sk,\n    ss_sold_date_sk AS date_sk,\n    ss_ext_sales_price AS sales_price,\n    ss_net_profit AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n    CAST(0 AS DECIMAL(7, 2)) AS net_loss\n  FROM store_sales\n  UNION ALL\n  SELECT\n    sr_store_sk AS store_sk,\n    sr_returned_date_sk AS date_sk,\n    CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    sr_return_amt AS return_amt,\n    sr_net_loss AS net_loss\n  FROM store_returns\n), catalog_sales_returns AS (\n  SELECT\n    cs_catalog_page_sk AS page_sk,\n    cs_sold_date_sk AS date_sk,\n    cs_ext_sales_price AS sales_price,\n    cs_net_profit AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n    CAST(0 AS DECIMAL(7, 2)) AS net_loss\n  FROM catalog_sales\n  UNION ALL\n  SELECT\n    cr_catalog_page_sk AS page_sk,\n    cr_returned_date_sk AS date_sk,\n    CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    cr_return_amount AS return_amt,\n    cr_net_loss AS net_loss\n  FROM catalog_returns\n), web_sales_returns AS (\n  SELECT\n    ws_web_site_sk AS wsr_web_site_sk,\n    ws_sold_date_sk AS date_sk,\n    ws_ext_sales_price AS sales_price,\n    ws_net_profit AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n    CAST(0 AS DECIMAL(7, 2)) AS net_loss\n  FROM web_sales\n  UNION ALL\n  SELECT\n    ws_web_site_sk AS wsr_web_site_sk,\n    wr_returned_date_sk AS date_sk,\n    CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    wr_return_amt AS return_amt,\n    wr_net_loss AS net_loss\n  FROM web_returns\n  LEFT OUTER JOIN web_sales\n    ON (\n      wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n    )\n), ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM store_sales_returns, date_dim, store\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM catalog_sales_returns, date_dim, catalog_page\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM web_sales_returns, date_dim, web_site\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [
        "materialize_cte"
      ],
      "transform_id": "flatten_subq",
      "duration_ms": 77292,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9142,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH store_sales_returns AS (\n  SELECT\n    ss_store_sk AS store_sk,\n    ss_sold_date_sk AS date_sk,\n    ss_ext_sales_price AS sales_price,\n    ss_net_profit AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n    CAST(0 AS DECIMAL(7, 2)) AS net_loss\n  FROM store_sales\n  UNION ALL\n  SELECT\n    sr_store_sk AS store_sk,\n    sr_returned_date_sk AS date_sk,\n    CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    sr_return_amt AS return_amt,\n    sr_net_loss AS net_loss\n  FROM store_returns\n), catalog_sales_returns AS (\n  SELECT\n    cs_catalog_page_sk AS page_sk,\n    cs_sold_date_sk AS date_sk,\n    cs_ext_sales_price AS sales_price,\n    cs_net_profit AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n    CAST(0 AS DECIMAL(7, 2)) AS net_loss\n  FROM catalog_sales\n  UNION ALL\n  SELECT\n    cr_catalog_page_sk AS page_sk,\n    cr_returned_date_sk AS date_sk,\n    CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    cr_return_amount AS return_amt,\n    cr_net_loss AS net_loss\n  FROM catalog_returns\n), web_sales_returns AS (\n  SELECT\n    ws_web_site_sk AS wsr_web_site_sk,\n    ws_sold_date_sk AS date_sk,\n    ws_ext_sales_price AS sales_price,\n    ws_net_profit AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n    CAST(0 AS DECIMAL(7, 2)) AS net_loss\n  FROM web_sales\n  UNION ALL\n  SELECT\n    ws_web_site_sk AS wsr_web_site_sk,\n    wr_returned_date_sk AS date_sk,\n    CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    wr_return_amt AS return_amt,\n    wr_net_loss AS net_loss\n  FROM web_returns\n  LEFT OUTER JOIN web_sales\n    ON (\n      wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n    )\n), ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM store_sales_returns\n  JOIN date_dim ON date_sk = d_date_sk\n  JOIN store ON store_sk = s_store_sk\n  WHERE d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n  GROUP BY s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM catalog_sales_returns\n  JOIN date_dim ON date_sk = d_date_sk\n  JOIN catalog_page ON page_sk = cp_catalog_page_sk\n  WHERE d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n  GROUP BY cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM web_sales_returns\n  JOIN date_dim ON date_sk = d_date_sk\n  JOIN web_site ON wsr_web_site_sk = web_site_sk\n  WHERE d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n  GROUP BY web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (profit - profit_loss) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (profit - profit_loss) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (profit - profit_loss) AS profit\n  FROM wsr\n) AS x\nGROUP BY ROLLUP(channel, id)\nORDER BY channel, id\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 73066,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0974,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.5,
      "output_sql": "WITH store_sales_returns AS (\n  SELECT\n    ss_store_sk AS store_sk,\n    ss_sold_date_sk AS date_sk,\n    ss_ext_sales_price AS sales_price,\n    ss_net_profit AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n    CAST(0 AS DECIMAL(7, 2)) AS net_loss\n  FROM store_sales\n  UNION ALL\n  SELECT\n    sr_store_sk AS store_sk,\n    sr_returned_date_sk AS date_sk,\n    CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    sr_return_amt AS return_amt,\n    sr_net_loss AS net_loss\n  FROM store_returns\n), catalog_sales_returns AS (\n  SELECT\n    cs_catalog_page_sk AS page_sk,\n    cs_sold_date_sk AS date_sk,\n    cs_ext_sales_price AS sales_price,\n    cs_net_profit AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n    CAST(0 AS DECIMAL(7, 2)) AS net_loss\n  FROM catalog_sales\n  UNION ALL\n  SELECT\n    cr_catalog_page_sk AS page_sk,\n    cr_returned_date_sk AS date_sk,\n    CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    cr_return_amount AS return_amt,\n    cr_net_loss AS net_loss\n  FROM catalog_returns\n), web_sales_returns AS (\n  SELECT\n    ws_web_site_sk AS wsr_web_site_sk,\n    ws_sold_date_sk AS date_sk,\n    ws_ext_sales_price AS sales_price,\n    ws_net_profit AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n    CAST(0 AS DECIMAL(7, 2)) AS net_loss\n  FROM web_sales\n  UNION ALL\n  SELECT\n    ws_web_site_sk AS wsr_web_site_sk,\n    wr_returned_date_sk AS date_sk,\n    CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    wr_return_amt AS return_amt,\n    wr_net_loss AS net_loss\n  FROM web_returns\n  LEFT OUTER JOIN web_sales\n    ON (\n      wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n    )\n), ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM store_sales_returns, date_dim, store\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM catalog_sales_returns, date_dim, catalog_page\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM web_sales_returns, date_dim, web_site\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 76,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9292,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.2,
      "output_sql": "with ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as \"returns\",\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('2000-08-19' as date) \n                  and (cast('2000-08-19' as date) + INTERVAL 14 DAY)\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as \"returns\",\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('2000-08-19' as date)\n                  and (cast('2000-08-19' as date) + INTERVAL 14 DAY)\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as \"returns\",\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('2000-08-19' as date)\n                  and (cast('2000-08-19' as date) + INTERVAL 14 DAY)\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n  select channel\n        , id\n        , sum(sales) as sales\n        , sum(\"returns\") as \"returns\"\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , \"returns\"\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , \"returns\"\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , \"returns\"\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by rollup (channel, id)\n order by channel\n         ,id\n LIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "inline_cte",
      "duration_ms": 82961,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.6693,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.2,
      "output_sql": "WITH ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ss_store_sk AS store_sk,\n      ss_sold_date_sk AS date_sk,\n      ss_ext_sales_price AS sales_price,\n      ss_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM store_sales\n    UNION ALL\n    SELECT\n      sr_store_sk AS store_sk,\n      sr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      sr_return_amt AS return_amt,\n      sr_net_loss AS net_loss\n    FROM store_returns\n  ) AS salesreturns, date_dim, store\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      cs_catalog_page_sk AS page_sk,\n      cs_sold_date_sk AS date_sk,\n      cs_ext_sales_price AS sales_price,\n      cs_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      cr_catalog_page_sk AS page_sk,\n      cr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      cr_return_amount AS return_amt,\n      cr_net_loss AS net_loss\n    FROM catalog_returns\n  ) AS salesreturns, date_dim, catalog_page\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      ws_sold_date_sk AS date_sk,\n      ws_ext_sales_price AS sales_price,\n      ws_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales\n    UNION ALL\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      wr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      wr_return_amt AS return_amt,\n      wr_net_loss AS net_loss\n    FROM web_returns\n    LEFT OUTER JOIN web_sales\n      ON (\n        wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n      )\n  ) AS salesreturns, date_dim, web_site\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 18666,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7558,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 10,
      "reward": 0.2,
      "output_sql": "WITH ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ss_store_sk AS store_sk,\n      ss_sold_date_sk AS date_sk,\n      ss_ext_sales_price AS sales_price,\n      ss_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM store_sales\n    UNION ALL\n    SELECT\n      sr_store_sk AS store_sk,\n      sr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      sr_return_amt AS return_amt,\n      sr_net_loss AS net_loss\n    FROM store_returns\n  ) AS salesreturns, date_dim, store\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      cs_catalog_page_sk AS page_sk,\n      cs_sold_date_sk AS date_sk,\n      cs_ext_sales_price AS sales_price,\n      cs_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      cr_catalog_page_sk AS page_sk,\n      cr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      cr_return_amount AS return_amt,\n      cr_net_loss AS net_loss\n    FROM catalog_returns\n  ) AS salesreturns, date_dim, catalog_page\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      ws_sold_date_sk AS date_sk,\n      ws_ext_sales_price AS sales_price,\n      ws_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales\n    UNION ALL\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      wr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      wr_return_amt AS return_amt,\n      wr_net_loss AS net_loss\n    FROM web_returns\n    LEFT OUTER JOIN web_sales\n      ON (\n        wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n      )\n  ) AS salesreturns, date_dim, web_site\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 187992,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH combined_data AS (\n  SELECT\n    channel_type,\n    entity_sk,\n    date_sk,\n    sales_price,\n    profit,\n    return_amt,\n    net_loss\n  FROM combined_sales_returns\n), date_filtered AS (\n  SELECT\n    channel_type,\n    entity_sk,\n    sales_price,\n    profit,\n    return_amt,\n    net_loss\n  FROM combined_data, date_dim\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n), ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM date_filtered, store\n  WHERE\n    channel_type = 'store' AND entity_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM date_filtered, catalog_page\n  WHERE\n    channel_type = 'catalog' AND entity_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM date_filtered, web_site\n  WHERE\n    channel_type = 'web' AND entity_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "or_to_union"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 66360,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0286,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.5,
      "output_sql": "WITH ssr_sales AS (\n  SELECT\n    s_store_id,\n    SUM(ss_ext_sales_price) AS sales,\n    SUM(ss_net_profit) AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS \"returns\",\n    CAST(0 AS DECIMAL(7, 2)) AS profit_loss\n  FROM store_sales, date_dim, store\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND ss_store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), ssr_returns AS (\n  SELECT\n    s_store_id,\n    CAST(0 AS DECIMAL(7, 2)) AS sales,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    SUM(sr_return_amt) AS \"returns\",\n    SUM(sr_net_loss) AS profit_loss\n  FROM store_returns, date_dim, store\n  WHERE\n    sr_returned_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND sr_store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales) AS sales,\n    SUM(profit) AS profit,\n    SUM(\"returns\") AS \"returns\",\n    SUM(profit_loss) AS profit_loss\n  FROM (\n    SELECT\n      s_store_id,\n      sales,\n      profit,\n      \"returns\",\n      profit_loss\n    FROM ssr_sales\n    UNION ALL\n    SELECT\n      s_store_id,\n      sales,\n      profit,\n      \"returns\",\n      profit_loss\n    FROM ssr_returns\n  ) AS combined\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      cs_catalog_page_sk AS page_sk,\n      cs_sold_date_sk AS date_sk,\n      cs_ext_sales_price AS sales_price,\n      cs_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM catalog_sales\n    UNION ALL\n    SELECT\n      cr_catalog_page_sk AS page_sk,\n      cr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      cr_return_amount AS return_amt,\n      cr_net_loss AS net_loss\n    FROM catalog_returns\n  ) AS salesreturns, date_dim, catalog_page\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      ws_sold_date_sk AS date_sk,\n      ws_ext_sales_price AS sales_price,\n      ws_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales\n    UNION ALL\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      wr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      wr_return_amt AS return_amt,\n      wr_net_loss AS net_loss\n    FROM web_returns\n    LEFT OUTER JOIN web_sales\n      ON (\n        wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n      )\n  ) AS salesreturns, date_dim, web_site\n  WHERE\n    date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "or_to_union",
        "consolidate_scans"
      ],
      "transform_id": "push_pred",
      "duration_ms": 71528,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "WITH ssr_sales AS (\n  SELECT\n    s_store_id,\n    SUM(ss_ext_sales_price) AS sales,\n    SUM(ss_net_profit) AS profit,\n    CAST(0 AS DECIMAL(7, 2)) AS \"returns\",\n    CAST(0 AS DECIMAL(7, 2)) AS profit_loss\n  FROM store_sales, date_dim, store\n  WHERE\n    ss_sold_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND ss_store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), ssr_returns AS (\n  SELECT\n    s_store_id,\n    CAST(0 AS DECIMAL(7, 2)) AS sales,\n    CAST(0 AS DECIMAL(7, 2)) AS profit,\n    SUM(sr_return_amt) AS \"returns\",\n    SUM(sr_net_loss) AS profit_loss\n  FROM store_returns, date_dim, store\n  WHERE\n    sr_returned_date_sk = d_date_sk\n    AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n      CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n    )\n    AND sr_store_sk = s_store_sk\n  GROUP BY\n    s_store_id\n), ssr AS (\n  SELECT\n    s_store_id,\n    SUM(sales) AS sales,\n    SUM(profit) AS profit,\n    SUM(\"returns\") AS \"returns\",\n    SUM(profit_loss) AS profit_loss\n  FROM (\n    SELECT\n      s_store_id,\n      sales,\n      profit,\n      \"returns\",\n      profit_loss\n    FROM ssr_sales\n    UNION ALL\n    SELECT\n      s_store_id,\n      sales,\n      profit,\n      \"returns\",\n      profit_loss\n    FROM ssr_returns\n  ) AS combined\n  GROUP BY\n    s_store_id\n), csr AS (\n  SELECT\n    cp_catalog_page_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      cs_catalog_page_sk AS page_sk,\n      cs_sold_date_sk AS date_sk,\n      cs_ext_sales_price AS sales_price,\n      cs_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM catalog_sales, date_dim\n    WHERE\n      cs_sold_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n    UNION ALL\n    SELECT\n      cr_catalog_page_sk AS page_sk,\n      cr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      cr_return_amount AS return_amt,\n      cr_net_loss AS net_loss\n    FROM catalog_returns, date_dim\n    WHERE\n      cr_returned_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n  ) AS salesreturns, catalog_page\n  WHERE\n    page_sk = cp_catalog_page_sk\n  GROUP BY\n    cp_catalog_page_id\n), wsr AS (\n  SELECT\n    web_site_id,\n    SUM(sales_price) AS sales,\n    SUM(profit) AS profit,\n    SUM(return_amt) AS \"returns\",\n    SUM(net_loss) AS profit_loss\n  FROM (\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      ws_sold_date_sk AS date_sk,\n      ws_ext_sales_price AS sales_price,\n      ws_net_profit AS profit,\n      CAST(0 AS DECIMAL(7, 2)) AS return_amt,\n      CAST(0 AS DECIMAL(7, 2)) AS net_loss\n    FROM web_sales, date_dim\n    WHERE\n      ws_sold_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n    UNION ALL\n    SELECT\n      ws_web_site_sk AS wsr_web_site_sk,\n      wr_returned_date_sk AS date_sk,\n      CAST(0 AS DECIMAL(7, 2)) AS sales_price,\n      CAST(0 AS DECIMAL(7, 2)) AS profit,\n      wr_return_amt AS return_amt,\n      wr_net_loss AS net_loss\n    FROM web_returns, date_dim\n    LEFT OUTER JOIN web_sales\n      ON (\n        wr_item_sk = ws_item_sk AND wr_order_number = ws_order_number\n      )\n    WHERE\n      wr_returned_date_sk = d_date_sk\n      AND d_date BETWEEN CAST('2000-08-19' AS DATE) AND (\n        CAST('2000-08-19' AS DATE) + INTERVAL '14' DAY\n      )\n  ) AS salesreturns, web_site\n  WHERE\n    wsr_web_site_sk = web_site_sk\n  GROUP BY\n    web_site_id\n)\nSELECT\n  channel,\n  id,\n  SUM(sales) AS sales,\n  SUM(\"returns\") AS \"returns\",\n  SUM(profit) AS profit\nFROM (\n  SELECT\n    'store channel' AS channel,\n    'store' || s_store_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM ssr\n  UNION ALL\n  SELECT\n    'catalog channel' AS channel,\n    'catalog_page' || cp_catalog_page_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM csr\n  UNION ALL\n  SELECT\n    'web channel' AS channel,\n    'web_site' || web_site_id AS id,\n    sales,\n    \"returns\",\n    (\n      profit - profit_loss\n    ) AS profit\n  FROM wsr\n) AS x\nGROUP BY\n  ROLLUP (\n    channel,\n    id\n  )\nORDER BY\n  channel,\n  id\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3732,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5333,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6118,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1405,
          "visits": 1,
          "avg_reward": 1.1032,
          "is_valid": true,
          "speedup": 1.1032,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0373,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4449,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6225,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.2062,
          "visits": 1,
          "avg_reward": 1.1653,
          "is_valid": true,
          "speedup": 1.1653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.144,
          "visits": 1,
          "avg_reward": 1.1032,
          "is_valid": true,
          "speedup": 1.1032,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.8124,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8573,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6323,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7121,
          "visits": 2,
          "avg_reward": 0.6827,
          "is_valid": true,
          "speedup": 1.1653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1473,
          "visits": 1,
          "avg_reward": 1.1032,
          "is_valid": true,
          "speedup": 1.1032,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4828,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6414,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7141,
          "visits": 2,
          "avg_reward": 0.6827,
          "is_valid": true,
          "speedup": 1.1653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1503,
          "visits": 1,
          "avg_reward": 1.1032,
          "is_valid": true,
          "speedup": 1.1032,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5471,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0974,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.65,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7827,
          "visits": 2,
          "avg_reward": 0.6827,
          "is_valid": true,
          "speedup": 1.1653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 2.2136,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.5811,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9292,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1532,
          "visits": 1,
          "avg_reward": 1.1032,
          "is_valid": true,
          "speedup": 1.1032,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0974,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.05,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5162,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6581,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7178,
          "visits": 2,
          "avg_reward": 0.6827,
          "is_valid": true,
          "speedup": 1.1653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6693,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1106,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 2.3216,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9292,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1559,
          "visits": 1,
          "avg_reward": 1.1032,
          "is_valid": true,
          "speedup": 1.1032,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5527,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0974,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.6743,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7906,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6975,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8317,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7932,
          "visits": 2,
          "avg_reward": 0.6827,
          "is_valid": true,
          "speedup": 1.1653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6693,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1155,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7558,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9292,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.1585,
          "visits": 1,
          "avg_reward": 1.1032,
          "is_valid": true,
          "speedup": 1.1032,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5553,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0974,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.0292,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.1608,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.8926,
          "visits": 2,
          "avg_reward": 0.6827,
          "is_valid": true,
          "speedup": 1.1653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6693,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.6556,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7558,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9292,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.4181,
          "visits": 1,
          "avg_reward": 1.1032,
          "is_valid": true,
          "speedup": 1.1032,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.8149,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0974,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5149,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.2099,
          "visits": 2,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "or_to_union"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5606,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9418,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6803,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0086,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7227,
          "visits": 2,
          "avg_reward": 0.6827,
          "is_valid": true,
          "speedup": 1.1653,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2601,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.6693,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2601,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7558,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2601,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9292,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.6429,
          "visits": 2,
          "avg_reward": 0.8016,
          "is_valid": true,
          "speedup": 1.1032,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.5601,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0974,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.923,
          "status": "tried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6009,
          "visits": 2,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "or_to_union"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.995,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0286,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "or_to_union",
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.3143,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 14,
    "avg_reward": 0.3549,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9418,
        "error": null
      },
      "date_cte_isolate": {
        "transforms": [
          "date_cte_isolate"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.923,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "consolidate_scans",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          }
        }
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0086,
        "error": null
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 3,
        "avg_reward": 0.5344,
        "is_valid": true,
        "speedup": 1.1032,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "or_to_union",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.25,
            "is_valid": true,
            "speedup": 1.0286,
            "error": null,
            "children": {
              "push_pred": {
                "transforms": [
                  "or_to_union",
                  "consolidate_scans",
                  "push_pred"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.0,
                "is_valid": false,
                "speedup": 0,
                "error": null
              }
            }
          }
        }
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.6827,
        "is_valid": true,
        "speedup": 1.1653,
        "error": null,
        "children": {
          "flatten_subq": {
            "transforms": [
              "materialize_cte",
              "flatten_subq"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9142,
            "error": null
          }
        }
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.5,
        "is_valid": true,
        "speedup": 1.0974,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9292,
        "error": null
      },
      "inline_cte": {
        "transforms": [
          "inline_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.6693,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.7558,
        "error": null
      }
    }
  }
}