{
  "stats": {
    "total_iterations": 9,
    "tree_size": 10,
    "successful_expansions": 9,
    "failed_expansions": 0,
    "validation_calls": 9,
    "llm_ranking_calls": 10,
    "root_visits": 9,
    "total_attempts": 9
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 32606,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.168,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 1.168,
      "output_sql": "SELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) AS cnt1,\n  cd_purchase_estimate,\n  COUNT(*) AS cnt2,\n  cd_credit_rating,\n  COUNT(*) AS cnt3,\n  cd_dep_count,\n  COUNT(*) AS cnt4,\n  cd_dep_employed_count,\n  COUNT(*) AS cnt5,\n  cd_dep_college_count,\n  COUNT(*) AS cnt6\nFROM customer AS c, customer_address AS ca, customer_demographics\nWHERE\n  c.c_current_addr_sk = ca.ca_address_sk\n  AND ca_county IN (\n    'Storey County',\n    'Marquette County',\n    'Warren County',\n    'Cochran County',\n    'Kandiyohi County'\n  )\n  AND cd_demo_sk = c.c_current_cdemo_sk\n  AND EXISTS(\n    SELECT\n      *\n    FROM store_sales, date_dim\n    WHERE\n      c.c_customer_sk = ss_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year = 2001\n      AND d_moy BETWEEN 1 AND 1 + 3\n  )\n  AND (\n    EXISTS(\n      SELECT\n        *\n      FROM web_sales, date_dim\n      WHERE\n        c.c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy BETWEEN 1 AND 1 + 3\n    )\n    OR EXISTS(\n      SELECT\n        *\n      FROM catalog_sales, date_dim\n      WHERE\n        c.c_customer_sk = cs_ship_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy BETWEEN 1 AND 1 + 3\n    )\n  )\nGROUP BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "date_cte_isolate",
      "duration_ms": 33768,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9657,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "WITH filtered_dates AS (\n  SELECT\n    d_date_sk\n  FROM date_dim\n  WHERE\n    d_year = 2001 AND d_moy BETWEEN 1 AND 4\n)\nSELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) AS cnt1,\n  cd_purchase_estimate,\n  COUNT(*) AS cnt2,\n  cd_credit_rating,\n  COUNT(*) AS cnt3,\n  cd_dep_count,\n  COUNT(*) AS cnt4,\n  cd_dep_employed_count,\n  COUNT(*) AS cnt5,\n  cd_dep_college_count,\n  COUNT(*) AS cnt6\nFROM customer AS c, customer_address AS ca, customer_demographics\nWHERE\n  c.c_current_addr_sk = ca.ca_address_sk\n  AND ca_county IN (\n    'Storey County',\n    'Marquette County',\n    'Warren County',\n    'Cochran County',\n    'Kandiyohi County'\n  )\n  AND cd_demo_sk = c.c_current_cdemo_sk\n  AND EXISTS(\n    SELECT\n      *\n    FROM store_sales\n    JOIN filtered_dates\n      ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk\n    WHERE\n      c.c_customer_sk = ss_customer_sk\n  )\n  AND (\n    EXISTS(\n      SELECT\n        *\n      FROM web_sales\n      JOIN filtered_dates\n        ON web_sales.ws_sold_date_sk = filtered_dates.d_date_sk\n      WHERE\n        c.c_customer_sk = ws_bill_customer_sk\n    )\n    OR EXISTS(\n      SELECT\n        *\n      FROM catalog_sales\n      JOIN filtered_dates\n        ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk\n      WHERE\n        c.c_customer_sk = cs_ship_customer_sk\n    )\n  )\nGROUP BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 45011,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.2856,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.2,
      "output_sql": "WITH branch1_cte AS (\n  SELECT DISTINCT\n    c_customer_sk\n  FROM customer AS c\n  WHERE\n    EXISTS(\n      SELECT\n        *\n      FROM store_sales, date_dim\n      WHERE\n        c.c_customer_sk = ss_customer_sk\n        AND ss_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy BETWEEN 1 AND 4\n    )\n    AND EXISTS(\n      SELECT\n        *\n      FROM web_sales, date_dim\n      WHERE\n        c.c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy BETWEEN 1 AND 4\n    )\n), branch2_cte AS (\n  SELECT DISTINCT\n    c_customer_sk\n  FROM customer AS c\n  WHERE\n    EXISTS(\n      SELECT\n        *\n      FROM store_sales, date_dim\n      WHERE\n        c.c_customer_sk = ss_customer_sk\n        AND ss_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy BETWEEN 1 AND 4\n    )\n    AND EXISTS(\n      SELECT\n        *\n      FROM catalog_sales, date_dim\n      WHERE\n        c.c_customer_sk = cs_ship_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy BETWEEN 1 AND 4\n    )\n    AND NOT EXISTS(\n      SELECT\n        *\n      FROM web_sales, date_dim\n      WHERE\n        c.c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy BETWEEN 1 AND 4\n    )\n), combined_cte AS (\n  SELECT\n    c_customer_sk\n  FROM branch1_cte\n  UNION ALL\n  SELECT\n    c_customer_sk\n  FROM branch2_cte\n)\nSELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) AS cnt1,\n  cd_purchase_estimate,\n  COUNT(*) AS cnt2,\n  cd_credit_rating,\n  COUNT(*) AS cnt3,\n  cd_dep_count,\n  COUNT(*) AS cnt4,\n  cd_dep_employed_count,\n  COUNT(*) AS cnt5,\n  cd_dep_college_count,\n  COUNT(*) AS cnt6\nFROM customer AS c, customer_address AS ca, customer_demographics\nWHERE\n  c.c_current_addr_sk = ca.ca_address_sk\n  AND ca_county IN (\n    'Storey County',\n    'Marquette County',\n    'Warren County',\n    'Cochran County',\n    'Kandiyohi County'\n  )\n  AND cd_demo_sk = c.c_current_cdemo_sk\n  AND c.c_customer_sk IN (\n    SELECT\n      c_customer_sk\n    FROM combined_cte\n  )\nGROUP BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "flatten_subq",
      "duration_ms": 35481,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9395,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.2,
      "output_sql": "SELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) AS cnt1,\n  cd_purchase_estimate,\n  COUNT(*) AS cnt2,\n  cd_credit_rating,\n  COUNT(*) AS cnt3,\n  cd_dep_count,\n  COUNT(*) AS cnt4,\n  cd_dep_employed_count,\n  COUNT(*) AS cnt5,\n  cd_dep_college_count,\n  COUNT(*) AS cnt6\nFROM customer AS c\nJOIN customer_address AS ca\n  ON c.c_current_addr_sk = ca.ca_address_sk\nJOIN customer_demographics\n  ON cd_demo_sk = c.c_current_cdemo_sk\nWHERE\n  ca_county IN (\n    'Storey County',\n    'Marquette County',\n    'Warren County',\n    'Cochran County',\n    'Kandiyohi County'\n  )\n  AND EXISTS(\n    SELECT\n      1\n    FROM store_sales\n    JOIN date_dim\n      ON ss_sold_date_sk = d_date_sk\n    WHERE\n      c.c_customer_sk = ss_customer_sk AND d_year = 2001 AND d_moy BETWEEN 1 AND 4\n  )\n  AND (\n    EXISTS(\n      SELECT\n        1\n      FROM web_sales\n      JOIN date_dim\n        ON ws_sold_date_sk = d_date_sk\n      WHERE\n        c.c_customer_sk = ws_bill_customer_sk AND d_year = 2001 AND d_moy BETWEEN 1 AND 4\n    )\n    OR EXISTS(\n      SELECT\n        1\n      FROM catalog_sales\n      JOIN date_dim\n        ON cs_sold_date_sk = d_date_sk\n      WHERE\n        c.c_customer_sk = cs_ship_customer_sk AND d_year = 2001 AND d_moy BETWEEN 1 AND 4\n    )\n  )\nGROUP BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "correlated_to_cte",
      "duration_ms": 33042,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7857,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.2,
      "output_sql": "WITH store_customers AS (\n  SELECT DISTINCT\n    ss_customer_sk AS customer_sk\n  FROM store_sales, date_dim\n  WHERE\n    ss_sold_date_sk = d_date_sk AND d_year = 2001 AND d_moy BETWEEN 1 AND 4\n), web_customers AS (\n  SELECT DISTINCT\n    ws_bill_customer_sk AS customer_sk\n  FROM web_sales, date_dim\n  WHERE\n    ws_sold_date_sk = d_date_sk AND d_year = 2001 AND d_moy BETWEEN 1 AND 4\n), catalog_customers AS (\n  SELECT DISTINCT\n    cs_ship_customer_sk AS customer_sk\n  FROM catalog_sales, date_dim\n  WHERE\n    cs_sold_date_sk = d_date_sk AND d_year = 2001 AND d_moy BETWEEN 1 AND 4\n)\nSELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) AS cnt1,\n  cd_purchase_estimate,\n  COUNT(*) AS cnt2,\n  cd_credit_rating,\n  COUNT(*) AS cnt3,\n  cd_dep_count,\n  COUNT(*) AS cnt4,\n  cd_dep_employed_count,\n  COUNT(*) AS cnt5,\n  cd_dep_college_count,\n  COUNT(*) AS cnt6\nFROM customer AS c, customer_address AS ca, customer_demographics\nWHERE\n  c.c_current_addr_sk = ca.ca_address_sk\n  AND ca_county IN (\n    'Storey County',\n    'Marquette County',\n    'Warren County',\n    'Cochran County',\n    'Kandiyohi County'\n  )\n  AND cd_demo_sk = c.c_current_cdemo_sk\n  AND EXISTS(\n    SELECT\n      1\n    FROM store_customers AS sc\n    WHERE\n      sc.customer_sk = c.c_customer_sk\n  )\n  AND (\n    EXISTS(\n      SELECT\n        1\n      FROM web_customers AS wc\n      WHERE\n        wc.customer_sk = c.c_customer_sk\n    )\n    OR EXISTS(\n      SELECT\n        1\n      FROM catalog_customers AS cc\n      WHERE\n        cc.customer_sk = c.c_customer_sk\n    )\n  )\nGROUP BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 39862,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.1351,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 1.1351,
      "output_sql": "SELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) AS cnt1,\n  cd_purchase_estimate,\n  COUNT(*) AS cnt2,\n  cd_credit_rating,\n  COUNT(*) AS cnt3,\n  cd_dep_count,\n  COUNT(*) AS cnt4,\n  cd_dep_employed_count,\n  COUNT(*) AS cnt5,\n  cd_dep_college_count,\n  COUNT(*) AS cnt6\nFROM customer_address AS ca, customer_demographics, customer AS c\nWHERE\n  c.c_current_addr_sk = ca.ca_address_sk\n  AND ca_county IN (\n    'Storey County',\n    'Marquette County',\n    'Warren County',\n    'Cochran County',\n    'Kandiyohi County'\n  )\n  AND cd_demo_sk = c.c_current_cdemo_sk\n  AND EXISTS(\n    SELECT\n      *\n    FROM date_dim, store_sales\n    WHERE\n      c.c_customer_sk = ss_customer_sk\n      AND ss_sold_date_sk = d_date_sk\n      AND d_year = 2001\n      AND d_moy BETWEEN 1 AND 1 + 3\n  )\n  AND (\n    EXISTS(\n      SELECT\n        *\n      FROM date_dim, web_sales\n      WHERE\n        c.c_customer_sk = ws_bill_customer_sk\n        AND ws_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy BETWEEN 1 AND 1 + 3\n    )\n    OR EXISTS(\n      SELECT\n        *\n      FROM date_dim, catalog_sales\n      WHERE\n        c.c_customer_sk = cs_ship_customer_sk\n        AND cs_sold_date_sk = d_date_sk\n        AND d_year = 2001\n        AND d_moy BETWEEN 1 AND 1 + 3\n    )\n  )\nGROUP BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 36433,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 6,
      "reward": 0.0,
      "output_sql": "SELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) AS cnt1,\n  cd_purchase_estimate,\n  COUNT(*) AS cnt2,\n  cd_credit_rating,\n  COUNT(*) AS cnt3,\n  cd_dep_count,\n  COUNT(*) AS cnt4,\n  cd_dep_employed_count,\n  COUNT(*) AS cnt5,\n  cd_dep_college_count,\n  COUNT(*) AS cnt6\nFROM customer AS c\nINNER JOIN customer_address AS ca\n  ON c.c_current_addr_sk = ca.ca_address_sk\nINNER JOIN customer_demographics AS cd\n  ON cd.cd_demo_sk = c.c_current_cdemo_sk\nLEFT JOIN customer_sales_activity AS csa\n  ON c.c_customer_sk = csa.customer_sk\nWHERE\n  ca.ca_county IN (\n    'Storey County',\n    'Marquette County',\n    'Warren County',\n    'Cochran County',\n    'Kandiyohi County'\n  )\n  AND csa.has_store_sales = 1\n  AND (\n    csa.has_web_sales = 1 OR csa.has_catalog_sales = 1\n  )\nGROUP BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [],
      "transform_id": "multi_push_pred",
      "duration_ms": 26,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7655,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 7,
      "reward": 0.2,
      "output_sql": "select \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Storey County','Marquette County','Warren County','Cochran County','Kandiyohi County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2001 and\n                d_moy between 1 and 1+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2001 and\n                  d_moy between 1 ANd 1+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2001 and\n                  d_moy between 1 and 1+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n LIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 31369,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 8,
      "reward": 0.0,
      "output_sql": "SELECT\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  COUNT(*) AS cnt1,\n  cd_purchase_estimate,\n  COUNT(*) AS cnt2,\n  cd_credit_rating,\n  COUNT(*) AS cnt3,\n  cd_dep_count,\n  COUNT(*) AS cnt4,\n  cd_dep_employed_count,\n  COUNT(*) AS cnt5,\n  cd_dep_college_count,\n  COUNT(*) AS cnt6\nFROM customer AS c, customer_address AS ca, customer_demographics\nWHERE\n  c.c_current_addr_sk = ca.ca_address_sk\n  AND ca_county IN (\n    'Storey County',\n    'Marquette County',\n    'Warren County',\n    'Cochran County',\n    'Kandiyohi County'\n  )\n  AND cd_demo_sk = c.c_current_cdemo_sk\n  AND EXISTS(\n    SELECT\n      *\n    FROM store_sales_filtered\n    WHERE\n      c.c_customer_sk = ss_customer_sk\n  )\n  AND (\n    EXISTS(\n      SELECT\n        *\n      FROM web_sales_filtered\n      WHERE\n        c.c_customer_sk = ws_bill_customer_sk\n    )\n    OR EXISTS(\n      SELECT\n        *\n      FROM catalog_sales_filtered\n      WHERE\n        c.c_customer_sk = cs_ship_customer_sk\n    )\n  )\nGROUP BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nORDER BY\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.1818,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.1846,
          "visits": 1,
          "avg_reward": 1.168,
          "is_valid": true,
          "speedup": 1.168,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6997,
          "visits": 2,
          "avg_reward": 0.684,
          "is_valid": true,
          "speedup": 1.168,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7032,
          "visits": 2,
          "avg_reward": 0.684,
          "is_valid": true,
          "speedup": 1.168,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2856,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7506,
          "visits": 2,
          "avg_reward": 0.684,
          "is_valid": true,
          "speedup": 1.168,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9395,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2333,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2856,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "correlated_to_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7088,
          "visits": 2,
          "avg_reward": 0.684,
          "is_valid": true,
          "speedup": 1.168,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9395,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2856,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7857,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7656,
          "visits": 2,
          "avg_reward": 0.684,
          "is_valid": true,
          "speedup": 1.168,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.1759,
          "visits": 1,
          "avg_reward": 1.1351,
          "is_valid": true,
          "speedup": 1.1351,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9395,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2856,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7857,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.852,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8604,
          "visits": 2,
          "avg_reward": 0.684,
          "is_valid": true,
          "speedup": 1.168,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2673,
          "visits": 1,
          "avg_reward": 1.1351,
          "is_valid": true,
          "speedup": 1.1351,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.4142,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9395,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.9799,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2856,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7857,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0441,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8725,
          "visits": 2,
          "avg_reward": 0.684,
          "is_valid": true,
          "speedup": 1.168,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 1.2765,
          "visits": 1,
          "avg_reward": 1.1351,
          "is_valid": true,
          "speedup": 1.1351,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 2.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9395,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7655,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.2856,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7857,
          "status": "tried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 9,
    "avg_reward": 0.367,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 0.684,
        "is_valid": true,
        "speedup": 1.168,
        "error": null,
        "children": {
          "date_cte_isolate": {
            "transforms": [
              "push_pred",
              "date_cte_isolate"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.9657,
            "error": null
          }
        }
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.2856,
        "error": null
      },
      "flatten_subq": {
        "transforms": [
          "flatten_subq"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9395,
        "error": null
      },
      "correlated_to_cte": {
        "transforms": [
          "correlated_to_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.7857,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 1.1351,
        "is_valid": true,
        "speedup": 1.1351,
        "error": null
      },
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "multi_push_pred": {
        "transforms": [
          "multi_push_pred"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.7655,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      }
    }
  }
}