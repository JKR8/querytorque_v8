{
  "stats": {
    "total_iterations": 2,
    "tree_size": 3,
    "successful_expansions": 2,
    "failed_expansions": 0,
    "validation_calls": 2,
    "llm_ranking_calls": 3,
    "root_visits": 2,
    "total_attempts": 2
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 22674,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.2912,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 1.2912,
      "output_sql": "WITH ssales AS (\n  SELECT\n    c_last_name,\n    c_first_name,\n    s_store_name,\n    ca_state,\n    s_state,\n    i_color,\n    i_current_price,\n    i_manager_id,\n    i_units,\n    i_size,\n    SUM(ss_net_profit) AS netpaid\n  FROM store_sales, store_returns, store, item, customer, customer_address\n  WHERE\n    ss_ticket_number = sr_ticket_number\n    AND ss_item_sk = sr_item_sk\n    AND ss_customer_sk = c_customer_sk\n    AND ss_item_sk = i_item_sk\n    AND ss_store_sk = s_store_sk\n    AND c_current_addr_sk = ca_address_sk\n    AND c_birth_country <> UPPER(ca_country)\n    AND s_zip = ca_zip\n    AND s_market_id = 8\n  GROUP BY\n    c_last_name,\n    c_first_name,\n    s_store_name,\n    ca_state,\n    s_state,\n    i_color,\n    i_current_price,\n    i_manager_id,\n    i_units,\n    i_size\n), avg_netpaid_threshold AS (\n  SELECT\n    0.05 * AVG(netpaid) AS threshold\n  FROM ssales\n)\nSELECT\n  c_last_name,\n  c_first_name,\n  s_store_name,\n  SUM(netpaid) AS paid\nFROM ssales\nWHERE\n  i_color = 'beige'\nGROUP BY\n  c_last_name,\n  c_first_name,\n  s_store_name\nHAVING\n  SUM(netpaid) > (\n    SELECT\n      threshold\n    FROM avg_netpaid_threshold\n  )\nORDER BY\n  c_last_name,\n  c_first_name,\n  s_store_name"
    },
    {
      "iteration": 2,
      "parent_path": [
        "materialize_cte"
      ],
      "transform_id": "push_pred",
      "duration_ms": 33446,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 3.1988,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 3.1988,
      "output_sql": "WITH ssales AS (\n  SELECT\n    c_last_name,\n    c_first_name,\n    s_store_name,\n    ca_state,\n    s_state,\n    i_color,\n    i_current_price,\n    i_manager_id,\n    i_units,\n    i_size,\n    SUM(ss_net_profit) AS netpaid\n  FROM store_sales, store_returns, store, item, customer, customer_address\n  WHERE\n    ss_ticket_number = sr_ticket_number\n    AND ss_item_sk = sr_item_sk\n    AND ss_customer_sk = c_customer_sk\n    AND ss_item_sk = i_item_sk\n    AND ss_store_sk = s_store_sk\n    AND c_current_addr_sk = ca_address_sk\n    AND c_birth_country <> UPPER(ca_country)\n    AND s_zip = ca_zip\n    AND s_market_id = 8\n    AND i_color = 'beige'\n  GROUP BY\n    c_last_name,\n    c_first_name,\n    s_store_name,\n    ca_state,\n    s_state,\n    i_color,\n    i_current_price,\n    i_manager_id,\n    i_units,\n    i_size\n), avg_netpaid_threshold AS (\n  SELECT\n    0.05 * AVG(netpaid) AS threshold\n  FROM ssales\n)\nSELECT\n  c_last_name,\n  c_first_name,\n  s_store_name,\n  SUM(netpaid) AS paid\nFROM ssales\nGROUP BY\n  c_last_name,\n  c_first_name,\n  s_store_name\nHAVING\n  SUM(netpaid) > (\n    SELECT\n      threshold\n    FROM avg_netpaid_threshold\n  )\nORDER BY\n  c_last_name,\n  c_first_name,\n  s_store_name"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.3079,
          "visits": 1,
          "avg_reward": 1.2912,
          "is_valid": true,
          "speedup": 1.2912,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "materialize_cte"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 2,
    "avg_reward": 2.245,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 2,
        "avg_reward": 2.245,
        "is_valid": true,
        "speedup": 1.2912,
        "error": null,
        "children": {
          "push_pred": {
            "transforms": [
              "materialize_cte",
              "push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 3.1988,
            "is_valid": true,
            "speedup": 3.1988,
            "error": null
          }
        }
      }
    }
  }
}