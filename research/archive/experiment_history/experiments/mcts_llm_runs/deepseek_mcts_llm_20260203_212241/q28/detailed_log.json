{
  "stats": {
    "total_iterations": 14,
    "tree_size": 15,
    "successful_expansions": 14,
    "failed_expansions": 0,
    "validation_calls": 14,
    "llm_ranking_calls": 24,
    "root_visits": 14,
    "total_attempts": 14
  },
  "attempts": [
    {
      "iteration": 1,
      "parent_path": [],
      "transform_id": "consolidate_scans",
      "duration_ms": 80574,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7995,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 0,
      "reward": 0.2,
      "output_sql": "SELECT\n  *\nFROM (\n  WITH consolidated_scan AS (\n    SELECT\n      CASE\n        WHEN ss_quantity BETWEEN 0 AND 5\n        AND (\n          ss_list_price BETWEEN 131 AND 141\n          OR ss_coupon_amt BETWEEN 16798 AND 17798\n          OR ss_wholesale_cost BETWEEN 25 AND 45\n        )\n        THEN ss_list_price\n      END AS b1_price,\n      CASE\n        WHEN ss_quantity BETWEEN 6 AND 10\n        AND (\n          ss_list_price BETWEEN 145 AND 155\n          OR ss_coupon_amt BETWEEN 14792 AND 15792\n          OR ss_wholesale_cost BETWEEN 46 AND 66\n        )\n        THEN ss_list_price\n      END AS b2_price,\n      CASE\n        WHEN ss_quantity BETWEEN 11 AND 15\n        AND (\n          ss_list_price BETWEEN 150 AND 160\n          OR ss_coupon_amt BETWEEN 6600 AND 7600\n          OR ss_wholesale_cost BETWEEN 9 AND 29\n        )\n        THEN ss_list_price\n      END AS b3_price,\n      CASE\n        WHEN ss_quantity BETWEEN 16 AND 20\n        AND (\n          ss_list_price BETWEEN 91 AND 101\n          OR ss_coupon_amt BETWEEN 13493 AND 14493\n          OR ss_wholesale_cost BETWEEN 36 AND 56\n        )\n        THEN ss_list_price\n      END AS b4_price,\n      CASE\n        WHEN ss_quantity BETWEEN 21 AND 25\n        AND (\n          ss_list_price BETWEEN 0 AND 10\n          OR ss_coupon_amt BETWEEN 7629 AND 8629\n          OR ss_wholesale_cost BETWEEN 6 AND 26\n        )\n        THEN ss_list_price\n      END AS b5_price,\n      CASE\n        WHEN ss_quantity BETWEEN 26 AND 30\n        AND (\n          ss_list_price BETWEEN 89 AND 99\n          OR ss_coupon_amt BETWEEN 15257 AND 16257\n          OR ss_wholesale_cost BETWEEN 31 AND 51\n        )\n        THEN ss_list_price\n      END AS b6_price\n    FROM store_sales\n    WHERE\n      ss_quantity BETWEEN 0 AND 30\n      AND (\n        (\n          ss_quantity BETWEEN 0 AND 5\n          AND (\n            ss_list_price BETWEEN 131 AND 141\n            OR ss_coupon_amt BETWEEN 16798 AND 17798\n            OR ss_wholesale_cost BETWEEN 25 AND 45\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 6 AND 10\n          AND (\n            ss_list_price BETWEEN 145 AND 155\n            OR ss_coupon_amt BETWEEN 14792 AND 15792\n            OR ss_wholesale_cost BETWEEN 46 AND 66\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 11 AND 15\n          AND (\n            ss_list_price BETWEEN 150 AND 160\n            OR ss_coupon_amt BETWEEN 6600 AND 7600\n            OR ss_wholesale_cost BETWEEN 9 AND 29\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 16 AND 20\n          AND (\n            ss_list_price BETWEEN 91 AND 101\n            OR ss_coupon_amt BETWEEN 13493 AND 14493\n            OR ss_wholesale_cost BETWEEN 36 AND 56\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 21 AND 25\n          AND (\n            ss_list_price BETWEEN 0 AND 10\n            OR ss_coupon_amt BETWEEN 7629 AND 8629\n            OR ss_wholesale_cost BETWEEN 6 AND 26\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 26 AND 30\n          AND (\n            ss_list_price BETWEEN 89 AND 99\n            OR ss_coupon_amt BETWEEN 15257 AND 16257\n            OR ss_wholesale_cost BETWEEN 31 AND 51\n          )\n        )\n      )\n  )\n  SELECT\n    AVG(b1_price) AS B1_LP,\n    COUNT(b1_price) AS B1_CNT,\n    COUNT(DISTINCT b1_price) AS B1_CNTD,\n    AVG(b2_price) AS B2_LP,\n    COUNT(b2_price) AS B2_CNT,\n    COUNT(DISTINCT b2_price) AS B2_CNTD,\n    AVG(b3_price) AS B3_LP,\n    COUNT(b3_price) AS B3_CNT,\n    COUNT(DISTINCT b3_price) AS B3_CNTD,\n    AVG(b4_price) AS B4_LP,\n    COUNT(b4_price) AS B4_CNT,\n    COUNT(DISTINCT b4_price) AS B4_CNTD,\n    AVG(b5_price) AS B5_LP,\n    COUNT(b5_price) AS B5_CNT,\n    COUNT(DISTINCT b5_price) AS B5_CNTD,\n    AVG(b6_price) AS B6_LP,\n    COUNT(b6_price) AS B6_CNT,\n    COUNT(DISTINCT b6_price) AS B6_CNTD\n  FROM consolidated_scan\n) AS consolidated_results\nLIMIT 100"
    },
    {
      "iteration": 2,
      "parent_path": [],
      "transform_id": "or_to_union",
      "duration_ms": 80571,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  *\nFROM (\n  SELECT\n    AVG(B1_LP) AS B1_LP,\n    SUM(B1_CNT) AS B1_CNT,\n    COUNT(DISTINCT CASE WHEN NOT B1_CNTD IS NULL THEN B1_LP END) AS B1_CNTD\n  FROM derived_1_combined\n) AS B1, (\n  SELECT\n    AVG(B2_LP) AS B2_LP,\n    SUM(B2_CNT) AS B2_CNT,\n    COUNT(DISTINCT CASE WHEN NOT B2_CNTD IS NULL THEN B2_LP END) AS B2_CNTD\n  FROM derived_2_combined\n) AS B2, (\n  SELECT\n    AVG(B3_LP) AS B3_LP,\n    SUM(B3_CNT) AS B3_CNT,\n    COUNT(DISTINCT CASE WHEN NOT B3_CNTD IS NULL THEN B3_LP END) AS B3_CNTD\n  FROM derived_3_combined\n) AS B3, (\n  SELECT\n    AVG(B4_LP) AS B4_LP,\n    SUM(B4_CNT) AS B4_CNT,\n    COUNT(DISTINCT CASE WHEN NOT B4_CNTD IS NULL THEN B4_LP END) AS B4_CNTD\n  FROM derived_4_combined\n) AS B4, (\n  SELECT\n    AVG(B5_LP) AS B5_LP,\n    SUM(B5_CNT) AS B5_CNT,\n    COUNT(DISTINCT CASE WHEN NOT B5_CNTD IS NULL THEN B5_LP END) AS B5_CNTD\n  FROM derived_5_combined\n) AS B5, (\n  SELECT\n    AVG(B6_LP) AS B6_LP,\n    SUM(B6_CNT) AS B6_CNT,\n    COUNT(DISTINCT CASE WHEN NOT B6_CNTD IS NULL THEN B6_LP END) AS B6_CNTD\n  FROM derived_6_combined\n) AS B6\nLIMIT 100"
    },
    {
      "iteration": 3,
      "parent_path": [],
      "transform_id": "reorder_join",
      "duration_ms": 44069,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.9497,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.2,
      "output_sql": "SELECT\n  *\nFROM (\n  SELECT\n    AVG(ss_list_price) AS B1_LP,\n    COUNT(ss_list_price) AS B1_CNT,\n    COUNT(DISTINCT ss_list_price) AS B1_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 0 AND 5\n    AND (\n      ss_list_price BETWEEN 131 AND 131 + 10\n      OR ss_coupon_amt BETWEEN 16798 AND 16798 + 1000\n      OR ss_wholesale_cost BETWEEN 25 AND 25 + 20\n    )\n) AS B1, (\n  SELECT\n    AVG(ss_list_price) AS B2_LP,\n    COUNT(ss_list_price) AS B2_CNT,\n    COUNT(DISTINCT ss_list_price) AS B2_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 6 AND 10\n    AND (\n      ss_list_price BETWEEN 145 AND 145 + 10\n      OR ss_coupon_amt BETWEEN 14792 AND 14792 + 1000\n      OR ss_wholesale_cost BETWEEN 46 AND 46 + 20\n    )\n) AS B2, (\n  SELECT\n    AVG(ss_list_price) AS B3_LP,\n    COUNT(ss_list_price) AS B3_CNT,\n    COUNT(DISTINCT ss_list_price) AS B3_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 11 AND 15\n    AND (\n      ss_list_price BETWEEN 150 AND 150 + 10\n      OR ss_coupon_amt BETWEEN 6600 AND 6600 + 1000\n      OR ss_wholesale_cost BETWEEN 9 AND 9 + 20\n    )\n) AS B3, (\n  SELECT\n    AVG(ss_list_price) AS B4_LP,\n    COUNT(ss_list_price) AS B4_CNT,\n    COUNT(DISTINCT ss_list_price) AS B4_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 16 AND 20\n    AND (\n      ss_list_price BETWEEN 91 AND 91 + 10\n      OR ss_coupon_amt BETWEEN 13493 AND 13493 + 1000\n      OR ss_wholesale_cost BETWEEN 36 AND 36 + 20\n    )\n) AS B4, (\n  SELECT\n    AVG(ss_list_price) AS B5_LP,\n    COUNT(ss_list_price) AS B5_CNT,\n    COUNT(DISTINCT ss_list_price) AS B5_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 21 AND 25\n    AND (\n      ss_list_price BETWEEN 0 AND 0 + 10\n      OR ss_coupon_amt BETWEEN 7629 AND 7629 + 1000\n      OR ss_wholesale_cost BETWEEN 6 AND 6 + 20\n    )\n) AS B5, (\n  SELECT\n    AVG(ss_list_price) AS B6_LP,\n    COUNT(ss_list_price) AS B6_CNT,\n    COUNT(DISTINCT ss_list_price) AS B6_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 26 AND 30\n    AND (\n      ss_list_price BETWEEN 89 AND 89 + 10\n      OR ss_coupon_amt BETWEEN 15257 AND 15257 + 1000\n      OR ss_wholesale_cost BETWEEN 31 AND 31 + 20\n    )\n) AS B6\nLIMIT 100"
    },
    {
      "iteration": 4,
      "parent_path": [],
      "transform_id": "materialize_cte",
      "duration_ms": 33746,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.0,
      "output_sql": "SELECT\n  *\nFROM B1_agg AS B1, B2_agg AS B2, B3_agg AS B3, B4_agg AS B4, B5_agg AS B5, B6_agg AS B6\nLIMIT 100"
    },
    {
      "iteration": 5,
      "parent_path": [],
      "transform_id": "remove_redundant",
      "duration_ms": 35261,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.8445,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.2,
      "output_sql": "SELECT\n  *\nFROM (\n  SELECT\n    AVG(ss_list_price) AS B1_LP,\n    COUNT(ss_list_price) AS B1_CNT,\n    COUNT(DISTINCT ss_list_price) AS B1_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 0 AND 5\n    AND (\n      ss_list_price BETWEEN 131 AND 131 + 10\n      OR ss_coupon_amt BETWEEN 16798 AND 16798 + 1000\n      OR ss_wholesale_cost BETWEEN 25 AND 25 + 20\n    )\n) AS B1, (\n  SELECT\n    AVG(ss_list_price) AS B2_LP,\n    COUNT(ss_list_price) AS B2_CNT,\n    COUNT(DISTINCT ss_list_price) AS B2_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 6 AND 10\n    AND (\n      ss_list_price BETWEEN 145 AND 145 + 10\n      OR ss_coupon_amt BETWEEN 14792 AND 14792 + 1000\n      OR ss_wholesale_cost BETWEEN 46 AND 46 + 20\n    )\n) AS B2, (\n  SELECT\n    AVG(ss_list_price) AS B3_LP,\n    COUNT(ss_list_price) AS B3_CNT,\n    COUNT(DISTINCT ss_list_price) AS B3_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 11 AND 15\n    AND (\n      ss_list_price BETWEEN 150 AND 150 + 10\n      OR ss_coupon_amt BETWEEN 6600 AND 6600 + 1000\n      OR ss_wholesale_cost BETWEEN 9 AND 9 + 20\n    )\n) AS B3, (\n  SELECT\n    AVG(ss_list_price) AS B4_LP,\n    COUNT(ss_list_price) AS B4_CNT,\n    COUNT(DISTINCT ss_list_price) AS B4_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 16 AND 20\n    AND (\n      ss_list_price BETWEEN 91 AND 91 + 10\n      OR ss_coupon_amt BETWEEN 13493 AND 13493 + 1000\n      OR ss_wholesale_cost BETWEEN 36 AND 36 + 20\n    )\n) AS B4, (\n  SELECT\n    AVG(ss_list_price) AS B5_LP,\n    COUNT(ss_list_price) AS B5_CNT,\n    COUNT(DISTINCT ss_list_price) AS B5_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 21 AND 25\n    AND (\n      ss_list_price BETWEEN 0 AND 0 + 10\n      OR ss_coupon_amt BETWEEN 7629 AND 7629 + 1000\n      OR ss_wholesale_cost BETWEEN 6 AND 6 + 20\n    )\n) AS B5, (\n  SELECT\n    AVG(ss_list_price) AS B6_LP,\n    COUNT(ss_list_price) AS B6_CNT,\n    COUNT(DISTINCT ss_list_price) AS B6_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 26 AND 30\n    AND (\n      ss_list_price BETWEEN 89 AND 89 + 10\n      OR ss_coupon_amt BETWEEN 15257 AND 15257 + 1000\n      OR ss_wholesale_cost BETWEEN 31 AND 31 + 20\n    )\n) AS B6\nLIMIT 100"
    },
    {
      "iteration": 6,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "flatten_subq",
      "duration_ms": 81563,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.7226,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 1.7226,
      "output_sql": "SELECT\n  *\nFROM (\n  WITH consolidated_scan AS (\n    SELECT\n      CASE\n        WHEN ss_quantity BETWEEN 0 AND 5\n        AND (\n          ss_list_price BETWEEN 131 AND 141\n          OR ss_coupon_amt BETWEEN 16798 AND 17798\n          OR ss_wholesale_cost BETWEEN 25 AND 45\n        )\n        THEN ss_list_price\n      END AS b1_price,\n      CASE\n        WHEN ss_quantity BETWEEN 6 AND 10\n        AND (\n          ss_list_price BETWEEN 145 AND 155\n          OR ss_coupon_amt BETWEEN 14792 AND 15792\n          OR ss_wholesale_cost BETWEEN 46 AND 66\n        )\n        THEN ss_list_price\n      END AS b2_price,\n      CASE\n        WHEN ss_quantity BETWEEN 11 AND 15\n        AND (\n          ss_list_price BETWEEN 150 AND 160\n          OR ss_coupon_amt BETWEEN 6600 AND 7600\n          OR ss_wholesale_cost BETWEEN 9 AND 29\n        )\n        THEN ss_list_price\n      END AS b3_price,\n      CASE\n        WHEN ss_quantity BETWEEN 16 AND 20\n        AND (\n          ss_list_price BETWEEN 91 AND 101\n          OR ss_coupon_amt BETWEEN 13493 AND 14493\n          OR ss_wholesale_cost BETWEEN 36 AND 56\n        )\n        THEN ss_list_price\n      END AS b4_price,\n      CASE\n        WHEN ss_quantity BETWEEN 21 AND 25\n        AND (\n          ss_list_price BETWEEN 0 AND 10\n          OR ss_coupon_amt BETWEEN 7629 AND 8629\n          OR ss_wholesale_cost BETWEEN 6 AND 26\n        )\n        THEN ss_list_price\n      END AS b5_price,\n      CASE\n        WHEN ss_quantity BETWEEN 26 AND 30\n        AND (\n          ss_list_price BETWEEN 89 AND 99\n          OR ss_coupon_amt BETWEEN 15257 AND 16257\n          OR ss_wholesale_cost BETWEEN 31 AND 51\n        )\n        THEN ss_list_price\n      END AS b6_price\n    FROM store_sales\n    WHERE\n      ss_quantity BETWEEN 0 AND 30\n      AND (\n        (\n          ss_quantity BETWEEN 0 AND 5\n          AND (\n            ss_list_price BETWEEN 131 AND 141\n            OR ss_coupon_amt BETWEEN 16798 AND 17798\n            OR ss_wholesale_cost BETWEEN 25 AND 45\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 6 AND 10\n          AND (\n            ss_list_price BETWEEN 145 AND 155\n            OR ss_coupon_amt BETWEEN 14792 AND 15792\n            OR ss_wholesale_cost BETWEEN 46 AND 66\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 11 AND 15\n          AND (\n            ss_list_price BETWEEN 150 AND 160\n            OR ss_coupon_amt BETWEEN 6600 AND 7600\n            OR ss_wholesale_cost BETWEEN 9 AND 29\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 16 AND 20\n          AND (\n            ss_list_price BETWEEN 91 AND 101\n            OR ss_coupon_amt BETWEEN 13493 AND 14493\n            OR ss_wholesale_cost BETWEEN 36 AND 56\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 21 AND 25\n          AND (\n            ss_list_price BETWEEN 0 AND 10\n            OR ss_coupon_amt BETWEEN 7629 AND 8629\n            OR ss_wholesale_cost BETWEEN 6 AND 26\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 26 AND 30\n          AND (\n            ss_list_price BETWEEN 89 AND 99\n            OR ss_coupon_amt BETWEEN 15257 AND 16257\n            OR ss_wholesale_cost BETWEEN 31 AND 51\n          )\n        )\n      )\n  )\n  SELECT\n    AVG(b1_price) AS B1_LP,\n    COUNT(b1_price) AS B1_CNT,\n    COUNT(DISTINCT b1_price) AS B1_CNTD,\n    AVG(b2_price) AS B2_LP,\n    COUNT(b2_price) AS B2_CNT,\n    COUNT(DISTINCT b2_price) AS B2_CNTD,\n    AVG(b3_price) AS B3_LP,\n    COUNT(b3_price) AS B3_CNT,\n    COUNT(DISTINCT b3_price) AS B3_CNTD,\n    AVG(b4_price) AS B4_LP,\n    COUNT(b4_price) AS B4_CNT,\n    COUNT(DISTINCT b4_price) AS B4_CNTD,\n    AVG(b5_price) AS B5_LP,\n    COUNT(b5_price) AS B5_CNT,\n    COUNT(DISTINCT b5_price) AS B5_CNTD,\n    AVG(b6_price) AS B6_LP,\n    COUNT(b6_price) AS B6_CNT,\n    COUNT(DISTINCT b6_price) AS B6_CNTD\n  FROM consolidated_scan\n) AS consolidated_results\nLIMIT 100"
    },
    {
      "iteration": 7,
      "parent_path": [
        "consolidate_scans",
        "flatten_subq"
      ],
      "transform_id": "push_pred",
      "duration_ms": 112689,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7819,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.2,
      "output_sql": "SELECT\n  *\nFROM (\n  WITH consolidated_scan AS (\n    SELECT\n      CASE\n        WHEN ss_quantity BETWEEN 0 AND 5\n        AND (\n          ss_list_price BETWEEN 131 AND 141\n          OR ss_coupon_amt BETWEEN 16798 AND 17798\n          OR ss_wholesale_cost BETWEEN 25 AND 45\n        )\n        THEN ss_list_price\n      END AS b1_price,\n      CASE\n        WHEN ss_quantity BETWEEN 6 AND 10\n        AND (\n          ss_list_price BETWEEN 145 AND 155\n          OR ss_coupon_amt BETWEEN 14792 AND 15792\n          OR ss_wholesale_cost BETWEEN 46 AND 66\n        )\n        THEN ss_list_price\n      END AS b2_price,\n      CASE\n        WHEN ss_quantity BETWEEN 11 AND 15\n        AND (\n          ss_list_price BETWEEN 150 AND 160\n          OR ss_coupon_amt BETWEEN 6600 AND 7600\n          OR ss_wholesale_cost BETWEEN 9 AND 29\n        )\n        THEN ss_list_price\n      END AS b3_price,\n      CASE\n        WHEN ss_quantity BETWEEN 16 AND 20\n        AND (\n          ss_list_price BETWEEN 91 AND 101\n          OR ss_coupon_amt BETWEEN 13493 AND 14493\n          OR ss_wholesale_cost BETWEEN 36 AND 56\n        )\n        THEN ss_list_price\n      END AS b4_price,\n      CASE\n        WHEN ss_quantity BETWEEN 21 AND 25\n        AND (\n          ss_list_price BETWEEN 0 AND 10\n          OR ss_coupon_amt BETWEEN 7629 AND 8629\n          OR ss_wholesale_cost BETWEEN 6 AND 26\n        )\n        THEN ss_list_price\n      END AS b5_price,\n      CASE\n        WHEN ss_quantity BETWEEN 26 AND 30\n        AND (\n          ss_list_price BETWEEN 89 AND 99\n          OR ss_coupon_amt BETWEEN 15257 AND 16257\n          OR ss_wholesale_cost BETWEEN 31 AND 51\n        )\n        THEN ss_list_price\n      END AS b6_price\n    FROM store_sales\n    WHERE\n      ss_quantity BETWEEN 0 AND 30\n      AND (\n        (\n          ss_quantity BETWEEN 0 AND 5\n          AND (\n            ss_list_price BETWEEN 131 AND 141\n            OR ss_coupon_amt BETWEEN 16798 AND 17798\n            OR ss_wholesale_cost BETWEEN 25 AND 45\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 6 AND 10\n          AND (\n            ss_list_price BETWEEN 145 AND 155\n            OR ss_coupon_amt BETWEEN 14792 AND 15792\n            OR ss_wholesale_cost BETWEEN 46 AND 66\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 11 AND 15\n          AND (\n            ss_list_price BETWEEN 150 AND 160\n            OR ss_coupon_amt BETWEEN 6600 AND 7600\n            OR ss_wholesale_cost BETWEEN 9 AND 29\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 16 AND 20\n          AND (\n            ss_list_price BETWEEN 91 AND 101\n            OR ss_coupon_amt BETWEEN 13493 AND 14493\n            OR ss_wholesale_cost BETWEEN 36 AND 56\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 21 AND 25\n          AND (\n            ss_list_price BETWEEN 0 AND 10\n            OR ss_coupon_amt BETWEEN 7629 AND 8629\n            OR ss_wholesale_cost BETWEEN 6 AND 26\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 26 AND 30\n          AND (\n            ss_list_price BETWEEN 89 AND 99\n            OR ss_coupon_amt BETWEEN 15257 AND 16257\n            OR ss_wholesale_cost BETWEEN 31 AND 51\n          )\n        )\n      )\n  )\n  SELECT\n    AVG(b1_price) AS B1_LP,\n    COUNT(b1_price) AS B1_CNT,\n    COUNT(DISTINCT b1_price) AS B1_CNTD,\n    AVG(b2_price) AS B2_LP,\n    COUNT(b2_price) AS B2_CNT,\n    COUNT(DISTINCT b2_price) AS B2_CNTD,\n    AVG(b3_price) AS B3_LP,\n    COUNT(b3_price) AS B3_CNT,\n    COUNT(DISTINCT b3_price) AS B3_CNTD,\n    AVG(b4_price) AS B4_LP,\n    COUNT(b4_price) AS B4_CNT,\n    COUNT(DISTINCT b4_price) AS B4_CNTD,\n    AVG(b5_price) AS B5_LP,\n    COUNT(b5_price) AS B5_CNT,\n    COUNT(DISTINCT b5_price) AS B5_CNTD,\n    AVG(b6_price) AS B6_LP,\n    COUNT(b6_price) AS B6_CNT,\n    COUNT(DISTINCT b6_price) AS B6_CNTD\n  FROM consolidated_scan\n) AS consolidated_results\nLIMIT 100"
    },
    {
      "iteration": 8,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "inline_cte",
      "duration_ms": 46240,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.827,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 3,
      "reward": 0.2,
      "output_sql": "SELECT\n  AVG(b1_price) AS B1_LP,\n  COUNT(b1_price) AS B1_CNT,\n  COUNT(DISTINCT b1_price) AS B1_CNTD,\n  AVG(b2_price) AS B2_LP,\n  COUNT(b2_price) AS B2_CNT,\n  COUNT(DISTINCT b2_price) AS B2_CNTD,\n  AVG(b3_price) AS B3_LP,\n  COUNT(b3_price) AS B3_CNT,\n  COUNT(DISTINCT b3_price) AS B3_CNTD,\n  AVG(b4_price) AS B4_LP,\n  COUNT(b4_price) AS B4_CNT,\n  COUNT(DISTINCT b4_price) AS B4_CNTD,\n  AVG(b5_price) AS B5_LP,\n  COUNT(b5_price) AS B5_CNT,\n  COUNT(DISTINCT b5_price) AS B5_CNTD,\n  AVG(b6_price) AS B6_LP,\n  COUNT(b6_price) AS B6_CNT,\n  COUNT(DISTINCT b6_price) AS B6_CNTD\nFROM (\n  SELECT\n    CASE\n      WHEN ss_quantity BETWEEN 0 AND 5\n      AND (\n        ss_list_price BETWEEN 131 AND 141\n        OR ss_coupon_amt BETWEEN 16798 AND 17798\n        OR ss_wholesale_cost BETWEEN 25 AND 45\n      )\n      THEN ss_list_price\n    END AS b1_price,\n    CASE\n      WHEN ss_quantity BETWEEN 6 AND 10\n      AND (\n        ss_list_price BETWEEN 145 AND 155\n        OR ss_coupon_amt BETWEEN 14792 AND 15792\n        OR ss_wholesale_cost BETWEEN 46 AND 66\n      )\n      THEN ss_list_price\n    END AS b2_price,\n    CASE\n      WHEN ss_quantity BETWEEN 11 AND 15\n      AND (\n        ss_list_price BETWEEN 150 AND 160\n        OR ss_coupon_amt BETWEEN 6600 AND 7600\n        OR ss_wholesale_cost BETWEEN 9 AND 29\n      )\n      THEN ss_list_price\n    END AS b3_price,\n    CASE\n      WHEN ss_quantity BETWEEN 16 AND 20\n      AND (\n        ss_list_price BETWEEN 91 AND 101\n        OR ss_coupon_amt BETWEEN 13493 AND 14493\n        OR ss_wholesale_cost BETWEEN 36 AND 56\n      )\n      THEN ss_list_price\n    END AS b4_price,\n    CASE\n      WHEN ss_quantity BETWEEN 21 AND 25\n      AND (\n        ss_list_price BETWEEN 0 AND 10\n        OR ss_coupon_amt BETWEEN 7629 AND 8629\n        OR ss_wholesale_cost BETWEEN 6 AND 26\n      )\n      THEN ss_list_price\n    END AS b5_price,\n    CASE\n      WHEN ss_quantity BETWEEN 26 AND 30\n      AND (\n        ss_list_price BETWEEN 89 AND 99\n        OR ss_coupon_amt BETWEEN 15257 AND 16257\n        OR ss_wholesale_cost BETWEEN 31 AND 51\n      )\n      THEN ss_list_price\n    END AS b6_price\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 0 AND 30\n    AND (\n      (\n        ss_quantity BETWEEN 0 AND 5\n        AND (\n          ss_list_price BETWEEN 131 AND 141\n          OR ss_coupon_amt BETWEEN 16798 AND 17798\n          OR ss_wholesale_cost BETWEEN 25 AND 45\n        )\n      )\n      OR (\n        ss_quantity BETWEEN 6 AND 10\n        AND (\n          ss_list_price BETWEEN 145 AND 155\n          OR ss_coupon_amt BETWEEN 14792 AND 15792\n          OR ss_wholesale_cost BETWEEN 46 AND 66\n        )\n      )\n      OR (\n        ss_quantity BETWEEN 11 AND 15\n        AND (\n          ss_list_price BETWEEN 150 AND 160\n          OR ss_coupon_amt BETWEEN 6600 AND 7600\n          OR ss_wholesale_cost BETWEEN 9 AND 29\n        )\n      )\n      OR (\n        ss_quantity BETWEEN 16 AND 20\n        AND (\n          ss_list_price BETWEEN 91 AND 101\n          OR ss_coupon_amt BETWEEN 13493 AND 14493\n          OR ss_wholesale_cost BETWEEN 36 AND 56\n        )\n      )\n      OR (\n        ss_quantity BETWEEN 21 AND 25\n        AND (\n          ss_list_price BETWEEN 0 AND 10\n          OR ss_coupon_amt BETWEEN 7629 AND 8629\n          OR ss_wholesale_cost BETWEEN 6 AND 26\n        )\n      )\n      OR (\n        ss_quantity BETWEEN 26 AND 30\n        AND (\n          ss_list_price BETWEEN 89 AND 99\n          OR ss_coupon_amt BETWEEN 15257 AND 16257\n          OR ss_wholesale_cost BETWEEN 31 AND 51\n        )\n      )\n    )\n) AS consolidated_scan\nLIMIT 100"
    },
    {
      "iteration": 9,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "multi_push_pred",
      "duration_ms": 83,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": false,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 0.7779,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 4,
      "reward": 0.2,
      "output_sql": "SELECT\n  *\nFROM (\n  WITH consolidated_scan AS (\n    SELECT\n      CASE\n        WHEN ss_quantity BETWEEN 0 AND 5\n        AND (\n          ss_list_price BETWEEN 131 AND 141\n          OR ss_coupon_amt BETWEEN 16798 AND 17798\n          OR ss_wholesale_cost BETWEEN 25 AND 45\n        )\n        THEN ss_list_price\n      END AS b1_price,\n      CASE\n        WHEN ss_quantity BETWEEN 6 AND 10\n        AND (\n          ss_list_price BETWEEN 145 AND 155\n          OR ss_coupon_amt BETWEEN 14792 AND 15792\n          OR ss_wholesale_cost BETWEEN 46 AND 66\n        )\n        THEN ss_list_price\n      END AS b2_price,\n      CASE\n        WHEN ss_quantity BETWEEN 11 AND 15\n        AND (\n          ss_list_price BETWEEN 150 AND 160\n          OR ss_coupon_amt BETWEEN 6600 AND 7600\n          OR ss_wholesale_cost BETWEEN 9 AND 29\n        )\n        THEN ss_list_price\n      END AS b3_price,\n      CASE\n        WHEN ss_quantity BETWEEN 16 AND 20\n        AND (\n          ss_list_price BETWEEN 91 AND 101\n          OR ss_coupon_amt BETWEEN 13493 AND 14493\n          OR ss_wholesale_cost BETWEEN 36 AND 56\n        )\n        THEN ss_list_price\n      END AS b4_price,\n      CASE\n        WHEN ss_quantity BETWEEN 21 AND 25\n        AND (\n          ss_list_price BETWEEN 0 AND 10\n          OR ss_coupon_amt BETWEEN 7629 AND 8629\n          OR ss_wholesale_cost BETWEEN 6 AND 26\n        )\n        THEN ss_list_price\n      END AS b5_price,\n      CASE\n        WHEN ss_quantity BETWEEN 26 AND 30\n        AND (\n          ss_list_price BETWEEN 89 AND 99\n          OR ss_coupon_amt BETWEEN 15257 AND 16257\n          OR ss_wholesale_cost BETWEEN 31 AND 51\n        )\n        THEN ss_list_price\n      END AS b6_price\n    FROM store_sales\n    WHERE\n      ss_quantity BETWEEN 0 AND 30\n      AND (\n        (\n          ss_quantity BETWEEN 0 AND 5\n          AND (\n            ss_list_price BETWEEN 131 AND 141\n            OR ss_coupon_amt BETWEEN 16798 AND 17798\n            OR ss_wholesale_cost BETWEEN 25 AND 45\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 6 AND 10\n          AND (\n            ss_list_price BETWEEN 145 AND 155\n            OR ss_coupon_amt BETWEEN 14792 AND 15792\n            OR ss_wholesale_cost BETWEEN 46 AND 66\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 11 AND 15\n          AND (\n            ss_list_price BETWEEN 150 AND 160\n            OR ss_coupon_amt BETWEEN 6600 AND 7600\n            OR ss_wholesale_cost BETWEEN 9 AND 29\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 16 AND 20\n          AND (\n            ss_list_price BETWEEN 91 AND 101\n            OR ss_coupon_amt BETWEEN 13493 AND 14493\n            OR ss_wholesale_cost BETWEEN 36 AND 56\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 21 AND 25\n          AND (\n            ss_list_price BETWEEN 0 AND 10\n            OR ss_coupon_amt BETWEEN 7629 AND 8629\n            OR ss_wholesale_cost BETWEEN 6 AND 26\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 26 AND 30\n          AND (\n            ss_list_price BETWEEN 89 AND 99\n            OR ss_coupon_amt BETWEEN 15257 AND 16257\n            OR ss_wholesale_cost BETWEEN 31 AND 51\n          )\n        )\n      )\n  )\n  SELECT\n    AVG(b1_price) AS B1_LP,\n    COUNT(b1_price) AS B1_CNT,\n    COUNT(DISTINCT b1_price) AS B1_CNTD,\n    AVG(b2_price) AS B2_LP,\n    COUNT(b2_price) AS B2_CNT,\n    COUNT(DISTINCT b2_price) AS B2_CNTD,\n    AVG(b3_price) AS B3_LP,\n    COUNT(b3_price) AS B3_CNT,\n    COUNT(DISTINCT b3_price) AS B3_CNTD,\n    AVG(b4_price) AS B4_LP,\n    COUNT(b4_price) AS B4_CNT,\n    COUNT(DISTINCT b4_price) AS B4_CNTD,\n    AVG(b5_price) AS B5_LP,\n    COUNT(b5_price) AS B5_CNT,\n    COUNT(DISTINCT b5_price) AS B5_CNTD,\n    AVG(b6_price) AS B6_LP,\n    COUNT(b6_price) AS B6_CNT,\n    COUNT(DISTINCT b6_price) AS B6_CNTD\n  FROM consolidated_scan\n) AS consolidated_results\nLIMIT 100"
    },
    {
      "iteration": 10,
      "parent_path": [],
      "transform_id": "push_pred",
      "duration_ms": 54005,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0052,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 9,
      "reward": 0.5,
      "output_sql": "SELECT *\nFROM (SELECT AVG(ss_list_price) B1_LP,\n             COUNT(ss_list_price) B1_CNT,\n             COUNT(DISTINCT ss_list_price) B1_CNTD\n      FROM store_sales\n      WHERE ss_quantity BETWEEN 0 AND 5\n        AND (ss_list_price BETWEEN 131 AND 131 + 10\n             OR ss_coupon_amt BETWEEN 16798 AND 16798 + 1000\n             OR ss_wholesale_cost BETWEEN 25 AND 25 + 20)) B1,\n     (SELECT AVG(ss_list_price) B2_LP,\n             COUNT(ss_list_price) B2_CNT,\n             COUNT(DISTINCT ss_list_price) B2_CNTD\n      FROM store_sales\n      WHERE ss_quantity BETWEEN 6 AND 10\n        AND (ss_list_price BETWEEN 145 AND 145 + 10\n             OR ss_coupon_amt BETWEEN 14792 AND 14792 + 1000\n             OR ss_wholesale_cost BETWEEN 46 AND 46 + 20)) B2,\n     (SELECT AVG(ss_list_price) B3_LP,\n             COUNT(ss_list_price) B3_CNT,\n             COUNT(DISTINCT ss_list_price) B3_CNTD\n      FROM store_sales\n      WHERE ss_quantity BETWEEN 11 AND 15\n        AND (ss_list_price BETWEEN 150 AND 150 + 10\n             OR ss_coupon_amt BETWEEN 6600 AND 6600 + 1000\n             OR ss_wholesale_cost BETWEEN 9 AND 9 + 20)) B3,\n     (SELECT AVG(ss_list_price) B4_LP,\n             COUNT(ss_list_price) B4_CNT,\n             COUNT(DISTINCT ss_list_price) B4_CNTD\n      FROM store_sales\n      WHERE ss_quantity BETWEEN 16 AND 20\n        AND (ss_list_price BETWEEN 91 AND 91 + 10\n             OR ss_coupon_amt BETWEEN 13493 AND 13493 + 1000\n             OR ss_wholesale_cost BETWEEN 36 AND 36 + 20)) B4,\n     (SELECT AVG(ss_list_price) B5_LP,\n             COUNT(ss_list_price) B5_CNT,\n             COUNT(DISTINCT ss_list_price) B5_CNTD\n      FROM store_sales\n      WHERE ss_quantity BETWEEN 21 AND 25\n        AND (ss_list_price BETWEEN 0 AND 0 + 10\n             OR ss_coupon_amt BETWEEN 7629 AND 7629 + 1000\n             OR ss_wholesale_cost BETWEEN 6 AND 6 + 20)) B5,\n     (SELECT AVG(ss_list_price) B6_LP,\n             COUNT(ss_list_price) B6_CNT,\n             COUNT(DISTINCT ss_list_price) B6_CNTD\n      FROM store_sales\n      WHERE ss_quantity BETWEEN 26 AND 30\n        AND (ss_list_price BETWEEN 89 AND 89 + 10\n             OR ss_coupon_amt BETWEEN 15257 AND 15257 + 1000\n             OR ss_wholesale_cost BETWEEN 31 AND 31 + 20)) B6\nLIMIT 100"
    },
    {
      "iteration": 11,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 50077,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  B1_LP,\n  B1_CNT,\n  B1_CNTD,\n  B2_LP,\n  B2_CNT,\n  B2_CNTD,\n  B3_LP,\n  B3_CNT,\n  B3_CNTD,\n  B4_LP,\n  B4_CNT,\n  B4_CNTD,\n  B5_LP,\n  B5_CNT,\n  B5_CNTD,\n  B6_LP,\n  B6_CNT,\n  B6_CNTD\nFROM consolidated_store_sales_agg\nLIMIT 100"
    },
    {
      "iteration": 12,
      "parent_path": [
        "consolidate_scans"
      ],
      "transform_id": "date_cte_isolate",
      "duration_ms": 85642,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.FAIL",
      "validation_error": null,
      "speedup": 1.7335,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 5,
      "reward": 0.0,
      "output_sql": "WITH filtered_dates AS (\n    SELECT d_date_sk\n    FROM date_dim\n    WHERE d_year = 2001 AND d_qoy = 1\n)\nSELECT\n  *\nFROM (\n  WITH consolidated_scan AS (\n    SELECT\n      CASE\n        WHEN ss_quantity BETWEEN 0 AND 5\n        AND (\n          ss_list_price BETWEEN 131 AND 141\n          OR ss_coupon_amt BETWEEN 16798 AND 17798\n          OR ss_wholesale_cost BETWEEN 25 AND 45\n        )\n        THEN ss_list_price\n      END AS b1_price,\n      CASE\n        WHEN ss_quantity BETWEEN 6 AND 10\n        AND (\n          ss_list_price BETWEEN 145 AND 155\n          OR ss_coupon_amt BETWEEN 14792 AND 15792\n          OR ss_wholesale_cost BETWEEN 46 AND 66\n        )\n        THEN ss_list_price\n      END AS b2_price,\n      CASE\n        WHEN ss_quantity BETWEEN 11 AND 15\n        AND (\n          ss_list_price BETWEEN 150 AND 160\n          OR ss_coupon_amt BETWEEN 6600 AND 7600\n          OR ss_wholesale_cost BETWEEN 9 AND 29\n        )\n        THEN ss_list_price\n      END AS b3_price,\n      CASE\n        WHEN ss_quantity BETWEEN 16 AND 20\n        AND (\n          ss_list_price BETWEEN 91 AND 101\n          OR ss_coupon_amt BETWEEN 13493 AND 14493\n          OR ss_wholesale_cost BETWEEN 36 AND 56\n        )\n        THEN ss_list_price\n      END AS b4_price,\n      CASE\n        WHEN ss_quantity BETWEEN 21 AND 25\n        AND (\n          ss_list_price BETWEEN 0 AND 10\n          OR ss_coupon_amt BETWEEN 7629 AND 8629\n          OR ss_wholesale_cost BETWEEN 6 AND 26\n        )\n        THEN ss_list_price\n      END AS b5_price,\n      CASE\n        WHEN ss_quantity BETWEEN 26 AND 30\n        AND (\n          ss_list_price BETWEEN 89 AND 99\n          OR ss_coupon_amt BETWEEN 15257 AND 16257\n          OR ss_wholesale_cost BETWEEN 31 AND 51\n        )\n        THEN ss_list_price\n      END AS b6_price\n    FROM store_sales\n    JOIN filtered_dates fd ON ss_sold_date_sk = fd.d_date_sk\n    WHERE\n      ss_quantity BETWEEN 0 AND 30\n      AND (\n        (\n          ss_quantity BETWEEN 0 AND 5\n          AND (\n            ss_list_price BETWEEN 131 AND 141\n            OR ss_coupon_amt BETWEEN 16798 AND 17798\n            OR ss_wholesale_cost BETWEEN 25 AND 45\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 6 AND 10\n          AND (\n            ss_list_price BETWEEN 145 AND 155\n            OR ss_coupon_amt BETWEEN 14792 AND 15792\n            OR ss_wholesale_cost BETWEEN 46 AND 66\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 11 AND 15\n          AND (\n            ss_list_price BETWEEN 150 AND 160\n            OR ss_coupon_amt BETWEEN 6600 AND 7600\n            OR ss_wholesale_cost BETWEEN 9 AND 29\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 16 AND 20\n          AND (\n            ss_list_price BETWEEN 91 AND 101\n            OR ss_coupon_amt BETWEEN 13493 AND 14493\n            OR ss_wholesale_cost BETWEEN 36 AND 56\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 21 AND 25\n          AND (\n            ss_list_price BETWEEN 0 AND 10\n            OR ss_coupon_amt BETWEEN 7629 AND 8629\n            OR ss_wholesale_cost BETWEEN 6 AND 26\n          )\n        )\n        OR (\n          ss_quantity BETWEEN 26 AND 30\n          AND (\n            ss_list_price BETWEEN 89 AND 99\n            OR ss_coupon_amt BETWEEN 15257 AND 16257\n            OR ss_wholesale_cost BETWEEN 31 AND 51\n          )\n        )\n      )\n  )\n  SELECT\n    AVG(b1_price) AS B1_LP,\n    COUNT(b1_price) AS B1_CNT,\n    COUNT(DISTINCT b1_price) AS B1_CNTD,\n    AVG(b2_price) AS B2_LP,\n    COUNT(b2_price) AS B2_CNT,\n    COUNT(DISTINCT b2_price) AS B2_CNTD,\n    AVG(b3_price) AS B3_LP,\n    COUNT(b3_price) AS B3_CNT,\n    COUNT(DISTINCT b3_price) AS B3_CNTD,\n    AVG(b4_price) AS B4_LP,\n    COUNT(b4_price) AS B4_CNT,\n    COUNT(DISTINCT b4_price) AS B4_CNTD,\n    AVG(b5_price) AS B5_LP,\n    COUNT(b5_price) AS B5_CNT,\n    COUNT(DISTINCT b5_price) AS B5_CNTD,\n    AVG(b6_price) AS B6_LP,\n    COUNT(b6_price) AS B6_CNT,\n    COUNT(DISTINCT b6_price) AS B6_CNTD\n  FROM consolidated_scan\n) AS consolidated_results\nLIMIT 100"
    },
    {
      "iteration": 13,
      "parent_path": [
        "push_pred"
      ],
      "transform_id": "reorder_join",
      "duration_ms": 81030,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.PASS",
      "validation_error": null,
      "speedup": 1.0301,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 2,
      "reward": 0.5,
      "output_sql": "SELECT\n  *\nFROM (\n  SELECT\n    AVG(ss_list_price) AS B2_LP,\n    COUNT(ss_list_price) AS B2_CNT,\n    COUNT(DISTINCT ss_list_price) AS B2_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 6 AND 10\n    AND (\n      ss_list_price BETWEEN 145 AND 145 + 10\n      OR ss_coupon_amt BETWEEN 14792 AND 14792 + 1000\n      OR ss_wholesale_cost BETWEEN 46 AND 46 + 20\n    )\n) AS B2, (\n  SELECT\n    AVG(ss_list_price) AS B3_LP,\n    COUNT(ss_list_price) AS B3_CNT,\n    COUNT(DISTINCT ss_list_price) AS B3_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 11 AND 15\n    AND (\n      ss_list_price BETWEEN 150 AND 150 + 10\n      OR ss_coupon_amt BETWEEN 6600 AND 6600 + 1000\n      OR ss_wholesale_cost BETWEEN 9 AND 9 + 20\n    )\n) AS B3, (\n  SELECT\n    AVG(ss_list_price) AS B4_LP,\n    COUNT(ss_list_price) AS B4_CNT,\n    COUNT(DISTINCT ss_list_price) AS B4_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 16 AND 20\n    AND (\n      ss_list_price BETWEEN 91 AND 91 + 10\n      OR ss_coupon_amt BETWEEN 13493 AND 13493 + 1000\n      OR ss_wholesale_cost BETWEEN 36 AND 36 + 20\n    )\n) AS B4, (\n  SELECT\n    AVG(ss_list_price) AS B5_LP,\n    COUNT(ss_list_price) AS B5_CNT,\n    COUNT(DISTINCT ss_list_price) AS B5_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 21 AND 25\n    AND (\n      ss_list_price BETWEEN 0 AND 0 + 10\n      OR ss_coupon_amt BETWEEN 7629 AND 7629 + 1000\n      OR ss_wholesale_cost BETWEEN 6 AND 6 + 20\n    )\n) AS B5, (\n  SELECT\n    AVG(ss_list_price) AS B6_LP,\n    COUNT(ss_list_price) AS B6_CNT,\n    COUNT(DISTINCT ss_list_price) AS B6_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 26 AND 30\n    AND (\n      ss_list_price BETWEEN 89 AND 89 + 10\n      OR ss_coupon_amt BETWEEN 15257 AND 15257 + 1000\n      OR ss_wholesale_cost BETWEEN 31 AND 31 + 20\n    )\n) AS B6, (\n  SELECT\n    AVG(ss_list_price) AS B1_LP,\n    COUNT(ss_list_price) AS B1_CNT,\n    COUNT(DISTINCT ss_list_price) AS B1_CNTD\n  FROM store_sales\n  WHERE\n    ss_quantity BETWEEN 0 AND 5\n    AND (\n      ss_list_price BETWEEN 131 AND 131 + 10\n      OR ss_coupon_amt BETWEEN 16798 AND 16798 + 1000\n      OR ss_wholesale_cost BETWEEN 25 AND 25 + 20\n    )\n) AS B1\nLIMIT 100"
    },
    {
      "iteration": 14,
      "parent_path": [
        "push_pred",
        "reorder_join"
      ],
      "transform_id": "consolidate_scans",
      "duration_ms": 53751,
      "llm_success": true,
      "llm_error": null,
      "sql_changed": true,
      "validated": true,
      "validation_status": "ValidationStatus.ERROR",
      "validation_error": null,
      "speedup": 0,
      "original_rows": 0,
      "optimized_rows": 0,
      "uct_score": 0.0,
      "parent_visits": 1,
      "reward": 0.0,
      "output_sql": "SELECT\n  *\nFROM combined_scan\nLIMIT 100"
    }
  ],
  "selections": [
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.3,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.5,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0333,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0471,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.55,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "or_to_union",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0236,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0577,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.695,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2289,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0289,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0667,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8062,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "materialize_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0333,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0745,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "remove_redundant",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4236,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1118,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2373,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8445,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.559,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0816,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9826,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.5292,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3225,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.3229,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8445,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7937,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0408,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0882,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.5329,
          "visits": 2,
          "avg_reward": 0.9613,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.7509,
          "visits": 1,
          "avg_reward": 1.7226,
          "is_valid": true,
          "speedup": 1.7226,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 1.2124,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "flatten_subq",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans",
        "flatten_subq"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8485,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4646,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1323,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2441,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8445,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.6614,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0943,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 1.1706,
          "visits": 3,
          "avg_reward": 0.7075,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 1.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 1.1345,
          "visits": 2,
          "avg_reward": 0.9613,
          "is_valid": true,
          "speedup": 1.7226,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 1.0,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "inline_cte",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4828,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.1414,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2471,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8445,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.7071,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9766,
          "visits": 4,
          "avg_reward": 0.5807,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.4472,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.2236,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.0894,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.24,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.827,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.988,
          "visits": 2,
          "avg_reward": 0.9613,
          "is_valid": true,
          "speedup": 1.7226,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0894,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 1.5652,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0894,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.6708,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.118,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "multi_push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.9487,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.5,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.15,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.25,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8445,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.75,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1054,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8545,
          "visits": 5,
          "avg_reward": 0.5045,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 1.2906,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0052,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6743,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3162,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3317,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1106,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2527,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8445,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1106,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0527,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1106,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1106,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8735,
          "visits": 5,
          "avg_reward": 0.5045,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0566,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8028,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0052,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.6975,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3317,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1155,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2553,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8445,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1155,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0553,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1155,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1155,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.8915,
          "visits": 5,
          "avg_reward": 0.5045,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "consolidate_scans"
      ],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.7348,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.4899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.2449,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.2447,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.827,
          "status": "tried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.9911,
          "visits": 2,
          "avg_reward": 0.9613,
          "is_valid": true,
          "speedup": 1.7226,
          "status": "tried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.098,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.2447,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.7779,
          "status": "tried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.098,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 1.2247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 1.7146,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "date_cte_isolate",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.8274,
          "visits": 2,
          "avg_reward": 0.25,
          "is_valid": true,
          "speedup": 1.0052,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7196,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3464,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3606,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1202,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2577,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8445,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1202,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0577,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1202,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1202,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.7668,
          "visits": 6,
          "avg_reward": 0.4204,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.866,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.5196,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3464,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1732,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0693,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.495,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [],
      "candidates": [
        {
          "transform_id": "push_pred",
          "uct_score": 0.784,
          "visits": 3,
          "avg_reward": 0.3333,
          "is_valid": true,
          "speedup": 1.0052,
          "status": "tried"
        },
        {
          "transform_id": "reorder_join",
          "uct_score": 0.7408,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.9497,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.3606,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.3742,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.1247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.2601,
          "visits": 1,
          "avg_reward": 0.2,
          "is_valid": true,
          "speedup": 0.8445,
          "status": "tried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.1247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0601,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.1247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.1247,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.781,
          "visits": 6,
          "avg_reward": 0.4204,
          "is_valid": true,
          "speedup": 0.7995,
          "status": "tried"
        }
      ],
      "selected": "push_pred",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred"
      ],
      "candidates": [
        {
          "transform_id": "reorder_join",
          "uct_score": 0.933,
          "visits": 1,
          "avg_reward": 0.5,
          "is_valid": true,
          "speedup": 1.0301,
          "status": "tried"
        },
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.6,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.08,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.6062,
          "visits": 1,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 0,
          "status": "tried"
        }
      ],
      "selected": "reorder_join",
      "reason": "puct_action"
    },
    {
      "node_path": [
        "push_pred",
        "reorder_join"
      ],
      "candidates": [
        {
          "transform_id": "materialize_cte",
          "uct_score": 0.7071,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "inline_cte",
          "uct_score": 0.4243,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "flatten_subq",
          "uct_score": 0.2828,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "remove_redundant",
          "uct_score": 0.1414,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "multi_push_pred",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "or_to_union",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "correlated_to_cte",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "date_cte_isolate",
          "uct_score": 0.0707,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        },
        {
          "transform_id": "consolidate_scans",
          "uct_score": 0.9899,
          "visits": 0,
          "avg_reward": 0.0,
          "is_valid": false,
          "speedup": 1.0,
          "status": "untried"
        }
      ],
      "selected": "consolidate_scans",
      "reason": "puct_action"
    }
  ],
  "tree": {
    "transforms": [],
    "depth": 0,
    "visits": 14,
    "avg_reward": 0.2802,
    "is_valid": false,
    "speedup": 1.0,
    "error": null,
    "children": {
      "consolidate_scans": {
        "transforms": [
          "consolidate_scans"
        ],
        "depth": 1,
        "visits": 6,
        "avg_reward": 0.4204,
        "is_valid": true,
        "speedup": 0.7995,
        "error": null,
        "children": {
          "flatten_subq": {
            "transforms": [
              "consolidate_scans",
              "flatten_subq"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.9613,
            "is_valid": true,
            "speedup": 1.7226,
            "error": null,
            "children": {
              "push_pred": {
                "transforms": [
                  "consolidate_scans",
                  "flatten_subq",
                  "push_pred"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.2,
                "is_valid": true,
                "speedup": 0.7819,
                "error": null
              }
            }
          },
          "inline_cte": {
            "transforms": [
              "consolidate_scans",
              "inline_cte"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.827,
            "error": null
          },
          "multi_push_pred": {
            "transforms": [
              "consolidate_scans",
              "multi_push_pred"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.2,
            "is_valid": true,
            "speedup": 0.7779,
            "error": null
          },
          "date_cte_isolate": {
            "transforms": [
              "consolidate_scans",
              "date_cte_isolate"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 1.7335,
            "error": null
          }
        }
      },
      "or_to_union": {
        "transforms": [
          "or_to_union"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "reorder_join": {
        "transforms": [
          "reorder_join"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.9497,
        "error": null
      },
      "materialize_cte": {
        "transforms": [
          "materialize_cte"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.0,
        "is_valid": false,
        "speedup": 0,
        "error": null
      },
      "remove_redundant": {
        "transforms": [
          "remove_redundant"
        ],
        "depth": 1,
        "visits": 1,
        "avg_reward": 0.2,
        "is_valid": true,
        "speedup": 0.8445,
        "error": null
      },
      "push_pred": {
        "transforms": [
          "push_pred"
        ],
        "depth": 1,
        "visits": 4,
        "avg_reward": 0.25,
        "is_valid": true,
        "speedup": 1.0052,
        "error": null,
        "children": {
          "consolidate_scans": {
            "transforms": [
              "push_pred",
              "consolidate_scans"
            ],
            "depth": 2,
            "visits": 1,
            "avg_reward": 0.0,
            "is_valid": false,
            "speedup": 0,
            "error": null
          },
          "reorder_join": {
            "transforms": [
              "push_pred",
              "reorder_join"
            ],
            "depth": 2,
            "visits": 2,
            "avg_reward": 0.25,
            "is_valid": true,
            "speedup": 1.0301,
            "error": null,
            "children": {
              "consolidate_scans": {
                "transforms": [
                  "push_pred",
                  "reorder_join",
                  "consolidate_scans"
                ],
                "depth": 3,
                "visits": 1,
                "avg_reward": 0.0,
                "is_valid": false,
                "speedup": 0,
                "error": null
              }
            }
          }
        }
      }
    }
  }
}