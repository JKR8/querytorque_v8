WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-02-26' AND (CAST('2002-02-26' AS DATE) + INTERVAL '90' DAY)), item_avg_discount AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk GROUP BY ws_item_sk)
SELECT SUM(ws_ext_discount_amt) AS "Excess Discount Amount" FROM web_sales AS ws JOIN item AS i ON i.i_item_sk = ws.ws_item_sk JOIN filtered_dates AS fd ON fd.d_date_sk = ws.ws_sold_date_sk JOIN item_avg_discount AS iad ON ws.ws_item_sk = iad.ws_item_sk WHERE i.i_manufact_id = 320 AND ws.ws_ext_discount_amt > iad.threshold ORDER BY SUM(ws_ext_discount_amt) LIMIT 100