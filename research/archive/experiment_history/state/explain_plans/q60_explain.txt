-- Q60 EXPLAIN ANALYZE (SF10)
-- State: baseline
-- Best speedup: 1.02x
-- Source SQL: /mnt/d/TPC-DS/queries_duckdb_converted/query_60.sql

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE with ss as (  select           i_item_id,sum(ss_ext_sales_price) total_sales  from  	store_sales,  	date_dim,          customer_address,          item  where          i_item_id in (select   i_item_id from  item where i_category in ('Children'))  and     ss_item_sk              = i_item_sk  and     ss_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 8  and     ss_addr_sk              = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  cs as (  select           i_item_id,sum(cs_ext_sales_price) total_sales  from  	catalog_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     cs_item_sk              = i_item_sk  and     cs_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 8  and     cs_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7   group by i_item_id),  ws as (  select           i_item_id,sum(ws_ext_sales_price) total_sales  from  	web_sales,  	date_dim,          customer_address,          item  where          i_item_id               in (select   i_item_id from  item where i_category in ('Children'))  and     ws_item_sk              = i_item_sk  and     ws_sold_date_sk         = d_date_sk  and     d_year                  = 2000  and     d_moy                   = 8  and     ws_bill_addr_sk         = ca_address_sk  and     ca_gmt_offset           = -7  group by i_item_id)   select     i_item_id ,sum(total_sales) total_sales  from  (select * from ss          union all         select * from cs          union all         select * from ws) tmp1  group by i_item_id  order by i_item_id       ,total_sales  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.0957s             ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌─────────────┐
│    QUERY    │
└──────┬──────┘
┌──────┴──────┐
│EXPLAIN_...  │
│    ──────   │
│    0 rows   │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│    TOP_N    │
│    ──────   │
│     Top:    │
│     100     │
│             │
│  Order By:  │
│tmp1.i_item_i│
│    d ASC    │
│   sum(tmp1  │
│ .total_sales│
│    ) ASC    │
│             │
│   100 rows  │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│HASH_GROUP_BY│
│    ──────   │
│   Groups:   │
│      #0     │
│             │
│ Aggregates: │
│   sum(#1)   │
│             │
│  8,556 rows │
│   (0.01s)   │
└──────┬──────┘
┌──────┴──────┐
│  PROJECTION │
│    ──────   │
│  i_item_id  │
│ total_sales │
│             │
│ 14,395 rows │
│   (0.00s)   │
└──────┬──────┘
┌──────┴──────┐
│    UNION    │
│    ──────   │
│    0 rows   ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│   (0.00s)   │                                                                                                                                              │
└──────┬──────┘                                                                                                                                              │
┌──────┴──────┐                                                                                                                                       ┌──────┴──────┐
│    UNION    │                                                                                                                                       │HASH_GROUP_BY│
│    ──────   │                                                                                                                                       │    ──────   │
│             │                                                                                                                                       │   Groups:   │
│             │                                                                                                                                       │      #0     │
│             │                                                                                                                                       │             │
│             ├───────────────────────────────────────────────────────────────────┐                                                                   │ Aggregates: │
│             │                                                                   │                                                                   │   sum(#1)   │
│             │                                                                   │                                                                   │             │
│    0 rows   │                                                                   │                                                                   │  2,869 rows │
│   (0.00s)   │                                                                   │                                                                   │   (0.00s)   │
└──────┬──────┘                                                                   │                                                                   └──────┬──────┘
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
│HASH_GROUP_BY│                                                            │HASH_GROUP_BY│                                                            │  PROJECTION │
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │
│   Groups:   │                                                            │   Groups:   │                                                            │  i_item_id  │
│      #0     │                                                            │      #0     │                                                            │ws_ext_sales_│
│             │                                                            │             │                                                            │    price    │
│ Aggregates: │                                                            │ Aggregates: │                                                            │             │
│   sum(#1)   │                                                            │   sum(#1)   │                                                            │             │
│             │                                                            │             │                                                            │             │
│  6,797 rows │                                                            │  4,729 rows │                                                            │  3,393 rows │
│   (0.02s)   │                                                            │   (0.00s)   │                                                            │   (0.00s)   │
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐
│  PROJECTION │                                                            │  PROJECTION │                                                            │  HASH_JOIN  │
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │
│  i_item_id  │                                                            │  i_item_id  │                                                            │  Join Type: │
│ss_ext_sales_│                                                            │cs_ext_sales_│                                                            │     SEMI    │
│    price    │                                                            │    price    │                                                            │             │
│             │                                                            │             │                                                            │ Conditions: ├────────────────────────────────────────────────────┐
│             │                                                            │             │                                                            │ i_item_id = │                                                    │
│             │                                                            │             │                                                            │      #0     │                                                    │
│             │                                                            │             │                                                            │             │                                                    │
│ 12,075 rows │                                                            │  6,543 rows │                                                            │  3,393 rows │                                                    │
│   (0.00s)   │                                                            │   (0.00s)   │                                                            │   (0.00s)   │                                                    │
└──────┬──────┘                                                            └──────┬──────┘                                                            └──────┬──────┘                                                    │
┌──────┴──────┐                                                            ┌──────┴──────┐                                                            ┌──────┴──────┐                                             ┌──────┴──────┐
│  HASH_JOIN  │                                                            │  HASH_JOIN  │                                                            │  HASH_JOIN  │                                             │  TABLE_SCAN │
│    ──────   │                                                            │    ──────   │                                                            │    ──────   │                                             │    ──────   │
│  Join Type: │                                                            │  Join Type: │                                                            │  Join Type: │                                             │    Table:   │
│    INNER    │                                                            │    INNER    │                                                            │    INNER    │                                             │     item    │
│             │                                                            │             │                                                            │             │                                             │             │
│ Conditions: │                                                            │ Conditions: │                                                            │ Conditions: │                                             │    Type:    │
│ ss_item_sk =│                                                            │ i_item_sk = │                                                            │ i_item_sk = │                                             │  Sequential │
│   i_item_sk │                                                            │  cs_item_sk │                                                            │  ws_item_sk │                                             │     Scan    │
│             │                                                            │             │                                                            │             │                                             │             │
│             ├─────────────────────────────────────┐                      │             ├──────────────────────┐                                     │             ├───────┐                                     │ Projections:│
│             │                                     │                      │             │                      │                                     │             │       │                                     │  i_item_id  │
│             │                                     │                      │             │                      │                                     │             │       │                                     │             │
│             │                                     │                      │             │                      │                                     │             │       │                                     │   Filters:  │
│             │                                     │                      │             │                      │                                     │             │       │                                     │ i_category= │
│             │                                     │                      │             │                      │                                     │             │       │                                     │  'Children' │
│             │                                     │                      │             │                      │                                     │             │       │                                     │             │
│ 12,075 rows │                                     │                      │  6,543 rows │                      │                                     │ 18,314 rows │       │                                     │ 10,149 rows │
│   (0.01s)   │                                     │                      │   (0.01s)   │                      │                                     │   (0.00s)   │       │                                     │   (0.00s)   │
└──────┬──────┘                                     │                      └──────┬──────┘                      │                                     └──────┬──────┘       │                                     └─────────────┘
┌──────┴──────┐                              ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐
│  HASH_JOIN  │                              │  HASH_JOIN  │               │  HASH_JOIN  │               │  HASH_JOIN  │                              │  TABLE_SCAN ││  HASH_JOIN  │
│    ──────   │                              │    ──────   │               │    ──────   │               │    ──────   │                              │    ──────   ││    ──────   │
│  Join Type: │                              │  Join Type: │               │  Join Type: │               │  Join Type: │                              │    Table:   ││  Join Type: │
│    INNER    │                              │     SEMI    │               │     SEMI    │               │    INNER    │                              │     item    ││    INNER    │
│             │                              │             │               │             │               │             │                              │             ││             │
│ Conditions: │                              │ Conditions: │               │ Conditions: │               │ Conditions: │                              │    Type:    ││ Conditions: │
│ ss_addr_sk =│                              │ i_item_id = │               │ i_item_id = │               │cs_bill_addr_│                              │  Sequential ││ws_bill_addr_│
│ ca_address_s│                              │      #0     │               │      #0     │               │sk = ca_addre│                              │     Scan    ││sk = ca_addre│
│      k      │                              │             │               │             │               │    ss_sk    │                              │             ││    ss_sk    │
│             │                              │             │               │             │               │             │                              │ Projections:││             │
│             ├──────────────────────┐       │             ├───────┐       │             ├───────┐       │             ├──────────────────────┐       │  i_item_id  ││             ├──────────────────────┐
│             │                      │       │             │       │       │             │       │       │             │                      │       │  i_item_sk  ││             │                      │
│             │                      │       │             │       │       │             │       │       │             │                      │       │             ││             │                      │
│             │                      │       │             │       │       │             │       │       │             │                      │       │   Filters:  ││             │                      │
│             │                      │       │             │       │       │             │       │       │             │                      │       │  optional:  ││             │                      │
│             │                      │       │             │       │       │             │       │       │             │                      │       │    Dynamic  ││             │                      │
│             │                      │       │             │       │       │             │       │       │             │                      │       │    Filter   ││             │                      │
│             │                      │       │             │       │       │             │       │       │             │                      │       │ (i_item_id) ││             │                      │
│             │                      │       │             │       │       │             │       │       │             │                      │       │             ││             │                      │
│ 65,324 rows │                      │       │ 21,845 rows │       │       │ 21,845 rows │       │       │ 35,191 rows │                      │       │ 101,973 rows││ 18,323 rows │                      │
│   (0.01s)   │                      │       │   (0.01s)   │       │       │   (0.00s)   │       │       │   (0.00s)   │                      │       │   (0.00s)   ││   (0.00s)   │                      │
└──────┬──────┘                      │       └──────┬──────┘       │       └──────┬──────┘       │       └──────┬──────┘                      │       └─────────────┘└──────┬──────┘                      │
┌──────┴──────┐               ┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐               ┌──────┴──────┐
│  HASH_JOIN  │               │  TABLE_SCAN ││  TABLE_SCAN ││  TABLE_SCAN ││  TABLE_SCAN ││  TABLE_SCAN ││  HASH_JOIN  │               │  TABLE_SCAN │               │  HASH_JOIN  │               │  TABLE_SCAN │
│    ──────   │               │    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   ││    ──────   │               │    ──────   │               │    ──────   │               │    ──────   │
│  Join Type: │               │    Table:   ││    Table:   ││    Table:   ││    Table:   ││    Table:   ││  Join Type: │               │    Table:   │               │  Join Type: │               │    Table:   │
│    INNER    │               │customer_addr││     item    ││     item    ││     item    ││     item    ││    INNER    │               │customer_addr│               │    INNER    │               │customer_addr│
│             │               │     ess     ││             ││             ││             ││             ││             │               │     ess     │               │             │               │     ess     │
│ Conditions: │               │             ││    Type:    ││    Type:    ││    Type:    ││    Type:    ││ Conditions: │               │             │               │ Conditions: │               │             │
│ss_sold_date_│               │    Type:    ││  Sequential ││  Sequential ││  Sequential ││  Sequential ││cs_sold_date_│               │    Type:    │               │ws_sold_date_│               │    Type:    │
│sk = d_date_s│               │  Sequential ││     Scan    ││     Scan    ││     Scan    ││     Scan    ││sk = d_date_s│               │  Sequential │               │sk = d_date_s│               │  Sequential │
│      k      │               │     Scan    ││             ││             ││             ││             ││      k      │               │     Scan    │               │      k      │               │     Scan    │
│             │               │             ││ Projections:││ Projections:││ Projections:││ Projections:││             │               │             │               │             │               │             │
│             ├───────┐       │ Projections:││  i_item_id  ││  i_item_id  ││  i_item_id  ││  i_item_id  ││             ├───────┐       │ Projections:│               │             ├───────┐       │ Projections:│
│             │       │       │ca_address_sk││  i_item_sk  ││             ││  i_item_sk  ││             ││             │       │       │ca_address_sk│               │             │       │       │ca_address_sk│
│             │       │       │             ││             ││   Filters:  ││             ││   Filters:  ││             │       │       │             │               │             │       │       │             │
│             │       │       │   Filters:  ││             ││ i_category= ││   Filters:  ││ i_category= ││             │       │       │   Filters:  │               │             │       │       │   Filters:  │
│             │       │       │ca_gmt_offset││             ││  'Children' ││  optional:  ││  'Children' ││             │       │       │ca_gmt_offset│               │             │       │       │ca_gmt_offset│
│             │       │       │    =-7.00   ││             ││             ││    Dynamic  ││             ││             │       │       │    =-7.00   │               │             │       │       │    =-7.00   │
│             │       │       │             ││             ││             ││    Filter   ││             ││             │       │       │             │               │             │       │       │             │
│             │       │       │             ││             ││             ││ (i_item_id) ││             ││             │       │       │             │               │             │       │       │             │
│             │       │       │             ││             ││             ││             ││             ││             │       │       │             │               │             │       │       │             │
│ 587,846 rows│       │       │ 27,348 rows ││ 101,978 rows││ 10,149 rows ││ 101,972 rows││ 10,149 rows ││ 318,595 rows│       │       │ 27,348 rows │               │ 158,960 rows│       │       │ 27,348 rows │
│   (0.05s)   │       │       │   (0.00s)   ││   (0.01s)   ││   (0.00s)   ││   (0.01s)   ││   (0.00s)   ││   (0.00s)   │       │       │   (0.00s)   │               │   (0.01s)   │       │       │   (0.00s)   │
└──────┬──────┘       │       └─────────────┘└─────────────┘└─────────────┘└─────────────┘└─────────────┘└──────┬──────┘       │       └─────────────┘               └──────┬──────┘       │       └─────────────┘
┌──────┴──────┐┌──────┴──────┐                                                                           ┌──────┴──────┐┌──────┴──────┐                              ┌──────┴──────┐┌──────┴──────┐
│  TABLE_SCAN ││    FILTER   │                                                                           │  TABLE_SCAN ││    FILTER   │                              │  TABLE_SCAN ││    FILTER   │
│    ──────   ││    ──────   │                                                                           │    ──────   ││    ──────   │                              │    ──────   ││    ──────   │
│    Table:   ││  (d_date_sk │                                                                           │    Table:   ││  (d_date_sk │                              │    Table:   ││  (d_date_sk │
│ store_sales ││    BETWEEN  │                                                                           │catalog_sales││    BETWEEN  │                              │  web_sales  ││    BETWEEN  │
│             ││  2450816 AND│                                                                           │             ││  2450815 AND│                              │             ││  2450816 AND│
│    Type:    ││   2452642)  │                                                                           │    Type:    ││   2452653)  │                              │    Type:    ││   2452642)  │
│  Sequential ││             │                                                                           │  Sequential ││             │                              │  Sequential ││             │
│     Scan    ││             │                                                                           │     Scan    ││             │                              │     Scan    ││             │
│             ││             │                                                                           │             ││             │                              │             ││             │
│ Projections:││             │                                                                           │ Projections:││             │                              │ Projections:││             │
│  ss_item_sk ││             │                                                                           │  cs_item_sk ││             │                              │  ws_item_sk ││             │
│ss_sold_date_││             │                                                                           │cs_sold_date_││             │                              │ws_sold_date_││             │
│      sk     ││             │                                                                           │      sk     ││             │                              │      sk     ││             │
│  ss_addr_sk ││             │                                                                           │cs_bill_addr_││             │                              │ws_bill_addr_││             │
│ss_ext_sales_││             │                                                                           │      sk     ││             │                              │      sk     ││             │
│    price    ││             │                                                                           │cs_ext_sales_││             │                              │ws_ext_sales_││             │
│             ││             │                                                                           │    price    ││             │                              │    price    ││             │
│             ││             │                                                                           │             ││             │                              │             ││             │
│ 587,846 rows││   31 rows   │                                                                           │ 318,595 rows││   31 rows   │                              │ 158,960 rows││   31 rows   │
│   (0.37s)   ││   (0.00s)   │                                                                           │   (0.03s)   ││   (0.00s)   │                              │   (0.06s)   ││   (0.00s)   │
└─────────────┘└──────┬──────┘                                                                           └─────────────┘└──────┬──────┘                              └─────────────┘└──────┬──────┘
               ┌──────┴──────┐                                                                                          ┌──────┴──────┐                                             ┌──────┴──────┐
               │  TABLE_SCAN │                                                                                          │  TABLE_SCAN │                                             │  TABLE_SCAN │
               │    ──────   │                                                                                          │    ──────   │                                             │    ──────   │
               │    Table:   │                                                                                          │    Table:   │                                             │    Table:   │
               │   date_dim  │                                                                                          │   date_dim  │                                             │   date_dim  │
               │             │                                                                                          │             │                                             │             │
               │    Type:    │                                                                                          │    Type:    │                                             │    Type:    │
               │  Sequential │                                                                                          │  Sequential │                                             │  Sequential │
               │     Scan    │                                                                                          │     Scan    │                                             │     Scan    │
               │             │                                                                                          │             │                                             │             │
               │ Projections:│                                                                                          │ Projections:│                                             │ Projections:│
               │  d_date_sk  │                                                                                          │  d_date_sk  │                                             │  d_date_sk  │
               │             │                                                                                          │             │                                             │             │
               │   Filters:  │                                                                                          │   Filters:  │                                             │   Filters:  │
               │ d_year=2000 │                                                                                          │ d_year=2000 │                                             │ d_year=2000 │
               │   d_moy=8   │                                                                                          │   d_moy=8   │                                             │   d_moy=8   │
               │             │                                                                                          │             │                                             │             │
               │   31 rows   │                                                                                          │   31 rows   │                                             │   31 rows   │
               │   (0.00s)   │                                                                                          │   (0.00s)   │                                             │   (0.00s)   │
               └─────────────┘                                                                                          └─────────────┘                                             └─────────────┘
