-- Q37 EXPLAIN ANALYZE (SF10)
-- State: optimized (retry3w_2, 1.30x)
-- Best speedup: 1.30x
-- Source SQL: /mnt/c/Users/jakc9/Documents/QueryTorque_V8/retry_collect/q37/w3_optimized.sql

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-02-01' AS DATE) AND CAST('2000-04-01' AS DATE)), filtered_inventory AS (SELECT inv_item_sk FROM inventory JOIN filtered_dates ON d_date_sk = inv_date_sk WHERE inv_quantity_on_hand BETWEEN 100 AND 500), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price FROM item WHERE i_current_price BETWEEN 68 AND 68 + 30 AND i_manufact_id IN (677, 940, 694, 808)) SELECT i_item_id, i_item_desc, i_current_price FROM filtered_items JOIN filtered_inventory ON inv_item_sk = i_item_sk WHERE EXISTS(SELECT 1 FROM catalog_sales WHERE cs_item_sk = i_item_sk) GROUP BY i_item_id, i_item_desc, i_current_price ORDER BY i_item_id LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.0315s             ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────────────────┐
│           QUERY           │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      EXPLAIN_ANALYZE      │
│    ────────────────────   │
│           0 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│           TOP_N           │
│    ────────────────────   │
│          Top: 100         │
│                           │
│         Order By:         │
│  filtered_items.i_item_id │
│             ASC           │
│                           │
│           2 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│       HASH_GROUP_BY       │
│    ────────────────────   │
│          Groups:          │
│             #0            │
│             #1            │
│             #2            │
│                           │
│           2 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│         PROJECTION        │
│    ────────────────────   │
│         i_item_id         │
│        i_item_desc        │
│      i_current_price      │
│                           │
│          74 rows          │
│          (0.00s)          │
└─────────────┬─────────────┘
┌─────────────┴─────────────┐
│      RIGHT_DELIM_JOIN     │
│    ────────────────────   │
│   Join Type: RIGHT_SEMI   │
│                           │
│        Conditions:        │
│ i_item_sk IS NOT DISTINCT │
│       FROM i_item_sk      ├────────────────────────────────────────────────────────────────────────┬──────────────────────────────────────────────────────────────────────────────────────┐
│                           │                                                                        │                                                                                      │
│       Delim Index: 1      │                                                                        │                                                                                      │
│                           │                                                                        │                                                                                      │
│           0 rows          │                                                                        │                                                                                      │
│          (0.00s)          │                                                                        │                                                                                      │
└─────────────┬─────────────┘                                                                        │                                                                                      │
┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐                                                          ┌─────────────┴─────────────┐
│         HASH_JOIN         │                                                          │         HASH_JOIN         │                                                          │       HASH_GROUP_BY       │
│    ────────────────────   │                                                          │    ────────────────────   │                                                          │    ────────────────────   │
│      Join Type: INNER     │                                                          │   Join Type: RIGHT_SEMI   │                                                          │         Groups: #1        │
│                           │                                                          │                           │                                                          │                           │
│        Conditions:        │                                                          │        Conditions:        │                                                          │                           │
│  inv_item_sk = i_item_sk  ├───────────────────────────────────────────┐              │ i_item_sk IS NOT DISTINCT ├───────────────────────────────────────────┐              │                           │
│                           │                                           │              │       FROM i_item_sk      │                                           │              │                           │
│                           │                                           │              │                           │                                           │              │                           │
│          74 rows          │                                           │              │          74 rows          │                                           │              │           2 rows          │
│          (0.01s)          │                                           │              │          (0.00s)          │                                           │              │          (0.00s)          │
└─────────────┬─────────────┘                                           │              └─────────────┬─────────────┘                                           │              └───────────────────────────┘
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐
│         PROJECTION        │                             │         PROJECTION        ││         PROJECTION        │                             │         DUMMY_SCAN        │
│    ────────────────────   │                             │    ────────────────────   ││    ────────────────────   │                             │    ────────────────────   │
│        inv_item_sk        │                             │         i_item_sk         ││         i_item_sk         │                             │                           │
│                           │                             │         i_item_id         ││                           │                             │                           │
│                           │                             │        i_item_desc        ││                           │                             │                           │
│                           │                             │      i_current_price      ││                           │                             │                           │
│                           │                             │                           ││                           │                             │                           │
│       1,616,367 rows      │                             │           5 rows          ││          536 rows         │                             │           0 rows          │
│          (0.00s)          │                             │          (0.00s)          ││          (0.00s)          │                             │          (0.00s)          │
└─────────────┬─────────────┘                             └─────────────┬─────────────┘└─────────────┬─────────────┘                             └───────────────────────────┘
┌─────────────┴─────────────┐                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         HASH_JOIN         │                             │         PROJECTION        ││         HASH_JOIN         │
│    ────────────────────   │                             │    ────────────────────   ││    ────────────────────   │
│      Join Type: INNER     │                             │             #0            ││      Join Type: INNER     │
│                           │                             │             #2            ││                           │
│        Conditions:        ├──────────────┐              │             #3            ││        Conditions:        ├──────────────┐
│  inv_date_sk = d_date_sk  │              │              │             #4            ││   cs_item_sk = i_item_sk  │              │
│                           │              │              │                           ││                           │              │
│       1,616,367 rows      │              │              │           5 rows          ││          536 rows         │              │
│          (0.01s)          │              │              │          (0.00s)          ││          (0.04s)          │              │
└─────────────┬─────────────┘              │              └─────────────┬─────────────┘└─────────────┬─────────────┘              │
┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐┌─────────────┴─────────────┐
│         TABLE_SCAN        ││           FILTER          ││           FILTER          ││         TABLE_SCAN        ││         DELIM_SCAN        │
│    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   ││    ────────────────────   │
│      Table: inventory     ││ (d_date_sk BETWEEN 2450815││ ((i_manufact_id = 677) OR ││    Table: catalog_sales   ││       Delim Index: 1      │
│   Type: Sequential Scan   ││        AND 2452635)       ││ (i_manufact_id = 940) OR  ││   Type: Sequential Scan   ││                           │
│                           ││                           ││ (i_manufact_id = 694) OR  ││                           ││                           │
│        Projections:       ││                           ││   (i_manufact_id = 808))  ││        Projections:       ││                           │
│        inv_date_sk        ││                           ││                           ││         cs_item_sk        ││                           │
│        inv_item_sk        ││                           ││                           ││                           ││                           │
│                           ││                           ││                           ││                           ││                           │
│          Filters:         ││                           ││                           ││                           ││                           │
│ inv_quantity_on_hand>=100 ││                           ││                           ││                           ││                           │
│  AND inv_quantity_on_hand<││                           ││                           ││                           ││                           │
│            =500           ││                           ││                           ││                           ││                           │
│                           ││                           ││                           ││                           ││                           │
│       1,616,367 rows      ││          61 rows          ││           5 rows          ││      13,318,909 rows      ││           0 rows          │
│          (0.04s)          ││          (0.00s)          ││          (0.00s)          ││          (0.06s)          ││          (0.00s)          │
└───────────────────────────┘└─────────────┬─────────────┘└─────────────┬─────────────┘└───────────────────────────┘└───────────────────────────┘
                             ┌─────────────┴─────────────┐┌─────────────┴─────────────┐
                             │         TABLE_SCAN        ││         TABLE_SCAN        │
                             │    ────────────────────   ││    ────────────────────   │
                             │      Table: date_dim      ││        Table: item        │
                             │   Type: Sequential Scan   ││   Type: Sequential Scan   │
                             │                           ││                           │
                             │        Projections:       ││        Projections:       │
                             │         d_date_sk         ││      i_current_price      │
                             │                           ││       i_manufact_id       │
                             │          Filters:         ││         i_item_sk         │
                             │ d_date>='2000-02-01'::DATE││         i_item_id         │
                             │  AND d_date<='2000-04-01':││        i_item_desc        │
                             │           :DATE           ││                           │
                             │                           ││          Filters:         │
                             │                           ││ i_current_price>=68.00 AND│
                             │                           ││   i_current_price<=98.00  │
                             │                           ││ optional: i_manufact_id IN│
                             │                           ││    (677, 694, 808, 940)   │
                             │                           ││                           │
                             │          61 rows          ││         3,406 rows        │
                             │          (0.00s)          ││          (0.01s)          │
                             └───────────────────────────┘└───────────────────────────┘
