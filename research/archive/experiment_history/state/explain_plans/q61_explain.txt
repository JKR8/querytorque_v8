-- Q61 EXPLAIN ANALYZE (SF10)
-- State: baseline
-- Best speedup: 1.00x
-- Source SQL: /mnt/d/TPC-DS/queries_duckdb_converted/query_61.sql

analyzed_plan
┌─────────────────────────────────────┐
│┌───────────────────────────────────┐│
││    Query Profiling Information    ││
│└───────────────────────────────────┘│
└─────────────────────────────────────┘
EXPLAIN ANALYZE select promotions,total,cast(promotions as decimal(15,4))/cast(total as decimal(15,4))*100 from   (select sum(ss_ext_sales_price) promotions    from  store_sales         ,store         ,promotion         ,date_dim         ,customer         ,customer_address          ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_promo_sk = p_promo_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk     and   ca_gmt_offset = -7    and   i_category = 'Jewelry'    and   (p_channel_dmail = 'Y' or p_channel_email = 'Y' or p_channel_tv = 'Y')    and   s_gmt_offset = -7    and   d_year = 1999    and   d_moy  = 11) promotional_sales,   (select sum(ss_ext_sales_price) total    from  store_sales         ,store         ,date_dim         ,customer         ,customer_address         ,item    where ss_sold_date_sk = d_date_sk    and   ss_store_sk = s_store_sk    and   ss_customer_sk= c_customer_sk    and   ca_address_sk = c_current_addr_sk    and   ss_item_sk = i_item_sk    and   ca_gmt_offset = -7    and   i_category = 'Jewelry'    and   s_gmt_offset = -7    and   d_year = 1999    and   d_moy  = 11) all_sales order by promotions, total  LIMIT 100
┌────────────────────────────────────────────────┐
│┌──────────────────────────────────────────────┐│
││              Total Time: 0.0217s             ││
│└──────────────────────────────────────────────┘│
└────────────────────────────────────────────────┘
┌───────────────┐
│     QUERY     │
└───────┬───────┘
┌───────┴───────┐
│EXPLAIN_ANALYZE│
│    ────────   │
│     0 rows    │
│    (0.00s)    │
└───────┬───────┘
┌───────┴───────┐
│     TOP_N     │
│    ────────   │
│    Top: 100   │
│               │
│   Order By:   │
│promotional_sal│
│ es.promotions │
│       ASC     │
│   all_sales   │
│   .total ASC  │
│               │
│     1 row     │
│    (0.00s)    │
└───────┬───────┘
┌───────┴───────┐
│   PROJECTION  │
│    ────────   │
│   promotions  │
│     total     │
│  ((CAST(CAST  │
│ (promotions AS│
│  DECIMAL(15,4)│
│ ) AS DOUBLE) /│
│    CAST(CAST  │
│   (total AS   │
│  DECIMAL(15,4)│
│ ) AS DOUBLE)) │
│    * 100.0)   │
│               │
│     1 row     │
│    (0.00s)    │
└───────┬───────┘
┌───────┴───────┐
│ CROSS_PRODUCT │
│    ────────   │
│     1 row     ├──────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│    (0.00s)    │                                                                                                              │
└───────┬───────┘                                                                                                              │
┌───────┴───────┐                                                                                                      ┌───────┴───────┐
│UNGROUPED_...  │                                                                                                      │UNGROUPED_...  │
│    ────────   │                                                                                                      │    ────────   │
│  Aggregates:  │                                                                                                      │  Aggregates:  │
│    sum(#0)    │                                                                                                      │    sum(#0)    │
│               │                                                                                                      │               │
│     1 row     │                                                                                                      │     1 row     │
│    (0.00s)    │                                                                                                      │    (0.00s)    │
└───────┬───────┘                                                                                                      └───────┬───────┘
┌───────┴───────┐                                                                                                      ┌───────┴───────┐
│   PROJECTION  │                                                                                                      │   PROJECTION  │
│    ────────   │                                                                                                      │    ────────   │
│ss_ext_sales_pr│                                                                                                      │ss_ext_sales_pr│
│      ice      │                                                                                                      │      ice      │
│               │                                                                                                      │               │
│     0 rows    │                                                                                                      │     0 rows    │
│    (0.00s)    │                                                                                                      │    (0.00s)    │
└───────┬───────┘                                                                                                      └───────┬───────┘
┌───────┴───────┐                                                                                                      ┌───────┴───────┐
│   HASH_JOIN   │                                                                                                      │   HASH_JOIN   │
│    ────────   │                                                                                                      │    ────────   │
│   Join Type:  │                                                                                                      │   Join Type:  │
│     INNER     │                                                                                                      │     INNER     │
│               │                                                                                                      │               │
│  Conditions:  │                                                                                                      │  Conditions:  │
│ ca_address_sk ├────────┐                                                                                             │ ca_address_sk ├────────┐
│= c_current_add│        │                                                                                             │= c_current_add│        │
│      r_sk     │        │                                                                                             │      r_sk     │        │
│               │        │                                                                                             │               │        │
│     0 rows    │        │                                                                                             │     0 rows    │        │
│    (0.00s)    │        │                                                                                             │    (0.00s)    │        │
└───────┬───────┘        │                                                                                             └───────┬───────┘        │
┌───────┴───────┐┌───────┴───────┐                                                                                     ┌───────┴───────┐┌───────┴───────┐
│   TABLE_SCAN  ││   HASH_JOIN   │                                                                                     │   TABLE_SCAN  ││   HASH_JOIN   │
│    ────────   ││    ────────   │                                                                                     │    ────────   ││    ────────   │
│     Table:    ││   Join Type:  │                                                                                     │     Table:    ││   Join Type:  │
│customer_addres││     INNER     │                                                                                     │customer_addres││     INNER     │
│       s       ││               │                                                                                     │       s       ││               │
│               ││  Conditions:  │                                                                                     │               ││  Conditions:  │
│     Type:     ││ c_customer_sk │                                                                                     │     Type:     ││ c_customer_sk │
│Sequential Scan││= ss_customer_s│                                                                                     │Sequential Scan││= ss_customer_s│
│               ││       k       │                                                                                     │               ││       k       │
│  Projections: ││               ├────────┐                                                                            │  Projections: ││               ├────────┐
│ ca_address_sk ││               │        │                                                                            │ ca_address_sk ││               │        │
│               ││               │        │                                                                            │               ││               │        │
│    Filters:   ││               │        │                                                                            │    Filters:   ││               │        │
│ ca_gmt_offset=││               │        │                                                                            │ ca_gmt_offset=││               │        │
│     -7.00     ││               │        │                                                                            │     -7.00     ││               │        │
│               ││               │        │                                                                            │               ││               │        │
│    702 rows   ││     0 rows    │        │                                                                            │    702 rows   ││     0 rows    │        │
│    (0.00s)    ││    (0.00s)    │        │                                                                            │    (0.00s)    ││    (0.00s)    │        │
└───────────────┘└───────┬───────┘        │                                                                            └───────────────┘└───────┬───────┘        │
                 ┌───────┴───────┐┌───────┴───────┐                                                                                     ┌───────┴───────┐┌───────┴───────┐
                 │   TABLE_SCAN  ││   HASH_JOIN   │                                                                                     │   TABLE_SCAN  ││   HASH_JOIN   │
                 │    ────────   ││    ────────   │                                                                                     │    ────────   ││    ────────   │
                 │     Table:    ││   Join Type:  │                                                                                     │     Table:    ││   Join Type:  │
                 │    customer   ││     INNER     │                                                                                     │    customer   ││     INNER     │
                 │               ││               │                                                                                     │               ││               │
                 │     Type:     ││  Conditions:  │                                                                                     │     Type:     ││  Conditions:  │
                 │Sequential Scan││ ss_store_sk = │                                                                                     │Sequential Scan││ ss_store_sk = │
                 │               ││   s_store_sk  ├───────────────────────────────────────────────────────────┐                         │               ││   s_store_sk  ├──────────────────────────────────────────┐
                 │  Projections: ││               │                                                           │                         │  Projections: ││               │                                          │
                 │ c_customer_sk ││               │                                                           │                         │ c_customer_sk ││               │                                          │
                 │c_current_addr_││               │                                                           │                         │c_current_addr_││               │                                          │
                 │       sk      ││               │                                                           │                         │       sk      ││               │                                          │
                 │               ││               │                                                           │                         │               ││               │                                          │
                 │  10,240 rows  ││     0 rows    │                                                           │                         │  10,240 rows  ││     0 rows    │                                          │
                 │    (0.00s)    ││    (0.00s)    │                                                           │                         │    (0.00s)    ││    (0.00s)    │                                          │
                 └───────────────┘└───────┬───────┘                                                           │                         └───────────────┘└───────┬───────┘                                          │
                                  ┌───────┴───────┐                                                   ┌───────┴───────┐                                  ┌───────┴───────┐                                  ┌───────┴───────┐
                                  │   HASH_JOIN   │                                                   │     FILTER    │                                  │   HASH_JOIN   │                                  │     FILTER    │
                                  │    ────────   │                                                   │    ────────   │                                  │    ────────   │                                  │    ────────   │
                                  │   Join Type:  │                                                   │ (s_store_sk <=│                                  │   Join Type:  │                                  │ (s_store_sk <=│
                                  │     INNER     │                                                   │      100)     │                                  │     INNER     │                                  │      100)     │
                                  │               │                                                   │               │                                  │               │                                  │               │
                                  │  Conditions:  ├──────────────────────────────────────────┐        │               │                                  │  Conditions:  ├─────────────────────────┐        │               │
                                  │ ss_promo_sk = │                                          │        │               │                                  │  ss_item_sk = │                         │        │               │
                                  │   p_promo_sk  │                                          │        │               │                                  │    i_item_sk  │                         │        │               │
                                  │               │                                          │        │               │                                  │               │                         │        │               │
                                  │   1,110 rows  │                                          │        │     0 rows    │                                  │   2,216 rows  │                         │        │     0 rows    │
                                  │    (0.00s)    │                                          │        │    (0.00s)    │                                  │    (0.00s)    │                         │        │    (0.00s)    │
                                  └───────┬───────┘                                          │        └───────┬───────┘                                  └───────┬───────┘                         │        └───────┬───────┘
                                  ┌───────┴───────┐                                  ┌───────┴───────┐┌───────┴───────┐                                  ┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐
                                  │   HASH_JOIN   │                                  │   PROJECTION  ││  EMPTY_RESULT │                                  │   HASH_JOIN   │                 │   TABLE_SCAN  ││  EMPTY_RESULT │
                                  │    ────────   │                                  │    ────────   ││    ────────   │                                  │    ────────   │                 │    ────────   ││    ────────   │
                                  │   Join Type:  │                                  │       #0      ││               │                                  │   Join Type:  │                 │     Table:    ││               │
                                  │     INNER     │                                  │               ││               │                                  │     INNER     │                 │      item     ││               │
                                  │               │                                  │               ││               │                                  │               │                 │               ││               │
                                  │  Conditions:  │                                  │               ││               │                                  │  Conditions:  │                 │     Type:     ││               │
                                  │  ss_item_sk = │                                  │               ││               │                                  │ss_sold_date_sk│                 │Sequential Scan││               │
                                  │    i_item_sk  │                                  │               ││               │                                  │   = d_date_sk │                 │               ││               │
                                  │               ├─────────────────────────┐        │               ││               │                                  │               ├────────┐        │  Projections: ││               │
                                  │               │                         │        │               ││               │                                  │               │        │        │   i_item_sk   ││               │
                                  │               │                         │        │               ││               │                                  │               │        │        │               ││               │
                                  │               │                         │        │               ││               │                                  │               │        │        │    Filters:   ││               │
                                  │               │                         │        │               ││               │                                  │               │        │        │  i_category=  ││               │
                                  │               │                         │        │               ││               │                                  │               │        │        │   'Jewelry'   ││               │
                                  │               │                         │        │               ││               │                                  │               │        │        │               ││               │
                                  │   2,196 rows  │                         │        │    251 rows   ││     0 rows    │                                  │  57,498 rows  │        │        │  10,063 rows  ││     0 rows    │
                                  │    (0.00s)    │                         │        │    (0.00s)    ││    (0.00s)    │                                  │    (0.00s)    │        │        │    (0.00s)    ││    (0.00s)    │
                                  └───────┬───────┘                         │        └───────┬───────┘└───────────────┘                                  └───────┬───────┘        │        └───────────────┘└───────────────┘
                                  ┌───────┴───────┐                 ┌───────┴───────┐┌───────┴───────┐                                                   ┌───────┴───────┐┌───────┴───────┐
                                  │   HASH_JOIN   │                 │   TABLE_SCAN  ││     FILTER    │                                                   │   TABLE_SCAN  ││     FILTER    │
                                  │    ────────   │                 │    ────────   ││    ────────   │                                                   │    ────────   ││    ────────   │
                                  │   Join Type:  │                 │     Table:    ││((p_channel_dma│                                                   │     Table:    ││   (d_date_sk  │
                                  │     INNER     │                 │      item     ││ il = 'Y') OR  │                                                   │  store_sales  ││     BETWEEN   │
                                  │               │                 │               ││(p_channel_emai│                                                   │               ││   2450816 AND │
                                  │  Conditions:  │                 │     Type:     ││  l = 'Y') OR  │                                                   │     Type:     ││    2452642)   │
                                  │ss_sold_date_sk│                 │Sequential Scan││ (p_channel_tv │                                                   │Sequential Scan││               │
                                  │   = d_date_sk │                 │               ││    = 'Y'))    │                                                   │               ││               │
                                  │               │                 │  Projections: ││               │                                                   │  Projections: ││               │
                                  │               ├────────┐        │   i_item_sk   ││               │                                                   │ss_sold_date_sk││               │
                                  │               │        │        │               ││               │                                                   │  ss_store_sk  ││               │
                                  │               │        │        │    Filters:   ││               │                                                   │ ss_customer_sk││               │
                                  │               │        │        │  i_category=  ││               │                                                   │   ss_item_sk  ││               │
                                  │               │        │        │   'Jewelry'   ││               │                                                   │ss_ext_sales_pr││               │
                                  │               │        │        │               ││               │                                                   │      ice      ││               │
                                  │               │        │        │               ││               │                                                   │               ││               │
                                  │  55,766 rows  │        │        │  10,063 rows  ││    251 rows   │                                                   │  58,835 rows  ││    30 rows    │
                                  │    (0.00s)    │        │        │    (0.00s)    ││    (0.00s)    │                                                   │    (0.02s)    ││    (0.00s)    │
                                  └───────┬───────┘        │        └───────────────┘└───────┬───────┘                                                   └───────────────┘└───────┬───────┘
                                  ┌───────┴───────┐┌───────┴───────┐                 ┌───────┴───────┐                                                                    ┌───────┴───────┐
                                  │   TABLE_SCAN  ││     FILTER    │                 │   TABLE_SCAN  │                                                                    │   TABLE_SCAN  │
                                  │    ────────   ││    ────────   │                 │    ────────   │                                                                    │    ────────   │
                                  │     Table:    ││   (d_date_sk  │                 │     Table:    │                                                                    │     Table:    │
                                  │  store_sales  ││     BETWEEN   │                 │   promotion   │                                                                    │    date_dim   │
                                  │               ││   2450816 AND │                 │               │                                                                    │               │
                                  │     Type:     ││    2452642)   │                 │     Type:     │                                                                    │     Type:     │
                                  │Sequential Scan││               │                 │Sequential Scan│                                                                    │Sequential Scan│
                                  │               ││               │                 │               │                                                                    │               │
                                  │  Projections: ││               │                 │  Projections: │                                                                    │  Projections: │
                                  │ss_sold_date_sk││               │                 │   p_promo_sk  │                                                                    │   d_date_sk   │
                                  │  ss_store_sk  ││               │                 │p_channel_dmail│                                                                    │               │
                                  │  ss_promo_sk  ││               │                 │p_channel_email│                                                                    │    Filters:   │
                                  │ ss_customer_sk││               │                 │  p_channel_tv │                                                                    │  d_year=1999  │
                                  │   ss_item_sk  ││               │                 │               │                                                                    │    d_moy=11   │
                                  │ss_ext_sales_pr││               │                 │               │                                                                    │               │
                                  │      ice      ││               │                 │               │                                                                    │               │
                                  │               ││               │                 │               │                                                                    │               │
                                  │  57,126 rows  ││    30 rows    │                 │    500 rows   │                                                                    │    30 rows    │
                                  │    (0.03s)    ││    (0.00s)    │                 │    (0.00s)    │                                                                    │    (0.00s)    │
                                  └───────────────┘└───────┬───────┘                 └───────────────┘                                                                    └───────────────┘
                                                   ┌───────┴───────┐
                                                   │   TABLE_SCAN  │
                                                   │    ────────   │
                                                   │     Table:    │
                                                   │    date_dim   │
                                                   │               │
                                                   │     Type:     │
                                                   │Sequential Scan│
                                                   │               │
                                                   │  Projections: │
                                                   │   d_date_sk   │
                                                   │               │
                                                   │    Filters:   │
                                                   │  d_year=1999  │
                                                   │    d_moy=11   │
                                                   │               │
                                                   │    30 rows    │
                                                   │    (0.00s)    │
                                                   └───────────────┘
