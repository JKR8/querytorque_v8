```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "multi_dimension_prefetch",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 1999",
        "filtered_customer_demographics": "SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'F' AND cd_marital_status = 'D' AND cd_education_status = 'Secondary'",
        "filtered_stores": "SELECT s_store_sk, s_state FROM store WHERE s_state IN ('MO', 'AL', 'MI', 'TN', 'LA', 'SC')",
        "filtered_items": "SELECT i_item_sk, i_item_id FROM item",
        "joined_facts": "SELECT ss_item_sk, ss_store_sk, ss_quantity, ss_list_price, ss_coupon_amt, ss_sales_price FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_customer_demographics AS fcd ON ss.ss_cdemo_sk = fcd.cd_demo_sk",
        "main_query": "SELECT i_item_id, s_state, GROUPING(s_state) AS g_state, AVG(ss_quantity) AS agg1, AVG(ss_list_price) AS agg2, AVG(ss_coupon_amt) AS agg3, AVG(ss_sales_price) AS agg4 FROM joined_facts AS jf JOIN filtered_stores AS fs ON jf.ss_store_sk = fs.s_store_sk JOIN filtered_items AS fi ON jf.ss_item_sk = fi.i_item_sk GROUP BY ROLLUP (i_item_id, s_state) ORDER BY i_item_id, s_state LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "ROLLUP grouping preserved",
        "literal values preserved exactly"
      ],
      "expected_speedup": "3.0x",
      "risk": "low"
    }
  ],
  "explanation": "Created separate CTEs for each dimension table with selective filters applied early. The date_dim CTE filters to only 1999 dates (365 rows vs 73,049), customer_demographics filters to specific gender/marital/education (27,440 rows vs 23M), and store filters to 6 states (102 rows). The fact table (store_sales) joins with these small CTEs first via their foreign keys, dramatically reducing the intermediate join size before joining with item and store. This leverages the high selectivity of dimension filters observed in the execution plan (date_dim: 0.5%, customer_demographics: 0.12% selectivity). The original OR structure is preserved (none existed), and all literal values are copied exactly from the original query."
}
```