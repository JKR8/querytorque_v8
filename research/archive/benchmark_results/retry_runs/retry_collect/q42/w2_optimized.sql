WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000 AND d_moy = 11), filtered_items AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1), filtered_sales AS (SELECT ss_sold_date_sk, ss_item_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk)
SELECT fd.d_year, fi.i_category_id, fi.i_category, SUM(ss_ext_sales_price) FROM filtered_sales AS fs JOIN filtered_items AS fi ON fs.ss_item_sk = fi.i_item_sk CROSS JOIN filtered_dates AS fd GROUP BY fd.d_year, fi.i_category_id, fi.i_category ORDER BY SUM(ss_ext_sales_price) DESC, fd.d_year, fi.i_category_id, fi.i_category LIMIT 100