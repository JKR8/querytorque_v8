{
  "timestamp": "20260206_002648",
  "summary": {
    "total_queries": 25,
    "improved": 14,
    "fixed": 14,
    "validation_time_s": 904.9798738956451
  },
  "results": [
    {
      "query_id": "q16",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Ambiguous reference to column name \"cs_order_number\" (use: \"cs1.cs_order_number\" or \"mwo.cs_order_number\")",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q16",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "fail",
      "speedup": 0.7201601089947108,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='total net profit', original_value=Decimal('-919212.20'), optimized_value=Decimal('-921718.93')), ValueDifference(row_index=0, column='total shipping cost', original_value=Decimal('3697013.80'), optimized_value=Decimal('3697020.07'))]\nOriginal row 0: {'order count': 803, 'total shipping cost': Decimal('3697013.80'), 'total net profit': Decimal('-919212.20')}\nOptimized row 0: {'order count': 803, 'total shipping cost': Decimal('3697020.07'), 'total net profit': Decimal('-921718.93')}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-02-01' AND CAST('2002-04-02' AS DATE)), filtered_shipments AS (SELECT cs1.cs_order_number, cs1.cs_ext_ship_cost, cs1.cs_net_profit, cs1.cs_ship_addr_sk, cs1.cs_call_center_sk FROM catalog_sales AS cs1 JOIN filtered_dates ON cs1.cs_ship_date_sk = d_date_sk) SELECT COUNT(DISTINCT cs_order_number) AS \"order count\", SUM(cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs_net_profit) AS \"total net profit\" FROM filtered_shipments AS fs JOIN customer_address ON fs.cs_ship_addr_sk = ca_address_sk JOIN call_center ON fs.cs_call_center_sk = cc_call_center_sk WHERE ca_state = 'GA' AND cc_county = 'Williamson County' AND EXISTS(SELECT 1 FROM catalog_sales AS cs2 WHERE fs.cs_order_number = cs2.cs_order_number AND fs.cs_ship_addr_sk <> cs2.cs_warehouse_sk) AND NOT EXISTS(SELECT 1 FROM catalog_returns AS cr1 WHERE fs.cs_order_number = cr1.cr_order_number) GROUP BY () ORDER BY COUNT(DISTINCT cs_order_number) LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q34",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Referenced column \"d_dom\" not found in FROM clause!\nCandidate bindings: \"hd_demo_sk\", \"d_date_sk\", \"ss_promo_sk\", \"ss_sold_time_sk\", \"ss_sold_date_sk\"\n\nLINE 1: ... s_store_sk JOIN filtered_hd ON ss_hdemo_sk = hd_demo_sk WHERE d_dom BETWEEN 1 AND 3 AND hd_buy_potential = '>10000' GROUP...\n                                                                          ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q34",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 0.7953948107169712,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q94",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 0.24111223635742648,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q34",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0.3572823470075284,
      "error": "SEMANTIC ERROR: Row count mismatch (original=1560, optimized=100)\nYour query DROPPED 1460 rows - likely an incorrect filter or JOIN condition\nOriginal query sample (first 3 of 1560 rows): [{'c_last_name': None, 'c_first_name': None, 'c_salutation': None, 'c_preferred_cust_flag': None, 'ss_ticket_number': 280731, 'cnt': 15}, {'c_last_name': None, 'c_first_name': None, 'c_salutation': None, 'c_preferred_cust_flag': None, 'ss_ticket_number': 796910, 'cnt': 15}, {'c_last_name': None, 'c_first_name': None, 'c_salutation': None, 'c_preferred_cust_flag': None, 'ss_ticket_number': 1449606, 'cnt': 15}]\nOptimized query sample (first 3 of 100 rows): [{'c_last_name': None, 'c_first_name': None, 'c_salutation': None, 'c_preferred_cust_flag': None, 'ss_ticket_number': 280731, 'cnt': 15}, {'c_last_name': None, 'c_first_name': None, 'c_salutation': None, 'c_preferred_cust_flag': None, 'ss_ticket_number': 796910, 'cnt': 15}, {'c_last_name': None, 'c_first_name': None, 'c_salutation': None, 'c_preferred_cust_flag': None, 'ss_ticket_number': 1449606, 'cnt': 15}]\nYour optimized SQL that failed:\n```sql\nWITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_county = 'Williamson County'), date_1_3 AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 3 AND d_year IN (1999, 2000, 2001)), date_25_28 AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 25 AND 28 AND d_year IN (1999, 2000, 2001)), hd_10000 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), hd_unknown AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = 'Unknown' AND hd_vehicle_count > 0 AND (hd_dep_count * 1.000) / hd_vehicle_count > 1.2), union_branches AS (SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN date_1_3 AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN hd_10000 AS h ON ss.ss_hdemo_sk = h.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN date_1_3 AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN hd_unknown AS h ON ss.ss_hdemo_sk = h.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN date_25_28 AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN hd_10000 AS h ON ss.ss_hdemo_sk = h.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM store_sales AS ss JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN date_25_28 AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN hd_unknown AS h ON ss.ss_hdemo_sk = h.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk) SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM (SELECT ss_ticket_number, ss_customer_sk, SUM(cnt) AS cnt FROM union_branches GROUP BY ss_ticket_number, ss_customer_sk HAVING SUM(cnt) BETWEEN 15 AND 20) AS dn JOIN customer AS c ON dn.ss_customer_sk = c.c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, c_salutation NULLS FIRST, c_preferred_cust_flag DESC NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q16",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0.06531376537301442,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='total net profit', original_value=Decimal('-919212.20'), optimized_value=Decimal('-921718.93')), ValueDifference(row_index=0, column='total shipping cost', original_value=Decimal('3697013.80'), optimized_value=Decimal('3697020.07'))]\nOriginal row 0: {'order count': 803, 'total shipping cost': Decimal('3697013.80'), 'total net profit': Decimal('-919212.20')}\nOptimized row 0: {'order count': 803, 'total shipping cost': Decimal('3697020.07'), 'total net profit': Decimal('-921718.93')}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-02-01' AND CAST('2002-04-02' AS DATE)), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_state = 'GA'), filtered_call_centers AS (SELECT cc_call_center_sk FROM call_center WHERE cc_county = 'Williamson County'), multi_warehouse_orders AS (SELECT cs_order_number FROM catalog_sales GROUP BY cs_order_number HAVING COUNT(DISTINCT cs_warehouse_sk) > 1), non_returned_orders AS (SELECT cr_order_number FROM catalog_returns) SELECT COUNT(DISTINCT cs1.cs_order_number) AS \"order count\", SUM(cs1.cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs1.cs_net_profit) AS \"total net profit\" FROM catalog_sales AS cs1 JOIN filtered_dates AS fd ON cs1.cs_ship_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON cs1.cs_ship_addr_sk = fa.ca_address_sk JOIN filtered_call_centers AS fc ON cs1.cs_call_center_sk = fc.cc_call_center_sk JOIN multi_warehouse_orders AS mwo ON cs1.cs_order_number = mwo.cs_order_number LEFT JOIN non_returned_orders AS nro ON cs1.cs_order_number = nro.cr_order_number WHERE nro.cr_order_number IS NULL GROUP BY () ORDER BY COUNT(DISTINCT cs1.cs_order_number) LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q94",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.11525175430452411,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q26",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.93155758504716,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q26",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 0.3355025435590715,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q94",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.07238664578625592,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q26",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "fail",
      "speedup": 0.22056530644852734,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=42, column='agg1', original_value=5.0, optimized_value=49.5), ValueDifference(row_index=42, column='agg2', original_value=105.78, optimized_value=72.79), ValueDifference(row_index=42, column='agg4', original_value=97.31, optimized_value=30.45), ValueDifference(row_index=42, column='i_item_id', original_value='AAAAAAAAAACCBAAA', optimized_value='AAAAAAAAAALCBAAA'), ValueDifference(row_index=43, column='agg2', original_value=137.34, optimized_value=105.78)]\nOriginal row 0: {'i_item_id': 'AAAAAAAAAAAABAAA', 'agg1': 90.0, 'agg2': 166.56, 'agg3': 0.0, 'agg4': 74.95}\nOptimized row 0: {'i_item_id': 'AAAAAAAAAAAABAAA', 'agg1': 90.0, 'agg2': 166.56, 'agg3': 0.0, 'agg4': 74.95}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), branch_email AS (SELECT cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, i_item_id FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN item ON cs_item_sk = i_item_sk JOIN promotion ON cs_promo_sk = p_promo_sk WHERE p_channel_email = 'N' AND p_channel_event <> 'N'), branch_event AS (SELECT cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, i_item_id FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN item ON cs_item_sk = i_item_sk JOIN promotion ON cs_promo_sk = p_promo_sk WHERE p_channel_event = 'N' AND p_channel_email <> 'N'), branch_both AS (SELECT cs_quantity, cs_list_price, cs_coupon_amt, cs_sales_price, i_item_id FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_customer_demographics ON cs_bill_cdemo_sk = cd_demo_sk JOIN item ON cs_item_sk = i_item_sk JOIN promotion ON cs_promo_sk = p_promo_sk WHERE p_channel_email = 'N' AND p_channel_event = 'N'), combined_sales AS (SELECT * FROM branch_email UNION ALL SELECT * FROM branch_event UNION ALL SELECT * FROM branch_both) SELECT i_item_id, AVG(cs_quantity) AS agg1, AVG(cs_list_price) AS agg2, AVG(cs_coupon_amt) AS agg3, AVG(cs_sales_price) AS agg4 FROM combined_sales GROUP BY i_item_id ORDER BY i_item_id LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q9",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.6509541273139003,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q9",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.0495823887002833,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q5",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Referenced column \"wr_web_site_sk\" not found in FROM clause!\nCandidate bindings: \"wr_web_page_sk\", \"ws_web_site_sk\", \"wr_item_sk\", \"wr_returning_hdemo_sk\", \"wr_returning_cdemo_sk\"\n\nLINE 1: ...e_sk = d_date_sk UNION ALL SELECT COALESCE(ws_web_site_sk, wr_web_site_sk) AS wsr_web_site_sk, CAST(0 AS DECIMAL(7...\n                                                                      ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q42",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.9713429803256117,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q42",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "fail",
      "speedup": 0.7030819040437468,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='sum(ss_ext_sales_price)', original_value=Decimal('2536111.33'), optimized_value=Decimal('76083339.90')), ValueDifference(row_index=1, column='sum(ss_ext_sales_price)', original_value=Decimal('3079043.11'), optimized_value=Decimal('92371293.30')), ValueDifference(row_index=2, column='sum(ss_ext_sales_price)', original_value=Decimal('3517172.56'), optimized_value=Decimal('105515176.80')), ValueDifference(row_index=3, column='sum(ss_ext_sales_price)', original_value=Decimal('3083177.40'), optimized_value=Decimal('92495322.00')), ValueDifference(row_index=4, column='sum(ss_ext_sales_price)', original_value=Decimal('2867114.78'), optimized_value=Decimal('86013443.40'))]\nOriginal row 0: {'d_year': 2000, 'i_category_id': 10, 'i_category': 'Electronics', 'sum(ss_ext_sales_price)': Decimal('3517172.56')}\nOptimized row 0: {'d_year': 2000, 'i_category_id': 10, 'i_category': 'Electronics', 'sum(ss_ext_sales_price)': Decimal('105515176.80')}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000 AND d_moy = 11), filtered_items AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1), filtered_sales AS (SELECT ss_sold_date_sk, ss_item_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk) SELECT fd.d_year, fi.i_category_id, fi.i_category, SUM(ss_ext_sales_price) FROM filtered_sales AS fs JOIN filtered_items AS fi ON fs.ss_item_sk = fi.i_item_sk CROSS JOIN filtered_dates AS fd GROUP BY fd.d_year, fi.i_category_id, fi.i_category ORDER BY SUM(ss_ext_sales_price) DESC, fd.d_year, fi.i_category_id, fi.i_category LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q42",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.6911961374790638,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q5",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 1.2164506534149993,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q5",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.8906754572899755,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q58",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.7112490487614529,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q91",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.8862365839518186,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q91",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 0.8422994044327969,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q58",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 1.0081507963263885,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q91",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.7011617224672984,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q58",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.33227038203634807,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q9",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 4.46697102956792,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q12",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.7450965487951521,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q12",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 0.7535718866058592,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q12",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 1.2286000120497942,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q63",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.8627042967688829,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q29",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 0.9002754599777265,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q63",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 3.7736899229018728,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q63",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: HAVING clause cannot contain window functions!\n\nLINE 1: ... combined_sales GROUP BY i_manager_id, d_moy HAVING CASE WHEN AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manager_id...\n                                                                         ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q43",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.9936178517797155,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q29",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 2.350634893835689,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q29",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.5801188577442139,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q43",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 1.320619633517202,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q43",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 2.710111085592758,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q48",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Referenced column \"ss_sold_date_sk\" not found in FROM clause!\nCandidate bindings: \"ss_store_sk\", \"s_closed_date_sk\", \"ss_addr_sk\", \"ss_cdemo_sk\", \"d_date_sk\"\n\nLINE 1: ... AND ca_state IN ('CO', 'OH', 'TX') JOIN date_filtered AS d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN...\n                                                                          ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q38",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.8969636666692856,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q48",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Referenced column \"cd_demo_sk\" not found in FROM clause!\nCandidate bindings: \"ss_cdemo_sk\", \"d_date_sk\", \"ss_hdemo_sk\", \"ss_item_sk\", \"s_closed_date_sk\"\n\nLINE 1: ... = d_date_sk JOIN store ON s_store_sk = ss_store_sk WHERE cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND...\n                                                                     ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q37",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.8280514066896514,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q37",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 1.3003223741455647,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q37",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.885740039165488,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q38",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "fail",
      "speedup": 1.6350680303915979,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='count_star()', original_value=487, optimized_value=92)]\nOriginal row 0: {'count_star()': 487}\nOptimized row 0: {'count_star()': 92}\nYour optimized SQL that failed:\n```sql\nWITH date_filter AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11) SELECT COUNT(*) FROM (SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales, date_filter, customer WHERE web_sales.ws_sold_date_sk = date_filter.d_date_sk AND web_sales.ws_bill_customer_sk = customer.c_customer_sk AND EXISTS(SELECT 1 FROM store_sales, date_filter AS sf, customer AS sc WHERE store_sales.ss_sold_date_sk = sf.d_date_sk AND store_sales.ss_customer_sk = sc.c_customer_sk AND sc.c_last_name = customer.c_last_name AND sc.c_first_name = customer.c_first_name AND sf.d_date = date_filter.d_date) AND EXISTS(SELECT 1 FROM catalog_sales, date_filter AS cf, customer AS cc WHERE catalog_sales.cs_sold_date_sk = cf.d_date_sk AND catalog_sales.cs_bill_customer_sk = cc.c_customer_sk AND cc.c_last_name = customer.c_last_name AND cc.c_first_name = customer.c_first_name AND cf.d_date = date_filter.d_date)) AS hot_cust LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q82",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.1823223493291828,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q82",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "fail",
      "speedup": 1.0995142800493134,
      "error": "SEMANTIC ERROR: Row count mismatch (original=6, optimized=100)\nYour query ADDED 94 extra rows - likely a missing DISTINCT or incorrect JOIN\nOriginal query sample (first 3 of 6 rows): [{'i_item_id': 'AAAAAAAADDLHBAAA', 'i_item_desc': 'There top designers could tackle then just', 'i_current_price': Decimal('66.09')}, {'i_item_id': 'AAAAAAAADGEFBAAA', 'i_item_desc': 'Increased steps ought to see never commercial banks. Items find also ideas. Often narrow developers say for the centres. ', 'i_current_price': Decimal('86.30')}, {'i_item_id': 'AAAAAAAAECMCAAAA', 'i_item_desc': 'Arab, financial pol', 'i_current_price': Decimal('67.28')}]\nOptimized query sample (first 3 of 100 rows): [{'i_item_id': 'AAAAAAAADDLHBAAA', 'i_item_desc': 'There top designers could tackle then just', 'i_current_price': Decimal('66.09')}, {'i_item_id': 'AAAAAAAADDLHBAAA', 'i_item_desc': 'There top designers could tackle then just', 'i_current_price': Decimal('66.09')}, {'i_item_id': 'AAAAAAAADDLHBAAA', 'i_item_desc': 'There top designers could tackle then just', 'i_current_price': Decimal('66.09')}]\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-05-25' AS DATE) AND CAST('2000-07-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_current_price, i_manufact_id FROM item WHERE i_current_price BETWEEN 62 AND 92 AND i_manufact_id IN (129, 270, 821, 423)), filtered_inventory AS (SELECT inv_item_sk, inv_date_sk FROM inventory WHERE inv_quantity_on_hand BETWEEN 100 AND 500), qualified_inventory AS (SELECT inv_item_sk FROM filtered_inventory AS inv JOIN filtered_dates AS dd ON inv.inv_date_sk = dd.d_date_sk) SELECT fi.i_item_id, fi.i_item_desc, fi.i_current_price FROM filtered_items AS fi JOIN qualified_inventory AS qi ON fi.i_item_sk = qi.inv_item_sk WHERE EXISTS(SELECT 1 FROM store_sales AS ss WHERE ss.ss_item_sk = fi.i_item_sk) ORDER BY fi.i_item_id LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q96",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.9712776011957084,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q82",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.47639249946945494,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q38",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 1.4433112410415658,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q96",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 1.6437183393650758,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q96",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 1.0566221846490862,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q25",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.5738113548852102,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q25",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 0.6869241265246135,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q48",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.24042195413893772,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q53",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.09841095605355976,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q25",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.007915414024956232,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q53",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: HAVING clause cannot contain window functions!\n\nLINE 1: ...= fs.ss_item_sk GROUP BY i_manufact_id, d_qoy HAVING CASE WHEN AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_manufact_id...\n                                                                          ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q53",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Catalog Error: Table with name filtered_dates does not exist!\nDid you mean \"sqlite_master\"?\n\nLINE 1: WITH filtered_dates AS (SELECT * FROM filtered_dates), union_branches AS (SELECT i_manufact_id...\n                                              ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q7",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.5537753842647851,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q7",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "fail",
      "speedup": 0.9964731323389494,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=44, column='agg1', original_value=46.333333333333336, optimized_value=46.5), ValueDifference(row_index=44, column='agg2', original_value=82.72, optimized_value=70.585), ValueDifference(row_index=44, column='agg3', original_value=0.0, optimized_value=499.49), ValueDifference(row_index=44, column='agg4', original_value=24.906666666666666, optimized_value=48.0), ValueDifference(row_index=44, column='i_item_id', original_value='AAAAAAAAAACHBAAA', optimized_value='AAAAAAAAAAEIBAAA')]\nOriginal row 0: {'i_item_id': 'AAAAAAAAAAAABAAA', 'agg1': 39.0, 'agg2': 86.185, 'agg3': 0.0, 'agg4': 21.945}\nOptimized row 0: {'i_item_id': 'AAAAAAAAAAAABAAA', 'agg1': 39.0, 'agg2': 86.185, 'agg3': 0.0, 'agg4': 21.945}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_cd AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), email_promo AS (SELECT p_promo_sk FROM promotion WHERE p_channel_email = 'N'), event_promo AS (SELECT p_promo_sk FROM promotion WHERE p_channel_event = 'N'), branch1 AS (SELECT ss_item_sk, ss_quantity, ss_list_price, ss_coupon_amt, ss_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_cd ON ss_cdemo_sk = cd_demo_sk JOIN email_promo ON ss_promo_sk = p_promo_sk), branch2 AS (SELECT ss_item_sk, ss_quantity, ss_list_price, ss_coupon_amt, ss_sales_price FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_cd ON ss_cdemo_sk = cd_demo_sk JOIN event_promo ON ss_promo_sk = p_promo_sk), combined_sales AS (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2) SELECT i_item_id, AVG(ss_quantity) AS agg1, AVG(ss_list_price) AS agg2, AVG(ss_coupon_amt) AS agg3, AVG(ss_sales_price) AS agg4 FROM combined_sales AS s JOIN item AS i ON s.ss_item_sk = i.i_item_sk GROUP BY i_item_id ORDER BY i_item_id LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q73",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.2515697544335458,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q73",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 1.5722442001496444,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q7",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.5175440623940163,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q4",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 0.045584827621389226,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q73",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.5602219809263156,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q75",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Values list \"d\" does not have a column named \"d_year\"\n\nLINE 1: ...) AS sales_cnt, SUM(sales_amt) AS sales_amt FROM (SELECT d.d_year, i.i_brand_id, i.i_class_id, i.i_category_id, i...\n                                                                    ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q4",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0.04304356951121659,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='customer_first_name', original_value='Adam', optimized_value='Ada'), ValueDifference(row_index=0, column='customer_id', original_value='AAAAAAAABBBHAAAA', optimized_value='AAAAAAAAABGPEAAA'), ValueDifference(row_index=0, column='customer_last_name', original_value='Anderson', optimized_value='Knight'), ValueDifference(row_index=1, column='customer_first_name', original_value='Alta', optimized_value='Adam'), ValueDifference(row_index=1, column='customer_id', original_value='AAAAAAAAAAHCBAAA', optimized_value='AAAAAAAAAEHHBAAA')]\nOriginal row 0: {'customer_id': 'AAAAAAAAAABHDAAA', 'customer_first_name': 'Amanda', 'customer_last_name': 'Funk', 'customer_preferred_cust_flag': 'N'}\nOptimized row 0: {'customer_id': 'AAAAAAAAAAAKFAAA', 'customer_first_name': 'Karen', 'customer_last_name': 'Sanchez', 'customer_preferred_cust_flag': 'Y'}\nYour optimized SQL that failed:\n```sql\nWITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, date_dim WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year), store_year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2001 AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer JOIN store_sales ON c_customer_sk = ss_customer_sk JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE (2001) = 2001 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2002 AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer JOIN store_sales ON c_customer_sk = ss_customer_sk JOIN date_filter ON ss_sold_date_sk = d_date_sk WHERE (2002) = 2002 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address), catalog_year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2001 AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer JOIN catalog_sales ON c_customer_sk = cs_bill_customer_sk JOIN date_filter ON cs_sold_date_sk = d_date_sk WHERE (2001) = 2001 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2002 AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer JOIN catalog_sales ON c_customer_sk = cs_bill_customer_sk JOIN date_filter ON cs_sold_date_sk = d_date_sk WHERE (2002) = 2002 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address), web_year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2001 AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer JOIN web_sales ON c_customer_sk = ws_bill_customer_sk JOIN date_filter ON ws_sold_date_sk = d_date_sk WHERE (2001) = 2001 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, 2002 AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer JOIN web_sales ON c_customer_sk = ws_bill_customer_sk JOIN date_filter ON ws_sold_date_sk = d_date_sk WHERE (2002) = 2002 GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM store_year_total AS t_s_firstyear, store_year_total AS t_s_secyear, catalog_year_total AS t_c_firstyear, catalog_year_total AS t_c_secyear, web_year_total AS t_w_firstyear, web_year_total AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2002 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2002 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2002 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / NULLIF(t_c_firstyear.year_total, 0) ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / NULLIF(t_s_firstyear.year_total, 0) ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / NULLIF(t_c_firstyear.year_total, 0) ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / NULLIF(t_w_firstyear.year_total, 0) ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q75",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 0.6697016667824512,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q4",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.34737294615599495,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q75",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 0.5172452642327805,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q22",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.2591651121417327,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q22",
      "worker_id": 3,
      "examples": [
        "or_to_union",
        "intersect_to_exists"
      ],
      "status": "pass",
      "speedup": 1.0467017558663725,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q22",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "materialize_cte",
        "union_cte_split"
      ],
      "status": "pass",
      "speedup": 1.6852430737427193,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    }
  ]
}