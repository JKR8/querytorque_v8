```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11",
        "main_query": "SELECT i_product_name, i_brand, i_class, i_category, AVG(inv_quantity_on_hand) AS qoh FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk JOIN item ON inv_item_sk = i_item_sk GROUP BY ROLLUP (i_product_name, i_brand, i_class, i_category) ORDER BY qoh NULLS FIRST, i_product_name NULLS FIRST, i_brand NULLS FIRST, i_class NULLS FIRST, i_category NULLS FIRST LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same output columns",
        "same ordering",
        "same rollup grouping"
      ],
      "expected_speedup": "4.00x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filter into separate CTE to reduce join cardinality early. The date filter (d_month_seq BETWEEN 1200 AND 1211) is highly selective (366 rows vs 73,049 in base table). By creating filtered_dates CTE, we join inventory with only relevant dates first, dramatically reducing the intermediate result size before grouping. This follows QT-OPT-003 pattern where filtering dimension tables before fact table joins yields significant speedup."
}
```