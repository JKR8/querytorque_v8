```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "date_filtered": "SELECT d_date_sk FROM date_dim WHERE d_year = 2000",
        "store_sales_filtered": "SELECT ss_store_sk, ss_quantity, ss_cdemo_sk, ss_sales_price, ss_addr_sk, ss_net_profit FROM store_sales",
        "branch1": "SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') JOIN date_filtered d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 0 AND 2000",
        "branch2": "SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') JOIN date_filtered d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 150 AND 3000",
        "branch3": "SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') JOIN date_filtered d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 50 AND 25000",
        "branch4": "SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') JOIN date_filtered d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 0 AND 2000",
        "branch5": "SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') JOIN date_filtered d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 3000",
        "branch6": "SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') JOIN date_filtered d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 50 AND 25000",
        "branch7": "SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') JOIN date_filtered d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 0 AND 2000",
        "branch8": "SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') JOIN date_filtered d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 150 AND 3000",
        "branch9": "SELECT SUM(ss_quantity) AS partial_sum FROM store_sales_filtered ss JOIN store ON s_store_sk = ss_store_sk JOIN customer_demographics cd ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address ca ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') JOIN date_filtered d ON ss_sold_date_sk = d_date_sk WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 25000",
        "main_query": "SELECT SUM(partial_sum) AS \"SUM(ss_quantity)\" FROM (SELECT partial_sum FROM branch1 UNION ALL SELECT partial_sum FROM branch2 UNION ALL SELECT partial_sum FROM branch3 UNION ALL SELECT partial_sum FROM branch4 UNION ALL SELECT partial_sum FROM branch5 UNION ALL SELECT partial_sum FROM branch6 UNION ALL SELECT partial_sum FROM branch7 UNION ALL SELECT partial_sum FROM branch8 UNION ALL SELECT partial_sum FROM branch9) t"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation",
        "same output columns"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "The original query has complex OR conditions spanning customer_demographics and customer_address tables with different value ranges. By transforming OR to UNION ALL, we create 9 separate branches (3x3 combinations) that can be executed independently with efficient hash joins. Each branch has specific filter values, allowing better index usage and reducing the need for complex predicate evaluation during the join phase. The date dimension is also isolated into a CTE to avoid repeated filtering."
}
```