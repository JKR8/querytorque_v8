```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "d1_dates": "SELECT d_date_sk FROM date_dim WHERE d_moy = 9 AND d_year = 1999",
        "d2_dates": "SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 9 AND 12 AND d_year = 1999",
        "d3_dates": "SELECT d_date_sk FROM date_dim WHERE d_year IN (1999, 2000, 2001)",
        "filtered_store_sales": "SELECT ss_customer_sk, ss_item_sk, ss_ticket_number, ss_store_sk, ss_quantity FROM store_sales JOIN d1_dates ON ss_sold_date_sk = d_date_sk",
        "filtered_store_returns": "SELECT sr_customer_sk, sr_item_sk, sr_ticket_number, sr_return_quantity FROM store_returns JOIN d2_dates ON sr_returned_date_sk = d_date_sk",
        "filtered_catalog_sales": "SELECT cs_bill_customer_sk, cs_item_sk, cs_quantity FROM catalog_sales JOIN d3_dates ON cs_sold_date_sk = d_date_sk",
        "main_query": "SELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_quantity) AS store_sales_quantity, SUM(sr_return_quantity) AS store_returns_quantity, SUM(cs_quantity) AS catalog_sales_quantity FROM filtered_store_sales ss JOIN filtered_store_returns sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN filtered_catalog_sales cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk JOIN item i ON ss.ss_item_sk = i.i_item_sk JOIN store s ON ss.ss_store_sk = s.s_store_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same grouping and aggregation"
      ],
      "expected_speedup": "3.0x",
      "risk": "low"
    }
  ],
  "explanation": "Created three CTEs for date_dim filters (d1, d2, d3) and joined fact tables (store_sales, store_returns, catalog_sales) to these CTEs early. This reduces full table scans of large fact tables by applying date filters first, then joining only the filtered rows through the chain of joins. The rewritten query scans each date_dim once and reduces the number of rows from fact tables before complex joins."
}
```