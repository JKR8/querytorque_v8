```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "early_filter",
      "nodes": {
        "filtered_date": "SELECT d_date_sk, d_day_name FROM date_dim WHERE d_year = 2000",
        "filtered_store": "SELECT s_store_sk, s_store_id, s_store_name FROM store WHERE s_gmt_offset = -5",
        "joined_facts": "SELECT s.s_store_name, s.s_store_id, f.d_day_name, ss.ss_sales_price FROM store_sales ss JOIN filtered_date f ON ss.ss_sold_date_sk = f.d_date_sk JOIN filtered_store s ON ss.ss_store_sk = s.s_store_sk",
        "main_query": "SELECT s_store_name, s_store_id, SUM(CASE WHEN (d_day_name = 'Sunday') THEN ss_sales_price ELSE NULL END) AS sun_sales, SUM(CASE WHEN (d_day_name = 'Monday') THEN ss_sales_price ELSE NULL END) AS mon_sales, SUM(CASE WHEN (d_day_name = 'Tuesday') THEN ss_sales_price ELSE NULL END) AS tue_sales, SUM(CASE WHEN (d_day_name = 'Wednesday') THEN ss_sales_price ELSE NULL END) AS wed_sales, SUM(CASE WHEN (d_day_name = 'Thursday') THEN ss_sales_price ELSE NULL END) AS thu_sales, SUM(CASE WHEN (d_day_name = 'Friday') THEN ss_sales_price ELSE NULL END) AS fri_sales, SUM(CASE WHEN (d_day_name = 'Saturday') THEN ss_sales_price ELSE NULL END) AS sat_sales FROM joined_facts GROUP BY s_store_name, s_store_id ORDER BY s_store_name, s_store_id, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (store_name, store_id)",
        "same result rows",
        "same aggregation logic"
      ],
      "expected_speedup": "2.8x",
      "risk": "low"
    }
  ],
  "explanation": "Pushed date_dim filter (d_year=2000) and store filter (s_gmt_offset=-5) EARLY into CTEs before joining with large store_sales fact table. This reduces the store_sales scan from full table (172M rows) to only rows matching filtered dimensions (2.7M rows). The CTE structure enables efficient join order: filter small dimensions first, then join with fact table using only relevant dimension keys."
}
```