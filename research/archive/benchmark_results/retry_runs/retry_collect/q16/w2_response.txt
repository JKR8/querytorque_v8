```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "materialize_cte",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-02-01' AND CAST('2002-04-02' AS DATE)",
        "multi_warehouse_orders": "SELECT DISTINCT cs_order_number FROM catalog_sales GROUP BY cs_order_number HAVING COUNT(DISTINCT cs_warehouse_sk) > 1",
        "returned_orders": "SELECT DISTINCT cr_order_number FROM catalog_returns",
        "main_query": "SELECT COUNT(DISTINCT cs_order_number) AS \"order count\", SUM(cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs_net_profit) AS \"total net profit\" FROM catalog_sales cs1 JOIN filtered_dates ON cs1.cs_ship_date_sk = filtered_dates.d_date_sk JOIN customer_address ON cs1.cs_ship_addr_sk = ca_address_sk JOIN call_center ON cs1.cs_call_center_sk = cc_call_center_sk JOIN multi_warehouse_orders mwo ON cs1.cs_order_number = mwo.cs_order_number LEFT JOIN returned_orders ro ON cs1.cs_order_number = ro.cr_order_number WHERE ca_state = 'GA' AND cc_county = 'Williamson County' AND ro.cr_order_number IS NULL GROUP BY () ORDER BY COUNT(DISTINCT cs_order_number) LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation",
        "same ordering",
        "same column output"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Extracted date filter into CTE to reduce date_dim scans. Materialized EXISTS subquery for multi-warehouse orders as CTE with HAVING COUNT(DISTINCT warehouse) > 1. Materialized NOT EXISTS subquery for returned orders as CTE. Converted correlated subqueries to efficient joins. This eliminates repeated scanning of catalog_sales for EXISTS check and catalog_returns for NOT EXISTS check."
}
```