```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "decorrelate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2002-02-01' AND CAST('2002-04-02' AS DATE)",
        "filtered_addresses": "SELECT ca_address_sk FROM customer_address WHERE ca_state = 'GA'",
        "filtered_call_centers": "SELECT cc_call_center_sk FROM call_center WHERE cc_county = 'Williamson County'",
        "multi_warehouse_orders": "SELECT cs_order_number FROM catalog_sales GROUP BY cs_order_number HAVING COUNT(DISTINCT cs_warehouse_sk) > 1",
        "non_returned_orders": "SELECT cr_order_number FROM catalog_returns",
        "main_query": "SELECT COUNT(DISTINCT cs1.cs_order_number) AS \"order count\", SUM(cs1.cs_ext_ship_cost) AS \"total shipping cost\", SUM(cs1.cs_net_profit) AS \"total net profit\" FROM catalog_sales cs1 JOIN filtered_dates fd ON cs1.cs_ship_date_sk = fd.d_date_sk JOIN filtered_addresses fa ON cs1.cs_ship_addr_sk = fa.ca_address_sk JOIN filtered_call_centers fc ON cs1.cs_call_center_sk = fc.cc_call_center_sk JOIN multi_warehouse_orders mwo ON cs1.cs_order_number = mwo.cs_order_number LEFT JOIN non_returned_orders nro ON cs1.cs_order_number = nro.cr_order_number WHERE nro.cr_order_number IS NULL GROUP BY () ORDER BY COUNT(DISTINCT cs1.cs_order_number) LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation results",
        "same output columns"
      ],
      "expected_speedup": "3.2x",
      "risk": "low"
    }
  ],
  "explanation": "Rewrote correlated EXISTS/NOT EXISTS subqueries into independent CTEs: (1) multi_warehouse_orders identifies orders with multiple warehouses in single scan, (2) non_returned_orders captures all returned orders for left join filter. Pushed dimension table filters (date, address, call_center) into separate CTEs for early reduction. This eliminates repeated subquery execution and reduces catalog_sales scans from 2 to 1."
}
```