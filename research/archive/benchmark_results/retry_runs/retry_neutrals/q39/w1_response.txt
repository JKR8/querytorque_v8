```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "date_filtered": "SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 2001 AND d_moy IN (1, 2)",
        "inv_base": "SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, date_filtered.d_moy, STDDEV_SAMP(inv_quantity_on_hand) * 1.000 AS stdev, AVG(inv_quantity_on_hand) AS mean FROM inventory JOIN date_filtered ON inventory.inv_date_sk = date_filtered.d_date_sk JOIN item ON inventory.inv_item_sk = item.i_item_sk JOIN warehouse ON inventory.inv_warehouse_sk = warehouse.w_warehouse_sk GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, date_filtered.d_moy",
        "inv": "SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM inv_base WHERE CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1",
        "main_query": "SELECT inv1.w_warehouse_sk AS wsk1, inv1.i_item_sk AS isk1, inv1.d_moy AS dmoy1, inv1.mean AS mean1, inv1.cov AS cov1, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM inv AS inv1, inv AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk AND inv1.d_moy = 1 AND inv2.d_moy = 2 ORDER BY inv1.w_warehouse_sk NULLS FIRST, inv1.i_item_sk NULLS FIRST, inv1.d_moy NULLS FIRST, inv1.mean NULLS FIRST, inv1.cov NULLS FIRST, inv2.d_moy NULLS FIRST, inv2.mean NULLS FIRST, inv2.cov NULLS FIRST"
      },
      "invariants_kept": [
        "output columns unchanged",
        "grain preserved",
        "same result rows",
        "required predicates maintained"
      ],
      "expected_speedup": "5.00x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filtering to only months 1 and 2 (2001) before joining with large fact table, reducing aggregation rows by ~6x. This pushes main query's d_moy filters into the CTE early, avoiding full year aggregation."
}
```