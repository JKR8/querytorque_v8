```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_date": "SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 11",
        "filtered_item": "SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1",
        "main_query": "SELECT 2000 AS d_year, i.i_category_id, i.i_category, SUM(ss.ss_ext_sales_price) FROM filtered_date d JOIN store_sales ss ON d.d_date_sk = ss.ss_sold_date_sk JOIN filtered_item i ON ss.ss_item_sk = i.i_item_sk GROUP BY i.i_category_id, i.i_category ORDER BY SUM(ss.ss_ext_sales_price) DESC, d_year, i.i_category_id, i.i_category LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (year/category)",
        "same result rows (11 rows)"
      ],
      "expected_speedup": "3.8x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filter into CTE, reducing scan from 73,049 rows to 30 rows before joining with store_sales (345M rows). Also isolated item filter into CTE, reducing from 102,000 to 1,847 rows. This dramatically reduces the hash join sizes early in the plan. The constant d_year=2000 is extracted for grouping."
}
```