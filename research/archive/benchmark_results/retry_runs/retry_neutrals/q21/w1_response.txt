```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE)",
        "filtered_items": "SELECT i_item_sk, i_item_id FROM item WHERE i_current_price BETWEEN 0.99 AND 1.49",
        "main_query": "SELECT w_warehouse_name, i_item_id, SUM(CASE WHEN CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE) THEN inv_quantity_on_hand ELSE 0 END) AS inv_before, SUM(CASE WHEN CAST(d_date AS DATE) >= CAST('2000-03-11' AS DATE) THEN inv_quantity_on_hand ELSE 0 END) AS inv_after FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk JOIN filtered_items ON inv_item_sk = i_item_sk JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk GROUP BY w_warehouse_name, i_item_id HAVING inv_before > 0 AND (CASE WHEN inv_before > 0 THEN (inv_after * 1.000) / inv_before ELSE NULL END) BETWEEN (2.000/3.000) AND (3.000/2.000) ORDER BY w_warehouse_name NULLS FIRST, i_item_id NULLS FIRST LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same output columns",
        "same grouping grain",
        "same filtering logic"
      ],
      "expected_speedup": "3.5x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim and item filters into CTEs to reduce early join volume. Pushed HAVING clause into main query to filter at aggregation level, eliminating outer wrapper. This reduces the inventory scan from 1.5B rows to only rows matching filtered date range and item price range."
}
```