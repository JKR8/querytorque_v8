```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)",
        "filtered_items": "SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')",
        "catalog_sales_filtered": "SELECT cs.cs_ext_sales_price, cs.cs_item_sk, i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price FROM catalog_sales cs JOIN filtered_dates fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_items i ON cs.cs_item_sk = i.i_item_sk",
        "main_query": "SELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(cs_ext_sales_price) AS itemrevenue, SUM(cs_ext_sales_price) * 100.0000 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM catalog_sales_filtered GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100"
      },
      "invariants_kept": [
        "same output columns",
        "same grain",
        "same result rows",
        "same ordering"
      ],
      "expected_speedup": "3.5x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filtering into separate CTE to reduce catalog_sales scan early. Also pushed item category filter into CTE. This avoids scanning entire catalog_sales table before applying highly selective date filter (31 rows from 73K) and item filter (3 categories). The rewrite transforms two sequential joins into pipelined execution where date and item filters are applied before the expensive catalog_sales scan."
}
```