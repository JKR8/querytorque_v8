{
  "timestamp": "20260206_004710",
  "config": {
    "database": "/mnt/d/TPC-DS/tpcds_sf10.duckdb",
    "queries": [
      "q45",
      "q52",
      "q20",
      "q40",
      "q23",
      "q58",
      "q33",
      "q79",
      "q19",
      "q31",
      "q4",
      "q8",
      "q54",
      "q69",
      "q80",
      "q10",
      "q46",
      "q49",
      "q57",
      "q60",
      "q13",
      "q27",
      "q64",
      "q77",
      "q78",
      "q47",
      "q48",
      "q85",
      "q99",
      "q21",
      "q39",
      "q88",
      "q3",
      "q25",
      "q97",
      "q42",
      "q72",
      "q36",
      "q71",
      "q98",
      "q14",
      "q68",
      "q92"
    ],
    "worker_examples": {
      "1": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "2": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "3": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "4": [
        "single_pass_aggregation",
        "or_to_union",
        "intersect_to_exists",
        "union_cte_split"
      ]
    }
  },
  "summary": {
    "total_queries": 43,
    "improved": 0,
    "fixed": 0,
    "total_time_minutes": 9.63604079882304
  },
  "results": [
    {
      "query_id": "q45",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q45",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001), special_items AS (SELECT i_item_id, i_item_sk FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29))\nSELECT ca_zip, ca_city, SUM(ws_sales_price) FROM (SELECT ca_zip, ca_city, ws_sales_price FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN item ON ws_item_sk = i_item_sk WHERE SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') UNION ALL SELECT ca_zip, ca_city, ws_sales_price FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN special_items ON ws_item_sk = i_item_sk WHERE NOT SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')) AS combined GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100",
          "prompt_tokens": 2983,
          "response_tokens": 683,
          "llm_time_ms": 192204.34999465942
        },
        {
          "worker_id": 2,
          "query_id": "q45",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001), filtered_items AS (SELECT i_item_id, i_item_sk FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)), branch1_sales AS (SELECT ws_bill_customer_sk, ws_item_sk, ws_sales_price FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk), branch1 AS (SELECT ca_zip, ca_city, ws_sales_price FROM branch1_sales AS bs JOIN customer AS c ON bs.ws_bill_customer_sk = c.c_customer_sk JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN item AS i ON bs.ws_item_sk = i.i_item_sk WHERE SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')), branch2 AS (SELECT ca_zip, ca_city, ws_sales_price FROM branch1_sales AS bs JOIN customer AS c ON bs.ws_bill_customer_sk = c.c_customer_sk JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN filtered_items AS fi ON bs.ws_item_sk = fi.i_item_sk), combined AS (SELECT ca_zip, ca_city, SUM(ws_sales_price) FROM (SELECT ca_zip, ca_city, ws_sales_price FROM branch1 UNION ALL SELECT ca_zip, ca_city, ws_sales_price FROM branch2) AS t GROUP BY ca_zip, ca_city HAVING NOT SUM(ws_sales_price) IS NULL ORDER BY ca_zip, ca_city LIMIT 100)\nSELECT ca_zip, ca_city, SUM(ws_sales_price) FROM web_sales, customer, customer_address, date_dim, item WHERE ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND (SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') OR i_item_id IN (SELECT i_item_id FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29))) AND ws_sold_date_sk = d_date_sk AND d_qoy = 2 AND d_year = 2001 GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100",
          "prompt_tokens": 2963,
          "response_tokens": 493,
          "llm_time_ms": 202507.42745399475
        },
        {
          "worker_id": 1,
          "query_id": "q45",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001), filtered_web_sales AS (SELECT ws.ws_sales_price, ws.ws_bill_customer_sk, ws.ws_item_sk FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk)\nSELECT ca_zip, ca_city, SUM(ws_sales_price) FROM web_sales, customer, customer_address, date_dim, item WHERE ws_bill_customer_sk = c_customer_sk AND c_current_addr_sk = ca_address_sk AND ws_item_sk = i_item_sk AND (SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') OR i_item_id IN (SELECT i_item_id FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29))) AND ws_sold_date_sk = d_date_sk AND d_qoy = 2 AND d_year = 2001 GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100",
          "prompt_tokens": 2816,
          "response_tokens": 568,
          "llm_time_ms": 214405.6010246277
        },
        {
          "worker_id": 4,
          "query_id": "q45",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001), zip_branch AS (SELECT ws_sales_price, ca_zip, ca_city FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN item ON ws_item_sk = i_item_sk WHERE SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')), item_branch AS (SELECT ws_sales_price, ca_zip, ca_city FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN item ON ws_item_sk = i_item_sk WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29))\nSELECT ca_zip, ca_city, SUM(ws_sales_price) FROM (SELECT ws_sales_price, ca_zip, ca_city FROM zip_branch UNION ALL SELECT ws_sales_price, ca_zip, ca_city FROM item_branch) AS combined GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100",
          "prompt_tokens": 4035,
          "response_tokens": 712,
          "llm_time_ms": 257759.18817520142
        }
      ],
      "original_speedup": 1.08,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061819"
    },
    {
      "query_id": "q52",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q52",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000 AND d_moy = 11), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 1)\nSELECT dt.d_year, item.i_brand_id AS brand_id, item.i_brand AS brand, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_dates AS dt ON dt.d_date_sk = store_sales.ss_sold_date_sk JOIN filtered_items AS item ON store_sales.ss_item_sk = item.i_item_sk GROUP BY dt.d_year, item.i_brand, item.i_brand_id ORDER BY dt.d_year, ext_price DESC, brand_id LIMIT 100",
          "prompt_tokens": 2722,
          "response_tokens": 353,
          "llm_time_ms": 98755.07712364197
        },
        {
          "worker_id": 4,
          "query_id": "q52",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11 AND d_year = 2000), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 1)\nSELECT dt.d_year, item.i_brand_id AS brand_id, item.i_brand AS brand, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_dates AS dt ON store_sales.ss_sold_date_sk = dt.d_date_sk JOIN filtered_items AS item ON store_sales.ss_item_sk = item.i_item_sk GROUP BY dt.d_year, item.i_brand, item.i_brand_id ORDER BY dt.d_year, ext_price DESC, brand_id LIMIT 100",
          "prompt_tokens": 3774,
          "response_tokens": 579,
          "llm_time_ms": 126924.97968673706
        },
        {
          "worker_id": 2,
          "query_id": "q52",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11 AND d_year = 2000), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 1), joined_facts AS (SELECT ss_ext_sales_price, fd.d_year, fi.i_brand_id, fi.i_brand FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items AS fi ON ss.ss_item_sk = fi.i_item_sk)\nSELECT d_year, i_brand_id AS brand_id, i_brand AS brand, SUM(ss_ext_sales_price) AS ext_price FROM joined_facts GROUP BY d_year, i_brand, i_brand_id ORDER BY d_year, ext_price DESC, brand_id LIMIT 100",
          "prompt_tokens": 2705,
          "response_tokens": 344,
          "llm_time_ms": 125748.03161621094
        },
        {
          "worker_id": 1,
          "query_id": "q52",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000 AND d_moy = 11), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 1)\nSELECT fd.d_year, fi.i_brand_id AS brand_id, fi.i_brand AS brand, SUM(ss_ext_sales_price) AS ext_price FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items AS fi ON ss.ss_item_sk = fi.i_item_sk GROUP BY fd.d_year, fi.i_brand_id, fi.i_brand ORDER BY fd.d_year, ext_price DESC, brand_id LIMIT 100",
          "prompt_tokens": 2558,
          "response_tokens": 310,
          "llm_time_ms": 137166.80145263672
        }
      ],
      "original_speedup": 1.08,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061842"
    },
    {
      "query_id": "q20",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q20",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE))\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(cs_ext_sales_price) AS itemrevenue, SUM(cs_ext_sales_price) * 100.0000 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk WHERE i_category IN ('Sports', 'Books', 'Home') GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100",
          "prompt_tokens": 3909,
          "response_tokens": 380,
          "llm_time_ms": 153719.4480895996
        },
        {
          "worker_id": 2,
          "query_id": "q20",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), joined_data AS (SELECT fi.i_item_id, fi.i_item_desc, fi.i_category, fi.i_class, fi.i_current_price, cs.cs_ext_sales_price FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_items AS fi ON cs.cs_item_sk = fi.i_item_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(cs_ext_sales_price) AS itemrevenue, SUM(cs_ext_sales_price) * 100.0000 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM joined_data GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100",
          "prompt_tokens": 2845,
          "response_tokens": 451,
          "llm_time_ms": 165487.3707294464
        },
        {
          "worker_id": 1,
          "query_id": "q20",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), catalog_sales_filtered AS (SELECT cs.cs_ext_sales_price, cs.cs_item_sk, i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_items AS i ON cs.cs_item_sk = i.i_item_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(cs_ext_sales_price) AS itemrevenue, SUM(cs_ext_sales_price) * 100.0000 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM catalog_sales_filtered GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100",
          "prompt_tokens": 2693,
          "response_tokens": 460,
          "llm_time_ms": 188335.1058959961
        },
        {
          "worker_id": 3,
          "query_id": "q20",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home'))\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(cs_ext_sales_price) AS itemrevenue, SUM(cs_ext_sales_price) * 100.0000 / SUM(SUM(cs_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_items ON cs_item_sk = i_item_sk GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST LIMIT 100",
          "prompt_tokens": 2862,
          "response_tokens": 381,
          "llm_time_ms": 188531.7587852478
        }
      ],
      "original_speedup": 1.07,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061847"
    },
    {
      "query_id": "q40",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q40",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE))\nSELECT w_state, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2000-03-11' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_order_number = cr_order_number AND cs_item_sk = cr_item_sk) INNER JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk INNER JOIN item ON i_item_sk = cs_item_sk INNER JOIN filtered_dates ON cs_sold_date_sk = d_date_sk WHERE i_current_price BETWEEN 0.99 AND 1.49 GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100",
          "prompt_tokens": 2921,
          "response_tokens": 407,
          "llm_time_ms": 143048.5589504242
        },
        {
          "worker_id": 1,
          "query_id": "q40",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_current_price BETWEEN 0.99 AND 1.49)\nSELECT w.w_state, fi.i_item_id, SUM(CASE WHEN (CAST(fd.d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN cs.cs_sales_price - COALESCE(cr.cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(fd.d_date AS DATE) >= CAST('2000-03-11' AS DATE)) THEN cs.cs_sales_price - COALESCE(cr.cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales AS cs LEFT OUTER JOIN catalog_returns AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) INNER JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk INNER JOIN filtered_items AS fi ON cs.cs_item_sk = fi.i_item_sk INNER JOIN warehouse AS w ON cs.cs_warehouse_sk = w.w_warehouse_sk GROUP BY w.w_state, fi.i_item_id ORDER BY w.w_state, fi.i_item_id LIMIT 100",
          "prompt_tokens": 2752,
          "response_tokens": 410,
          "llm_time_ms": 163096.9042778015
        },
        {
          "worker_id": 2,
          "query_id": "q40",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_current_price BETWEEN 0.99 AND 1.49), filtered_catalog_sales AS (SELECT cs_order_number, cs_item_sk, cs_warehouse_sk, cs_sales_price, d_date FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk), filtered_sales_with_items AS (SELECT fcs.*, fi.i_item_id FROM filtered_catalog_sales AS fcs JOIN filtered_items AS fi ON fcs.cs_item_sk = fi.i_item_sk), sales_with_warehouse AS (SELECT fsi.cs_order_number, fsi.cs_item_sk, fsi.cs_sales_price, fsi.d_date, fsi.i_item_id, w.w_state FROM filtered_sales_with_items AS fsi JOIN warehouse AS w ON fsi.cs_warehouse_sk = w.w_warehouse_sk)\nSELECT sw.w_state, sw.i_item_id, SUM(CASE WHEN (CAST(sw.d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN sw.cs_sales_price - COALESCE(cr.cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(sw.d_date AS DATE) >= CAST('2000-03-11' AS DATE)) THEN sw.cs_sales_price - COALESCE(cr.cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM sales_with_warehouse AS sw LEFT OUTER JOIN catalog_returns AS cr ON sw.cs_order_number = cr.cr_order_number AND sw.cs_item_sk = cr.cr_item_sk GROUP BY sw.w_state, sw.i_item_id ORDER BY sw.w_state, sw.i_item_id LIMIT 100",
          "prompt_tokens": 2900,
          "response_tokens": 596,
          "llm_time_ms": 187022.19986915588
        },
        {
          "worker_id": 4,
          "query_id": "q40",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date_dim AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE)), filtered_item AS (SELECT i_item_sk, i_item_id FROM item WHERE i_current_price BETWEEN 0.99 AND 1.49), filtered_sales AS (SELECT cs_order_number, cs_item_sk, cs_sales_price, cs_warehouse_sk, cs_sold_date_sk FROM catalog_sales), sales_with_returns AS (SELECT fs.cs_order_number, fs.cs_item_sk, fs.cs_sales_price, fs.cs_warehouse_sk, fs.cs_sold_date_sk, cr.cr_refunded_cash FROM filtered_sales AS fs LEFT OUTER JOIN catalog_returns AS cr ON (fs.cs_order_number = cr.cr_order_number AND fs.cs_item_sk = cr.cr_item_sk)), joined_data AS (SELECT w.w_state, i.i_item_id, fd.d_date, swr.cs_sales_price, swr.cr_refunded_cash FROM sales_with_returns AS swr JOIN filtered_date_dim AS fd ON swr.cs_sold_date_sk = fd.d_date_sk JOIN filtered_item AS i ON swr.cs_item_sk = i.i_item_sk JOIN warehouse AS w ON swr.cs_warehouse_sk = w.w_warehouse_sk)\nSELECT w_state, i_item_id, SUM(CASE WHEN (d_date < CAST('2000-03-11' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (d_date >= CAST('2000-03-11' AS DATE)) THEN cs_sales_price - COALESCE(cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM joined_data GROUP BY w_state, i_item_id ORDER BY w_state, i_item_id LIMIT 100",
          "prompt_tokens": 3969,
          "response_tokens": 560,
          "llm_time_ms": 214868.9799308777
        }
      ],
      "original_speedup": 1.07,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061852"
    },
    {
      "query_id": "q23",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q23",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_month_2000_2 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 2), date_range_years AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2000, 2001, 2002, 2003)), filtered_frequent_items AS (SELECT i_item_sk, SUBSTRING(i_item_desc, 1, 30) AS itemdesc, d_date, COUNT(*) AS cnt FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN date_range_years ON ss_sold_date_sk = d_date_sk GROUP BY i_item_sk, itemdesc, d_date HAVING COUNT(*) > 4), max_csales AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM store_sales JOIN customer ON ss_customer_sk = c_customer_sk JOIN date_range_years ON ss_sold_date_sk = d_date_sk GROUP BY c_customer_sk), tpcds_cmax AS (SELECT MAX(csales) AS tpcds_cmax FROM max_csales), best_customers AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM store_sales JOIN customer ON ss_customer_sk = c_customer_sk GROUP BY c_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (50 / 100.0) * (SELECT tpcds_cmax FROM tpcds_cmax)), catalog_sales_month AS (SELECT cs_bill_customer_sk, cs_item_sk, cs_quantity * cs_list_price AS sales FROM catalog_sales JOIN date_month_2000_2 ON cs_sold_date_sk = d_date_sk), web_sales_month AS (SELECT ws_bill_customer_sk, ws_item_sk, ws_quantity * ws_list_price AS sales FROM web_sales JOIN date_month_2000_2 ON ws_sold_date_sk = d_date_sk), frequent_ss_items AS (SELECT itemdesc, i_item_sk AS item_sk, d_date AS solddate, COUNT(*) AS cnt FROM store_sales, date_dim, (SELECT SUBSTRING(i_item_desc, 1, 30) AS itemdesc, * FROM item) AS sq1 WHERE ss_sold_date_sk = d_date_sk AND ss_item_sk = i_item_sk AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3) GROUP BY itemdesc, i_item_sk, d_date HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM store_sales, customer, date_dim WHERE ss_customer_sk = c_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3) GROUP BY c_customer_sk) AS sq2), best_ss_customer AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM store_sales, customer, max_store_sales WHERE ss_customer_sk = c_customer_sk GROUP BY c_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (50 / 100.0) * MAX(tpcds_cmax))\nSELECT c_last_name, c_first_name, SUM(sales) AS sales FROM (SELECT c_last_name, c_first_name, sales FROM catalog_sales_month AS cs JOIN customer ON cs.cs_bill_customer_sk = customer.c_customer_sk JOIN filtered_frequent_items AS fi ON cs.cs_item_sk = fi.i_item_sk JOIN best_customers AS bc ON cs.cs_bill_customer_sk = bc.c_customer_sk UNION ALL SELECT c_last_name, c_first_name, sales FROM web_sales_month AS ws JOIN customer ON ws.ws_bill_customer_sk = customer.c_customer_sk JOIN filtered_frequent_items AS fi ON ws.ws_item_sk = fi.i_item_sk JOIN best_customers AS bc ON ws.ws_bill_customer_sk = bc.c_customer_sk) AS sq GROUP BY c_last_name, c_first_name ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, sales NULLS FIRST LIMIT 100",
          "prompt_tokens": 3800,
          "response_tokens": 748,
          "llm_time_ms": 140948.28248023987
        },
        {
          "worker_id": 3,
          "query_id": "q23",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_years AS (SELECT d_date_sk, d_date, d_year FROM date_dim WHERE d_year IN (2000, 2001, 2002, 2003)), date_feb2000 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 2), frequent_ss_items AS (SELECT itemdesc, i_item_sk AS item_sk, d_date AS solddate, COUNT(*) AS cnt FROM store_sales JOIN date_years ON ss_sold_date_sk = d_date_sk JOIN (SELECT SUBSTRING(i_item_desc, 1, 30) AS itemdesc, * FROM item) AS sq1 ON ss_item_sk = i_item_sk GROUP BY itemdesc, i_item_sk, d_date HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM store_sales JOIN date_years ON ss_sold_date_sk = d_date_sk JOIN customer ON ss_customer_sk = c_customer_sk GROUP BY c_customer_sk) AS sq2), best_ss_customer AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM store_sales, customer, max_store_sales WHERE ss_customer_sk = c_customer_sk GROUP BY c_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (50 / 100.0) * MAX(tpcds_cmax))\nSELECT c_last_name, c_first_name, sales FROM (SELECT c_last_name, c_first_name, SUM(cs_quantity * cs_list_price) AS sales FROM catalog_sales, customer, date_dim, frequent_ss_items, best_ss_customer WHERE d_year = 2000 AND d_moy = 2 AND cs_sold_date_sk = d_date_sk AND cs_item_sk = item_sk AND cs_bill_customer_sk = best_ss_customer.c_customer_sk AND cs_bill_customer_sk = customer.c_customer_sk GROUP BY c_last_name, c_first_name UNION ALL SELECT c_last_name, c_first_name, SUM(ws_quantity * ws_list_price) AS sales FROM web_sales, customer, date_dim, frequent_ss_items, best_ss_customer WHERE d_year = 2000 AND d_moy = 2 AND ws_sold_date_sk = d_date_sk AND ws_item_sk = item_sk AND ws_bill_customer_sk = best_ss_customer.c_customer_sk AND ws_bill_customer_sk = customer.c_customer_sk GROUP BY c_last_name, c_first_name) AS sq3 ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, sales NULLS FIRST LIMIT 100",
          "prompt_tokens": 3817,
          "response_tokens": 1156,
          "llm_time_ms": 194126.26266479492
        },
        {
          "worker_id": 1,
          "query_id": "q23",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_years AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year IN (2000, 2001, 2002, 2003)), date_month AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_year = 2000 AND d_moy = 2), frequent_ss_items AS (SELECT itemdesc, i_item_sk AS item_sk, d_date AS solddate, COUNT(*) AS cnt FROM store_sales, date_years, (SELECT SUBSTRING(i_item_desc, 1, 30) AS itemdesc, * FROM item) AS sq1 WHERE ss_sold_date_sk = d_date_sk AND ss_item_sk = i_item_sk GROUP BY itemdesc, i_item_sk, d_date HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM store_sales, customer, date_years WHERE ss_customer_sk = c_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_sk) AS sq2), best_ss_customer AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM store_sales, customer, max_store_sales WHERE ss_customer_sk = c_customer_sk GROUP BY c_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (50 / 100.0) * MAX(tpcds_cmax))\nSELECT c_last_name, c_first_name, sales FROM (SELECT c_last_name, c_first_name, SUM(cs_quantity * cs_list_price) AS sales FROM catalog_sales, customer, date_month, frequent_ss_items, best_ss_customer WHERE cs_sold_date_sk = d_date_sk AND cs_item_sk = item_sk AND cs_bill_customer_sk = best_ss_customer.c_customer_sk AND cs_bill_customer_sk = customer.c_customer_sk GROUP BY c_last_name, c_first_name UNION ALL SELECT c_last_name, c_first_name, SUM(ws_quantity * ws_list_price) AS sales FROM web_sales, customer, date_month, frequent_ss_items, best_ss_customer WHERE ws_sold_date_sk = d_date_sk AND ws_item_sk = item_sk AND ws_bill_customer_sk = best_ss_customer.c_customer_sk AND ws_bill_customer_sk = customer.c_customer_sk GROUP BY c_last_name, c_first_name) AS sq3 ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, sales NULLS FIRST LIMIT 100",
          "prompt_tokens": 3657,
          "response_tokens": 1299,
          "llm_time_ms": 196073.02355766296
        },
        {
          "worker_id": 4,
          "query_id": "q23",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter_2000_2003 AS (SELECT d_date_sk, d_date, d_year FROM date_dim WHERE d_year BETWEEN 2000 AND 2003), date_filter_2000_02 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 2), frequent_ss_items_rewrite AS (SELECT SUBSTRING(i_item_desc, 1, 30) AS itemdesc, i_item_sk AS item_sk, d_date AS solddate, COUNT(*) AS cnt FROM store_sales JOIN date_filter_2000_2003 ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk GROUP BY i_item_desc, i_item_sk, d_date HAVING COUNT(*) > 4), frequent_ss_items AS (SELECT itemdesc, i_item_sk AS item_sk, d_date AS solddate, COUNT(*) AS cnt FROM store_sales, date_dim, (SELECT SUBSTRING(i_item_desc, 1, 30) AS itemdesc, * FROM item) AS sq1 WHERE ss_sold_date_sk = d_date_sk AND ss_item_sk = i_item_sk AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3) GROUP BY itemdesc, i_item_sk, d_date HAVING COUNT(*) > 4), max_store_sales AS (SELECT MAX(csales) AS tpcds_cmax FROM (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS csales FROM store_sales, customer, date_dim WHERE ss_customer_sk = c_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year IN (2000, 2000 + 1, 2000 + 2, 2000 + 3) GROUP BY c_customer_sk) AS sq2), best_ss_customer AS (SELECT c_customer_sk, SUM(ss_quantity * ss_sales_price) AS ssales FROM store_sales, customer, max_store_sales WHERE ss_customer_sk = c_customer_sk GROUP BY c_customer_sk HAVING SUM(ss_quantity * ss_sales_price) > (50 / 100.0) * MAX(tpcds_cmax))\nSELECT c_last_name, c_first_name, sales FROM (SELECT c_last_name, c_first_name, SUM(cs_quantity * cs_list_price) AS sales FROM catalog_sales, customer, date_dim, frequent_ss_items, best_ss_customer WHERE d_year = 2000 AND d_moy = 2 AND cs_sold_date_sk = d_date_sk AND cs_item_sk = item_sk AND cs_bill_customer_sk = best_ss_customer.c_customer_sk AND cs_bill_customer_sk = customer.c_customer_sk GROUP BY c_last_name, c_first_name UNION ALL SELECT c_last_name, c_first_name, SUM(ws_quantity * ws_list_price) AS sales FROM web_sales, customer, date_dim, frequent_ss_items, best_ss_customer WHERE d_year = 2000 AND d_moy = 2 AND ws_sold_date_sk = d_date_sk AND ws_item_sk = item_sk AND ws_bill_customer_sk = best_ss_customer.c_customer_sk AND ws_bill_customer_sk = customer.c_customer_sk GROUP BY c_last_name, c_first_name) AS sq3 ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, sales NULLS FIRST LIMIT 100",
          "prompt_tokens": 4873,
          "response_tokens": 1264,
          "llm_time_ms": 218136.72351837158
        }
      ],
      "original_speedup": 1.06,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061855"
    },
    {
      "query_id": "q58",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q58",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH target_week AS (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03'), filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM target_week)), ss_items AS (SELECT i_item_id AS item_id, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk GROUP BY i_item_id), ws_items AS (SELECT i_item_id AS item_id, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales JOIN item ON ws_item_sk = i_item_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk GROUP BY i_item_id), cs_items AS (SELECT i_item_id AS item_id, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales, item, date_dim WHERE cs_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')) AND cs_sold_date_sk = d_date_sk GROUP BY i_item_id)\nSELECT ss_items.item_id, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY ss_items.item_id NULLS FIRST, ss_item_rev NULLS FIRST LIMIT 100",
          "prompt_tokens": 3573,
          "response_tokens": 845,
          "llm_time_ms": 143519.6168422699
        },
        {
          "worker_id": 1,
          "query_id": "q58",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH week_dates AS (SELECT d_date_sk FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')), ss_items AS (SELECT i_item_id AS item_id, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN week_dates ON store_sales.ss_sold_date_sk = week_dates.d_date_sk GROUP BY i_item_id), ws_items AS (SELECT i_item_id AS item_id, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales JOIN item ON ws_item_sk = i_item_sk JOIN week_dates ON web_sales.ws_sold_date_sk = week_dates.d_date_sk GROUP BY i_item_id), cs_items AS (SELECT i_item_id AS item_id, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales JOIN item ON cs_item_sk = i_item_sk JOIN week_dates ON catalog_sales.cs_sold_date_sk = week_dates.d_date_sk GROUP BY i_item_id)\nSELECT ss_items.item_id, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY ss_items.item_id NULLS FIRST, ss_item_rev NULLS FIRST LIMIT 100",
          "prompt_tokens": 3426,
          "response_tokens": 664,
          "llm_time_ms": 143908.28251838684
        },
        {
          "worker_id": 4,
          "query_id": "q58",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH week_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')), ss_items AS (SELECT i_item_id AS item_id, SUM(ss_ext_sales_price) AS ss_item_rev FROM store_sales JOIN item ON ss_item_sk = i_item_sk JOIN week_dates ON ss_sold_date_sk = week_dates.d_date_sk GROUP BY i_item_id), ws_items AS (SELECT i_item_id AS item_id, SUM(ws_ext_sales_price) AS ws_item_rev FROM web_sales JOIN item ON ws_item_sk = i_item_sk JOIN week_dates ON ws_sold_date_sk = week_dates.d_date_sk GROUP BY i_item_id), cs_items AS (SELECT i_item_id AS item_id, SUM(cs_ext_sales_price) AS cs_item_rev FROM catalog_sales, item, date_dim WHERE cs_item_sk = i_item_sk AND d_date IN (SELECT d_date FROM date_dim WHERE d_week_seq = (SELECT d_week_seq FROM date_dim WHERE d_date = '2000-01-03')) AND cs_sold_date_sk = d_date_sk GROUP BY i_item_id)\nSELECT ss_items.item_id, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM ss_items, cs_items, ws_items WHERE ss_items.item_id = cs_items.item_id AND ss_items.item_id = ws_items.item_id AND ss_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev AND ss_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND cs_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND cs_item_rev BETWEEN 0.9 * ws_item_rev AND 1.1 * ws_item_rev AND ws_item_rev BETWEEN 0.9 * ss_item_rev AND 1.1 * ss_item_rev AND ws_item_rev BETWEEN 0.9 * cs_item_rev AND 1.1 * cs_item_rev ORDER BY ss_items.item_id NULLS FIRST, ss_item_rev NULLS FIRST LIMIT 100",
          "prompt_tokens": 4643,
          "response_tokens": 640,
          "llm_time_ms": 172377.45141983032
        },
        {
          "worker_id": 3,
          "query_id": "q58",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_items AS (SELECT s.item_id, s.ss_item_rev, c.cs_item_rev, w.ws_item_rev FROM ss_items AS s JOIN cs_items AS c ON s.item_id = c.item_id JOIN ws_items AS w ON s.item_id = w.item_id WHERE s.ss_item_rev BETWEEN 0.9 * c.cs_item_rev AND 1.1 * c.cs_item_rev AND s.ss_item_rev BETWEEN 0.9 * w.ws_item_rev AND 1.1 * w.ws_item_rev AND c.cs_item_rev BETWEEN 0.9 * s.ss_item_rev AND 1.1 * s.ss_item_rev AND c.cs_item_rev BETWEEN 0.9 * w.ws_item_rev AND 1.1 * w.ws_item_rev AND w.ws_item_rev BETWEEN 0.9 * s.ss_item_rev AND 1.1 * s.ss_item_rev AND w.ws_item_rev BETWEEN 0.9 * c.cs_item_rev AND 1.1 * c.cs_item_rev) SELECT item_id, ss_item_rev, ss_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ss_dev, cs_item_rev, cs_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS cs_dev, ws_item_rev, ws_item_rev / ((ss_item_rev + cs_item_rev + ws_item_rev) / 3) * 100 AS ws_dev, (ss_item_rev + cs_item_rev + ws_item_rev) / 3 AS average FROM filtered_items ORDER BY item_id NULLS FIRST, ss_item_rev NULLS FIRST LIMIT 100",
          "prompt_tokens": 3590,
          "response_tokens": 1193,
          "llm_time_ms": 240170.50528526306
        }
      ],
      "original_speedup": 1.06,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061860"
    },
    {
      "query_id": "q33",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q33",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH electronics_manufacturers AS (SELECT DISTINCT i_manufact_id FROM item WHERE i_category IN ('Electronics')), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), ss AS (SELECT ei.i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN electronics_manufacturers AS em ON ss.ss_item_sk = (SELECT i_item_sk FROM item AS i WHERE i.i_manufact_id = em.i_manufact_id AND i.i_category IN ('Electronics') LIMIT 1) JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_address AS fa ON ss.ss_addr_sk = fa.ca_address_sk GROUP BY ei.i_manufact_id), ws AS (SELECT ei.i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN electronics_manufacturers AS em ON ws.ws_item_sk = (SELECT i_item_sk FROM item AS i WHERE i.i_manufact_id = em.i_manufact_id AND i.i_category IN ('Electronics') LIMIT 1) JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_address AS fa ON ws.ws_bill_addr_sk = fa.ca_address_sk GROUP BY ei.i_manufact_id), cs AS (SELECT ei.i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales AS cs JOIN electronics_manufacturers AS em ON cs.cs_item_sk = (SELECT i_item_sk FROM item AS i WHERE i.i_manufact_id = em.i_manufact_id AND i.i_category IN ('Electronics') LIMIT 1) JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_address AS fa ON cs.cs_bill_addr_sk = fa.ca_address_sk GROUP BY ei.i_manufact_id)\nSELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM ws UNION ALL SELECT * FROM cs) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100",
          "prompt_tokens": 3523,
          "response_tokens": 615,
          "llm_time_ms": 114703.74894142151
        },
        {
          "worker_id": 3,
          "query_id": "q33",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), electronics_items AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Electronics')), ss AS (SELECT i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_addresses ON ss_addr_sk = ca_address_sk JOIN electronics_items ON ss_item_sk = i_item_sk GROUP BY i_manufact_id), ws AS (SELECT i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_addresses ON ws_bill_addr_sk = ca_address_sk JOIN electronics_items ON ws_item_sk = i_item_sk GROUP BY i_manufact_id), cs AS (SELECT i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_addresses ON cs_bill_addr_sk = ca_address_sk JOIN electronics_items ON cs_item_sk = i_item_sk GROUP BY i_manufact_id)\nSELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100",
          "prompt_tokens": 3540,
          "response_tokens": 580,
          "llm_time_ms": 133978.6069393158
        },
        {
          "worker_id": 4,
          "query_id": "q33",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), electronics_items AS (SELECT i_manufact_id, i_item_sk FROM item WHERE i_category IN ('Electronics')), ss_rewritten AS (SELECT i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_addresses ON ss_addr_sk = ca_address_sk JOIN electronics_items ON ss_item_sk = i_item_sk GROUP BY i_manufact_id), ws_rewritten AS (SELECT i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_addresses ON ws_bill_addr_sk = ca_address_sk JOIN electronics_items ON ws_item_sk = i_item_sk GROUP BY i_manufact_id), cs_rewritten AS (SELECT i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_addresses ON cs_bill_addr_sk = ca_address_sk JOIN electronics_items ON cs_item_sk = i_item_sk GROUP BY i_manufact_id), ss AS (SELECT i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), cs AS (SELECT i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id), ws AS (SELECT i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales, date_dim, customer_address, item WHERE i_manufact_id IN (SELECT i_manufact_id FROM item WHERE i_category IN ('Electronics')) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 5 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_manufact_id)\nSELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100",
          "prompt_tokens": 4593,
          "response_tokens": 817,
          "llm_time_ms": 133511.1346244812
        },
        {
          "worker_id": 1,
          "query_id": "q33",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), electronics_manufacturers AS (SELECT DISTINCT i_manufact_id FROM item WHERE i_category IN ('Electronics')), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), ss AS (SELECT i.i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_addresses ON ss_addr_sk = ca_address_sk JOIN item AS i ON ss_item_sk = i_item_sk JOIN electronics_manufacturers AS em ON i.i_manufact_id = em.i_manufact_id GROUP BY i.i_manufact_id), ws AS (SELECT i.i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_addresses ON ws_bill_addr_sk = ca_address_sk JOIN item AS i ON ws_item_sk = i_item_sk JOIN electronics_manufacturers AS em ON i.i_manufact_id = em.i_manufact_id GROUP BY i.i_manufact_id), cs AS (SELECT i.i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_addresses ON cs_bill_addr_sk = ca_address_sk JOIN item AS i ON cs_item_sk = i_item_sk JOIN electronics_manufacturers AS em ON i.i_manufact_id = em.i_manufact_id GROUP BY i.i_manufact_id)\nSELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100",
          "prompt_tokens": 3380,
          "response_tokens": 740,
          "llm_time_ms": 138719.562292099
        }
      ],
      "original_speedup": 1.05,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061863"
    },
    {
      "query_id": "q79",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q79",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow = 1 AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk, s_city, s_number_employees FROM store WHERE s_number_employees BETWEEN 200 AND 295), branch_hd_dep_count AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_dep_count = 6 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city), branch_hd_vehicle_count AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_vehicle_count > 2 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city)\nSELECT c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number, amt, profit FROM (SELECT * FROM branch_hd_dep_count UNION ALL SELECT * FROM branch_hd_vehicle_count) AS ms, customer WHERE ss_customer_sk = c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, SUBSTRING(s_city, 1, 30) NULLS FIRST, profit NULLS FIRST, ss_ticket_number LIMIT 100",
          "prompt_tokens": 2988,
          "response_tokens": 945,
          "llm_time_ms": 209739.74514007568
        },
        {
          "worker_id": 1,
          "query_id": "q79",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_dow = 1 AND d_year IN (1999, 2000, 2001)), store_filtered AS (SELECT s_store_sk, s_city FROM store WHERE s_number_employees BETWEEN 200 AND 295), hd_branch1 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 6), hd_branch2 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_vehicle_count > 2 AND hd_dep_count <> 6), branch1_data AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, sf.s_city, ss_coupon_amt, ss_net_profit FROM store_sales AS ss JOIN date_filtered AS df ON ss.ss_sold_date_sk = df.d_date_sk JOIN store_filtered AS sf ON ss.ss_store_sk = sf.s_store_sk JOIN hd_branch1 AS hd1 ON ss.ss_hdemo_sk = hd1.hd_demo_sk), branch2_data AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, sf.s_city, ss_coupon_amt, ss_net_profit FROM store_sales AS ss JOIN date_filtered AS df ON ss.ss_sold_date_sk = df.d_date_sk JOIN store_filtered AS sf ON ss.ss_store_sk = sf.s_store_sk JOIN hd_branch2 AS hd2 ON ss.ss_hdemo_sk = hd2.hd_demo_sk), ms AS (SELECT ss_ticket_number, ss_customer_sk, s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM (SELECT * FROM branch1_data UNION ALL SELECT * FROM branch2_data) AS union_data GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city)\nSELECT c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number, amt, profit FROM ms JOIN customer ON ms.ss_customer_sk = customer.c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, SUBSTRING(s_city, 1, 30) NULLS FIRST, profit NULLS FIRST, ss_ticket_number LIMIT 100",
          "prompt_tokens": 2825,
          "response_tokens": 1014,
          "llm_time_ms": 217378.76415252686
        },
        {
          "worker_id": 2,
          "query_id": "q79",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow = 1 AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk, s_city FROM store WHERE s_number_employees BETWEEN 200 AND 295), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 6 OR hd_vehicle_count > 2), store_sales_summary AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, fs.s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_store AS fs ON ss.ss_store_sk = fs.s_store_sk JOIN filtered_hd AS fhd ON ss.ss_hdemo_sk = fhd.hd_demo_sk GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, fs.s_city)\nSELECT c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number, amt, profit FROM store_sales_summary AS ms JOIN customer ON ms.ss_customer_sk = c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, SUBSTRING(s_city, 1, 30) NULLS FIRST, profit NULLS FIRST, ss_ticket_number LIMIT 100",
          "prompt_tokens": 2975,
          "response_tokens": 531,
          "llm_time_ms": 230288.58590126038
        },
        {
          "worker_id": 4,
          "query_id": "q79",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow = 1 AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk, s_city FROM store WHERE s_number_employees BETWEEN 200 AND 295), split_branch_1 AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, filtered_store.s_city, ss_coupon_amt, ss_net_profit FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_store ON store_sales.ss_store_sk = filtered_store.s_store_sk JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk WHERE household_demographics.hd_dep_count = 6), split_branch_2 AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, filtered_store.s_city, ss_coupon_amt, ss_net_profit FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_store ON store_sales.ss_store_sk = filtered_store.s_store_sk JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk WHERE household_demographics.hd_vehicle_count > 2 AND household_demographics.hd_dep_count <> 6)\nSELECT c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM (SELECT * FROM split_branch_1 UNION ALL SELECT * FROM split_branch_2) AS combined_sales, customer WHERE ss_customer_sk = c_customer_sk GROUP BY c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, SUBSTRING(s_city, 1, 30) NULLS FIRST, profit NULLS FIRST, ss_ticket_number LIMIT 100",
          "prompt_tokens": 4043,
          "response_tokens": 616,
          "llm_time_ms": 380540.488243103
        }
      ],
      "original_speedup": 1.05,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061867"
    },
    {
      "query_id": "q19",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q19",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1998), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_manager_id = 8), filtered_stores AS (SELECT s_store_sk, s_zip FROM store)\nSELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN filtered_stores ON ss_store_sk = s_store_sk AND SUBSTRING(ca_zip, 1, 5) <> SUBSTRING(s_zip, 1, 5) GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100",
          "prompt_tokens": 3903,
          "response_tokens": 409,
          "llm_time_ms": 94904.66713905334
        },
        {
          "worker_id": 3,
          "query_id": "q19",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1998), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_manager_id = 8), filtered_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_store_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk)\nSELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM filtered_sales JOIN filtered_items ON ss_item_sk = i_item_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN store ON ss_store_sk = s_store_sk WHERE SUBSTRING(ca_zip, 1, 5) <> SUBSTRING(s_zip, 1, 5) GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100",
          "prompt_tokens": 2851,
          "response_tokens": 426,
          "llm_time_ms": 91996.78492546082
        },
        {
          "worker_id": 1,
          "query_id": "q19",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1998), filtered_item AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_manager_id = 8), filtered_store AS (SELECT s_store_sk, SUBSTRING(s_zip, 1, 5) AS s_zip_prefix FROM store), filtered_customer AS (SELECT c_customer_sk, c_current_addr_sk FROM customer), filtered_customer_address AS (SELECT ca_address_sk, SUBSTRING(ca_zip, 1, 5) AS ca_zip_prefix FROM customer_address), qualified_sales AS (SELECT ss.ss_ext_sales_price, i.i_brand_id, i.i_brand, i.i_manufact_id, i.i_manufact FROM store_sales AS ss JOIN filtered_date AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN filtered_item AS i ON ss.ss_item_sk = i.i_item_sk)\nSELECT i_brand_id AS brand_id, i_brand AS brand, i_manufact_id, i_manufact, SUM(ss_ext_sales_price) AS ext_price FROM qualified_sales AS qs JOIN filtered_customer AS c ON qs.ss_customer_sk = c.c_customer_sk JOIN filtered_customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN filtered_store AS s ON qs.ss_store_sk = s.s_store_sk AND ca.ca_zip_prefix <> s.s_zip_prefix GROUP BY i_brand, i_brand_id, i_manufact_id, i_manufact ORDER BY ext_price DESC, i_brand, i_brand_id, i_manufact_id, i_manufact LIMIT 100",
          "prompt_tokens": 2687,
          "response_tokens": 477,
          "llm_time_ms": 115935.52875518799
        },
        {
          "worker_id": 2,
          "query_id": "q19",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1998), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand, i_manufact_id, i_manufact FROM item WHERE i_manager_id = 8), filtered_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_store_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk), filtered_store AS (SELECT s_store_sk, s_zip FROM store)\nSELECT fi.i_brand_id AS brand_id, fi.i_brand AS brand, fi.i_manufact_id, fi.i_manufact, SUM(fs.ss_ext_sales_price) AS ext_price FROM filtered_sales AS fs JOIN filtered_items AS fi ON fs.ss_item_sk = fi.i_item_sk JOIN customer AS c ON fs.ss_customer_sk = c.c_customer_sk JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN filtered_store AS s ON fs.ss_store_sk = s.s_store_sk WHERE SUBSTRING(ca.ca_zip, 1, 5) <> SUBSTRING(s.s_zip, 1, 5) GROUP BY fi.i_brand, fi.i_brand_id, fi.i_manufact_id, fi.i_manufact ORDER BY ext_price DESC, fi.i_brand, fi.i_brand_id, fi.i_manufact_id, fi.i_manufact LIMIT 100",
          "prompt_tokens": 2834,
          "response_tokens": 485,
          "llm_time_ms": 113122.72429466248
        }
      ],
      "original_speedup": 1.04,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061870"
    },
    {
      "query_id": "q31",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q31",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH ss_q1_2000 AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_year = 2000 AND d_qoy = 1 GROUP BY ca_county, d_qoy, d_year), ss_q2_2000 AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_year = 2000 AND d_qoy = 2 GROUP BY ca_county, d_qoy, d_year), ss_q3_2000 AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_year = 2000 AND d_qoy = 3 GROUP BY ca_county, d_qoy, d_year), ws_q1_2000 AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_year = 2000 AND d_qoy = 1 GROUP BY ca_county, d_qoy, d_year), ws_q2_2000 AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_year = 2000 AND d_qoy = 2 GROUP BY ca_county, d_qoy, d_year), ws_q3_2000 AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_year = 2000 AND d_qoy = 3 GROUP BY ca_county, d_qoy, d_year), ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk GROUP BY ca_county, d_qoy, d_year)\nSELECT ss1.ca_county, ss1.d_year, (ws2.web_sales * 1.0000) / ws1.web_sales AS web_q1_q2_increase, (ss2.store_sales * 1.0000) / ss1.store_sales AS store_q1_q2_increase, (ws3.web_sales * 1.0000) / ws2.web_sales AS web_q2_q3_increase, (ss3.store_sales * 1.0000) / ss2.store_sales AS store_q2_q3_increase FROM ss_q1_2000 AS ss1, ss_q2_2000 AS ss2, ss_q3_2000 AS ss3, ws_q1_2000 AS ws1, ws_q2_2000 AS ws2, ws_q3_2000 AS ws3 WHERE ss1.ca_county = ss2.ca_county AND ss2.ca_county = ss3.ca_county AND ss1.ca_county = ws1.ca_county AND ws1.ca_county = ws2.ca_county AND ws1.ca_county = ws3.ca_county AND CASE WHEN ws1.web_sales > 0 THEN (ws2.web_sales * 1.0000) / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN (ss2.store_sales * 1.0000) / ss1.store_sales ELSE NULL END AND CASE WHEN ws2.web_sales > 0 THEN (ws3.web_sales * 1.0000) / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN (ss3.store_sales * 1.0000) / ss2.store_sales ELSE NULL END ORDER BY ss1.ca_county",
          "prompt_tokens": 3948,
          "response_tokens": 927,
          "llm_time_ms": 117572.00574874878
        },
        {
          "worker_id": 4,
          "query_id": "q31",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_qoy IN (1, 2, 3)), ss_agg AS (SELECT ca_county, SUM(CASE WHEN d_qoy = 1 THEN ss_ext_sales_price ELSE 0 END) AS store_sales_q1, SUM(CASE WHEN d_qoy = 2 THEN ss_ext_sales_price ELSE 0 END) AS store_sales_q2, SUM(CASE WHEN d_qoy = 3 THEN ss_ext_sales_price ELSE 0 END) AS store_sales_q3 FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN customer_address ON ss_addr_sk = ca_address_sk GROUP BY ca_county), ws_agg AS (SELECT ca_county, SUM(CASE WHEN d_qoy = 1 THEN ws_ext_sales_price ELSE 0 END) AS web_sales_q1, SUM(CASE WHEN d_qoy = 2 THEN ws_ext_sales_price ELSE 0 END) AS web_sales_q2, SUM(CASE WHEN d_qoy = 3 THEN ws_ext_sales_price ELSE 0 END) AS web_sales_q3 FROM web_sales JOIN date_filter ON ws_sold_date_sk = d_date_sk JOIN customer_address ON ws_bill_addr_sk = ca_address_sk GROUP BY ca_county), ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk GROUP BY ca_county, d_qoy, d_year)\nSELECT s.ca_county, 2000 AS d_year, CASE WHEN s.store_sales_q1 > 0 THEN (s.store_sales_q2 * 1.0000) / s.store_sales_q1 ELSE NULL END AS store_q1_q2_increase, CASE WHEN s.store_sales_q2 > 0 THEN (s.store_sales_q3 * 1.0000) / s.store_sales_q2 ELSE NULL END AS store_q2_q3_increase, CASE WHEN w.web_sales_q1 > 0 THEN (w.web_sales_q2 * 1.0000) / w.web_sales_q1 ELSE NULL END AS web_q1_q2_increase, CASE WHEN w.web_sales_q2 > 0 THEN (w.web_sales_q3 * 1.0000) / w.web_sales_q2 ELSE NULL END AS web_q2_q3_increase FROM ss_agg AS s JOIN ws_agg AS w ON s.ca_county = w.ca_county WHERE (CASE WHEN w.web_sales_q1 > 0 THEN (w.web_sales_q2 * 1.0000) / w.web_sales_q1 ELSE NULL END) > (CASE WHEN s.store_sales_q1 > 0 THEN (s.store_sales_q2 * 1.0000) / s.store_sales_q1 ELSE NULL END) AND (CASE WHEN w.web_sales_q2 > 0 THEN (w.web_sales_q3 * 1.0000) / w.web_sales_q2 ELSE NULL END) > (CASE WHEN s.store_sales_q2 > 0 THEN (s.store_sales_q3 * 1.0000) / s.store_sales_q2 ELSE NULL END) ORDER BY s.ca_county",
          "prompt_tokens": 5017,
          "response_tokens": 1074,
          "llm_time_ms": 136375.70071220398
        },
        {
          "worker_id": 3,
          "query_id": "q31",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_qoy, d_year FROM date_dim WHERE d_year = 2000 AND d_qoy IN (1, 2, 3)), ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_address ON ss_addr_sk = ca_address_sk GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer_address ON ws_bill_addr_sk = ca_address_sk GROUP BY ca_county, d_qoy, d_year)\nSELECT ss1.ca_county, ss1.d_year, (ws2.web_sales * 1.0000) / NULLIF(ws1.web_sales, 0) AS web_q1_q2_increase, (ss2.store_sales * 1.0000) / NULLIF(ss1.store_sales, 0) AS store_q1_q2_increase, (ws3.web_sales * 1.0000) / NULLIF(ws2.web_sales, 0) AS web_q2_q3_increase, (ss3.store_sales * 1.0000) / NULLIF(ss2.store_sales, 0) AS store_q2_q3_increase FROM ss AS ss1 JOIN ss AS ss2 ON ss1.ca_county = ss2.ca_county AND ss2.d_qoy = 2 JOIN ss AS ss3 ON ss2.ca_county = ss3.ca_county AND ss3.d_qoy = 3 JOIN ws AS ws1 ON ss1.ca_county = ws1.ca_county AND ws1.d_qoy = 1 JOIN ws AS ws2 ON ws1.ca_county = ws2.ca_county AND ws2.d_qoy = 2 JOIN ws AS ws3 ON ws1.ca_county = ws3.ca_county AND ws3.d_qoy = 3 WHERE ss1.d_qoy = 1 AND CASE WHEN ws1.web_sales > 0 THEN (ws2.web_sales * 1.0000) / NULLIF(ws1.web_sales, 0) ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN (ss2.store_sales * 1.0000) / NULLIF(ss1.store_sales, 0) ELSE NULL END AND CASE WHEN ws2.web_sales > 0 THEN (ws3.web_sales * 1.0000) / NULLIF(ws2.web_sales, 0) ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN (ss3.store_sales * 1.0000) / NULLIF(ss2.store_sales, 0) ELSE NULL END ORDER BY ss1.ca_county",
          "prompt_tokens": 3967,
          "response_tokens": 1133,
          "llm_time_ms": 139170.5400943756
        },
        {
          "worker_id": 1,
          "query_id": "q31",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH ss_q1 AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_qoy = 1 AND d_year = 2000 GROUP BY ca_county, d_qoy, d_year), ss_q2 AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_qoy = 2 AND d_year = 2000 GROUP BY ca_county, d_qoy, d_year), ss_q3 AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk AND d_qoy = 3 AND d_year = 2000 GROUP BY ca_county, d_qoy, d_year), ws_q1 AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_qoy = 1 AND d_year = 2000 GROUP BY ca_county, d_qoy, d_year), ws_q2 AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_qoy = 2 AND d_year = 2000 GROUP BY ca_county, d_qoy, d_year), ws_q3 AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk AND d_qoy = 3 AND d_year = 2000 GROUP BY ca_county, d_qoy, d_year), ss AS (SELECT ca_county, d_qoy, d_year, SUM(ss_ext_sales_price) AS store_sales FROM store_sales, date_dim, customer_address WHERE ss_sold_date_sk = d_date_sk AND ss_addr_sk = ca_address_sk GROUP BY ca_county, d_qoy, d_year), ws AS (SELECT ca_county, d_qoy, d_year, SUM(ws_ext_sales_price) AS web_sales FROM web_sales, date_dim, customer_address WHERE ws_sold_date_sk = d_date_sk AND ws_bill_addr_sk = ca_address_sk GROUP BY ca_county, d_qoy, d_year)\nSELECT ss1.ca_county, ss1.d_year, (ws2.web_sales * 1.0000) / ws1.web_sales AS web_q1_q2_increase, (ss2.store_sales * 1.0000) / ss1.store_sales AS store_q1_q2_increase, (ws3.web_sales * 1.0000) / ws2.web_sales AS web_q2_q3_increase, (ss3.store_sales * 1.0000) / ss2.store_sales AS store_q2_q3_increase FROM ss_q1 AS ss1, ss_q2 AS ss2, ss_q3 AS ss3, ws_q1 AS ws1, ws_q2 AS ws2, ws_q3 AS ws3 WHERE ss1.ca_county = ss2.ca_county AND ss2.ca_county = ss3.ca_county AND ss1.ca_county = ws1.ca_county AND ws1.ca_county = ws2.ca_county AND ws2.ca_county = ws3.ca_county AND CASE WHEN ws1.web_sales > 0 THEN (ws2.web_sales * 1.0000) / ws1.web_sales ELSE NULL END > CASE WHEN ss1.store_sales > 0 THEN (ss2.store_sales * 1.0000) / ss1.store_sales ELSE NULL END AND CASE WHEN ws2.web_sales > 0 THEN (ws3.web_sales * 1.0000) / ws2.web_sales ELSE NULL END > CASE WHEN ss2.store_sales > 0 THEN (ss3.store_sales * 1.0000) / ss2.store_sales ELSE NULL END ORDER BY ss1.ca_county",
          "prompt_tokens": 3801,
          "response_tokens": 972,
          "llm_time_ms": 162323.14729690552
        }
      ],
      "original_speedup": 1.04,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061874"
    },
    {
      "query_id": "q4",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q4",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk AND d_year IN (2001, 2002) GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, date_dim WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk AND d_year IN (2001, 2002) GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk AND d_year IN (2001, 2002) GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001 + 1 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2001 + 1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001 + 1 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 4541,
          "response_tokens": 1351,
          "llm_time_ms": 175943.3445930481
        },
        {
          "worker_id": 1,
          "query_id": "q4",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, date_dim WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year), year_total_store_2001 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2001 AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer AS c JOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk JOIN date_filter AS df ON ss.ss_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag HAVING SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) > 0), year_total_store_2002 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2002 AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer AS c JOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk JOIN date_filter AS df ON ss.ss_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag), year_total_catalog_2001 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2001 AS dyear, SUM(((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2) AS year_total, 'c' AS sale_type FROM customer AS c JOIN catalog_sales AS cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN date_filter AS df ON cs.cs_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag HAVING SUM(((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2) > 0), year_total_catalog_2002 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2002 AS dyear, SUM(((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2) AS year_total, 'c' AS sale_type FROM customer AS c JOIN catalog_sales AS cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN date_filter AS df ON cs.cs_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag), year_total_web_2001 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2001 AS dyear, SUM(((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2) AS year_total, 'w' AS sale_type FROM customer AS c JOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag HAVING SUM(((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2) > 0), year_total_web_2002 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2002 AS dyear, SUM(((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2) AS year_total, 'w' AS sale_type FROM customer AS c JOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total_store_2001 AS t_s_firstyear, year_total_store_2002 AS t_s_secyear, year_total_catalog_2001 AS t_c_firstyear, year_total_catalog_2002 AS t_c_secyear, year_total_web_2001 AS t_w_firstyear, year_total_web_2002 AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 4394,
          "response_tokens": 1497,
          "llm_time_ms": 209119.00663375854
        },
        {
          "worker_id": 4,
          "query_id": "q4",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, filtered_dates WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, filtered_dates WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, filtered_dates WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year)\nSELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total AS t_s_firstyear, year_total AS t_s_secyear, year_total AS t_c_firstyear, year_total AS t_c_secyear, year_total AS t_w_firstyear, year_total AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND t_s_firstyear.sale_type = 's' AND t_c_firstyear.sale_type = 'c' AND t_w_firstyear.sale_type = 'w' AND t_s_secyear.sale_type = 's' AND t_c_secyear.sale_type = 'c' AND t_w_secyear.sale_type = 'w' AND t_s_firstyear.dyear = 2001 AND t_s_secyear.dyear = 2001 + 1 AND t_c_firstyear.dyear = 2001 AND t_c_secyear.dyear = 2001 + 1 AND t_w_firstyear.dyear = 2001 AND t_w_secyear.dyear = 2001 + 1 AND t_s_firstyear.year_total > 0 AND t_c_firstyear.year_total > 0 AND t_w_firstyear.year_total > 0 AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100",
          "prompt_tokens": 5613,
          "response_tokens": 3315,
          "llm_time_ms": 292292.1917438507
        },
        {
          "worker_id": 3,
          "query_id": "q4",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH year_total AS\n  (SELECT c_customer_id customer_id,\n          c_first_name customer_first_name,\n          c_last_name customer_last_name,\n          c_preferred_cust_flag customer_preferred_cust_flag,\n          c_birth_country customer_birth_country,\n          c_login customer_login,\n          c_email_address customer_email_address,\n          d_year dyear,\n          sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total,\n          's' sale_type\n   FROM customer,\n        store_sales,\n        date_dim\n   WHERE c_customer_sk = ss_customer_sk\n     AND ss_sold_date_sk = d_date_sk\n   GROUP BY c_customer_id,\n            c_first_name,\n            c_last_name,\n            c_preferred_cust_flag,\n            c_birth_country,\n            c_login,\n            c_email_address,\n            d_year\n   UNION ALL SELECT c_customer_id customer_id,\n                    c_first_name customer_first_name,\n                    c_last_name customer_last_name,\n                    c_preferred_cust_flag customer_preferred_cust_flag,\n                    c_birth_country customer_birth_country,\n                    c_login customer_login,\n                    c_email_address customer_email_address,\n                    d_year dyear,\n                    sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2)) year_total,\n                    'c' sale_type\n   FROM customer,\n        catalog_sales,\n        date_dim\n   WHERE c_customer_sk = cs_bill_customer_sk\n     AND cs_sold_date_sk = d_date_sk\n   GROUP BY c_customer_id,\n            c_first_name,\n            c_last_name,\n            c_preferred_cust_flag,\n            c_birth_country,\n            c_login,\n            c_email_address,\n            d_year\n   UNION ALL SELECT c_customer_id customer_id,\n                    c_first_name customer_first_name,\n                    c_last_name customer_last_name,\n                    c_preferred_cust_flag customer_preferred_cust_flag,\n                    c_birth_country customer_birth_country,\n                    c_login customer_login,\n                    c_email_address customer_email_address,\n                    d_year dyear,\n                    sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2)) year_total,\n                    'w' sale_type\n   FROM customer,\n        web_sales,\n        date_dim\n   WHERE c_customer_sk = ws_bill_customer_sk\n     AND ws_sold_date_sk = d_date_sk\n   GROUP BY c_customer_id,\n            c_first_name,\n            c_last_name,\n            c_preferred_cust_flag,\n            c_birth_country,\n            c_login,\n            c_email_address,\n            d_year)\nSELECT t_s_secyear.customer_id,\n       t_s_secyear.customer_first_name,\n       t_s_secyear.customer_last_name,\n       t_s_secyear.customer_preferred_cust_flag\nFROM year_total t_s_firstyear,\n     year_total t_s_secyear,\n     year_total t_c_firstyear,\n     year_total t_c_secyear,\n     year_total t_w_firstyear,\n     year_total t_w_secyear\nWHERE t_s_secyear.customer_id = t_s_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_secyear.customer_id\n  AND t_s_firstyear.customer_id = t_c_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_firstyear.customer_id\n  AND t_s_firstyear.customer_id = t_w_secyear.customer_id\n  AND t_s_firstyear.sale_type = 's'\n  AND t_c_firstyear.sale_type = 'c'\n  AND t_w_firstyear.sale_type = 'w'\n  AND t_s_secyear.sale_type = 's'\n  AND t_c_secyear.sale_type = 'c'\n  AND t_w_secyear.sale_type = 'w'\n  AND t_s_firstyear.dyear = 2001\n  AND t_s_secyear.dyear = 2001+1\n  AND t_c_firstyear.dyear = 2001\n  AND t_c_secyear.dyear = 2001+1\n  AND t_w_firstyear.dyear = 2001\n  AND t_w_secyear.dyear = 2001+1\n  AND t_s_firstyear.year_total > 0\n  AND t_c_firstyear.year_total > 0\n  AND t_w_firstyear.year_total > 0\n  AND CASE\n          WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total\n          ELSE NULL\n      END > CASE\n                WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total\n                ELSE NULL\n            END\n  AND CASE\n          WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total\n          ELSE NULL\n      END > CASE\n                WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total\n                ELSE NULL\n            END\nORDER BY t_s_secyear.customer_id NULLS FIRST,\n         t_s_secyear.customer_first_name NULLS FIRST,\n         t_s_secyear.customer_last_name NULLS FIRST,\n         t_s_secyear.customer_preferred_cust_flag NULLS FIRST\nLIMIT 100;\n\n",
          "prompt_tokens": 4558,
          "response_tokens": 0,
          "llm_time_ms": 505015.61737060547
        }
      ],
      "original_speedup": 1.03,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061878"
    },
    {
      "query_id": "q8",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q8",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 1998), filtered_stores_with_zips AS (SELECT s_store_sk, s_store_name, SUBSTRING(s_zip, 1, 2) AS s_zip_prefix FROM store)\nSELECT s_store_name, SUM(ss_net_profit) FROM store_sales JOIN filtered_date_dim ON ss_sold_date_sk = d_date_sk JOIN filtered_stores_with_zips ON ss_store_sk = s_store_sk WHERE s_zip_prefix IN (SELECT DISTINCT SUBSTRING(ca_zip, 1, 2) FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576') INTERSECT SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip, COUNT(*) AS cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk AND c_preferred_cust_flag = 'Y' GROUP BY ca_zip HAVING COUNT(*) > 10) AS A1) AS A2) GROUP BY s_store_name ORDER BY s_store_name LIMIT 100",
          "prompt_tokens": 3775,
          "response_tokens": 1273,
          "llm_time_ms": 230910.51030158997
        },
        {
          "worker_id": 2,
          "query_id": "q8",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 1998), filtered_store_sales AS (SELECT ss_store_sk, ss_net_profit FROM store_sales WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM filtered_dates)), zip_subquery AS (SELECT SUBSTRING(ca_zip, 1, 2) AS zip_prefix FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576')), preferred_customer_zips AS (SELECT SUBSTRING(ca_zip, 1, 2) AS zip_prefix, COUNT(*) AS cnt FROM customer_address JOIN customer ON ca_address_sk = c_current_addr_sk WHERE c_preferred_cust_flag = 'Y' GROUP BY SUBSTRING(ca_zip, 1, 2) HAVING COUNT(*) > 10), valid_zip_prefixes AS (SELECT zip_prefix FROM zip_subquery INTERSECT SELECT zip_prefix FROM preferred_customer_zips)\nSELECT s_store_name, SUM(ss_net_profit) FROM filtered_store_sales AS fss JOIN store AS s ON fss.ss_store_sk = s.s_store_sk WHERE SUBSTRING(s_zip, 1, 2) IN (SELECT zip_prefix FROM valid_zip_prefixes) GROUP BY s_store_name ORDER BY s_store_name LIMIT 100",
          "prompt_tokens": 3758,
          "response_tokens": 1312,
          "llm_time_ms": 239474.72524642944
        },
        {
          "worker_id": 1,
          "query_id": "q8",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 1998), filtered_store_sales AS (SELECT ss_store_sk, ss_net_profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk)\nSELECT s_store_name, SUM(ss_net_profit) FROM store_sales, date_dim, store, (SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576') INTERSECT SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip, COUNT(*) AS cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk AND c_preferred_cust_flag = 'Y' GROUP BY ca_zip HAVING COUNT(*) > 10) AS A1) AS A2) AS V1 WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d_date_sk AND d_qoy = 2 AND d_year = 1998 AND (SUBSTRING(s_zip, 1, 2) = SUBSTRING(V1.ca_zip, 1, 2)) GROUP BY s_store_name ORDER BY s_store_name LIMIT 100",
          "prompt_tokens": 3611,
          "response_tokens": 1822,
          "llm_time_ms": 257144.31977272034
        },
        {
          "worker_id": 4,
          "query_id": "q8",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 1998)\nSELECT s_store_name, SUM(ss_net_profit) FROM store_sales, filtered_dates, store, (SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576') INTERSECT SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip, COUNT(*) AS cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk AND c_preferred_cust_flag = 'Y' GROUP BY ca_zip HAVING COUNT(*) > 10) AS A1) AS A2) AS V1 WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d_date_sk AND (SUBSTRING(s_zip, 1, 2) = SUBSTRING(V1.ca_zip, 1, 2)) GROUP BY s_store_name ORDER BY s_store_name LIMIT 100",
          "prompt_tokens": 4825,
          "response_tokens": 4348,
          "llm_time_ms": 367633.5060596466
        }
      ],
      "original_speedup": 1.03,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061881"
    },
    {
      "query_id": "q54",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q54",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_customers AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 12), date_range_anchor AS (SELECT d_month_seq FROM date_dim WHERE d_year = 1998 AND d_moy = 12 LIMIT 1), filtered_dates_revenue AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN (SELECT d_month_seq + 1 FROM date_range_anchor) AND (SELECT d_month_seq + 3 FROM date_range_anchor)), filtered_item AS (SELECT i_item_sk FROM item WHERE i_category = 'Women' AND i_class = 'maternity'), my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk FROM web_sales) AS cs_or_ws_sales, filtered_item, filtered_dates_customers, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND c_customer_sk = cs_or_ws_sales.customer_sk), my_revenue AS (SELECT c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, filtered_dates_revenue WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk GROUP BY c_customer_sk), segments AS (SELECT CAST(ROUND(revenue / 50) AS INT) AS SEGMENT FROM my_revenue)\nSELECT SEGMENT, COUNT(*) AS num_customers, SEGMENT * 50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT NULLS FIRST, num_customers NULLS FIRST, segment_base LIMIT 100",
          "prompt_tokens": 3198,
          "response_tokens": 926,
          "llm_time_ms": 143524.0216255188
        },
        {
          "worker_id": 1,
          "query_id": "q54",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH base_month_seq AS (SELECT DISTINCT d_month_seq FROM date_dim WHERE d_year = 1998 AND d_moy = 12), dec_1998_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 12), next_three_months_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN (SELECT d_month_seq FROM base_month_seq) + 1 AND (SELECT d_month_seq FROM base_month_seq) + 3), my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk FROM web_sales) AS cs_or_ws_sales JOIN dec_1998_dates AS d ON cs_or_ws_sales.sold_date_sk = d.d_date_sk JOIN item AS i ON cs_or_ws_sales.item_sk = i.i_item_sk JOIN customer AS c ON cs_or_ws_sales.customer_sk = c.c_customer_sk WHERE i.i_category = 'Women' AND i.i_class = 'maternity'), my_revenue AS (SELECT c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers AS mc JOIN store_sales AS ss ON mc.c_customer_sk = ss.ss_customer_sk JOIN customer_address AS ca ON mc.c_current_addr_sk = ca.ca_address_sk JOIN store AS s ON ca.ca_county = s.s_county AND ca.ca_state = s.s_state JOIN next_three_months_dates AS nd ON ss.ss_sold_date_sk = nd.d_date_sk GROUP BY c_customer_sk), segments AS (SELECT CAST(ROUND(revenue / 50) AS INT) AS SEGMENT FROM my_revenue)\nSELECT SEGMENT, COUNT(*) AS num_customers, SEGMENT * 50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT NULLS FIRST, num_customers NULLS FIRST, segment_base LIMIT 100",
          "prompt_tokens": 3036,
          "response_tokens": 756,
          "llm_time_ms": 146244.72165107727
        },
        {
          "worker_id": 4,
          "query_id": "q54",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_1998_dec AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 12), my_customers_rewrite AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales WHERE cs_sold_date_sk IN (SELECT d_date_sk FROM filtered_dates_1998_dec) UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk FROM web_sales WHERE ws_sold_date_sk IN (SELECT d_date_sk FROM filtered_dates_1998_dec)) AS cs_or_ws_sales, item, customer WHERE item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk), my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM (SELECT cs_sold_date_sk AS sold_date_sk, cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales UNION ALL SELECT ws_sold_date_sk AS sold_date_sk, ws_bill_customer_sk AS customer_sk, ws_item_sk AS item_sk FROM web_sales) AS cs_or_ws_sales, item, date_dim, customer WHERE sold_date_sk = d_date_sk AND item_sk = i_item_sk AND i_category = 'Women' AND i_class = 'maternity' AND c_customer_sk = cs_or_ws_sales.customer_sk AND d_moy = 12 AND d_year = 1998), my_revenue AS (SELECT c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers, store_sales, customer_address, store, date_dim WHERE c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND ss_sold_date_sk = d_date_sk AND c_customer_sk = ss_customer_sk AND d_month_seq BETWEEN (SELECT DISTINCT d_month_seq + 1 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) AND (SELECT DISTINCT d_month_seq + 3 FROM date_dim WHERE d_year = 1998 AND d_moy = 12) GROUP BY c_customer_sk), segments AS (SELECT CAST(ROUND(revenue / 50) AS INT) AS SEGMENT FROM my_revenue)\nSELECT SEGMENT, COUNT(*) AS num_customers, SEGMENT * 50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT NULLS FIRST, num_customers NULLS FIRST, segment_base LIMIT 100",
          "prompt_tokens": 4249,
          "response_tokens": 912,
          "llm_time_ms": 168087.58068084717
        },
        {
          "worker_id": 2,
          "query_id": "q54",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_my_customers AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 12 AND d_year = 1998), filtered_items AS (SELECT i_item_sk FROM item WHERE i_category = 'Women' AND i_class = 'maternity'), cs_sales_filtered AS (SELECT cs_sold_date_sk, cs_bill_customer_sk FROM catalog_sales JOIN filtered_dates_my_customers ON catalog_sales.cs_sold_date_sk = filtered_dates_my_customers.d_date_sk JOIN filtered_items ON catalog_sales.cs_item_sk = filtered_items.i_item_sk), ws_sales_filtered AS (SELECT ws_sold_date_sk, ws_bill_customer_sk FROM web_sales JOIN filtered_dates_my_customers ON web_sales.ws_sold_date_sk = filtered_dates_my_customers.d_date_sk JOIN filtered_items ON web_sales.ws_item_sk = filtered_items.i_item_sk), cs_or_ws_sales_union AS (SELECT cs_bill_customer_sk AS customer_sk FROM cs_sales_filtered UNION ALL SELECT ws_bill_customer_sk AS customer_sk FROM ws_sales_filtered), my_customers AS (SELECT DISTINCT c_customer_sk, c_current_addr_sk FROM cs_or_ws_sales_union, customer WHERE c_customer_sk = cs_or_ws_sales_union.customer_sk), base_month_seq AS (SELECT DISTINCT d_month_seq FROM date_dim WHERE d_year = 1998 AND d_moy = 12), date_range_dates AS (SELECT d_date_sk FROM date_dim, base_month_seq WHERE d_month_seq BETWEEN base_month_seq.d_month_seq + 1 AND base_month_seq.d_month_seq + 3), filtered_store_sales AS (SELECT ss_customer_sk, ss_ext_sales_price FROM store_sales JOIN date_range_dates ON store_sales.ss_sold_date_sk = date_range_dates.d_date_sk), my_revenue AS (SELECT c_customer_sk, SUM(ss_ext_sales_price) AS revenue FROM my_customers, filtered_store_sales, customer_address, store WHERE my_customers.c_current_addr_sk = ca_address_sk AND ca_county = s_county AND ca_state = s_state AND my_customers.c_customer_sk = filtered_store_sales.ss_customer_sk GROUP BY c_customer_sk), segments AS (SELECT CAST(ROUND(revenue / 50) AS INT) AS SEGMENT FROM my_revenue)\nSELECT SEGMENT, COUNT(*) AS num_customers, SEGMENT * 50 AS segment_base FROM segments GROUP BY SEGMENT ORDER BY SEGMENT NULLS FIRST, num_customers NULLS FIRST, segment_base LIMIT 100",
          "prompt_tokens": 3183,
          "response_tokens": 728,
          "llm_time_ms": 183422.37782478333
        }
      ],
      "original_speedup": 1.03,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061885"
    },
    {
      "query_id": "q69",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q69",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy BETWEEN 4 AND 6), store_sales_customers AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk), web_sales_customers AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk), catalog_sales_customers AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_range ON cs_sold_date_sk = d_date_sk)\nSELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk JOIN store_sales_customers AS ss ON c.c_customer_sk = ss.ss_customer_sk LEFT JOIN web_sales_customers AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk LEFT JOIN catalog_sales_customers AS cs ON c.c_customer_sk = cs.cs_ship_customer_sk WHERE ca_state IN ('KY', 'GA', 'NM') AND ws.ws_bill_customer_sk IS NULL AND cs.cs_ship_customer_sk IS NULL GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100",
          "prompt_tokens": 2965,
          "response_tokens": 558,
          "llm_time_ms": 127158.30540657043
        },
        {
          "worker_id": 3,
          "query_id": "q69",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy BETWEEN 4 AND 6), store_sales_customers AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk), web_sales_customers AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk), catalog_sales_customers AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk), filtered_ca AS (SELECT ca_address_sk FROM customer_address WHERE ca_state IN ('KY', 'GA', 'NM'))\nSELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer_demographics AS cd JOIN customer AS c ON cd.cd_demo_sk = c.c_current_cdemo_sk JOIN filtered_ca AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN store_sales_customers AS ssc ON c.c_customer_sk = ssc.ss_customer_sk LEFT JOIN web_sales_customers AS wsc ON c.c_customer_sk = wsc.ws_bill_customer_sk LEFT JOIN catalog_sales_customers AS csc ON c.c_customer_sk = csc.cs_ship_customer_sk WHERE wsc.ws_bill_customer_sk IS NULL AND csc.cs_ship_customer_sk IS NULL GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100",
          "prompt_tokens": 3129,
          "response_tokens": 905,
          "llm_time_ms": 120865.82493782043
        },
        {
          "worker_id": 2,
          "query_id": "q69",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy BETWEEN 4 AND 6), filtered_store_sales AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk), filtered_web_sales AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk), filtered_catalog_sales AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk)\nSELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE ca.ca_state IN ('KY', 'GA', 'NM') AND EXISTS(SELECT 1 FROM filtered_store_sales WHERE ss_customer_sk = c.c_customer_sk) AND NOT EXISTS(SELECT 1 FROM filtered_web_sales WHERE ws_bill_customer_sk = c.c_customer_sk) AND NOT EXISTS(SELECT 1 FROM filtered_catalog_sales WHERE cs_ship_customer_sk = c.c_customer_sk) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100",
          "prompt_tokens": 3109,
          "response_tokens": 533,
          "llm_time_ms": 164089.14351463318
        },
        {
          "worker_id": 4,
          "query_id": "q69",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy BETWEEN 4 AND 6), store_sales_filtered AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk), web_sales_filtered AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_filter ON ws_sold_date_sk = d_date_sk), catalog_sales_filtered AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_filter ON cs_sold_date_sk = d_date_sk)\nSELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics ON cd_demo_sk = c.c_current_cdemo_sk WHERE ca_state IN ('KY', 'GA', 'NM') AND EXISTS(SELECT 1 FROM store_sales_filtered WHERE ss_customer_sk = c.c_customer_sk) AND NOT EXISTS(SELECT 1 FROM web_sales_filtered WHERE ws_bill_customer_sk = c.c_customer_sk) AND NOT EXISTS(SELECT 1 FROM catalog_sales_filtered WHERE cs_ship_customer_sk = c.c_customer_sk) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating LIMIT 100",
          "prompt_tokens": 4181,
          "response_tokens": 881,
          "llm_time_ms": 177014.49918746948
        }
      ],
      "original_speedup": 1.03,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061888"
    },
    {
      "query_id": "q80",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q80",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)), filtered_item AS (SELECT i_item_sk FROM item WHERE i_current_price > 50), filtered_promotion AS (SELECT p_promo_sk FROM promotion WHERE p_channel_tv = 'N'), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns_, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number) JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN web_site ON ws_web_site_sk = web_site_sk JOIN filtered_item ON ws_item_sk = i_item_sk JOIN filtered_promotion ON ws_promo_sk = p_promo_sk GROUP BY web_site_id), ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns_, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk JOIN filtered_item ON ss_item_sk = i_item_sk JOIN filtered_promotion ON ss_promo_sk = p_promo_sk GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns_, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number) JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk JOIN filtered_item ON cs_item_sk = i_item_sk JOIN filtered_promotion ON cs_promo_sk = p_promo_sk GROUP BY cp_catalog_page_id)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, CONCAT('store', store_id) AS id, sales, returns_, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, CONCAT('catalog_page', catalog_page_id) AS id, sales, returns_, profit FROM csr UNION ALL SELECT 'web channel' AS channel, CONCAT('web_site', web_site_id) AS id, sales, returns_, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3813,
          "response_tokens": 785,
          "llm_time_ms": 91090.1529788971
        },
        {
          "worker_id": 3,
          "query_id": "q80",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)), filtered_item AS (SELECT i_item_sk FROM item WHERE i_current_price > 50), filtered_promotion AS (SELECT p_promo_sk FROM promotion WHERE p_channel_tv = 'N'), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns_, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_item ON ws_item_sk = i_item_sk JOIN filtered_promotion ON ws_promo_sk = p_promo_sk LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number) JOIN web_site ON ws_web_site_sk = web_site_sk GROUP BY web_site_id), ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns_, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_item ON ss_item_sk = i_item_sk JOIN filtered_promotion ON ss_promo_sk = p_promo_sk LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) JOIN store ON ss_store_sk = s_store_sk GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns_, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_item ON cs_item_sk = i_item_sk JOIN filtered_promotion ON cs_promo_sk = p_promo_sk LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number) JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, CONCAT('store', store_id) AS id, sales, returns_, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, CONCAT('catalog_page', catalog_page_id) AS id, sales, returns_, profit FROM csr UNION ALL SELECT 'web channel' AS channel, CONCAT('web_site', web_site_id) AS id, sales, returns_, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3978,
          "response_tokens": 806,
          "llm_time_ms": 129752.25305557251
        },
        {
          "worker_id": 2,
          "query_id": "q80",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)), filtered_items AS (SELECT i_item_sk FROM item WHERE i_current_price > 50), filtered_promotions AS (SELECT p_promo_sk FROM promotion WHERE p_channel_tv = 'N'), ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns_, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_items ON ss_item_sk = i_item_sk JOIN filtered_promotions ON ss_promo_sk = p_promo_sk LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) JOIN store ON ss_store_sk = s_store_sk GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns_, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_items ON cs_item_sk = i_item_sk JOIN filtered_promotions ON cs_promo_sk = p_promo_sk LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number) JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk GROUP BY cp_catalog_page_id), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns_, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_items ON ws_item_sk = i_item_sk JOIN filtered_promotions ON ws_promo_sk = p_promo_sk LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number) JOIN web_site ON ws_web_site_sk = web_site_sk GROUP BY web_site_id)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, CONCAT('store', store_id) AS id, sales, returns_, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, CONCAT('catalog_page', catalog_page_id) AS id, sales, returns_, profit FROM csr UNION ALL SELECT 'web channel' AS channel, CONCAT('web_site', web_site_id) AS id, sales, returns_, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3959,
          "response_tokens": 905,
          "llm_time_ms": 177073.19116592407
        },
        {
          "worker_id": 4,
          "query_id": "q80",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)), wsr AS (SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns_, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number) JOIN filtered_dates ON ws_sold_date_sk = d_date_sk, web_site, item, promotion WHERE ws_web_site_sk = web_site_sk AND ws_item_sk = i_item_sk AND i_current_price > 50 AND ws_promo_sk = p_promo_sk AND p_channel_tv = 'N' GROUP BY web_site_id), ssr AS (SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns_, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) JOIN filtered_dates ON ss_sold_date_sk = d_date_sk, store, item, promotion WHERE ss_store_sk = s_store_sk AND ss_item_sk = i_item_sk AND i_current_price > 50 AND ss_promo_sk = p_promo_sk AND p_channel_tv = 'N' GROUP BY s_store_id), csr AS (SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns_, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number) JOIN filtered_dates ON cs_sold_date_sk = d_date_sk, catalog_page, item, promotion WHERE cs_catalog_page_sk = cp_catalog_page_sk AND cs_item_sk = i_item_sk AND i_current_price > 50 AND cs_promo_sk = p_promo_sk AND p_channel_tv = 'N' GROUP BY cp_catalog_page_id)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, CONCAT('store', store_id) AS id, sales, returns_, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, CONCAT('catalog_page', catalog_page_id) AS id, sales, returns_, profit FROM csr UNION ALL SELECT 'web channel' AS channel, CONCAT('web_site', web_site_id) AS id, sales, returns_, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST LIMIT 100",
          "prompt_tokens": 5025,
          "response_tokens": 1514,
          "llm_time_ms": 262149.52778816223
        }
      ],
      "original_speedup": 1.03,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061891"
    },
    {
      "query_id": "q10",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q10",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 1 AND 4), store_sales_customers AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk), web_sales_customers AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN filtered_dates ON web_sales.ws_sold_date_sk = filtered_dates.d_date_sk), catalog_sales_customers AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN filtered_dates ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk)\nSELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = c.c_current_cdemo_sk WHERE ca.ca_county IN ('Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County') AND EXISTS(SELECT 1 FROM store_sales_customers AS ssc WHERE ssc.ss_customer_sk = c.c_customer_sk) AND (EXISTS(SELECT 1 FROM web_sales_customers AS wsc WHERE wsc.ws_bill_customer_sk = c.c_customer_sk) OR EXISTS(SELECT 1 FROM catalog_sales_customers AS csc WHERE csc.cs_ship_customer_sk = c.c_customer_sk)) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",
          "prompt_tokens": 3484,
          "response_tokens": 1137,
          "llm_time_ms": 167378.1192302704
        },
        {
          "worker_id": 3,
          "query_id": "q10",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 1 AND 4), store_sales_customers AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_range ON ss_sold_date_sk = d_date_sk), web_sales_customers AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_range ON ws_sold_date_sk = d_date_sk), catalog_sales_customers AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_range ON cs_sold_date_sk = d_date_sk)\nSELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk JOIN store_sales_customers AS ssc ON c.c_customer_sk = ssc.ss_customer_sk LEFT JOIN web_sales_customers AS wsc ON c.c_customer_sk = wsc.ws_bill_customer_sk LEFT JOIN catalog_sales_customers AS csc ON c.c_customer_sk = csc.cs_ship_customer_sk WHERE ca_county IN ('Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County') AND (NOT wsc.ws_bill_customer_sk IS NULL OR NOT csc.cs_ship_customer_sk IS NULL) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",
          "prompt_tokens": 3505,
          "response_tokens": 620,
          "llm_time_ms": 183744.60887908936
        },
        {
          "worker_id": 1,
          "query_id": "q10",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_period AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 1 AND 4), filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_county IN ('Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County')), store_sales_customers AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN date_period ON ss_sold_date_sk = d_date_sk), web_sales_customers AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN date_period ON ws_sold_date_sk = d_date_sk), catalog_sales_customers AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN date_period ON cs_sold_date_sk = d_date_sk), any_sales_customers AS (SELECT ws_bill_customer_sk AS customer_sk FROM web_sales_customers UNION ALL SELECT cs_ship_customer_sk FROM catalog_sales_customers), customers_with_sales AS (SELECT DISTINCT c.c_customer_sk, c.c_current_cdemo_sk, c.c_current_addr_sk FROM customer AS c JOIN store_sales_customers AS ss ON c.c_customer_sk = ss.ss_customer_sk JOIN any_sales_customers AS asc ON c.c_customer_sk = asc.customer_sk)\nSELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM customers_with_sales AS cws JOIN filtered_customer_address AS fca ON cws.c_current_addr_sk = fca.ca_address_sk JOIN customer_demographics AS cd ON cws.c_current_cdemo_sk = cd.cd_demo_sk GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",
          "prompt_tokens": 3337,
          "response_tokens": 948,
          "llm_time_ms": 184391.5629386902
        },
        {
          "worker_id": 4,
          "query_id": "q10",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002 AND d_moy BETWEEN 1 AND 4), store_sales_customers AS (SELECT DISTINCT ss_customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk), web_sales_customers AS (SELECT DISTINCT ws_bill_customer_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk), catalog_sales_customers AS (SELECT DISTINCT cs_ship_customer_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk), qualified_customers AS (SELECT ss_customer_sk FROM store_sales_customers INTERSECT (SELECT ws_bill_customer_sk FROM web_sales_customers UNION SELECT cs_ship_customer_sk FROM catalog_sales_customers))\nSELECT cd_gender, cd_marital_status, cd_education_status, COUNT(*) AS cnt1, cd_purchase_estimate, COUNT(*) AS cnt2, cd_credit_rating, COUNT(*) AS cnt3, cd_dep_count, COUNT(*) AS cnt4, cd_dep_employed_count, COUNT(*) AS cnt5, cd_dep_college_count, COUNT(*) AS cnt6 FROM customer AS c JOIN customer_address AS ca ON c.c_current_addr_sk = ca.ca_address_sk JOIN customer_demographics AS cd ON cd_demo_sk = c.c_current_cdemo_sk WHERE ca_county IN ('Rush County', 'Toole County', 'Jefferson County', 'Dona Ana County', 'La Porte County') AND c.c_customer_sk IN (SELECT ss_customer_sk FROM qualified_customers) GROUP BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ORDER BY cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count LIMIT 100",
          "prompt_tokens": 4554,
          "response_tokens": 611,
          "llm_time_ms": 214544.50845718384
        }
      ],
      "original_speedup": 1.02,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061897"
    },
    {
      "query_id": "q46",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q46",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH hd_filter_or_branch1 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 4), hd_filter_or_branch2 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_vehicle_count = 3), filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow IN (6, 0) AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), filtered_sales_union AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_stores ON store_sales.ss_store_sk = filtered_stores.s_store_sk JOIN hd_filter_or_branch1 ON store_sales.ss_hdemo_sk = hd_filter_or_branch1.hd_demo_sk JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city UNION ALL SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_stores ON store_sales.ss_store_sk = filtered_stores.s_store_sk JOIN hd_filter_or_branch2 ON store_sales.ss_hdemo_sk = hd_filter_or_branch2.hd_demo_sk JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk WHERE NOT EXISTS(SELECT 1 FROM hd_filter_or_branch1 WHERE hd_filter_or_branch1.hd_demo_sk = store_sales.ss_hdemo_sk) GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city)\nSELECT c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, amt, profit FROM filtered_sales_union AS dn, customer, customer_address AS current_addr WHERE ss_customer_sk = c_customer_sk AND customer.c_current_addr_sk = current_addr.ca_address_sk AND current_addr.ca_city <> bought_city ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, ca_city NULLS FIRST, bought_city NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100",
          "prompt_tokens": 3100,
          "response_tokens": 757,
          "llm_time_ms": 158354.33101654053
        },
        {
          "worker_id": 3,
          "query_id": "q46",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow IN (6, 0) AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 4 OR hd_vehicle_count = 3)\nSELECT c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, amt, profit FROM (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_store ON store_sales.ss_store_sk = filtered_store.s_store_sk JOIN filtered_hd ON store_sales.ss_hdemo_sk = filtered_hd.hd_demo_sk JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city) AS dn, customer, customer_address AS current_addr WHERE dn.ss_customer_sk = customer.c_customer_sk AND customer.c_current_addr_sk = current_addr.ca_address_sk AND current_addr.ca_city <> bought_city ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, ca_city NULLS FIRST, bought_city NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100",
          "prompt_tokens": 3117,
          "response_tokens": 520,
          "llm_time_ms": 202295.03655433655
        },
        {
          "worker_id": 4,
          "query_id": "q46",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow IN (6, 0) AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), store_sales_hd_dep AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city, ss_coupon_amt, ss_net_profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE hd_dep_count = 4), store_sales_hd_vehicle AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city, ss_coupon_amt, ss_net_profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE hd_vehicle_count = 3 AND (hd_dep_count <> 4 OR hd_dep_count IS NULL)), dn AS (SELECT ss_ticket_number, ss_customer_sk, ca_city AS bought_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM (SELECT * FROM store_sales_hd_dep UNION ALL SELECT * FROM store_sales_hd_vehicle) AS t GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city)\nSELECT c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, amt, profit FROM dn, customer, customer_address AS current_addr WHERE ss_customer_sk = c_customer_sk AND customer.c_current_addr_sk = current_addr.ca_address_sk AND current_addr.ca_city <> bought_city ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, ca_city NULLS FIRST, bought_city NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100",
          "prompt_tokens": 4169,
          "response_tokens": 652,
          "llm_time_ms": 202586.44104003906
        },
        {
          "worker_id": 1,
          "query_id": "q46",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_dow IN (6, 0) AND d_year IN (1999, 2000, 2001)), store_filter AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), hd_dep4 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 4), hd_vehicle3 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_vehicle_count = 3), branch1_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_coupon_amt, ss_net_profit FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN store_filter ON ss_store_sk = s_store_sk JOIN hd_dep4 ON ss_hdemo_sk = hd_demo_sk), branch2_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_coupon_amt, ss_net_profit FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN store_filter ON ss_store_sk = s_store_sk JOIN hd_vehicle3 ON ss_hdemo_sk = hd_demo_sk), unified_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_coupon_amt, ss_net_profit FROM branch1_sales UNION ALL SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_coupon_amt, ss_net_profit FROM branch2_sales), dn AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM unified_sales JOIN customer_address ON ss_addr_sk = ca_address_sk GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city)\nSELECT c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, amt, profit FROM dn, customer, customer_address AS current_addr WHERE ss_customer_sk = c_customer_sk AND customer.c_current_addr_sk = current_addr.ca_address_sk AND current_addr.ca_city <> bought_city ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, ca_city NULLS FIRST, bought_city NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100",
          "prompt_tokens": 2953,
          "response_tokens": 1124,
          "llm_time_ms": 246590.4839038849
        }
      ],
      "original_speedup": 1.02,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061899"
    },
    {
      "query_id": "q49",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q49",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), web_agg AS (SELECT ws.ws_item_sk AS item, ws.ws_order_number, ws.ws_item_sk, ws.ws_quantity, ws.ws_net_paid, wr.wr_return_quantity, wr.wr_return_amt FROM web_sales AS ws LEFT OUTER JOIN web_returns AS wr ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk AND wr.wr_return_amt > 10000), filtered_dates WHERE ws.ws_net_profit > 1 AND ws.ws_net_paid > 0 AND ws.ws_quantity > 0 AND ws.ws_sold_date_sk = filtered_dates.d_date_sk), catalog_agg AS (SELECT cs.cs_item_sk AS item, cs.cs_order_number, cs.cs_item_sk, cs.cs_quantity, cs.cs_net_paid, cr.cr_return_quantity, cr.cr_return_amount FROM catalog_sales AS cs LEFT OUTER JOIN catalog_returns AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk AND cr.cr_return_amount > 10000), filtered_dates WHERE cs.cs_net_profit > 1 AND cs.cs_net_paid > 0 AND cs.cs_quantity > 0 AND cs.cs_sold_date_sk = filtered_dates.d_date_sk), store_agg AS (SELECT sts.ss_item_sk AS item, sts.ss_ticket_number, sts.ss_item_sk, sts.ss_quantity, sts.ss_net_paid, sr.sr_return_quantity, sr.sr_return_amt FROM store_sales AS sts LEFT OUTER JOIN store_returns AS sr ON (sts.ss_ticket_number = sr.sr_ticket_number AND sts.ss_item_sk = sr.sr_item_sk AND sr.sr_return_amt > 10000), filtered_dates WHERE sts.ss_net_profit > 1 AND sts.ss_net_paid > 0 AND sts.ss_quantity > 0 AND sts.ss_sold_date_sk = filtered_dates.d_date_sk)\nSELECT channel, item, return_ratio, return_rank, currency_rank FROM (SELECT 'web' AS channel, web.item, web.return_ratio, web.return_rank, web.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT item, (CAST(SUM(COALESCE(wr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(wr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM web_agg GROUP BY item) AS in_web) AS web WHERE (web.return_rank <= 10 OR web.currency_rank <= 10) UNION SELECT 'catalog' AS channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT item, (CAST(SUM(COALESCE(cr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(cr_return_amount, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM catalog_agg GROUP BY item) AS in_cat) AS catalog WHERE (catalog.return_rank <= 10 OR catalog.currency_rank <= 10) UNION SELECT 'store' AS channel, store.item, store.return_ratio, store.return_rank, store.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT item, (CAST(SUM(COALESCE(sr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ss_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(sr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ss_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM store_agg GROUP BY item) AS in_store) AS store WHERE (store.return_rank <= 10 OR store.currency_rank <= 10)) AS sq1 ORDER BY 1 NULLS FIRST, 4 NULLS FIRST, 5 NULLS FIRST, 2 NULLS FIRST LIMIT 100",
          "prompt_tokens": 5060,
          "response_tokens": 1139,
          "llm_time_ms": 158203.15718650818
        },
        {
          "worker_id": 3,
          "query_id": "q49",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), web_sales_filtered AS (SELECT ws_order_number, ws_item_sk, ws_quantity, ws_net_paid, ws_net_profit FROM web_sales WHERE ws_net_profit > 1 AND ws_net_paid > 0 AND ws_quantity > 0), catalog_sales_filtered AS (SELECT cs_order_number, cs_item_sk, cs_quantity, cs_net_paid, cs_net_profit FROM catalog_sales WHERE cs_net_profit > 1 AND cs_net_paid > 0 AND cs_quantity > 0), store_sales_filtered AS (SELECT ss_ticket_number, ss_item_sk, ss_quantity, ss_net_paid, ss_net_profit FROM store_sales WHERE ss_net_profit > 1 AND ss_net_paid > 0 AND ss_quantity > 0)\nSELECT channel, item, return_ratio, return_rank, currency_rank FROM (SELECT 'web' AS channel, web.item, web.return_ratio, web.return_rank, web.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT ws.ws_item_sk AS item, (CAST(SUM(COALESCE(wr.wr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(wr.wr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM web_sales_filtered AS ws LEFT OUTER JOIN web_returns AS wr ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk) JOIN filtered_dates ON ws.ws_sold_date_sk = filtered_dates.d_date_sk WHERE wr.wr_return_amt > 10000 OR wr.wr_return_amt IS NULL GROUP BY ws.ws_item_sk) AS in_web) AS web WHERE (web.return_rank <= 10 OR web.currency_rank <= 10) UNION SELECT 'catalog' AS channel, catalog.item, catalog.return_ratio, catalog.return_rank, catalog.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT cs.cs_item_sk AS item, (CAST(SUM(COALESCE(cr.cr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(cr.cr_return_amount, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM catalog_sales_filtered AS cs LEFT OUTER JOIN catalog_returns AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) JOIN filtered_dates ON cs.cs_sold_date_sk = filtered_dates.d_date_sk WHERE cr.cr_return_amount > 10000 OR cr.cr_return_amount IS NULL GROUP BY cs.cs_item_sk) AS in_cat) AS catalog WHERE (catalog.return_rank <= 10 OR catalog.currency_rank <= 10) UNION SELECT 'store' AS channel, store.item, store.return_ratio, store.return_rank, store.currency_rank FROM (SELECT item, return_ratio, currency_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM (SELECT sts.ss_item_sk AS item, (CAST(SUM(COALESCE(sr.sr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(sr.sr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM store_sales_filtered AS sts LEFT OUTER JOIN store_returns AS sr ON (sts.ss_ticket_number = sr.sr_ticket_number AND sts.ss_item_sk = sr.sr_item_sk) JOIN filtered_dates ON sts.ss_sold_date_sk = filtered_dates.d_date_sk WHERE sr.sr_return_amt > 10000 OR sr.sr_return_amt IS NULL GROUP BY sts.ss_item_sk) AS in_store) AS store WHERE (store.return_rank <= 10 OR store.currency_rank <= 10)) AS sq1 ORDER BY 1 NULLS FIRST, 4 NULLS FIRST, 5 NULLS FIRST, 2 NULLS FIRST LIMIT 100",
          "prompt_tokens": 4004,
          "response_tokens": 1224,
          "llm_time_ms": 161669.5418357849
        },
        {
          "worker_id": 1,
          "query_id": "q49",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), web_sales_filtered AS (SELECT ws.ws_item_sk, ws.ws_order_number, ws.ws_quantity, ws.ws_net_paid, ws.ws_net_profit FROM web_sales AS ws JOIN filtered_date AS fd ON ws.ws_sold_date_sk = fd.d_date_sk WHERE ws.ws_net_profit > 1 AND ws.ws_net_paid > 0 AND ws.ws_quantity > 0), catalog_sales_filtered AS (SELECT cs.cs_item_sk, cs.cs_order_number, cs.cs_quantity, cs.cs_net_paid, cs.cs_net_profit FROM catalog_sales AS cs JOIN filtered_date AS fd ON cs.cs_sold_date_sk = fd.d_date_sk WHERE cs.cs_net_profit > 1 AND cs.cs_net_paid > 0 AND cs.cs_quantity > 0), store_sales_filtered AS (SELECT ss.ss_item_sk, ss.ss_ticket_number, ss.ss_quantity, ss.ss_net_paid, ss.ss_net_profit FROM store_sales AS ss JOIN filtered_date AS fd ON ss.ss_sold_date_sk = fd.d_date_sk WHERE ss.ss_net_profit > 1 AND ss.ss_net_paid > 0 AND ss.ss_quantity > 0), web_returns_filtered AS (SELECT wr.wr_order_number, wr.wr_item_sk, wr.wr_return_quantity, wr.wr_return_amt FROM web_returns AS wr WHERE wr.wr_return_amt > 10000), catalog_returns_filtered AS (SELECT cr.cr_order_number, cr.cr_item_sk, cr.cr_return_quantity, cr.cr_return_amount FROM catalog_returns AS cr WHERE cr.cr_return_amount > 10000), store_returns_filtered AS (SELECT sr.sr_ticket_number, sr.sr_item_sk, sr.sr_return_quantity, sr.sr_return_amt FROM store_returns AS sr WHERE sr.sr_return_amt > 10000), web_channel_base AS (SELECT wsf.ws_item_sk AS item, CAST(SUM(COALESCE(wrf.wr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(wsf.ws_quantity, 0)) AS DECIMAL(15, 4)) AS return_ratio, CAST(SUM(COALESCE(wrf.wr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(wsf.ws_net_paid, 0)) AS DECIMAL(15, 4)) AS currency_ratio FROM web_sales_filtered AS wsf LEFT JOIN web_returns_filtered AS wrf ON wsf.ws_order_number = wrf.wr_order_number AND wsf.ws_item_sk = wrf.wr_item_sk GROUP BY wsf.ws_item_sk), catalog_channel_base AS (SELECT csf.cs_item_sk AS item, CAST(SUM(COALESCE(crf.cr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(csf.cs_quantity, 0)) AS DECIMAL(15, 4)) AS return_ratio, CAST(SUM(COALESCE(crf.cr_return_amount, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(csf.cs_net_paid, 0)) AS DECIMAL(15, 4)) AS currency_ratio FROM catalog_sales_filtered AS csf LEFT JOIN catalog_returns_filtered AS crf ON csf.cs_order_number = crf.cr_order_number AND csf.cs_item_sk = crf.cr_item_sk GROUP BY csf.cs_item_sk), store_channel_base AS (SELECT ssf.ss_item_sk AS item, CAST(SUM(COALESCE(srf.sr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ssf.ss_quantity, 0)) AS DECIMAL(15, 4)) AS return_ratio, CAST(SUM(COALESCE(srf.sr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ssf.ss_net_paid, 0)) AS DECIMAL(15, 4)) AS currency_ratio FROM store_sales_filtered AS ssf LEFT JOIN store_returns_filtered AS srf ON ssf.ss_ticket_number = srf.sr_ticket_number AND ssf.ss_item_sk = srf.sr_item_sk GROUP BY ssf.ss_item_sk), web_channel_ranked AS (SELECT 'web' AS channel, item, return_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM web_channel_base), catalog_channel_ranked AS (SELECT 'catalog' AS channel, item, return_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM catalog_channel_base), store_channel_ranked AS (SELECT 'store' AS channel, item, return_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM store_channel_base)\nSELECT channel, item, return_ratio, return_rank, currency_rank FROM (SELECT * FROM web_channel_ranked WHERE return_rank <= 10 OR currency_rank <= 10 UNION SELECT * FROM catalog_channel_ranked WHERE return_rank <= 10 OR currency_rank <= 10 UNION SELECT * FROM store_channel_ranked WHERE return_rank <= 10 OR currency_rank <= 10) AS sq1 ORDER BY 1 NULLS FIRST, 4 NULLS FIRST, 5 NULLS FIRST, 2 NULLS FIRST LIMIT 100",
          "prompt_tokens": 3844,
          "response_tokens": 1260,
          "llm_time_ms": 185303.18212509155
        },
        {
          "worker_id": 2,
          "query_id": "q49",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), web_sales_filtered AS (SELECT ws.ws_item_sk, ws.ws_order_number, ws.ws_quantity, ws.ws_net_paid, ws.ws_net_profit FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk WHERE ws.ws_net_profit > 1 AND ws.ws_net_paid > 0 AND ws.ws_quantity > 0), catalog_sales_filtered AS (SELECT cs.cs_item_sk, cs.cs_order_number, cs.cs_quantity, cs.cs_net_paid, cs.cs_net_profit FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk WHERE cs.cs_net_profit > 1 AND cs.cs_net_paid > 0 AND cs.cs_quantity > 0), store_sales_filtered AS (SELECT sts.ss_item_sk, sts.ss_ticket_number, sts.ss_quantity, sts.ss_net_paid, sts.ss_net_profit FROM store_sales AS sts JOIN filtered_dates AS fd ON sts.ss_sold_date_sk = fd.d_date_sk WHERE sts.ss_net_profit > 1 AND sts.ss_net_paid > 0 AND sts.ss_quantity > 0), web_returns_filtered AS (SELECT wr.wr_order_number, wr.wr_item_sk, wr.wr_return_quantity, wr.wr_return_amt FROM web_returns AS wr WHERE wr.wr_return_amt > 10000), catalog_returns_filtered AS (SELECT cr.cr_order_number, cr.cr_item_sk, cr.cr_return_quantity, cr.cr_return_amount FROM catalog_returns AS cr WHERE cr.cr_return_amount > 10000), store_returns_filtered AS (SELECT sr.sr_ticket_number, sr.sr_item_sk, sr.sr_return_quantity, sr.sr_return_amt FROM store_returns AS sr WHERE sr.sr_return_amt > 10000), web_channel AS (SELECT 'web' AS channel, ws.ws_item_sk AS item, (CAST(SUM(COALESCE(wr.wr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(wr.wr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ws.ws_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM web_sales_filtered AS ws LEFT OUTER JOIN web_returns_filtered AS wr ON (ws.ws_order_number = wr.wr_order_number AND ws.ws_item_sk = wr.wr_item_sk) GROUP BY ws.ws_item_sk), catalog_channel AS (SELECT 'catalog' AS channel, cs.cs_item_sk AS item, (CAST(SUM(COALESCE(cr.cr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(cr.cr_return_amount, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(cs.cs_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM catalog_sales_filtered AS cs LEFT OUTER JOIN catalog_returns_filtered AS cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) GROUP BY cs.cs_item_sk), store_channel AS (SELECT 'store' AS channel, sts.ss_item_sk AS item, (CAST(SUM(COALESCE(sr.sr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_quantity, 0)) AS DECIMAL(15, 4))) AS return_ratio, (CAST(SUM(COALESCE(sr.sr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(sts.ss_net_paid, 0)) AS DECIMAL(15, 4))) AS currency_ratio FROM store_sales_filtered AS sts LEFT OUTER JOIN store_returns_filtered AS sr ON (sts.ss_ticket_number = sr.sr_ticket_number AND sts.ss_item_sk = sr.sr_item_sk) GROUP BY sts.ss_item_sk)\nSELECT channel, item, return_ratio, RANK() OVER (PARTITION BY channel ORDER BY return_ratio) AS return_rank, RANK() OVER (PARTITION BY channel ORDER BY currency_ratio) AS currency_rank FROM (SELECT * FROM web_channel UNION ALL SELECT * FROM catalog_channel UNION ALL SELECT * FROM store_channel) AS all_channels WHERE return_rank <= 10 OR currency_rank <= 10 ORDER BY channel NULLS FIRST, return_rank NULLS FIRST, currency_rank NULLS FIRST, item NULLS FIRST LIMIT 100",
          "prompt_tokens": 3987,
          "response_tokens": 1200,
          "llm_time_ms": 221875.04124641418
        }
      ],
      "original_speedup": 1.02,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061902"
    },
    {
      "query_id": "q57",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q57",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH v2 AS (SELECT v1.i_category, v1.i_brand, v1.cc_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.cc_name = v1_lag.cc_name AND v1.cc_name = v1_lead.cc_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales NULLS FIRST, 1, 2, 3, 4, 5, 6, 7, 8, 9 LIMIT 100",
          "prompt_tokens": 4494,
          "response_tokens": 497,
          "llm_time_ms": 166274.32990074158
        },
        {
          "worker_id": 3,
          "query_id": "q57",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1999 OR (d_year = 1998 AND d_moy = 12) OR (d_year = 2000 AND d_moy = 1)), v1 AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, SUM(cs_sales_price) AS sum_sales, AVG(SUM(cs_sales_price)) OVER (PARTITION BY i_category, i_brand, cc_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, cc_name ORDER BY d_year, d_moy) AS rn FROM item, catalog_sales, filtered_dates, call_center WHERE cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND cc_call_center_sk = cs_call_center_sk GROUP BY i_category, i_brand, cc_name, d_year, d_moy), v2 AS (SELECT v1.i_category, v1.i_brand, v1.cc_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.cc_name = v1_lag.cc_name AND v1.cc_name = v1_lead.cc_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales NULLS FIRST, 1, 2, 3, 4, 5, 6, 7, 8, 9 LIMIT 100",
          "prompt_tokens": 3445,
          "response_tokens": 1281,
          "llm_time_ms": 193916.80479049683
        },
        {
          "worker_id": 1,
          "query_id": "q57",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1999 UNION ALL SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1998 AND d_moy = 12 UNION ALL SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 2000 AND d_moy = 1), v1_base AS (SELECT i.i_category, i.i_brand, cc.cc_name, df.d_year, df.d_moy, SUM(cs.cs_sales_price) AS sum_sales FROM catalog_sales AS cs JOIN date_filtered AS df ON cs.cs_sold_date_sk = df.d_date_sk JOIN item AS i ON cs.cs_item_sk = i.i_item_sk JOIN call_center AS cc ON cs.cs_call_center_sk = cc.cc_call_center_sk GROUP BY i.i_category, i.i_brand, cc.cc_name, df.d_year, df.d_moy), v1 AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, sum_sales, AVG(sum_sales) OVER (PARTITION BY i_category, i_brand, cc_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, cc_name ORDER BY d_year, d_moy) AS rn FROM v1_base), v2 AS (SELECT v1.i_category, v1.i_brand, v1.cc_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.cc_name = v1_lag.cc_name AND v1.cc_name = v1_lead.cc_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales NULLS FIRST, 1, 2, 3, 4, 5, 6, 7, 8, 9 LIMIT 100",
          "prompt_tokens": 3281,
          "response_tokens": 1076,
          "llm_time_ms": 250719.55919265747
        },
        {
          "worker_id": 2,
          "query_id": "q57",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH v1 AS (SELECT i_category, i_brand, cc_name, d_year, d_moy, SUM(cs_sales_price) AS sum_sales, AVG(SUM(cs_sales_price)) OVER (PARTITION BY i_category, i_brand, cc_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, cc_name ORDER BY d_year, d_moy) AS rn FROM item, catalog_sales, date_dim, call_center WHERE cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND cc_call_center_sk = cs_call_center_sk AND (d_year = 1999 OR (d_year = 1999 - 1 AND d_moy = 12) OR (d_year = 1999 + 1 AND d_moy = 1)) GROUP BY i_category, i_brand, cc_name, d_year, d_moy), v2 AS (SELECT v1.i_category, v1.i_brand, v1.cc_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.cc_name = v1_lag.cc_name AND v1.cc_name = v1_lead.cc_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales NULLS FIRST, 1, 2, 3, 4, 5, 6, 7, 8, 9 LIMIT 100",
          "prompt_tokens": 3428,
          "response_tokens": 858,
          "llm_time_ms": 281680.6950569153
        }
      ],
      "original_speedup": 1.02,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061907"
    },
    {
      "query_id": "q60",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q60",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), address_filtered AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), music_items AS (SELECT i_item_id, i_item_sk FROM item WHERE i_category = 'Music'), ss AS (SELECT i.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN music_items AS i ON ss.ss_item_sk = i.i_item_sk JOIN date_filtered AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN address_filtered AS a ON ss.ss_addr_sk = a.ca_address_sk GROUP BY i.i_item_id), ws AS (SELECT i.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN music_items AS i ON ws.ws_item_sk = i.i_item_sk JOIN date_filtered AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN address_filtered AS a ON ws.ws_bill_addr_sk = a.ca_address_sk GROUP BY i.i_item_id), cs AS (SELECT i.i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales AS cs JOIN music_items AS i ON cs.cs_item_sk = i.i_item_sk JOIN date_filtered AS d ON cs.cs_sold_date_sk = d.d_date_sk JOIN address_filtered AS a ON cs.cs_bill_addr_sk = a.ca_address_sk GROUP BY i.i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100",
          "prompt_tokens": 3217,
          "response_tokens": 544,
          "llm_time_ms": 115248.10194969177
        },
        {
          "worker_id": 2,
          "query_id": "q60",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), ss AS (SELECT i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ss_rewritten AS (SELECT fi.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ss.ss_addr_sk = fa.ca_address_sk JOIN filtered_items AS fi ON ss.ss_item_sk = fi.i_item_sk GROUP BY fi.i_item_id), ws AS (SELECT i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ws_rewritten AS (SELECT fi.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ws.ws_bill_addr_sk = fa.ca_address_sk JOIN filtered_items AS fi ON ws.ws_item_sk = fi.i_item_sk GROUP BY fi.i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), cs_rewritten AS (SELECT fi.i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON cs.cs_bill_addr_sk = fa.ca_address_sk JOIN filtered_items AS fi ON cs.cs_item_sk = fi.i_item_sk GROUP BY fi.i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss_rewritten UNION ALL SELECT * FROM ws_rewritten UNION ALL SELECT * FROM cs_rewritten) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100",
          "prompt_tokens": 3367,
          "response_tokens": 572,
          "llm_time_ms": 123458.82081985474
        },
        {
          "worker_id": 3,
          "query_id": "q60",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), ss AS (SELECT i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_items ON ss_item_sk = i_item_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_customer_address ON ss_addr_sk = ca_address_sk GROUP BY i_item_id), ws AS (SELECT i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_items ON ws_item_sk = i_item_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_customer_address ON ws_bill_addr_sk = ca_address_sk GROUP BY i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales JOIN filtered_items ON cs_item_sk = i_item_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_customer_address ON cs_bill_addr_sk = ca_address_sk GROUP BY i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100",
          "prompt_tokens": 3383,
          "response_tokens": 864,
          "llm_time_ms": 157827.75497436523
        },
        {
          "worker_id": 4,
          "query_id": "q60",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), filtered_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), ss AS (SELECT i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_address ON ss_addr_sk = ca_address_sk JOIN filtered_items ON ss_item_sk = i_item_sk GROUP BY i_item_id), ws AS (SELECT i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_address ON ws_bill_addr_sk = ca_address_sk JOIN filtered_items ON ws_item_sk = i_item_sk GROUP BY i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_address ON cs_bill_addr_sk = ca_address_sk JOIN filtered_items ON cs_item_sk = i_item_sk GROUP BY i_item_id)\nSELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100",
          "prompt_tokens": 4436,
          "response_tokens": 817,
          "llm_time_ms": 227183.88509750366
        }
      ],
      "original_speedup": 1.02,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061909"
    },
    {
      "query_id": "q13",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q13",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), branch1 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') AND ss_net_profit BETWEEN 100 AND 200), branch2 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') AND ss_net_profit BETWEEN 150 AND 300), branch3 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3 AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') AND ss_net_profit BETWEEN 50 AND 250), branch4 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') AND ss_net_profit BETWEEN 100 AND 200), branch5 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') AND ss_net_profit BETWEEN 150 AND 300), branch6 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') AND ss_net_profit BETWEEN 50 AND 250), branch7 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') AND ss_net_profit BETWEEN 100 AND 200), branch8 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') AND ss_net_profit BETWEEN 150 AND 300), branch9 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1 AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') AND ss_net_profit BETWEEN 50 AND 250), combined_sales AS (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2 UNION ALL SELECT * FROM branch3 UNION ALL SELECT * FROM branch4 UNION ALL SELECT * FROM branch5 UNION ALL SELECT * FROM branch6 UNION ALL SELECT * FROM branch7 UNION ALL SELECT * FROM branch8 UNION ALL SELECT * FROM branch9)\nSELECT AVG(ss_quantity) AS avg1, AVG(ss_ext_sales_price) AS avg2, AVG(ss_ext_wholesale_cost) AS avg3, SUM(ss_ext_wholesale_cost) FROM combined_sales",
          "prompt_tokens": 4183,
          "response_tokens": 1848,
          "llm_time_ms": 233904.88028526306
        },
        {
          "worker_id": 2,
          "query_id": "q13",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), filtered_store_sales AS (SELECT ss_store_sk, ss_hdemo_sk, ss_cdemo_sk, ss_addr_sk, ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_sales_price, ss_net_profit FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk)\nSELECT AVG(ss_quantity) AS avg1, AVG(ss_ext_sales_price) AS avg2, AVG(ss_ext_wholesale_cost) AS avg3, SUM(ss_ext_wholesale_cost) FROM filtered_store_sales AS fss, store, customer_demographics, household_demographics, customer_address WHERE s_store_sk = fss.ss_store_sk AND ((fss.ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = fss.ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' AND fss.ss_sales_price BETWEEN 100.00 AND 150.00 AND hd_dep_count = 3) OR (fss.ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = fss.ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' AND fss.ss_sales_price BETWEEN 50.00 AND 100.00 AND hd_dep_count = 1) OR (fss.ss_hdemo_sk = hd_demo_sk AND cd_demo_sk = fss.ss_cdemo_sk AND cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' AND fss.ss_sales_price BETWEEN 150.00 AND 200.00 AND hd_dep_count = 1)) AND ((fss.ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') AND fss.ss_net_profit BETWEEN 100 AND 200) OR (fss.ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') AND fss.ss_net_profit BETWEEN 150 AND 300) OR (fss.ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') AND fss.ss_net_profit BETWEEN 50 AND 250))",
          "prompt_tokens": 3113,
          "response_tokens": 2855,
          "llm_time_ms": 240215.86775779724
        },
        {
          "worker_id": 1,
          "query_id": "q13",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), store_sales_base AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_sales_price, ss_net_profit, ss_store_sk, ss_hdemo_sk, ss_cdemo_sk, ss_addr_sk FROM store_sales JOIN date_filtered ON ss_sold_date_sk = d_date_sk), branch_1 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 3 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 100 AND 200), branch_2 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 3 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 150 AND 300), branch_3 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 3 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 50 AND 250), branch_4 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 100 AND 200), branch_5 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 300), branch_6 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 50 AND 250), branch_7 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 100 AND 200), branch_8 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 150 AND 300), branch_9 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 250)\nSELECT (b1.sum_qty + b2.sum_qty + b3.sum_qty + b4.sum_qty + b5.sum_qty + b6.sum_qty + b7.sum_qty + b8.sum_qty + b9.sum_qty) / (b1.cnt + b2.cnt + b3.cnt + b4.cnt + b5.cnt + b6.cnt + b7.cnt + b8.cnt + b9.cnt) AS avg1, (b1.sum_sales + b2.sum_sales + b3.sum_sales + b4.sum_sales + b5.sum_sales + b6.sum_sales + b7.sum_sales + b8.sum_sales + b9.sum_sales) / (b1.cnt + b2.cnt + b3.cnt + b4.cnt + b5.cnt + b6.cnt + b7.cnt + b8.cnt + b9.cnt) AS avg2, (b1.sum_wholesale + b2.sum_wholesale + b3.sum_wholesale + b4.sum_wholesale + b5.sum_wholesale + b6.sum_wholesale + b7.sum_wholesale + b8.sum_wholesale + b9.sum_wholesale) / (b1.cnt + b2.cnt + b3.cnt + b4.cnt + b5.cnt + b6.cnt + b7.cnt + b8.cnt + b9.cnt) AS avg3, (b1.sum_wholesale + b2.sum_wholesale + b3.sum_wholesale + b4.sum_wholesale + b5.sum_wholesale + b6.sum_wholesale + b7.sum_wholesale + b8.sum_wholesale + b9.sum_wholesale) AS \"SUM(ss_ext_wholesale_cost)\" FROM branch_1 AS b1 CROSS JOIN branch_2 AS b2 CROSS JOIN branch_3 AS b3 CROSS JOIN branch_4 AS b4 CROSS JOIN branch_5 AS b5 CROSS JOIN branch_6 AS b6 CROSS JOIN branch_7 AS b7 CROSS JOIN branch_8 AS b8 CROSS JOIN branch_9 AS b9",
          "prompt_tokens": 2966,
          "response_tokens": 2103,
          "llm_time_ms": 296271.5151309967
        },
        {
          "worker_id": 3,
          "query_id": "q13",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE (cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree') OR (cd_marital_status = 'S' AND cd_education_status = 'College') OR (cd_marital_status = 'W' AND cd_education_status = '2 yr Degree')), filtered_household_demographics AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count IN (1, 3)), filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND (ca_state IN ('TX', 'OH', 'TX') OR ca_state IN ('OR', 'NM', 'KY') OR ca_state IN ('VA', 'TX', 'MS'))), branch1 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN filtered_customer_demographics AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN filtered_household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN filtered_customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN store AS s ON ss.ss_store_sk = s.s_store_sk WHERE cd.cd_marital_status = 'M' AND cd.cd_education_status = 'Advanced Degree' AND ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND hd.hd_dep_count = 3 AND ca.ca_state IN ('TX', 'OH', 'TX') AND ss.ss_net_profit BETWEEN 100 AND 200), branch2 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN filtered_customer_demographics AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN filtered_household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN filtered_customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN store AS s ON ss.ss_store_sk = s.s_store_sk WHERE cd.cd_marital_status = 'S' AND cd.cd_education_status = 'College' AND ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND hd.hd_dep_count = 1 AND ca.ca_state IN ('OR', 'NM', 'KY') AND ss.ss_net_profit BETWEEN 150 AND 300), branch3 AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost FROM store_sales AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN filtered_customer_demographics AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN filtered_household_demographics AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN filtered_customer_address AS ca ON ss.ss_addr_sk = ca.ca_address_sk JOIN store AS s ON ss.ss_store_sk = s.s_store_sk WHERE cd.cd_marital_status = 'W' AND cd.cd_education_status = '2 yr Degree' AND ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND hd.hd_dep_count = 1 AND ca.ca_state IN ('VA', 'TX', 'MS') AND ss.ss_net_profit BETWEEN 50 AND 250)\nSELECT AVG(ss_quantity) AS avg1, AVG(ss_ext_sales_price) AS avg2, AVG(ss_ext_wholesale_cost) AS avg3, SUM(ss_ext_wholesale_cost) FROM (SELECT * FROM branch1 UNION ALL SELECT * FROM branch2 UNION ALL SELECT * FROM branch3) AS all_branches",
          "prompt_tokens": 3130,
          "response_tokens": 1763,
          "llm_time_ms": 299628.3085346222
        }
      ],
      "original_speedup": 1.01,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061914"
    },
    {
      "query_id": "q27",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q27",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), filtered_stores AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'TN'), filtered_customers AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), results AS (SELECT i_item_id, s_state, 0 AS g_state, ss_quantity AS agg1, ss_list_price AS agg2, ss_coupon_amt AS agg3, ss_sales_price AS agg4 FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN filtered_customers ON ss_cdemo_sk = cd_demo_sk JOIN item ON ss_item_sk = i_item_sk)\nSELECT i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 FROM (SELECT i_item_id, s_state, 0 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id, s_state UNION ALL SELECT i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id UNION ALL SELECT NULL AS i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results) AS foo ORDER BY i_item_id NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 3052,
          "response_tokens": 973,
          "llm_time_ms": 106859.28273200989
        },
        {
          "worker_id": 4,
          "query_id": "q27",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), results AS (SELECT i_item_id, s_state, 0 AS g_state, ss_quantity AS agg1, ss_list_price AS agg2, ss_coupon_amt AS agg3, ss_sales_price AS agg4 FROM store_sales, customer_demographics, filtered_dates, store, item WHERE ss_sold_date_sk = d_date_sk AND ss_item_sk = i_item_sk AND ss_store_sk = s_store_sk AND ss_cdemo_sk = cd_demo_sk AND cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College' AND s_state = 'TN')\nSELECT i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 FROM (SELECT i_item_id, s_state, 0 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id, s_state UNION ALL SELECT i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id UNION ALL SELECT NULL AS i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results) AS foo ORDER BY i_item_id NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 4104,
          "response_tokens": 890,
          "llm_time_ms": 143136.9206905365
        },
        {
          "worker_id": 2,
          "query_id": "q27",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), filtered_stores AS (SELECT s_store_sk, s_state FROM store WHERE s_state = 'TN'), results AS (SELECT i.i_item_id, s.s_state, 0 AS g_state, ss.ss_quantity AS agg1, ss.ss_list_price AS agg2, ss.ss_coupon_amt AS agg3, ss.ss_sales_price AS agg4 FROM store_sales AS ss JOIN filtered_customer_demographics AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN filtered_stores AS s ON ss.ss_store_sk = s.s_store_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk)\nSELECT i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 FROM (SELECT i_item_id, s_state, 0 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id, s_state UNION ALL SELECT i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id UNION ALL SELECT NULL AS i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results) AS foo ORDER BY i_item_id NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 3035,
          "response_tokens": 989,
          "llm_time_ms": 180698.04215431213
        },
        {
          "worker_id": 1,
          "query_id": "q27",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2002), filtered_store AS (SELECT s_store_sk FROM store WHERE s_state = 'TN'), filtered_cdemo AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_gender = 'M' AND cd_marital_status = 'S' AND cd_education_status = 'College'), filtered_sales AS (SELECT ss.ss_item_sk, ss.ss_store_sk, ss.ss_quantity, ss.ss_list_price, ss.ss_coupon_amt, ss.ss_sales_price FROM store_sales AS ss JOIN filtered_date AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN filtered_cdemo AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk), results AS (SELECT i.i_item_id, 'TN' AS s_state, 0 AS g_state, f.ss_quantity AS agg1, f.ss_list_price AS agg2, f.ss_coupon_amt AS agg3, f.ss_sales_price AS agg4 FROM filtered_sales AS f JOIN item AS i ON f.ss_item_sk = i.i_item_sk)\nSELECT i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 FROM (SELECT i_item_id, s_state, 0 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id, s_state UNION ALL SELECT i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results GROUP BY i_item_id UNION ALL SELECT NULL AS i_item_id, NULL AS s_state, 1 AS g_state, AVG(agg1) AS agg1, AVG(agg2) AS agg2, AVG(agg3) AS agg3, AVG(agg4) AS agg4 FROM results) AS foo ORDER BY i_item_id NULLS FIRST, s_state NULLS FIRST LIMIT 100",
          "prompt_tokens": 2888,
          "response_tokens": 563,
          "llm_time_ms": 188830.95240592957
        }
      ],
      "original_speedup": 1.01,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061916"
    },
    {
      "query_id": "q64",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q64",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (1999, 2000)), cs_ui AS (SELECT cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund FROM catalog_sales JOIN catalog_returns ON cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number GROUP BY cs_item_sk HAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)), cross_sales AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, fd.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales JOIN filtered_dates AS fd ON ss_sold_date_sk = fd.d_date_sk LEFT JOIN store_returns ON ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN cs_ui ON ss_item_sk = cs_ui.cs_item_sk JOIN date_dim AS d2 ON c_first_sales_date_sk = d2.d_date_sk JOIN date_dim AS d3 ON c_first_shipto_date_sk = d3.d_date_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_demographics AS cd1 ON ss_cdemo_sk = cd1.cd_demo_sk JOIN customer_demographics AS cd2 ON c_current_cdemo_sk = cd2.cd_demo_sk JOIN promotion ON ss_promo_sk = p_promo_sk JOIN household_demographics AS hd1 ON ss_hdemo_sk = hd1.hd_demo_sk JOIN household_demographics AS hd2 ON c_current_hdemo_sk = hd2.hd_demo_sk JOIN customer_address AS ad1 ON ss_addr_sk = ad1.ca_address_sk JOIN customer_address AS ad2 ON c_current_addr_sk = ad2.ca_address_sk JOIN income_band AS ib1 ON hd1.hd_income_band_sk = ib1.ib_income_band_sk JOIN income_band AS ib2 ON hd2.hd_income_band_sk = ib2.ib_income_band_sk JOIN item ON ss_item_sk = i_item_sk WHERE cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 74 AND i_current_price BETWEEN 65 AND 79 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, fd.d_year, d2.d_year, d3.d_year)\nSELECT cs1.product_name, cs1.store_name, cs1.store_zip, cs1.b_street_number, cs1.b_street_name, cs1.b_city, cs1.b_zip, cs1.c_street_number, cs1.c_street_name, cs1.c_city, cs1.c_zip, cs1.syear AS cs1syear, cs1.cnt AS cs1cnt, cs1.s1 AS s11, cs1.s2 AS s21, cs1.s3 AS s31, cs2.s1 AS s12, cs2.s2 AS s22, cs2.s3 AS s32, cs2.syear, cs2.cnt FROM cross_sales AS cs1, cross_sales AS cs2 WHERE cs1.item_sk = cs2.item_sk AND cs1.syear = 1999 AND cs2.syear = 1999 + 1 AND cs2.cnt <= cs1.cnt AND cs1.store_name = cs2.store_name AND cs1.store_zip = cs2.store_zip ORDER BY cs1.product_name, cs1.store_name, cs2.cnt, cs1.s1, cs2.s1",
          "prompt_tokens": 3959,
          "response_tokens": 952,
          "llm_time_ms": 124923.38967323303
        },
        {
          "worker_id": 3,
          "query_id": "q64",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d1 AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year IN (1999, 2000)), filtered_items AS (SELECT i_item_sk, i_product_name, i_current_price FROM item WHERE i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 74 AND i_current_price BETWEEN 65 AND 79), cs_ui_optimized AS (SELECT cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund FROM catalog_sales JOIN catalog_returns ON cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number GROUP BY cs_item_sk HAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics), filtered_household_demographics AS (SELECT hd_demo_sk, hd_income_band_sk FROM household_demographics), filtered_promotion AS (SELECT p_promo_sk FROM promotion), filtered_income_band AS (SELECT ib_income_band_sk FROM income_band), cross_sales_optimized AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales JOIN filtered_d1 AS d1 ON ss_sold_date_sk = d1.d_date_sk JOIN store ON ss_store_sk = s_store_sk JOIN filtered_items ON ss_item_sk = i_item_sk JOIN store_returns ON ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN cs_ui_optimized ON ss_item_sk = cs_ui_optimized.cs_item_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_demographics AS cd1 ON ss_cdemo_sk = cd1.cd_demo_sk JOIN customer_demographics AS cd2 ON c_current_cdemo_sk = cd2.cd_demo_sk JOIN household_demographics AS hd1 ON ss_hdemo_sk = hd1.hd_demo_sk JOIN household_demographics AS hd2 ON c_current_hdemo_sk = hd2.hd_demo_sk JOIN customer_address AS ad1 ON ss_addr_sk = ad1.ca_address_sk JOIN customer_address AS ad2 ON c_current_addr_sk = ad2.ca_address_sk JOIN date_dim AS d2 ON c_first_sales_date_sk = d2.d_date_sk JOIN date_dim AS d3 ON c_first_shipto_date_sk = d3.d_date_sk JOIN filtered_promotion ON ss_promo_sk = p_promo_sk JOIN filtered_income_band AS ib1 ON hd1.hd_income_band_sk = ib1.ib_income_band_sk JOIN filtered_income_band AS ib2 ON hd2.hd_income_band_sk = ib2.ib_income_band_sk WHERE cd1.cd_marital_status <> cd2.cd_marital_status GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year), cs_ui AS (SELECT cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number GROUP BY cs_item_sk HAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)), cross_sales AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales, store_returns, cs_ui, date_dim AS d1, date_dim AS d2, date_dim AS d3, store, customer, customer_demographics AS cd1, customer_demographics AS cd2, promotion, household_demographics AS hd1, household_demographics AS hd2, customer_address AS ad1, customer_address AS ad2, income_band AS ib1, income_band AS ib2, item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk = cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk AND ss_item_sk = i_item_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND ss_item_sk = cs_ui.cs_item_sk AND c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk AND c_first_sales_date_sk = d2.d_date_sk AND c_first_shipto_date_sk = d3.d_date_sk AND ss_promo_sk = p_promo_sk AND hd1.hd_income_band_sk = ib1.ib_income_band_sk AND hd2.hd_income_band_sk = ib2.ib_income_band_sk AND cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year)\nSELECT cs1.product_name, cs1.store_name, cs1.store_zip, cs1.b_street_number, cs1.b_street_name, cs1.b_city, cs1.b_zip, cs1.c_street_number, cs1.c_street_name, cs1.c_city, cs1.c_zip, cs1.syear AS cs1syear, cs1.cnt AS cs1cnt, cs1.s1 AS s11, cs1.s2 AS s21, cs1.s3 AS s31, cs2.s1 AS s12, cs2.s2 AS s22, cs2.s3 AS s32, cs2.syear, cs2.cnt FROM cross_sales AS cs1, cross_sales AS cs2 WHERE cs1.item_sk = cs2.item_sk AND cs1.syear = 1999 AND cs2.syear = 1999 + 1 AND cs2.cnt <= cs1.cnt AND cs1.store_name = cs2.store_name AND cs1.store_zip = cs2.store_zip ORDER BY cs1.product_name, cs1.store_name, cs2.cnt, cs1.s1, cs2.s1",
          "prompt_tokens": 4123,
          "response_tokens": 1208,
          "llm_time_ms": 157356.9061756134
        },
        {
          "worker_id": 2,
          "query_id": "q64",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH cs_ui AS (SELECT cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number GROUP BY cs_item_sk HAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)), cross_sales_1999 AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales, store_returns, cs_ui, date_dim AS d1, date_dim AS d2, date_dim AS d3, store, customer, customer_demographics AS cd1, customer_demographics AS cd2, promotion, household_demographics AS hd1, household_demographics AS hd2, customer_address AS ad1, customer_address AS ad2, income_band AS ib1, income_band AS ib2, item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk = cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk AND ss_item_sk = i_item_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND ss_item_sk = cs_ui.cs_item_sk AND c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk AND c_first_sales_date_sk = d2.d_date_sk AND c_first_shipto_date_sk = d3.d_date_sk AND ss_promo_sk = p_promo_sk AND hd1.hd_income_band_sk = ib1.ib_income_band_sk AND hd2.hd_income_band_sk = ib2.ib_income_band_sk AND cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 AND d1.d_year = 1999 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year), cross_sales_2000 AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales, store_returns, cs_ui, date_dim AS d1, date_dim AS d2, date_dim AS d3, store, customer, customer_demographics AS cd1, customer_demographics AS cd2, promotion, household_demographics AS hd1, household_demographics AS hd2, customer_address AS ad1, customer_address AS ad2, income_band AS ib1, income_band AS ib2, item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk = cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk AND ss_item_sk = i_item_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND ss_item_sk = cs_ui.cs_item_sk AND c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk AND c_first_sales_date_sk = d2.d_date_sk AND c_first_shipto_date_sk = d3.d_date_sk AND ss_promo_sk = p_promo_sk AND hd1.hd_income_band_sk = ib1.ib_income_band_sk AND hd2.hd_income_band_sk = ib2.ib_income_band_sk AND cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 AND d1.d_year = 2000 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year), cross_sales AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales, store_returns, cs_ui, date_dim AS d1, date_dim AS d2, date_dim AS d3, store, customer, customer_demographics AS cd1, customer_demographics AS cd2, promotion, household_demographics AS hd1, household_demographics AS hd2, customer_address AS ad1, customer_address AS ad2, income_band AS ib1, income_band AS ib2, item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk = cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk AND ss_item_sk = i_item_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND ss_item_sk = cs_ui.cs_item_sk AND c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk AND c_first_sales_date_sk = d2.d_date_sk AND c_first_shipto_date_sk = d3.d_date_sk AND ss_promo_sk = p_promo_sk AND hd1.hd_income_band_sk = ib1.ib_income_band_sk AND hd2.hd_income_band_sk = ib2.ib_income_band_sk AND cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year)\nSELECT cs1.product_name, cs1.store_name, cs1.store_zip, cs1.b_street_number, cs1.b_street_name, cs1.b_city, cs1.b_zip, cs1.c_street_number, cs1.c_street_name, cs1.c_city, cs1.c_zip, cs1.syear AS cs1syear, cs1.cnt AS cs1cnt, cs1.s1 AS s11, cs1.s2 AS s21, cs1.s3 AS s31, cs2.s1 AS s12, cs2.s2 AS s22, cs2.s3 AS s32, cs2.syear, cs2.cnt FROM cross_sales_1999 AS cs1, cross_sales_2000 AS cs2 WHERE cs1.item_sk = cs2.item_sk AND cs2.cnt <= cs1.cnt AND cs1.store_name = cs2.store_name AND cs1.store_zip = cs2.store_zip ORDER BY cs1.product_name, cs1.store_name, cs2.cnt, cs1.s1, cs2.s1",
          "prompt_tokens": 4110,
          "response_tokens": 1319,
          "llm_time_ms": 205641.87479019165
        },
        {
          "worker_id": 4,
          "query_id": "q64",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_1999 AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 1999), filtered_dates_2000 AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000), filtered_dates_general AS (SELECT d_date_sk, d_year FROM date_dim), cs_ui AS (SELECT cs_item_sk, SUM(cs_ext_list_price) AS sale, SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit) AS refund FROM catalog_sales, catalog_returns WHERE cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number GROUP BY cs_item_sk HAVING SUM(cs_ext_list_price) > 2 * SUM(cr_refunded_cash + cr_reversed_charge + cr_store_credit)), cross_sales_1999 AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales JOIN filtered_dates_1999 AS d1 ON ss_sold_date_sk = d1.d_date_sk JOIN store_returns ON ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN cs_ui ON ss_item_sk = cs_ui.cs_item_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_demographics AS cd1 ON ss_cdemo_sk = cd1.cd_demo_sk JOIN customer_demographics AS cd2 ON c_current_cdemo_sk = cd2.cd_demo_sk JOIN promotion ON ss_promo_sk = p_promo_sk JOIN household_demographics AS hd1 ON ss_hdemo_sk = hd1.hd_demo_sk JOIN household_demographics AS hd2 ON c_current_hdemo_sk = hd2.hd_demo_sk JOIN customer_address AS ad1 ON ss_addr_sk = ad1.ca_address_sk JOIN customer_address AS ad2 ON c_current_addr_sk = ad2.ca_address_sk JOIN income_band AS ib1 ON hd1.hd_income_band_sk = ib1.ib_income_band_sk JOIN income_band AS ib2 ON hd2.hd_income_band_sk = ib2.ib_income_band_sk JOIN item ON ss_item_sk = i_item_sk JOIN filtered_dates_general AS d2 ON c_first_sales_date_sk = d2.d_date_sk JOIN filtered_dates_general AS d3 ON c_first_shipto_date_sk = d3.d_date_sk WHERE cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year), cross_sales_2000 AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales JOIN filtered_dates_2000 AS d1 ON ss_sold_date_sk = d1.d_date_sk JOIN store_returns ON ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN cs_ui ON ss_item_sk = cs_ui.cs_item_sk JOIN store ON ss_store_sk = s_store_sk JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_demographics AS cd1 ON ss_cdemo_sk = cd1.cd_demo_sk JOIN customer_demographics AS cd2 ON c_current_cdemo_sk = cd2.cd_demo_sk JOIN promotion ON ss_promo_sk = p_promo_sk JOIN household_demographics AS hd1 ON ss_hdemo_sk = hd1.hd_demo_sk JOIN household_demographics AS hd2 ON c_current_hdemo_sk = hd2.hd_demo_sk JOIN customer_address AS ad1 ON ss_addr_sk = ad1.ca_address_sk JOIN customer_address AS ad2 ON c_current_addr_sk = ad2.ca_address_sk JOIN income_band AS ib1 ON hd1.hd_income_band_sk = ib1.ib_income_band_sk JOIN income_band AS ib2 ON hd2.hd_income_band_sk = ib2.ib_income_band_sk JOIN item ON ss_item_sk = i_item_sk JOIN filtered_dates_general AS d2 ON c_first_sales_date_sk = d2.d_date_sk JOIN filtered_dates_general AS d3 ON c_first_shipto_date_sk = d3.d_date_sk WHERE cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year), cross_sales AS (SELECT i_product_name AS product_name, i_item_sk AS item_sk, s_store_name AS store_name, s_zip AS store_zip, ad1.ca_street_number AS b_street_number, ad1.ca_street_name AS b_street_name, ad1.ca_city AS b_city, ad1.ca_zip AS b_zip, ad2.ca_street_number AS c_street_number, ad2.ca_street_name AS c_street_name, ad2.ca_city AS c_city, ad2.ca_zip AS c_zip, d1.d_year AS syear, d2.d_year AS fsyear, d3.d_year AS s2year, COUNT(*) AS cnt, SUM(ss_wholesale_cost) AS s1, SUM(ss_list_price) AS s2, SUM(ss_coupon_amt) AS s3 FROM store_sales, store_returns, cs_ui, date_dim AS d1, date_dim AS d2, date_dim AS d3, store, customer, customer_demographics AS cd1, customer_demographics AS cd2, promotion, household_demographics AS hd1, household_demographics AS hd2, customer_address AS ad1, customer_address AS ad2, income_band AS ib1, income_band AS ib2, item WHERE ss_store_sk = s_store_sk AND ss_sold_date_sk = d1.d_date_sk AND ss_customer_sk = c_customer_sk AND ss_cdemo_sk = cd1.cd_demo_sk AND ss_hdemo_sk = hd1.hd_demo_sk AND ss_addr_sk = ad1.ca_address_sk AND ss_item_sk = i_item_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number AND ss_item_sk = cs_ui.cs_item_sk AND c_current_cdemo_sk = cd2.cd_demo_sk AND c_current_hdemo_sk = hd2.hd_demo_sk AND c_current_addr_sk = ad2.ca_address_sk AND c_first_sales_date_sk = d2.d_date_sk AND c_first_shipto_date_sk = d3.d_date_sk AND ss_promo_sk = p_promo_sk AND hd1.hd_income_band_sk = ib1.ib_income_band_sk AND hd2.hd_income_band_sk = ib2.ib_income_band_sk AND cd1.cd_marital_status <> cd2.cd_marital_status AND i_color IN ('purple', 'burlywood', 'indian', 'spring', 'floral', 'medium') AND i_current_price BETWEEN 64 AND 64 + 10 AND i_current_price BETWEEN 64 + 1 AND 64 + 15 GROUP BY i_product_name, i_item_sk, s_store_name, s_zip, ad1.ca_street_number, ad1.ca_street_name, ad1.ca_city, ad1.ca_zip, ad2.ca_street_number, ad2.ca_street_name, ad2.ca_city, ad2.ca_zip, d1.d_year, d2.d_year, d3.d_year)\nSELECT cs1.product_name, cs1.store_name, cs1.store_zip, cs1.b_street_number, cs1.b_street_name, cs1.b_city, cs1.b_zip, cs1.c_street_number, cs1.c_street_name, cs1.c_city, cs1.c_zip, cs1.syear AS cs1syear, cs1.cnt AS cs1cnt, cs1.s1 AS s11, cs1.s2 AS s21, cs1.s3 AS s31, cs2.s1 AS s12, cs2.s2 AS s22, cs2.s3 AS s32, cs2.syear, cs2.cnt FROM cross_sales_1999 AS cs1, cross_sales_2000 AS cs2 WHERE cs1.item_sk = cs2.item_sk AND cs2.cnt <= cs1.cnt AND cs1.store_name = cs2.store_name AND cs1.store_zip = cs2.store_zip ORDER BY cs1.product_name, cs1.store_name, cs2.cnt, cs1.s1, cs2.s1",
          "prompt_tokens": 5175,
          "response_tokens": 2724,
          "llm_time_ms": 312294.64769363403
        }
      ],
      "original_speedup": 1.01,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061919"
    },
    {
      "query_id": "q77",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q77",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)), ss AS (SELECT s_store_sk, SUM(ss_ext_sales_price) AS sales, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk GROUP BY s_store_sk), sr AS (SELECT s_store_sk, SUM(sr_return_amt) AS returns_, SUM(sr_net_loss) AS profit_loss FROM store_returns JOIN filtered_dates ON sr_returned_date_sk = d_date_sk JOIN store ON sr_store_sk = s_store_sk GROUP BY s_store_sk), cs AS (SELECT cs_call_center_sk, SUM(cs_ext_sales_price) AS sales, SUM(cs_net_profit) AS profit FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) GROUP BY cs_call_center_sk), cr AS (SELECT cr_call_center_sk, SUM(cr_return_amount) AS returns_, SUM(cr_net_loss) AS profit_loss FROM catalog_returns, date_dim WHERE cr_returned_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) GROUP BY cr_call_center_sk), ws AS (SELECT wp_web_page_sk, SUM(ws_ext_sales_price) AS sales, SUM(ws_net_profit) AS profit FROM web_sales, date_dim, web_page WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) AND ws_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk), wr AS (SELECT wp_web_page_sk, SUM(wr_return_amt) AS returns_, SUM(wr_net_loss) AS profit_loss FROM web_returns, date_dim, web_page WHERE wr_returned_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) AND wr_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, ss.s_store_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel, cs_call_center_sk AS id, sales, returns_, (profit - profit_loss) AS profit FROM cs, cr UNION ALL SELECT 'web channel' AS channel, ws.wp_web_page_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST, returns_ DESC LIMIT 100",
          "prompt_tokens": 3758,
          "response_tokens": 504,
          "llm_time_ms": 64569.056034088135
        },
        {
          "worker_id": 4,
          "query_id": "q77",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)), ss AS (SELECT s_store_sk, SUM(ss_ext_sales_price) AS sales, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk GROUP BY s_store_sk), sr AS (SELECT s_store_sk, SUM(sr_return_amt) AS returns_, SUM(sr_net_loss) AS profit_loss FROM store_returns JOIN filtered_dates ON sr_returned_date_sk = d_date_sk JOIN store ON sr_store_sk = s_store_sk GROUP BY s_store_sk), cs AS (SELECT cs_call_center_sk, SUM(cs_ext_sales_price) AS sales, SUM(cs_net_profit) AS profit FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) GROUP BY cs_call_center_sk), cr AS (SELECT cr_call_center_sk, SUM(cr_return_amount) AS returns_, SUM(cr_net_loss) AS profit_loss FROM catalog_returns, date_dim WHERE cr_returned_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) GROUP BY cr_call_center_sk), ws AS (SELECT wp_web_page_sk, SUM(ws_ext_sales_price) AS sales, SUM(ws_net_profit) AS profit FROM web_sales, date_dim, web_page WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) AND ws_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk), wr AS (SELECT wp_web_page_sk, SUM(wr_return_amt) AS returns_, SUM(wr_net_loss) AS profit_loss FROM web_returns, date_dim, web_page WHERE wr_returned_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) AND wr_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, ss.s_store_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel, cs_call_center_sk AS id, sales, returns_, (profit - profit_loss) AS profit FROM cs, cr UNION ALL SELECT 'web channel' AS channel, ws.wp_web_page_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST, returns_ DESC LIMIT 100",
          "prompt_tokens": 4972,
          "response_tokens": 533,
          "llm_time_ms": 127770.55191993713
        },
        {
          "worker_id": 3,
          "query_id": "q77",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)), ss AS (SELECT s_store_sk, SUM(ss_ext_sales_price) AS sales, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk GROUP BY s_store_sk), sr AS (SELECT s_store_sk, SUM(sr_return_amt) AS returns_, SUM(sr_net_loss) AS profit_loss FROM store_returns JOIN filtered_dates ON sr_returned_date_sk = d_date_sk JOIN store ON sr_store_sk = s_store_sk GROUP BY s_store_sk), cs AS (SELECT cs_call_center_sk, SUM(cs_ext_sales_price) AS sales, SUM(cs_net_profit) AS profit FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) GROUP BY cs_call_center_sk), cr AS (SELECT cr_call_center_sk, SUM(cr_return_amount) AS returns_, SUM(cr_net_loss) AS profit_loss FROM catalog_returns, date_dim WHERE cr_returned_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) GROUP BY cr_call_center_sk), ws AS (SELECT wp_web_page_sk, SUM(ws_ext_sales_price) AS sales, SUM(ws_net_profit) AS profit FROM web_sales, date_dim, web_page WHERE ws_sold_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) AND ws_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk), wr AS (SELECT wp_web_page_sk, SUM(wr_return_amt) AS returns_, SUM(wr_net_loss) AS profit_loss FROM web_returns, date_dim, web_page WHERE wr_returned_date_sk = d_date_sk AND d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE) AND wr_web_page_sk = wp_web_page_sk GROUP BY wp_web_page_sk)\nSELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, ss.s_store_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel, cs_call_center_sk AS id, sales, returns_, (profit - profit_loss) AS profit FROM cs, cr UNION ALL SELECT 'web channel' AS channel, ws.wp_web_page_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST, returns_ DESC LIMIT 100",
          "prompt_tokens": 3922,
          "response_tokens": 531,
          "llm_time_ms": 141891.02292060852
        },
        {
          "worker_id": 2,
          "query_id": "q77",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)), ss AS (SELECT s_store_sk, SUM(ss_ext_sales_price) AS sales, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN store ON store_sales.ss_store_sk = store.s_store_sk GROUP BY s_store_sk), sr AS (SELECT s_store_sk, SUM(sr_return_amt) AS returns_, SUM(sr_net_loss) AS profit_loss FROM store_returns JOIN filtered_dates ON store_returns.sr_returned_date_sk = filtered_dates.d_date_sk JOIN store ON store_returns.sr_store_sk = store.s_store_sk GROUP BY s_store_sk) SELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, ss.s_store_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel, cs_call_center_sk AS id, sales, returns_, (profit - profit_loss) AS profit FROM cs, cr UNION ALL SELECT 'web channel' AS channel, ws.wp_web_page_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST, returns_ DESC LIMIT 100",
          "prompt_tokens": 3902,
          "response_tokens": 1076,
          "llm_time_ms": 236898.60558509827
        }
      ],
      "original_speedup": 1.01,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061921"
    },
    {
      "query_id": "q78",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q78",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000), filtered_ss AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, SUM(ss_quantity) AS ss_qty, SUM(ss_wholesale_cost) AS ss_wc, SUM(ss_sales_price) AS ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk JOIN filtered_dates ON ss_sold_date_sk = filtered_dates.d_date_sk WHERE sr_ticket_number IS NULL GROUP BY d_year, ss_item_sk, ss_customer_sk), filtered_ws AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk AS ws_customer_sk, SUM(ws_quantity) AS ws_qty, SUM(ws_wholesale_cost) AS ws_wc, SUM(ws_sales_price) AS ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk JOIN filtered_dates ON ws_sold_date_sk = filtered_dates.d_date_sk WHERE wr_order_number IS NULL GROUP BY d_year, ws_item_sk, ws_bill_customer_sk), filtered_cs AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk AS cs_customer_sk, SUM(cs_quantity) AS cs_qty, SUM(cs_wholesale_cost) AS cs_wc, SUM(cs_sales_price) AS cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk JOIN filtered_dates ON cs_sold_date_sk = filtered_dates.d_date_sk WHERE cr_order_number IS NULL GROUP BY d_year, cs_item_sk, cs_bill_customer_sk), ws AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk AS ws_customer_sk, SUM(ws_quantity) AS ws_qty, SUM(ws_wholesale_cost) AS ws_wc, SUM(ws_sales_price) AS ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL GROUP BY d_year, ws_item_sk, ws_bill_customer_sk), cs AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk AS cs_customer_sk, SUM(cs_quantity) AS cs_qty, SUM(cs_wholesale_cost) AS cs_wc, SUM(cs_sales_price) AS cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL GROUP BY d_year, cs_item_sk, cs_bill_customer_sk), ss AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, SUM(ss_quantity) AS ss_qty, SUM(ss_wholesale_cost) AS ss_wc, SUM(ss_sales_price) AS ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL GROUP BY d_year, ss_item_sk, ss_customer_sk)\nSELECT ss_sold_year, ss_item_sk, ss_customer_sk, ROUND((ss_qty * 1.00) / (COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0)), 2) AS ratio, ss_qty AS store_qty, ss_wc AS store_wholesale_cost, ss_sp AS store_sales_price, COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0) AS other_chan_qty, COALESCE(ws_wc, 0) + COALESCE(cs_wc, 0) AS other_chan_wholesale_cost, COALESCE(ws_sp, 0) + COALESCE(cs_sp, 0) AS other_chan_sales_price FROM filtered_ss LEFT JOIN filtered_ws ON (ws_sold_year = ss_sold_year AND ws_item_sk = ss_item_sk AND ws_customer_sk = ss_customer_sk) LEFT JOIN filtered_cs ON (cs_sold_year = ss_sold_year AND cs_item_sk = ss_item_sk AND cs_customer_sk = ss_customer_sk) WHERE (COALESCE(ws_qty, 0) > 0 OR COALESCE(cs_qty, 0) > 0) ORDER BY ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty DESC, ss_wc DESC, ss_sp DESC, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio LIMIT 100",
          "prompt_tokens": 3954,
          "response_tokens": 760,
          "llm_time_ms": 136614.28141593933
        },
        {
          "worker_id": 1,
          "query_id": "q78",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_2000 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), ss AS (SELECT 2000 AS ss_sold_year, ss_item_sk, ss_customer_sk, SUM(ss_quantity) AS ss_qty, SUM(ss_wholesale_cost) AS ss_wc, SUM(ss_sales_price) AS ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk JOIN date_2000 ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL GROUP BY ss_item_sk, ss_customer_sk), ws AS (SELECT 2000 AS ws_sold_year, ws_item_sk, ws_bill_customer_sk AS ws_customer_sk, SUM(ws_quantity) AS ws_qty, SUM(ws_wholesale_cost) AS ws_wc, SUM(ws_sales_price) AS ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk JOIN date_2000 ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL GROUP BY ws_item_sk, ws_bill_customer_sk), cs AS (SELECT 2000 AS cs_sold_year, cs_item_sk, cs_bill_customer_sk AS cs_customer_sk, SUM(cs_quantity) AS cs_qty, SUM(cs_wholesale_cost) AS cs_wc, SUM(cs_sales_price) AS cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk JOIN date_2000 ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL GROUP BY cs_item_sk, cs_bill_customer_sk)\nSELECT ss_sold_year, ss_item_sk, ss_customer_sk, ROUND((ss_qty * 1.00) / (COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0)), 2) AS ratio, ss_qty AS store_qty, ss_wc AS store_wholesale_cost, ss_sp AS store_sales_price, COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0) AS other_chan_qty, COALESCE(ws_wc, 0) + COALESCE(cs_wc, 0) AS other_chan_wholesale_cost, COALESCE(ws_sp, 0) + COALESCE(cs_sp, 0) AS other_chan_sales_price FROM ss LEFT JOIN ws ON (ws_item_sk = ss_item_sk AND ws_customer_sk = ss_customer_sk) LEFT JOIN cs ON (cs_item_sk = ss_item_sk AND cs_customer_sk = ss_customer_sk) WHERE (COALESCE(ws_qty, 0) > 0 OR COALESCE(cs_qty, 0) > 0) ORDER BY ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty DESC, ss_wc DESC, ss_sp DESC, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio LIMIT 100",
          "prompt_tokens": 3808,
          "response_tokens": 1506,
          "llm_time_ms": 173696.78711891174
        },
        {
          "worker_id": 3,
          "query_id": "q78",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000), ss AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, SUM(ss_quantity) AS ss_qty, SUM(ss_wholesale_cost) AS ss_wc, SUM(ss_sales_price) AS ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL GROUP BY d_year, ss_item_sk, ss_customer_sk), ws AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk AS ws_customer_sk, SUM(ws_quantity) AS ws_qty, SUM(ws_wholesale_cost) AS ws_wc, SUM(ws_sales_price) AS ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL GROUP BY d_year, ws_item_sk, ws_bill_customer_sk), cs AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk AS cs_customer_sk, SUM(cs_quantity) AS cs_qty, SUM(cs_wholesale_cost) AS cs_wc, SUM(cs_sales_price) AS cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL GROUP BY d_year, cs_item_sk, cs_bill_customer_sk)\nSELECT ss_sold_year, ss_item_sk, ss_customer_sk, ROUND((ss_qty * 1.00) / (COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0)), 2) AS ratio, ss_qty AS store_qty, ss_wc AS store_wholesale_cost, ss_sp AS store_sales_price, COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0) AS other_chan_qty, COALESCE(ws_wc, 0) + COALESCE(cs_wc, 0) AS other_chan_wholesale_cost, COALESCE(ws_sp, 0) + COALESCE(cs_sp, 0) AS other_chan_sales_price FROM ss LEFT JOIN ws ON (ws_sold_year = ss_sold_year AND ws_item_sk = ss_item_sk AND ws_customer_sk = ss_customer_sk) LEFT JOIN cs ON (cs_sold_year = ss_sold_year AND cs_item_sk = ss_item_sk AND cs_customer_sk = ss_customer_sk) WHERE (COALESCE(ws_qty, 0) > 0 OR COALESCE(cs_qty, 0) > 0) ORDER BY ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty DESC, ss_wc DESC, ss_sp DESC, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio LIMIT 100",
          "prompt_tokens": 3971,
          "response_tokens": 1276,
          "llm_time_ms": 208288.82455825806
        },
        {
          "worker_id": 4,
          "query_id": "q78",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH ss_filtered AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, SUM(ss_quantity) AS ss_qty, SUM(ss_wholesale_cost) AS ss_wc, SUM(ss_sales_price) AS ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL AND d_year = 2000 GROUP BY d_year, ss_item_sk, ss_customer_sk), ws_filtered AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk AS ws_customer_sk, SUM(ws_quantity) AS ws_qty, SUM(ws_wholesale_cost) AS ws_wc, SUM(ws_sales_price) AS ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL AND d_year = 2000 GROUP BY d_year, ws_item_sk, ws_bill_customer_sk), cs_filtered AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk AS cs_customer_sk, SUM(cs_quantity) AS cs_qty, SUM(cs_wholesale_cost) AS cs_wc, SUM(cs_sales_price) AS cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL AND d_year = 2000 GROUP BY d_year, cs_item_sk, cs_bill_customer_sk), ws AS (SELECT d_year AS ws_sold_year, ws_item_sk, ws_bill_customer_sk AS ws_customer_sk, SUM(ws_quantity) AS ws_qty, SUM(ws_wholesale_cost) AS ws_wc, SUM(ws_sales_price) AS ws_sp FROM web_sales LEFT JOIN web_returns ON wr_order_number = ws_order_number AND ws_item_sk = wr_item_sk JOIN date_dim ON ws_sold_date_sk = d_date_sk WHERE wr_order_number IS NULL GROUP BY d_year, ws_item_sk, ws_bill_customer_sk), cs AS (SELECT d_year AS cs_sold_year, cs_item_sk, cs_bill_customer_sk AS cs_customer_sk, SUM(cs_quantity) AS cs_qty, SUM(cs_wholesale_cost) AS cs_wc, SUM(cs_sales_price) AS cs_sp FROM catalog_sales LEFT JOIN catalog_returns ON cr_order_number = cs_order_number AND cs_item_sk = cr_item_sk JOIN date_dim ON cs_sold_date_sk = d_date_sk WHERE cr_order_number IS NULL GROUP BY d_year, cs_item_sk, cs_bill_customer_sk), ss AS (SELECT d_year AS ss_sold_year, ss_item_sk, ss_customer_sk, SUM(ss_quantity) AS ss_qty, SUM(ss_wholesale_cost) AS ss_wc, SUM(ss_sales_price) AS ss_sp FROM store_sales LEFT JOIN store_returns ON sr_ticket_number = ss_ticket_number AND ss_item_sk = sr_item_sk JOIN date_dim ON ss_sold_date_sk = d_date_sk WHERE sr_ticket_number IS NULL GROUP BY d_year, ss_item_sk, ss_customer_sk)\nSELECT ss_sold_year, ss_item_sk, ss_customer_sk, ROUND((ss_qty * 1.00) / (COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0)), 2) AS ratio, ss_qty AS store_qty, ss_wc AS store_wholesale_cost, ss_sp AS store_sales_price, COALESCE(ws_qty, 0) + COALESCE(cs_qty, 0) AS other_chan_qty, COALESCE(ws_wc, 0) + COALESCE(cs_wc, 0) AS other_chan_wholesale_cost, COALESCE(ws_sp, 0) + COALESCE(cs_sp, 0) AS other_chan_sales_price FROM ss LEFT JOIN ws ON (ws_sold_year = ss_sold_year AND ws_item_sk = ss_item_sk AND ws_customer_sk = ss_customer_sk) LEFT JOIN cs ON (cs_sold_year = ss_sold_year AND cs_item_sk = ss_item_sk AND cs_customer_sk = ss_customer_sk) WHERE (COALESCE(ws_qty, 0) > 0 OR COALESCE(cs_qty, 0) > 0) AND ss_sold_year = 2000 ORDER BY ss_sold_year, ss_item_sk, ss_customer_sk, ss_qty DESC, ss_wc DESC, ss_sp DESC, other_chan_qty, other_chan_wholesale_cost, other_chan_sales_price, ratio LIMIT 100",
          "prompt_tokens": 5024,
          "response_tokens": 1007,
          "llm_time_ms": 249948.17519187927
        }
      ],
      "original_speedup": 1.01,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061924"
    },
    {
      "query_id": "q47",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q47",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1999 OR (d_year = 1998 AND d_moy = 12) OR (d_year = 2000 AND d_moy = 1)), v1 AS (SELECT i_category, i_brand, s_store_name, s_company_name, d_year, d_moy, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name ORDER BY d_year, d_moy) AS rn FROM item JOIN store_sales ON ss_item_sk = i_item_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk GROUP BY i_category, i_brand, s_store_name, s_company_name, d_year, d_moy), v2 AS (SELECT v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.s_store_name = v1_lag.s_store_name AND v1.s_store_name = v1_lead.s_store_name AND v1.s_company_name = v1_lag.s_company_name AND v1.s_company_name = v1_lead.s_company_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 LIMIT 100",
          "prompt_tokens": 3510,
          "response_tokens": 502,
          "llm_time_ms": 140953.0472755432
        },
        {
          "worker_id": 1,
          "query_id": "q47",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1999 UNION ALL SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1998 AND d_moy = 12 UNION ALL SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 2000 AND d_moy = 1), filtered_stores AS (SELECT s_store_sk, s_store_name, s_company_name FROM store), v1 AS (SELECT i_category, i_brand, s_store_name, s_company_name, d_year, d_moy, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name ORDER BY d_year, d_moy) AS rn FROM item JOIN store_sales ON ss_item_sk = i_item_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk GROUP BY i_category, i_brand, s_store_name, s_company_name, d_year, d_moy), v2 AS (SELECT v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.s_store_name = v1_lag.s_store_name AND v1.s_store_name = v1_lead.s_store_name AND v1.s_company_name = v1_lag.s_company_name AND v1.s_company_name = v1_lead.s_company_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 LIMIT 100",
          "prompt_tokens": 3347,
          "response_tokens": 1262,
          "llm_time_ms": 155242.9745197296
        },
        {
          "worker_id": 2,
          "query_id": "q47",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH dates_1999 AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1999), dates_1998_m12 AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1998 AND d_moy = 12), dates_2000_m1 AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 2000 AND d_moy = 1), filtered_store_sales_part1 AS (SELECT ss_item_sk, ss_store_sk, ss_sales_price, d_year, d_moy FROM store_sales JOIN dates_1999 ON ss_sold_date_sk = d_date_sk), filtered_store_sales_part2 AS (SELECT ss_item_sk, ss_store_sk, ss_sales_price, d_year, d_moy FROM store_sales JOIN dates_1998_m12 ON ss_sold_date_sk = d_date_sk), filtered_store_sales_part3 AS (SELECT ss_item_sk, ss_store_sk, ss_sales_price, d_year, d_moy FROM store_sales JOIN dates_2000_m1 ON ss_sold_date_sk = d_date_sk), filtered_store_sales AS (SELECT * FROM filtered_store_sales_part1 UNION ALL SELECT * FROM filtered_store_sales_part2 UNION ALL SELECT * FROM filtered_store_sales_part3), v1 AS (SELECT i.i_category, i.i_brand, s.s_store_name, s.s_company_name, fss.d_year, fss.d_moy, SUM(fss.ss_sales_price) AS sum_sales, AVG(SUM(fss.ss_sales_price)) OVER (PARTITION BY i.i_category, i.i_brand, s.s_store_name, s.s_company_name, fss.d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i.i_category, i.i_brand, s.s_store_name, s.s_company_name ORDER BY fss.d_year, fss.d_moy) AS rn FROM filtered_store_sales AS fss JOIN item AS i ON fss.ss_item_sk = i.i_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk GROUP BY i.i_category, i.i_brand, s.s_store_name, s.s_company_name, fss.d_year, fss.d_moy), v2 AS (SELECT v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.s_store_name = v1_lag.s_store_name AND v1.s_store_name = v1_lead.s_store_name AND v1.s_company_name = v1_lag.s_company_name AND v1.s_company_name = v1_lead.s_company_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 LIMIT 100",
          "prompt_tokens": 3494,
          "response_tokens": 1142,
          "llm_time_ms": 199244.21572685242
        },
        {
          "worker_id": 4,
          "query_id": "q47",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1999 UNION ALL SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 1998 AND d_moy = 12 UNION ALL SELECT d_date_sk, d_year, d_moy FROM date_dim WHERE d_year = 2000 AND d_moy = 1), v1 AS (SELECT i_category, i_brand, s_store_name, s_company_name, d_year, d_moy, SUM(ss_sales_price) AS sum_sales, AVG(SUM(ss_sales_price)) OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name, d_year) AS avg_monthly_sales, RANK() OVER (PARTITION BY i_category, i_brand, s_store_name, s_company_name ORDER BY d_year, d_moy) AS rn FROM item, store_sales, filtered_dates, store WHERE ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND ss_store_sk = s_store_sk GROUP BY i_category, i_brand, s_store_name, s_company_name, d_year, d_moy), v2 AS (SELECT v1.i_category, v1.i_brand, v1.s_store_name, v1.s_company_name, v1.d_year, v1.d_moy, v1.avg_monthly_sales, v1.sum_sales, v1_lag.sum_sales AS psum, v1_lead.sum_sales AS nsum FROM v1, v1 AS v1_lag, v1 AS v1_lead WHERE v1.i_category = v1_lag.i_category AND v1.i_category = v1_lead.i_category AND v1.i_brand = v1_lag.i_brand AND v1.i_brand = v1_lead.i_brand AND v1.s_store_name = v1_lag.s_store_name AND v1.s_store_name = v1_lead.s_store_name AND v1.s_company_name = v1_lag.s_company_name AND v1.s_company_name = v1_lead.s_company_name AND v1.rn = v1_lag.rn + 1 AND v1.rn = v1_lead.rn - 1)\nSELECT * FROM v2 WHERE d_year = 1999 AND avg_monthly_sales > 0 AND CASE WHEN avg_monthly_sales > 0 THEN ABS(sum_sales - avg_monthly_sales) / avg_monthly_sales ELSE NULL END > 0.1 ORDER BY sum_sales - avg_monthly_sales, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10 LIMIT 100",
          "prompt_tokens": 4560,
          "response_tokens": 1148,
          "llm_time_ms": 305159.1274738312
        }
      ],
      "original_speedup": 1.0,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061927"
    },
    {
      "query_id": "q48",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q48",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_stores AS (SELECT s_store_sk FROM store), branch_1 AS (SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') AND ss_net_profit BETWEEN 0 AND 2000), branch_2 AS (SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') AND ss_net_profit BETWEEN 150 AND 3000), branch_3 AS (SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') AND ss_net_profit BETWEEN 50 AND 25000)\nSELECT SUM(ss_quantity) FROM (SELECT * FROM branch_1 UNION ALL SELECT * FROM branch_2 UNION ALL SELECT * FROM branch_3) AS combined",
          "prompt_tokens": 3064,
          "response_tokens": 968,
          "llm_time_ms": 178634.39869880676
        },
        {
          "worker_id": 4,
          "query_id": "q48",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_stores AS (SELECT s_store_sk FROM store), union_branches AS (SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 50 AND 25000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 50 AND 25000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 25000)\nSELECT SUM(ss_quantity) FROM union_branches",
          "prompt_tokens": 4115,
          "response_tokens": 1453,
          "llm_time_ms": 247121.74654006958
        },
        {
          "worker_id": 1,
          "query_id": "q48",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), store_branch AS (SELECT ss_store_sk, ss_cdemo_sk, ss_addr_sk, ss_sold_date_sk, ss_quantity, ss_sales_price, ss_net_profit FROM store_sales), demographics_branch1 AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree'), demographics_branch2 AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree'), demographics_branch3 AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College'), address_branch1 AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX')), address_branch2 AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY')), address_branch3 AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS')), sales_branch_a1 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch1 AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch1 AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND ss.ss_net_profit BETWEEN 0 AND 2000), sales_branch_a2 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch1 AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch2 AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND ss.ss_net_profit BETWEEN 150 AND 3000), sales_branch_a3 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch1 AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch3 AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 100.00 AND 150.00 AND ss.ss_net_profit BETWEEN 50 AND 25000), sales_branch_b1 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch2 AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch1 AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND ss.ss_net_profit BETWEEN 0 AND 2000), sales_branch_b2 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch2 AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch2 AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND ss.ss_net_profit BETWEEN 150 AND 3000), sales_branch_b3 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch2 AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch3 AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 50.00 AND 100.00 AND ss.ss_net_profit BETWEEN 50 AND 25000), sales_branch_c1 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch3 AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch1 AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND ss.ss_net_profit BETWEEN 0 AND 2000), sales_branch_c2 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch3 AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch2 AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND ss.ss_net_profit BETWEEN 150 AND 3000), sales_branch_c3 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN demographics_branch3 AS cd ON ss.ss_cdemo_sk = cd.cd_demo_sk JOIN address_branch3 AS ca ON ss.ss_addr_sk = ca.ca_address_sk WHERE ss.ss_sales_price BETWEEN 150.00 AND 200.00 AND ss.ss_net_profit BETWEEN 50 AND 25000)\nSELECT SUM(quantity) FROM (SELECT quantity FROM sales_branch_a1 UNION ALL SELECT quantity FROM sales_branch_a2 UNION ALL SELECT quantity FROM sales_branch_a3 UNION ALL SELECT quantity FROM sales_branch_b1 UNION ALL SELECT quantity FROM sales_branch_b2 UNION ALL SELECT quantity FROM sales_branch_b3 UNION ALL SELECT quantity FROM sales_branch_c1 UNION ALL SELECT quantity FROM sales_branch_c2 UNION ALL SELECT quantity FROM sales_branch_c3) AS all_branches",
          "prompt_tokens": 2900,
          "response_tokens": 1394,
          "llm_time_ms": 246151.85403823853
        },
        {
          "worker_id": 2,
          "query_id": "q48",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_sales AS (SELECT ss_quantity, ss_sales_price, ss_net_profit, ss_cdemo_sk, ss_addr_sk, ss_store_sk FROM store_sales JOIN date_filter ON store_sales.ss_sold_date_sk = date_filter.d_date_sk)\nSELECT SUM(ss_quantity) FROM (SELECT ss_quantity FROM filtered_sales AS fs JOIN store ON store.s_store_sk = fs.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = fs.ss_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = fs.ss_addr_sk WHERE cd.cd_marital_status = 'M' AND cd.cd_education_status = '4 yr Degree' AND fs.ss_sales_price BETWEEN 100.00 AND 150.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('CO', 'OH', 'TX') AND fs.ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT ss_quantity FROM filtered_sales AS fs JOIN store ON store.s_store_sk = fs.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = fs.ss_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = fs.ss_addr_sk WHERE cd.cd_marital_status = 'M' AND cd.cd_education_status = '4 yr Degree' AND fs.ss_sales_price BETWEEN 100.00 AND 150.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('OR', 'MN', 'KY') AND fs.ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT ss_quantity FROM filtered_sales AS fs JOIN store ON store.s_store_sk = fs.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = fs.ss_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = fs.ss_addr_sk WHERE cd.cd_marital_status = 'M' AND cd.cd_education_status = '4 yr Degree' AND fs.ss_sales_price BETWEEN 100.00 AND 150.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('VA', 'CA', 'MS') AND fs.ss_net_profit BETWEEN 50 AND 25000 UNION ALL SELECT ss_quantity FROM filtered_sales AS fs JOIN store ON store.s_store_sk = fs.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = fs.ss_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = fs.ss_addr_sk WHERE cd.cd_marital_status = 'D' AND cd.cd_education_status = '2 yr Degree' AND fs.ss_sales_price BETWEEN 50.00 AND 100.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('CO', 'OH', 'TX') AND fs.ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT ss_quantity FROM filtered_sales AS fs JOIN store ON store.s_store_sk = fs.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = fs.ss_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = fs.ss_addr_sk WHERE cd.cd_marital_status = 'D' AND cd.cd_education_status = '2 yr Degree' AND fs.ss_sales_price BETWEEN 50.00 AND 100.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('OR', 'MN', 'KY') AND fs.ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT ss_quantity FROM filtered_sales AS fs JOIN store ON store.s_store_sk = fs.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = fs.ss_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = fs.ss_addr_sk WHERE cd.cd_marital_status = 'D' AND cd.cd_education_status = '2 yr Degree' AND fs.ss_sales_price BETWEEN 50.00 AND 100.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('VA', 'CA', 'MS') AND fs.ss_net_profit BETWEEN 50 AND 25000 UNION ALL SELECT ss_quantity FROM filtered_sales AS fs JOIN store ON store.s_store_sk = fs.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = fs.ss_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = fs.ss_addr_sk WHERE cd.cd_marital_status = 'S' AND cd.cd_education_status = 'College' AND fs.ss_sales_price BETWEEN 150.00 AND 200.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('CO', 'OH', 'TX') AND fs.ss_net_profit BETWEEN 0 AND 2000 UNION ALL SELECT ss_quantity FROM filtered_sales AS fs JOIN store ON store.s_store_sk = fs.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = fs.ss_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = fs.ss_addr_sk WHERE cd.cd_marital_status = 'S' AND cd.cd_education_status = 'College' AND fs.ss_sales_price BETWEEN 150.00 AND 200.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('OR', 'MN', 'KY') AND fs.ss_net_profit BETWEEN 150 AND 3000 UNION ALL SELECT ss_quantity FROM filtered_sales AS fs JOIN store ON store.s_store_sk = fs.ss_store_sk JOIN customer_demographics AS cd ON cd.cd_demo_sk = fs.ss_cdemo_sk JOIN customer_address AS ca ON ca.ca_address_sk = fs.ss_addr_sk WHERE cd.cd_marital_status = 'S' AND cd.cd_education_status = 'College' AND fs.ss_sales_price BETWEEN 150.00 AND 200.00 AND ca.ca_country = 'United States' AND ca.ca_state IN ('VA', 'CA', 'MS') AND fs.ss_net_profit BETWEEN 50 AND 25000) AS all_branches",
          "prompt_tokens": 3047,
          "response_tokens": 1345,
          "llm_time_ms": 270224.28154945374
        }
      ],
      "original_speedup": 1.0,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061929"
    },
    {
      "query_id": "q85",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q85",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_addresses AS (SELECT ca_address_sk, ca_country, ca_state FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('IN', 'OH', 'NJ', 'WI', 'CT', 'KY', 'LA', 'IA', 'AR'))\nSELECT SUBSTRING(r_reason_desc, 1, 20), AVG(ws_quantity) AS avg1, AVG(wr_refunded_cash) AS avg2, AVG(wr_fee) FROM web_sales JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number JOIN web_page ON ws_web_page_sk = wp_web_page_sk JOIN customer_demographics AS cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk JOIN customer_demographics AS cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk JOIN filtered_addresses ON ca_address_sk = wr_refunded_addr_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN reason ON r_reason_sk = wr_reason_sk WHERE ((cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Advanced Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 100.00 AND 150.00) OR (cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'College' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 50.00 AND 100.00) OR (cd1.cd_marital_status = 'W' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = '2 yr Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 150.00 AND 200.00)) AND ((ca_country = 'United States' AND ca_state IN ('IN', 'OH', 'NJ') AND ws_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('WI', 'CT', 'KY') AND ws_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('LA', 'IA', 'AR') AND ws_net_profit BETWEEN 50 AND 250)) GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc, 1, 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100",
          "prompt_tokens": 3322,
          "response_tokens": 1457,
          "llm_time_ms": 206901.24344825745
        },
        {
          "worker_id": 2,
          "query_id": "q85",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), branch_cd_m AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc FROM web_sales JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number JOIN web_page ON ws_web_page_sk = wp_web_page_sk JOIN customer_demographics AS cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk JOIN customer_demographics AS cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk JOIN reason ON r_reason_sk = wr_reason_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk WHERE cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Advanced Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 100.00 AND 150.00 AND ca_country = 'United States' AND ca_state IN ('IN', 'OH', 'NJ') AND ws_net_profit BETWEEN 100 AND 200), branch_cd_s AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc FROM web_sales JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number JOIN web_page ON ws_web_page_sk = wp_web_page_sk JOIN customer_demographics AS cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk JOIN customer_demographics AS cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk JOIN reason ON r_reason_sk = wr_reason_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk WHERE cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'College' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 50.00 AND 100.00 AND ca_country = 'United States' AND ca_state IN ('WI', 'CT', 'KY') AND ws_net_profit BETWEEN 150 AND 300), branch_cd_w AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc FROM web_sales JOIN web_returns ON ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number JOIN web_page ON ws_web_page_sk = wp_web_page_sk JOIN customer_demographics AS cd1 ON cd1.cd_demo_sk = wr_refunded_cdemo_sk JOIN customer_demographics AS cd2 ON cd2.cd_demo_sk = wr_returning_cdemo_sk JOIN customer_address ON ca_address_sk = wr_refunded_addr_sk JOIN reason ON r_reason_sk = wr_reason_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk WHERE cd1.cd_marital_status = 'W' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = '2 yr Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 150.00 AND 200.00 AND ca_country = 'United States' AND ca_state IN ('LA', 'IA', 'AR') AND ws_net_profit BETWEEN 50 AND 250)\nSELECT SUBSTRING(r_reason_desc, 1, 20), AVG(ws_quantity) AS avg1, AVG(wr_refunded_cash) AS avg2, AVG(wr_fee) FROM (branch_cd_m UNION ALL branch_cd_s UNION ALL branch_cd_w) AS unioned_data GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc, 1, 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100",
          "prompt_tokens": 3302,
          "response_tokens": 1748,
          "llm_time_ms": 218840.74902534485
        },
        {
          "worker_id": 1,
          "query_id": "q85",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_reason AS (SELECT r_reason_sk, SUBSTRING(r_reason_desc, 1, 20) AS r_reason_desc_short FROM reason), filtered_customer_address_1 AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('IN', 'OH', 'NJ')), filtered_customer_address_2 AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('WI', 'CT', 'KY')), filtered_customer_address_3 AS (SELECT ca_address_sk FROM customer_address WHERE ca_country = 'United States' AND ca_state IN ('LA', 'IA', 'AR')), filtered_cd_status_m AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree'), filtered_cd_status_s AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'S' AND cd_education_status = 'College'), filtered_cd_status_w AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'W' AND cd_education_status = '2 yr Degree'), branch_m_in AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc_short FROM web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN filtered_customer_address_1 AS ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk JOIN filtered_cd_status_m AS cd1 ON wr.wr_refunded_cdemo_sk = cd1.cd_demo_sk JOIN filtered_cd_status_m AS cd2 ON wr.wr_returning_cdemo_sk = cd2.cd_demo_sk JOIN filtered_reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE ws.ws_sales_price BETWEEN 100.00 AND 150.00 AND ws.ws_net_profit BETWEEN 100 AND 200), branch_m_wi AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc_short FROM web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN filtered_customer_address_2 AS ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk JOIN filtered_cd_status_m AS cd1 ON wr.wr_refunded_cdemo_sk = cd1.cd_demo_sk JOIN filtered_cd_status_m AS cd2 ON wr.wr_returning_cdemo_sk = cd2.cd_demo_sk JOIN filtered_reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE ws.ws_sales_price BETWEEN 100.00 AND 150.00 AND ws.ws_net_profit BETWEEN 150 AND 300), branch_m_la AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc_short FROM web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN filtered_customer_address_3 AS ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk JOIN filtered_cd_status_m AS cd1 ON wr.wr_refunded_cdemo_sk = cd1.cd_demo_sk JOIN filtered_cd_status_m AS cd2 ON wr.wr_returning_cdemo_sk = cd2.cd_demo_sk JOIN filtered_reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE ws.ws_sales_price BETWEEN 100.00 AND 150.00 AND ws.ws_net_profit BETWEEN 50 AND 250), branch_s_in AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc_short FROM web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN filtered_customer_address_1 AS ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk JOIN filtered_cd_status_s AS cd1 ON wr.wr_refunded_cdemo_sk = cd1.cd_demo_sk JOIN filtered_cd_status_s AS cd2 ON wr.wr_returning_cdemo_sk = cd2.cd_demo_sk JOIN filtered_reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE ws.ws_sales_price BETWEEN 50.00 AND 100.00 AND ws.ws_net_profit BETWEEN 100 AND 200), branch_s_wi AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc_short FROM web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN filtered_customer_address_2 AS ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk JOIN filtered_cd_status_s AS cd1 ON wr.wr_refunded_cdemo_sk = cd1.cd_demo_sk JOIN filtered_cd_status_s AS cd2 ON wr.wr_returning_cdemo_sk = cd2.cd_demo_sk JOIN filtered_reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE ws.ws_sales_price BETWEEN 50.00 AND 100.00 AND ws.ws_net_profit BETWEEN 150 AND 300), branch_s_la AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc_short FROM web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN filtered_customer_address_3 AS ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk JOIN filtered_cd_status_s AS cd1 ON wr.wr_refunded_cdemo_sk = cd1.cd_demo_sk JOIN filtered_cd_status_s AS cd2 ON wr.wr_returning_cdemo_sk = cd2.cd_demo_sk JOIN filtered_reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE ws.ws_sales_price BETWEEN 50.00 AND 100.00 AND ws.ws_net_profit BETWEEN 50 AND 250), branch_w_in AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc_short FROM web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN filtered_customer_address_1 AS ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk JOIN filtered_cd_status_w AS cd1 ON wr.wr_refunded_cdemo_sk = cd1.cd_demo_sk JOIN filtered_cd_status_w AS cd2 ON wr.wr_returning_cdemo_sk = cd2.cd_demo_sk JOIN filtered_reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE ws.ws_sales_price BETWEEN 150.00 AND 200.00 AND ws.ws_net_profit BETWEEN 100 AND 200), branch_w_wi AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc_short FROM web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN filtered_customer_address_2 AS ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk JOIN filtered_cd_status_w AS cd1 ON wr.wr_refunded_cdemo_sk = cd1.cd_demo_sk JOIN filtered_cd_status_w AS cd2 ON wr.wr_returning_cdemo_sk = cd2.cd_demo_sk JOIN filtered_reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE ws.ws_sales_price BETWEEN 150.00 AND 200.00 AND ws.ws_net_profit BETWEEN 150 AND 300), branch_w_la AS (SELECT ws_quantity, wr_refunded_cash, wr_fee, r_reason_desc_short FROM web_sales AS ws JOIN web_returns AS wr ON ws.ws_item_sk = wr.wr_item_sk AND ws.ws_order_number = wr.wr_order_number JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk JOIN filtered_customer_address_3 AS ca ON wr.wr_refunded_addr_sk = ca.ca_address_sk JOIN filtered_cd_status_w AS cd1 ON wr.wr_refunded_cdemo_sk = cd1.cd_demo_sk JOIN filtered_cd_status_w AS cd2 ON wr.wr_returning_cdemo_sk = cd2.cd_demo_sk JOIN filtered_reason AS r ON wr.wr_reason_sk = r.r_reason_sk JOIN web_page AS wp ON ws.ws_web_page_sk = wp.wp_web_page_sk WHERE ws.ws_sales_price BETWEEN 150.00 AND 200.00 AND ws.ws_net_profit BETWEEN 50 AND 250)\nSELECT r_reason_desc_short, AVG(ws_quantity) AS avg1, AVG(wr_refunded_cash) AS avg2, AVG(wr_fee) FROM (SELECT * FROM branch_m_in UNION ALL SELECT * FROM branch_m_wi UNION ALL SELECT * FROM branch_m_la UNION ALL SELECT * FROM branch_s_in UNION ALL SELECT * FROM branch_s_wi UNION ALL SELECT * FROM branch_s_la UNION ALL SELECT * FROM branch_w_in UNION ALL SELECT * FROM branch_w_wi UNION ALL SELECT * FROM branch_w_la) AS all_branches GROUP BY r_reason_desc_short ORDER BY r_reason_desc_short, AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100",
          "prompt_tokens": 3157,
          "response_tokens": 2538,
          "llm_time_ms": 290857.7561378479
        },
        {
          "worker_id": 4,
          "query_id": "q85",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000)\nSELECT SUBSTRING(r_reason_desc, 1, 20), AVG(ws_quantity) AS avg1, AVG(wr_refunded_cash) AS avg2, AVG(wr_fee) FROM web_sales, web_returns, web_page, customer_demographics AS cd1, customer_demographics AS cd2, customer_address, filtered_dates, reason WHERE ws_web_page_sk = wp_web_page_sk AND ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number AND ws_sold_date_sk = d_date_sk AND cd1.cd_demo_sk = wr_refunded_cdemo_sk AND cd2.cd_demo_sk = wr_returning_cdemo_sk AND ca_address_sk = wr_refunded_addr_sk AND r_reason_sk = wr_reason_sk AND ((cd1.cd_marital_status = 'M' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'Advanced Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 100.00 AND 150.00) OR (cd1.cd_marital_status = 'S' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = 'College' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 50.00 AND 100.00) OR (cd1.cd_marital_status = 'W' AND cd1.cd_marital_status = cd2.cd_marital_status AND cd1.cd_education_status = '2 yr Degree' AND cd1.cd_education_status = cd2.cd_education_status AND ws_sales_price BETWEEN 150.00 AND 200.00)) AND ((ca_country = 'United States' AND ca_state IN ('IN', 'OH', 'NJ') AND ws_net_profit BETWEEN 100 AND 200) OR (ca_country = 'United States' AND ca_state IN ('WI', 'CT', 'KY') AND ws_net_profit BETWEEN 150 AND 300) OR (ca_country = 'United States' AND ca_state IN ('LA', 'IA', 'AR') AND ws_net_profit BETWEEN 50 AND 250)) GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc, 1, 20), AVG(ws_quantity), AVG(wr_refunded_cash), AVG(wr_fee) LIMIT 100",
          "prompt_tokens": 4372,
          "response_tokens": 2883,
          "llm_time_ms": 312916.0785675049
        }
      ],
      "original_speedup": 1.0,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061934"
    },
    {
      "query_id": "q99",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q99",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1211), filtered_catalog_sales AS (SELECT cs_warehouse_sk, cs_ship_mode_sk, cs_call_center_sk, cs_ship_date_sk, cs_sold_date_sk FROM catalog_sales JOIN filtered_dates ON cs_ship_date_sk = d_date_sk)\nSELECT w_substr, sm_type, LOWER(cc_name) AS cc_name_lower, SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 30) AND (cs_ship_date_sk - cs_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 60) AND (cs_ship_date_sk - cs_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 90) AND (cs_ship_date_sk - cs_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM filtered_catalog_sales AS cs JOIN (SELECT SUBSTRING(w_warehouse_name, 1, 20) AS w_substr, w_warehouse_sk FROM warehouse) AS w ON cs.cs_warehouse_sk = w.w_warehouse_sk JOIN ship_mode AS sm ON cs.cs_ship_mode_sk = sm.sm_ship_mode_sk JOIN call_center AS cc ON cs.cs_call_center_sk = cc.cc_call_center_sk GROUP BY w_substr, sm_type, cc_name ORDER BY w_substr NULLS FIRST, sm_type NULLS FIRST, cc_name_lower NULLS FIRST LIMIT 100",
          "prompt_tokens": 2948,
          "response_tokens": 525,
          "llm_time_ms": 149211.73191070557
        },
        {
          "worker_id": 4,
          "query_id": "q99",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), filtered_catalog_sales AS (SELECT cs.* FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_ship_date_sk = fd.d_date_sk)\nSELECT SUBSTRING(w.w_warehouse_name, 1, 20) AS w_substr, sm.sm_type, LOWER(cc.cc_name) AS cc_name_lower, SUM(CASE WHEN (cs.cs_ship_date_sk - cs.cs_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (cs.cs_ship_date_sk - cs.cs_sold_date_sk > 30) AND (cs.cs_ship_date_sk - cs.cs_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (cs.cs_ship_date_sk - cs.cs_sold_date_sk > 60) AND (cs.cs_ship_date_sk - cs.cs_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (cs.cs_ship_date_sk - cs.cs_sold_date_sk > 90) AND (cs.cs_ship_date_sk - cs.cs_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (cs.cs_ship_date_sk - cs.cs_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM filtered_catalog_sales AS cs, warehouse AS w, ship_mode AS sm, call_center AS cc WHERE cs.cs_warehouse_sk = w.w_warehouse_sk AND cs.cs_ship_mode_sk = sm.sm_ship_mode_sk AND cs.cs_call_center_sk = cc.cc_call_center_sk GROUP BY SUBSTRING(w.w_warehouse_name, 1, 20), sm.sm_type, cc.cc_name ORDER BY w_substr NULLS FIRST, sm.sm_type NULLS FIRST, cc_name_lower NULLS FIRST LIMIT 100",
          "prompt_tokens": 4015,
          "response_tokens": 707,
          "llm_time_ms": 157067.21425056458
        },
        {
          "worker_id": 1,
          "query_id": "q99",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1211)\nSELECT SUBSTRING(w_warehouse_name, 1, 20) AS w_substr, sm_type, LOWER(cc_name) AS cc_name_lower, SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 30) AND (cs_ship_date_sk - cs_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 60) AND (cs_ship_date_sk - cs_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 90) AND (cs_ship_date_sk - cs_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM catalog_sales JOIN filtered_dates ON cs_ship_date_sk = d_date_sk JOIN warehouse ON cs_warehouse_sk = w_warehouse_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN call_center ON cs_call_center_sk = cc_call_center_sk GROUP BY w_substr, sm_type, cc_name ORDER BY w_substr NULLS FIRST, sm_type NULLS FIRST, cc_name_lower NULLS FIRST LIMIT 100",
          "prompt_tokens": 2800,
          "response_tokens": 839,
          "llm_time_ms": 163785.7482433319
        },
        {
          "worker_id": 3,
          "query_id": "q99",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), warehouse_with_substr AS (SELECT SUBSTRING(w_warehouse_name, 1, 20) AS w_substr, w_warehouse_sk, w_warehouse_name FROM warehouse)\nSELECT w_substr, sm_type, LOWER(cc_name) AS cc_name_lower, SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk <= 30) THEN 1 ELSE 0 END) AS \"30 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 30) AND (cs_ship_date_sk - cs_sold_date_sk <= 60) THEN 1 ELSE 0 END) AS \"31-60 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 60) AND (cs_ship_date_sk - cs_sold_date_sk <= 90) THEN 1 ELSE 0 END) AS \"61-90 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 90) AND (cs_ship_date_sk - cs_sold_date_sk <= 120) THEN 1 ELSE 0 END) AS \"91-120 days\", SUM(CASE WHEN (cs_ship_date_sk - cs_sold_date_sk > 120) THEN 1 ELSE 0 END) AS \">120 days\" FROM catalog_sales JOIN filtered_dates ON cs_ship_date_sk = d_date_sk JOIN warehouse_with_substr ON cs_warehouse_sk = w_warehouse_sk JOIN ship_mode ON cs_ship_mode_sk = sm_ship_mode_sk JOIN call_center ON cs_call_center_sk = cc_call_center_sk GROUP BY w_substr, sm_type, cc_name ORDER BY w_substr NULLS FIRST, sm_type NULLS FIRST, cc_name_lower NULLS FIRST LIMIT 100",
          "prompt_tokens": 2960,
          "response_tokens": 511,
          "llm_time_ms": 192283.90169143677
        }
      ],
      "original_speedup": 1.0,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061936"
    },
    {
      "query_id": "q21",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q21",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_current_price BETWEEN 0.99 AND 1.49)\nSELECT * FROM (SELECT w_warehouse_name, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) AS inv_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) AS inv_after FROM inventory JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk JOIN filtered_items ON i_item_sk = inv_item_sk JOIN filtered_dates ON inv_date_sk = d_date_sk GROUP BY w_warehouse_name, i_item_id) AS x WHERE (CASE WHEN inv_before > 0 THEN (inv_after * 1.000) / inv_before ELSE NULL END) BETWEEN 2.000 / 3.000 AND 3.000 / 2.000 ORDER BY w_warehouse_name NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 2843,
          "response_tokens": 392,
          "llm_time_ms": 122763.5350227356
        },
        {
          "worker_id": 2,
          "query_id": "q21",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_current_price BETWEEN 0.99 AND 1.49), joined_facts AS (SELECT w_warehouse_name, i_item_id, d_date, inv_quantity_on_hand FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk JOIN filtered_items ON inv_item_sk = i_item_sk JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk)\nSELECT w_warehouse_name, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) AS inv_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) AS inv_after FROM joined_facts GROUP BY w_warehouse_name, i_item_id HAVING (CASE WHEN SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) > 0 THEN (SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) * 1.000) / SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) ELSE NULL END) BETWEEN 2.000 / 3.000 AND 3.000 / 2.000 ORDER BY w_warehouse_name NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 2828,
          "response_tokens": 530,
          "llm_time_ms": 117158.67352485657
        },
        {
          "worker_id": 1,
          "query_id": "q21",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_current_price BETWEEN 0.99 AND 1.49)\nSELECT w_warehouse_name, i_item_id, SUM(CASE WHEN CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE) THEN inv_quantity_on_hand ELSE 0 END) AS inv_before, SUM(CASE WHEN CAST(d_date AS DATE) >= CAST('2000-03-11' AS DATE) THEN inv_quantity_on_hand ELSE 0 END) AS inv_after FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk JOIN filtered_items ON inv_item_sk = i_item_sk JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk GROUP BY w_warehouse_name, i_item_id HAVING inv_before > 0 AND (CASE WHEN inv_before > 0 THEN (inv_after * 1.000) / inv_before ELSE NULL END) BETWEEN (2.000 / 3.000) AND (3.000 / 2.000) ORDER BY w_warehouse_name NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 2683,
          "response_tokens": 403,
          "llm_time_ms": 139103.2099723816
        },
        {
          "worker_id": 4,
          "query_id": "q21",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_current_price BETWEEN 0.99 AND 1.49)\nSELECT w_warehouse_name, i_item_id, SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) AS inv_before, SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) AS inv_after FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk JOIN filtered_items ON inv_item_sk = i_item_sk JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk GROUP BY w_warehouse_name, i_item_id HAVING SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) > 0 AND (CASE WHEN SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) > 0 THEN (SUM(CASE WHEN (CAST(d_date AS DATE) >= CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) * 1.000) / SUM(CASE WHEN (CAST(d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN inv_quantity_on_hand ELSE 0 END) ELSE NULL END) BETWEEN 2.000 / 3.000 AND 3.000 / 2.000 ORDER BY w_warehouse_name NULLS FIRST, i_item_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3898,
          "response_tokens": 510,
          "llm_time_ms": 193983.51979255676
        }
      ],
      "original_speedup": 0.99,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061938"
    },
    {
      "query_id": "q39",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q39",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 2001 AND d_moy IN (1, 2)), inv AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, STDDEV_SAMP(inv_quantity_on_hand) * 1.000 AS stdev, AVG(inv_quantity_on_hand) AS mean, CASE WHEN AVG(inv_quantity_on_hand) = 0 THEN NULL ELSE STDDEV_SAMP(inv_quantity_on_hand) * 1.000 / AVG(inv_quantity_on_hand) END AS cov FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk JOIN item ON inv_item_sk = i_item_sk JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy HAVING CASE WHEN AVG(inv_quantity_on_hand) = 0 THEN 0 ELSE STDDEV_SAMP(inv_quantity_on_hand) * 1.000 / AVG(inv_quantity_on_hand) END > 1)\nSELECT inv1.w_warehouse_sk AS wsk1, inv1.i_item_sk AS isk1, inv1.d_moy AS dmoy1, inv1.mean AS mean1, inv1.cov AS cov1, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM inv AS inv1, inv AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk AND inv1.d_moy = 1 AND inv2.d_moy = 1 + 1 ORDER BY inv1.w_warehouse_sk NULLS FIRST, inv1.i_item_sk NULLS FIRST, inv1.d_moy NULLS FIRST, inv1.mean NULLS FIRST, inv1.cov NULLS FIRST, inv2.d_moy NULLS FIRST, inv2.mean NULLS FIRST, inv2.cov NULLS FIRST",
          "prompt_tokens": 4260,
          "response_tokens": 644,
          "llm_time_ms": 125146.17252349854
        },
        {
          "worker_id": 3,
          "query_id": "q39",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH inv AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, STDDEV_SAMP(inv_quantity_on_hand) * 1.000 AS stdev, AVG(inv_quantity_on_hand) AS mean FROM inventory, item, warehouse, date_dim WHERE inv_item_sk = i_item_sk AND inv_warehouse_sk = w_warehouse_sk AND inv_date_sk = d_date_sk AND d_year = 2001 AND d_moy IN (1, 2) GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy) AS foo WHERE CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1)\nSELECT inv1.w_warehouse_sk AS wsk1, inv1.i_item_sk AS isk1, inv1.d_moy AS dmoy1, inv1.mean AS mean1, inv1.cov AS cov1, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM inv AS inv1, inv AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk AND inv1.d_moy = 1 AND inv2.d_moy = 2 ORDER BY inv1.w_warehouse_sk NULLS FIRST, inv1.i_item_sk NULLS FIRST, inv1.d_moy NULLS FIRST, inv1.mean NULLS FIRST, inv1.cov NULLS FIRST, inv2.d_moy NULLS FIRST, inv2.mean NULLS FIRST, inv2.cov NULLS FIRST",
          "prompt_tokens": 3205,
          "response_tokens": 583,
          "llm_time_ms": 130233.96134376526
        },
        {
          "worker_id": 1,
          "query_id": "q39",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 2001 AND d_moy IN (1, 2)), inv_base AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, date_filtered.d_moy, STDDEV_SAMP(inv_quantity_on_hand) * 1.000 AS stdev, AVG(inv_quantity_on_hand) AS mean FROM inventory JOIN date_filtered ON inventory.inv_date_sk = date_filtered.d_date_sk JOIN item ON inventory.inv_item_sk = item.i_item_sk JOIN warehouse ON inventory.inv_warehouse_sk = warehouse.w_warehouse_sk GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, date_filtered.d_moy), inv AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, stdev, mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM inv_base WHERE CASE mean WHEN 0 THEN 0 ELSE stdev / mean END > 1)\nSELECT inv1.w_warehouse_sk AS wsk1, inv1.i_item_sk AS isk1, inv1.d_moy AS dmoy1, inv1.mean AS mean1, inv1.cov AS cov1, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM inv AS inv1, inv AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk AND inv1.d_moy = 1 AND inv2.d_moy = 2 ORDER BY inv1.w_warehouse_sk NULLS FIRST, inv1.i_item_sk NULLS FIRST, inv1.d_moy NULLS FIRST, inv1.mean NULLS FIRST, inv1.cov NULLS FIRST, inv2.d_moy NULLS FIRST, inv2.mean NULLS FIRST, inv2.cov NULLS FIRST",
          "prompt_tokens": 3044,
          "response_tokens": 489,
          "llm_time_ms": 134819.88763809204
        },
        {
          "worker_id": 2,
          "query_id": "q39",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_moy FROM date_dim WHERE d_year = 2001), inv AS (SELECT w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy, STDDEV_SAMP(inv_quantity_on_hand) * 1.000 AS stdev, AVG(inv_quantity_on_hand) AS mean, CASE mean WHEN 0 THEN NULL ELSE stdev / mean END AS cov FROM inventory JOIN filtered_dates ON inv_date_sk = d_date_sk JOIN item ON inv_item_sk = i_item_sk JOIN warehouse ON inv_warehouse_sk = w_warehouse_sk GROUP BY w_warehouse_name, w_warehouse_sk, i_item_sk, d_moy HAVING CASE mean WHEN 0 THEN 0 ELSE stdev / NULLIF(mean, 0) END > 1)\nSELECT inv1.w_warehouse_sk AS wsk1, inv1.i_item_sk AS isk1, inv1.d_moy AS dmoy1, inv1.mean AS mean1, inv1.cov AS cov1, inv2.w_warehouse_sk, inv2.i_item_sk, inv2.d_moy, inv2.mean, inv2.cov FROM inv AS inv1, inv AS inv2 WHERE inv1.i_item_sk = inv2.i_item_sk AND inv1.w_warehouse_sk = inv2.w_warehouse_sk AND inv1.d_moy = 1 AND inv2.d_moy = 1 + 1 ORDER BY inv1.w_warehouse_sk NULLS FIRST, inv1.i_item_sk NULLS FIRST, inv1.d_moy NULLS FIRST, inv1.mean NULLS FIRST, inv1.cov NULLS FIRST, inv2.d_moy NULLS FIRST, inv2.mean NULLS FIRST, inv2.cov NULLS FIRST",
          "prompt_tokens": 3193,
          "response_tokens": 724,
          "llm_time_ms": 163849.82442855835
        }
      ],
      "original_speedup": 0.99,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061942"
    },
    {
      "query_id": "q88",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q88",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_hh_demo AS (SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 4 AND hd_vehicle_count <= 6) UNION ALL SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 2 AND hd_vehicle_count <= 4) UNION ALL SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 0 AND hd_vehicle_count <= 2)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_store_name = 'ese'), time_intervals AS (SELECT 8 AS interval_hour, 30 AS min_minute, 8 AS max_hour, 59 AS max_minute UNION ALL SELECT 9, 0, 9, 29 UNION ALL SELECT 9, 30, 9, 59 UNION ALL SELECT 10, 0, 10, 29 UNION ALL SELECT 10, 30, 10, 59 UNION ALL SELECT 11, 0, 11, 29 UNION ALL SELECT 11, 30, 11, 59 UNION ALL SELECT 12, 0, 12, 29), sales_by_interval AS (SELECT ti.interval_hour, COUNT(*) AS cnt FROM store_sales AS ss JOIN time_dim AS td ON ss.ss_sold_time_sk = td.t_time_sk JOIN filtered_hh_demo AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN time_intervals AS ti ON td.t_hour = ti.interval_hour WHERE td.t_minute BETWEEN ti.min_minute AND ti.max_minute GROUP BY ti.interval_hour)\nSELECT s1.cnt AS h8_30_to_9, s2.cnt AS h9_to_9_30, s3.cnt AS h9_30_to_10, s4.cnt AS h10_to_10_30, s5.cnt AS h10_30_to_11, s6.cnt AS h11_to_11_30, s7.cnt AS h11_30_to_12, s8.cnt AS h12_to_12_30 FROM sales_by_interval AS s1, sales_by_interval AS s2, sales_by_interval AS s3, sales_by_interval AS s4, sales_by_interval AS s5, sales_by_interval AS s6, sales_by_interval AS s7, sales_by_interval AS s8 WHERE s1.interval_hour = 8 AND s2.interval_hour = 9 AND s3.interval_hour = 9 AND s4.interval_hour = 10 AND s5.interval_hour = 10 AND s6.interval_hour = 11 AND s7.interval_hour = 11 AND s8.interval_hour = 12 AND s2.cnt = s3.cnt AND s4.cnt = s5.cnt AND s6.cnt = s7.cnt",
          "prompt_tokens": 3817,
          "response_tokens": 667,
          "llm_time_ms": 117044.6388721466
        },
        {
          "worker_id": 2,
          "query_id": "q88",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dimensions AS (SELECT s_store_sk FROM store WHERE s_store_name = 'ese'), filtered_hh AS (SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 4 AND hd_vehicle_count <= 6) OR (hd_dep_count = 2 AND hd_vehicle_count <= 4) OR (hd_dep_count = 0 AND hd_vehicle_count <= 2))\nSELECT COUNT(CASE WHEN t_hour = 8 AND t_minute >= 30 THEN 1 END) AS h8_30_to_9, COUNT(CASE WHEN t_hour = 9 AND t_minute < 30 THEN 1 END) AS h9_to_9_30, COUNT(CASE WHEN t_hour = 9 AND t_minute >= 30 THEN 1 END) AS h9_30_to_10, COUNT(CASE WHEN t_hour = 10 AND t_minute < 30 THEN 1 END) AS h10_to_10_30, COUNT(CASE WHEN t_hour = 10 AND t_minute >= 30 THEN 1 END) AS h10_30_to_11, COUNT(CASE WHEN t_hour = 11 AND t_minute < 30 THEN 1 END) AS h11_to_11_30, COUNT(CASE WHEN t_hour = 11 AND t_minute >= 30 THEN 1 END) AS h11_30_to_12, COUNT(CASE WHEN t_hour = 12 AND t_minute < 30 THEN 1 END) AS h12_to_12_30 FROM store_sales JOIN filtered_hh ON ss_hdemo_sk = hd_demo_sk JOIN time_dim ON ss_sold_time_sk = t_time_sk JOIN filtered_store ON ss_store_sk = s_store_sk WHERE (t_hour = 8 AND t_minute >= 30) OR (t_hour = 9 AND t_minute < 30) OR (t_hour = 9 AND t_minute >= 30) OR (t_hour = 10 AND t_minute < 30) OR (t_hour = 10 AND t_minute >= 30) OR (t_hour = 11 AND t_minute < 30) OR (t_hour = 11 AND t_minute >= 30) OR (t_hour = 12 AND t_minute < 30)",
          "prompt_tokens": 3964,
          "response_tokens": 753,
          "llm_time_ms": 131375.91218948364
        },
        {
          "worker_id": 4,
          "query_id": "q88",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_store AS (SELECT s_store_sk FROM store WHERE s_store_name = 'ese'), filtered_hh AS (SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 4 AND hd_vehicle_count <= 6) OR (hd_dep_count = 2 AND hd_vehicle_count <= 4) OR (hd_dep_count = 0 AND hd_vehicle_count <= 2)), time_slots AS (SELECT t_time_sk, CASE WHEN t_hour = 8 AND t_minute >= 30 THEN 1 WHEN t_hour = 9 AND t_minute < 30 THEN 2 WHEN t_hour = 9 AND t_minute >= 30 THEN 3 WHEN t_hour = 10 AND t_minute < 30 THEN 4 WHEN t_hour = 10 AND t_minute >= 30 THEN 5 WHEN t_hour = 11 AND t_minute < 30 THEN 6 WHEN t_hour = 11 AND t_minute >= 30 THEN 7 WHEN t_hour = 12 AND t_minute < 30 THEN 8 END AS time_slot FROM time_dim WHERE (t_hour = 8 AND t_minute >= 30) OR (t_hour = 9) OR (t_hour = 10) OR (t_hour = 11) OR (t_hour = 12 AND t_minute < 30)), qualified_sales AS (SELECT ss.sales_price, ts.time_slot FROM (SELECT ss_sold_time_sk, ss_hdemo_sk, ss_store_sk, 1 AS sales_price FROM store_sales) AS ss JOIN time_slots AS ts ON ss.ss_sold_time_sk = ts.t_time_sk JOIN filtered_hh AS hh ON ss.ss_hdemo_sk = hh.hd_demo_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk WHERE NOT ts.time_slot IS NULL)\nSELECT SUM(CASE WHEN time_slot = 1 THEN sales_price END) AS h8_30_to_9, SUM(CASE WHEN time_slot = 2 THEN sales_price END) AS h9_to_9_30, SUM(CASE WHEN time_slot = 3 THEN sales_price END) AS h9_30_to_10, SUM(CASE WHEN time_slot = 4 THEN sales_price END) AS h10_to_10_30, SUM(CASE WHEN time_slot = 5 THEN sales_price END) AS h10_30_to_11, SUM(CASE WHEN time_slot = 6 THEN sales_price END) AS h11_to_11_30, SUM(CASE WHEN time_slot = 7 THEN sales_price END) AS h11_30_to_12, SUM(CASE WHEN time_slot = 8 THEN sales_price END) AS h12_to_12_30 FROM qualified_sales",
          "prompt_tokens": 5034,
          "response_tokens": 660,
          "llm_time_ms": 136422.43480682373
        },
        {
          "worker_id": 3,
          "query_id": "q88",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_store AS (SELECT s_store_sk, s_store_name FROM store WHERE s_store_name = 'ese'), filtered_time_windows AS (SELECT t_time_sk, CASE WHEN t_hour = 8 AND t_minute >= 30 THEN 'h8_30_to_9' WHEN t_hour = 9 AND t_minute < 30 THEN 'h9_to_9_30' WHEN t_hour = 9 AND t_minute >= 30 THEN 'h9_30_to_10' WHEN t_hour = 10 AND t_minute < 30 THEN 'h10_to_10_30' WHEN t_hour = 10 AND t_minute >= 30 THEN 'h10_30_to_11' WHEN t_hour = 11 AND t_minute < 30 THEN 'h11_to_11_30' WHEN t_hour = 11 AND t_minute >= 30 THEN 'h11_30_to_12' WHEN t_hour = 12 AND t_minute < 30 THEN 'h12_to_12_30' ELSE 'other' END AS time_window FROM time_dim WHERE (t_hour = 8 AND t_minute >= 30) OR (t_hour = 9 AND t_minute < 30) OR (t_hour = 9 AND t_minute >= 30) OR (t_hour = 10 AND t_minute < 30) OR (t_hour = 10 AND t_minute >= 30) OR (t_hour = 11 AND t_minute < 30) OR (t_hour = 11 AND t_minute >= 30) OR (t_hour = 12 AND t_minute < 30)), filtered_hh_demographics AS (SELECT hd_demo_sk FROM household_demographics WHERE ((hd_dep_count = 4 AND hd_vehicle_count <= 6) OR (hd_dep_count = 2 AND hd_vehicle_count <= 4) OR (hd_dep_count = 0 AND hd_vehicle_count <= 2)))\nSELECT s1.h8_30_to_9, s2.h9_to_9_30, s3.h9_30_to_10, s4.h10_to_10_30, s5.h10_30_to_11, s6.h11_to_11_30, s7.h11_30_to_12, s8.h12_to_12_30 FROM (SELECT COUNT(*) AS h8_30_to_9 FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_time_windows ON ss_sold_time_sk = t_time_sk JOIN filtered_hh_demographics ON ss_hdemo_sk = hd_demo_sk WHERE time_window = 'h8_30_to_9') AS s1, (SELECT COUNT(*) AS h9_to_9_30 FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_time_windows ON ss_sold_time_sk = t_time_sk JOIN filtered_hh_demographics ON ss_hdemo_sk = hd_demo_sk WHERE time_window = 'h9_to_9_30') AS s2, (SELECT COUNT(*) AS h9_30_to_10 FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_time_windows ON ss_sold_time_sk = t_time_sk JOIN filtered_hh_demographics ON ss_hdemo_sk = hd_demo_sk WHERE time_window = 'h9_30_to_10') AS s3, (SELECT COUNT(*) AS h10_to_10_30 FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_time_windows ON ss_sold_time_sk = t_time_sk JOIN filtered_hh_demographics ON ss_hdemo_sk = hd_demo_sk WHERE time_window = 'h10_to_10_30') AS s4, (SELECT COUNT(*) AS h10_30_to_11 FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_time_windows ON ss_sold_time_sk = t_time_sk JOIN filtered_hh_demographics ON ss_hdemo_sk = hd_demo_sk WHERE time_window = 'h10_30_to_11') AS s5, (SELECT COUNT(*) AS h11_to_11_30 FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_time_windows ON ss_sold_time_sk = t_time_sk JOIN filtered_hh_demographics ON ss_hdemo_sk = hd_demo_sk WHERE time_window = 'h11_to_11_30') AS s6, (SELECT COUNT(*) AS h11_30_to_12 FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_time_windows ON ss_sold_time_sk = t_time_sk JOIN filtered_hh_demographics ON ss_hdemo_sk = hd_demo_sk WHERE time_window = 'h11_30_to_12') AS s7, (SELECT COUNT(*) AS h12_to_12_30 FROM store_sales JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_time_windows ON ss_sold_time_sk = t_time_sk JOIN filtered_hh_demographics ON ss_hdemo_sk = hd_demo_sk WHERE time_window = 'h12_to_12_30') AS s8",
          "prompt_tokens": 3981,
          "response_tokens": 1850,
          "llm_time_ms": 179707.4797153473
        }
      ],
      "original_speedup": 0.99,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061944"
    },
    {
      "query_id": "q3",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q3",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manufact_id = 128)\nSELECT dt.d_year, item.i_brand_id AS brand_id, item.i_brand AS brand, SUM(ss_ext_sales_price) AS sum_agg FROM store_sales JOIN filtered_dates AS dt ON store_sales.ss_sold_date_sk = dt.d_date_sk JOIN filtered_items AS item ON store_sales.ss_item_sk = item.i_item_sk GROUP BY dt.d_year, item.i_brand, item.i_brand_id ORDER BY dt.d_year, sum_agg DESC, brand_id LIMIT 100",
          "prompt_tokens": 3740,
          "response_tokens": 318,
          "llm_time_ms": 83236.572265625
        },
        {
          "worker_id": 3,
          "query_id": "q3",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11)\nSELECT dt.d_year, item.i_brand_id AS brand_id, item.i_brand AS brand, SUM(ss_ext_sales_price) AS sum_agg FROM store_sales JOIN filtered_dates AS dt ON dt.d_date_sk = store_sales.ss_sold_date_sk JOIN item ON store_sales.ss_item_sk = item.i_item_sk WHERE item.i_manufact_id = 128 GROUP BY dt.d_year, item.i_brand, item.i_brand_id ORDER BY dt.d_year, sum_agg DESC, brand_id LIMIT 100",
          "prompt_tokens": 2683,
          "response_tokens": 306,
          "llm_time_ms": 89092.10658073425
        },
        {
          "worker_id": 1,
          "query_id": "q3",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11), filtered_item AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manufact_id = 128)\nSELECT dt.d_year, item.i_brand_id AS brand_id, item.i_brand AS brand, SUM(ss_ext_sales_price) AS sum_agg FROM store_sales JOIN filtered_date AS dt ON dt.d_date_sk = store_sales.ss_sold_date_sk JOIN filtered_item AS item ON store_sales.ss_item_sk = item.i_item_sk GROUP BY dt.d_year, item.i_brand, item.i_brand_id ORDER BY dt.d_year, sum_agg DESC, brand_id LIMIT 100",
          "prompt_tokens": 2521,
          "response_tokens": 337,
          "llm_time_ms": 114038.68532180786
        },
        {
          "worker_id": 2,
          "query_id": "q3",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manufact_id = 128), joined_sales AS (SELECT ss_ext_sales_price, ss_sold_date_sk, ss_item_sk FROM store_sales), filtered_sales AS (SELECT fd.d_year, fi.i_brand_id, fi.i_brand, js.ss_ext_sales_price FROM joined_sales AS js JOIN filtered_dates AS fd ON js.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items AS fi ON js.ss_item_sk = fi.i_item_sk)\nSELECT d_year, i_brand_id AS brand_id, i_brand AS brand, SUM(ss_ext_sales_price) AS sum_agg FROM filtered_sales GROUP BY d_year, i_brand, i_brand_id ORDER BY d_year, sum_agg DESC, brand_id LIMIT 100",
          "prompt_tokens": 2668,
          "response_tokens": 413,
          "llm_time_ms": 126128.5126209259
        }
      ],
      "original_speedup": 0.98,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061948"
    },
    {
      "query_id": "q25",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q25",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), d2_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), d3_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN d1_dates ON store_sales.ss_sold_date_sk = d1_dates.d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN d2_dates ON store_returns.sr_returned_date_sk = d2_dates.d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN d3_dates ON catalog_sales.cs_sold_date_sk = d3_dates.d_date_sk)\nSELECT i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name, SUM(fss.ss_net_profit) AS store_sales_profit, SUM(fsr.sr_net_loss) AS store_returns_loss, SUM(fcs.cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales AS fss JOIN filtered_store_returns AS fsr ON fss.ss_customer_sk = fsr.sr_customer_sk AND fss.ss_item_sk = fsr.sr_item_sk AND fss.ss_ticket_number = fsr.sr_ticket_number JOIN filtered_catalog_sales AS fcs ON fsr.sr_customer_sk = fcs.cs_bill_customer_sk AND fsr.sr_item_sk = fcs.cs_item_sk JOIN store AS s ON fss.ss_store_sk = s.s_store_sk JOIN item AS i ON fss.ss_item_sk = i.i_item_sk GROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name ORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name LIMIT 100",
          "prompt_tokens": 2999,
          "response_tokens": 613,
          "llm_time_ms": 61976.36556625366
        },
        {
          "worker_id": 1,
          "query_id": "q25",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), d2_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), d3_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), store_sales_filtered AS (SELECT ss_item_sk, ss_customer_sk, ss_ticket_number, ss_store_sk, ss_net_profit FROM store_sales JOIN d1_filtered AS d1 ON ss_sold_date_sk = d1.d_date_sk), store_returns_filtered AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN d2_filtered AS d2 ON sr_returned_date_sk = d2.d_date_sk), catalog_sales_filtered AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN d3_filtered AS d3 ON cs_sold_date_sk = d3.d_date_sk)\nSELECT i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name, SUM(ss.ss_net_profit) AS store_sales_profit, SUM(sr.sr_net_loss) AS store_returns_loss, SUM(cs.cs_net_profit) AS catalog_sales_profit FROM store_sales_filtered AS ss JOIN item AS i ON ss.ss_item_sk = i.i_item_sk JOIN store AS s ON ss.ss_store_sk = s.s_store_sk JOIN store_returns_filtered AS sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN catalog_sales_filtered AS cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk GROUP BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name ORDER BY i.i_item_id, i.i_item_desc, s.s_store_id, s.s_store_name LIMIT 100",
          "prompt_tokens": 2850,
          "response_tokens": 571,
          "llm_time_ms": 122748.60167503357
        },
        {
          "worker_id": 4,
          "query_id": "q25",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), d2_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), d3_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss_item_sk, ss_store_sk, ss_customer_sk, ss_ticket_number, ss_net_profit FROM store_sales JOIN d1_dates ON ss_sold_date_sk = d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss, sr_returned_date_sk FROM store_returns JOIN d2_dates ON sr_returned_date_sk = d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN d3_dates ON cs_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_net_profit) AS store_sales_profit, SUM(sr_net_loss) AS store_returns_loss, SUM(cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales AS ss JOIN filtered_store_returns AS sr ON ss.ss_customer_sk = sr.sr_customer_sk AND ss.ss_item_sk = sr.sr_item_sk AND ss.ss_ticket_number = sr.sr_ticket_number JOIN filtered_catalog_sales AS cs ON sr.sr_customer_sk = cs.cs_bill_customer_sk AND sr.sr_item_sk = cs.cs_item_sk JOIN store AS s ON ss.ss_store_sk = s.s_store_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
          "prompt_tokens": 4070,
          "response_tokens": 1389,
          "llm_time_ms": 137256.41345977783
        },
        {
          "worker_id": 3,
          "query_id": "q25",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d1 AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 4 AND d_year = 2001), filtered_d2 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_d3 AS (SELECT d_date_sk FROM date_dim WHERE d_moy BETWEEN 4 AND 10 AND d_year = 2001), filtered_store_sales AS (SELECT ss_item_sk, ss_customer_sk, ss_ticket_number, ss_store_sk, ss_net_profit FROM store_sales JOIN filtered_d1 ON ss_sold_date_sk = d_date_sk), filtered_store_returns AS (SELECT sr_item_sk, sr_customer_sk, sr_ticket_number, sr_net_loss FROM store_returns JOIN filtered_d2 ON sr_returned_date_sk = d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_bill_customer_sk, cs_net_profit FROM catalog_sales JOIN filtered_d3 ON cs_sold_date_sk = d_date_sk)\nSELECT i_item_id, i_item_desc, s_store_id, s_store_name, SUM(ss_net_profit) AS store_sales_profit, SUM(sr_net_loss) AS store_returns_loss, SUM(cs_net_profit) AS catalog_sales_profit FROM filtered_store_sales JOIN item ON i_item_sk = ss_item_sk JOIN store ON s_store_sk = ss_store_sk JOIN filtered_store_returns ON ss_customer_sk = sr_customer_sk AND ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number JOIN filtered_catalog_sales ON sr_customer_sk = cs_bill_customer_sk AND sr_item_sk = cs_item_sk GROUP BY i_item_id, i_item_desc, s_store_id, s_store_name ORDER BY i_item_id, i_item_desc, s_store_id, s_store_name LIMIT 100",
          "prompt_tokens": 3018,
          "response_tokens": 564,
          "llm_time_ms": 173864.6743297577
        }
      ],
      "original_speedup": 0.98,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061950"
    },
    {
      "query_id": "q97",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q97",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), ssci AS (SELECT ss_customer_sk AS customer_sk, ss_item_sk AS item_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk, ss_item_sk), csci AS (SELECT cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk GROUP BY cs_bill_customer_sk, cs_item_sk)\nSELECT SUM(CASE WHEN NOT ssci.customer_sk IS NULL AND csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_only, SUM(CASE WHEN ssci.customer_sk IS NULL AND NOT csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS catalog_only, SUM(CASE WHEN NOT ssci.customer_sk IS NULL AND NOT csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_and_catalog FROM ssci FULL OUTER JOIN csci ON (ssci.customer_sk = csci.customer_sk AND ssci.item_sk = csci.item_sk) LIMIT 100",
          "prompt_tokens": 2887,
          "response_tokens": 415,
          "llm_time_ms": 56445.796489715576
        },
        {
          "worker_id": 4,
          "query_id": "q97",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), ssci AS (SELECT ss_customer_sk AS customer_sk, ss_item_sk AS item_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk, ss_item_sk), csci AS (SELECT cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk GROUP BY cs_bill_customer_sk, cs_item_sk)\nSELECT SUM(CASE WHEN NOT ssci.customer_sk IS NULL AND csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_only, SUM(CASE WHEN ssci.customer_sk IS NULL AND NOT csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS catalog_only, SUM(CASE WHEN NOT ssci.customer_sk IS NULL AND NOT csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_and_catalog FROM ssci FULL OUTER JOIN csci ON (ssci.customer_sk = csci.customer_sk AND ssci.item_sk = csci.item_sk) LIMIT 100",
          "prompt_tokens": 4095,
          "response_tokens": 695,
          "llm_time_ms": 88777.61554718018
        },
        {
          "worker_id": 3,
          "query_id": "q97",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), ssci AS (SELECT ss_customer_sk AS customer_sk, ss_item_sk AS item_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk GROUP BY ss_customer_sk, ss_item_sk), csci AS (SELECT cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk GROUP BY cs_bill_customer_sk, cs_item_sk)\nSELECT SUM(CASE WHEN NOT ssci.customer_sk IS NULL AND csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_only, SUM(CASE WHEN ssci.customer_sk IS NULL AND NOT csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS catalog_only, SUM(CASE WHEN NOT ssci.customer_sk IS NULL AND NOT csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_and_catalog FROM ssci FULL OUTER JOIN csci ON (ssci.customer_sk = csci.customer_sk AND ssci.item_sk = csci.item_sk) LIMIT 100",
          "prompt_tokens": 3043,
          "response_tokens": 422,
          "llm_time_ms": 94699.80239868164
        },
        {
          "worker_id": 2,
          "query_id": "q97",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_month_seq BETWEEN 1200 AND 1200 + 11), ssci AS (SELECT ss_customer_sk AS customer_sk, ss_item_sk AS item_sk FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk GROUP BY ss_customer_sk, ss_item_sk), csci AS (SELECT cs_bill_customer_sk AS customer_sk, cs_item_sk AS item_sk FROM catalog_sales JOIN filtered_dates ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk GROUP BY cs_bill_customer_sk, cs_item_sk)\nSELECT SUM(CASE WHEN NOT ssci.customer_sk IS NULL AND csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_only, SUM(CASE WHEN ssci.customer_sk IS NULL AND NOT csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS catalog_only, SUM(CASE WHEN NOT ssci.customer_sk IS NULL AND NOT csci.customer_sk IS NULL THEN 1 ELSE 0 END) AS store_and_catalog FROM ssci FULL OUTER JOIN csci ON (ssci.customer_sk = csci.customer_sk AND ssci.item_sk = csci.item_sk) LIMIT 100",
          "prompt_tokens": 3026,
          "response_tokens": 460,
          "llm_time_ms": 120635.26248931885
        }
      ],
      "original_speedup": 0.98,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061954"
    },
    {
      "query_id": "q42",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q42",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11 AND d_year = 2000), filtered_items AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1)\nSELECT fd.d_year, fi.i_category_id, fi.i_category, SUM(ss_ext_sales_price) FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items AS fi ON ss.ss_item_sk = fi.i_item_sk GROUP BY fd.d_year, fi.i_category_id, fi.i_category ORDER BY SUM(ss_ext_sales_price) DESC, fd.d_year, fi.i_category_id, fi.i_category LIMIT 100",
          "prompt_tokens": 3775,
          "response_tokens": 350,
          "llm_time_ms": 102084.32960510254
        },
        {
          "worker_id": 1,
          "query_id": "q42",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000 AND d_moy = 11), filtered_item AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1)\nSELECT 2000 AS d_year, i.i_category_id, i.i_category, SUM(ss.ss_ext_sales_price) FROM filtered_date AS d JOIN store_sales AS ss ON d.d_date_sk = ss.ss_sold_date_sk JOIN filtered_item AS i ON ss.ss_item_sk = i.i_item_sk GROUP BY i.i_category_id, i.i_category ORDER BY SUM(ss.ss_ext_sales_price) DESC, d_year, i.i_category_id, i.i_category LIMIT 100",
          "prompt_tokens": 2559,
          "response_tokens": 306,
          "llm_time_ms": 118239.98856544495
        },
        {
          "worker_id": 2,
          "query_id": "q42",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_moy = 11 AND d_year = 2000), filtered_items AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1), joined_sales AS (SELECT ss.ss_ext_sales_price, fd.d_year, fi.i_category_id, fi.i_category FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items AS fi ON ss.ss_item_sk = fi.i_item_sk)\nSELECT d_year, i_category_id, i_category, SUM(ss_ext_sales_price) FROM joined_sales GROUP BY d_year, i_category_id, i_category ORDER BY SUM(ss_ext_sales_price) DESC, d_year, i_category_id, i_category LIMIT 100",
          "prompt_tokens": 2706,
          "response_tokens": 398,
          "llm_time_ms": 137036.3368988037
        },
        {
          "worker_id": 3,
          "query_id": "q42",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk, d_year FROM date_dim WHERE d_year = 2000 AND d_moy = 11), filtered_items AS (SELECT i_item_sk, i_category_id, i_category FROM item WHERE i_manager_id = 1)\nSELECT fd.d_year, fi.i_category_id, fi.i_category, SUM(ss_ext_sales_price) FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items AS fi ON ss.ss_item_sk = fi.i_item_sk GROUP BY fd.d_year, fi.i_category_id, fi.i_category ORDER BY SUM(ss_ext_sales_price) DESC, fd.d_year, fi.i_category_id, fi.i_category LIMIT 100",
          "prompt_tokens": 2723,
          "response_tokens": 359,
          "llm_time_ms": 132394.32764053345
        }
      ],
      "original_speedup": 0.97,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061956"
    },
    {
      "query_id": "q72",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q72",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_1999 AS (SELECT d_date_sk, d_date, d_week_seq FROM date_dim WHERE d_year = 1999), filtered_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D'), filtered_household AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000')\nSELECT i_item_desc, w_warehouse_name, d1.d_week_seq, SUM(CASE WHEN p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo, SUM(CASE WHEN NOT p_promo_sk IS NULL THEN 1 ELSE 0 END) AS promo, COUNT(*) AS total_cnt FROM catalog_sales JOIN inventory ON (cs_item_sk = inv_item_sk) JOIN warehouse ON (w_warehouse_sk = inv_warehouse_sk) JOIN item ON (i_item_sk = cs_item_sk) JOIN filtered_demographics AS cd ON (cs_bill_cdemo_sk = cd.cd_demo_sk) JOIN filtered_household AS hd ON (cs_bill_hdemo_sk = hd.hd_demo_sk) JOIN filtered_dates_1999 AS d1 ON (cs_sold_date_sk = d1.d_date_sk) JOIN filtered_dates_1999 AS d2 ON (inv_date_sk = d2.d_date_sk AND d1.d_week_seq = d2.d_week_seq) JOIN date_dim AS d3 ON (cs_ship_date_sk = d3.d_date_sk AND d3.d_date > d1.d_date + 5) LEFT OUTER JOIN promotion ON (cs_promo_sk = p_promo_sk) LEFT OUTER JOIN catalog_returns ON (cr_item_sk = cs_item_sk AND cr_order_number = cs_order_number) WHERE inv_quantity_on_hand < cs_quantity GROUP BY i_item_desc, w_warehouse_name, d1.d_week_seq ORDER BY total_cnt DESC NULLS FIRST, i_item_desc NULLS FIRST, w_warehouse_name NULLS FIRST, d1.d_week_seq NULLS FIRST LIMIT 100",
          "prompt_tokens": 4228,
          "response_tokens": 830,
          "llm_time_ms": 137069.10133361816
        },
        {
          "worker_id": 3,
          "query_id": "q72",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d1 AS (SELECT d_date_sk, d_week_seq, d_date FROM date_dim WHERE d_year = 1999), filtered_d2 AS (SELECT d_date_sk, d_week_seq FROM date_dim WHERE EXISTS(SELECT 1 FROM filtered_d1 WHERE filtered_d1.d_week_seq = date_dim.d_week_seq)), filtered_cd AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D'), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000')\nSELECT i_item_desc, w_warehouse_name, d1.d_week_seq, SUM(CASE WHEN p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo, SUM(CASE WHEN NOT p_promo_sk IS NULL THEN 1 ELSE 0 END) AS promo, COUNT(*) AS total_cnt FROM catalog_sales JOIN filtered_d1 AS d1 ON cs_sold_date_sk = d1.d_date_sk JOIN filtered_d2 AS d2 ON inv_date_sk = d2.d_date_sk JOIN inventory ON (cs_item_sk = inv_item_sk AND d1.d_week_seq = d2.d_week_seq) JOIN warehouse ON (w_warehouse_sk = inv_warehouse_sk) JOIN item ON (i_item_sk = cs_item_sk) JOIN filtered_cd ON (cs_bill_cdemo_sk = cd_demo_sk) JOIN filtered_hd ON (cs_bill_hdemo_sk = hd_demo_sk) JOIN date_dim AS d3 ON (cs_ship_date_sk = d3.d_date_sk) LEFT OUTER JOIN promotion ON (cs_promo_sk = p_promo_sk) LEFT OUTER JOIN catalog_returns ON (cr_item_sk = cs_item_sk AND cr_order_number = cs_order_number) WHERE inv_quantity_on_hand < cs_quantity AND d3.d_date > d1.d_date + 5 GROUP BY i_item_desc, w_warehouse_name, d1.d_week_seq ORDER BY total_cnt DESC NULLS FIRST, i_item_desc NULLS FIRST, w_warehouse_name NULLS FIRST, d1.d_week_seq NULLS FIRST LIMIT 100",
          "prompt_tokens": 3177,
          "response_tokens": 579,
          "llm_time_ms": 160557.3763847351
        },
        {
          "worker_id": 1,
          "query_id": "q72",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_d1 AS (SELECT d_date_sk, d_date, d_week_seq FROM date_dim WHERE d_year = 1999), filtered_d2 AS (SELECT d_date_sk, d_week_seq FROM date_dim WHERE d_week_seq IN (SELECT d_week_seq FROM filtered_d1)), filtered_d3 AS (SELECT d_date_sk, d_date FROM date_dim), filtered_cd AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D'), filtered_hd AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000')\nSELECT i_item_desc, w_warehouse_name, fd1.d_week_seq, SUM(CASE WHEN p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo, SUM(CASE WHEN NOT p_promo_sk IS NULL THEN 1 ELSE 0 END) AS promo, COUNT(*) AS total_cnt FROM catalog_sales AS cs JOIN filtered_d1 AS fd1 ON cs.cs_sold_date_sk = fd1.d_date_sk JOIN filtered_d2 AS fd2 ON fd1.d_week_seq = fd2.d_week_seq JOIN filtered_d3 AS fd3 ON cs.cs_ship_date_sk = fd3.d_date_sk AND fd3.d_date > fd1.d_date + 5 JOIN inventory AS inv ON inv.inv_item_sk = cs.cs_item_sk AND inv.inv_date_sk = fd2.d_date_sk AND inv.inv_quantity_on_hand < cs.cs_quantity JOIN warehouse AS w ON w.w_warehouse_sk = inv.inv_warehouse_sk JOIN item AS i ON i.i_item_sk = cs.cs_item_sk JOIN filtered_cd AS cd ON cs.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN filtered_hd AS hd ON cs.cs_bill_hdemo_sk = hd.hd_demo_sk LEFT OUTER JOIN promotion AS p ON cs.cs_promo_sk = p.p_promo_sk LEFT OUTER JOIN catalog_returns AS cr ON cr.cr_item_sk = cs.cs_item_sk AND cr.cr_order_number = cs.cs_order_number GROUP BY i_item_desc, w_warehouse_name, fd1.d_week_seq ORDER BY total_cnt DESC NULLS FIRST, i_item_desc NULLS FIRST, w_warehouse_name NULLS FIRST, fd1.d_week_seq NULLS FIRST LIMIT 100",
          "prompt_tokens": 3016,
          "response_tokens": 1085,
          "llm_time_ms": 161474.61366653442
        },
        {
          "worker_id": 2,
          "query_id": "q72",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH d1_dates AS (SELECT d_date_sk, d_week_seq, d_date FROM date_dim WHERE d_year = 1999), filtered_inventory AS (SELECT inv_item_sk, inv_warehouse_sk, inv_quantity_on_hand FROM inventory JOIN d1_dates AS d2 ON inv_date_sk = d2.d_date_sk), filtered_catalog_sales AS (SELECT cs_item_sk, cs_order_number, cs_bill_cdemo_sk, cs_bill_hdemo_sk, cs_sold_date_sk, cs_ship_date_sk, cs_quantity, cs_promo_sk FROM catalog_sales JOIN d1_dates AS d1 ON cs_sold_date_sk = d1.d_date_sk JOIN date_dim AS d3 ON cs_ship_date_sk = d3.d_date_sk WHERE d3.d_date > d1.d_date + 5), filtered_customer_demographics AS (SELECT cd_demo_sk FROM customer_demographics WHERE cd_marital_status = 'D'), filtered_household_demographics AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_buy_potential = '>10000'), joined_facts AS (SELECT cs_item_sk, cs_order_number, cs_quantity, cs_promo_sk, inv_warehouse_sk, inv_quantity_on_hand FROM filtered_catalog_sales AS cs JOIN filtered_inventory AS inv ON cs.cs_item_sk = inv.inv_item_sk AND EXISTS(SELECT 1 FROM d1_dates AS d1, d1_dates AS d2 WHERE cs.cs_sold_date_sk = d1.d_date_sk AND inv.inv_date_sk = d2.d_date_sk AND d1.d_week_seq = d2.d_week_seq) WHERE inv_quantity_on_hand < cs_quantity)\nSELECT i.i_item_desc, w.w_warehouse_name, d1.d_week_seq, SUM(CASE WHEN p.p_promo_sk IS NULL THEN 1 ELSE 0 END) AS no_promo, SUM(CASE WHEN NOT p.p_promo_sk IS NULL THEN 1 ELSE 0 END) AS promo, COUNT(*) AS total_cnt FROM joined_facts AS jf JOIN item AS i ON jf.cs_item_sk = i.i_item_sk JOIN warehouse AS w ON jf.inv_warehouse_sk = w.w_warehouse_sk JOIN d1_dates AS d1 ON jf.cs_sold_date_sk = d1.d_date_sk JOIN filtered_customer_demographics AS cd ON jf.cs_bill_cdemo_sk = cd.cd_demo_sk JOIN filtered_household_demographics AS hd ON jf.cs_bill_hdemo_sk = hd.hd_demo_sk LEFT OUTER JOIN promotion AS p ON jf.cs_promo_sk = p.p_promo_sk LEFT OUTER JOIN catalog_returns AS cr ON jf.cs_item_sk = cr.cr_item_sk AND jf.cs_order_number = cr.cr_order_number GROUP BY i.i_item_desc, w.w_warehouse_name, d1.d_week_seq ORDER BY total_cnt DESC, i.i_item_desc, w.w_warehouse_name, d1.d_week_seq LIMIT 100",
          "prompt_tokens": 3161,
          "response_tokens": 1389,
          "llm_time_ms": 215448.157787323
        }
      ],
      "original_speedup": 0.97,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061960"
    },
    {
      "query_id": "q36",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 2,
          "query_id": "q36",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_state = 'TN'), filtered_sales AS (SELECT ss_item_sk, ss_store_sk, ss_net_profit, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk), joined_facts AS (SELECT fs.ss_item_sk, fs.ss_net_profit, fs.ss_ext_sales_price, fs.ss_store_sk FROM filtered_sales AS fs JOIN filtered_stores AS fs2 ON fs.ss_store_sk = fs2.s_store_sk), results AS (SELECT SUM(jf.ss_net_profit) AS ss_net_profit, SUM(jf.ss_ext_sales_price) AS ss_ext_sales_price, (SUM(jf.ss_net_profit) * 1.0000) / SUM(jf.ss_ext_sales_price) AS gross_margin, i.i_category, i.i_class, 0 AS g_category, 0 AS g_class FROM joined_facts AS jf JOIN item AS i ON jf.ss_item_sk = i.i_item_sk GROUP BY i.i_category, i.i_class), results_rollup AS (SELECT gross_margin, i_category, i_class, 0 AS t_category, 0 AS t_class, 0 AS lochierarchy FROM results UNION SELECT (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, i_category, NULL AS i_class, 0 AS t_category, 1 AS t_class, 1 AS lochierarchy FROM results GROUP BY i_category UNION SELECT (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, NULL AS i_category, NULL AS i_class, 1 AS t_category, 1 AS t_class, 2 AS lochierarchy FROM results)\nSELECT gross_margin, i_category, i_class, lochierarchy, RANK() OVER (PARTITION BY lochierarchy, CASE WHEN t_class = 0 THEN i_category END ORDER BY gross_margin ASC) AS rank_within_parent FROM results_rollup ORDER BY lochierarchy DESC NULLS FIRST, CASE WHEN lochierarchy = 0 THEN i_category END NULLS FIRST, rank_within_parent NULLS FIRST LIMIT 100",
          "prompt_tokens": 3368,
          "response_tokens": 620,
          "llm_time_ms": 132384.54842567444
        },
        {
          "worker_id": 1,
          "query_id": "q36",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), filtered_store AS (SELECT s_store_sk FROM store WHERE s_state = 'TN'), filtered_sales AS (SELECT ss_net_profit, ss_ext_sales_price, ss_item_sk, ss_store_sk FROM store_sales JOIN filtered_date ON ss_sold_date_sk = d_date_sk), results AS (SELECT SUM(fs.ss_net_profit) AS ss_net_profit, SUM(fs.ss_ext_sales_price) AS ss_ext_sales_price, (SUM(fs.ss_net_profit) * 1.0000) / SUM(fs.ss_ext_sales_price) AS gross_margin, i.i_category, i.i_class, 0 AS g_category, 0 AS g_class FROM filtered_sales AS fs JOIN filtered_store AS s ON fs.ss_store_sk = s.s_store_sk JOIN item AS i ON fs.ss_item_sk = i.i_item_sk GROUP BY i.i_category, i.i_class), results_rollup AS (SELECT gross_margin, i_category, i_class, 0 AS t_category, 0 AS t_class, 0 AS lochierarchy FROM results UNION ALL SELECT (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, i_category, NULL AS i_class, 0 AS t_category, 1 AS t_class, 1 AS lochierarchy FROM results GROUP BY i_category UNION ALL SELECT (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, NULL AS i_category, NULL AS i_class, 1 AS t_category, 1 AS t_class, 2 AS lochierarchy FROM results)\nSELECT gross_margin, i_category, i_class, lochierarchy, RANK() OVER (PARTITION BY lochierarchy, CASE WHEN t_class = 0 THEN i_category END ORDER BY gross_margin ASC) AS rank_within_parent FROM results_rollup ORDER BY lochierarchy DESC NULLS FIRST, CASE WHEN lochierarchy = 0 THEN i_category END NULLS FIRST, rank_within_parent NULLS FIRST LIMIT 100",
          "prompt_tokens": 3221,
          "response_tokens": 836,
          "llm_time_ms": 164864.39442634583
        },
        {
          "worker_id": 3,
          "query_id": "q36",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_state = 'TN'), results AS (SELECT SUM(ss_net_profit) AS ss_net_profit, SUM(ss_ext_sales_price) AS ss_ext_sales_price, (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, i_category, i_class, 0 AS g_category, 0 AS g_class FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk JOIN item ON i_item_sk = ss_item_sk JOIN filtered_stores ON s_store_sk = ss_store_sk GROUP BY i_category, i_class), results_rollup AS (SELECT gross_margin, i_category, i_class, 0 AS t_category, 0 AS t_class, 0 AS lochierarchy FROM results UNION SELECT (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, i_category, NULL AS i_class, 0 AS t_category, 1 AS t_class, 1 AS lochierarchy FROM results GROUP BY i_category UNION SELECT (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, NULL AS i_category, NULL AS i_class, 1 AS t_category, 1 AS t_class, 2 AS lochierarchy FROM results)\nSELECT gross_margin, i_category, i_class, lochierarchy, RANK() OVER (PARTITION BY lochierarchy, CASE WHEN t_class = 0 THEN i_category END ORDER BY gross_margin ASC) AS rank_within_parent FROM results_rollup ORDER BY lochierarchy DESC NULLS FIRST, CASE WHEN lochierarchy = 0 THEN i_category END NULLS FIRST, rank_within_parent NULLS FIRST LIMIT 100",
          "prompt_tokens": 3384,
          "response_tokens": 312,
          "llm_time_ms": 160592.0057296753
        },
        {
          "worker_id": 4,
          "query_id": "q36",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), filtered_store AS (SELECT s_store_sk FROM store WHERE s_state = 'TN'), results AS (SELECT SUM(ss_net_profit) AS ss_net_profit, SUM(ss_ext_sales_price) AS ss_ext_sales_price, (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, i_category, i_class, 0 AS g_category, 0 AS g_class FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON i_item_sk = ss_item_sk JOIN filtered_store ON s_store_sk = ss_store_sk GROUP BY i_category, i_class), results_rollup AS (SELECT gross_margin, i_category, i_class, 0 AS t_category, 0 AS t_class, 0 AS lochierarchy FROM results UNION SELECT (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, i_category, NULL AS i_class, 0 AS t_category, 1 AS t_class, 1 AS lochierarchy FROM results GROUP BY i_category UNION SELECT (SUM(ss_net_profit) * 1.0000) / SUM(ss_ext_sales_price) AS gross_margin, NULL AS i_category, NULL AS i_class, 1 AS t_category, 1 AS t_class, 2 AS lochierarchy FROM results)\nSELECT gross_margin, i_category, i_class, lochierarchy, RANK() OVER (PARTITION BY lochierarchy, CASE WHEN t_class = 0 THEN i_category END ORDER BY gross_margin ASC) AS rank_within_parent FROM results_rollup ORDER BY lochierarchy DESC NULLS FIRST, CASE WHEN lochierarchy = 0 THEN i_category END NULLS FIRST, rank_within_parent NULLS FIRST LIMIT 100",
          "prompt_tokens": 4437,
          "response_tokens": 963,
          "llm_time_ms": 163556.86378479004
        }
      ],
      "original_speedup": 0.96,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061963"
    },
    {
      "query_id": "q71",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 4,
          "query_id": "q71",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999), filtered_times AS (SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time = 'breakfast' OR t_meal_time = 'dinner')\nSELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM (SELECT ws_ext_sales_price AS ext_price, ws_sold_date_sk AS sold_date_sk, ws_item_sk AS sold_item_sk, ws_sold_time_sk AS time_sk FROM web_sales WHERE EXISTS(SELECT 1 FROM filtered_dates WHERE d_date_sk = ws_sold_date_sk) UNION ALL SELECT cs_ext_sales_price AS ext_price, cs_sold_date_sk AS sold_date_sk, cs_item_sk AS sold_item_sk, cs_sold_time_sk AS time_sk FROM catalog_sales WHERE EXISTS(SELECT 1 FROM filtered_dates WHERE d_date_sk = cs_sold_date_sk) UNION ALL SELECT ss_ext_sales_price AS ext_price, ss_sold_date_sk AS sold_date_sk, ss_item_sk AS sold_item_sk, ss_sold_time_sk AS time_sk FROM store_sales WHERE EXISTS(SELECT 1 FROM filtered_dates WHERE d_date_sk = ss_sold_date_sk)) AS tmp JOIN item ON sold_item_sk = i_item_sk AND i_manager_id = 1 JOIN filtered_times ON time_sk = t_time_sk GROUP BY i_brand, i_brand_id, t_hour, t_minute ORDER BY ext_price DESC NULLS FIRST, i_brand_id NULLS FIRST, t_hour NULLS FIRST",
          "prompt_tokens": 4189,
          "response_tokens": 1216,
          "llm_time_ms": 172553.70116233826
        },
        {
          "worker_id": 3,
          "query_id": "q71",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999), filtered_time AS (SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time = 'breakfast' OR t_meal_time = 'dinner'), sales_union AS (SELECT ws_ext_sales_price AS ext_price, ws_sold_date_sk AS sold_date_sk, ws_item_sk AS sold_item_sk, ws_sold_time_sk AS time_sk FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk UNION ALL SELECT cs_ext_sales_price AS ext_price, cs_sold_date_sk AS sold_date_sk, cs_item_sk AS sold_item_sk, cs_sold_time_sk AS time_sk FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk UNION ALL SELECT ss_ext_sales_price AS ext_price, ss_sold_date_sk AS sold_date_sk, ss_item_sk AS sold_item_sk, ss_sold_time_sk AS time_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk)\nSELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM sales_union JOIN item ON sold_item_sk = i_item_sk AND i_manager_id = 1 JOIN filtered_time ON time_sk = t_time_sk GROUP BY i_brand, i_brand_id, t_hour, t_minute ORDER BY ext_price DESC NULLS FIRST, i_brand_id NULLS FIRST, t_hour NULLS FIRST",
          "prompt_tokens": 3140,
          "response_tokens": 883,
          "llm_time_ms": 208476.81498527527
        },
        {
          "worker_id": 2,
          "query_id": "q71",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999), web_sales_filtered AS (SELECT ws_ext_sales_price AS ext_price, ws_item_sk AS sold_item_sk, ws_sold_time_sk AS time_sk FROM web_sales JOIN filtered_dates ON web_sales.ws_sold_date_sk = filtered_dates.d_date_sk), catalog_sales_filtered AS (SELECT cs_ext_sales_price AS ext_price, cs_item_sk AS sold_item_sk, cs_sold_time_sk AS time_sk FROM catalog_sales JOIN filtered_dates ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk), store_sales_filtered AS (SELECT ss_ext_sales_price AS ext_price, ss_item_sk AS sold_item_sk, ss_sold_time_sk AS time_sk FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk), filtered_item AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 1), breakfast_times AS (SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time = 'breakfast'), dinner_times AS (SELECT t_time_sk, t_hour, t_minute FROM time_dim WHERE t_meal_time = 'dinner')\nSELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM (SELECT ext_price, sold_item_sk, time_sk FROM web_sales_filtered UNION ALL SELECT ext_price, sold_item_sk, time_sk FROM catalog_sales_filtered UNION ALL SELECT ext_price, sold_item_sk, time_sk FROM store_sales_filtered) AS sales UNION ALL JOIN filtered_item ON sales.sold_item_sk = filtered_item.i_item_sk JOIN breakfast_times ON sales.time_sk = breakfast_times.t_time_sk UNION ALL SELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM (SELECT ext_price, sold_item_sk, time_sk FROM web_sales_filtered UNION ALL SELECT ext_price, sold_item_sk, time_sk FROM catalog_sales_filtered UNION ALL SELECT ext_price, sold_item_sk, time_sk FROM store_sales_filtered) AS sales JOIN filtered_item ON sales.sold_item_sk = filtered_item.i_item_sk JOIN dinner_times ON sales.time_sk = dinner_times.t_time_sk GROUP BY i_brand_id, i_brand, t_hour, t_minute ORDER BY ext_price DESC NULLS FIRST, i_brand_id NULLS FIRST, t_hour NULLS FIRST LIMIT 100",
          "prompt_tokens": 3120,
          "response_tokens": 1247,
          "llm_time_ms": 190546.9994544983
        },
        {
          "worker_id": 1,
          "query_id": "q71",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999), web_filtered AS (SELECT ws_ext_sales_price AS ext_price, ws_sold_time_sk AS time_sk, ws_item_sk FROM web_sales JOIN filtered_dates ON d_date_sk = ws_sold_date_sk), catalog_filtered AS (SELECT cs_ext_sales_price AS ext_price, cs_sold_time_sk AS time_sk, cs_item_sk FROM catalog_sales JOIN filtered_dates ON d_date_sk = cs_sold_date_sk), store_filtered AS (SELECT ss_ext_sales_price AS ext_price, ss_sold_time_sk AS time_sk, ss_item_sk FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk), sales_union AS (SELECT ext_price, time_sk, sold_item_sk FROM web_filtered UNION ALL SELECT ext_price, time_sk, sold_item_sk FROM catalog_filtered UNION ALL SELECT ext_price, time_sk, sold_item_sk FROM store_filtered)\nSELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM sales_union AS su JOIN item AS i ON su.sold_item_sk = i.i_item_sk JOIN time_dim AS t ON su.time_sk = t.t_time_sk WHERE i_manager_id = 1 AND (t_meal_time = 'breakfast' OR t_meal_time = 'dinner') GROUP BY i_brand, i_brand_id, t_hour, t_minute ORDER BY ext_price DESC NULLS FIRST, i_brand_id NULLS FIRST, t_hour NULLS FIRST",
          "prompt_tokens": 2976,
          "response_tokens": 488,
          "llm_time_ms": 277586.9414806366
        }
      ],
      "original_speedup": 0.96,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061968"
    },
    {
      "query_id": "q98",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 3,
          "query_id": "q98",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE))\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ss_ext_sales_price) AS itemrevenue, SUM(ss_ext_sales_price) * 100.0000 / SUM(SUM(ss_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN item ON ss_item_sk = i_item_sk WHERE i_category IN ('Sports', 'Books', 'Home') GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST",
          "prompt_tokens": 2885,
          "response_tokens": 661,
          "llm_time_ms": 152875.37240982056
        },
        {
          "worker_id": 1,
          "query_id": "q98",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), item_filtered AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), filtered_sales AS (SELECT ss_item_sk, ss_ext_sales_price, i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM store_sales AS ss JOIN date_filtered AS df ON ss.ss_sold_date_sk = df.d_date_sk JOIN item_filtered AS it ON ss.ss_item_sk = it.i_item_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ss_ext_sales_price) AS itemrevenue, SUM(ss_ext_sales_price) * 100.0000 / SUM(SUM(ss_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM filtered_sales GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST",
          "prompt_tokens": 2718,
          "response_tokens": 447,
          "llm_time_ms": 149654.01792526245
        },
        {
          "worker_id": 4,
          "query_id": "q98",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), qualified_sales AS (SELECT ss.ss_ext_sales_price, i.i_item_id, i.i_item_desc, i.i_category, i.i_class, i.i_current_price FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_items AS i ON ss.ss_item_sk = i.i_item_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ss_ext_sales_price) AS itemrevenue, SUM(ss_ext_sales_price) * 100.0000 / SUM(SUM(ss_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM qualified_sales GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST",
          "prompt_tokens": 3937,
          "response_tokens": 419,
          "llm_time_ms": 165745.4810142517
        },
        {
          "worker_id": 2,
          "query_id": "q98",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('1999-02-22' AS DATE) AND CAST('1999-03-24' AS DATE)), filtered_sales AS (SELECT ss_item_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk), filtered_items AS (SELECT i_item_sk, i_item_id, i_item_desc, i_category, i_class, i_current_price FROM item WHERE i_category IN ('Sports', 'Books', 'Home')), joined_sales_items AS (SELECT fs.ss_ext_sales_price, fi.i_item_id, fi.i_item_desc, fi.i_category, fi.i_class, fi.i_current_price FROM filtered_sales AS fs JOIN filtered_items AS fi ON fs.ss_item_sk = fi.i_item_sk)\nSELECT i_item_id, i_item_desc, i_category, i_class, i_current_price, SUM(ss_ext_sales_price) AS itemrevenue, SUM(ss_ext_sales_price) * 100.0000 / SUM(SUM(ss_ext_sales_price)) OVER (PARTITION BY i_class) AS revenueratio FROM joined_sales_items GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price ORDER BY i_category NULLS FIRST, i_class NULLS FIRST, i_item_id NULLS FIRST, i_item_desc NULLS FIRST, revenueratio NULLS FIRST",
          "prompt_tokens": 2868,
          "response_tokens": 798,
          "llm_time_ms": 209017.5964832306
        }
      ],
      "original_speedup": 0.96,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061971"
    },
    {
      "query_id": "q14",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q14",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_three_years AS (SELECT d_date_sk FROM date_dim WHERE d_year BETWEEN 1999 AND 1999 + 2), date_nov_2001 AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 + 2 AND d_moy = 11), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales JOIN date_three_years ON ss_sold_date_sk = d_date_sk UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales JOIN date_three_years ON cs_sold_date_sk = d_date_sk UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales JOIN date_three_years ON ws_sold_date_sk = d_date_sk) AS sq2), cross_items_improved AS (SELECT i_item_sk AS ss_item_sk FROM item JOIN (SELECT DISTINCT i_brand_id AS brand_id, i_class_id AS class_id, i_category_id AS category_id FROM store_sales JOIN item AS iss ON ss_item_sk = iss.i_item_sk JOIN date_three_years AS d1 ON ss_sold_date_sk = d1.d_date_sk INTERSECT SELECT DISTINCT i_brand_id, i_class_id, i_category_id FROM catalog_sales JOIN item AS ics ON cs_item_sk = ics.i_item_sk JOIN date_three_years AS d2 ON cs_sold_date_sk = d2.d_date_sk INTERSECT SELECT DISTINCT i_brand_id, i_class_id, i_category_id FROM web_sales JOIN item AS iws ON ws_item_sk = iws.i_item_sk JOIN date_three_years AS d3 ON ws_sold_date_sk = d3.d_date_sk) AS sq1 ON i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id), cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item, (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales, item AS iss, date_dim AS d1 WHERE ss_item_sk = iss.i_item_sk AND ss_sold_date_sk = d1.d_date_sk AND d1.d_year BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales, item AS ics, date_dim AS d2 WHERE cs_item_sk = ics.i_item_sk AND cs_sold_date_sk = d2.d_date_sk AND d2.d_year BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales, item AS iws, date_dim AS d3 WHERE ws_item_sk = iws.i_item_sk AND ws_sold_date_sk = d3.d_date_sk AND d3.d_year BETWEEN 1999 AND 1999 + 2) AS sq1 WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id)\nSELECT channel, i_brand_id, i_class_id, i_category_id, SUM(sales) AS sum_sales, SUM(number_sales) AS sum_number_sales FROM (SELECT 'store' AS channel, i.i_brand_id, i.i_class_id, i.i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales AS ss JOIN date_nov_2001 AS dn ON ss.ss_sold_date_sk = dn.d_date_sk JOIN item AS i ON ss.ss_item_sk = i.i_item_sk WHERE ss.ss_item_sk IN (SELECT ss_item_sk FROM cross_items_improved) GROUP BY i.i_brand_id, i.i_class_id, i.i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales) UNION ALL SELECT 'catalog' AS channel, i.i_brand_id, i.i_class_id, i.i_category_id, SUM(cs_quantity * cs_list_price) AS sales, COUNT(*) AS number_sales FROM catalog_sales AS cs JOIN date_nov_2001 AS dn ON cs.cs_sold_date_sk = dn.d_date_sk JOIN item AS i ON cs.cs_item_sk = i.i_item_sk WHERE cs.cs_item_sk IN (SELECT ss_item_sk FROM cross_items_improved) GROUP BY i.i_brand_id, i.i_class_id, i.i_category_id HAVING SUM(cs_quantity * cs_list_price) > (SELECT average_sales FROM avg_sales) UNION ALL SELECT 'web' AS channel, i.i_brand_id, i.i_class_id, i.i_category_id, SUM(ws_quantity * ws_list_price) AS sales, COUNT(*) AS number_sales FROM web_sales AS ws JOIN date_nov_2001 AS dn ON ws.ws_sold_date_sk = dn.d_date_sk JOIN item AS i ON ws.ws_item_sk = i.i_item_sk WHERE ws.ws_item_sk IN (SELECT ss_item_sk FROM cross_items_improved) GROUP BY i.i_brand_id, i.i_class_id, i.i_category_id HAVING SUM(ws_quantity * ws_list_price) > (SELECT average_sales FROM avg_sales)) AS y GROUP BY ROLLUP (channel, i_brand_id, i_class_id, i_category_id) ORDER BY channel NULLS FIRST, i_brand_id NULLS FIRST, i_class_id NULLS FIRST, i_category_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 3949,
          "response_tokens": 1705,
          "llm_time_ms": 177449.1903781891
        },
        {
          "worker_id": 2,
          "query_id": "q14",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH nov_2001_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 11), three_year_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year BETWEEN 1999 AND 2001), materialized_cross_items AS (SELECT ss_item_sk FROM (SELECT i_item_sk AS ss_item_sk FROM item, (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales JOIN three_year_dates ON store_sales.ss_sold_date_sk = three_year_dates.d_date_sk JOIN item AS iss ON store_sales.ss_item_sk = iss.i_item_sk INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales JOIN three_year_dates ON catalog_sales.cs_sold_date_sk = three_year_dates.d_date_sk JOIN item AS ics ON catalog_sales.cs_item_sk = ics.i_item_sk INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales JOIN three_year_dates ON web_sales.ws_sold_date_sk = three_year_dates.d_date_sk JOIN item AS iws ON web_sales.ws_item_sk = iws.i_item_sk) AS sq1 WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id) AS items), filtered_store_sales AS (SELECT ss_item_sk, ss_quantity, ss_list_price FROM store_sales JOIN nov_2001_dates ON store_sales.ss_sold_date_sk = nov_2001_dates.d_date_sk WHERE ss_item_sk IN (SELECT ss_item_sk FROM materialized_cross_items)), filtered_catalog_sales AS (SELECT cs_item_sk, cs_quantity, cs_list_price FROM catalog_sales JOIN nov_2001_dates ON catalog_sales.cs_sold_date_sk = nov_2001_dates.d_date_sk WHERE cs_item_sk IN (SELECT ss_item_sk FROM materialized_cross_items)), filtered_web_sales AS (SELECT ws_item_sk, ws_quantity, ws_list_price FROM web_sales JOIN nov_2001_dates ON web_sales.ws_sold_date_sk = nov_2001_dates.d_date_sk WHERE ws_item_sk IN (SELECT ss_item_sk FROM materialized_cross_items)), avg_sales_optimized AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales JOIN three_year_dates ON store_sales.ss_sold_date_sk = three_year_dates.d_date_sk UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales JOIN three_year_dates ON catalog_sales.cs_sold_date_sk = three_year_dates.d_date_sk UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales JOIN three_year_dates ON web_sales.ws_sold_date_sk = three_year_dates.d_date_sk) AS sq2), cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item, (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales, item AS iss, date_dim AS d1 WHERE ss_item_sk = iss.i_item_sk AND ss_sold_date_sk = d1.d_date_sk AND d1.d_year BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales, item AS ics, date_dim AS d2 WHERE cs_item_sk = ics.i_item_sk AND cs_sold_date_sk = d2.d_date_sk AND d2.d_year BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales, item AS iws, date_dim AS d3 WHERE ws_item_sk = iws.i_item_sk AND ws_sold_date_sk = d3.d_date_sk AND d3.d_year BETWEEN 1999 AND 1999 + 2) AS sq1 WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales, date_dim WHERE ss_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales, date_dim WHERE cs_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2 UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales, date_dim WHERE ws_sold_date_sk = d_date_sk AND d_year BETWEEN 1999 AND 1999 + 2) AS sq2)\nSELECT channel, i_brand_id, i_class_id, i_category_id, SUM(sales) AS sum_sales, SUM(number_sales) AS sum_number_sales FROM (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM filtered_store_sales, item WHERE ss_item_sk = i_item_sk GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales_optimized) UNION ALL SELECT 'catalog' AS channel, i_brand_id, i_class_id, i_category_id, SUM(cs_quantity * cs_list_price) AS sales, COUNT(*) AS number_sales FROM filtered_catalog_sales, item WHERE cs_item_sk = i_item_sk GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(cs_quantity * cs_list_price) > (SELECT average_sales FROM avg_sales_optimized) UNION ALL SELECT 'web' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ws_quantity * ws_list_price) AS sales, COUNT(*) AS number_sales FROM filtered_web_sales, item WHERE ws_item_sk = i_item_sk GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ws_quantity * ws_list_price) > (SELECT average_sales FROM avg_sales_optimized)) AS y GROUP BY ROLLUP (channel, i_brand_id, i_class_id, i_category_id) ORDER BY channel NULLS FIRST, i_brand_id NULLS FIRST, i_class_id NULLS FIRST, i_category_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 4096,
          "response_tokens": 1341,
          "llm_time_ms": 183566.79916381836
        },
        {
          "worker_id": 4,
          "query_id": "q14",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH dates_main AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 11), dates_3years AS (SELECT d_date_sk FROM date_dim WHERE d_year BETWEEN 1999 AND 2001), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales JOIN dates_3years ON ss_sold_date_sk = d_date_sk UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales JOIN dates_3years ON cs_sold_date_sk = d_date_sk UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales JOIN dates_3years ON ws_sold_date_sk = d_date_sk) AS sq2), cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item, (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales, item AS iss, date_dim AS d1 WHERE ss_item_sk = iss.i_item_sk AND ss_sold_date_sk = d1.d_date_sk AND d1.d_year BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales, item AS ics, date_dim AS d2 WHERE cs_item_sk = ics.i_item_sk AND cs_sold_date_sk = d2.d_date_sk AND d2.d_year BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales, item AS iws, date_dim AS d3 WHERE ws_item_sk = iws.i_item_sk AND ws_sold_date_sk = d3.d_date_sk AND d3.d_year BETWEEN 1999 AND 1999 + 2) AS sq1 WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id)\nSELECT channel, i_brand_id, i_class_id, i_category_id, SUM(sales) AS sum_sales, SUM(number_sales) AS sum_number_sales FROM (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales, item, date_dim WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1999 + 2 AND d_moy = 11 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales) UNION ALL SELECT 'catalog' AS channel, i_brand_id, i_class_id, i_category_id, SUM(cs_quantity * cs_list_price) AS sales, COUNT(*) AS number_sales FROM catalog_sales, item, date_dim WHERE cs_item_sk IN (SELECT ss_item_sk FROM cross_items) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1999 + 2 AND d_moy = 11 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(cs_quantity * cs_list_price) > (SELECT average_sales FROM avg_sales) UNION ALL SELECT 'web' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ws_quantity * ws_list_price) AS sales, COUNT(*) AS number_sales FROM web_sales, item, date_dim WHERE ws_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1999 + 2 AND d_moy = 11 GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ws_quantity * ws_list_price) > (SELECT average_sales FROM avg_sales)) AS y GROUP BY ROLLUP (channel, i_brand_id, i_class_id, i_category_id) ORDER BY channel NULLS FIRST, i_brand_id NULLS FIRST, i_class_id NULLS FIRST, i_category_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 5171,
          "response_tokens": 1261,
          "llm_time_ms": 196738.42883110046
        },
        {
          "worker_id": 3,
          "query_id": "q14",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates_main AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 + 2 AND d_moy = 11), filtered_dates_cross AS (SELECT d_date_sk FROM date_dim WHERE d_year BETWEEN 1999 AND 1999 + 2), avg_sales AS (SELECT AVG(quantity * list_price) AS average_sales FROM (SELECT ss_quantity AS quantity, ss_list_price AS list_price FROM store_sales JOIN filtered_dates_cross ON ss_sold_date_sk = d_date_sk UNION ALL SELECT cs_quantity AS quantity, cs_list_price AS list_price FROM catalog_sales JOIN filtered_dates_cross ON cs_sold_date_sk = d_date_sk UNION ALL SELECT ws_quantity AS quantity, ws_list_price AS list_price FROM web_sales JOIN filtered_dates_cross ON ws_sold_date_sk = d_date_sk) AS sq2), cross_items AS (SELECT i_item_sk AS ss_item_sk FROM item, (SELECT iss.i_brand_id AS brand_id, iss.i_class_id AS class_id, iss.i_category_id AS category_id FROM store_sales, item AS iss, filtered_dates_cross AS d1 WHERE ss_item_sk = iss.i_item_sk AND ss_sold_date_sk = d1.d_date_sk INTERSECT SELECT ics.i_brand_id, ics.i_class_id, ics.i_category_id FROM catalog_sales, item AS ics, filtered_dates_cross AS d2 WHERE cs_item_sk = ics.i_item_sk AND cs_sold_date_sk = d2.d_date_sk INTERSECT SELECT iws.i_brand_id, iws.i_class_id, iws.i_category_id FROM web_sales, item AS iws, filtered_dates_cross AS d3 WHERE ws_item_sk = iws.i_item_sk AND ws_sold_date_sk = d3.d_date_sk) AS sq1 WHERE i_brand_id = brand_id AND i_class_id = class_id AND i_category_id = category_id)\nSELECT channel, i_brand_id, i_class_id, i_category_id, SUM(sales) AS sum_sales, SUM(number_sales) AS sum_number_sales FROM (SELECT 'store' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ss_quantity * ss_list_price) AS sales, COUNT(*) AS number_sales FROM store_sales, item, filtered_dates_main WHERE ss_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ss_quantity * ss_list_price) > (SELECT average_sales FROM avg_sales) UNION ALL SELECT 'catalog' AS channel, i_brand_id, i_class_id, i_category_id, SUM(cs_quantity * cs_list_price) AS sales, COUNT(*) AS number_sales FROM catalog_sales, item, filtered_dates_main WHERE cs_item_sk IN (SELECT ss_item_sk FROM cross_items) AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(cs_quantity * cs_list_price) > (SELECT average_sales FROM avg_sales) UNION ALL SELECT 'web' AS channel, i_brand_id, i_class_id, i_category_id, SUM(ws_quantity * ws_list_price) AS sales, COUNT(*) AS number_sales FROM web_sales, item, filtered_dates_main WHERE ws_item_sk IN (SELECT ss_item_sk FROM cross_items) AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk GROUP BY i_brand_id, i_class_id, i_category_id HAVING SUM(ws_quantity * ws_list_price) > (SELECT average_sales FROM avg_sales)) AS y GROUP BY ROLLUP (channel, i_brand_id, i_class_id, i_category_id) ORDER BY channel NULLS FIRST, i_brand_id NULLS FIRST, i_class_id NULLS FIRST, i_category_id NULLS FIRST LIMIT 100",
          "prompt_tokens": 4115,
          "response_tokens": 1021,
          "llm_time_ms": 199156.42714500427
        }
      ],
      "original_speedup": 0.95,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061974"
    },
    {
      "query_id": "q68",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q68",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 2 AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), filtered_hh_demo AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 4 OR hd_vehicle_count = 3), store_sales_agg AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_ext_sales_price) AS extended_price, SUM(ss_ext_list_price) AS list_price, SUM(ss_ext_tax) AS extended_tax FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN filtered_hh_demo ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city)\nSELECT c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price FROM store_sales_agg AS dn JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_address AS current_addr ON customer.c_current_addr_sk = current_addr.ca_address_sk WHERE current_addr.ca_city <> bought_city ORDER BY c_last_name NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100",
          "prompt_tokens": 2965,
          "response_tokens": 476,
          "llm_time_ms": 190663.2685661316
        },
        {
          "worker_id": 2,
          "query_id": "q68",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 2 AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), branch1_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city, ss_ext_sales_price, ss_ext_list_price, ss_ext_tax FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_stores ON store_sales.ss_store_sk = filtered_stores.s_store_sk JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk WHERE household_demographics.hd_dep_count = 4), branch2_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city, ss_ext_sales_price, ss_ext_list_price, ss_ext_tax FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN filtered_stores ON store_sales.ss_store_sk = filtered_stores.s_store_sk JOIN household_demographics ON store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk JOIN customer_address ON store_sales.ss_addr_sk = customer_address.ca_address_sk WHERE household_demographics.hd_vehicle_count = 3 AND household_demographics.hd_dep_count <> 4), union_sales AS (SELECT * FROM branch1_sales UNION ALL SELECT * FROM branch2_sales), grouped_sales AS (SELECT ss_ticket_number, ss_customer_sk, ca_city AS bought_city, SUM(ss_ext_sales_price) AS extended_price, SUM(ss_ext_list_price) AS list_price, SUM(ss_ext_tax) AS extended_tax FROM union_sales GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city)\nSELECT c_last_name, c_first_name, current_addr.ca_city, grouped_sales.bought_city, grouped_sales.ss_ticket_number, grouped_sales.extended_price, grouped_sales.extended_tax, grouped_sales.list_price FROM grouped_sales JOIN customer ON grouped_sales.ss_customer_sk = customer.c_customer_sk JOIN customer_address AS current_addr ON customer.c_current_addr_sk = current_addr.ca_address_sk WHERE current_addr.ca_city <> grouped_sales.bought_city ORDER BY c_last_name NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100",
          "prompt_tokens": 3115,
          "response_tokens": 746,
          "llm_time_ms": 189195.32775878906
        },
        {
          "worker_id": 3,
          "query_id": "q68",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 2 AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), union_branch1 AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_ext_sales_price) AS extended_price, SUM(ss_ext_list_price) AS list_price, SUM(ss_ext_tax) AS extended_tax FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE hd_dep_count = 4 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city), union_branch2 AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_ext_sales_price) AS extended_price, SUM(ss_ext_list_price) AS list_price, SUM(ss_ext_tax) AS extended_tax FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE hd_vehicle_count = 3 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city)\nSELECT c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price FROM (SELECT * FROM union_branch1 UNION ALL SELECT * FROM union_branch2) AS dn JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_address AS current_addr ON c_current_addr_sk = current_addr.ca_address_sk WHERE current_addr.ca_city <> bought_city ORDER BY c_last_name NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100",
          "prompt_tokens": 3129,
          "response_tokens": 600,
          "llm_time_ms": 264342.0822620392
        },
        {
          "worker_id": 4,
          "query_id": "q68",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 2 AND d_year IN (1999, 2000, 2001)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), filtered_hd_dep AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 4), filtered_hd_vehicle AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_vehicle_count = 3), sales_union AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_ext_sales_price, ss_ext_list_price, ss_ext_tax, ca_city AS bought_city FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd_dep ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk UNION ALL SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_ext_sales_price, ss_ext_list_price, ss_ext_tax, ca_city AS bought_city FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_store ON ss_store_sk = s_store_sk JOIN filtered_hd_vehicle ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk)\nSELECT c_last_name, c_first_name, current_addr.ca_city, dn.bought_city, dn.ss_ticket_number, dn.extended_price, dn.extended_tax, dn.list_price FROM (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, bought_city, SUM(ss_ext_sales_price) AS extended_price, SUM(ss_ext_list_price) AS list_price, SUM(ss_ext_tax) AS extended_tax FROM sales_union GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, bought_city) AS dn, customer, customer_address AS current_addr WHERE dn.ss_customer_sk = c_customer_sk AND customer.c_current_addr_sk = current_addr.ca_address_sk AND current_addr.ca_city <> dn.bought_city ORDER BY c_last_name NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100",
          "prompt_tokens": 4182,
          "response_tokens": 988,
          "llm_time_ms": 246125.56862831116
        }
      ],
      "original_speedup": 0.95,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061977"
    },
    {
      "query_id": "q92",
      "best_worker": null,
      "best_speedup": 0.0,
      "best_status": "collected",
      "all_workers": [
        {
          "worker_id": 1,
          "query_id": "q92",
          "examples_used": [
            "decorrelate",
            "pushdown",
            "early_filter"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), web_sales_filtered AS (SELECT ws_item_sk, ws_ext_discount_amt, ws_sold_date_sk FROM web_sales AS ws JOIN date_range AS dr ON ws.ws_sold_date_sk = dr.d_date_sk), item_filtered AS (SELECT i_item_sk FROM item WHERE i_manufact_id = 350), item_avg_discount AS (SELECT wf.ws_item_sk, AVG(wf.ws_ext_discount_amt) AS avg_discount FROM web_sales_filtered AS wf JOIN item_filtered AS i ON wf.ws_item_sk = i.i_item_sk GROUP BY wf.ws_item_sk)\nSELECT SUM(wf.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales_filtered AS wf JOIN item_filtered AS i ON wf.ws_item_sk = i.i_item_sk JOIN item_avg_discount AS avgd ON wf.ws_item_sk = avgd.ws_item_sk WHERE wf.ws_ext_discount_amt > 1.3 * avgd.avg_discount ORDER BY SUM(wf.ws_ext_discount_amt) LIMIT 100",
          "prompt_tokens": 2796,
          "response_tokens": 393,
          "llm_time_ms": 120204.04982566833
        },
        {
          "worker_id": 4,
          "query_id": "q92",
          "examples_used": [
            "single_pass_aggregation",
            "or_to_union",
            "intersect_to_exists",
            "union_cte_split"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), item_avg_discount AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold FROM web_sales JOIN filtered_dates ON d_date_sk = ws_sold_date_sk GROUP BY ws_item_sk)\nSELECT SUM(ws.ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales AS ws JOIN item AS i ON i.i_item_sk = ws.ws_item_sk JOIN filtered_dates AS fd ON fd.d_date_sk = ws.ws_sold_date_sk JOIN item_avg_discount AS iad ON iad.ws_item_sk = ws.ws_item_sk WHERE i.i_manufact_id = 350 AND ws.ws_ext_discount_amt > iad.threshold ORDER BY SUM(ws.ws_ext_discount_amt) LIMIT 100",
          "prompt_tokens": 4013,
          "response_tokens": 507,
          "llm_time_ms": 165521.3325023651
        },
        {
          "worker_id": 3,
          "query_id": "q92",
          "examples_used": [
            "prefetch_fact_join",
            "multi_dimension_prefetch",
            "materialize_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), item_avg_discounts AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS threshold_discount FROM web_sales JOIN filtered_dates ON d_date_sk = ws_sold_date_sk GROUP BY ws_item_sk)\nSELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales JOIN filtered_dates ON d_date_sk = ws_sold_date_sk JOIN item ON i_item_sk = ws_item_sk JOIN item_avg_discounts AS iad ON web_sales.ws_item_sk = iad.ws_item_sk WHERE i_manufact_id = 350 AND ws_ext_discount_amt > iad.threshold_discount ORDER BY SUM(ws_ext_discount_amt) LIMIT 100",
          "prompt_tokens": 2961,
          "response_tokens": 387,
          "llm_time_ms": 182850.69513320923
        },
        {
          "worker_id": 2,
          "query_id": "q92",
          "examples_used": [
            "date_cte_isolate",
            "dimension_cte_isolate",
            "multi_date_range_cte"
          ],
          "status": "collected",
          "speedup": 0.0,
          "error_message": null,
          "error_category": null,
          "original_time_ms": 0,
          "optimized_time_ms": 0,
          "optimized_sql": "WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), item_avg_discount AS (SELECT ws_item_sk, 1.3 * AVG(ws_ext_discount_amt) AS avg_threshold FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk GROUP BY ws_item_sk)\nSELECT SUM(ws_ext_discount_amt) AS \"Excess Discount Amount\" FROM web_sales AS ws JOIN item AS i ON ws.ws_item_sk = i.i_item_sk JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN item_avg_discount AS iad ON ws.ws_item_sk = iad.ws_item_sk WHERE i.i_manufact_id = 350 AND ws.ws_ext_discount_amt > iad.avg_threshold ORDER BY SUM(ws_ext_discount_amt) LIMIT 100",
          "prompt_tokens": 2943,
          "response_tokens": 405,
          "llm_time_ms": 203485.61573028564
        }
      ],
      "original_speedup": 0.95,
      "improvement": 0.0,
      "timestamp": "2026-02-06T00:56:49.061978"
    }
  ]
}