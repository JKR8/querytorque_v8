WITH date_range AS (SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN '2000-01-27' AND CAST('2000-04-26' AS DATE)), web_sales_filtered AS (SELECT ws_item_sk, ws_ext_discount_amt, ws_sold_date_sk FROM web_sales AS ws JOIN date_range AS dr ON ws.ws_sold_date_sk = dr.d_date_sk), item_filtered AS (SELECT i_item_sk FROM item WHERE i_manufact_id = 350), item_avg_discount AS (SELECT wf.ws_item_sk, AVG(wf.ws_ext_discount_amt) AS avg_discount FROM web_sales_filtered AS wf JOIN item_filtered AS i ON wf.ws_item_sk = i.i_item_sk GROUP BY wf.ws_item_sk)
SELECT SUM(wf.ws_ext_discount_amt) AS "Excess Discount Amount" FROM web_sales_filtered AS wf JOIN item_filtered AS i ON wf.ws_item_sk = i.i_item_sk JOIN item_avg_discount AS avgd ON wf.ws_item_sk = avgd.ws_item_sk WHERE wf.ws_ext_discount_amt > 1.3 * avgd.avg_discount ORDER BY SUM(wf.ws_ext_discount_amt) LIMIT 100