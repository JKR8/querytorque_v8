```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_moy = 11 AND d_year = 1999",
        "web_filtered": "SELECT ws_ext_sales_price AS ext_price, ws_sold_time_sk AS time_sk, ws_item_sk FROM web_sales JOIN filtered_dates ON d_date_sk = ws_sold_date_sk",
        "catalog_filtered": "SELECT cs_ext_sales_price AS ext_price, cs_sold_time_sk AS time_sk, cs_item_sk FROM catalog_sales JOIN filtered_dates ON d_date_sk = cs_sold_date_sk",
        "store_filtered": "SELECT ss_ext_sales_price AS ext_price, ss_sold_time_sk AS time_sk, ss_item_sk FROM store_sales JOIN filtered_dates ON d_date_sk = ss_sold_date_sk",
        "sales_union": "SELECT ext_price, time_sk, sold_item_sk FROM web_filtered UNION ALL SELECT ext_price, time_sk, sold_item_sk FROM catalog_filtered UNION ALL SELECT ext_price, time_sk, sold_item_sk FROM store_filtered",
        "main_query": "SELECT i_brand_id AS brand_id, i_brand AS brand, t_hour, t_minute, SUM(ext_price) AS ext_price FROM sales_union su JOIN item i ON su.sold_item_sk = i.i_item_sk JOIN time_dim t ON su.time_sk = t.t_time_sk WHERE i_manager_id = 1 AND (t_meal_time = 'breakfast' OR t_meal_time = 'dinner') GROUP BY i_brand, i_brand_id, t_hour, t_minute ORDER BY ext_price DESC NULLS FIRST, i_brand_id NULLS FIRST, t_hour NULLS FIRST"
      },
      "invariants_kept": [
        "same result rows",
        "same output columns",
        "same grouping and ordering"
      ],
      "expected_speedup": "3.1x",
      "risk": "low"
    }
  ],
  "explanation": "Created a single CTE for filtered date_dim (d_moy=11 AND d_year=1999) and joined each sales table with it before union. This prevents scanning date_dim three times and reduces sales table rows early via the selective date filter (30 rows vs 73K). The main query then joins the union result with item and time_dim as before."
}
```