WITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1999 AND d_moy = 11), filtered_items AS (SELECT i_item_sk, i_brand_id, i_brand FROM item WHERE i_manager_id = 28), filtered_sales AS (SELECT ss_item_sk, ss_ext_sales_price FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk)
SELECT i.brand_id, i.brand, SUM(s.ss_ext_sales_price) AS ext_price FROM filtered_sales AS s JOIN filtered_items AS i ON s.ss_item_sk = i.i_item_sk GROUP BY i.brand_id, i.brand ORDER BY ext_price DESC, i.brand_id LIMIT 100