```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "dimension_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9",
        "filtered_addresses": "SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5",
        "filtered_items": "SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'",
        "ss_rewritten": "SELECT fi.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales ss JOIN filtered_dates fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_addresses fa ON ss.ss_addr_sk = fa.ca_address_sk JOIN filtered_items fi ON ss.ss_item_sk = fi.i_item_sk GROUP BY fi.i_item_id",
        "ws_rewritten": "SELECT fi.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales ws JOIN filtered_dates fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_addresses fa ON ws.ws_bill_addr_sk = fa.ca_address_sk JOIN filtered_items fi ON ws.ws_item_sk = fi.i_item_sk GROUP BY fi.i_item_id",
        "cs_rewritten": "SELECT fi.i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales cs JOIN filtered_dates fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_addresses fa ON cs.cs_bill_addr_sk = fa.ca_address_sk JOIN filtered_items fi ON cs.cs_item_sk = fi.i_item_sk GROUP BY fi.i_item_id",
        "main_query": "SELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss_rewritten UNION ALL SELECT * FROM ws_rewritten UNION ALL SELECT * FROM cs_rewritten) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "same grouping and aggregation"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Created three dimension CTEs (filtered_dates, filtered_addresses, filtered_items) that pre-filter the dimension tables to only relevant rows. Each fact CTE (ss, ws, cs) now joins directly with these pre-filtered CTEs, eliminating repeated subqueries and redundant scans. The item subquery is materialized once and reused across all three fact tables. This reduces cardinality of intermediate joins and eliminates repeated filtering operations."
}
```