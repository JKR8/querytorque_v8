Looking at the query, I see a complex WHERE clause with multiple OR conditions that can't be efficiently pushed down. The OR conditions involve different combinations of `customer_demographics`, `household_demographics`, and `customer_address` filters. This prevents selective filtering early in the query plan.

I'll use **OR_TO_UNION** to break the complex OR conditions into separate UNION ALL branches, allowing each branch to use more specific filters. This matches pattern QT-OPT-001 from the detected opportunities.

```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "main_query": "WITH all_qualified_sales AS (\n  /* Branch 1: First OR condition combination */\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost\n  FROM store_sales\n  JOIN store ON s_store_sk = ss_store_sk\n  JOIN date_dim ON ss_sold_date_sk = d_date_sk\n  JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\n  JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk\n  JOIN customer_address ON ss_addr_sk = ca_address_sk\n  WHERE d_year = 2001\n    AND cd_marital_status = 'D'\n    AND cd_education_status = 'Unknown'\n    AND ss_sales_price BETWEEN 100.00 AND 150.00\n    AND hd_dep_count = 3\n    AND ca_country = 'United States'\n    AND ca_state IN ('SD', 'KS', 'MI')\n    AND ss_net_profit BETWEEN 100 AND 200\n  \n  UNION ALL\n  \n  /* Branch 2 */\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost\n  FROM store_sales\n  JOIN store ON s_store_sk = ss_store_sk\n  JOIN date_dim ON ss_sold_date_sk = d_date_sk\n  JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\n  JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk\n  JOIN customer_address ON ss_addr_sk = ca_address_sk\n  WHERE d_year = 2001\n    AND cd_marital_status = 'D'\n    AND cd_education_status = 'Unknown'\n    AND ss_sales_price BETWEEN 100.00 AND 150.00\n    AND hd_dep_count = 3\n    AND ca_country = 'United States'\n    AND ca_state IN ('MO', 'ND', 'CO')\n    AND ss_net_profit BETWEEN 150 AND 300\n  \n  UNION ALL\n  \n  /* Branch 3 */\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost\n  FROM store_sales\n  JOIN store ON s_store_sk = ss_store_sk\n  JOIN date_dim ON ss_sold_date_sk = d_date_sk\n  JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\n  JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk\n  JOIN customer_address ON ss_addr_sk = ca_address_sk\n  WHERE d_year = 2001\n    AND cd_marital_status = 'D'\n    AND cd_education_status = 'Unknown'\n    AND ss_sales_price BETWEEN 100.00 AND 150.00\n    AND hd_dep_count = 3\n    AND ca_country = 'United States'\n    AND ca_state IN ('NH', 'OH', 'TX')\n    AND ss_net_profit BETWEEN 50 AND 250\n  \n  UNION ALL\n  \n  /* Branch 4 */\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost\n  FROM store_sales\n  JOIN store ON s_store_sk = ss_store_sk\n  JOIN date_dim ON ss_sold_date_sk = d_date_sk\n  JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\n  JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk\n  JOIN customer_address ON ss_addr_sk = ca_address_sk\n  WHERE d_year = 2001\n    AND cd_marital_status = 'S'\n    AND cd_education_status = 'College'\n    AND ss_sales_price BETWEEN 50.00 AND 100.00\n    AND hd_dep_count = 1\n    AND ca_country = 'United States'\n    AND ca_state IN ('SD', 'KS', 'MI')\n    AND ss_net_profit BETWEEN 100 AND 200\n  \n  UNION ALL\n  \n  /* Branch 5 */\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost\n  FROM store_sales\n  JOIN store ON s_store_sk = ss_store_sk\n  JOIN date_dim ON ss_sold_date_sk = d_date_sk\n  JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\n  JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk\n  JOIN customer_address ON ss_addr_sk = ca_address_sk\n  WHERE d_year = 2001\n    AND cd_marital_status = 'S'\n    AND cd_education_status = 'College'\n    AND ss_sales_price BETWEEN 50.00 AND 100.00\n    AND hd_dep_count = 1\n    AND ca_country = 'United States'\n    AND ca_state IN ('MO', 'ND', 'CO')\n    AND ss_net_profit BETWEEN 150 AND 300\n  \n  UNION ALL\n  \n  /* Branch 6 */\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost\n  FROM store_sales\n  JOIN store ON s_store_sk = ss_store_sk\n  JOIN date_dim ON ss_sold_date_sk = d_date_sk\n  JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\n  JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk\n  JOIN customer_address ON ss_addr_sk = ca_address_sk\n  WHERE d_year = 2001\n    AND cd_marital_status = 'S'\n    AND cd_education_status = 'College'\n    AND ss_sales_price BETWEEN 50.00 AND 100.00\n    AND hd_dep_count = 1\n    AND ca_country = 'United States'\n    AND ca_state IN ('NH', 'OH', 'TX')\n    AND ss_net_profit BETWEEN 50 AND 250\n  \n  UNION ALL\n  \n  /* Branch 7 */\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost\n  FROM store_sales\n  JOIN store ON s_store_sk = ss_store_sk\n  JOIN date_dim ON ss_sold_date_sk = d_date_sk\n  JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\n  JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk\n  JOIN customer_address ON ss_addr_sk = ca_address_sk\n  WHERE d_year = 2001\n    AND cd_marital_status = 'M'\n    AND cd_education_status = '4 yr Degree'\n    AND ss_sales_price BETWEEN 150.00 AND 200.00\n    AND hd_dep_count = 1\n    AND ca_country = 'United States'\n    AND ca_state IN ('SD', 'KS', 'MI')\n    AND ss_net_profit BETWEEN 100 AND 200\n  \n  UNION ALL\n  \n  /* Branch 8 */\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost\n  FROM store_sales\n  JOIN store ON s_store_sk = ss_store_sk\n  JOIN date_dim ON ss_sold_date_sk = d_date_sk\n  JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\n  JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk\n  JOIN customer_address ON ss_addr_sk = ca_address_sk\n  WHERE d_year = 2001\n    AND cd_marital_status = 'M'\n    AND cd_education_status = '4 yr Degree'\n    AND ss_sales_price BETWEEN 150.00 AND 200.00\n    AND hd_dep_count = 1\n    AND ca_country = 'United States'\n    AND ca_state IN ('MO', 'ND', 'CO')\n    AND ss_net_profit BETWEEN 150 AND 300\n  \n  UNION ALL\n  \n  /* Branch 9 */\n  SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost\n  FROM store_sales\n  JOIN store ON s_store_sk = ss_store_sk\n  JOIN date_dim ON ss_sold_date_sk = d_date_sk\n  JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk\n  JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk\n  JOIN customer_address ON ss_addr_sk = ca_address_sk\n  WHERE d_year = 2001\n    AND cd_marital_status = 'M'\n    AND cd_education_status = '4 yr Degree'\n    AND ss_sales_price BETWEEN 150.00 AND 200.00\n    AND hd_dep_count = 1\n    AND ca_country = 'United States'\n    AND ca_state IN ('NH', 'OH', 'TX')\n    AND ss_net_profit BETWEEN 50 AND 250\n)\nSELECT \n  AVG(ss_quantity) AS \"AVG(ss_quantity)\",\n  AVG(ss_ext_sales_price) AS \"AVG(ss_ext_sales_price)\",\n  AVG(ss_ext_wholesale_cost) AS \"AVG(ss_ext_wholesale_cost)\",\n  SUM(ss_ext_wholesale_cost) AS \"SUM(ss_ext_wholesale_cost)\"\nFROM all_qualified_sales"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation values",
        "same output columns"
      ],
      "expected_speedup": "2.0x",
      "risk": "medium"
    }
  ],
  "explanation": "Transformed the complex OR conditions in the WHERE clause into 9 separate UNION ALL branches. Each branch has specific, non-overlapping filters that allow the optimizer to push down all predicates and use more efficient join strategies. This avoids the need to evaluate all OR conditions for every row, reducing the filtering cost significantly."
}
```