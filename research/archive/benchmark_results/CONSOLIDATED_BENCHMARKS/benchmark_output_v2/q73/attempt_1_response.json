```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 2 AND d_year IN (2000, 2001, 2002)",
        "filtered_stores": "SELECT s_store_sk FROM store WHERE s_county IN ('Fairfield County', 'Walker County', 'Daviess County', 'Barrow County')",
        "buy_potential_501": "SELECT ss_ticket_number, ss_customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_buy_potential = '501-1000' AND hd_vehicle_count > 0 AND hd_dep_count / hd_vehicle_count > 1",
        "buy_potential_unknown": "SELECT ss_ticket_number, ss_customer_sk FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_buy_potential = 'Unknown' AND hd_vehicle_count > 0 AND hd_dep_count / hd_vehicle_count > 1",
        "dj": "SELECT ss_ticket_number, ss_customer_sk, COUNT(*) AS cnt FROM (SELECT * FROM buy_potential_501 UNION ALL SELECT * FROM buy_potential_unknown) AS combined GROUP BY ss_ticket_number, ss_customer_sk",
        "main_query": "SELECT c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt FROM dj JOIN customer ON ss_customer_sk = c_customer_sk WHERE cnt BETWEEN 1 AND 5 ORDER BY cnt DESC, c_last_name ASC"
      },
      "invariants_kept": [
        "output columns unchanged",
        "same rows after aggregation",
        "same grouping and aggregation",
        "same ordering"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Transformed the OR condition on hd_buy_potential into UNION ALL of two separate branches. This allows each branch to efficiently filter household_demographics by specific values. Also extracted date and store filters into CTEs to avoid redundant scans. The UNION ALL ensures no duplicate elimination overhead."
}
```