```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk, d_date FROM date_dim WHERE d_month_seq BETWEEN 1183 AND 1183 + 11",
        "store_customers": "SELECT DISTINCT c_last_name, c_first_name, d_date FROM store_sales JOIN filtered_dates ON store_sales.ss_sold_date_sk = filtered_dates.d_date_sk JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk",
        "catalog_customers": "SELECT DISTINCT c_last_name, c_first_name, d_date FROM catalog_sales JOIN filtered_dates ON catalog_sales.cs_sold_date_sk = filtered_dates.d_date_sk JOIN customer ON catalog_sales.cs_bill_customer_sk = customer.c_customer_sk",
        "web_customers": "SELECT DISTINCT c_last_name, c_first_name, d_date FROM web_sales JOIN filtered_dates ON web_sales.ws_sold_date_sk = filtered_dates.d_date_sk JOIN customer ON web_sales.ws_bill_customer_sk = customer.c_customer_sk",
        "main_query": "SELECT COUNT(*) FROM (SELECT * FROM store_customers INTERSECT SELECT * FROM catalog_customers INTERSECT SELECT * FROM web_customers) AS hot_cust LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same output columns",
        "same intersection semantics",
        "same distinct semantics"
      ],
      "expected_speedup": "2.5x",
      "risk": "low"
    }
  ],
  "explanation": "Extracted the common date_dim filter into a single CTE (filtered_dates) that's reused across all three sales channels. This eliminates three separate sequential scans of date_dim (each scanning 73,049 rows to filter down to 365) and replaces them with one scan. Each sales channel query now joins with this pre-filtered CTE, reducing overall I/O and computation. The INTERSECT operations remain unchanged, preserving exact semantics."
}
```