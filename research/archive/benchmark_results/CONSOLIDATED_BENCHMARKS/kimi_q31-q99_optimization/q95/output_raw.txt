```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "in_to_exists",
      "nodes": {
        "main_query": "SELECT COUNT(DISTINCT ws_order_number) AS \"order count\", SUM(ws_ext_ship_cost) AS \"total shipping cost\", SUM(ws_net_profit) AS \"total net profit\" FROM web_sales AS ws1 JOIN date_dim ON ws1.ws_ship_date_sk = d_date_sk JOIN customer_address ON ws1.ws_ship_addr_sk = ca_address_sk JOIN web_site ON ws1.ws_web_site_sk = web_site_sk WHERE d_date BETWEEN '1999-2-01' AND (CAST('1999-2-01' AS DATE) + INTERVAL '60' DAY) AND ca_state = 'NC' AND web_company_name = 'pri' AND EXISTS (SELECT 1 FROM ws_wh WHERE ws_wh.ws_order_number = ws1.ws_order_number) AND EXISTS (SELECT 1 FROM web_returns JOIN ws_wh ON wr_order_number = ws_wh.ws_order_number WHERE wr_order_number = ws1.ws_order_number) ORDER BY COUNT(DISTINCT ws_order_number) LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation results",
        "same ordering",
        "output columns unchanged"
      ],
      "expected_speedup": "1.5x",
      "risk": "low"
    }
  ],
  "explanation": "Converted both IN subqueries to EXISTS predicates for early termination benefits. The first semi-join (ws_order_number IN ws_wh) becomes an EXISTS check against the ws_wh CTE. The second semi-join (checking membership in web_returns joined with ws_wh) becomes an EXISTS correlated subquery. This transformation allows the query engine to stop scanning inner tables as soon as a match is found, rather than fully materializing the subquery result sets, significantly reducing I/O for these semi-join operations."
}
```