 ```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "early_filter",
      "nodes": {
        "main_query": "SELECT item_sk, d_date, web_sales, store_sales, web_sales AS web_cumulative, store_sales AS store_cumulative FROM (SELECT CASE WHEN NOT web.item_sk IS NULL THEN web.item_sk ELSE store.item_sk END AS item_sk, CASE WHEN NOT web.d_date IS NULL THEN web.d_date ELSE store.d_date END AS d_date, web.cume_sales AS web_sales, store.cume_sales AS store_sales FROM web_v1 AS web FULL OUTER JOIN store_v1 AS store ON (web.item_sk = store.item_sk AND web.d_date = store.d_date)) AS x WHERE web_sales > store_sales ORDER BY item_sk, d_date LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same ordering",
        "same column output",
        "null handling preserved"
      ],
      "expected_speedup": "2.0x",
      "risk": "low"
    }
  ],
  "explanation": "Eliminated redundant MAX window functions in main_query. Since web_v1 and store_v1 already compute cumulative sales (running totals ordered by d_date), the MAX of these values over the same window frame equals the value itself (assuming non-decreasing cumulative sums). This allows removing two expensive window operations and pushing the comparison filter into the subquery to reduce data materialization earlier in the plan."
}
```