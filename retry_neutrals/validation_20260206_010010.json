{
  "timestamp": "20260206_010010",
  "summary": {
    "total_queries": 43,
    "improved": 30,
    "fixed": 30,
    "validation_time_s": 160.25372195243835
  },
  "results": [
    {
      "query_id": "q20",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.8017931646180063,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q20",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.7775891064012115,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q52",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.9429797077015454,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q52",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.76116092442498,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q20",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.7639148576977852,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q52",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.7662287035113667,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q45",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.6830658304200914,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q45",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 1.0057535839077976,
      "error": "SEMANTIC ERROR: Row count mismatch (original=49, optimized=47)\nYour query DROPPED 2 rows - likely an incorrect filter or JOIN condition\nOriginal query sample (first 3 of 49 rows): [{'ca_zip': '09532', 'ca_city': 'Lakeside', 'sum(ws_sales_price)': Decimal('47.32')}, {'ca_zip': '11387', 'ca_city': 'Greenville', 'sum(ws_sales_price)': Decimal('79.05')}, {'ca_zip': '13604', 'ca_city': 'Pleasant Hill', 'sum(ws_sales_price)': Decimal('134.68')}]\nOptimized query sample (first 3 of 47 rows): [{'ca_zip': '09532', 'ca_city': 'Lakeside', 'sum(ws_sales_price)': Decimal('47.32')}, {'ca_zip': '11387', 'ca_city': 'Greenville', 'sum(ws_sales_price)': Decimal('79.05')}, {'ca_zip': '13604', 'ca_city': 'Pleasant Hill', 'sum(ws_sales_price)': Decimal('134.68')}]\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 2001), special_items AS (SELECT i_item_id, i_item_sk FROM item WHERE i_item_sk IN (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)) SELECT ca_zip, ca_city, SUM(ws_sales_price) FROM (SELECT ca_zip, ca_city, ws_sales_price FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN item ON ws_item_sk = i_item_sk WHERE SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') UNION ALL SELECT ca_zip, ca_city, ws_sales_price FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN customer ON ws_bill_customer_sk = c_customer_sk JOIN customer_address ON c_current_addr_sk = ca_address_sk JOIN special_items ON ws_item_sk = i_item_sk WHERE NOT SUBSTRING(ca_zip, 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792')) AS combined GROUP BY ca_zip, ca_city ORDER BY ca_zip, ca_city LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q45",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.8226606436674136,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q40",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 5.71179425805959,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q40",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.6420637556785981,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q40",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.178214341043941,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q58",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Catalog Error: Table with name ss_items does not exist!\nDid you mean \"item\"?\n\nLINE 1: ... s.item_id, s.ss_item_rev, c.cs_item_rev, w.ws_item_rev FROM ss_items AS s JOIN cs_items AS c ON s.item_id = c.item_id...\n                                                                        ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q33",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Referenced table \"ei\" not found!\nCandidate tables: \"em\"\n\nLINE 1: ...address AS fa ON ss.ss_addr_sk = fa.ca_address_sk GROUP BY ei.i_manufact_id), ws AS (SELECT ei.i_manufact_id, SUM(ws_e...\n                                                                      ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q58",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.9868628858716525,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q58",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.942079125269562,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q33",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.5336120744535915,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q33",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 0.8139077239378406,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='i_manufact_id', original_value=672, optimized_value=335), ValueDifference(row_index=0, column='total_sales', original_value=Decimal('91055.26'), optimized_value=Decimal('8549.24')), ValueDifference(row_index=1, column='i_manufact_id', original_value=676, optimized_value=336), ValueDifference(row_index=1, column='total_sales', original_value=Decimal('82406.03'), optimized_value=Decimal('2861.90')), ValueDifference(row_index=2, column='i_manufact_id', original_value=678, optimized_value=342)]\nOriginal row 0: {'i_manufact_id': 944, 'total_sales': Decimal('39122.84')}\nOptimized row 0: {'i_manufact_id': 977, 'total_sales': Decimal('126.00')}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 5), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), electronics_items AS (SELECT i_item_sk, i_manufact_id FROM item WHERE i_category IN ('Electronics')), ss AS (SELECT i_manufact_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_addresses ON ss_addr_sk = ca_address_sk JOIN electronics_items ON ss_item_sk = i_item_sk GROUP BY i_manufact_id), ws AS (SELECT i_manufact_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_addresses ON ws_bill_addr_sk = ca_address_sk JOIN electronics_items ON ws_item_sk = i_item_sk GROUP BY i_manufact_id), cs AS (SELECT i_manufact_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_addresses ON cs_bill_addr_sk = ca_address_sk JOIN electronics_items ON cs_item_sk = i_item_sk GROUP BY i_manufact_id) SELECT i_manufact_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_manufact_id ORDER BY total_sales LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q19",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Values list \"qs\" does not have a column named \"ss_customer_sk\"\n\nLINE 1: ... FROM qualified_sales AS qs JOIN filtered_customer AS c ON qs.ss_customer_sk = c.c_customer_sk JOIN filtered_customer_...\n                                                                      ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q19",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.1433944859985656,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q19",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.0300288959165398,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q79",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.7533865653910721,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q79",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 1.2818589277542933,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='profit', original_value=Decimal('-10166.40'), optimized_value=Decimal('-10957.94')), ValueDifference(row_index=0, column='ss_ticket_number', original_value=1122952, optimized_value=211112), ValueDifference(row_index=1, column='profit', original_value=Decimal('-10957.94'), optimized_value=Decimal('-20555.02')), ValueDifference(row_index=1, column='ss_ticket_number', original_value=211112, optimized_value=2276486), ValueDifference(row_index=2, column='profit', original_value=Decimal('-20555.02'), optimized_value=None)]\nOriginal row 0: {'c_last_name': None, 'c_first_name': None, 'main.\"substring\"(s_city, 1, 30)': 'Fairview', 'ss_ticket_number': 63346, 'amt': Decimal('19.42'), 'profit': None}\nOptimized row 0: {'c_last_name': None, 'c_first_name': None, 'main.\"substring\"(s_city, 1, 30)': 'Fairview', 'ss_ticket_number': 63346, 'amt': Decimal('19.42'), 'profit': None}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dow = 1 AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk, s_city, s_number_employees FROM store WHERE s_number_employees BETWEEN 200 AND 295), branch_hd_dep_count AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_dep_count = 6 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city), branch_hd_vehicle_count AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk WHERE hd_vehicle_count > 2 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, s_city) SELECT c_last_name, c_first_name, SUBSTRING(s_city, 1, 30), ss_ticket_number, amt, profit FROM (SELECT * FROM branch_hd_dep_count UNION ALL SELECT * FROM branch_hd_vehicle_count) AS ms, customer WHERE ss_customer_sk = c_customer_sk ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, SUBSTRING(s_city, 1, 30) NULLS FIRST, profit NULLS FIRST, ss_ticket_number LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q79",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.8495948891909539,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q31",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.4601310279423135,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q23",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Referenced column \"d_date\" not found in FROM clause!\nCandidate bindings: \"d_date_sk\", \"ss_sold_date_sk\", \"i_category\", \"i_category_id\", \"i_item_sk\"\n\nLINE 1: ... ON ss_sold_date_sk = d_date_sk GROUP BY i_item_sk, itemdesc, d_date HAVING COUNT(*) > 4), max_csales AS (SELECT c_custom...\n                                                                         ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q31",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.23213018116120565,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q8",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.1328760148026131,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q31",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.48266741213868486,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q54",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.688929925186359,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q8",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0.8850459676182538,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='sum(ss_net_profit)', original_value=Decimal('-37751993.56'), optimized_value=Decimal('-50435623.99')), ValueDifference(row_index=2, column='sum(ss_net_profit)', original_value=Decimal('-12393083.20'), optimized_value=Decimal('-24653985.55')), ValueDifference(row_index=3, column='sum(ss_net_profit)', original_value=Decimal('-37993292.25'), optimized_value=Decimal('-24740851.07')), ValueDifference(row_index=5, column='sum(ss_net_profit)', original_value=Decimal('-61295705.57'), optimized_value=Decimal('-36612922.12')), ValueDifference(row_index=6, column='sum(ss_net_profit)', original_value=Decimal('-51363002.77'), optimized_value=Decimal('-38006842.06'))]\nOriginal row 0: {'s_store_name': 'able', 'sum(ss_net_profit)': Decimal('-37751993.56')}\nOptimized row 0: {'s_store_name': 'able', 'sum(ss_net_profit)': Decimal('-50435623.99')}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 1998), filtered_store_sales AS (SELECT ss_store_sk, ss_net_profit FROM store_sales WHERE ss_sold_date_sk IN (SELECT d_date_sk FROM filtered_dates)), zip_subquery AS (SELECT SUBSTRING(ca_zip, 1, 2) AS zip_prefix FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576')), preferred_customer_zips AS (SELECT SUBSTRING(ca_zip, 1, 2) AS zip_prefix, COUNT(*) AS cnt FROM customer_address JOIN customer ON ca_address_sk = c_current_addr_sk WHERE c_preferred_cust_flag = 'Y' GROUP BY SUBSTRING(ca_zip, 1, 2) HAVING COUNT(*) > 10), valid_zip_prefixes AS (SELECT zip_prefix FROM zip_subquery INTERSECT SELECT zip_prefix FROM preferred_customer_zips) SELECT s_store_name, SUM(ss_net_profit) FROM filtered_store_sales AS fss JOIN store AS s ON fss.ss_store_sk = s.s_store_sk WHERE SUBSTRING(s_zip, 1, 2) IN (SELECT zip_prefix FROM valid_zip_prefixes) GROUP BY s_store_name ORDER BY s_store_name LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q54",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Ambiguous reference to column name \"d_month_seq\" (use: \"date_dim.d_month_seq\" or \"base_month_seq.d_month_seq\")",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q54",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.197602421984918,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q69",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.9659964610084274,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q8",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 1.372737206909019,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='sum(ss_net_profit)', original_value=Decimal('-37751993.56'), optimized_value=Decimal('-25193309.77')), ValueDifference(row_index=3, column='sum(ss_net_profit)', original_value=Decimal('-37993292.25'), optimized_value=Decimal('-24740851.07')), ValueDifference(row_index=5, column='sum(ss_net_profit)', original_value=Decimal('-61295705.57'), optimized_value=Decimal('-36612922.12')), ValueDifference(row_index=6, column='sum(ss_net_profit)', original_value=Decimal('-51363002.77'), optimized_value=Decimal('-38006842.06')), ValueDifference(row_index=7, column='sum(ss_net_profit)', original_value=Decimal('-38827272.44'), optimized_value=Decimal('-25925374.55'))]\nOriginal row 0: {'s_store_name': 'able', 'sum(ss_net_profit)': Decimal('-37751993.56')}\nOptimized row 0: {'s_store_name': 'able', 'sum(ss_net_profit)': Decimal('-25193309.77')}\nYour optimized SQL that failed:\n```sql\nWITH filtered_date_dim AS (SELECT d_date_sk FROM date_dim WHERE d_qoy = 2 AND d_year = 1998), filtered_stores_with_zips AS (SELECT s_store_sk, s_store_name, SUBSTRING(s_zip, 1, 2) AS s_zip_prefix FROM store) SELECT s_store_name, SUM(ss_net_profit) FROM store_sales JOIN filtered_date_dim ON ss_sold_date_sk = d_date_sk JOIN filtered_stores_with_zips ON ss_store_sk = s_store_sk WHERE s_zip_prefix IN (SELECT DISTINCT SUBSTRING(ca_zip, 1, 2) FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip FROM customer_address WHERE SUBSTRING(ca_zip, 1, 5) IN ('24128', '76232', '65084', '87816', '83926', '77556', '20548', '26231', '43848', '15126', '91137', '61265', '98294', '25782', '17920', '18426', '98235', '40081', '84093', '28577', '55565', '17183', '54601', '67897', '22752', '86284', '18376', '38607', '45200', '21756', '29741', '96765', '23932', '89360', '29839', '25989', '28898', '91068', '72550', '10390', '18845', '47770', '82636', '41367', '76638', '86198', '81312', '37126', '39192', '88424', '72175', '81426', '53672', '10445', '42666', '66864', '66708', '41248', '48583', '82276', '18842', '78890', '49448', '14089', '38122', '34425', '79077', '19849', '43285', '39861', '66162', '77610', '13695', '99543', '83444', '83041', '12305', '57665', '68341', '25003', '57834', '62878', '49130', '81096', '18840', '27700', '23470', '50412', '21195', '16021', '76107', '71954', '68309', '18119', '98359', '64544', '10336', '86379', '27068', '39736', '98569', '28915', '24206', '56529', '57647', '54917', '42961', '91110', '63981', '14922', '36420', '23006', '67467', '32754', '30903', '20260', '31671', '51798', '72325', '85816', '68621', '13955', '36446', '41766', '68806', '16725', '15146', '22744', '35850', '88086', '51649', '18270', '52867', '39972', '96976', '63792', '11376', '94898', '13595', '10516', '90225', '58943', '39371', '94945', '28587', '96576', '57855', '28488', '26105', '83933', '25858', '34322', '44438', '73171', '30122', '34102', '22685', '71256', '78451', '54364', '13354', '45375', '40558', '56458', '28286', '45266', '47305', '69399', '83921', '26233', '11101', '15371', '69913', '35942', '15882', '25631', '24610', '44165', '99076', '33786', '70738', '26653', '14328', '72305', '62496', '22152', '10144', '64147', '48425', '14663', '21076', '18799', '30450', '63089', '81019', '68893', '24996', '51200', '51211', '45692', '92712', '70466', '79994', '22437', '25280', '38935', '71791', '73134', '56571', '14060', '19505', '72425', '56575', '74351', '68786', '51650', '20004', '18383', '76614', '11634', '18906', '15765', '41368', '73241', '76698', '78567', '97189', '28545', '76231', '75691', '22246', '51061', '90578', '56691', '68014', '51103', '94167', '57047', '14867', '73520', '15734', '63435', '25733', '35474', '24676', '94627', '53535', '17879', '15559', '53268', '59166', '11928', '59402', '33282', '45721', '43933', '68101', '33515', '36634', '71286', '19736', '58058', '55253', '67473', '41918', '19515', '36495', '19430', '22351', '77191', '91393', '49156', '50298', '87501', '18652', '53179', '18767', '63193', '23968', '65164', '68880', '21286', '72823', '58470', '67301', '13394', '31016', '70372', '67030', '40604', '24317', '45748', '39127', '26065', '77721', '31029', '31880', '60576', '24671', '45549', '13376', '50016', '33123', '19769', '22927', '97789', '46081', '72151', '15723', '46136', '51949', '68100', '96888', '64528', '14171', '79777', '28709', '11489', '25103', '32213', '78668', '22245', '15798', '27156', '37930', '62971', '21337', '51622', '67853', '10567', '38415', '15455', '58263', '42029', '60279', '37125', '56240', '88190', '50308', '26859', '64457', '89091', '82136', '62377', '36233', '63837', '58078', '17043', '30010', '60099', '28810', '98025', '29178', '87343', '73273', '30469', '64034', '39516', '86057', '21309', '90257', '67875', '40162', '11356', '73650', '61810', '72013', '30431', '22461', '19512', '13375', '55307', '30625', '83849', '68908', '26689', '96451', '38193', '46820', '88885', '84935', '69035', '83144', '47537', '56616', '94983', '48033', '69952', '25486', '61547', '27385', '61860', '58048', '56910', '16807', '17871', '35258', '31387', '35458', '35576') INTERSECT SELECT ca_zip FROM (SELECT SUBSTRING(ca_zip, 1, 5) AS ca_zip, COUNT(*) AS cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk AND c_preferred_cust_flag = 'Y' GROUP BY ca_zip HAVING COUNT(*) > 10) AS A1) AS A2) GROUP BY s_store_name ORDER BY s_store_name LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q69",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 3.01380179858059,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q69",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.6492126143332616,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q23",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.093688660435141,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q10",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Parser Error: syntax error at or near \"asc\"\n\nLINE 1: ....c_customer_sk = ss.ss_customer_sk JOIN any_sales_customers AS asc ON c.c_customer_sk = asc.customer_sk) SELECT cd_gender...\n                                                                          ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q80",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 2.120141167622575,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q80",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.6904592116068018,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q10",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.4868575590566114,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q10",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.4661522746082845,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q80",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.7013458103690762,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q46",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 1.0738415343546437,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=8, column='profit', original_value=Decimal('-3615.04'), optimized_value=Decimal('-7230.08')), ValueDifference(row_index=19, column='amt', original_value=Decimal('1225.79'), optimized_value=Decimal('1233.77')), ValueDifference(row_index=19, column='bought_city', original_value='Belmont', optimized_value='Spring Valley'), ValueDifference(row_index=19, column='ca_city', original_value='Edgewood', optimized_value='Bethel'), ValueDifference(row_index=19, column='profit', original_value=Decimal('-9179.70'), optimized_value=Decimal('-2229.91'))]\nOriginal row 0: {'c_last_name': None, 'c_first_name': None, 'ca_city': 'Aberdeen', 'bought_city': 'Providence', 'ss_ticket_number': 1550421, 'amt': Decimal('2301.91'), 'profit': Decimal('-11953.02')}\nOptimized row 0: {'c_last_name': None, 'c_first_name': None, 'ca_city': 'Aberdeen', 'bought_city': 'Providence', 'ss_ticket_number': 1550421, 'amt': Decimal('2301.91'), 'profit': Decimal('-11953.02')}\nYour optimized SQL that failed:\n```sql\nWITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_dow IN (6, 0) AND d_year IN (1999, 2000, 2001)), store_filter AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), hd_dep4 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_dep_count = 4), hd_vehicle3 AS (SELECT hd_demo_sk FROM household_demographics WHERE hd_vehicle_count = 3), branch1_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_coupon_amt, ss_net_profit FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN store_filter ON ss_store_sk = s_store_sk JOIN hd_dep4 ON ss_hdemo_sk = hd_demo_sk), branch2_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_coupon_amt, ss_net_profit FROM store_sales JOIN date_filter ON ss_sold_date_sk = d_date_sk JOIN store_filter ON ss_store_sk = s_store_sk JOIN hd_vehicle3 ON ss_hdemo_sk = hd_demo_sk), unified_sales AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_coupon_amt, ss_net_profit FROM branch1_sales UNION ALL SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ss_coupon_amt, ss_net_profit FROM branch2_sales), dn AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_coupon_amt) AS amt, SUM(ss_net_profit) AS profit FROM unified_sales JOIN customer_address ON ss_addr_sk = ca_address_sk GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city) SELECT c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, amt, profit FROM dn, customer, customer_address AS current_addr WHERE ss_customer_sk = c_customer_sk AND customer.c_current_addr_sk = current_addr.ca_address_sk AND current_addr.ca_city <> bought_city ORDER BY c_last_name NULLS FIRST, c_first_name NULLS FIRST, ca_city NULLS FIRST, bought_city NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q23",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.9326045198102668,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q46",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.505624723182454,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q46",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.47952809033342514,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q49",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: WHERE clause cannot contain window functions!\n\nLINE 1: ...) GROUP BY sts.ss_item_sk) SELECT channel, item, return_ratio, RANK() OVER (PARTITION BY channel ORDER BY return_ratio...\n                                                                          ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q49",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Values list \"ws\" does not have a column named \"ws_sold_date_sk\"\n\nLINE 1: ... AND ws.ws_item_sk = wr.wr_item_sk) JOIN filtered_dates ON ws.ws_sold_date_sk = filtered_dates.d_date_sk WHERE wr.wr_r...\n                                                                      ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q49",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0.8784112355860457,
      "error": "SEMANTIC ERROR: Row count mismatch (original=46, optimized=100)\nYour query ADDED 54 extra rows - likely a missing DISTINCT or incorrect JOIN\nOriginal query sample (first 3 of 46 rows): [{'channel': 'catalog', 'item': 53427, 'return_ratio': 0.0, 'return_rank': 1, 'currency_rank': 39}, {'channel': 'catalog', 'item': 27951, 'return_ratio': 0.0, 'return_rank': 1, 'currency_rank': 138}, {'channel': 'catalog', 'item': 90927, 'return_ratio': 0.0, 'return_rank': 1, 'currency_rank': 206}]\nOptimized query sample (first 3 of 100 rows): [{'channel': 'catalog', 'item': 1, 'return_ratio': 0.0, 'return_rank': 1, 'currency_rank': 1}, {'channel': 'catalog', 'item': 3, 'return_ratio': 0.0, 'return_rank': 1, 'currency_rank': 1}, {'channel': 'catalog', 'item': 5, 'return_ratio': 0.0, 'return_rank': 1, 'currency_rank': 1}]\nYour optimized SQL that failed:\n```sql\nWITH filtered_date AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001 AND d_moy = 12), web_sales_filtered AS (SELECT ws.ws_item_sk, ws.ws_order_number, ws.ws_quantity, ws.ws_net_paid, ws.ws_net_profit FROM web_sales AS ws JOIN filtered_date AS fd ON ws.ws_sold_date_sk = fd.d_date_sk WHERE ws.ws_net_profit > 1 AND ws.ws_net_paid > 0 AND ws.ws_quantity > 0), catalog_sales_filtered AS (SELECT cs.cs_item_sk, cs.cs_order_number, cs.cs_quantity, cs.cs_net_paid, cs.cs_net_profit FROM catalog_sales AS cs JOIN filtered_date AS fd ON cs.cs_sold_date_sk = fd.d_date_sk WHERE cs.cs_net_profit > 1 AND cs.cs_net_paid > 0 AND cs.cs_quantity > 0), store_sales_filtered AS (SELECT ss.ss_item_sk, ss.ss_ticket_number, ss.ss_quantity, ss.ss_net_paid, ss.ss_net_profit FROM store_sales AS ss JOIN filtered_date AS fd ON ss.ss_sold_date_sk = fd.d_date_sk WHERE ss.ss_net_profit > 1 AND ss.ss_net_paid > 0 AND ss.ss_quantity > 0), web_returns_filtered AS (SELECT wr.wr_order_number, wr.wr_item_sk, wr.wr_return_quantity, wr.wr_return_amt FROM web_returns AS wr WHERE wr.wr_return_amt > 10000), catalog_returns_filtered AS (SELECT cr.cr_order_number, cr.cr_item_sk, cr.cr_return_quantity, cr.cr_return_amount FROM catalog_returns AS cr WHERE cr.cr_return_amount > 10000), store_returns_filtered AS (SELECT sr.sr_ticket_number, sr.sr_item_sk, sr.sr_return_quantity, sr.sr_return_amt FROM store_returns AS sr WHERE sr.sr_return_amt > 10000), web_channel_base AS (SELECT wsf.ws_item_sk AS item, CAST(SUM(COALESCE(wrf.wr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(wsf.ws_quantity, 0)) AS DECIMAL(15, 4)) AS return_ratio, CAST(SUM(COALESCE(wrf.wr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(wsf.ws_net_paid, 0)) AS DECIMAL(15, 4)) AS currency_ratio FROM web_sales_filtered AS wsf LEFT JOIN web_returns_filtered AS wrf ON wsf.ws_order_number = wrf.wr_order_number AND wsf.ws_item_sk = wrf.wr_item_sk GROUP BY wsf.ws_item_sk), catalog_channel_base AS (SELECT csf.cs_item_sk AS item, CAST(SUM(COALESCE(crf.cr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(csf.cs_quantity, 0)) AS DECIMAL(15, 4)) AS return_ratio, CAST(SUM(COALESCE(crf.cr_return_amount, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(csf.cs_net_paid, 0)) AS DECIMAL(15, 4)) AS currency_ratio FROM catalog_sales_filtered AS csf LEFT JOIN catalog_returns_filtered AS crf ON csf.cs_order_number = crf.cr_order_number AND csf.cs_item_sk = crf.cr_item_sk GROUP BY csf.cs_item_sk), store_channel_base AS (SELECT ssf.ss_item_sk AS item, CAST(SUM(COALESCE(srf.sr_return_quantity, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ssf.ss_quantity, 0)) AS DECIMAL(15, 4)) AS return_ratio, CAST(SUM(COALESCE(srf.sr_return_amt, 0)) AS DECIMAL(15, 4)) / CAST(SUM(COALESCE(ssf.ss_net_paid, 0)) AS DECIMAL(15, 4)) AS currency_ratio FROM store_sales_filtered AS ssf LEFT JOIN store_returns_filtered AS srf ON ssf.ss_ticket_number = srf.sr_ticket_number AND ssf.ss_item_sk = srf.sr_item_sk GROUP BY ssf.ss_item_sk), web_channel_ranked AS (SELECT 'web' AS channel, item, return_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM web_channel_base), catalog_channel_ranked AS (SELECT 'catalog' AS channel, item, return_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM catalog_channel_base), store_channel_ranked AS (SELECT 'store' AS channel, item, return_ratio, RANK() OVER (ORDER BY return_ratio) AS return_rank, RANK() OVER (ORDER BY currency_ratio) AS currency_rank FROM store_channel_base) SELECT channel, item, return_ratio, return_rank, currency_rank FROM (SELECT * FROM web_channel_ranked WHERE return_rank <= 10 OR currency_rank <= 10 UNION SELECT * FROM catalog_channel_ranked WHERE return_rank <= 10 OR currency_rank <= 10 UNION SELECT * FROM store_channel_ranked WHERE return_rank <= 10 OR currency_rank <= 10) AS sq1 ORDER BY 1 NULLS FIRST, 4 NULLS FIRST, 5 NULLS FIRST, 2 NULLS FIRST LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q60",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 1.45358716820421,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=1, column='i_item_id', original_value='AAAAAAAAAABBAAAA', optimized_value='AAAAAAAAAABJAAAA'), ValueDifference(row_index=1, column='total_sales', original_value=Decimal('8403.05'), optimized_value=Decimal('8143.89')), ValueDifference(row_index=2, column='i_item_id', original_value='AAAAAAAAAABEAAAA', optimized_value='AAAAAAAAAACHBAAA'), ValueDifference(row_index=2, column='total_sales', original_value=Decimal('12593.47'), optimized_value=Decimal('13480.59')), ValueDifference(row_index=3, column='i_item_id', original_value='AAAAAAAAAABJAAAA', optimized_value='AAAAAAAAAACIAAAA')]\nOriginal row 0: {'i_item_id': 'AAAAAAAAAAAHBAAA', 'total_sales': Decimal('8920.18')}\nOptimized row 0: {'i_item_id': 'AAAAAAAAAAAHBAAA', 'total_sales': Decimal('8920.18')}\nYour optimized SQL that failed:\n```sql\nWITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), address_filtered AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), music_items AS (SELECT i_item_id, i_item_sk FROM item WHERE i_category = 'Music'), ss AS (SELECT i.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN music_items AS i ON ss.ss_item_sk = i.i_item_sk JOIN date_filtered AS d ON ss.ss_sold_date_sk = d.d_date_sk JOIN address_filtered AS a ON ss.ss_addr_sk = a.ca_address_sk GROUP BY i.i_item_id), ws AS (SELECT i.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN music_items AS i ON ws.ws_item_sk = i.i_item_sk JOIN date_filtered AS d ON ws.ws_sold_date_sk = d.d_date_sk JOIN address_filtered AS a ON ws.ws_bill_addr_sk = a.ca_address_sk GROUP BY i.i_item_id), cs AS (SELECT i.i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales AS cs JOIN music_items AS i ON cs.cs_item_sk = i.i_item_sk JOIN date_filtered AS d ON cs.cs_sold_date_sk = d.d_date_sk JOIN address_filtered AS a ON cs.cs_bill_addr_sk = a.ca_address_sk GROUP BY i.i_item_id) SELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q60",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 1.6419207225211507,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=1, column='i_item_id', original_value='AAAAAAAAAABBAAAA', optimized_value='AAAAAAAAAABJAAAA'), ValueDifference(row_index=1, column='total_sales', original_value=Decimal('8403.05'), optimized_value=Decimal('8143.89')), ValueDifference(row_index=2, column='i_item_id', original_value='AAAAAAAAAABEAAAA', optimized_value='AAAAAAAAAACHBAAA'), ValueDifference(row_index=2, column='total_sales', original_value=Decimal('12593.47'), optimized_value=Decimal('13480.59')), ValueDifference(row_index=3, column='i_item_id', original_value='AAAAAAAAAABJAAAA', optimized_value='AAAAAAAAAACIAAAA')]\nOriginal row 0: {'i_item_id': 'AAAAAAAAAAAHBAAA', 'total_sales': Decimal('8920.18')}\nOptimized row 0: {'i_item_id': 'AAAAAAAAAAAHBAAA', 'total_sales': Decimal('8920.18')}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), filtered_addresses AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), ss AS (SELECT i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND ss_item_sk = i_item_sk AND ss_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ss_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ss_rewritten AS (SELECT fi.i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales AS ss JOIN filtered_dates AS fd ON ss.ss_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ss.ss_addr_sk = fa.ca_address_sk JOIN filtered_items AS fi ON ss.ss_item_sk = fi.i_item_sk GROUP BY fi.i_item_id), ws AS (SELECT i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND ws_item_sk = i_item_sk AND ws_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND ws_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), ws_rewritten AS (SELECT fi.i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales AS ws JOIN filtered_dates AS fd ON ws.ws_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON ws.ws_bill_addr_sk = fa.ca_address_sk JOIN filtered_items AS fi ON ws.ws_item_sk = fi.i_item_sk GROUP BY fi.i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales, date_dim, customer_address, item WHERE i_item_id IN (SELECT i_item_id FROM item WHERE i_category = 'Music') AND cs_item_sk = i_item_sk AND cs_sold_date_sk = d_date_sk AND d_year = 1998 AND d_moy = 9 AND cs_bill_addr_sk = ca_address_sk AND ca_gmt_offset = -5 GROUP BY i_item_id), cs_rewritten AS (SELECT fi.i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales AS cs JOIN filtered_dates AS fd ON cs.cs_sold_date_sk = fd.d_date_sk JOIN filtered_addresses AS fa ON cs.cs_bill_addr_sk = fa.ca_address_sk JOIN filtered_items AS fi ON cs.cs_item_sk = fi.i_item_sk GROUP BY fi.i_item_id) SELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss_rewritten UNION ALL SELECT * FROM ws_rewritten UNION ALL SELECT * FROM cs_rewritten) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q60",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 0.9440328164828282,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=1, column='i_item_id', original_value='AAAAAAAAAABBAAAA', optimized_value='AAAAAAAAAABJAAAA'), ValueDifference(row_index=1, column='total_sales', original_value=Decimal('8403.05'), optimized_value=Decimal('8143.89')), ValueDifference(row_index=2, column='i_item_id', original_value='AAAAAAAAAABEAAAA', optimized_value='AAAAAAAAAACHBAAA'), ValueDifference(row_index=2, column='total_sales', original_value=Decimal('12593.47'), optimized_value=Decimal('13480.59')), ValueDifference(row_index=3, column='i_item_id', original_value='AAAAAAAAAABJAAAA', optimized_value='AAAAAAAAAACIAAAA')]\nOriginal row 0: {'i_item_id': 'AAAAAAAAAAAHBAAA', 'total_sales': Decimal('8920.18')}\nOptimized row 0: {'i_item_id': 'AAAAAAAAAAAHBAAA', 'total_sales': Decimal('8920.18')}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 1998 AND d_moy = 9), filtered_customer_address AS (SELECT ca_address_sk FROM customer_address WHERE ca_gmt_offset = -5), filtered_items AS (SELECT i_item_sk, i_item_id FROM item WHERE i_category = 'Music'), ss AS (SELECT i_item_id, SUM(ss_ext_sales_price) AS total_sales FROM store_sales JOIN filtered_items ON ss_item_sk = i_item_sk JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_customer_address ON ss_addr_sk = ca_address_sk GROUP BY i_item_id), ws AS (SELECT i_item_id, SUM(ws_ext_sales_price) AS total_sales FROM web_sales JOIN filtered_items ON ws_item_sk = i_item_sk JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN filtered_customer_address ON ws_bill_addr_sk = ca_address_sk GROUP BY i_item_id), cs AS (SELECT i_item_id, SUM(cs_ext_sales_price) AS total_sales FROM catalog_sales JOIN filtered_items ON cs_item_sk = i_item_sk JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN filtered_customer_address ON cs_bill_addr_sk = ca_address_sk GROUP BY i_item_id) SELECT i_item_id, SUM(total_sales) AS total_sales FROM (SELECT * FROM ss UNION ALL SELECT * FROM cs UNION ALL SELECT * FROM ws) AS tmp1 GROUP BY i_item_id ORDER BY i_item_id, total_sales LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q57",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.858234796746331,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q57",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.844017760050283,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q13",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Values list \"cd\" does not have a column named \"cd_marital_status\"\n\nLINE 1: ... JOIN store AS s ON ss.ss_store_sk = s.s_store_sk WHERE cd.cd_marital_status = 'M' AND cd.cd_education_status =...\n                                                                   ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q13",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.9042710787267048,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q57",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 2.107652952467987,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q13",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 1.6014089314423539,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='avg1', original_value=28.585714285714285, optimized_value=None), ValueDifference(row_index=0, column='avg2', original_value=2062.2237142857143, optimized_value=None), ValueDifference(row_index=0, column='avg3', original_value=1869.8662857142858, optimized_value=None), ValueDifference(row_index=0, column='sum(ss_ext_wholesale_cost)', original_value=Decimal('130890.64'), optimized_value=None)]\nOriginal row 0: {'avg1': 28.585714285714285, 'avg2': 2062.2237142857143, 'avg3': 1869.8662857142858, 'sum(ss_ext_wholesale_cost)': Decimal('130890.64')}\nOptimized row 0: {'avg1': None, 'avg2': None, 'avg3': None, 'SUM(ss_ext_wholesale_cost)': None}\nYour optimized SQL that failed:\n```sql\nWITH date_filtered AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2001), store_sales_base AS (SELECT ss_quantity, ss_ext_sales_price, ss_ext_wholesale_cost, ss_sales_price, ss_net_profit, ss_store_sk, ss_hdemo_sk, ss_cdemo_sk, ss_addr_sk FROM store_sales JOIN date_filtered ON ss_sold_date_sk = d_date_sk), branch_1 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 3 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 100 AND 200), branch_2 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 3 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 150 AND 300), branch_3 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'M' AND cd_education_status = 'Advanced Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 3 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') WHERE ss_sales_price BETWEEN 100.00 AND 150.00 AND ss_net_profit BETWEEN 50 AND 250), branch_4 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 100 AND 200), branch_5 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 150 AND 300), branch_6 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'S' AND cd_education_status = 'College' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') WHERE ss_sales_price BETWEEN 50.00 AND 100.00 AND ss_net_profit BETWEEN 50 AND 250), branch_7 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('TX', 'OH', 'TX') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 100 AND 200), branch_8 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('OR', 'NM', 'KY') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 150 AND 300), branch_9 AS (SELECT COUNT(*) AS cnt, SUM(ss_quantity) AS sum_qty, SUM(ss_ext_sales_price) AS sum_sales, SUM(ss_ext_wholesale_cost) AS sum_wholesale FROM store_sales_base JOIN store ON ss_store_sk = s_store_sk JOIN customer_demographics ON ss_cdemo_sk = cd_demo_sk AND cd_marital_status = 'W' AND cd_education_status = '2 yr Degree' JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk AND hd_dep_count = 1 JOIN customer_address ON ss_addr_sk = ca_address_sk AND ca_country = 'United States' AND ca_state IN ('VA', 'TX', 'MS') WHERE ss_sales_price BETWEEN 150.00 AND 200.00 AND ss_net_profit BETWEEN 50 AND 250) SELECT (b1.sum_qty + b2.sum_qty + b3.sum_qty + b4.sum_qty + b5.sum_qty + b6.sum_qty + b7.sum_qty + b8.sum_qty + b9.sum_qty) / (b1.cnt + b2.cnt + b3.cnt + b4.cnt + b5.cnt + b6.cnt + b7.cnt + b8.cnt + b9.cnt) AS avg1, (b1.sum_sales + b2.sum_sales + b3.sum_sales + b4.sum_sales + b5.sum_sales + b6.sum_sales + b7.sum_sales + b8.sum_sales + b9.sum_sales) / (b1.cnt + b2.cnt + b3.cnt + b4.cnt + b5.cnt + b6.cnt + b7.cnt + b8.cnt + b9.cnt) AS avg2, (b1.sum_wholesale + b2.sum_wholesale + b3.sum_wholesale + b4.sum_wholesale + b5.sum_wholesale + b6.sum_wholesale + b7.sum_wholesale + b8.sum_wholesale + b9.sum_wholesale) / (b1.cnt + b2.cnt + b3.cnt + b4.cnt + b5.cnt + b6.cnt + b7.cnt + b8.cnt + b9.cnt) AS avg3, (b1.sum_wholesale + b2.sum_wholesale + b3.sum_wholesale + b4.sum_wholesale + b5.sum_wholesale + b6.sum_wholesale + b7.sum_wholesale + b8.sum_wholesale + b9.sum_wholesale) AS \"SUM(ss_ext_wholesale_cost)\" FROM branch_1 AS b1 CROSS JOIN branch_2 AS b2 CROSS JOIN branch_3 AS b3 CROSS JOIN branch_4 AS b4 CROSS JOIN branch_5 AS b5 CROSS JOIN branch_6 AS b6 CROSS JOIN branch_7 AS b7 CROSS JOIN branch_8 AS b8 CROSS JOIN branch_9 AS b9\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q27",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.941767403411337,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q27",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.31478810107854654,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q27",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.1865844679101087,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q4",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 1.112066135964396,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='customer_first_name', original_value='Adam', optimized_value='Abraham'), ValueDifference(row_index=0, column='customer_id', original_value='AAAAAAAABBBHAAAA', optimized_value='AAAAAAAAADOKEAAA'), ValueDifference(row_index=0, column='customer_last_name', original_value='Anderson', optimized_value='Mccray'), ValueDifference(row_index=0, column='customer_preferred_cust_flag', original_value='N', optimized_value='Y'), ValueDifference(row_index=1, column='customer_first_name', original_value='Alta', optimized_value='Adam')]\nOriginal row 0: {'customer_id': 'AAAAAAAAAABHDAAA', 'customer_first_name': 'Amanda', 'customer_last_name': 'Funk', 'customer_preferred_cust_flag': 'N'}\nOptimized row 0: {'customer_id': 'AAAAAAAAAACADAAA', 'customer_first_name': 'Cathleen', 'customer_last_name': 'Tucker', 'customer_preferred_cust_flag': 'Y'}\nYour optimized SQL that failed:\n```sql\nWITH date_filter AS (SELECT d_date_sk FROM date_dim WHERE d_year IN (2001, 2002)), year_total AS (SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer, store_sales, date_dim WHERE c_customer_sk = ss_customer_sk AND ss_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2)) AS year_total, 'c' AS sale_type FROM customer, catalog_sales, date_dim WHERE c_customer_sk = cs_bill_customer_sk AND cs_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year UNION ALL SELECT c_customer_id AS customer_id, c_first_name AS customer_first_name, c_last_name AS customer_last_name, c_preferred_cust_flag AS customer_preferred_cust_flag, c_birth_country AS customer_birth_country, c_login AS customer_login, c_email_address AS customer_email_address, d_year AS dyear, SUM((((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2)) AS year_total, 'w' AS sale_type FROM customer, web_sales, date_dim WHERE c_customer_sk = ws_bill_customer_sk AND ws_sold_date_sk = d_date_sk GROUP BY c_customer_id, c_first_name, c_last_name, c_preferred_cust_flag, c_birth_country, c_login, c_email_address, d_year), year_total_store_2001 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2001 AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer AS c JOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk JOIN date_filter AS df ON ss.ss_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag HAVING SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) > 0), year_total_store_2002 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2002 AS dyear, SUM(((ss_ext_list_price - ss_ext_wholesale_cost - ss_ext_discount_amt) + ss_ext_sales_price) / 2) AS year_total, 's' AS sale_type FROM customer AS c JOIN store_sales AS ss ON c.c_customer_sk = ss.ss_customer_sk JOIN date_filter AS df ON ss.ss_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag), year_total_catalog_2001 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2001 AS dyear, SUM(((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2) AS year_total, 'c' AS sale_type FROM customer AS c JOIN catalog_sales AS cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN date_filter AS df ON cs.cs_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag HAVING SUM(((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2) > 0), year_total_catalog_2002 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2002 AS dyear, SUM(((cs_ext_list_price - cs_ext_wholesale_cost - cs_ext_discount_amt) + cs_ext_sales_price) / 2) AS year_total, 'c' AS sale_type FROM customer AS c JOIN catalog_sales AS cs ON c.c_customer_sk = cs.cs_bill_customer_sk JOIN date_filter AS df ON cs.cs_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag), year_total_web_2001 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2001 AS dyear, SUM(((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2) AS year_total, 'w' AS sale_type FROM customer AS c JOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag HAVING SUM(((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2) > 0), year_total_web_2002 AS (SELECT c.c_customer_id AS customer_id, c.c_first_name AS customer_first_name, c.c_last_name AS customer_last_name, c.c_preferred_cust_flag AS customer_preferred_cust_flag, 2002 AS dyear, SUM(((ws_ext_list_price - ws_ext_wholesale_cost - ws_ext_discount_amt) + ws_ext_sales_price) / 2) AS year_total, 'w' AS sale_type FROM customer AS c JOIN web_sales AS ws ON c.c_customer_sk = ws.ws_bill_customer_sk JOIN date_filter AS df ON ws.ws_sold_date_sk = df.d_date_sk GROUP BY c.c_customer_id, c.c_first_name, c.c_last_name, c.c_preferred_cust_flag) SELECT t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name, t_s_secyear.customer_preferred_cust_flag FROM year_total_store_2001 AS t_s_firstyear, year_total_store_2002 AS t_s_secyear, year_total_catalog_2001 AS t_c_firstyear, year_total_catalog_2002 AS t_c_secyear, year_total_web_2001 AS t_w_firstyear, year_total_web_2002 AS t_w_secyear WHERE t_s_secyear.customer_id = t_s_firstyear.customer_id AND t_s_firstyear.customer_id = t_c_secyear.customer_id AND t_s_firstyear.customer_id = t_c_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_firstyear.customer_id AND t_s_firstyear.customer_id = t_w_secyear.customer_id AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_s_firstyear.year_total > 0 THEN t_s_secyear.year_total / t_s_firstyear.year_total ELSE NULL END AND CASE WHEN t_c_firstyear.year_total > 0 THEN t_c_secyear.year_total / t_c_firstyear.year_total ELSE NULL END > CASE WHEN t_w_firstyear.year_total > 0 THEN t_w_secyear.year_total / t_w_firstyear.year_total ELSE NULL END ORDER BY t_s_secyear.customer_id NULLS FIRST, t_s_secyear.customer_first_name NULLS FIRST, t_s_secyear.customer_last_name NULLS FIRST, t_s_secyear.customer_preferred_cust_flag NULLS FIRST LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q64",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Referenced column \"c_first_sales_date_sk\" not found in FROM clause!\nCandidate bindings: \"sale\", \"d_first_dom\", \"ss_sold_time_sk\", \"ss_sold_date_sk\", \"ss_ext_list_price\"\n\nLINE 1: ... cs_ui ON ss_item_sk = cs_ui.cs_item_sk JOIN date_dim AS d2 ON c_first_sales_date_sk = d2.d_date_sk JOIN date_dim AS d3...\n                                                                          ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q77",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Catalog Error: Table with name cs does not exist!\nDid you mean \"customer\"?\n\nLINE 1: ... AS id, sales, returns_, (profit - profit_loss) AS profit FROM cs, cr UNION ALL SELECT 'web channel' AS channel, ws.wp_web...\n                                                                          ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q77",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 3.7909010191246577,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q77",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.3415443622462533,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q64",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.0115792115171205,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q64",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.0433966272980197,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q4",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.9404771309686327,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q48",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Values list \"ss\" does not have a column named \"quantity\"\n\nLINE 1: ... ca_state IN ('VA', 'CA', 'MS')), sales_branch_a1 AS (SELECT ss.quantity FROM store_branch AS ss JOIN filtered_dates...\n                                                                        ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q4",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.1547401533625217,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q48",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.8447552374313235,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q48",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 1.052613477160269,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='sum(ss_quantity)', original_value=273767, optimized_value=75303)]\nOriginal row 0: {'sum(ss_quantity)': 273767}\nOptimized row 0: {'sum(ss_quantity)': 75303}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_year = 2000), filtered_stores AS (SELECT s_store_sk FROM store), branch_1 AS (SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'M' AND cd_education_status = '4 yr Degree' AND ss_sales_price BETWEEN 100.00 AND 150.00 AND ca_country = 'United States' AND ca_state IN ('CO', 'OH', 'TX') AND ss_net_profit BETWEEN 0 AND 2000), branch_2 AS (SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'D' AND cd_education_status = '2 yr Degree' AND ss_sales_price BETWEEN 50.00 AND 100.00 AND ca_country = 'United States' AND ca_state IN ('OR', 'MN', 'KY') AND ss_net_profit BETWEEN 150 AND 3000), branch_3 AS (SELECT ss_quantity FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON s_store_sk = ss_store_sk JOIN customer_demographics ON cd_demo_sk = ss_cdemo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE cd_marital_status = 'S' AND cd_education_status = 'College' AND ss_sales_price BETWEEN 150.00 AND 200.00 AND ca_country = 'United States' AND ca_state IN ('VA', 'CA', 'MS') AND ss_net_profit BETWEEN 50 AND 25000) SELECT SUM(ss_quantity) FROM (SELECT * FROM branch_1 UNION ALL SELECT * FROM branch_2 UNION ALL SELECT * FROM branch_3) AS combined\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q85",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Optimized SQL syntax error: [\"Required keyword: 'expression' missing for <class 'sqlglot.expressions.Union'>. Line 2, Col: 148.\\n  ), AVG(ws_quantity) AS avg1, AVG(wr_refunded_cash) AS avg2, AVG(wr_fee) FROM (branch_cd_m UNION ALL \\x1b[4mbranch_cd_s\\x1b[0m UNION ALL branch_cd_w) AS unioned_data GROUP BY r_reason_desc ORDER BY SUBSTRING(r_reason_desc, 1, \"]",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q47",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.8169129130715962,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q47",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.6394266102386618,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q47",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.9425269567514657,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q85",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.8432973825324983,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q99",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 2.2539274268931555,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q99",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.2736367074289974,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q85",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.7881377313167035,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q99",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.8192437046317244,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q21",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.169105220483743,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q21",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.6869704056665081,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q21",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.6229752115208822,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q39",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.2125932148721819,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q39",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.7776832286886657,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q39",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 2.4623945374262237,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q88",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Catalog Error: Table with name filtered_store does not exist!\nDid you mean \"sqlite_master\"?\n\nLINE 1: ...= hd_demo_sk JOIN time_dim ON ss_sold_time_sk = t_time_sk JOIN filtered_store ON ss_store_sk = s_store_sk WHERE (t_hour...\n                                                                          ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q88",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 6.871968943381523,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=0, column='h10_30_to_11', original_value=58285, optimized_value=116262), ValueDifference(row_index=0, column='h10_to_10_30', original_value=57977, optimized_value=116262), ValueDifference(row_index=0, column='h11_30_to_12', original_value=33435, optimized_value=68246), ValueDifference(row_index=0, column='h11_to_11_30', original_value=34811, optimized_value=68246), ValueDifference(row_index=0, column='h9_30_to_10', original_value=38929, optimized_value=78209)]\nOriginal row 0: {'h8_30_to_9': 19659, 'h9_to_9_30': 39280, 'h9_30_to_10': 38929, 'h10_to_10_30': 57977, 'h10_30_to_11': 58285, 'h11_to_11_30': 34811, 'h11_30_to_12': 33435, 'h12_to_12_30': 38804}\nOptimized row 0: {'h8_30_to_9': 19659, 'h9_to_9_30': 78209, 'h9_30_to_10': 78209, 'h10_to_10_30': 116262, 'h10_30_to_11': 116262, 'h11_to_11_30': 68246, 'h11_30_to_12': 68246, 'h12_to_12_30': 38804}\nYour optimized SQL that failed:\n```sql\nWITH filtered_hh_demo AS (SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 4 AND hd_vehicle_count <= 6) UNION ALL SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 2 AND hd_vehicle_count <= 4) UNION ALL SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 0 AND hd_vehicle_count <= 2)), filtered_store AS (SELECT s_store_sk FROM store WHERE s_store_name = 'ese'), time_intervals AS (SELECT 8 AS interval_hour, 30 AS min_minute, 8 AS max_hour, 59 AS max_minute UNION ALL SELECT 9, 0, 9, 29 UNION ALL SELECT 9, 30, 9, 59 UNION ALL SELECT 10, 0, 10, 29 UNION ALL SELECT 10, 30, 10, 59 UNION ALL SELECT 11, 0, 11, 29 UNION ALL SELECT 11, 30, 11, 59 UNION ALL SELECT 12, 0, 12, 29), sales_by_interval AS (SELECT ti.interval_hour, COUNT(*) AS cnt FROM store_sales AS ss JOIN time_dim AS td ON ss.ss_sold_time_sk = td.t_time_sk JOIN filtered_hh_demo AS hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN filtered_store AS s ON ss.ss_store_sk = s.s_store_sk JOIN time_intervals AS ti ON td.t_hour = ti.interval_hour WHERE td.t_minute BETWEEN ti.min_minute AND ti.max_minute GROUP BY ti.interval_hour) SELECT s1.cnt AS h8_30_to_9, s2.cnt AS h9_to_9_30, s3.cnt AS h9_30_to_10, s4.cnt AS h10_to_10_30, s5.cnt AS h10_30_to_11, s6.cnt AS h11_to_11_30, s7.cnt AS h11_30_to_12, s8.cnt AS h12_to_12_30 FROM sales_by_interval AS s1, sales_by_interval AS s2, sales_by_interval AS s3, sales_by_interval AS s4, sales_by_interval AS s5, sales_by_interval AS s6, sales_by_interval AS s7, sales_by_interval AS s8 WHERE s1.interval_hour = 8 AND s2.interval_hour = 9 AND s3.interval_hour = 9 AND s4.interval_hour = 10 AND s5.interval_hour = 10 AND s6.interval_hour = 11 AND s7.interval_hour = 11 AND s8.interval_hour = 12 AND s2.cnt = s3.cnt AND s4.cnt = s5.cnt AND s6.cnt = s7.cnt\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q3",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.58826075004332,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q3",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.2019354882786615,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q3",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.000951074060213,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q25",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.9670032058565622,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q25",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.5674880000396676,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q25",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.4329450794982064,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q78",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 3.990981396657346,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q42",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.6915530662951658,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q42",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.1537825698508446,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q42",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.129582722771031,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q97",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.8978205156598127,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q72",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Values list \"inv\" does not have a column named \"inv_date_sk\"\n\nLINE 1: ..., d1_dates AS d2 WHERE cs.cs_sold_date_sk = d1.d_date_sk AND inv.inv_date_sk = d2.d_date_sk AND d1.d_week_seq = d2.d_wee...\n                                                                        ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q78",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 3.2744960897819717,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q97",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.0701609876253242,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q88",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 0.7587368109353814,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q97",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 2.958639903554491,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q71",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Optimized SQL syntax error: [\"Required keyword: 'expression' missing for <class 'sqlglot.expressions.Union'>. Line 2, Col: 343.\\n  red UNION ALL SELECT ext_price, sold_item_sk, time_sk FROM store_sales_filtered) AS sales UNION ALL \\x1b[4mJOIN\\x1b[0m filtered_item ON sales.sold_item_sk = filtered_item.i_item_sk JOIN breakfast_times ON sales.time_sk\"]",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q72",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Referenced column \"inv_date_sk\" not found in FROM clause!\nCandidate bindings: \"d2.d_date_sk\", \"d1.d_date_sk\", \"cs_item_sk\", \"d_date\", \"cs_ship_date_sk\"\n\nLINE 1: ... ON cs_sold_date_sk = d1.d_date_sk JOIN filtered_d2 AS d2 ON inv_date_sk = d2.d_date_sk JOIN inventory ON (cs_item_sk...\n                                                                        ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q71",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "fail",
      "speedup": 0,
      "error": "Original query execution failed: Binder Error: Referenced column \"sold_item_sk\" not found in FROM clause!\nCandidate bindings: \"ws_item_sk\", \"time_sk\", \"ext_price\"\n\nLINE 1: ...= ss_sold_date_sk), sales_union AS (SELECT ext_price, time_sk, sold_item_sk FROM web_filtered UNION ALL SELECT ext_price...\n                                                                          ^",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q72",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.1719409581846711,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q36",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.987327566251182,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q36",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 2.2278787430223232,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q36",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.7357496133091628,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q71",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.407015941404685,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q68",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.8172850604040731,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q98",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.5527299406536992,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q98",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.2381133804197217,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q98",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.6567318479533208,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q92",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 1.2595520306839465,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q92",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.404574722612863,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q68",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 0.8417391905687402,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q68",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "fail",
      "speedup": 0.8001129064111188,
      "error": "SEMANTIC ERROR: Value mismatch - row counts match but VALUES differ\nSample differences: [ValueDifference(row_index=14, column='bought_city', original_value='Farmington', optimized_value='Five Forks'), ValueDifference(row_index=14, column='c_first_name', original_value=None, optimized_value='Marya'), ValueDifference(row_index=14, column='ca_city', original_value='Franklin', optimized_value='New Hope'), ValueDifference(row_index=14, column='extended_price', original_value=Decimal('37530.36'), optimized_value=Decimal('29644.80')), ValueDifference(row_index=14, column='extended_tax', original_value=Decimal('1057.06'), optimized_value=Decimal('1079.46'))]\nOriginal row 0: {'c_last_name': None, 'c_first_name': 'Cheryl', 'ca_city': 'Harmony', 'bought_city': 'Centerville', 'ss_ticket_number': 3681, 'extended_price': Decimal('22226.45'), 'extended_tax': Decimal('674.64'), 'list_price': Decimal('44938.66')}\nOptimized row 0: {'c_last_name': None, 'c_first_name': 'Cheryl', 'ca_city': 'Harmony', 'bought_city': 'Centerville', 'ss_ticket_number': 3681, 'extended_price': Decimal('22226.45'), 'extended_tax': Decimal('674.64'), 'list_price': Decimal('44938.66')}\nYour optimized SQL that failed:\n```sql\nWITH filtered_dates AS (SELECT d_date_sk FROM date_dim WHERE d_dom BETWEEN 1 AND 2 AND d_year IN (1999, 2000, 2001)), filtered_stores AS (SELECT s_store_sk FROM store WHERE s_city IN ('Fairview', 'Midway')), union_branch1 AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_ext_sales_price) AS extended_price, SUM(ss_ext_list_price) AS list_price, SUM(ss_ext_tax) AS extended_tax FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE hd_dep_count = 4 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city), union_branch2 AS (SELECT ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city AS bought_city, SUM(ss_ext_sales_price) AS extended_price, SUM(ss_ext_list_price) AS list_price, SUM(ss_ext_tax) AS extended_tax FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN filtered_stores ON ss_store_sk = s_store_sk JOIN household_demographics ON ss_hdemo_sk = hd_demo_sk JOIN customer_address ON ss_addr_sk = ca_address_sk WHERE hd_vehicle_count = 3 GROUP BY ss_ticket_number, ss_customer_sk, ss_addr_sk, ca_city) SELECT c_last_name, c_first_name, ca_city, bought_city, ss_ticket_number, extended_price, extended_tax, list_price FROM (SELECT * FROM union_branch1 UNION ALL SELECT * FROM union_branch2) AS dn JOIN customer ON ss_customer_sk = c_customer_sk JOIN customer_address AS current_addr ON c_current_addr_sk = current_addr.ca_address_sk WHERE current_addr.ca_city <> bought_city ORDER BY c_last_name NULLS FIRST, ss_ticket_number NULLS FIRST LIMIT 100\n```",
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q92",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.8965187359786464,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q14",
      "worker_id": 1,
      "examples": [
        "decorrelate",
        "pushdown",
        "early_filter"
      ],
      "status": "pass",
      "speedup": 0.9040844159797201,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q78",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 1.896235456027462,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q14",
      "worker_id": 2,
      "examples": [
        "date_cte_isolate",
        "dimension_cte_isolate",
        "multi_date_range_cte"
      ],
      "status": "pass",
      "speedup": 2.2121607610341743,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    },
    {
      "query_id": "q14",
      "worker_id": 3,
      "examples": [
        "prefetch_fact_join",
        "multi_dimension_prefetch",
        "materialize_cte"
      ],
      "status": "pass",
      "speedup": 1.8732407084167404,
      "error": null,
      "original_time_ms": 0,
      "optimized_time_ms": 0
    }
  ]
}