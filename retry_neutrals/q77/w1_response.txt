```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)",
        "ss": "SELECT s_store_sk, SUM(ss_ext_sales_price) AS sales, SUM(ss_net_profit) AS profit FROM store_sales JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk GROUP BY s_store_sk",
        "sr": "SELECT s_store_sk, SUM(sr_return_amt) AS returns_, SUM(sr_net_loss) AS profit_loss FROM store_returns JOIN filtered_dates ON sr_returned_date_sk = d_date_sk JOIN store ON sr_store_sk = s_store_sk GROUP BY s_store_sk",
        "main_query": "SELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, ss.s_store_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ss LEFT JOIN sr ON ss.s_store_sk = sr.s_store_sk UNION ALL SELECT 'catalog channel' AS channel, cs_call_center_sk AS id, sales, returns_, (profit - profit_loss) AS profit FROM cs, cr UNION ALL SELECT 'web channel' AS channel, ws.wp_web_page_sk AS id, sales, COALESCE(returns_, 0) AS returns_, (profit - COALESCE(profit_loss, 0)) AS profit FROM ws LEFT JOIN wr ON ws.wp_web_page_sk = wr.wp_web_page_sk) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST, returns_ DESC LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same output columns",
        "same aggregation results"
      ],
      "expected_speedup": "2.71x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated the date filter into a CTE (filtered_dates) to avoid scanning date_dim multiple times. Both ss and sr CTEs now join with this single filtered date dimension, reducing redundant date filtering from 6 scans to 1 scan. This eliminates 471x misestimation overhead on date_dim FILTER operations."
}
```