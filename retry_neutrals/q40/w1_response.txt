```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk, d_date FROM date_dim WHERE d_date BETWEEN CAST('2000-02-10' AS DATE) AND CAST('2000-04-10' AS DATE)",
        "filtered_items": "SELECT i_item_sk, i_item_id FROM item WHERE i_current_price BETWEEN 0.99 AND 1.49",
        "main_query": "SELECT w.w_state, fi.i_item_id, SUM(CASE WHEN (CAST(fd.d_date AS DATE) < CAST('2000-03-11' AS DATE)) THEN cs.cs_sales_price - COALESCE(cr.cr_refunded_cash, 0) ELSE 0 END) AS sales_before, SUM(CASE WHEN (CAST(fd.d_date AS DATE) >= CAST('2000-03-11' AS DATE)) THEN cs.cs_sales_price - COALESCE(cr.cr_refunded_cash, 0) ELSE 0 END) AS sales_after FROM catalog_sales cs LEFT OUTER JOIN catalog_returns cr ON (cs.cs_order_number = cr.cr_order_number AND cs.cs_item_sk = cr.cr_item_sk) INNER JOIN filtered_dates fd ON cs.cs_sold_date_sk = fd.d_date_sk INNER JOIN filtered_items fi ON cs.cs_item_sk = fi.i_item_sk INNER JOIN warehouse w ON cs.cs_warehouse_sk = w.w_warehouse_sk GROUP BY w.w_state, fi.i_item_id ORDER BY w.w_state, fi.i_item_id LIMIT 100"
      },
      "invariants_kept": [
        "output columns unchanged",
        "grouping grain preserved",
        "same result rows",
        "LEFT OUTER JOIN semantics preserved"
      ],
      "expected_speedup": "4x",
      "risk": "low"
    }
  ],
  "explanation": "Isolated date_dim filter into a CTE to reduce join cardinality early. Also filtered item table early to reduce rows before the main join. This reduces the large fact table scan by applying selective dimension filters first."
}
```