```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "filtered_hh_demo": "SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 4 AND hd_vehicle_count <= 6) UNION ALL SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 2 AND hd_vehicle_count <= 4) UNION ALL SELECT hd_demo_sk FROM household_demographics WHERE (hd_dep_count = 0 AND hd_vehicle_count <= 2)",
        "filtered_store": "SELECT s_store_sk FROM store WHERE s_store_name = 'ese'",
        "time_intervals": "SELECT 8 as interval_hour, 30 as min_minute, 8 as max_hour, 59 as max_minute UNION ALL SELECT 9, 0, 9, 29 UNION ALL SELECT 9, 30, 9, 59 UNION ALL SELECT 10, 0, 10, 29 UNION ALL SELECT 10, 30, 10, 59 UNION ALL SELECT 11, 0, 11, 29 UNION ALL SELECT 11, 30, 11, 59 UNION ALL SELECT 12, 0, 12, 29",
        "sales_by_interval": "SELECT ti.interval_hour, COUNT(*) as cnt FROM store_sales ss JOIN time_dim td ON ss.ss_sold_time_sk = td.t_time_sk JOIN filtered_hh_demo hd ON ss.ss_hdemo_sk = hd.hd_demo_sk JOIN filtered_store s ON ss.ss_store_sk = s.s_store_sk JOIN time_intervals ti ON td.t_hour = ti.interval_hour WHERE td.t_minute BETWEEN ti.min_minute AND ti.max_minute GROUP BY ti.interval_hour",
        "main_query": "SELECT s1.cnt as h8_30_to_9, s2.cnt as h9_to_9_30, s3.cnt as h9_30_to_10, s4.cnt as h10_to_10_30, s5.cnt as h10_30_to_11, s6.cnt as h11_to_11_30, s7.cnt as h11_30_to_12, s8.cnt as h12_to_12_30 FROM sales_by_interval s1, sales_by_interval s2, sales_by_interval s3, sales_by_interval s4, sales_by_interval s5, sales_by_interval s6, sales_by_interval s7, sales_by_interval s8 WHERE s1.interval_hour = 8 AND s2.interval_hour = 9 AND s3.interval_hour = 9 AND s4.interval_hour = 10 AND s5.interval_hour = 10 AND s6.interval_hour = 11 AND s7.interval_hour = 11 AND s8.interval_hour = 12 AND s2.cnt = s3.cnt AND s4.cnt = s5.cnt AND s6.cnt = s7.cnt"
      },
      "invariants_kept": [
        "same result rows",
        "same aggregation results",
        "same output columns"
      ],
      "expected_speedup": "4.50x",
      "risk": "medium"
    }
  ],
  "explanation": "The original query had 8 identical subqueries scanning store_sales 8 times with only time filters differing. Rewrote to: 1) Convert OR conditions on household_demographics to UNION ALL for better index usage; 2) Pre-filter store table once; 3) Create time intervals as a CTE; 4) Scan store_sales ONCE and join with time intervals to compute all counts in a single pass; 5) Join the single-pass results 8 ways (cross product) to produce same output shape. Eliminates 7 redundant scans of store_sales (~1.4M rows each)."
}
```