```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "or_to_union",
      "nodes": {
        "v1": "WITH v1_union AS (\n  SELECT i_category, i_brand, cc_name, d_year, d_moy, cs_sales_price\n  FROM item\n  JOIN catalog_sales ON cs_item_sk = i_item_sk\n  JOIN date_dim ON cs_sold_date_sk = d_date_sk\n  JOIN call_center ON cc_call_center_sk = cs_call_center_sk\n  WHERE d_year = 1999\n  UNION ALL\n  SELECT i_category, i_brand, cc_name, d_year, d_moy, cs_sales_price\n  FROM item\n  JOIN catalog_sales ON cs_item_sk = i_item_sk\n  JOIN date_dim ON cs_sold_date_sk = d_date_sk\n  JOIN call_center ON cc_call_center_sk = cs_call_center_sk\n  WHERE d_year = 1998 AND d_moy = 12\n  UNION ALL\n  SELECT i_category, i_brand, cc_name, d_year, d_moy, cs_sales_price\n  FROM item\n  JOIN catalog_sales ON cs_item_sk = i_item_sk\n  JOIN date_dim ON cs_sold_date_sk = d_date_sk\n  JOIN call_center ON cc_call_center_sk = cs_call_center_sk\n  WHERE d_year = 2000 AND d_moy = 1\n)\nSELECT i_category, i_brand, cc_name, d_year, d_moy,\n       SUM(cs_sales_price) AS sum_sales,\n       AVG(SUM(cs_sales_price)) OVER (PARTITION BY i_category, i_brand, cc_name, d_year) AS avg_monthly_sales,\n       RANK() OVER (PARTITION BY i_category, i_brand, cc_name ORDER BY d_year, d_moy) AS rn\nFROM v1_union\nGROUP BY i_category, i_brand, cc_name, d_year, d_moy"
      },
      "invariants_kept": [
        "same output columns",
        "same grain (i_category, i_brand, cc_name, d_year, d_moy)",
        "same result rows after window functions",
        "same aggregation semantics"
      ],
      "expected_speedup": "2x",
      "risk": "low"
    }
  ],
  "explanation": "Transformed the OR condition in v1 (d_year=1999 OR (d_year=1998 AND d_moy=12) OR (d_year=2000 AND d_moy=1)) into three UNION ALL branches. Each branch has a focused predicate allowing better index usage and partition pruning. The three conditions are mutually exclusive, so UNION ALL is safe without duplicates."
}
```