```json
{
  "rewrite_sets": [
    {
      "id": "rs_01",
      "transform": "date_cte_isolate",
      "nodes": {
        "filtered_dates": "SELECT d_date_sk FROM date_dim WHERE d_date BETWEEN CAST('2000-08-23' AS DATE) AND CAST('2000-09-22' AS DATE)",
        "filtered_item": "SELECT i_item_sk FROM item WHERE i_current_price > 50",
        "filtered_promotion": "SELECT p_promo_sk FROM promotion WHERE p_channel_tv = 'N'",
        "wsr": "SELECT web_site_id, SUM(ws_ext_sales_price) AS sales, SUM(COALESCE(wr_return_amt, 0)) AS returns_, SUM(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit FROM web_sales LEFT OUTER JOIN web_returns ON (ws_item_sk = wr_item_sk AND ws_order_number = wr_order_number) JOIN filtered_dates ON ws_sold_date_sk = d_date_sk JOIN web_site ON ws_web_site_sk = web_site_sk JOIN filtered_item ON ws_item_sk = i_item_sk JOIN filtered_promotion ON ws_promo_sk = p_promo_sk GROUP BY web_site_id",
        "ssr": "SELECT s_store_id AS store_id, SUM(ss_ext_sales_price) AS sales, SUM(COALESCE(sr_return_amt, 0)) AS returns_, SUM(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit FROM store_sales LEFT OUTER JOIN store_returns ON (ss_item_sk = sr_item_sk AND ss_ticket_number = sr_ticket_number) JOIN filtered_dates ON ss_sold_date_sk = d_date_sk JOIN store ON ss_store_sk = s_store_sk JOIN filtered_item ON ss_item_sk = i_item_sk JOIN filtered_promotion ON ss_promo_sk = p_promo_sk GROUP BY s_store_id",
        "csr": "SELECT cp_catalog_page_id AS catalog_page_id, SUM(cs_ext_sales_price) AS sales, SUM(COALESCE(cr_return_amount, 0)) AS returns_, SUM(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit FROM catalog_sales LEFT OUTER JOIN catalog_returns ON (cs_item_sk = cr_item_sk AND cs_order_number = cr_order_number) JOIN filtered_dates ON cs_sold_date_sk = d_date_sk JOIN catalog_page ON cs_catalog_page_sk = cp_catalog_page_sk JOIN filtered_item ON cs_item_sk = i_item_sk JOIN filtered_promotion ON cs_promo_sk = p_promo_sk GROUP BY cp_catalog_page_id",
        "main_query": "SELECT channel, id, SUM(sales) AS sales, SUM(returns_) AS returns_, SUM(profit) AS profit FROM (SELECT 'store channel' AS channel, CONCAT('store', store_id) AS id, sales, returns_, profit FROM ssr UNION ALL SELECT 'catalog channel' AS channel, CONCAT('catalog_page', catalog_page_id) AS id, sales, returns_, profit FROM csr UNION ALL SELECT 'web channel' AS channel, CONCAT('web_site', web_site_id) AS id, sales, returns_, profit FROM wsr) AS x GROUP BY ROLLUP (channel, id) ORDER BY channel NULLS FIRST, id NULLS FIRST LIMIT 100"
      },
      "invariants_kept": [
        "same result rows",
        "same output columns",
        "same aggregation results"
      ],
      "expected_speedup": "3.2x",
      "risk": "low"
    }
  ],
  "explanation": "Created filtered CTEs for date_dim, item, and promotion to isolate and reuse their filtered results across all three channel CTEs. This eliminates redundant scans of date_dim (3x), item (3x), and promotion (3x) by performing each filter once and joining the filtered results. The date range filter is applied early to reduce the fact table join sizes before aggregation."
}
```